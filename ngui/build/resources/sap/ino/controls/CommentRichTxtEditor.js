/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
sap.ui.define(["jquery.sap.global","sap/ui/richtexteditor/RichTextEditor","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/Attachment"],function(q,R,C,A){"use strict";var a=R.extend("sap.ino.controls.CommentRichTxtEditor",{metadata:{properties:{saveText:{type:"string",group:"Data",defaultValue:''},saveIcon:{type:"string",group:"Data",defaultValue:'save'},saveTooltip:{type:"string",group:"Data",defaultValue:''},failureMsg:{type:"string",group:"Data",defaultValue:''}}},constructor:function(s){var t=this;var S=q.extend(true,{width:"100%",editable:true,editorType:sap.ui.richtexteditor.EditorType.TinyMCE4,showGroupInsert:true,showGroupLink:true,showGroupFont:true,showGroupClipboard:false,showGroupStructure:false,useLegacyTheme:false,beforeEditorInit:function(c){c.mParameters.configuration.powerpaste_word_import="clean";c.mParameters.configuration.powerpaste_html_import="clean";c.mParameters.configuration.image_advtab=false;c.mParameters.configuration.paste_data_images=true;c.mParameters.configuration.automatic_uploads=true;c.mParameters.configuration.images_reuse_filename=false;c.mParameters.configuration.image_title=true;c.mParameters.configuration.file_picker_types='image';c.mParameters.configuration.default_link_target="_blank";c.mParameters.configuration.toolbar="fontsizeselect | "+c.mParameters.configuration.toolbar.join(" | ").replace("image","image emoticons ").replace("| alignleft aligncenter alignright alignjustify","");c.mParameters.configuration.images_upload_handler=function(f,b,d){var F=f.blob();if(F){A.uploadFile(F).done(function(r){b("/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_ATTACHMENT_DOWNLOAD")+"/"+r.attachmentId);}).fail(function(){d(t.getFailureMsg());});}};c.mParameters.configuration.file_picker_callback=function(b,v,m){var i=document.createElement('input');i.setAttribute('type','file');i.setAttribute('accept','image/*');i.onchange=function(){var f=this.files[0];var r=new FileReader();r.onload=function(){var d='blobid'+(new Date()).getTime();var e=window.tinymce.activeEditor.editorUpload.blobCache;var g=r.result.split(',')[1];var h=e.create(d,f,g);e.add(h);b(h.blobUri(),{title:f.name});};r.readAsDataURL(f);};i.click();};}},s);R.apply(t,[S]);},renderer:"sap.ui.richtexteditor.RichTextEditorRenderer"});a.prototype.init=function(){R.prototype.init.call(this);this.setButtonGroups([{name:"font-style",visible:true,row:0,priority:10,buttons:["bold","italic","underline","strikethrough"]},{name:"undo",visible:true,row:0,priority:40,buttons:["undo","redo"]},{name:"insert",visible:false,row:0,priority:50,buttons:["image"]},{name:"link",visible:false,row:0,priority:60,buttons:["link","unlink"]}]);this.removePlugin("paste");this.removePlugin("lists");this.removePlugin("text-align");this.removePlugin("directionality");this.removePlugin("textpattern");};return a;});
