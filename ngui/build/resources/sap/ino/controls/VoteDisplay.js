/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/core/IconPool","sap/m/Text","sap/m/HBox","sap/ino/controls/LabelledIcon","sap/ui/core/format/NumberFormat","sap/ino/controls/VoteType"],function(C,I,T,H,L,N,V){"use strict";var i=N.getIntegerInstance({style:"short"});var f=N.getFloatInstance({decimals:1});var a=C.extend("sap.ino.controls.VoteDisplay",{metadata:{properties:{"likeVotes":{type:"int"},"negativeVotes":{type:"int"},"positiveVotes":{type:"int"},"starVoteCount":{type:"int"},"starVotes":{type:"float"},"score":{type:"float"},"type":{type:"string"},"isExpert":{type:"boolean",defaultValue:false}},aggregations:{"_like":{type:"sap.ino.controls.LabelledIcon",multiple:false,visibility:"hidden"},"_likeDislike":{type:"sap.m.HBox",multiple:false,visibility:"hidden"},"_star":{type:"sap.ino.controls.LabelledIcon",multiple:false,visibility:"hidden"},"_score":{type:"sap.m.Text",multiple:false,visibility:"hidden"}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_getLike:function(){var l=this.getAggregation("_like");if(!l){l=new L({iconUrl:this.getIsExpert()?"sap-icon://person-placeholder":I.getIconURI("heart","InoIcons"),label:i.format(this.getLikeVotes())});this.setAggregation("_like",l,true);}return l;},_getLikeDislike:function(){var l=this.getAggregation("_likeDislike");if(!l){var o=new L({iconUrl:this.getIsExpert()?"sap-icon://employee-approvals":I.getIconURI("thumbsup","InoIcons"),label:i.format(this.getPositiveVotes())}).addStyleClass("sapInoVoteDisplayLike");var d=new L({iconUrl:this.getIsExpert()?"sap-icon://employee-rejections":I.getIconURI("thumbsdown","InoIcons"),label:i.format(this.getNegativeVotes())}).addStyleClass("sapInoVoteDisplayDislike");l=new H({items:[o,d],displayInline:true});this.setAggregation("_likeDislike",l,true);}return l;},_getLikeDislikeLike:function(){return this._getLikeDislike().getItems()[0];},_getLikeDislikeDislike:function(){return this._getLikeDislike().getItems()[1];},_getStarLabel:function(){var l;var s=this.getStarVotes();var S=this.getStarVoteCount();if(s!==undefined&&s!==null&&S!==undefined&&S!==null){if(S!==1){l=this._oRB.getText("CTRL_VOTE_DISPLAY_FLD_STARS",[f.format(s),i.format(S)]);}else{l=this._oRB.getText("CTRL_VOTE_DISPLAY_FLD_STAR",[f.format(s),S]);}}return l;},_getStar:function(){var s=this.getAggregation("_star");if(!s){s=new L({iconUrl:this.getIsExpert()?"sap-icon://person-placeholder":"sap-icon://favorite",label:this._getStarLabel()});this.setAggregation("_star",s,true);}return s;},_getScore:function(){var s=this.getAggregation("_score");if(!s){s=new T({text:this.getScore()});this.setAggregation("_score",s,true);}return s;},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapInoVoteDisplay");r.writeClasses();if(c.getTooltip_Text()){r.writeAttributeEscaped("title",c.getTooltip_Text());}r.write(">");var v;switch(c.getProperty("type")){case V.TYPE_LIKE:v=c._getLike();break;case V.TYPE_LIKE_DISLIKE:v=c._getLikeDislike();break;case V.TYPE_STAR:v=c._getStar();break;default:break;}if(v){r.renderControl(v);}r.write("</div>");}});a.prototype.onAfterRendering=function(){this._getLike().data("ignoreExport",true);this._getLikeDislikeLike().data("ignoreExport",true);this._getLikeDislikeDislike().data("ignoreExport",true);this._getStar().data("ignoreExport",true);};a.prototype.bindProperty=function(k,b){C.prototype.bindProperty.apply(this,arguments);switch(k){case"likeVotes":this._getLike().bindProperty("label",b);break;case"positiveVotes":this._getLikeDislikeLike().bindProperty("label",b);break;case"negativeVotes":this._getLikeDislikeDislike().bindProperty("label",b);break;case"starVotes":this._getStar().bindProperty("label",b);break;case"score":this._getScore().bindProperty("text",b);break;default:break;}};a.prototype.setLikeVotes=function(v){this.setProperty("likeVotes",v);this._getLike().setLabel(i.format(v));};a.prototype.setStarVotes=function(v){this.setProperty("starVotes",v);this._getStar().setLabel(this._getStarLabel());};a.prototype.setStarVoteCount=function(v){this.setProperty("starVoteCount",v);this._getStar().setLabel(this._getStarLabel());};a.prototype.setPositiveVotes=function(v){this.setProperty("positiveVotes",v);this._getLikeDislikeLike().setLabel(i.format(v));};a.prototype.setNegativeVotes=function(v){this.setProperty("negativeVotes",v);this._getLikeDislikeDislike().setLabel(i.format(v));};return a;});
