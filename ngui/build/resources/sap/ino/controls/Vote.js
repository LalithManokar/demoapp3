/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
sap.ui.define(["sap/m/ButtonType","sap/ui/core/Control","sap/ui/core/IconPool","sap/m/HBox","sap/m/RatingIndicator","sap/m/ToggleButton","sap/ino/controls/VoteType"],function(B,C,I,H,R,T,V){"use strict";var a=C.extend("sap.ino.controls.Vote",{metadata:{properties:{"voteId":{type:"int"},"objectId":{type:"int"},"enabled":{type:"boolean"},"type":{type:"string"},"value":{type:"float"},"maxStar":{type:"int"},"tooltip":{type:"string"}},aggregations:{"_like":{type:"sap.m.ToggleButton",multiple:false,visibility:"hidden"},"_likeDislike":{type:"sap.m.HBox",multiple:false,visibility:"hidden"},"_star":{type:"sap.m.RatingIndicator",multiple:false,visibility:"hidden"}},events:{userVote:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_getLike:function(){var l=this.getAggregation("_like");var t=this;if(!l){l=new T({enabled:this.getProperty("enabled"),icon:I.getIconURI("heart","InoIcons"),press:function(){t._onButtonPressed();},pressed:this.getProperty("value")===1,tooltip:this.getProperty("tooltip"),type:B.Transparent});this.setAggregation("_like",l,true);}return l;},_getLikeDislike:function(){var l=this.getAggregation("_likeDislike");var t=this;if(!l){var L=new T({enabled:this.getProperty("enabled"),icon:I.getIconURI("thumbsup","InoIcons"),press:function(){t._onButtonPressed(true);},pressed:this.getValue()===1,tooltip:this.getProperty("tooltip")+'('+this._oRB.getText("VOTE_FLD_LIKE_THUMBS_UP_TOOLTIP")+')',type:B.Transparent});L.addStyleClass("sapInoVoteLikeDislikeLike");var d=new T({enabled:this.getProperty("enabled"),icon:I.getIconURI("thumbsdown","InoIcons"),press:function(){t._onButtonPressed();},pressed:this.getValue()===-1,tooltip:this.getProperty("tooltip")+'('+this._oRB.getText("VOTE_FLD_DISLIKE_THUMBS_DOWN_TOOLTIP")+')',type:B.Transparent});d.addStyleClass("sapInoVoteLikeDislikeDislike");l=new H({displayInline:true,items:[L,d],tooltip:this.getProperty("tooltip")});this.setAggregation("_likeDislike",l,true);}return l;},_getLikeDislikeLike:function(){return this._getLikeDislike().getItems()[0];},_getLikeDislikeDislike:function(){return this._getLikeDislike().getItems()[1];},_getStar:function(){var s=this.getAggregation("_star");var t=this;if(!s){s=new R({change:function(){t._onButtonPressed();},enabled:this.getEnabled(),maxValue:this.getMaxStar(),value:this.getValue(),tooltip:this.getProperty("tooltip")}).addStyleClass('starVote');this.setAggregation("_star",s,true);}return s;},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapInoVote");r.writeClasses();if(c.getTooltip_Text()){r.writeAttributeEscaped("title",c.getTooltip());}r.write(">");var v;switch(c.getProperty("type")){case V.TYPE_LIKE:v=c._getLike();break;case V.TYPE_LIKE_DISLIKE:v=c._getLikeDislike();break;case V.TYPE_STAR:v=c._getStar();break;default:break;}if(v){r.renderControl(v);}r.write("</div>");},_onButtonPressed:function(l){var v=this.getProperty("value");var t=this.getProperty("type");if(t){switch(t){case V.TYPE_LIKE:this.setProperty("value",(v===1)?0:1);break;case V.TYPE_LIKE_DISLIKE:var L=this._getLikeDislikeLike();var d=this._getLikeDislikeDislike();if(l&&L&&d){d.setPressed(false);L.setPressed(L.getPressed());this.setProperty("value",(L.getPressed())?1:0);}else if(L&&d){d.setPressed(d.getPressed());L.setPressed(false);this.setProperty("value",(d.getPressed())?-1:0);}break;case V.TYPE_STAR:var s=this._getStar();this.setProperty("value",s.getValue());break;default:break;}this.fireUserVote({voteId:this.getVoteId(),value:this.getValue(),objectId:this.getObjectId(),type:this.getType(),oldValue:v});}}});a.prototype.setEnabled=function(v){this.setProperty("enabled",v);if(this.getProperty("type")){switch(this.getProperty("type")){case V.TYPE_LIKE:this._getLike().setEnabled(v);break;case V.TYPE_LIKE_DISLIKE:this._getLikeDislikeLike().setEnabled(v);this._getLikeDislikeDislike().setEnabled(v);break;case V.TYPE_STAR:this._getStar().setEnabled(v);break;default:break;}}};a.prototype.setValue=function(v){this.setProperty("value",v);if(this.getProperty("type")){switch(this.getProperty("type")){case V.TYPE_LIKE:this._getLike().setPressed(v===1);break;case V.TYPE_LIKE_DISLIKE:this._getLikeDislikeLike().setPressed(v===1);this._getLikeDislikeDislike().setPressed(v===-1);break;case V.TYPE_STAR:this._getStar().setValue(v);break;default:break;}}};a.prototype.setType=function(v){this.setProperty("type",v);this.setValue(this.getValue());this.setEnabled(this.getEnabled());};a.prototype.setMaxStar=function(m){this.setProperty("maxStar",m);if(this.getProperty("type")===V.TYPE_STAR){this._getStar().setMaxValue(m);}};a.prototype.setTooltip=function(v){this.setProperty("tooltip",v);if(this.getProperty("type")){switch(this.getProperty("type")){case V.TYPE_LIKE:this._getLike().setTooltip(v);break;case V.TYPE_LIKE_DISLIKE:this._getLikeDislikeLike().setTooltip(v);this._getLikeDislikeDislike().setTooltip(v);break;case V.TYPE_STAR:this._getStar().setTooltip(v);break;default:break;}}else{this.setAggregation("_like",undefined);this.setAggregation("_likeDislike",undefined);this.setAggregation("_star",undefined);}};return a;});
