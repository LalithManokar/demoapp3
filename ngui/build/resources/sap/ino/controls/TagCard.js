/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
sap.ui.define(["sap/ui/core/Control","sap/m/Button","sap/m/ButtonType","sap/m/Label","sap/m/Link","sap/m/Text","sap/ui/core/TextAlign","sap/ui/core/Icon","sap/m/ToggleButton","sap/base/security/sanitizeHTML"],function(C,B,a,L,b,T,c,I,d,s){"use strict";var e=C.extend("sap.ino.controls.TagCard",{metadata:{properties:{"tagId":{type:"int"},"tagName":{type:"string"},"campaignCount":{type:"string"},"ideaCount":{type:"string"},"tagGroupId":{type:"int"},"campaignHref":{type:"sap.ui.core.URI"},"ideaHref":{type:"sap.ui.core.URI"}},aggregations:{"followPlaceholder":{type:"sap.ui.core.Control",multiple:false},_campaignLink:{type:"sap.m.Link",multiple:false,visibility:"hidden"},_ideaLink:{type:"sap.m.Link",multiple:false,visibility:"hidden"},_tagLabel:{type:"sap.m.Text",multiple:false,visibility:"hidden"}},events:{press:{},openCampaign:{},openIdea:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_getCampaignLink:function(){var t=this;var A="_campaignLink";var o=new b({href:this.getProperty("campaignHref"),text:this.getProperty("campaignCount"),enabled:this.getProperty("campaignCount")==="0"?false:true,press:function(E){E.preventDefault();t.fireOpenCampaign({tagId:t.getProperty("tagId"),tagName:t.getProperty("tagName"),tagGroupId:t.getProperty("tagGroupId")});}});this.setAggregation(A,o,true);return o;},_getIdeaLink:function(){var t=this;var A="_ideaLink";var i=new b({href:this.getProperty("ideaHref"),text:this.getProperty("ideaCount"),enabled:this.getProperty("ideaCount")==="0"?false:true,press:function(E){E.preventDefault();t.fireOpenIdea({tagId:t.getProperty("tagId"),tagName:t.getProperty("tagName"),tagGroupId:t.getProperty("tagGroupId")});}});this.setAggregation(A,i,true);return i;},_getTagIcon:function(){return new I({src:"sap-icon://tag"}).addStyleClass("log");},_follow:function(E){var t=this;t.fireFollow();},_getFeedIcon:function(){var t=this;return new I({src:"sap-icon://feed",press:function(E){t._follow();}}).addStyleClass("follow");},setTagName:function(t){if(t){this.setAggregation("_tagLabel",new T({maxLines:1}).setText(t).setTooltip(t));}this.setProperty("tagName",t);return this;},renderer:function(r,o){r.write("<div");r.writeControlData(o);r.addClass("container");r.writeClasses();r.write(">");r.write("<header");r.addClass("tagheader");r.writeClasses();r.write(">");r.write("<div");r.addClass("bio");r.writeClasses();r.write(">");r.write("<div");r.addClass("desc");r.writeClasses();r.write(">");r.write("<div>");var t=o.getAggregation("_tagLabel");if(t){r.renderControl(t);}r.write("</div>");r.write("</div>");r.write("</div>");r.write("</header>");r.write("<div");r.addClass("content");r.writeClasses();r.write(">");r.write("<div");r.addClass("data");r.writeClasses();r.write(">");r.write("<ul>");r.write("<li");r.addClass("cardleft");r.writeClasses();r.write(">");r.renderControl(o._getCampaignLink());r.write("<span class=\"tagContentText\">"+s(o._oRB.getText('CTRL_TAG_CARD_CAMPAIGN')));r.write("</span>");r.write("</li>");r.write("<li");r.addClass("split");r.writeClasses();r.write(">");r.write("</li>");r.write("<li");r.addClass("cardright");r.writeClasses();r.write(">");r.renderControl(o._getIdeaLink());r.write("<span class=\"tagContentText\">"+s(o._oRB.getText('CTRL_TAG_CARD_IDEA')));r.write("</span>");r.write("</li>");r.write("</ul>");r.write("</div>");r.write("</div>");r.write("<div");r.addClass("splitH");r.writeClasses();r.write(">");r.write("</div>");r.write("<div>");var f=o.getAggregation("followPlaceholder");if(f){r.renderControl(f);}r.write("</div>");r.write("</div>");},onAfterRendering:function(){this._initTabs();},_getTabs:function(){return this._tabs;},_initTabs:function(){this._tabs=[];if(this.getAggregation("_campaignLink")&&this.getAggregation("_campaignLink").$().length){this._tabs.push(this.getAggregation("_campaignLink").$()[0].id);}if(this.getAggregation("_ideaLink")&&this.getAggregation("_ideaLink").$().length){this._tabs.push(this.getAggregation("_ideaLink").$()[0].id);}if(this.getAggregation("followPlaceholder")){this._tabs.push(this.getAggregation("followPlaceholder").$().find("[tabindex=0],button")[0].id);}},_defaultOnKeyDown:function(E){if(C.prototype.onkeydown){C.prototype.onkeydown.apply(this,arguments);}},onkeydown:function(E){var t=this._getTabs();var u=this._incr;if(E.shiftKey||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){u=this._decr;}if(E.keyCode===jQuery.sap.KeyCodes.ESCAPE){this.getParent().focus();}else if(E.keyCode===jQuery.sap.KeyCodes.TAB||E.keyCode===jQuery.sap.KeyCodes.ARROW_DOWN||E.keyCode===jQuery.sap.KeyCodes.ARROW_RIGHT||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){var $=jQuery(":focus");var i=-1;if($&&$.length>0){i=t.indexOf($[0].id);i=u(i,t.length-1);this._focus(jQuery("#"+t[i]));E.preventDefault();E.stopPropagation();}else{this.getParent().focus();}}else{this._defaultOnKeyDown(E);}},_incr:function(v,m){v++;if(v>m){return 0;}return v;},_decr:function(v,m){v--;if(v<0){return m;}return v;},_focus:function(E){if(jQuery.type(E.focus)==="function"){setTimeout(function(){E.focus();},0);}}});return e;});
