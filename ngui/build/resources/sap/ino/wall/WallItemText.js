/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
jQuery.sap.declare("sap.ino.wall.WallItemText");(function(){"use strict";jQuery.sap.require("sap.ino.wall.WallItemBase");jQuery.sap.require("sap.ino.wall.util.Formatter");jQuery.sap.require("sap.ino.wall.TextEditor");jQuery.sap.require("sap.ino.wall.config.Config");jQuery.sap.require("sap.ino.wall.util.Helper");sap.ino.wall.WallItemBase.extend("sap.ino.wall.WallItemText",{metadata:{properties:{"description":{type:"string",group:"Misc",defaultValue:null}},aggregations:{"_scrollContainerDescription":{type:"sap.m.ScrollContainer",multiple:false,visibility:"hidden"},"_textAreaDescription":{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}}}});sap.ino.wall.WallItemText.prototype.init=function(){sap.ino.wall.WallItemBase.prototype.init.call(this);this.setResizable(true);};sap.ino.wall.WallItemText.prototype.setDescription=function(d){this.setProperty("description",d,true);if(sap.ino.wall.config.Config.getEnableRichtTextEditing()){this._getScrollContainerDescription().getContent()[0].setContent("<div class=\"sapMText\">"+sap.ino.wall.util.Helper.stripTags(d,"<div><br><b><strong><u><i><em><ol><ul><li><font>")+"</div>");}else{this._getScrollContainerDescription().getContent()[0].setText(d);}if(this.getParent()){this.getParent()._notifyItemChanged(this);}return this;};sap.ino.wall.WallItemText.prototype._onResize=function(s,d,D){var S=this._adjustTShirtSize();var e=this._getTextareaDescription();if(e instanceof sap.ino.wall.TextEditor){e.setControlDetails(S);}if(!jQuery.support.hasFlexBoxSupport||sap.ui.Device.browser.firefox||sap.ui.Device.browser.safari||sap.ui.Device.browser.internet_explorer&&sap.ui.Device.browser.version===10){if(!this.getH()){this.$().find(".front .sapMScrollCont").height("108px");}else{this.$().find(".front .sapMScrollCont").height("100%");}var f=this.$().find(".front .sapInoWallWITitle").outerHeight();this.$().find(".front .sapInoWallWITDescription").height(this.$().find(".front").height()-f-10);f=this.$().find(".back .sapInoWallWITitleEdit").outerHeight();this.$().find(".back .sapInoWallWITDescription").height(this.$().find(".back").height()-f-20);this.$().find(".back .sapInoWallWITDescription .sapInoWallTextEditorContent").height(this.$().find(".back").height()-f-this.$().children(".flippable").find(".sapInoWallTextEditorControls").outerHeight()-20);}this._adjustTShirtSize();};sap.ino.wall.WallItemText.prototype._getScrollContainerDescription=function(){var c=this.getAggregation("_scrollContainerDescription"),t;if(!c){if(sap.ino.wall.config.Config.getEnableRichtTextEditing()){t=new sap.ui.core.HTML(this.getId()+"-desc",{content:"<div class=\"sapMText\">"+sap.ino.wall.util.Helper.stripTags(sap.ino.wall.util.Formatter.escapeBindingCharacters(this.getDescription()),"<div><b><strong><u><i><em><ol><ul><li><font>")+"</div>",sanitizeContent:true});}else{t=new sap.m.Text(this.getId()+"-desc",{text:sap.ino.wall.util.Formatter.escapeBindingCharacters(this.getDescription())});}c=new sap.m.ScrollContainer(this.getId()+"-sc",{height:"100%",horizontal:false,vertical:true,content:t}).addStyleClass("sapInoWallScrollable");this.setAggregation("_scrollContainerDescription",c,true);}return c;};sap.ino.wall.WallItemText.prototype._getTextareaDescription=function(){var t=this,c=this.getAggregation("_textAreaDescription");if(!c){if(sap.ino.wall.config.Config.getEnableRichtTextEditing()){c=new sap.ino.wall.TextEditor(this.getId()+"-textEditor",{value:sap.ino.wall.util.Formatter.escapeBindingCharacters(this.getDescription()),change:function(e){t.setDescription(e.getParameter("value"));}}).addStyleClass("noflip").addStyleClass("sapInoWallWITDescriptionTA");}else{c=new sap.m.TextArea({value:sap.ino.wall.util.Formatter.escapeBindingCharacters(this.getDescription()),change:function(e){t.setDescription(e.getParameter("newValue"));}}).addStyleClass("sapInoWallWITDescriptionTA");}this.setAggregation("_textAreaDescription",c,true);}return c;};sap.ino.wall.WallItemText.prototype.formatToJSON=function(){var j=sap.ino.wall.WallItemBase.prototype.formatToJSON.call(this);j.description=this.getDescription();return j;};})();
