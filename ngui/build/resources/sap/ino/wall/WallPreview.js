/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
jQuery.sap.declare("sap.ino.wall.WallPreview");jQuery.sap.declare("sap.ino.wall.Helper");(function(){"use strict";jQuery.sap.require("sap.ino.wall.util.Formatter");jQuery.sap.require("sap.ino.wall.util.Helper");jQuery.sap.require("sap.ino.wall.DocumentType");jQuery.sap.require("sap.ino.wall.Wall");sap.ui.core.Control.extend("sap.ino.wall.WallPreview",{metadata:{properties:{"mode":{type:"string",group:"Misc",defaultValue:'wall'},"enabled":{type:"boolean",group:"Appearance",defaultValue:true},"numberOfItems":{type:"int",group:"Misc",defaultValue:0},"hits":{type:"int",group:"Misc",defaultValue:0},"lastUpdate":{type:"string",group:"Misc",defaultValue:null},"owner":{type:"string",group:"Misc",defaultValue:null},"showRemoveIcon":{type:"boolean",group:"Misc",defaultValue:false},"textOnly":{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{"_iconNew":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_iconTemplate":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_layoutFooter":{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},"_iconRemove":{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},associations:{"wall":{type:"sap.ino.wall.Wall",multiple:false}},events:{"press":{},"remove":{}}}});sap.ino.wall.WallPreview.M_EVENTS={'press':'press','remove':'remove'};sap.ino.wall.WallPreview.prototype.init=function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.wall");this.allowTextSelection(false);};sap.ino.wall.WallPreview.prototype.onAfterRendering=function(){if(this.getWallControl()){this._renderCanvas();}};sap.ino.wall.WallPreview.prototype.ontap=function(e){if(e.srcControl!==this.getAggregation("_iconRemove")){this.firePress();}};sap.ino.wall.WallPreview.prototype.getWallControl=function(){return sap.ui.getCore().byId(this.getWall());};sap.ino.wall.WallPreview.prototype.setWall=function(w){if(w instanceof sap.ino.wall.Wall){this.setAssociation("wall",w,true);this.setMode("Wall");}else{this.setMode("Error");}return this;};sap.ino.wall.WallPreview.prototype.setEnabled=function(e){this.setProperty("enabled",e,true);if(e){this.removeStyleClass("sapmUiWallPreviewDisabled");}else{this.addStyleClass("sapmUiWallPreviewDisabled");}return this;};sap.ino.wall.WallPreview.prototype.setShowRemoveIcon=function(s){this.setProperty("showRemoveIcon",s,true);return this;};sap.ino.wall.WallPreview.prototype._getShortHits=function(){var h=this.getHits();var H=h||1;if(h>1000){h=Math.floor(h/1000);H=this._oRB.getText("WALL_ITEMPREVIEW_VIEWS_K",[h]);}else if(h>1000000){h=Math.floor(h/1000000);H=this._oRB.getText("WALL_ITEMPREVIEW_VIEWS_M",[h]);}else if(h>1000000000){h=Math.floor(h/1000000000);H=this._oRB.getText("WALL_ITEMPREVIEW_VIEWS_B",[h]);}return H;};sap.ino.wall.WallPreview.prototype._renderCanvas=function(){var t=this,a=jQuery.sap.byId(this.getId()+"-canvas"),d=a[0],c,w=this.getWallControl(),b=w.getBackgroundImage(),B=w.getBackgroundColor(),i;var W="/sap/ino/ngui/sap/ino/assets/img/wall/bg/";if(d&&d.getContext){c=d.getContext("2d");i=new Image();i.onload=function(){c.drawImage(i,0,0,i.width,i.height,0,0,300,Math.max(200,300*i.height/i.width));if(t.getWallControl().getItems().length){t._renderCanvasItems(c,parseInt(d.getAttribute("width"),10),parseInt(d.getAttribute("height"),10));}};i.onerror=function(){if(t.getWallControl().getItems().length){t._renderCanvasItems(c,parseInt(d.getAttribute("width"),10),parseInt(d.getAttribute("height"),10));}};if(b){if(b.indexOf("http://")===0||b.indexOf("https://")===0){i.src=b;}else{var s=sap.ino.wall.util.Helper.getStandardImages();var p=$.grep(s,function(o){return o.file===b;});if(p.length>0&&p[0].preview){a.css("background-image","url("+W+p[0].preview+")");a.css("background-repeat","repeat");if(t.getWallControl().getItems().length){t._renderCanvasItems(c,parseInt(d.getAttribute("width"),10),parseInt(d.getAttribute("height"),10));}}else{i.src=W+b;}}}else if(B){a.css("background-color","#"+B);a.css("background-image",sap.ino.wall.util.Helper.addBrowserPrefix("linear-gradient(top, "+sap.ino.wall.util.Helper.shadeColor(B,10)+" 0%, "+sap.ino.wall.util.Helper.shadeColor(B,-10)+" 100%)"));if(t.getWallControl().getItems().length){t._renderCanvasItems(c,parseInt(d.getAttribute("width"),10),parseInt(d.getAttribute("height"),10));}}else{i.src="";}}return this;};sap.ino.wall.WallPreview.prototype._getItemStyle=function(i,c){var C=i.getMetadata()._sClassName.split(".").pop(),s={};s.shadowColor="rgba(50, 25, 0, 0.5)";switch(C){case"WallItemSticker":s.shape="Rect";switch(i.getColor()){case"Yellow":s.bgColor1="#fcf294";s.bgColor2="#f9e900";s.fontColor="#140F00";break;case"Pink":s.bgColor1="#e5b0e8";s.bgColor2="#d831cd";s.fontColor="#260822";break;case"Cyan":s.bgColor1="#87e0fd";s.bgColor2="#05abe0";s.fontColor="#001521";break;case"Green":s.bgColor1="#d2ff52";s.bgColor2="#91e842";s.fontColor="#0D1606";break;case"Orange":s.bgColor1="#ffa84c";s.bgColor2="#ff7b0d";s.fontColor="#1C0E01";break;case"Red":s.bgColor1="#ff3019";s.bgColor2="#d80404";s.fontColor="#190000";break;case"Rose":s.bgColor1="#f9d6d6";s.bgColor2="#ffb5b5";s.fontColor="#161210";break;case"Lavender":s.bgColor1="#c4c6ff";s.bgColor2="#9ba7db";s.fontColor="#15171E";break;case"Neutral":s.bgColor1="#ffffff";s.bgColor2="#efefef";s.fontColor="#1C1C1C";break;case"Black":s.bgColor1="#45484d";s.bgColor2="#000000";s.fontColor="#eeeeee";break;}s.borderColor=null;s.borderWidth=0;s.fontSize="30px";s.fontFace="Calibri";break;case"WallItemText":s.shape="Rect";s.bgColor1="#ffffff";s.bgColor2="#E5F5E1";s.borderColor="#89898";s.borderWidth=0;s.fontColor="#555555";break;case"WallItemVideo":s.shape="Rect";s.bgColor1="#131313";s.bgColor2="#1c1c1c";s.borderColor=null;s.borderWidth=0;s.fontColor="#ffffff";s.multiLineText=false;break;case"WallItemImage":s.shape="Rect";s.bgColor1="#e1e1e1";s.bgColor2="#f6f6f6";s.borderColor="#9e9e9e";s.borderWidth=4;s.fontColor="#555555";s.multiLineText=false;break;case"WallItemNote":s.shape="Rect";s.bgColor1="#e6f8fd";s.bgColor2="#b1d8f5";s.borderColor="#555555";s.borderWidth=4;s.fontColor="#0000EE";break;case"WallItemGroup":s.shape="Rect";s.borderWidth=3;s.fontColor="#ffffff";s.shadowColor="rgba(50, 25, 0, 0.1)";s.multiLineText=false;break;case"WallItemLink":s.shape="Circle";s.bgColor1="#dff6ff";s.bgColor2="#7bd5fc";s.borderColor="#3d5000";s.borderWidth=4;s.fontColor="#ffffff";s.multiLineText=false;break;case"WallItemPerson":s.shape="Circle";s.bgColor1="#cff1fc";s.bgColor2="#87e0fd";s.borderColor=null;s.borderWidth=0;s.fontColor="#555555";break;case"WallItemDocument":case"WallItemAttachment":s.shape="Rect";s.bgColor1="#f6f6f6";s.bgColor2="#ededed";s.borderColor="#cccccc";s.borderWidth=0;s.fontColor="#555555";s.multiLineText=false;break;case"WallItemLine":s.shape="Line";break;case"WallItemHeadline":s.shape="Headline";s.multiLineText=false;switch(i.getType()){case"Clear":s.bgColor1="rgba(235, 235, 235, 0.4)";break;case"Brag":s.bgColor1="#fceabb";s.bgColor2="#fbdf93";s.borderColor="#DD8200";s.borderWidth=1;break;case"Elegant":s.bgColor1="#7d7e7d";s.bgColor2="#0e0e0e";s.borderColor="#84731E";s.borderWidth=1;s.fontColor="#F4D538";break;case"Cool":s.bgColor1="#e4f5fc";s.bgColor2="#2ab0ed";s.borderColor="#0988BF";s.borderWidth=1;break;case"Simple":default:s.bgColor1="rgba(235, 235, 235, 0.8)";}if(!s.borderColor){s.borderColor="#cccccc";}if(!s.borderWidth){s.borderWidth=0;}if(!s.fontColor){s.fontColor="#232323";}break;case"WallItemSprite":s.shape="Circle";s.borderWidth=3;s.fontColor="#000000";s.fontSize="30px";s.multiLineText=false;break;case"WallItemArrow":s.shape="Arrow";break;default:}if(s.multiLineText===undefined){s.multiLineText=true;}return s;};sap.ino.wall.WallPreview.prototype._renderCanvasWord=function(c,x,y,a){var l=c.lineWidth,L=l,C=x,d=a-C,u=true;if(l<4){c.moveTo(x,y);c.lineTo(a,y);}else{c.lineWidth=Math.ceil(l/4);while(d>0){L=Math.min(d,l);c.moveTo(C,y+l/3*(u?1:-1));c.lineTo(C+L,y-L/3*(u?1:-1));C+=L-c.lineWidth/2;d=a-C;if(L!==l){d=0;}u=!u;}}c.stroke();c.lineWidth=l;};sap.ino.wall.WallPreview.prototype._renderLineText=function(c,x,y,a,b,t){var d=a-x;var e=b-y;c.save();c.textAlign="center";c.translate(x+d*0.5,y+e*0.5-5);c.rotate(Math.atan2(e,d));c.fillText(Array(t.length+1).join("."),0,0,Math.sqrt(d*d+e*e));c.restore();};sap.ino.wall.WallPreview.prototype._renderArrowHead=function(c,a,b,d,e,s,E){var r=0;var x=0;var y=0;if(E){r=Math.atan((e-b)/(d-a));r+=((d>a)?90:-90)*Math.PI/180;x=d;y=e;}else{r=Math.atan((e-b)/(d-a));r+=((d>a)?-90:90)*Math.PI/180;x=a;y=b;}c.save();c.beginPath();c.translate(x,y);c.rotate(r);c.moveTo(0,0);c.lineTo(10*s,20*s);c.lineTo(-10*s,20*s);c.closePath();c.restore();c.fill();};sap.ino.wall.WallPreview.prototype._renderDashedLine=function(c,x,y,a,b,d){if(d==undefined){d=2;}c.moveTo(x,y);var X=a-x,Y=b-y,e=Math.floor(Math.sqrt(X*X+Y*Y)/d),f=X/e,g=Y/e,q=0;while(q++<e){x+=f;y+=g;c[q%2===0?'moveTo':'lineTo'](x,y);}c[q%2===0?'moveTo':'lineTo'](a,b);};sap.ino.wall.WallPreview.prototype._renderCanvasItems=function(c,W,H){var o=this.getWallControl(),I=o.getItems(),d,s,B,f,e,g,k,l,m,n,u,L,p=10,S,q,r=1,t,D,v,O=p,z=p,A,F,C,E,G,J,K,M,N,x,y,w,h,P,Q,R,T,U,V,X,Y,Z,_,a1,b1,c1,d1,i=0,j=0;if(!W){W=300;}if(!H){H=200;}n=o._calculateBoundingBox();if(!n){return;}u=n[0];L=n[1];D=L.getX()-u.getX();v=L.getY()-u.getY();if(D!==0){S=(W-2*p)/D;q=(H-2*p)/v;r=Math.min(S,q);r=Math.max(0.1,r);r=Math.min(1,r);if(D*r<W){O=(W-D*r)/2.0;}if(v*r<H){z=(H-v*r)/2.0;}}A=4*r;function e1(a,b){if(a.getDepth()<b.getDepth()){return-1;}else if(a.getDepth()>b.getDepth()){return 1;}return 0;}I.sort(e1);for(;i<I.length;i++){d=I[i];s=this._getItemStyle(d,c);f=parseInt(d.getX(),10);e=parseInt(d.getY(),10);if(isNaN(f)||isNaN(e)||f<0||e<0){continue;}l=I[i].getW();m=I[i].getH();if(l){l=parseInt(l,10);}if(m){m=parseInt(m,10);}if(I[i]instanceof sap.ino.wall.WallItemVideo){if(!l){l=250;}if(!m){m=250;}}else{if(!l){l=150;}if(!m){m=150;}}l=l*r-2*s.borderWidth*r;m=m*r-2*s.borderWidth*r;g=O+Math.abs(f-u.getX())*r;k=z+Math.abs(e-u.getY())*r;F=12*r;if(s.shape==="Headline"){t=(d.getSize().substring(1)?4/(parseInt(d.getSize().substring(1),10)+3):1);l=l*t*1.8*Math.min(d.getTitle().length/3,1);m=m/3*t;F=F*t*1.5;s.shape="Rect";}if(s.shape==="Rect"){c.fillStyle=s.shadowColor;c.beginPath();c.rect(g+A,k+A,l,m);c.fill();if(s.bgColor2){B=c.createLinearGradient(0,k,0,k+m);B.addColorStop(0,s.bgColor1);B.addColorStop(1,s.bgColor2);c.fillStyle=B;}else{c.fillStyle=(d.getColor?d.getColor():s.bgColor1);}if(d instanceof sap.ino.wall.WallItemGroup){c.fillStyle=sap.ino.wall.util.Helper.transparentColor(c.fillStyle,30);}c.beginPath();c.rect(g,k,l,m);c.fill();if(d instanceof sap.ino.wall.WallItemGroup){c.fillStyle=(d.getColor?d.getColor():s.bgColor1);}if(s.borderWidth){c.strokeStyle=(d.getColor?sap.ino.wall.util.Helper.shadeColor(d.getColor(),-20):s.borderColor);c.lineWidth=s.borderWidth*r;c.stroke();}}else if(s.shape==="Circle"){c.fillStyle=s.shadowColor;c.beginPath();c.arc(g+l/2+A,k+m/2+A,Math.min(l,m)/2,0,2*Math.PI,false);c.fill();if(s.bgColor2){B=c.createLinearGradient(0,k,0,k+m);B.addColorStop(0,s.bgColor1);B.addColorStop(1,s.bgColor2);c.fillStyle=B;}else{c.fillStyle=(d.getColor?d.getColor():s.bgColor1);}c.beginPath();c.arc(g+l/2,k+m/2,Math.min(l,m)/2,0,2*Math.PI,false);c.fill();if(s.borderWidth){c.strokeStyle=(d.getColor?sap.ino.wall.util.Helper.shadeColor(d.getColor(),-20):s.borderColor);c.lineWidth=s.borderWidth*r;c.stroke();}}else if(s.shape==="Line"){C=W;c.beginPath();c.strokeStyle=d.getColor();c.lineWidth=d.getThickness()*r;switch(d.getStyle()){case"DASHED":C=c.lineWidth*3;break;case"DOTTED":C=c.lineWidth;break;case"SOLID":default:C=(d.getOrientation()==="HORIZONTAL"?W:H);break;}if(d.getOrientation()==="HORIZONTAL"){if(k>0&&k<H){this._renderDashedLine(c,0,k,W,k,C);c.stroke();}}else{if(g>0&&g<W){this._renderDashedLine(c,g,0,g,H,C);c.stroke();}}c.closePath();continue;}else if(s.shape==="Arrow"){var x=g;var y=k;var x1=O+Math.abs(d.getX1()-u.getX())*r;var y1=z+Math.abs(d.getY1()-u.getY())*r;var x2=O+Math.abs(d.getX2()-u.getX())*r;var y2=z+Math.abs(d.getY2()-u.getY())*r;C=Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2));c.beginPath();c.strokeStyle=d.getColor();c.fillStyle=d.getColor();c.lineWidth=d.getThickness()*r;switch(d.getStyle()){case"DASHED":C=c.lineWidth*3;break;case"DOTTED":C=c.lineWidth;break;case"SOLID":default:break;}this._renderDashedLine(c,x1,y1,x2,y2,C);c.stroke();c.closePath();if(d.getTitle()){this._renderLineText(c,x1,y1,x2,y2,d.getTitle());}if(d.getHeadStyle()=="START"||d.getHeadStyle()=="BOTH"){this._renderArrowHead(c,x1,y1,x2,y2,r,false);}if(d.getHeadStyle()=="END"||d.getHeadStyle()=="BOTH"){this._renderArrowHead(c,x1,y1,x2,y2,r,true);}continue;}E=g;G=k;J=l;K=m;M=10*r;switch(d.getMetadata()._sClassName.split(".").pop()){case"WallItemImage":c.fillStyle="#cccccc";c.beginPath();c.rect(g+M,k+M,l-2*M,m-M-35*r);c.fill();c.fillStyle="#eeeeee";c.beginPath();c.arc(g+l/2,k+(m-30*r)/2,Math.min(l,m)/4,0,2*Math.PI,false);c.fill();G+=m-40*r;K+=30*r;break;case"WallItemVideo":B=c.createLinearGradient(0,k,0,k+m);B.addColorStop(0,"#686868");B.addColorStop(1,"#3F3F3F");c.fillStyle=B;c.beginPath();c.rect(g+M,k+M,l-2*M,m-M-35*r);c.fill();c.fillStyle="#aaaaaa";c.beginPath();c.rect(g+l/3,k+l/3,l/4,35*r);c.fill();c.beginPath();c.moveTo(g+l*7/12,k+l/3+17.5*r);c.lineTo(g+l*7/12+17.5*r,k+l/3);c.lineTo(g+l*7/12+17.5*r,k+l/3+35*r);c.lineTo(g+l*7/12,k+l/3+17.5*r);c.fill();c.closePath();G+=m-40*r;K+=30*r;break;case"WallItemNote":N=s.borderWidth*r*0.5;x=g+M;y=k+M;c.fillStyle="#AECCE8";c.beginPath();c.rect(g+N,k+N,l-N*2,42*r-N);c.fill();c.fillStyle="#03AEEB";c.beginPath();c.moveTo(x,y);c.lineTo(x+l/3,y);c.lineTo(x+l/5,y+25*r);c.lineTo(x,y+25*r);c.lineTo(x,y);c.fill();c.closePath();c.lineWidth=F;c.beginPath();this._renderCanvasWord(c,x+l/3+M,y+M,g+l-M);c.closePath();G+=40*r;K-=40*r;break;case"WallItemLink":x=g+M;y=k+M;w=l-2*M;h=m-2*M;c.fillStyle="#b8f84e";c.strokeStyle="#3d5000";c.beginPath();c.moveTo(x+w*0.38,y+h);c.lineTo(x+w*0.63,y+h*0.62);c.lineTo(x+w*0.86,y+h*0.76);c.lineTo(x+w*0.82,y);c.lineTo(x+w*0.12,y+h*0.28);c.lineTo(x+w*0.33,y+h*0.42);c.lineTo(x+w*0.09,y+h*0.80);c.lineTo(x+w*0.38,y+h);c.fill();c.stroke();c.closePath();c.fillStyle="#709520";c.beginPath();c.rect(g,k+m/2+30*r,l,25*r);c.fill();c.strokeStyle="#3d5000";c.stroke();c.fillStyle="#87B52F";c.beginPath();c.rect(g,k+m/2+55*r,l,25*r);c.fill();c.strokeStyle="#3d5000";c.stroke();c.strokeStyle=s.fontColor;c.lineWidth=F;c.beginPath();this._renderCanvasWord(c,x,y+m/2+60*r,x+w);c.closePath();c.lineWidth=s.borderWidth*r;E+=M;G+=m/2+20*r;K=60*r-2*M;break;case"WallItemPerson":x=g+M;y=k+M;w=l-2*M;c.fillStyle="#cccccc";c.beginPath();c.arc(g+l/2,k+(l-30*r)/3,l/4,0,2*Math.PI,false);c.fill();c.fillStyle="#cccccc";c.beginPath();c.rect(g+M*3,k+M+m/2.5,l-6*M,m/2-35*r);c.fill();c.fillStyle="#cff1fc";c.beginPath();c.rect(g,k+m/2+30*r,l,50*r);c.fill();c.lineWidth=4*r;c.strokeStyle="#44D1FC";c.stroke();c.closePath();c.strokeStyle=s.fontColor;c.lineWidth=F;c.beginPath();this._renderCanvasWord(c,x,y+m/2+60*r,x+w);c.closePath();c.lineWidth=s.borderWidth*r;E+=M;G+=m/2+20*r;K=60*r-2*M;break;case"WallItemDocument":switch(d.getType()){case sap.ino.wall.DocumentType.Word:P="#1067C1";break;case sap.ino.wall.DocumentType.Excel:P="#52A039";break;case sap.ino.wall.DocumentType.PowerPoint:P="#EB671B";break;case sap.ino.wall.DocumentType.PDF:P="#DC1414";break;case sap.ino.wall.DocumentType.Zip:P="#FBC121";break;case sap.ino.wall.DocumentType.Text:P="#4CBDFF";break;case sap.ino.wall.DocumentType.Video:P="#8200E5";break;case sap.ino.wall.DocumentType.Misc:default:P="#bbbbbb";}c.beginPath();c.fillStyle=P;c.moveTo(g+l*3.85/12,k+l*2.85/12);c.lineTo(g+l*4.85/12,k+l*2.85/12);c.lineTo(g+l*4.85/12,k+l*1.85/12);c.fill();c.closePath();c.lineWidth=8*r;c.strokeStyle=P;c.moveTo(g+l*3.52/12,k+l*3/12);c.lineTo(g+l*3.52/12,k+l*7.5/12);c.lineTo(g+l*8.5/12,k+l*7.5/12);c.lineTo(g+l*8.5/12,k+l*6.78/12);c.moveTo(g+l*8.5/12,k+l*2.4/12);c.lineTo(g+l*8.5/12,k+l*1.45/12);c.lineTo(g+l*5.05/12,k+l*1.45/12);c.stroke();c.beginPath();c.arc(g+l*2/3,k+(l-36*r)/2,l/7,0,2*Math.PI,false);c.stroke();c.closePath();c.beginPath();c.lineWidth=4*r;c.strokeStyle=s.borderColor;c.moveTo(E+5*r,G+m-37*r);c.lineTo(E+J-5*r,G+m-37*r);c.stroke();c.closePath();G+=m-40*r;K+=30*r;break;case"WallItemAttachment":P="#bbbbbb";c.beginPath();c.fillStyle=P;c.moveTo(g+l*3.85/12,k+l*2.85/12);c.lineTo(g+l*4.85/12,k+l*2.85/12);c.lineTo(g+l*4.85/12,k+l*1.85/12);c.fill();c.closePath();c.lineWidth=8*r;c.strokeStyle=P;c.moveTo(g+l*3.52/12,k+l*3/12);c.lineTo(g+l*3.52/12,k+l*7.5/12);c.lineTo(g+l*8.5/12,k+l*7.5/12);c.lineTo(g+l*8.5/12,k+l*6.78/12);c.moveTo(g+l*8.5/12,k+l*2.4/12);c.lineTo(g+l*8.5/12,k+l*1.45/12);c.lineTo(g+l*5.05/12,k+l*1.45/12);c.stroke();c.beginPath();c.arc(g+l*2/3,k+(l-36*r)/2,l/7,0,2*Math.PI,false);c.stroke();c.closePath();c.beginPath();c.lineWidth=4*r;c.strokeStyle=s.borderColor;c.moveTo(E+5*r,G+m-37*r);c.lineTo(E+J-5*r,G+m-37*r);c.stroke();c.closePath();G+=m-40*r;K+=30*r;break;case"WallItemSprite":Q=Math.min(l,m);E+=M+(l-Math.min(l,m))/2;G+=M/2+(m-Math.min(l,m))/2;J=Q-2*M;K=Q-2*M;F=K/2;M=J/5;break;case"WallItemGroup":E=g+l/4;G=k-20*r;J=l/2;x=g+l/4+M;y=k+3*M;w=l/2-2*M;m=m-10*r;c.beginPath();c.rect(g+l/4,G,l-l/2,40*r);c.fill();c.lineWidth=4*r;c.stroke();c.closePath();}R=F*2;T=F*0.666;U=(d.getDescrption?d.getDescription():d.getTitle());V=U.split(" ");Y=Math.min(10,V.length);Z=0;_=M;j=0;c.strokeStyle=s.fontColor;c.lineWidth=F;c.beginPath();for(;j<Y;j++){if((Z+1)*((j===0?0:R)+F)+M>K){break;}X=Math.min(Math.max(V[j].length,3)*T,J-2*M);if(M+_+X>J){_=M;if(s.multiLineText){Z++;}else{break;}}this._renderCanvasWord(c,E+_,G+F+M+Z*(R+F),E+_+X,G+F+M+Z*(R+F));_+=X+T;}c.closePath();d1=I[i].getChilds();if(d1.length){if(d instanceof sap.ino.wall.WallItemGroup){c.strokeStyle="#aaaaaa";c.lineWidth=4*r;for(j=0;j<d1.length;j++){a1=k+M+parseInt(d1[j].getY(),10)*r;b1=g+parseInt(d1[j].getX(),10)*r;c1=Math.min(160*r,m-2*M-40*r);B=c.createLinearGradient(b1,a1,b1,a1+c1);B.addColorStop(0,"rgba(155, 155, 155, 0.5)");B.addColorStop(1,"rgba(80,80,80, 0.5)");c.fillStyle=B;c.beginPath();c.rect(b1,a1,c1,c1);c.fill();c.stroke();}}else{a1=k+20*r;b1=g+l-20*r;c1=Math.min(160*r,m-40*r);B=c.createLinearGradient(0,a1,0,k+c1);B.addColorStop(0,"rgba(155, 155, 155, 0.5)");B.addColorStop(1,"rgba(80,80,80, 0.5)");c.fillStyle=B;c.beginPath();c.rect(b1,a1,c1,c1);c.fill();c.strokeStyle="#aaaaaa";c.lineWidth=4*r;c.stroke();}}}};sap.ino.wall.WallPreview.prototype._getFooter=function(t,o){var a=this,m=this.getMode(),h,l,c=this.getAggregation("_layoutFooter");if(!c){c=new sap.ui.layout.VerticalLayout().addStyleClass("sapInoWallPreviewFooter");if(this.getMode()==="NewTemplate"){c.addStyleClass("sapInoWallPreviewFooterSingleCell");}this.setAggregation("_layoutFooter",c,true);if(a.getTextOnly()){c.addAggregation("content",new sap.m.Text({width:"100%",text:sap.ino.wall.util.Formatter.escapeBindingCharacters(t)}).addStyleClass("sapInoWallFooterTitle"),true);}else{c.addAggregation("content",new sap.m.Link({width:"100%",text:sap.ino.wall.util.Formatter.escapeBindingCharacters(t),press:function(){if(a.getMode()==="New"){a.firePress({"action":"New"});}return false;}}).addStyleClass("sapInoWallFooterTitleLink"),true);}c.addContent(new sap.m.Text({width:"100%",text:sap.ino.wall.util.Formatter.escapeBindingCharacters(o)}).addStyleClass("sapInoWallFooterText"),true);var H=new sap.ui.layout.HorizontalLayout();H.addAggregation("content",new sap.ui.core.Icon({src:"sap-icon://show",tooltip:this._oRB.getText("WALL_ITEMPREVIEW_VIEWS",[this.getHits()||1])}).addStyleClass("sapInoWallPreviewFooterViewsIcon"),true);H.addContent(new sap.m.Label({text:this._getShortHits(),tooltip:this._oRB.getText("WALL_ITEMPREVIEW_VIEWS",[this.getHits()||1])}).addStyleClass("sapInoWallPreviewFooterViews"),true);c.addContent(H,true);}else{c.getContent()[0].setText(t);}return c;};sap.ino.wall.WallPreview.prototype._getIconNew=function(){var t=this,c=this.getAggregation("_iconNew");if(!c){c=new sap.ui.core.Icon({src:"sap-icon://add",size:"3.5rem",width:(this.getMode()==="New"?"148px":"300px"),height:"200px",color:"#aaaaaa",press:function(e){t.firePress({"action":"New"});return false;}});this.setAggregation("_iconNew",c,true);}return c;};sap.ino.wall.WallPreview.prototype._getIconRemove=function(){var t=this,c=this.getAggregation("_iconRemove");if(!c){c=new sap.ui.core.Icon({src:"sap-icon://sys-cancel",tooltip:this._oRB.getText("WALL_ITEMPREVIEW_TOOLTIP_REMOVE"),press:function(e){e.preventDefault();e.cancelBubble();t.fireRemove();return false;}});c.addStyleClass("sapInoWallPreviewRemove");this.setAggregation("_iconRemove",c,true);}return c;};sap.ino.wall.WallPreview.prototype._getIconTemplate=function(){var t=this,c=this.getAggregation("_iconTemplate");if(!c){c=new sap.ui.core.Icon({src:"sap-icon://inspect",size:"3.5rem",width:"150px",height:"200px",color:"#aaaaaa",press:function(e){t.firePress({"action":"Template"});return false;}});this.setAggregation("_iconTemplate",c,true);}return c;};})();
