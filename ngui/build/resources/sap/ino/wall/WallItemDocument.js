/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
jQuery.sap.declare("sap.ino.wall.WallItemDocument");(function(){"use strict";jQuery.sap.require("sap.ino.wall.WallItemBase");jQuery.sap.require("sap.ino.wall.util.Formatter");jQuery.sap.require("sap.ino.wall.DocumentType");sap.ino.wall.WallItemBase.extend("sap.ino.wall.WallItemDocument",{metadata:{properties:{"type":{type:"sap.ino.wall.DocumentType",group:"Misc",defaultValue:sap.ino.wall.DocumentType.Misc},"description":{type:"string",group:"Misc",defaultValue:null}},aggregations:{"_icon":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_textAreaDescription":{type:"sap.m.TextArea",multiple:false,visibility:"hidden"},"_selectType":{type:"sap.m.Select",multiple:false,visibility:"hidden"},"_inputLink":{type:"sap.m.Input",multiple:false,visibility:"hidden"}}}});sap.ino.wall.WallItemDocument.prototype._getIcon=function(){var t=this,i=this.getAggregation("_icon"),I,s,c,a;switch(this.getType()){case sap.ino.wall.DocumentType.Word:s="85px";I=sap.ui.core.IconPool.getIconURI("doc-attachment");c="#1067C1";a="#1376D8";break;case sap.ino.wall.DocumentType.Excel:s="85px";I=sap.ui.core.IconPool.getIconURI("excel-attachment");c="#52A039";a="#5FB742";break;case sap.ino.wall.DocumentType.PowerPoint:s="95px";I=sap.ui.core.IconPool.getIconURI("ppt-attachment");c="#EB671B";a="#FF6D1E";break;case sap.ino.wall.DocumentType.PDF:s="85px";I=sap.ui.core.IconPool.getIconURI("pdf-attachment");c="#DC1414";a="#F41818";break;case sap.ino.wall.DocumentType.Zip:s="85px";I=sap.ui.core.IconPool.getIconURI("attachment-zip-file");c="#FBC121";a="#FFBD0A";break;case sap.ino.wall.DocumentType.Video:s="85px";I=sap.ui.core.IconPool.getIconURI("attachment-video");c="#8200E5";a="#9400FF";break;case sap.ino.wall.DocumentType.Text:s="85px";I=sap.ui.core.IconPool.getIconURI("attachment-text-file");c="#4CBDFF";a="#32B4FF";break;case sap.ino.wall.DocumentType.Misc:default:s="85px";I=sap.ui.core.IconPool.getIconURI("document");c="#bbbbbb";a="#cccccc";}if(sap.ui.Device.system.tablet){s=(parseInt(s,10)*1.7)+"px";}if(!i){i=new sap.ui.core.Icon({press:function(){var d=this.getDescription();if(!this._bMoving&&d){if(d&&d!=="http://"&&d!=="https://"&&d!=="file://"){var w=window.open(d,'_blank');w.opener=null;}else{this.setFlipped(true);}}}.bind(this)});i.addStyleClass("sapInoWallWIDIcon").addStyleClass("noflip");this.setAggregation("_icon",i,true);}if(i.getSrc()!==I){i.setSrc(I);i.setSize(s);i.setColor(c);i.setActiveColor(a);}if(i.getSrc()!==I){i.setSrc(I);i.setSize(s);i.setColor(c);i.setActiveColor(a);}return i;};sap.ino.wall.WallItemDocument.prototype._getSelectType=function(){var t=this,c=this.getAggregation("_selectType"),s=null,I,a,T=this.getType(),k=null,i=0;if(!c){c=new sap.m.Select(this.getId()+"-type",{width:"100%",change:function(e){t.setType(e.getParameter("selectedItem").getText());}}).addStyleClass("sapInoWallWIBSelect").addStyleClass("noflip").addEventDelegate({onsapenter:function(e){e.preventDefault();e.stopPropagation();}});for(k in sap.ino.wall.DocumentType){if(sap.ino.wall.DocumentType.hasOwnProperty(k)){I=new sap.ui.core.Item({key:k,text:k});c.addItem(I);if(T===k&&!s){s=I.getId();}}}c.setSelectedItem(s);this.setAggregation("_selectType",c,true);}else{a=c.getItems();for(;i<a.length;i++){if(a[i].getKey()===T){c.setSelectedItem(a[i]);break;}}}return c;};sap.ino.wall.WallItemDocument.prototype.setDescription=function(t,s){var m,f="";this.setProperty("description",t,true);t=this.getDescription();if(!s){m=/\.([0-9a-z]+)(?:[\?#]|$)/i.exec(t);if(m&&m.length>1){f=m[1].toLowerCase();}else{this.setType(sap.ino.wall.DocumentType.Misc);}switch(f){case"doc":case"docx":case"docm":case"dotx":case"dotm":this.setType(sap.ino.wall.DocumentType.Word);break;case"xls":case"xlsx":case"xlsm":case"xlsb":case"xltx":case"xltm":this.setType(sap.ino.wall.DocumentType.Excel);break;case"ppt":case"pptx":case"pptm":case"pot":case"potx":case"potm":this.setType(sap.ino.wall.DocumentType.PowerPoint);break;case"pdf":this.setType(sap.ino.wall.DocumentType.PDF);break;case"txt":this.setType(sap.ino.wall.DocumentType.Text);break;case"zip":case"7z":case"rar":case"gz":case"tar":this.setType(sap.ino.wall.DocumentType.Zip);break;case"avi":case"mp4":case"mpg":case"mov":case"wmv":this.setType(sap.ino.wall.DocumentType.Video);break;default:this.setType(sap.ino.wall.DocumentType.Misc);}}if(this.getParent()){this.getParent()._notifyItemChanged(this);}return this;};sap.ino.wall.WallItemDocument.prototype.setType=function(t){var d=jQuery.sap.domById(this.getId()+"-icon"),i,o=this.getType(),r;this.setProperty("type",t,true);if(t!==o&&d){i=this._getIcon();r=sap.ui.getCore().createRenderManager();r.renderControl(i);r.flush(d,true,false);r.destroy();}if(this.getParent()){this.getParent()._notifyItemChanged(this);}return this;};sap.ino.wall.WallItemDocument.prototype._getInputLink=function(){var t=this,c=this.getAggregation("_inputLink");if(!c){c=new sap.m.Input({value:sap.ino.wall.util.Formatter.escapeBindingCharacters(sap.ino.wall.util.Formatter.escapeNetworkPaths(this.getDescription())),placeholder:this._oRB.getText("WALL_ITEMDOCUMENT_PLACEHOLDER_LINK"),change:function(e){t.setDescription(e.getParameter("newValue"));}}).addStyleClass("sapInoWallWIDLinkEdit");this.setAggregation("_inputLink",c,true);}return c;};sap.ino.wall.WallItemDocument.prototype.formatToJSON=function(){var j=sap.ino.wall.WallItemBase.prototype.formatToJSON.call(this);j.type=this.getType();j.description=this.getDescription();return j;};})();
