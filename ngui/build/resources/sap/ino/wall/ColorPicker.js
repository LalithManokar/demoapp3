/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
jQuery.sap.declare("sap.ino.wall.ColorPicker");(function(){"use strict";jQuery.sap.require("sap.ino.wall.config.Config");sap.ui.core.Control.extend("sap.ino.wall.ColorPicker",{metadata:{publicMethods:["close","openBy","isOpen"],properties:{"color":{type:"string",group:"Misc",defaultValue:'#ffffff'},"colorInputActive":{type:"boolean",group:"Misc",defaultValue:true},"placement":{type:"sap.m.PlacementType",group:"Behavior",defaultValue:sap.m.PlacementType.Right},"zoomable":{type:"boolean",defaultValue:true},"autoClose":{type:"boolean",defaultValue:false}},aggregations:{"_popoverColorSelector":{type:"sap.m.Popover",multiple:false},"_colorPickerControl":{type:"sap.ino.controls.ColorPickerLite",multiple:false,visibility:"hidden"},"colorInputControl":{type:"sap.m.Input",multiple:false}},events:{"change":{}}}});sap.ino.wall.ColorPicker.M_EVENTS={'change':'change'};sap.ino.wall.ColorPicker.prototype.setColor=function(c){var p=this.getColor();this.setProperty("color",c,true);if(this.isOpen()&&p!=c){var C=this.getAggregation("_colorPickerControl");if(C){C.setColor(c);}}return this;};sap.ino.wall.ColorPicker.prototype._setColor=function(c){if(c.match(/NaN/)){return;}if(this.getColor()!==c){this.setProperty("color",c,true);this.fireChange({color:c});}this._getPopoverColorSelector().focus();};sap.ino.wall.ColorPicker.prototype.getPlacement=function(){return this._getPopoverColorSelector().getPlacement();};sap.ino.wall.ColorPicker.prototype.setPlacement=function(p){this._getPopoverColorSelector().setPlacement(p);return this;};sap.ino.wall.ColorPicker.prototype.isOpen=function(){var p=this.getAggregation("_popoverColorSelector");if(p&&p.isOpen()){return true;}return false;};sap.ino.wall.ColorPicker.prototype.openBy=function(c){if(sap.ino.wall.ColorPicker.INSTANCE){sap.ino.wall.ColorPicker.INSTANCE.close();}sap.ino.wall.ColorPicker.INSTANCE=this;this._getPopoverColorSelector().openBy(c);return this;};sap.ino.wall.ColorPicker.prototype.close=function(){if(sap.ino.wall.ColorPicker.INSTANCE){sap.ino.wall.ColorPicker.INSTANCE=null;}var p=this.getAggregation("_popoverColorSelector");if(p){p.close();}return this;};sap.ino.wall.ColorPicker.prototype._getPopoverColorSelector=function(){var t=this;var c=this.getAggregation("_colorPickerControl");if(!c){c=new sap.ino.controls.ColorPickerLite({color:t.getColor(),change:function(e){var v=e.getParameter("hashValue");if(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(v)){t._setColor(v);}},preview:false,showValueStateMessage:false,showHex:false});this.setAggregation("_colorPickerControl",c,true);}var p=this.getAggregation("_popoverColorSelector");if(!p){var P=new sap.m.Panel({content:[this.getAggregation("_colorPickerControl")]}).addStyleClass("sapInoWallColorPickerPopoverPanel");p=new sap.m.Popover(this.getId()+"-popoverColorSelector",{showHeader:false,placement:sap.m.PlacementType.Auto,contentWidth:'154px',verticalScrolling:false,horizontalScrolling:false,content:[P]}).addStyleClass("sapInoWallColorPickerPopover");p.setHorizontalScrolling(false);var o=p.onAfterRendering;p.onAfterRendering=function(){if(jQuery.type(o)==="function"){o.apply(this,arguments);}this.$().attr("tabindex","");};this.setAggregation("_popoverColorSelector",p,true);p.oPopup.attachOpened(function(){this.setAutoClose(t.getAutoClose());});}return p;};sap.ino.wall.ColorPicker.INSTANCE=null;})();
