sap.ui.define(["sap/ino/vc/commons/BaseController","sap/m/MessageBox","sap/ui/core/MessageType","sap/ui/Device","sap/ino/commons/application/Configuration"],function(B,M,a,D,C){"use strict";return B.extend("sap.ino.vc.app.App",{_iBusyDelay:1000,_mVisitedRoutes:{},onInit:function(){B.prototype.onInit.apply(this,arguments);var s=this.byId("systemMessage");s.attachClose(function(){s.data("msgClosed",true);this.getParent().getController()._oComponent.getRootController().byId("innerShell").removeStyleClass("sapInoInnoMgmtMShellMsg");});if(C.systemMessage()){s.setText(C.systemMessage());}else{s.data("msgClosed",true);s.setVisible(false);}},getPages:function(){var i=this.byId("innerShell");var I=i.getApp();return I.getPages();},getCurrentPage:function(){var i=this.byId("innerShell");var I=i.getApp();return I.getCurrentPage();},onBypassed:function(e){this.showMessage(a.ERROR,this.getModel("i18n").getResourceBundle().getText("NAVIGATION_EXP_UNKNOWN_TARGET"));},showMessage:function(e,m,t,o){var s=this._getSeverity(e,t);M.show(m,{icon:s.icon,title:s.title,actions:[M.Action.OK],onClose:o?o:undefined,styleClass:this.getDensityClass()});},showConfirmation:function(e,m,t,o){var s=this._getSeverity(e,t);M.confirm(m,{icon:s.icon,title:s.title,actions:[M.Action.OK,M.Action.CANCEL],onClose:o?o:undefined,styleClass:this.getDensityClass()});},showDataLossPopup:function(n){var t=this;var c=function(A){if(A===M.Action.OK){t.resetPendingChanges();n();}else{var v=t.getCurrentPage();if(v){var o=v.getController();if(o.cancelOperationAction){o.cancelOperationAction();}}}};this.showConfirmation(a.QUESTION,this.getText("COMMON_INS_DATALOSS"),this.getText("COMMON_TIT_DATALOSS"),c);},isNavigationAllowed:function(){var v=this.getCurrentPage();if(v){var c=v.getController();if(c.hasPendingChanges&&c.hasPendingChanges()){return false;}}return true;},isCloseAllowed:function(){if(!this.isNavigationAllowed()){return this.getText("COMMON_INS_DATALOSS");}},resetPendingChanges:function(){var v=this.getCurrentPage();if(v){var c=v.getController();if(c.resetPendingChanges){c.resetPendingChanges();}}},onBypassedNavigate:function(){var b=this._oBusyElement||this.getView();b.setBusy(false);b.setBusyIndicatorDelay(this._iBusyDelay);},onAfterNavigate:function(){var b=this._oBusyElement||this.getView();var t=this;setTimeout(function(){b.setBusy(false);b.setBusyIndicatorDelay(t._iBusyDelay);},500);},onBeforeNavigate:function(r){if(!this._oBusyElement){if(this.getView().getDomRef()){var m=jQuery(".sapInoInnoMgmtShell");if(m&&m.length>0){this._oBusyElement=sap.ui.getCore().getElementById(m.attr("id")+"-container");}this._oBusyElement=this._oBusyElement||this.getView();}}var b=this._oBusyElement||this.getView();if(!this._mVisitedRoutes[r]&&r){b.setBusyIndicatorDelay(0);this._mVisitedRoutes[r]=true;}b.setBusy(true);var c=this.getCurrentPage();if(c&&c.getController().onBeforeNavigateFrom){c.getController().onBeforeNavigateFrom();}},onNavigate:function(e){var f=e.getParameter("from");var F=f.getController();if(F.onNavigateFrom){F.onNavigateFrom(e);}var t=e.getParameter("to");var T=t.getController();if(T.onNavigateTo){T.onNavigateTo(e);}},_getSeverity:function(e,t){var s={title:"",icon:undefined};switch(e){case a.ERROR:s.title=t?t:this.getText("MESSAGE_TIT_ERROR");s.icon=M.Icon.ERROR;break;case a.INFORMATION:s.title=t?t:this.getText("MESSAGE_TIT_INFORMATION");s.icon=M.Icon.INFORMATION;break;case a.SUCCESS:s.title=t?t:this.getText("MESSAGE_TIT_SUCCESS");s.icon=M.Icon.SUCCESS;break;case a.QUESTION:s.title=t?t:this.getText("MESSAGE_TIT_QUESTION");s.icon=M.Icon.QUESTION;break;case a.WARNING:s.title=t?t:this.getText("MESSAGE_TIT_WARNING");s.icon=M.Icon.WARNING;break;default:s.title=t?t:this.getText("MESSAGE_TIT_NONE");s.icon=M.Icon.NONE;break;}return s;},openHelpScreen:function(t){var c=this.getOwnerComponent();if(!this._oHelp){this._oHelp=new sap.ui.core.mvc.XMLView({viewName:"sap.ino.vc.app.Help"});this._oHelp.setModel(c.getModel("i18n"),"i18n");this._oHelp.setModel(c.getModel("device"),"device");}this._oHelp.setModel(c.getModel("help"),"help");this._oHelp.getController().show(t?this.getModel("i18n").getResourceBundle().getText(t):undefined);}});});
