sap.ui.define(["sap/ino/vc/commons/BaseObjectController","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/UserSettings","sap/ino/commons/models/object/Attachment","sap/m/MessageToast","sap/ino/commons/models/core/ModelSynchronizer"],function(B,C,U,A,M,a){"use strict";return B.extend("sap.ino.vc.shell.Settings",{formatter:jQuery.extend({mailLanguageText:function(d,c){return d;}},B.prototype.formatter),onInit:function(){B.prototype.onInit.apply(this,arguments);this.setViewProperty("/EDIT",true);this.setViewProperty("/ATTACHMENT_UPLOAD_URL",A.getEndpointURL());this.aBusyControls=[this.byId("userSettings")];},setUserDataModel:function(u){this._oUserDataModel=u;},onBeforeRendering:function(){var u=C.getCurrentUser().USER_ID;var o=new U(u,{continuousUse:true,actions:["updateUserLocale"],readSource:{model:this.getDefaultODataModel()}});this.setObjectModel(o);this.bindDefaultODataModel(u);if(this._oUserDataModel){a.addAOInstanceDependency(o,this._oUserDataModel,function(b,d){if(b&&b.getProperty("/Settings")&&d){d.setProperty("/IMAGE_ID",b.getProperty("/Settings").TITLE_IMAGE_ID);}});}},getODataEntitySet:function(){return"Identity";},onFileUploaderChange:function(e){var f=e.getSource();var F=e.getParameter("files");f.setBusy(true);A.prepareFileUploader(f,F);},onFileUploaderComplete:function(e){var r=A.parseUploadResponse(e.getParameter("responseRaw"));var f=e.getSource();if(r){var o=this.getObjectModel();if(r.success){o.setUserImage({"ATTACHMENT_ID":r.attachmentId,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType});}else{M.show(this.getText("SETTINGS_MSG_USER_IMAGE_FAILED"));}}else{M.show(this.getText("SETTINGS_MSG_USER_IMAGE_ERROR"));}f.setBusy(false);f.clear();},onImageSettingClear:function(e){var o=this.getObjectModel();o.clearUserImage();var f=this.byId("imageSettingUploader");f.setValue(null);}});});
