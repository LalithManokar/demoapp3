<mvc:View
    controllerName="sap.ino.vc.blog.Display"
	xmlns="sap.m"
	xmlns:l="sap.ui.layout"
	xmlns:core="sap.ui.core"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:ino="sap.ino.controls"
    afterRendering="onAfterRendering"
	xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1">
	<Page 
	    id="blogDisplay"
	    class="sapInoBlogDisplay"
	    showFooter="{= ${view>/objectExists} &amp;&amp; (${object>/property/actions/publish/enabled} || ${object>/property/actions/unPublish/enabled} || ${object>/property/actions/update/enabled})}"
        app:aofSmartControl="true"
        app:aofModel="object"
        app:aofObject="sap.ino.xs.object.blog.Blog">
		<customHeader>
			<ino:ColorBar id="pageheader" backgroundColor="{path: 'object>CAMPAIGN_COLOR', formatter: '.formatter.color'}">
				<core:Fragment fragmentName="sap.ino.vc.commons.fragments.NavBackButton" type="XML" />
				<ToolbarSpacer/>
				<Link text="{object>CAMPAIGN_NAME}" press="onCampaignPressed" visible="{= ${object>CAMPAIGN_NAME} ? true : false }"/>
				<ToolbarSpacer/>
				<core:Fragment fragmentName="sap.ino.vc.commons.fragments.FullScreenButton" type="XML" />
			</ino:ColorBar>
		</customHeader>
		<content>
			<l:Grid  
			    class="sapInoBlogList sapInfoBlogDisplay"
		        defaultSpan="XL12 L12 M12 S12"
                visible="{view>/objectExists}">
				<Text class="sapInoBlogListTitle" text="{object>TITLE}" />
				<HBox class="sapInoBlogListSubTitle">
					<Label text="{:= ${i18n>BLOG_LIST_FLD_CREATED_BY_NAME}}" class="sapInoBlogListMarginEnd4"/>
					<Link text="{object>CREATED_BY_NAME}" class="sapInoBlogListSubTitleColor" href="javascript:void(0)" press="onOpenCreator"/>
					<Text visible="{=${object>STATUS_CODE} === 'sap.ino.config.BLOG_PUBLISHED'}" text="{path: 'object>PUBLISHED_AT', type: 'sap.ui.model.type.DateTime', formatOptions: { relative: false }}"/>
					<Text visible="{=${object>STATUS_CODE} !== 'sap.ino.config.BLOG_PUBLISHED'}" text="{path: 'object>CREATED_AT', type: 'sap.ui.model.type.DateTime', formatOptions: { relative: false }}"/>
				</HBox>
				<core:ExtensionPoint name="extension_details_top_left"/>
				<core:HTML 
            	    id="DESCRIPTION"  
                    content="{ path: 'object>DESCRIPTION', formatter: '.formatter.wrapHTML'}"
                    sanitizeContent="true"/>
				<core:ExtensionPoint name="extension_details_top_left"/>
				<List
                    id="BlogAttachments"
                    width="100%"
                    items="{ path : 'object>Attachments', sorter: [{ path: 'CREATED_AT', descending: true }], filters: { path: 'ROLE_TYPE_CODE', operator: 'EQ', value1: 'ATTACHMENT' }}"
                    growingScrollToLoad="false"
                    visible="{=!!${object>Attachments} &amp;&amp; ${object>Attachments}.length > 0}"
                    class="sapInoBlogAttachment">
					<CustomListItem>
						<VBox>
							<Image 
							    press="onImgPressed"
						        src="{ parts:[{path:'object>MEDIA_TYPE'}, {path:'object>ATTACHMENT_ID'}], formatter:'.formatter.previewUrl' }" 
						        visible="{=!!${ parts:[{path:'object>MEDIA_TYPE'}, {path:'object>ATTACHMENT_ID'}], formatter:'.formatter.previewUrl' }}" 
						        decorative="false" alt="{object>FILE_NAME}" class="sapMUCItemImage sapMPointer" />
							<core:Icon 
							    press="onIconPressed"
    							src="{ parts:[{path:'object>FILE_NAME'}], formatter:'.iconUrl' }" 
    							visible="{=!${ parts:[{path:'object>MEDIA_TYPE'}, {path:'object>ATTACHMENT_ID'}], formatter:'.formatter.previewUrl' }}"  
    							size="4.67rem"
    							useIconTooltip="false" class="sapMUCItemIcon">
							</core:Icon>
							<Link class="sapInoBlogmarginTop5" tooltip="{object>FILE_NAME}"  text="{object>FILE_NAME}" target="_blank" href="{ path:'object>ATTACHMENT_ID', formatter:'.formatter.downloadUrl' }" />
							<HBox class="sapInoBlogmarginTop5">
								<Label class="sapInoBlogmarginTop5 sapInoBlogListMarginEnd4" text="{:= ${i18n>BLOG_LIST_FLD_CREATED_BY_NAME}}" />
								<Link class="sapInoBlogmarginTop5" tooltip="{object>CREATED_BY_NAME}" text="{object>CREATED_BY_NAME}" href="javascript:void(0)" press="onOpenCreator"/>
							</HBox>
							<Label class="sapInoBlogmarginTop5" text="{ path:'object>CREATED_AT', type:'sap.ui.model.type.DateTime', formatOptions: {  relative: false}}" />
						</VBox>
					</CustomListItem>
				</List>
				<core:ExtensionPoint name="extension_details_top_left"/>
				<Table
				    class="sapInoBlogTags"
        		    visible="{=!!${object>Tags} &amp;&amp; ${object>Tags}.length > 0}">
					<columns>
						<Column width="2.5rem"></Column>
						<Column></Column>
					</columns>
					<items>
						<ColumnListItem>
							<cells>
								<Label 
                        		    text="{i18n>BLOG_OBJECT_TIT_TAGS}:" 
                        		    visible="{=!!${object>Tags} &amp;&amp; ${object>Tags}.length > 0}" />
								<Tokenizer 
                        			id="Tags" 
                        			class="sapBlogtag sapInoWrap" 
                        			tokens="{object>Tags}" 
                        			editable="false" 
                        		    visible="{=!!${object>Tags} &amp;&amp; ${object>Tags}.length > 0}">
									<tokens>
										<Token key="{object>TAG_ID}" text="{object>NAME}" editable="false" press="showPopupTagCard"/>
									</tokens>
								</Tokenizer>
							</cells>
						</ColumnListItem>
					</items>
				</Table>
				<core:ExtensionPoint name="extension_details_top_left"/>
				<mvc:XMLView viewName="sap.ino.vc.comment.Comment" type="XML" app:object_id="{object>InitRefObjectId}" app:modelObjectType="sap.ino.commons.models.object.BlogComment" />
			</l:Grid>
			<core:Fragment fragmentName="sap.ino.vc.commons.fragments.ObjectNotExists"  type="XML"/>
		</content>
		<footer>
			<OverflowToolbar visible="{= ${view>/objectExists} &amp;&amp; (${object>/property/actions/publish/enabled} || ${object>/property/actions/unPublish/enabled} || ${object>/property/actions/update/enabled})}">
				<content>
					<core:Fragment fragmentName="sap.ino.vc.commons.fragments.MessageLog" type="XML" />
					<ToolbarSpacer />
					<MenuButton
					    id="publishMenuButton"
					    visible="{=${object>STATUS_CODE} === 'sap.ino.config.DRAFT' &amp;&amp; ${object>/property/actions/publish/enabled}}"
    					text="{i18n>BLOG_OBJECT_BTN_PUBLISH_MAJOR_CHANGED}" 
    					buttonMode="Split" 
    					width="225px"
    					type="Default" 
    					class="sapMenumBlogPublish"
    					defaultAction="onPublish" 
    					useDefaultActionOnly="true">
						<menu>
							<Menu itemSelected="onPublishAction">
								<items>
									<MenuItem text="{i18n>BLOG_OBJECT_BTN_PUBLISH_MAJOR_CHANGED}"
        					                key="majorPublishSubmit" />
									<MenuItem text="{i18n>BLOG_OBJECT_BTN_PUBLISH_MINOR_CHANGED}" 
    										key="publishSubmit" />
								</items>
							</Menu>
						</menu>
					</MenuButton>
					<Button 
					    id="blogUnPublishBtn"
                        text="{i18n>BLOG_OBJECT_BTN_UNPUBLISHED}"
                        type="Default"
    					visible="{=${object>STATUS_CODE} !== 'sap.ino.config.DRAFT' &amp;&amp; ${object>/property/actions/unPublish/enabled}}"
                        press="onUnPublish" />
					<Button 
					    id="blogEditBtn"
                        text="{i18n>BLOG_OBJECT_BTN_EDIT}"
    					type="Accept" 
    					visible="{=${object>/property/actions/update/enabled}}"
                        press="onEdit" />
				</content>
			</OverflowToolbar>
		</footer>
	</Page>
</mvc:View>