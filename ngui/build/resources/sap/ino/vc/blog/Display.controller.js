sap.ui.define(["sap/ino/vc/commons/BaseObjectController","sap/ino/commons/models/object/Blog","sap/m/MessageToast","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration","sap/ino/commons/formatters/BaseFormatter","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/vc/commons/mixins/FollowMixin"],function(B,a,M,T,J,C,b,c,F){"use strict";return B.extend("sap.ino.vc.blog.Display",jQuery.extend({},T,c,F,{routes:["blog-display"],onInit:function(){B.prototype.onInit.apply(this,arguments);this.setViewProperty("/EDIT",false);},onRouteMatched:function(){B.prototype.onRouteMatched.apply(this,arguments);this.setHelp("CAMPAIGN_BLOG_MODIFY");},createObjectModel:function(o){var s={nodes:["Root"],actions:["modify","del","unPublish"],continuousUse:true,readSource:{model:this.getDefaultODataModel()}};var m=new a(o,s);m.setProperty("/InitRefObjectId",o);return m;},getODataEntitySet:function(){return"CampaignBlogsFull";},onEdit:function(){var o=this.getObjectModel();this.navigateTo("blog-edit",{id:o.getKey()});},onOpenCreator:function(e){var s=e.getSource();var i=s.getBindingContext("data").getProperty("CREATED_BY_ID");if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(s,i);},onCancel:function(){this.navigateBack();},onPublish:function(){this._executeAction("majorPublishSubmit");},onPublishAction:function(e){var i=e.getParameter("item");if(!i){return;}this._executeAction(i.getProperty("key")||"publishSubmit");},onUnPublish:function(){this._executeAction("unPublishSubmit");},onCampaignPressed:function(e){e.preventDefault();var i=this.getObjectModel().getProperty("/CAMPAIGN_ID");this.navigateTo("campaign",{id:i});},onImgPressed:function(e){sap.m.URLHelper.redirect(e.oSource.getProperty("src"),true);},onIconPressed:function(e){var i=e.oSource.oParent.getItems();if(i&&i.length>=2){sap.m.URLHelper.redirect(i[2].getProperty("href"),true);}},showPopupTagCard:function(e){this._bIsTokenPressed=true;if(!this._oPopover){this._oPopover=sap.ui.xmlfragment("sap.ino.vc.tag.fragments.TagCardPopover",this);this.getView().addDependent(this._oPopover);}var t=e.getSource();var p="/SearchTagsAll(searchToken='',ID="+t.getKey()+")";var d=this.getModel("data");var f=this;d.read(p,{async:true,success:function(D){var m=new J();m.setData(D);f._oPopover.setModel(m,"Tag");jQuery.sap.delayedCall(0,f,function(){f._oPopover.openBy(t);});}});},_executeAction:function(A){var o=this;o.resetClientMessages();o.executeObjectAction(A);},iconUrl:function(f){var e=this._splitFilename(f).extension;if(jQuery.type(e)==='string'){e=e.toLowerCase();}switch(e){case'.bmp':case'.jpg':case'.jpeg':case'.png':return"sap-icon://camera";case'.csv':case'.xls':case'.xlsx':return'sap-icon://excel-attachment';case'.doc':case'.docx':case'.odt':return'sap-icon://doc-attachment';case'.pdf':return'sap-icon://pdf-attachment';case'.ppt':case'.pptx':return'sap-icon://ppt-attachment';case'.txt':return'sap-icon://document-text';default:return'sap-icon://document';}},_splitFilename:function(s){var r={};var n=s.split('.');if(n.length===1){r.extension='';r.name=n.pop();return r;}r.extension='.'+n.pop();r.name=n.join('.');return r;}}));});
