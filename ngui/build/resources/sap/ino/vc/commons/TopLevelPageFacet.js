sap.ui.define(["sap/ui/Device","sap/ino/commons/application/Configuration","sap/ui/core/UIComponent"],function(D,C,U){"use strict";var T=function(){throw"Facet may not be instantiated directly";};T._onInit=function(){var t=this;this._oComponent=this.getOwnerComponent();this._oRouter=this._oComponent?this._oComponent.getRouter():undefined;if(this.routes&&this._oRouter){if(jQuery.type(this.routes)==="array"){jQuery.each(this.routes,function(i,r){t._oRouter.getRoute(r).attachMatched(t._onRouteMatched,t);});}else if(jQuery.type(this.routes)==="string"){t._oRouter.getRoute(this.routes).attachMatched(t._onRouteMatched,t);}}this._oNavEventDelegate={onBeforeShow:function(e){if(this.onBeforeShow){this.onBeforeShow(e);}if(!this._bOrientationHandlerAttached&&!D.system.desktop){this._bOrientationHandlerAttached=true;D.orientation.attachHandler(this._onOrientationChange,this);}},onAfterShow:function(e){if(this.onAfterShow){this.onAfterShow(e);}if(this.setViewFocus){this.setViewFocus();}},onBeforeHide:function(e){if(this.onBeforeHide){this.onBeforeHide(e);}},onAfterHide:function(e){if(this.onAfterHide){this.onAfterHide(e);}this._bOrientationHandlerAttached=false;D.orientation.detachHandler(this._onOrientationChange,this);}};this.getView().addEventDelegate(this._oNavEventDelegate,this);if(!this.getView().hasStyleClass("sapInoViewNoBackground")){this.getView().addStyleClass("sapUiGlobalBackgroundColor sapUiGlobalBackgroundColorForce");}if(this._oRouter){this._oRouter.attachRouteMatched(this._onAnyRouteMatched,this);this._oRouter.attachBypassed(t._onBypassed,t);}};T._onExit=function(){this.getView().removeEventDelegate(this._oNavEventDelegate);};T._onOrientationChange=function(e){if(this._onBaseOrientationChange){this._onBaseOrientationChange(e);}if(this.onOrientationChange){this.onOrientationChange(e);}};T.setBackgroundImages=function(b,s){var B=this._selectAppropriateBackgroundImageURL(b,s);if(B){this._setBackgroundImage(B);}};T.resetBackgroundImage=function(){var d=this.getDefaultBackgroundImageURL();if(d){this._setBackgroundImage(d);}else{this._removeBackgroundImage();}};T.getDefaultBackgroundImageURL=function(){var i=C.getTheme()==="THEME_HIGHCONTRAST";var b=C.getFrontofficeDefaultBackgroundImageURL(i);var s=C.getMobileSmallDefaultBackgroundImageURL();return this._selectAppropriateBackgroundImageURL(b,s);};T.updateBackgroundColor=function(s){function h(c){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null;}function a(j,l){j=String(j).replace(/[^0-9a-f]/gi,'');if(j.length<6){j=j[0]+j[0]+j[1]+j[1]+j[2]+j[2];}l=l||0;var k="#",c,i;for(i=0;i<3;i++){c=parseInt(j.substr(i*2,2),16);c=Math.round(Math.min(Math.max(0,c+(c*l)),220)).toString(16);k+=("00"+c).substr(c.length);}return k;}if(s){var o=this.getOwnerComponent();var r=o.getRootController();var S=r.byId("innerShell").getDomRef();var R=h(s);var b=a(s,0.7);var d=h(b);$(S).css("background-color","#"+s);if(s==="FFFFFF"){this.resetBackgroundImage();}else{$(S).css('background-image','none');var B="-webkit-linear-gradient(top, rgba("+R.r+","+R.g+","+R.b+","+"0.2) 70%, rgba("+R.r+","+R.g+","+R.b+","+"0.9) 100%)";var e="-ms-linear-gradient(top, #ffffff 10%, rgba("+R.r+","+R.g+","+R.b+","+"0.9) 100%)";var f="linear-gradient(to bottom, rgba("+d.r+","+d.g+","+d.b+","+"1) 30%, rgba("+R.r+","+R.g+","+R.b+","+"1) 90%)";var g="-moz-linear-gradient(top, #ffffff 10%, rgba("+R.r+","+R.g+","+R.b+","+"0.9) 100%)";$(S).css("background-image",B);$(S).css("background-image",e);$(S).css("background-image",f);$(S).css("background-image",g);}}else{this.resetBackgroundImage();}};T.reusePropertiesOnNavigation=function(s){return false;};T._selectAppropriateBackgroundImageURL=function(b,s){var i=b;if(D.system.phone){i=s;}if(jQuery.isNumeric(i)){return C.getAttachmentTitleImageDownloadURL(i);}else{return null;}};T._setBackgroundImage=function(u){var c=this.getOwnerComponent();var r=c.getRootController();var s=r.byId("innerShell").getDomRef();if($(s).css("background-image")!==u){if(u){$(s).css("background-image","url("+u+")");r.byId("app").setBackgroundOpacity(0.5);}else{$(s).css("background-image","");r.byId("app").setBackgroundOpacity(1);}}};T._removeBackgroundImage=function(){this._setBackgroundImage(undefined);};T._onRouteMatched=function(e){this._oComponent.setCurrentRoute(e.getParameter("name"));if(jQuery.type(this.onRouteMatched)==="function"){if(this.getViewProperty("/HIDE_SYS_MSG")===true||this._oComponent.getRootController().byId("systemMessage").data().msgClosed){this._oComponent.getRootController().byId("systemMessage").setProperty("visible",false);this._oComponent.getRootController().byId("innerShell").removeStyleClass("sapInoInnoMgmtMShellMsg");}else{this._oComponent.getRootController().byId("systemMessage").setProperty("visible",true);this._oComponent.getRootController().byId("innerShell").addStyleClass("sapInoInnoMgmtMShellMsg");}this.onRouteMatched(e);}if(!this.bKeepMessages){var m=sap.ui.getCore().getMessageManager();m.removeAllMessages();}if(!this.hasBackgroundImage||!this.hasBackgroundImage()){this.resetBackgroundImage();}this._oComponent.getRootController().onAfterNavigate();};T._onAnyRouteMatched=function(e){if(jQuery.type(this.onAnyRouteMatched)==="function"){this.onAnyRouteMatched(e);}};T._onBypassed=function(e){this._oComponent.setCurrentRoute("home");this._oComponent.getRootController().onBypassedNavigate();};return T;});
