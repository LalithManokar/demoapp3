sap.ui.define(["./BaseObjectController","sap/ui/Device","sap/ui/core/ListItem","sap/m/Token","sap/m/Tokenizer","sap/ui/core/MessageType"],function(B,D,L,T,a,M){"use strict";return B.extend("sap.ino.vc.commons.BaseObjectModifyController",{onInit:function(){B.prototype.onInit.apply(this,arguments);},onRouteMatched:function(e){var t=this;var r=e.getParameter("name");var R=e.getParameter("arguments");var v=this.getView();this.setObjectExists(true);v.setBusy(true);this.resetInputTypeValidations();var o;if(R.id){try{o=parseInt(R.id,10);}catch(E){jQuery.sap.log.error("Failed parsing key argument",E,"sap.ino.vc.commons.BaseObjectModify.controller");return;}}var O=this.getObjectModel();if(!O||!o||O.getKey()!==o){O=this.createObjectModel(o,r,R);}this.setObjectModel(O);O.getDataInitializedPromise().always(function(){v.setBusy(false);});O.getDataInitializedPromise().fail(function(){t.setObjectExists(false);if(t.preCheck){t.checkObjectExists(O.getObjectName(),O.getKey()||O.getInitKey());}});},onCancel:function(){this.navigateBack();},onDelete:function(e){var c=this;var d=e.getSource();var o=this.executeObjectAction("del",{messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});o.done(function(r){if(r&&r.confirmationCancelled===true){if(d&&jQuery.type(d.focus)==="function"){d.focus();}return;}c.navigateTo("home");});},hasPendingChanges:function(){var m=this.getObjectModel();if(m){return m.hasPendingChanges();}return false;},addMultiInputHandling:function(c,s){if(!c){return;}var t=this;var o=new T({key:"{object>"+s.token.key+"}",text:"{object>"+s.token.text+"}",editable:t._getEditable(s.token)});c.bindAggregation("tokens",{path:"object>"+s.childNodeName,template:o});var S=t._createSuggestHandler(s.suggestion);c.attachSuggest(S,t);var f=t._createTokenChangedHandler(s);c.attachTokenChange(f,t);},_getEditable:function(t){if(!t.hasOwnProperty("editable")){return true;}var s=typeof t.editable;if(s==="string"||(s==="object"&&t.editable.hasOwnProperty("path"))){return t.editable;}return!!t.editable;},_createTokenChangedHandler:function(s){return function(E){var t=E.getParameter("type");if(t===a.TokenChangeType.Removed||t===a.TokenChangeType.RemovedAll||(t===a.TokenChangeType.Added&&!E.getParameter("token").bApplicationCreated)){return;}var A=E.getParameter("addedTokens")||[E.getParameter("token")]||[];var r=E.getParameter("removedTokens")||[];var o=this.getObjectModel();A.forEach(function(b){var n={};var k=b.getKey();try{k=parseInt(b.getKey(),10);}catch(e){}n[s.token.key]=k;n[s.token.text]=b.getText();var c="add"+s.childNodeNameSingular;var m;if(o[c]){m=o[c].apply(o,[n]);}else{m=o.addChild(n,s.childNodeName);}if(m&&m.type===M.Error){b.destroy();}});r.forEach(function(b){if(!b.getBindingContext){return;}var c=b.getBindingContext("object");if(!c){return;}var C=c.getObject();o.removeChild(C);});};}});});
