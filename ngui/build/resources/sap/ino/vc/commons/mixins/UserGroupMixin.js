sap.ui.define(["sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast","sap/ino/commons/models/object/Group","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/communityUser"],function(P,M,G,J,F,a,C,c){"use strict";var U=function(){throw"Mixin may not be instantiated directly";};U._memberRequestQueue=[];U._bindUserGroupModel=function(V){var b=V||this.getView();var p=C.getBackendRootURL()+"/sap/ino/xs/rest/common/public_user_group.xsjs";var g=new J(p);b.setModel(g,"USER_GROUPS");return g;};U.onSearchUserGroup=function(e){var i=e.getSource();var t=i&&i.getParent();var b=t&&t.getParent();var s=e.getParameter('query');var d=new F([new F('GROUP_NAME',a.Contains,s),new F('DESCRIPTION',a.Contains,s)]);b.getBinding('rows').filter(d,"searchGroup");this.reBindSelectedData(b);};U.selectedNoneGroup=function(e){var s=e.getParameters().selected;var t=s?'RowOnly':'Row';var b=e.getSource();var d=b&&b.getParent();d.setSelectionBehavior(t);d.setEditable(!s);};U.putGroupSelected=function(t,v){if(!t){return false;}var b=t;var d=v||false;var e=b.getModel('USER_GROUPS').getData();var s=e.SELECTED_NONE||false;var n=e.noneGroupID[0].GROUP_ID;var f=b.getSelectedIndices();var u=C.getCurrentUser().USER_ID;var g={keys:[],parameters:[]};if(!s){for(var i=0;i<f.length;i++){g.keys.push(b.getContextByIndex(f[i]).getObject().GROUP_ID);}}else{g.keys.push(n);}if(!g.keys.length&&d){M.show(this.getText('USER_GROUP_SELECT_ERROR'));return false;}return this.createUserModel(u).assignGroups(g);};U.reBindSelectedData=function(t){var b=t;var d=b.getModel('USER_GROUPS').getData();var r=d.total;var n=d.noneGroupID&&d.noneGroupID.length&&d.noneGroupID[0];var e=b.getBinding('rows').getContexts(0,r);var s=this.getModel('identityData>/groups').getData();b.setSelectionBehavior('Row');b.setEditable(true);if(s&&s.length&&n&&s[0].GROUP_ID===n.GROUP_ID){b.getExtension()[0].setSelected(true);b.setSelectionBehavior('RowOnly');b.setEditable(false);b.setSelectedIndex(-1);}if(s&&e){for(var i=0;i<s.length;i++){for(var x=0;x<e.length;x++){if(s[i].GROUP_ID===e[x].getObject().GROUP_ID){b.addSelectionInterval(x,x);}}}}};U.createUserModel=function(u){var s={readSource:{model:this.getDefaultODataModel()}};return new c(u,s);};U.transGroupVisible=function(v){return!!v;};U.getMemberGroups=function(){var p=C.getBackendRootURL()+"/sap/ino/xs/rest/common/group.xsjs";var u=C.getCurrentUser().USER_ID;return $.ajax({url:p,type:'GET',data:{id:u}});};U.cantClose=function(){return false;};return U;});
