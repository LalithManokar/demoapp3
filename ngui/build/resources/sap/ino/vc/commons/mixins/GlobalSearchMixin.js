sap.ui.define(["sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration"],function(P,M,J,C){var G=function(){throw"Mixin may not be instantiated directly";};var o={'search':{key:'search',value:'CTRL_GLOBAL_SEARCH_ALL'},'campaignlist':{key:'campaignlist',value:'CTRL_GLOBAL_SEARCH_CAMPAIGNS'},'campaignlistvariant':{key:'campaignlistvariant',value:'CTRL_GLOBAL_SEARCH_CAMPAIGNS'},'idealist':{key:'idealist',value:'CTRL_GLOBAL_SEARCH_IDEAS'},'idealistbycompany':{key:'idealistbycompany',value:C.getGroupConfiguration().DISPLAY_LABEL,bNotFormatter:true},'idealistvariant':{key:'idealistvariant',value:'CTRL_GLOBAL_SEARCH_IDEAS'},'peoplelist':{key:'peoplelist',value:'CTRL_GLOBAL_SEARCH_USERS'},'peoplelistvariant':{key:'peoplelistvariant',value:'CTRL_GLOBAL_SEARCH_USERS'},'walllist':{key:'walllist',value:'CTRL_GLOBAL_SEARCH_WALLS'},'walllistvariant':{key:'walllistvariant',value:'CTRL_GLOBAL_SEARCH_WALLS'},'taglist':{key:'taglist',value:'CTRL_GLOBAL_SEARCH_TAGS'},'taglistvariant':{key:'taglistvariant',value:'CTRL_GLOBAL_SEARCH_TAGS'},'campaign':{key:'campaign',value:'CTRL_GLOBAL_SEARCH_CURRENT_CAMPAIGN'},'searchcategory':{key:'searchcategory',value:'CTRL_GLOBAL_SEARCH_CURRENT_CAMPAIGN'},'campaign-idealist':{key:'campaign-idealist',value:'CTRL_GLOBAL_SEARCH_CAMPAIGN_IDEAS'},'campaign-idealistvariant':{key:'campaign-idealistvariant',value:'CTRL_GLOBAL_SEARCH_CAMPAIGN_IDEAS'},'campaign-idealistbycompany':{key:'campaign-idealistbycompany',value:C.getGroupConfiguration().DISPLAY_LABEL,bNotFormatter:true},'campaign-bloglist':{key:'campaign-bloglist',value:'CTRL_GLOBAL_SEARCH_CAMPAIGN_BLOGS'},'campaign-bloglistvariant':{key:'campaign-bloglistvariant',value:'CTRL_GLOBAL_SEARCH_CAMPAIGN_BLOGS'},'bloglist':{key:'bloglist',value:'CTRL_GLOBAL_SEARCH_BLOGS'},'bloglistvariant':{key:'bloglistvariant',value:'CTRL_GLOBAL_SEARCH_BLOGS'}};var s=[o.search,o.campaignlist,o.idealist,o.peoplelist,o.walllist,o.taglist];var a={ALL:'all',CAMPAIGN:'campaign'};var b={ALL:'all',MANAGE:'manage'};G.setCategroyData=function(){var c=this.getOwnerComponent().getModel('search');if(c){if(C.getSystemSetting("sap.ino.config.PEOPLE_MENU_FOR_ALL_ACTIVE")!=="1"){this._removeCategory(o.peoplelist.key);}c.setProperty('/category',s);}};G.listenRouteMatch=function(){var c=this;this.getOwnerComponent().getRootView().attachEvent('routeMatchedEvent',function(e){var d=e.getParameters().name;var f=this.getModel('search').getProperty('/selectedCategory');var g=$.extend({},e.getParameters().arguments);c._handleSearchRule(d,g,f);});};G._handleSearchRule=function(k,c,d){var e=this;var f=e.getOwnerComponent().getModel('search');var p=c;var g=(k==="idea-display"?o.campaign.key:k);var u=this.getOwnerComponent().getModel("component").getProperty("/SHOW_BACKOFFICE");var h=C.getGroupConfiguration().ENABLE_GROUP_VIEW;if(!u||!h){this._removeCategory(o['campaign-idealistbycompany'].key);this._removeCategory(o.idealistbycompany.key);d=g;}else if(u&&h){if(g==='campaign-idealistvariant'||g==='campaign-idealist'){this._addCategory(o['campaign-idealistbycompany']);this._removeCategory(o.idealistbycompany.key);d=d!=='campaign-idealistbycompany'?g:d;}else if(g==='idealistvariant'||g==='idealist'){this._addCategory(o.idealistbycompany);this._removeCategory(o['campaign-idealistbycompany'].key);d=d!=='idealistbycompany'?g:d;}else if(g==='home'){this._addCategory(o.idealistbycompany);this._removeCategory(o['campaign-idealistbycompany'].key);d=g;}else{this._removeCategory(o['campaign-idealistbycompany'].key);this._removeCategory(o.idealistbycompany.key);d=g;}}switch(g){case o.campaignlistvariant.key:this._replaceKey([o.campaignlist.key],o.campaignlistvariant.key);break;case o.campaignlist.key:this._replaceKey([o.campaignlistvariant.key],o.campaignlist.key);break;case o.idealistvariant.key:this._replaceKey([o.idealist.key],o.idealistvariant.key);break;case o.idealist.key:this._replaceKey([o.idealistvariant.key],o.idealist.key);break;case o.campaign.key:this._addCategory(o.campaign);break;case o.searchcategory.key:this._addCategory(o.searchcategory);break;case o.walllist.key:this._replaceKey([o.walllistvariant.key],o.walllist.key);break;case o.walllistvariant.key:this._replaceKey([o.walllist.key],o.walllistvariant.key);break;case o.taglist.key:this._replaceKey([o.taglistvariant.key],o.taglist.key);break;case o.taglistvariant.key:this._replaceKey([o.taglist.key],o.taglistvariant.key);break;case o.peoplelist.key:this._replaceKey([o.peoplelistvariant.key],o.peoplelist.key);break;case o.peoplelistvariant.key:this._replaceKey([o.peoplelist.key],o.peoplelistvariant.key);break;case o['campaign-idealist'].key:this._addCategory(o['campaign-idealist']);break;case o['campaign-idealistvariant'].key:this._addCategory(o['campaign-idealistvariant']);break;case o['campaign-bloglist'].key:this._addCategory(o['campaign-bloglist']);break;case o['campaign-bloglistvariant'].key:this._addCategory(o['campaign-bloglistvariant']);break;case o.bloglist.key:this._addCategory(o.bloglist);break;case o.bloglistvariant.key:this._addCategory(o.bloglistvariant);break;default:g=this._getSelectedCate(k,g);break;}if(g!==o.campaign.key){this._removeCategory(o.campaign.key);}if(g!==o.searchcategory.key){this._removeCategory(o.searchcategory.key);}if(g!==o['campaign-idealist'].key){this._removeCategory(o['campaign-idealist'].key);}if(g!==o['campaign-idealistvariant'].key){this._removeCategory(o['campaign-idealistvariant'].key);}if(g!==o['campaign-bloglist'].key){this._removeCategory(o['campaign-bloglist'].key);}if(g!==o['campaign-bloglistvariant'].key){this._removeCategory(o['campaign-bloglistvariant'].key);}if(g!==o.bloglist.key){this._removeCategory(o.bloglist.key);}if(g!==o.bloglistvariant.key){this._removeCategory(o.bloglistvariant.key);}if(k!=="idea-display"){f.setProperty('/searchAguments',p);}if(d==='idealistbycompany'||d==='campaign-idealistbycompany'){f.setProperty('/selectedCategory',d);}else{f.setProperty('/selectedCategory',g);}};G._getParams=function(k,p){if(k==="idea-display"){return o.campaign.key;}return p;};G._getSelectedCate=function(k,c){if(k==="idea-display"){return o.campaign.key;}return o[k]?c:o.search.key;};G._replaceKey=function(k,r){var c=this._findCategory(k);if(!c.value||!o[r]){return false;}s[c.index]=o[r];};G._findCategory=function(k){var r={};for(var i=0;i<s.length;i++){if(~k.indexOf(s[i].key)){r.value=s[i];r.index=i;break;}}return r;};G._addCategory=function(c){if(!c||!c.key||!c.value){return false;}var r=this._findCategory([c.key]);if(r.value){return false;}s.unshift(c);};G._removeCategory=function(k){var r=this._findCategory([k]);if(!r.value){return false;}s.splice(r.index,1);};G._handleSearchNavgate=function(k,d){var c=o[d.category]?d.category:o.search.key;if(!d.param.variant&&c==="idealistvariant"){c="idealist";}var q=$.extend({},d.param['?query']);var u=this.getOwnerComponent().getModel("component").getProperty("/SHOW_BACKOFFICE");var e=u?b.MANAGE:b.ALL;var n={query:q,variant:d.param.variant||e};if(k){n.query.search=k;}if(!k&&!$.isEmptyObject(n.query)){delete n.query.search;}if(!k&&$.isEmptyObject(n.query)){return false;}if(n.query.type){delete n.query.type;}if(n.query.id){delete n.query.id;}switch(c){case o.searchcategory.key:$.extend(n,{query:{type:a.CAMPAIGN,id:d.param['?query'].id,search:k||'',managed:0}});break;case o.campaign.key:c=o.searchcategory.key;$.extend(n,{query:{type:a.CAMPAIGN,id:d.param.id,search:k||'',managed:0}});break;case o['campaign-bloglist'].key:case o['campaign-bloglistvariant'].key:case o['campaign-idealistvariant'].key:case o['campaign-idealist'].key:case o['campaign-idealistbycompany'].key:$.extend(true,n,{id:d.param.id});break;case o.search.key:$.extend(n,{query:{type:a.ALL,search:k||'',managed:Number(u||false)}});break;default:$.extend(true,n,{query:{search:k||''}});break;}if(c==='idealistbycompany'){if(d.param.variant){c='idealistvariant';}else{c='idealist';}}else if(c==='campaign-idealistbycompany'){if(d.param.variant){c='campaign-idealistvariant';}else{c='campaign-idealist';}}this.getOwnerComponent().navigateTo(c,n);};G.onSearch=function(e){var p=e.getParameters();var c=window.encodeURIComponent(p.search);if(p.search&&p.category&&p.param&&(p.param.variant==='all'||p.param.variant==='manage')){p.param['?query']=p.param['?query']||{};p.param['?query'].sort="SEARCH_SCORE DESC";}else if(p.param&&p.param['?query']){p.param['?query'].sort="";}this._handleSearchNavgate(c,p);};return G;});
