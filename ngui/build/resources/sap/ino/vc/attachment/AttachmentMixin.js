sap.ui.define(["sap/ino/commons/application/Configuration","sap/m/UploadCollectionParameter","sap/ino/commons/models/object/Attachment","sap/m/MessageToast"],function(C,U,A,M){"use strict";var a=function(){throw"Mixin may not be instantiated directly";};a._attachmentMixinInit=function(s){this._attachmentMixinSetting=s;var o=this.byId(this._attachmentMixinSetting.attachmentId);var b=this.getView().byId(this._attachmentMixinSetting.attachmentId);if(!o.getUploadEnabled()){o.addStyleClass("sapInoAttachmentUploadInvisible");}b.addEventDelegate({onAfterRendering:jQuery.proxy(function(){this.setAccessibility();},this)});};a.attachmentMixinOnChange=function(e){var u=e.getSource();var c=new U({name:"x-csrf-token",value:C.getXSRFToken()});u.addHeaderParameter(c);};a.attachmentMixinonFileDeleted=function(e){var i=e.getParameter("item");var o=this.getModel("object");o.removeAttachment(parseInt(i.getDocumentId(),10));this._attachmentMixinSetting.updateObject(o);};a.attachmentMixinonBeforeUploadStarts=function(e){var c=new U({name:"unicode_filename",value:A.stringToUnicode(e.getParameter("fileName"))});e.getParameters().addHeaderParameter(c);};a.attachmentMixinonUploadComplete=function(e){var t=this;var o=this.getModel("object");var f=e.getParameter("files");if(f.length>0){var E=false;f.forEach(function(F){var r=A.parseUploadResponse(F.responseRaw);o.getMessageParser().parse(r);if(r){if(r.success){E=t._attachmentMixinSetting.uploadSuccess(o,r);}else{M.show(t.getText("OBJECT_MSG_ATTACHMENT_FAILED"));E=true;}}else{M.show(t.getText("OBJECT_MSG_ATTACHMENT_ERROR"));E=true;}});if(E){var u=this.getView().byId(this._attachmentMixinSetting.attachmentId);u.aItems=[];u.rerender();}}};a.setAccessibility=function(){var v=this.getView();var e=v.byId(this._attachmentMixinSetting.attachmentId).$();var i=e.find('.sapMListNoData');var l=e.find('.sapMListModeNone ');if(i.length){l.hide();l.siblings().attr('tabindex','-1');}};return a;});
