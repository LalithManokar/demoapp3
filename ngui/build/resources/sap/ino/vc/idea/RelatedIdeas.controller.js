sap.ui.define(["sap/ino/vc/commons/BaseObjectController","sap/ino/vc/commons/BaseListController","sap/ino/commons/application/Configuration","sap/ui/Device","sap/ino/vc/idea/mixins/DuplicateActionMixin","sap/m/GroupHeaderListItem","sap/ino/commons/models/object/Idea","sap/ui/model/json/JSONModel","sap/ino/commons/formatters/ObjectListFormatter","sap/ui/model/Sorter","sap/m/Button","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(B,a,C,D,b,G,I,J,O,S,c,V,F,d,e,f){"use strict";return B.extend("sap.ino.vc.idea.RelatedIdeas",jQuery.extend({},b,V,F,d,{formatter:O,onInit:function(){B.prototype.onInit.apply(this,arguments);this._sResizeSimList=this.attachListControlResized(this.byId("idealist-similar"));this._sResizeRelList=this.attachListControlResized(this.byId("idealist-related"));this._sResizeRMerList=this.attachListControlResized(this.byId("idealist-merge"));},onExit:function(){B.prototype.onExit.apply(this,arguments);this.detachListControlResized(this._sResizeSimList);this.detachListControlResized(this._sResizeRelList);this.detachListControlResized(this._sResizeRMerList);},onBeforeRendering:function(E){var t=this;var o=this.byId("otherCampaignPanel");if(o&&o.getExpanded()){o.setExpanded(false);}var g=this.byId("currentCampaignPanel");if(g&&!g.getExpanded()){g.setExpanded(true);}var i=this.getObjectModel().getKey();var h=this.getObjectModel().getProperty("/CAMPAIGN_ID");if(i!==null){var s=new J(C.getRelatedIdeasURL(i));var j=this.byId("idealist-similar");t.bindSimilarIdeaList(j,s,f.EQ,h);var r=this.byId('idealist-related');var m=this.byId('idealist-merge');t.bindRelatedCampaignIdeaList(r,f.EQ,h);t.bindMergeIdeaList(m,f.EQ,h);}},onAfterRendering:function(){},getRelatedIdeaItemTemplate:function(){if(!this._oIdeaDupListItemTemplate){this._oIdeaDupListItemTemplate=this.getFragment("sap.ino.vc.idea.fragments.FlatListItem");var A=sap.ui.core.Fragment.byId(this.getView().getId(),"flatListIdeaActions");var o=new c({type:"Transparent",visible:this.getObjectModel().getProperty("/property/actions/update/enabled")&&!this.getModel("device").getProperty("/system/phone"),icon:"sap-icon://duplicate",tooltip:this.getModel("i18n").getProperty("IDEA_OBJECT_TIT_DUPLCATE_GENERAL"),press:this.onDuplicate.bind(this)});A.addItem(o);}return this._oIdeaDupListItemTemplate;},onItemPress:function(E){var s=E.getSource();var i=s.getBindingContext("data").getProperty("ID");if(i){this.navigateTo("idea-display",{id:i});}},onExpandOther:function(E){var t=this;var i=this.getObjectModel().getKey();var g=this.getObjectModel().getProperty("/CAMPAIGN_ID");var s=E.getSource();var o=s.getBindingContext("data");if(i!==null&&E.getParameter("expand")&&o){var h=new J(C.getRelatedIdeasURL(i));var j=this.byId("idealist-similarOther");t.bindSimilarIdeaList(j,h,f.NE,g);var r=this.byId('idealist-relatedOther');t.bindRelatedOtherCampaignIdeaList(r,f.NE,g);}},bindMergeIdeaList:function(l,o){var t=this;if(!l){jQuery.sap.log.warning("List not ready","","sap.ino.vc.idea.RelatedIdeasController.js");}else{l.bindItems({path:"data>RelatedIdeas",template:this.getRelatedIdeaItemTemplate(),filters:[new e({path:"SEMANTIC",operator:o,value1:"sap.ino.config.MERGED"})],sorter:[new S("SEMANTIC_SOURCE",false,true)],groupHeaderFactory:function(g){return new G({title:t.getText("IDEA_RELATED_"+g.key),upperCase:false}).addStyleClass("sapInoIdeasRelatedHeader");}});}},bindRelatedCampaignIdeaList:function(l,o,i){var t=this;if(!l){jQuery.sap.log.warning("List not ready","","sap.ino.vc.idea.RelatedIdeasController.js");}else{l.bindItems({path:"data>RelatedIdeas",template:this.getRelatedIdeaItemTemplate(),filters:[new e({path:"CAMPAIGN_ID",operator:o,value1:i}),new e({path:"SEMANTIC",operator:o,value1:"sap.ino.config.DUPLICATE"||"sap.ino.config.COPIED"})],sorter:[new S("SEMANTIC_SOURCE",false,true)],groupHeaderFactory:function(g){return new G({title:t.getText("IDEA_RELATED_"+g.key),upperCase:false}).addStyleClass("sapInoIdeasRelatedHeader");}});}},bindRelatedOtherCampaignIdeaList:function(l,o,i){var t=this;if(!l){jQuery.sap.log.warning("List not ready","","sap.ino.vc.idea.RelatedIdeasController.js");}else{l.bindItems({path:"data>RelatedIdeas",template:this.getRelatedIdeaItemTemplate(),filters:[new e({path:"CAMPAIGN_ID",operator:o,value1:i}),new e({path:"SEMANTIC",operator:o,value1:"sap.ino.config.MERGED"})],sorter:[new S("SEMANTIC_SOURCE",false,true)],groupHeaderFactory:function(g){return new G({title:t.getText("IDEA_RELATED_"+g.key),upperCase:false}).addStyleClass("sapInoIdeasRelatedHeader");}});}},bindSimilarIdeaList:function(l,m,o,i){var t=this;if(!l){jQuery.sap.log.warning("List not ready","","sap.ino.vc.idea.RelatedIdeasController.js");}else{l.setModel(m,"data");l.bindItems({path:"data>/",filters:new e({path:"CAMPAIGN_ID",operator:o,value1:i}),template:this.getRelatedIdeaItemTemplate(),sorter:[new S("SEMANTIC",false,true)],groupHeaderFactory:function(g){return new G({title:t.getText("IDEA_RELATED_TITLE_SIMILAR_IDEAS"),upperCase:false}).addStyleClass("sapInoIdeasRelatedHeader");}});}}}));});
