sap.ui.define(["sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Idea","sap/ino/commons/models/object/RewardList","sap/ino/commons/models/object/EvaluationRequestItem","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/application/Configuration","sap/m/MessageToast"],function(B,J,I,R,E,P,C,M){"use strict";var D=function(){throw"Mixin may not be instantiated directly";};D.onDeleteIdea=function(e){var s=e.getSource();var i=s.getBindingContext("data").getProperty("ID");var S={nodes:[],actions:["del"]};var t=this;var p=C.getSystemSettingsModel().getProperty("/sap.ino.config.PPM_INTEGRATION_ACTIVE");var d=function(a){var b=a.getSource();var c=b.getProperty("/actions/del/enabled");var h=b.getProperty("/actions/del/customProperties/hasReward");var f=b.getProperty("/actions/del/customProperties/isMergeedWithVote");var g=b.getProperty("/actions/del/customProperties/isMerged");if(h){M.show(t.getText("MSG_IDEA_HAVE_REWARD_CANNOT_DELETE"));}else if(!c){if(g){M.show(t.getText("MSG_IDEA_MERGED_CANNOT_DELETE"));}else{M.show(t.getText("OBJECT_MSG_DELETE_FAILED"));}}else{var H=s.getBindingContext("data").getProperty("EVALUATION_COUNT");var j=b.getProperty("/actions/del/customProperties/isManager");if(!H||(H&&j)){var m=p==="1"?"MSG_IDEA_CAMP_MANAGER_DEL_CONFIRM_HAVE_PPM":"MSG_DEL_CONFIRM";var k=B.prototype.executeObjectAction.call(t,I,"del",{staticparameters:i,messages:{confirm:m,success:"MSG_DEL_SUCCESS"}});k.done(function(r){if(r&&r.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(t.bindList&&typeof(t.bindList)==="function"){t.bindList();}else if(t._bindIdeas&&typeof(t._bindIdeas)==="function"&&t._sIdeaViewKey){t._bindIdeas(t._sIdeaViewKey);}});k.fail(function(r){if(r.MESSAGES&&r.MESSAGES.length>0){M.show(r.MESSAGES[0].MESSAGE_TEXT);}});}else{M.show(this.getText("MSG_IDEA_DEL_FAILED_SUBMITTER_HAVE_EVALUATION"));}}};var o=new P("sap.ino.xs.object.idea.Idea",i,S,false,d);};D.onMassDeleteReward=function(e){var s=e.getSource();var t=this.getTable();var r=[];var a=[];var S=t.getSelectedIndices();if(S.length){for(var i=0;i<S.length;i++){r.push(t.getContextByIndex(S[i]).getProperty("ID"));if(a.indexOf(t.getContextByIndex(S[i]).getProperty("REWARD_LIST_ID"))===-1){a.push(t.getContextByIndex(S[i]).getProperty("REWARD_LIST_ID"));}}}var b=this;var d=B.prototype.executeObjectAction.call(b,R,"bulkDeleteRewards",{staticparameters:{"REWARD_ID":r,"REWARD_LIST_ID":a},messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});d.done(function(o){if(o&&o.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(b.bindList&&typeof(b.bindList)==="function"){b.bindList();}});};D.onMassDeleteEvalReq=function(e){var s=e.getSource();var t=this.getTable();var S=t.getSelectedIndices();var a=[];if(S.length){for(var i=0;i<S.length;i++){a.push(t.getContextByIndex(S[i]).getProperty("ID"));}}var b=this;var d=B.prototype.executeObjectAction.call(b,E,"bulkDeleteItems",{staticparameters:{"EVAL_REQ_ITEM_ID":a},messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});d.done(function(r){if(r&&r.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(b.bindList&&typeof(b.bindList)==="function"){b.bindList();}});};return D;});
