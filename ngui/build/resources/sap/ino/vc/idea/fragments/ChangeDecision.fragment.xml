<core:FragmentDefinition
	xmlns="sap.m"
	xmlns:core="sap.ui.core"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:l="sap.ui.layout"
	xmlns:f="sap.ui.layout.form">
	<Dialog 
        title="{i18n>IDEA_OBJECT_TIT_CHANGE_DECISION}">
		<f:SimpleForm
            maxContainerCols="2"
            layout="ResponsiveGridLayout"
            editable="true">
			<f:content>
				<Label text="{i18n>IDEA_OBJECT_FLD_DECISION_DATE}" required="true" visible="{decision>/IS_DECISION_RELEVANT}"/>
				<DatePicker
                visible="{decision>/IS_DECISION_RELEVANT}"
                displayFormat="long"
                placeholder="{i18n>IDEA_OBJECT_FLD_DECISION_DATE}"
                value="{path: 'decision>/DECISION_DATE', type: 'sap.ui.model.type.Date', 
                formatOptions:{ style: 'medium', source: { pattern : 'yyyy-MM-dd'}}}">
					<layoutData>
						<l:GridData span="XL12 L12 M12 S12"/>
					</layoutData>
				</DatePicker>
				<Label text="{i18n>IDEA_OBJECT_FLD_DECISION_MAKER}" required="true" visible="{decision>/IS_DECISION_RELEVANT}"/>
				<Input  type="Text" visible="{decision>/IS_DECISION_RELEVANT}"
                value="{path: 'decision>/DECIDER_NAME', type: 'sap.ui.model.type.String', constraints: {minLength: 1}}"
				placeholder="{i18n>IDEA_OBJECT_FLD_DECISION_MAKER_PLACEHOLDER}" tooltip="{i18n>IDEA_OBJECT_FLD_DECISION_MAKER_PLACEHOLDER}"
				displaySecondaryValues="true" showSuggestion="true" suggest="onChangeDecisionSuggestUser" suggestionItemSelected="onChangeDecisionSuggestionUserSelected"
	            valueLiveUpdate = "true"
				liveChange="onChangeDecisionMakerChange">
					<layoutData>
						<l:GridData span="XL12 L12 M12 S12"/>
					</layoutData>
				</Input>
				<Label text="{i18n>IDEA_OBJECT_FLD_DECISION_REASON}" required="true" visible="{path: 'decision>/DECISION_REASON_LIST_CODE', formatter: '.reasonCodeExist'}"/>
				<ComboBox width="100%"
                        id="ReasonListChangeDecision"
                        visible="{path: 'decision>/DECISION_REASON_LIST_CODE', formatter: '.reasonCodeExist'}"
                        items="{decision>/reasonList}"
                        selectedKey="{path: 'decision>/REASON_CODE', type:'sap.ui.model.type.String', constraints: {minLength: 1}}">
					<core:Item
                            key="{decision>CODE}"
                            text="{decision>DEFAULT_TEXT}"/>
					<layoutData>
						<l:GridData span="XL12 L12 M12 S12"/>
					</layoutData>
				</ComboBox>
				<Label text="{i18n>IDEA_OBJECT_FLD_REASON_COMMENTS}" visible="{path: 'decision>/DECISION_REASON_LIST_CODE', formatter: '.reasonCodeExist'}"/>
				<TextArea value="{path: 'decision>/REASON', type: 'sap.ui.model.type.String'}" 
                rows="2" visible="{path: 'decision>/DECISION_REASON_LIST_CODE', formatter: '.reasonCodeExist'}">
					<layoutData>
						<l:GridData span="XL12 L12 M12 S12"/>
					</layoutData>
				</TextArea>
				<Label text="{i18n>IDEA_OBJECT_FLD_REASON}" visible="{=!${decision>/DECISION_REASON_LIST_CODE} &amp;&amp; ${decision>/IS_DECISION_RELEVANT}}"  
				required="{=!${decision>/DECISION_REASON_LIST_CODE} &amp;&amp; ${decision>/IS_DECISION_RELEVANT}}"/>
				<TextArea value="{path: 'decision>/REASON', type: 'sap.ui.model.type.String', constraints: {minLength: 1}}" 
                rows="2" visible="{=!${decision>/DECISION_REASON_LIST_CODE} &amp;&amp; ${decision>/IS_DECISION_RELEVANT}}">
					<layoutData>
						<l:GridData span="XL12 L12 M12 S12"/>
					</layoutData>
				</TextArea>
				<Label text="{i18n>IDEA_OBJECT_FLD_REASON_LINK}" visible="{path: 'decision>/DECISION_REASON_LIST_CODE', formatter: '.reasonCodeExist'}"/>
				<VBox alignItems="start" visible="{path: 'decision>/DECISION_REASON_LIST_CODE', formatter: '.reasonCodeExist'}">
					<Button id="addLinkChangeDecision" 
                        press="onAddLinkChangeDecision"
                        type="Transparent"
                        visible="{=${decision>/LINK_URL} ? false : true}"
                        icon="sap-icon://add"
                        tooltip="{i18n>IDEA_OBJECT_BTN_ADD_LINK}"/>
					<FlexBox
                        alignItems="Center"
                        justifyContent="SpaceBetween" 
                        visible="{=${decision>/LINK_URL} ? true : false}">
						<items>
							<Link text="{ parts : [{path: 'decision>/LINK_LABEL'}, {path: 'decision>/LINK_URL'}] , formatter : '.formatter.linkLabel' }"
                              href="{decision>/LINK_URL}"
                              target="new"
                              wrapping="true"/>
							<HBox>
								<Button press="onEditLinkChangeDecision"
                                icon="sap-icon://edit-outside"
                                type="Transparent" />
								<Button press="onDeleteLinkChangeDecision"
                                icon="sap-icon://sys-cancel"
                                type="Transparent" />
							</HBox>
						</items>
					</FlexBox>
				</VBox>
				<CheckBox selected="{path: 'decision>/SEND_RESPONSE', type: 'sap.ino.commons.models.types.IntBooleanType'}" text="{i18n>IDEA_OBJECT_FLD_NOTIFY_AUTHOR}" textAlign="Left"
                 select="clearClientMessages"/>
				<Label text="{i18n>IDEA_OBJECT_FLD_MY_TEXT}" required="true" visible="{= ${decision>/SEND_RESPONSE} ===1 &amp;&amp; !${decision>/TEXT_MODULE_CODE}}"/>
				<TextArea id="responseRequireTextAreaDecision" value="{path: 'decision>/RESPONSE', type: 'sap.ui.model.type.String', constraints: {minLength: 1}}"
                rows="2" visible="{=${decision>/SEND_RESPONSE} === 1 &amp;&amp; !${decision>/TEXT_MODULE_CODE}}" enabled="{path: 'decision>/SEND_RESPONSE', type: 'sap.ino.commons.models.types.IntBooleanType'}">
					<layoutData>
						<l:GridData span="XL12 L12 M12 S12"/>
					</layoutData>
				</TextArea>
				<Label text="{i18n>IDEA_OBJECT_FLD_MY_TEXT}" required="false" visible="{= ${decision>/SEND_RESPONSE} ===1 &amp;&amp; !!${decision>/TEXT_MODULE_CODE}}"/>
				<TextArea value="{path: 'decision>/RESPONSE', type: 'sap.ui.model.type.String'}"
                rows="2" visible="{=${decision>/SEND_RESPONSE}  === 1 &amp;&amp; !!${decision>/TEXT_MODULE_CODE}}" enabled="{path: 'decision>/SEND_RESPONSE', type: 'sap.ino.commons.models.types.IntBooleanType'}">
					<layoutData>
						<l:GridData span="XL12 L12 M12 S12"/>
					</layoutData>
				</TextArea>
				<Link text="{i18n>IDEA_OBJECT_FLD_MAIL_PREVIEW}" target="_blank" press="onShowChangeDecisionMailPreview" visible="{path: 'decision>/SEND_RESPONSE', type: 'sap.ino.commons.models.types.IntBooleanType'}"/>
			</f:content>
		</f:SimpleForm>
		<buttons>
			<Button text="{i18n>BTN_SAVE}" type="Accept" press="onChangeDecisionDialogOK" />
			<Button text="{i18n>BTN_CANCEL}" press="onChangeDecisionDialogCancel" />
		</buttons>
	</Dialog>
</core:FragmentDefinition>