sap.ui.define(["sap/ino/vc/commons/BaseHomepageController","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/application/Configuration","sap/ino/commons/application/WebAnalytics","sap/ino/commons/models/aof/PropertyModel","sap/ui/model/json/JSONModel","sap/ino/vc/campaign/mixins/CampaignInstanceRolesMixin"],function(B,T,C,W,P,J,a){"use strict";return B.extend("sap.ino.vc.campaign.Homepage",jQuery.extend({},a,T,{routes:["campaign"],onRouteMatched:function(e){var A=e.getParameter("arguments");this.iCampaignId=parseInt(A.id,0);if(this.iCampaignId>0){W.logCampaignView(this.iCampaignId);var u=C.getBackendRootURL()+"/sap/ino/xs/rest/common/update_object_view_count.xsjs";var b={OBJECT_TYPE:"CAMPAIGN",OBJECT_ID:this.iCampaignId,USER_NAME:C.getCurrentUser().USER_NAME};var o=jQuery.ajax({url:u,headers:{"X-CSRF-Token":C.getXSRFToken()},data:JSON.stringify(b),dataType:"json",type:"POST",contentType:"application/json; charset=UTF-8",async:true});o.done();}B.prototype.onRouteMatched.apply(this,arguments);this.setHelp("CAMPAIGN_DISPLAY","CAMPAIGN_DISPLAY_ADDITIONAL");},onBeforeDisplayViewShow:function(){var v=this.getView();if(v.getBindingContext("data")){var i=v.getBindingContext("data").getProperty("CAMPAIGN_BACKGROUND_IMAGE_ID");var s=v.getBindingContext("data").getProperty("CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID");this.updateBackgroundColor(v.getBindingContext("data").getProperty("COLOR_CODE"));this.setBackgroundImages(i,s);}},getDisplayView:function(i){var d;var s=this.getModel("component").getProperty("/SHOW_BACKOFFICE");var h=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");var r=this.getModel("component").getProperty("/REGISTRABLE");var c=this.getModel("component").getProperty("/COMMUNITY");if(!h){s=false;this.setModel(new J({}),"property");}else{if(i){var o=new P("sap.ino.xs.object.campaign.Campaign",i,{nodes:["Root"]},true);this.setModel(o,"property");var b=o.getProperty("/nodes/Root/customProperties/backofficeCampaignPrivilege");s=s&&b;}}this.getCampaignInstanceRolesData(i);if(s){d="sap.ino.vc.campaign.BackOfficeHome";}else if(c){d="sap.ino.vc.campaign.CommunityHome";}else if(r){d="sap.ino.vc.campaign.RegistrationHome";}else{d="sap.ino.vc.campaign.CommunityHome";}return d;},hasBackgroundImage:function(){return true;},getLayoutPrefix:function(){return"sapInoCampaignHomepage";},getODataEntitySet:function(){return"CampaignFull";},onBeforeHide:function(){B.prototype.onBeforeHide.apply(this,arguments);},openCampaignSettings:function(c){this.navigateToByURLInNewWindow(C.getCampaignSettingsURL(c));}}));});
