/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
sap.ui.define(["sap/ino/commons/models/core/CodeModel","sap/ui/core/format/NumberFormat","sap/ui/base/Object","sap/ino/commons/formatters/ObjectFormatter","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/models/aof/PropertyModelCache"],function(C,N,O,a,P,b){"use strict";var f=N.getFloatInstance({maxFractionDigits:2});var e=O.extend("sap.ino.vc.evaluation.EvaluationFormatter",{});jQuery.extend(e,a);var E=P.getStaticActionEnabledStaticFormatter("sap.ino.xs.object.evaluation.Evaluation","create",function(i){return{IDEA_ID:i};});var c=P.getStaticActionEnabledDynamicFormatter("sap.ino.xs.object.evaluation.Evaluation","create",function(i){return{IDEA_ID:i};});var d=P.getStaticActionEnabledDynamicFormatter("sap.ino.xs.object.evaluation.EvaluationRequest","create",function(i){return{IDEA_ID:i};});e.getFormattedValue=function(D,n,B,t,v,u,V,o){var g=e.getValue(D,n,B,t);var F="";if(v){var s="sap.ino.xs.object.basis.ValueOptionList.Root_"+v;var r=e.getRawValue(D,n,B,t);F=C.getText(s,r);}else{switch(D){case"INTEGER":F=Math.round(g).toString();break;case"NUMERIC":F=f.format(e.toFloat(g));break;case"BOOLEAN":F=e.booleanValueToString(g,o?o:this);break;case"TEXT":F=g;break;default:F=g.toString();break;}}if(!F){F="";}if(u){F=F+" "+C.getText("sap.ino.xs.object.basis.Unit.Root",u);}return F;};e.getFormattedValueEvaluations=function(D,n,B,t,v,u,V,o){var g=e.getValueEvaluations(D,n,B,t);var F="";if(v){var s="sap.ino.xs.object.basis.ValueOptionList.Root_"+v;var r=e.getRawValue(D,n,B,t);F=C.getText(s,r);}else{switch(D){case"INTEGER":F=Math.round(g).toString();break;case"NUMERIC":F=f.format(e.toFloat(g));break;case"BOOLEAN":F=e.booleanValueToString(g,o?o:this);break;case"TEXT":F=g;break;default:F=g.toString();break;}}if(!F){F="";}if(u){F=F+" "+C.getText("sap.ino.xs.object.basis.Unit.Root",u);}return F;};e.isFormattedValueVisible=function(D,n,B,t,v,u,V,o){if(!o){o=this;}var F=e.getFormattedValue(D,n,B,t,v,u,V,o);return F?F.trim().length>0:false;};e.getValue=function(D,n,B,t){var v=null;switch(D){case"INTEGER":v=Math.round(n);break;case"NUMERIC":v=typeof n==="string"?f.parse(n):n;break;case"BOOLEAN":v=B===1;break;case"TEXT":v=t;break;default:break;}switch(D){case"INTEGER":case"NUMERIC":if(isNaN(v)||v===undefined||v===null){v=0;}break;case"BOOLEAN":if(v===undefined||v===null){v=false;}break;case"TEXT":if(v===undefined||v===null){v="";}break;default:if(v===undefined||v===null){v="";}break;}return v;};e.getValueEvaluations=function(D,n,B,t){var v=null;switch(D){case"INTEGER":v=Math.round(n);break;case"NUMERIC":n=parseFloat(n);v=typeof n==="string"?f.parse(n):n;break;case"BOOLEAN":v=B===1;break;case"TEXT":v=t;break;default:break;}switch(D){case"INTEGER":case"NUMERIC":if(isNaN(v)||v===undefined||v===null){v=0;}break;case"BOOLEAN":if(v===undefined||v===null){v=false;}break;case"TEXT":if(v===undefined||v===null){v="";}break;default:if(v===undefined||v===null){v="";}break;}return v;};e.getRawValue=function(D,n,B,t){var v=null;switch(D){case"INTEGER":v=n;if(jQuery.type(n)){v=parseInt(n,10);}break;case"NUMERIC":v=n;if(jQuery.type(n)==='string'){var r=N.getFloatInstance({});v=r.parse(n);}else{v=parseFloat(n,10);}break;case"BOOLEAN":v=B;break;case"TEXT":v=t;break;default:break;}if(D!=="TEXT"&&(isNaN(v)||v===undefined||v===null)){switch(D){case"INTEGER":case"NUMERIC":case"BOOLEAN":v=0;break;default:v="";break;}}return v;};e.getWeight=function(w){var W=null;if(w===undefined||w===null){W="";}else{W="\("+w+"\%"+"\)";}return W;};e.getWeightMultiply=function(w){var W=null;if(w===undefined||w===null){W="";}else{W="\*"+w+"\%";}return W;};e.booleanValueToString=function(v,o){if(v===undefined||v===null){return o.getText("EVALUATION_FLD_UNKNOWN");}else if(v===1||v===true){return o.getText("EVALUATION_FLD_YES");}else if(v===0||v===false){return o.getText("EVALUATION_FLD_NO");}else{return o.getText("EVALUATION_FLD_UNKNOWN");}};e.hasSubcriteria=function(g){if(g&&g.length>0){return true;}return false;};e.isComboBoxControl=function(v){if(v){return true;}return false;};function m(D,v,t){if(D===t&&e.isComboBoxControl(v)){return true;}return false;}e.isTextVoL=function(D,v){return m(D,v,"TEXT");};e.isIntegerVoL=function(D,v){return m(D,v,"INTEGER");};e.isNumericVoL=function(D,v){return m(D,v,"NUMERIC");};e.isBooleanVoL=function(D,v){return m(D,v,"BOOLEAN");};e.isTextControl=function(D,v){if(e.isComboBoxControl(v)){return false;}return D==="TEXT";};e.isBooleanControl=function(D,v){if(e.isComboBoxControl(v)){return false;}return D==="BOOLEAN";};e.isInputControl=function(D,v){if(e.isComboBoxControl(v)){return false;}return D==="NUMERIC"||D==="INTEGER";};e.isProgressIndicatorControl=function(n,s,v,D){if(e.isComboBoxControl(v)){return false;}if(D!=="INTEGER"&&D!=="NUMERIC"){return false;}if(n===undefined||n===null||s===undefined||s===null){return false;}if(n===s){return false;}return true;};e.isProgressIndicator=function(n,s,v,D){if(e.isProgressIndicatorControl(n,s,v,D)){return"true";}return"false";};e.formatSliderStep=function(n,s,g,D){if(jQuery.isNumeric(n)&&jQuery.isNumeric(s)&&jQuery.isNumeric(g)){var h=parseFloat(s);var i=parseFloat(n);var j=parseFloat(g);var k=h-i;if(D==="INTEGER"){if(j===0){if(k<1&&k>0){return k;}else{return 1;}}return j;}if(D==="NUMERIC"){if(j===0){if(k<1&&k>0){return k;}else{return 0.01;}}return j;}}return 1;};e.showInputControl=function(D,n,s,v,g){if(e.isComboBoxControl(v)){return false;}if(g&&g.length>0){return false;}if((D==="INTEGER"||D==="NUMERIC")&&!e.isProgressIndicatorControl(n,s,v,D)){return true;}return false;};e.showAggregatingProgressIndicatorControl=function(n,s,g,v,D){if(e.isComboBoxControl(v)){return false;}if(g&&g.length>0){return false;}return e.isProgressIndicatorControl(n,s,v,D)&&(D==="INTEGER"||D==="NUMERIC");};e.showAggregatingCheckBoxControl=function(D,g,v){if(e.isComboBoxControl(v)){return false;}if(g&&g.length>0){return false;}return e.isBooleanControl(D,v);};e.showValue=function(D,n,s,v){if(D==="INTEGER"){return e.isProgressIndicatorControl(n,s,v,D);}return false;};e.showTextValue=function(D,v,n,s){return(e.isTextControl(D,v)||e.isBooleanControl(D)||e.showInputControl(D,n,s,v));};e.showAggregatingValue=function(D,n,s,v,g){if(e.isComboBoxControl(v)){return false;}if(g&&g.length>0){return false;}if(e.showInputControl(D,n,s,v,g)){return false;}return e.showAggregatingValueDisplay(D,n,s);};e.showAggregatingBooleanValue=function(D,g){return D!=="TEXT"&&(g&&g.length>0);};e.showAggregatingValueDisplay=function(D,n,s){return(D==="INTEGER"&&!e.showInputControl(D,n,s));};e.showComment=function(D,s){if(s){return true;}return!e.isTextControl(D);};e.showWarningMsg=function(M){if(M){return true;}return false;};e.showCommentDisplay=function(D,s){if(s&&!e.isTextControl(D)){return true;}return false;};e.showEvaluationCommentDisplay=function(s){if(s){return true;}return false;};e.progressIndicatorValue=function(D,n,B,t,v,u,M,s){var V=e.getFormattedValue(D,n,B,t,v,u,undefined,this);var i=parseInt(V,10);var g=parseInt(M,10);var h=parseInt(s,10);if(jQuery.type(i)==="number"&&jQuery.type(g)==="number"&&jQuery.type(h)==="number"){return Math.round(100*(i-g)/(h-g));}return 0;};e.hasMyEvaluations=function(M){var h=false;var i=this.getView()&&this.getView().getModel&&this.getView().getModel("object")&&this.getView().getModel("object").getProperty("/ID");if(i!==undefined){if(M){jQuery.each(M,function(I,o){if(I&&I.indexOf("IdeaMyEvaluation")===0&&o&&o.IDEA_ID===i){h=true;}});}}else{h=true;}return h;};e.statusActionCode=function(A){return C.getText("sap.ino.xs.object.status.Action.Root",A);};e.submitButtonVisible=function(s,g,i){if(g){return true;}if(s==='sap.ino.config.EVAL_DRAFT'&&i<0){return true;}return false;};e.createEvaluationEnabled=function(i){if(i){return E(i);}return false;};e.createEvaluationDynamicFormatter=function(i){if(i){return c(i);}return false;};e.selfEvaluationButtonLabel=function(i){var o=this.getView().getController();if(i){if(c(i)&&P.getCacheModel().getProperty("/sap.ino.xs.object.evaluation.Evaluation/actions/create/customProperties/SELF_EVALUATION_ACTIVE")){return o.getText("IDEA_OBJECT_BTN_CREATE_SELF_EVALUATION");}}return o.getText("IDEA_OBJECT_BTN_CREATE_EVALUATION");};e.createEvaluationRequestEnabled=function(i){if(i){return d(i);}return false;};return e;});
