/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
sap.ui.define(["sap/ino/commons/application/Configuration","sap/ui/base/Object","sap/ui/core/MessageType","sap/ui/core/IconPool","sap/ui/model/type/Date","sap/ui/model/FormatException","sap/ui/Device","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ui/core/Locale","sap/m/ListType"],function(C,O,M,I,D,F,a,N,b,L,c){"use strict";var m={};m[M.Error]="message-error";m[M.Warning]="message-warning";m[M.Success]="message-success";m[M.Information]="message-information";var d={};d[M.Error]=1;d[M.Warning]=2;d[M.Success]=3;d[M.Information]=4;function e(i){if(i.length===0){return undefined;}return i.reduce(function(s,o){if(d[o.type]===undefined){return s;}if(d[o.type]<d[s]){return o.type;}else{return s;}},M.Information);}function g(){return C.getSysCompanyView()==="1"?"LIST_TIT_FILTER_COMPANY_VIEW_HEADER":"LIST_TIT_FILTER_ORGANIZATION_VIEW_HEADER";}var B=O.extend("sap.ino.commons.formatters.BaseFormatter",{});var _;var G=function(t){if(!_){if(t.getOwnerComponent){_=b.getDateInstance({relative:true},new L(t.getOwnerComponent().getModel("user").getProperty("/data/LOCALE")));}else{return b.getDateInstance({relative:true});}}return _;};var f;var h=function(t){if(!f){if(t.getOwnerComponent){f=b.getDateInstance({relative:true,relativeScale:"auto"},new L(t.getOwnerComponent().getModel("user").getProperty("/data/LOCALE")));}else{return b.getDateInstance({relative:true,relativeScale:"auto"});}}return f;};var j;var k=function(t){if(!j){if(t.getOwnerComponent){j=b.getDateInstance({relative:false},new L(t.getOwnerComponent().getModel("user").getProperty("/data/LOCALE")));}else{return b.getDateInstance({relative:false});}}return j;};var l;var n=function(t){if(!l){if(t.getOwnerComponent){l=b.getTimeInstance({relative:false,format:'Hm'},new L(t.getOwnerComponent().getModel("user").getProperty("/data/LOCALE")));}else{return b.getTimeInstance({relative:false,format:'Hm'});}}return l;};B.showCreateButton=function(o,s){return o+s===2;};B.titleImageURL=function(i,o){var s=o instanceof Date?'&t='+o.getTime():'';var u=C.getAttachmentTitleImageDownloadURL(i,null,'small');if(s){return u+s;}return u;};B.campaignTitleImageURL=function(i,o){var s=o instanceof Date?'&t='+o.getTime():'';var u=C.getAttachmentTitleImageDownloadURL(i,null,'large');if(s){return u+s;}return u;};B.campaignListImageURL=function(t,i){if(i===null){return C.getAttachmentTitleImageDownloadURL(t,null,'small');}else{return C.getAttachmentTitleImageDownloadURL(i,null,'small');}};B.parameterizedText=function(t){var i=Array.prototype.slice.call(arguments);i.shift();if(t){jQuery.each(i||[],function(o,p){t=t.replace(new RegExp("\\{"+o+"\\}","g"),p||"");});}return t;};B.TagGroupName=function(t,p){if(p){return this.getText(t,p);}else{return this.getText(t);}return"";};B.TagGroupLinkEnable=function(t,T){var i={};var o=[];t.forEach(function(p,q){if(!i[p.ROOTGROUPID]){i[p.ROOTGROUPID]={};o.push(p.ROOTGROUPID);}});return!!~o.indexOf(T)||(o.length<5);};B.text=function(t,p){if(!t){return"";}if(p){return this.getText(t,p);}else{return this.getText(t);}return"";};B.getManageContinuesText=function(t,p){if(p){return this.getText("PERSONALIZE_FILTER_ACTIVE_IDEA_LABEL");}else{return this.getText("PERSONALIZE_MANAGED_ALL_IDEA_LABEL");}return"";};B.getManageContinuesTooltip=function(t,p){if(p){return this.getText("PERSONALIZE_MANAGED_ALL_IDEA_LABEL");}else{return this.getText("PERSONALIZE_FILTER_ACTIVE_IDEA_LABEL");}return"";};B.getManageContinuesToggle=function(t,p){if(p){return true;}else{return false;}return"";};B.getManageTextTooltip=function(t,p){if(p){return this.getText("PERSONALIZE_FILTER_ACTIVE_IDEA_LABEL_TOOLTIP");}else{return this.getText("PERSONALIZE_MANAGED_ALL_IDEA_LABEL_TOOLTIP");}return"";};B.campaignListCountNumber=function(p){if(p){var i=C.getCampaignFilterCount();return i[p];}};B.ideaListCountNumber=function(p){if(p){var i=C.getIdeaFilterCountData();return i[p];}};B.color=function(s){if(s&&s.length===6){return"#"+s;}else{return"#FFFFFF";}};B.isEqual=function(A,v){return A===v;};B.system=function(s){var S=false;if(!s){S=true;}else if(jQuery.type(s)==="array"){jQuery.each(s,function(i,o){S=S||a.system[o];});}else if(jQuery.type(s)==="string"){S=a.system[s];}return!!S;};B.mostSevereMessageTypeIcon=function(i){var s=e(i);return"sap-icon://"+m[s]||"";};B.uploadEnabled=function(i,o,E){if(E===undefined){var p=this.getView().data("editable");E=p==="true"||p===null;}return(E!==false)&&(i<0||o!==false);};B.downloadUrl=function(A,s){if(!s){return C.getAttachmentDownloadURL(A);}return C.getAttachmentDownloadURL(A)+"?filename="+encodeURIComponent(s);};B.previewUrl=function(s,A){if(s&&s.indexOf("image/")===0){return C.getAttachmentDownloadURL(A);}return undefined;};B.attachmentEditable=function(A){return A>0;};B.attachmentDeletable=function(A,i,E){if(E===undefined&&this.getView().data){var o=this.getView().data("editable");E=o==="true"||o===null;}return(E!==false)&&(A<0||i!==false);};B.navigationLink=function(r,p){return this.getOwnerComponent().getNavigationLink(r,p);};B.commentSaveTooltip=function(i,o,p){var s=p>0&&i>0||!p;if(!(s&&o>0)){return this.getText("MSG_COMMENT_HAS_PRIVILEGE");}else{return this.getText("MSG_COMMENT_SAVE_BUTTON");}};B.setIdeaListLatestUpdateBackGroundColor=function(i,u,o,s){if(!i&&!u&&!o&&!s){return"LATESTUPDATE_BACKGROUND";}else{return"null";}};B.setMgrCoachBackGroundColor=function(i,o,p,q){var r=this.getRouter();if(!i&&r.getContext().indexOf("sectionComments")<0){return"null";}var s=[];var t=[];if(p&&p.length>0){s=p.filter(function(u){return u.IDENTITY_ID===o;});}if(q&&q.length>0){t=q.filter(function(u){return u.IDENTITY_ID===o;});}if(t.length>0||s.length>0){return"MGRCOACH_BACKGROUND";}else{return"null";}};B.userIcon=function(i,o){if(!i||!o){return I.getIconURI("person-placeholder");}var s=o instanceof Date?'&t='+o.getTime():'&t='+(new Date(o)).getTime();var u=C.getAttachmentDownloadURL(i,null,'small');if(s){return u+s;}return u;};B.userIconEdit=function(i,o){if(!i){return I.getIconURI("person-placeholder");}var s=o instanceof Date?'&t='+o.getTime():'';var u=C.getAttachmentDownloadURL(i,null,'large');if(s){return u+s;}return u;};B.feedIdentityCard=function(i,p){if(i==="DATE_REACHED_SUBMIT_FROM"||i==="DATE_REACHED_SUBMIT_TO"||i==="DATE_REACHED_VALID_TO"||i==="DATE_REACHED_REGISTER_FROM"||i==="DATE_REACHED_REGISTER_TO"||p){return false;}};B.feedNoIdentityCard=function(i,p){if(p){return false;}if(i==="DATE_REACHED_SUBMIT_FROM"||i==="DATE_REACHED_SUBMIT_TO"||i==="DATE_REACHED_VALID_TO"||i==="DATE_REACHED_REGISTER_FROM"||i==="DATE_REACHED_REGISTER_TO"){return true;}return false;};B.feedLink=function(i,A){if(A<=0){return false;}if(i==="DATE_REACHED_SUBMIT_FROM"||i==="DATE_REACHED_SUBMIT_TO"||i==="DATE_REACHED_VALID_TO"||i==="DATE_REACHED_REGISTER_FROM"||i==="DATE_REACHED_REGISTER_TO"){return false;}};B.userImage=function(i){return!i?"":C.getAttachmentTitleImageDownloadURL(i);};B.isValidEmailAddr=function(s){if(!s||typeof s!=="string"){return false;}return/^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/g.test(s.trim());};B.isUsageReportingActive=function(){return C.isUsageReportingActive();};B.returnIfUsageReportingActive=function(o){return C.isUsageReportingActive()?o:undefined;};B.toInt=function(s){var i=parseInt(s,10);if(isNaN(i)){i=0;}else{throw new F("Don't know how to format "+s+" to int");}return i;};B.toFloat=function(s){var i=parseFloat(s);if(isNaN(i)){i=0;}else{throw new F("Don't know how to format "+s+" to float");}return i;};B.toString=function(o){return o.toString();};B.notEmpty=function(o){if(jQuery.type(o)==="array"){return o.length>0;}else{return!!o;}};B.toRelativeDate=function(o){if(!o){return"";}else if(typeof(o)==="number"){o=new Date(o);}else if(typeof(o)==="string"){o=new Date(o);}else if(typeof(o)==="object"){}else{throw new F("Don't know how to format "+o+" to relative Date");}return G(this).format(o);};B.toRelativeDateAuto=function(o){if(!o){return"";}else if(typeof(o)==="number"){o=new Date(o);}else if(typeof(o)==="string"){o=new Date(o);}else if(typeof(o)==="object"){}else{throw new F("Don't know how to format "+o+" to relative Date (Auto)");}return h(this).format(o);};B.toDate=function(o){if(!o){return"";}else if(typeof(o)==="number"){o=new Date(o);}else if(typeof(o)==="string"){o=new Date(o);}else if(typeof(o)==="object"){}else{throw new F("Don't know how to format "+o+" to Date");}return k(this).format(o);};B.toDateTime=function(o,w){if(!o){return"";}else if(typeof(o)==="number"){o=new Date(o);}else if(typeof(o)==="string"){o=new Date(o);}else if(typeof(o)==="object"){}else{throw new F("Don't know how to format "+o+" to oDateTime");}var s=k(this).format(o);var t=n(this).format(o);var r=sap.ui.getCore().getConfiguration().getRTL();if(r){return t+" "+s;}if(w){return s+" "+t;}return"<span style='display:inline-block'>"+s+" "+t+"</span>";};B.isVisible=function(o){return!!o;};B.isFutureDate=function(o){if(!o){return false;}else if(typeof(o)==="number"){o=new Date(o);}else if(typeof(o)==="string"){o=new Date(o);}else if(typeof(o)==="object"){}else{throw new F("Don't know how to format "+o);}var i=new Date();var p=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate());return o.getTime()>p;};B.toBool=function(s){return parseInt(s,10)===1;};B.toBoolNot=function(s){return parseInt(s,10)!==1;};B.toBoolText=function(s){if(typeof s==="boolean"){s=(s===true?1:0);}return parseInt(s,10)===1?this.getText("BOOL_FLD_TEXT_YES"):this.getText("BOOL_FLD_TEXT_NO");};B.toBoolInt=function(s){if(typeof s==="boolean"){return(s===true?1:0);}var i=parseInt(s,10);if(isNaN(i)||i===0){return 0;}else{return 1;}};B.atLeastOne=function(s){return parseInt(s,10)||1;};B.asPercent=function(v){return this.getText("PERCENTAGE_FLD_TEXT",[(v||0)]);};B.atLeastZero=function(v){return(v||0.0);};B.convertToInt=function(i){return Math.floor(i);};B.count=function(i){if(i){var o=N.getIntegerInstance({style:"short"});return o.format(i);}return"0";};B.isIdIncluded=function(i,p){p=p?p:[];return jQuery.grep(p,function(o){return o.ID===i;}).length>0;};B.isIdNotIncluded=function(i,p){p=p?p:[];return jQuery.grep(p,function(o){return o.ID===i;}).length===0;};B.incativeWhenIncluded=function(i,o){return this.formatter.isIdNotIncluded(i,o)?c.Active:c.Inactive;};B.expertRolesKeyToText=function(r){var t=this;var R=[];jQuery.each(r,function(i,s){switch(s){case"SUBMITTER":R.push(t.getText("CTRL_EXPERTS_GRP_SUBMITTER"));break;case"CONTRIBUTOR":R.push(t.getText("CTRL_EXPERTS_GRP_CONTRIBUTOR"));break;case"COMMENTATOR":R.push(t.getText("CTRL_EXPERTS_GRP_COMMENTATOR"));break;case"COACH":R.push(t.getText("CTRL_EXPERTS_GRP_COACH"));break;case"EVALUATOR":R.push(t.getText("CTRL_EXPERTS_GRP_EVALUATOR"));break;default:R.push(s);}});return R.join(", ");};B.wrapHTML=function(H){return"<div>"+(H||"")+"</div>";};B.wrapToHTML=function(H){if(H&&!(/^<(\w+)>.*<\/\1>$/gim.test(H))){return"<p>"+H+"</p>";}return H;};B.decodeURI=function(u){return decodeURIComponent(u);};B.termsConditions=function(s){if(s===null||s===undefined){return undefined;}var o=this.getView().getModel("module");return o.getProperty(s);};B.generateDescription=function(o,v,s){var t=this;if(o){if(s){return jQuery.sap.formatMessage(t.getText("INO_IDENTITY_DATA_VALIDATIONTO"),o,B.toDate(v),B.toDateTime(s,true));}return jQuery.sap.formatMessage(t.getText("INO_IDENTITY_DATA_VALIDATIONTO_WITHOUT_LAST_LOGIN"),o,B.toDate(v));}if(s){return jQuery.sap.formatMessage(t.getText("INO_IDENTITY_DATA_VALIDATIONTO_WITHOUT_ORGANIZATION"),B.toDate(v),B.toDateTime(s,true));}return jQuery.sap.formatMessage(t.getText("INO_IDENTITY_DATA_VALIDATIONTO_WITHOUT_ORGANIZATION_WITHOUT_LAST_LOGIN"),B.toDate(v));};B.checkVisibleText=function(t,p){if(p){return this.getText(t,p);}else{if(t!=="manage"&&t!=="draft"&&t!=="publish"&&t!=="submittable"){return true;}}return false;};B.ideaCheckVisibleText=function(t,p){if(p){return this.getText(t,p);}else{if(t!=="manage"&&t!=="follow"&&t!=="unassigned"&&t!=="coachme"&&t!=="evaldone"&&t!=="managedcompleted"){return true;}}return false;};B.checkVisibleText2=function(t,p){if(p){return this.getText(t,p);}else{if(t!=="all"&&t!=="active"&&t!=="open"&&t!=="future"&&t!=="past"&&t!=="registered"){return true;}}return false;};B.ideaCheckVisibleText2=function(t,p){if(p){return this.getText(t,p);}else{if(t!=="all"&&t!=="my"&&t!=="voted"&&t!=="commented"&&t!=="vote"&&t!=="eval"&&t!=="evalpending"&&t!=="evalopen"&&t!=="completed"){return true;}}return false;};B.parentText=function(t,p){if(p){return this.getText(t,p);}else{if(t==="CAMPAIGN_LIST_MIT_ALL"){return"Campaigns";}}return"";};B.parentText2=function(t,p){if(p){return this.getText(t,p);}else{if(t==="CAMPAIGN_LIST_MIT_MANAGE"){return"Managed Campaigns";}}return"";};B.checkList=function(p){if(p==="CAMPAIGN_LIST_TIT_NAME"||p==="IDEA_LIST_TIT_NAME"){return true;}return false;};B.i18nText=function(t){var i=this.getModel('i18n');return i.getResourceBundle().getText(t)||'';};B.formatGlobalSearchKey=function(t,i){if(i){return t;}var o=this.getModel('i18n');return o.getResourceBundle().getText(t)||'';};B.URIdecoding=function(t){return t&&window.decodeURIComponent(t)||'';};B.anonymousIconFormatter=function(i){if(i==="ALL"){return"sap-icon://theater";}else if(i==="PARTLY"){return"sap-icon://personnel-view";}};B.anonymousIconVisibleFormatter=function(i){if(i===null){return false;}else{return true;}};B.anonymousIconTooltipFormatter=function(i){if(i==="ALL"){return this.getText("IDEA_ANONYMOUS_FOR_ALL");}else if(i==="PARTLY"){return this.getText("IDEA_NOT_ANONYMOUS_CAMPAIGN_MANAGER");}};B.anonymousIconLabelFormatter=function(i){if(i==="ALL"){return this.getText("IDEA_ANONYMOUS_FOR_ALL");}else if(i==="PARTLY"){return this.getText("IDEA_NOT_ANONYMOUS_CAMPAIGN_MANAGER");}};B.adminFormTitle=function(i){if(i&&i.length>0){var r=i[0].FORM_DEFAULT_TEXT;return r;}else{return"";}};B.ideaPersonalizationFilterTextInDialog=function(t){switch(t){case'CAMPAIGN':return this.getText("LIST_TIT_FILTER_CAMPAIGN_HEADER");case'CUSTOM_IDEA_FORM':return this.getText("LIST_TIT_FILTER_CAMPAIGN_FORM_HEADER");case'PHASE':return this.getText("LIST_TIT_FILTER_PHASE_HEADER");case'STATUS_TYPE':return this.getText("LIST_TIT_FILTER_STATUS_HEADER");case'STATUS':return this.getText("LIST_TIT_FILTER_SUB_STATUS");case'VOTE_NUMBER':return this.getText("LIST_TIT_FILTER_VOTE_NUMBER");case'RESPONSIBILITY_LIST':return this.getText("LIST_TIT_FILTER_RESPONSIBILITY_LIST_HEADER");case'AUTHOR':return this.getText("LIST_TIT_FILTER_AUTHOR_HEADER");case'COACH':return this.getText("LIST_TIT_FILTER_COACH_HEADER");case'DUE_DATE':return this.getText("LIST_TIT_FILTER_DUE_HEADER");case'LATEST_UPDATE':return this.getText("LIST_TIT_FILTER_LATEST_UPDATE_HEADER");case'COMPANY_VIEW':return this.getText(g());}};B.quickLinkStandardListVisible=function(t,s){if(s){if(t!=="all"&&t!=="my"&&t!=="voted"&&t!=="commented"&&t!=="vote"&&t!=="eval"&&t!=="evalpending"&&t!=="evalopen"&&t!=="completed"){return true;}}else{if(t!=="manage"&&t!=="follow"&&t!=="unassigned"&&t!=="coachme"&&t!=="evaldone"&&t!=="managedcompleted"){return true;}}return false;};B.shortByQuickSortText=function(q){if(!q){return;}var Q=this.getListProperty('/QuickSorter');var t;Q.forEach(function(i){if(i.ACTION===q){t=i.TEXT;}});return this.getText(t);};B.shortBySortText1=function(s){if(!s){return;}var S=s.split(",");var i=S[0].split(" ");var q=this.getListProperty('/Sorter/Values');var t;q.forEach(function(o){if(o.ACTION===i[0]){t=o.TEXT;}});return this.getText(t);};B.shortBySortText2=function(s){if(!s){return;}if(s.indexOf(",")!==-1){var S=s.split(",");var i=S[1].split(" ");var q=this.getListProperty('/Sorter/Values');var t;q.forEach(function(o){if(o.ACTION===i[0]){t=o.TEXT;}});return this.getText(t);}else{return"";}};B.shortBySortVisible=function(s){if(!s){return false;}if(s.indexOf(",")!==-1){return true;}else{return false;}};B.quickLinkTextFormate=function(t,i,o){if(i){return i;}else{if(o){return this.getText(t,[o]);}else if(t){return this.getText(t);}else{return"";}}};B.quickLinkListSelected=function(A,i,s,S,o,p){if(!o&&(A===s||A===S)){return true;}if(o&&i&&p&&i===p){return true;}if(o&&!p&&(A===s||A===S)){return true;}return false;};B.commentEnabled=function(i,o,p){var s=p>0&&i>0||!p;return o>0&&s;};B.disableQuickLinkAllIdeas=function(t){if(t==="all"||t==="manage"){return false;}else{return true;}};B.formatInsufficientObjectId=function(t,p){return jQuery.sap.formatMessage(t,p);};B.formatInsufficientObjectExists=function(i,o){if(!o){return C.getBackendRootURL()+"/sap/ino/"+window.location.search;}var p={"sap.ino.xs.object.idea.Idea":function(s){return C.getBackendRootURL()+"/sap/ino/"+window.location.search+"#/campaign/"+s;}};return p[o](i);};B.getCommunityGroupViewTooltip=function(i){if(!i){return this.getText("IDEA_LIST_TIT_NAME_FOR_MY_VIEW");}else{return this.getText("IDEA_LIST_TIT_NAME");}};B.getIdeaListTitleText=function(E,i){if(!E){return this.getText("IDEA_LIST_TIT_NAME");}else{if(!i){return this.getText("IDEA_LIST_TIT_NAME");}else{return this.getText("IDEA_LIST_TIT_NAME_FOR_MY_VIEW");}}};B.getCommunityGroupViewToggle=function(i){if(i){return true;}else{return false;}};return B;});
