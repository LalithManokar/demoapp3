/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
sap.ui.define(["sap/ino/commons/formatters/BaseFormatter","sap/ino/commons/models/core/CodeModel","sap/ino/commons/application/Configuration","sap/ino/controls/IdeaStatusType","sap/ino/controls/VoteType","sap/ui/base/Object","sap/ui/model/type/Date","sap/ui/core/IconPool","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat"],function(B,C,b,I,V,O,D,c,N,d){"use strict";var f=N.getFloatInstance({maxFractionDigits:1});var o=O.extend("sap.ino.commons.formatters.ObjectFormatter",{});jQuery.extend(o,B);o.alternativeBy=function(v,i,a,e,A){if(i){e=B.toRelativeDate(e);if(!e&&A){e=B.toRelativeDate(A);}return B.parameterizedText(v,i,e);}else if(a){A=B.toRelativeDate(A);return B.parameterizedText(v,a,A);}else return"";};o.ideaDisplaySubtitle=function(i,s,r,R,v,a,A,e,g,w){if(w){if(R){return i+": "+s+", "+r+": "+R;}return i+": "+s;}return o.alternativeBy(v,a,A,e,g);};o.aContributorsTostring=function(a){if(!a||a.length<=0){return"";}var r=a[0].NAME;for(var i=1;i<=a.length-1;i++){r+=", "+a[i].NAME;}return r;};o.alternativeDate=function(v,a){v=B.toRelativeDate(v);if(!v&&a){v=B.toRelativeDate(a);}return v||"";};o.daysLeft=function(s){if(s){var a=new Date(s);var n=new Date();var e=new Date("9999-12-30T00:00:00.000Z");var i=n.getTime()-a.getTime();var l;if(i<=0){if(s>=e){l=this.getText("CAMPAIGN_LIST_FLD_DEADLINE_NO_END_DATE");}else{l=this.getText("CAMPAIGN_FLD_DATE_DEADLINE",[B.toDateTime(a)]);}}else{l=this.getText("CAMPAIGN_FLD_DATE_DEADLINE_PASSED",[B.toDateTime(a)]);}return l;}return undefined;};o.campaignStartsInDays=function(s){if(s){var a=new Date(s);var n=new Date();var i=a.getTime()-n.getTime();var l;if(i<0){l=this.getText("CAMPAIGN_FLD_DATE_STARTED",[B.toDate(a)]);}else{l=this.getText("CAMPAIGN_FLD_DATE_WILL_START",[B.toDate(a)]);}return l;}return undefined;};o.submissionDaysLeft=function(s){if(s){var a=new Date(s);var n=new Date();var e=new Date("9999-12-30T00:00:00.000Z");var i=n.getTime()-a.getTime();var l;if(i<=0){if(a>=e){l=this.getText("CAMPAIGN_LIST_FLD_SUBMISSION_DEADLINE_NO_END_DATE");}else{l=this.getText("CAMPAIGN_FLD_SUBMISSION_DEADLINE",[B.toDateTime(a)]);}}else{l=this.getText("CAMPAIGN_FLD_SUBMISSION_DEADLINE_PASSED",[B.toDateTime(a)]);}return l;}return undefined;};o.submissionStartsInDays=function(s){if(s){var a=new Date(s);var n=new Date();var i=a.getTime()-n.getTime();var l;if(i<0){l=this.getText("CAMPAIGN_FLD_SUBMISSION_STARTED",[B.toDate(a)]);}else{l=this.getText("CAMPAIGN_FLD_SUBMISSION_WILL_START",[B.toDate(a)]);}return l;}return undefined;};o.registrationDaysLeft=function(s){if(s){var a=new Date(s);var n=new Date();var e=new Date("9999-12-30T00:00:00.000Z");var i=n.getTime()-a.getTime();var l;if(i<0){if(a>=e){l=this.getText("CAMPAIGN_LIST_FLD_REGISTRATION_DEADLINE_NO_END_DATE");}else{l=this.getText("CAMPAIGN_FLD_REGISTRATION_DEADLINE",[B.toDateTime(a)]);}}else{l=this.getText("CAMPAIGN_FLD_REGISTRATION_DEADLINE_PASSED",[B.toDateTime(a)]);}return l;}return undefined;};o.registrationStartsInDays=function(s){if(s){var a=new Date(s);var n=new Date();var i=a.getTime()-n.getTime();var l;if(i<0){l=this.getText("CAMPAIGN_FLD_REGISTRATION_STARTED",[B.toDate(a)]);}else{l=this.getText("CAMPAIGN_FLD_REGISTRATION_WILL_START",[B.toDate(a)]);}return l;}return undefined;};o.formatInfinityWithTimeFormat=function(a){if(!a){return"";}else if(typeof(a)==="number"||typeof(a)==="string"){a=new Date(a);}a=new Date(a.getTime()+a.getTimezoneOffset()*60*1000);return sap.ui.core.format.DateFormat.getDateTimeInstance({"pattern":"yyyy-MM-dd HH:mm:ss UTC"}).format(a,false);};o.ideaImageUrl=function(t,m){if(m&&m.indexOf("image/")===0){return b.getAttachmentTitleImageDownloadURL(t);}return null;};o.ideaTitleImageUrl=function(t,u,a){if(t&&u){if(a instanceof Date){return'/'+u+'/'+t+'?type=large&t='+a.getTime();}else{return'/'+u+'/'+t+'?type=large';}}return null;};o.ideaProcessStopped=function(s){if(s){return s===I.Discontinued||s===I.Merged;}return false;};o.isIdeaProcessStoped=function(s,t){if(t){return t==="DISCONTINUED";}else if(s){return s===I.Discontinued||s===I.Merged;}return false;};o.baseCampaignHomePageButtons=function(p,a){return p&&a;};o.ideaStatus=C.getFormatter("sap.ino.xs.object.status.Status.Root");o.ideaStatusAction=C.getFormatter("sap.ino.xs.object.status.Action.Root");o.ideaPhase=C.getFormatter("sap.ino.xs.object.campaign.Phase.Root");o.criterionCode=C.getFormatter("sap.ino.xs.object.evaluation.Model.Criterion");o.changeStatusActionCode=C.getFormatter("sap.ino.xs.object.status.Action.Root");o.criterionCodeLongText=C.getLongTextFormatter("sap.ino.xs.object.evaluation.Model.Criterion");o.criterionCodeLongTextVisible=function(t){return!!t&&t.length>0;};o.modelCode=C.getFormatter("sap.ino.xs.object.evaluation.Model.Root");o.modelCodeLongText=C.getLongTextFormatter("sap.ino.xs.object.evaluation.Model.Root");o.valueOption=C.getFormatter("sap.ino.xs.object.basis.ValueOptionList.ValueOptions");o.uomCode=C.getFormatter("sap.ino.xs.object.basis.Unit.Root");o.ideaNavigationLink=function(i,s){if(!isNaN(parseInt(i,10))){var p={id:i};if(s){p.query={section:s};}return B.navigationLink.apply(this,["idea-display",p]);}return undefined;};o.campaignNavigationLink=function(i){if(!isNaN(parseInt(i,10))){return B.navigationLink.apply(this,["campaign",{id:i}]);}return undefined;};o.rewardEmployeeName=function(e,i){if(i>0){return e;}else if(i===0){e=this.getText("IDEA_OBJECT_TIT_IDEA_Anonymity");return e;}};o.rewardEmployeeNameLinkEnabled=function(i){if(i>0){return true;}else{return false;}};o.wallNavigationLink=function(i){if(!isNaN(parseInt(i,10))){return B.navigationLink.apply(this,["wall",{id:i}]);}return undefined;};o.evaluationNavigationLink=function(i){if(!isNaN(parseInt(i,10))){return B.navigationLink.apply(this,["evaluation-display",{id:i}]);}return undefined;};o.roleCode=C.getFormatter("sap.ino.xs.object.iam.RoleCode.Root");o.multipleRoleCodes=function(r){var R="";if(r){R=r.split(",").map(o.roleCode).join(", ");}return R;};o.ideaAccessibilityLabel=function(i,p,a,s,S,v,e,g,h,m,j,k){if(S===I.Draft){return this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_DRAFT",[i]);}g=g||0;h=h||0;m=m||0;j=j||0;k=k||0;a=a||0;s=s||0;var l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_NO");if(v===V.TYPE_STAR){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_STAR",[h,m]);}else if(v===V.TYPE_LIKE){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE",[h]);}else if(v===V.TYPE_LIKE_DISLIKE){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_DISLIKE",[j,k]);}var n=b.isUsageReportingActive()?this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VIEW_COUNT",[g]):"";return this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL",[i,o.ideaPhase(p),a+1,s,o.ideaStatus(S),l,e,n]);};o.ideaAccessibilityLabelBackOfficeHome=function(i,s,S,a,p,e,g,h,v,E,j,k,l,m,F,n,M,q,r){if(h===I.Draft){return this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_DRAFT",[i]);}e=e+1||1;g=g||0;E=E||0;j=j||0;k=k||0;var t=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_NO");if(v===V.TYPE_STAR){t=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_STAR",[n,M]);}else if(v===V.TYPE_LIKE){t=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE",[n]);}else if(v===V.TYPE_LIKE_DISLIKE){t=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_DISLIKE",[q,r]);}a=a?this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_COACH",[a]):"";F=F?this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_DUE_DATE",[B.toDate(F)]):"";return this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_BACKOFFICEHOME",[i,s,S,a,o.ideaPhase(p),e,g,o.ideaStatus(h),t,E,j,k,B.toDate(l),B.toDate(m),F]);};o.ideaAccessibilityLabelListItem=function(i,p,a,s,S,v,e,g,h,m,j,k){if(S===I.Draft){return this.getText("IDEA_LIST_ITEM_ALT_ACCESSIBILITY_LABEL_DRAFT",[i]);}g=g||0;h=h||0;m=m||0;j=j||0;k=k||0;a=a||0;s=s||0;var l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_NO");if(v===V.TYPE_STAR){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_STAR",[h,m]);}else if(v===V.TYPE_LIKE){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE",[h]);}else if(v===V.TYPE_LIKE_DISLIKE){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_DISLIKE",[j,k]);}var n=b.isUsageReportingActive()?this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VIEW_COUNT",[g]):"";return this.getText("IDEA_LIST_ITEM_ALT_ACCESSIBILITY_LABEL",[i,o.ideaPhase(p),a+1,s,o.ideaStatus(S),l,e,n]);};o.campaignAccessibilityLabel=function(n,v,t,T,i,a,s,e){var g=o.daysLeft.apply(this,[v]);var h=(a+s===2);t=t||0;T=T||0;i=i||0;var j=b.isUsageReportingActive()?this.getText("CAMPAIGN_LIST_ALT_ACCESSIBILITY_LABEL_VIEW_COUNT",[i]):"";if(!e){return this.getText("CAMPAIGN_LIST_ALT_ACCESSIBILITY_LABEL"+(h?"_NEW_SUBMITTABLE":""),[n,g,t,T,j]);}else{return this.getText("CAMPAIGN_LIST_ITEM_ALT_ACCESSIBILITY_LABEL_REGISTER",[n]);}};o.campaignAccessibilityLabelBackOfficeHome=function(n,v,u,t,T,i,a,s,e){var g=o.daysLeft.apply(this,[v]);var h=(a+s===2);u=u||0;t=t||0;T=T||0;i=i||0;var j=b.isUsageReportingActive()?this.getText("CAMPAIGN_LIST_ALT_ACCESSIBILITY_LABEL_VIEW_COUNT",[i]):"";if(e){return this.getText("CAMPAIGN_LIST_ITEM_ALT_ACCESSIBILITY_LABEL_REGISTER",[n]);}return this.getText("CAMPAIGN_LIST_ALT_ACCESSIBILITY_BACKOFFICEHOME",[n,g,u,t,T,j]);};o.campaignAccessibilityLabelListItem=function(n,v,t,T,i,a,s){var e=o.daysLeft.apply(this,[v]);var g=(a+s===2);t=t||0;T=T||0;i=i||0;var h=b.isUsageReportingActive()?this.getText("CAMPAIGN_LIST_ALT_ACCESSIBILITY_LABEL_VIEW_COUNT",[i]):"";return this.getText("CAMPAIGN_LIST_ITEM_ALT_ACCESSIBILITY_LABEL",[n,e,t,T,h]);};o.comAccessibilityLabelListItem=function(){if(!arguments||!arguments.length){return false;}return Array.prototype.join.call(arguments,' ');};o.blogAccessibilityLabelListItem=function(s,a,A,i){return this.getText("BLOG_LIST_ITEM_ALT_ACCESSIBILITY_LABEL",[s,a,A,i]);};o.registerAccessibilityApprovalListItem=function(n,v,s,r,a,S){var e=o.daysLeft.apply(this,[v]);var g=o.submissionDaysLeft.apply(this,[s]);return this.getText("REGISTER_APPROVAL_LIST_ITEM_ALT_ACCESSIBILITY_LABEL",[n,e,g,r,a,S]);};o.blogNavigationLink=function(i,s){if(!isNaN(parseInt(i,10))){var p={id:i};if(s){p.query={section:s};}return B.navigationLink.apply(this,["blog-display",p]);}return undefined;};o.controlTooltip=function(s,t){var r=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");return!t?r.getText(s):r.getText(s,t);};o.formatMsg=function(t){if(arguments){return jQuery.sap.formatMessage(t,Array.prototype.splice.call(arguments,1));}};o.viewCount=function(n){if(n){var a=N.getIntegerInstance({style:"short"});return a.format(n);}return"1";};o.toInt=function(n){var i=parseInt(n,10);if(isNaN(i)){i=0;}return i;};o.toFloat=function(n){var i=parseFloat(n);if(isNaN(i)){i=0;}return i;};o.votingActive=function(s,v,i,a,e){var S=(a>0&&e>0)||!a;return v>0&&I.Draft!==s&&I.Discontinued!==s&&I.Merged!==s&&S&&i>0;};o.commentTooltip=function(i,a,e){var s=e>0&&i>0||!e;if(a>0&&s){return this.getText("CTRL_IDEACARD_BUT_COMMENT_BUTTON");}return this.getText("VOTE_MSG_COMMENT_NO_PRIVILEGE");};o.voteTooltip=function(s,v,i,p,a,e,S,u,g,h,j){var P=s!==I.Draft&&s!==I.Discontinued&&s!==I.Merged;if(!P){return this.getText("VOTE_MSG_VOTING_NOT_POSSIBLE");}var k=(j>0&&v>0)||!j;if(!k||!h){return this.getText("VOTE_MSG_VOTING_NO_PRIVILEGE");}var l=i>0;if(!l){return this.getText("VOTE_MSG_VOTING_INACTIVE",[C.getText("sap.ino.xs.object.campaign.Phase.Root",p)]);}switch(a){case V.TYPE_STAR:var m=f.format(this.formatter.toFloat(S));if(u){return this.getText("VOTE_FLD_STAR_RATING_TOOLTIP_USER_VOTED",[u,e,m]);}else if(!g){return this.getText("VOTE_FLD_STAR_RATING_TOOLTIP");}break;case V.TYPE_LIKE:if(u){return this.getText("VOTE_FLD_LIKE_TOOLTIP_USER_VOTED",[u,e,m]);}else if(!g){return this.getText("VOTE_FLD_LIKE_TOOLTIP");}break;case V.TYPE_LIKE_DISLIKE:if(u){if(u===1){return this.getText("VOTE_FLD_LIKE_DISLIKE_LIKE_TOOLTIP_USER_VOTED",[u,e,m]);}if(u===-1){return this.getText("VOTE_FLD_LIKE_DISLIKE_DISLIKE_TOOLTIP_USER_VOTED",[u,e,m]);}}else if(!g){return this.getText("VOTE_FLD_LIKE_DISLIKE_TOOLTIP");}break;}return this.getText("IDEA_LIST_ALT_IDEA_VOTE_TOOLTIP_VOTE");};o.isDraft=function(s){return s===I.Draft;};o.isFinal=function(s){var S;jQuery.each(b.getBackendConfiguration().ideaStatus,function(i,a){if(a.CODE===s){S=a.STATUS_TYPE;return;}});return s===I.Completed||s===I.Discontinued||s===I.Merged||S===I.TypeCompleted||S===I.TypeDiscontinued;};o.isMerged=function(s){return s===I.Merged;};o.linkLabel=function(l,u){return l||u;};o.imageIcon=function(i){return!i?"sap-icon://person-placeholder":"";};o.isNewObject=function(){var a=this.getObjectModel();return a&&a.isNew();};o.isExistingObject=function(){var a=this.getObjectModel();return a&&!a.isNew();};o.getLikeIconUrl=function(){return c.getIconURI("heart","InoIcons");};o.widthCampaignBanner=function(s){if(s.phone){return"300px";}else{return"350px";}};o.heightCampaignBanner=function(s){if(s.phone){return"160px";}else{return"213px";}};o.blogStatus=function(s){return s==="sap.ino.config.DRAFT"?this.getText("BLOG_LIST_MIT_DRAFT_STATUS"):"";};o.isBlogStatusDraft=function(s){return s==="sap.ino.config.DRAFT";};o.urlVisible=function(u){return jQuery.sap.validateUrl(u);};o.ideaShortDescription=function(e){function p(s){if(jQuery.parseHTML){var a=jQuery.parseHTML(s);if(a){var g=0,h=a.length;while(g<h&&a[g].nodeType!==1){g++;}while(g<h&&a[h-1].nodeType!==1){h--;}if(g>0||h<a.length){a=a.slice(g,h);}return jQuery(a);}}return jQuery(s);}if(e){e="<span>"+e+"</span>";var P=p(e);var t=P&&P[0]&&P[0].innerText;return t;}return e;};o.enableRejectOKButton=function(r){if(r.length>0){return true;}return false;};return o;});
