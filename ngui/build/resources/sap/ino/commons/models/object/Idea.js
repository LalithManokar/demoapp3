/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
sap.ui.define(["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/models/core/ReadSource","sap/ino/commons/models/core/Extensibility","sap/ino/commons/application/Configuration","sap/ui/core/message/Message","sap/ui/core/MessageType","sap/ui/core/format/DateFormat","sap/ino/controls/IdeaAttachmentRoleType","sap/ino/controls/IdeaStatusType","sap/ino/controls/IdeaStatusActionType","sap/ino/commons/models/core/CodeModel"],function(A,P,R,E,C,M,a,D,I,b,c,d){"use strict";var e=A.extend("sap.ino.commons.models.object.Idea",{objectName:"sap.ino.xs.object.idea.Idea",readSource:R.getDefaultODataSource("IdeaFull",{excludeNodes:["Relations"],includeNodes:["Evaluations"]}),invalidation:{entitySets:["IdeaFull","IdeaMedium","IdeaMediumCommunity","IdeaSmall","IdeaMediumSearch","IdeaMediumBackofficeSearch","CampaignEntityCount","MyIdeaMediumCommunity","MyIdeaFollow"]},actionImpacts:{"create":[{"entitySetName":"EntityCount","entitySetKey":"1","impactedAttributes":["AUTHORED_IDEA_COUNT"]}],"modifyAndSubmit":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["UNASSIGNED_IDEAS_COUNT"]}],"assignCoach":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["UNASSIGNED_IDEAS_COUNT"]}],"modifyAndAutoAssignCoach":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["UNASSIGNED_IDEAS_COUNT"]}],"autoAssignCoach":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["UNASSIGNED_IDEAS_COUNT"]}],"unassignCoach":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["UNASSIGNED_IDEAS_COUNT"]}],"del":[{"entitySetName":"EntityCount","entitySetKey":"1","impactedAttributes":["AUTHORED_IDEA_COUNT"]}]},determinations:{onCreate:h,onRead:j},actions:{executeStatusTransition:{initParameter:k},modifyAndSubmit:{enabledCheck:function(Q){var S=Q.getProperty("/STATUS_CODE");return S===b.Draft;},execute:function(Q,S,T,U,V){var W=new jQuery.Deferred();var X=S.modify(V);X.fail(W.reject);X.done(function(){var Y=S.submit(T,V);Y.fail(W.reject);Y.done(function(){T.VOTE_TYPE_TYPE_CODE=S.getProperty("/VOTE_TYPE_TYPE_CODE");T.MAX_STAR_NO=S.getProperty("/MAX_STAR_NO");if(S.getProperty("/VOTING_ACTIVE")&&S.getProperty("/AUTO_VOTE")){var Z=S.autoVote(T,V);Z.fail(W.reject);Z.done(W.resolve);}else{W.resolve();}});});return W.promise();}},del:{enabledCheck:function(Q,S){if(S===undefined){return false;}}},modifyAndAutoAssignCoach:{execute:function(Q,S,T,U,V){var W=new jQuery.Deferred();var X=S.modify(V);X.fail(W.reject);if(S.getData().COACH_ID===T.DEFAULT_COACH){X.done(W.resolve);}else{X.done(function(){var Y=S.autoAssignCoach(T,V);Y.fail(W.reject);Y.done(W.resolve);});}return W.promise();}}},setProperty:s,setData:f,addWall:l,removeWall:r,addInternalWall:m,removeInternalWall:n,addContributor:o,addTag:t,modifyLink:u,addLink:v,addAttachment:x,addInternalAttachment:y,removeAttachment:z,setTitleImage:G,clearTitleImage:H,hasInitialDescription:J,isSubmitted:K,createWall:O,delVotesSimulate:N});e.isPhaseChange=function(S){return S===c.nextPhase||S===c.prevPhase;};e.isFinalStatus=function(S){return S===b.Discontinued||S===b.Completed||S===b.Merged;};function s(Q,V,S,T){var U=false;U=A.prototype.setProperty.apply(this,arguments);var W=(Q[0]==="/"?Q.substring(1):Q);if(W==="CAMPAIGN_ID"){var X=this.getReadSourceModel();var Y=this;var Z=V;if(Z===""||Z==="0"){Z=0;A.prototype.setProperty.apply(this,[Q,Z,S,T]);}var $=function(a1){Y.setProperty("/CAMPAIGN_NAME",a1.NAME);Y.setProperty("/CAMPAIGN_SHORT_NAME",a1.SHORT_NAME);Y.setProperty("/CAMPAIGN_COLOR",a1.COLOR_CODE);Y.setProperty("/STEPS",a1.PHASE_COUNT);Y.setProperty("/CAMPAIGN_BACKGROUND_IMAGE_ID",a1.CAMPAIGN_BACKGROUND_IMAGE_ID);Y.setProperty("/CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID",a1.CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID);Y.setProperty("/CAMPAIGN_VOTE_TYPE_CODE",a1.VOTE_TYPE_CODE);Y.setProperty("/RESP_NAME",a1.RESP_NAME);Y.setProperty("/RESP_CODE",a1.RESP_CODE);Y.setProperty("/RESP_DESCRIPTION",a1.RESP_DESCRIPTION);Y.setProperty("/RESP_LIST_VISIBLE",false);Y.setProperty("/REWARD_ACTIVE",a1.REWARD_ACTIVE);Y.setProperty("/AUTO_ASSIGN_RL_COACH",a1.IS_AUTO_ASSIGN_RL_COACH);Y.setProperty("/OPEN_ANONYMOUS_FOR_IDEA",a1.IS_OPEN_ANONYMOUS_FUNCTION);if(a1.RESP_CODE){Y.setProperty("/RESP_LIST_VISIBLE",true);}if(Y.hasInitialDescription(a1.IDEA_DESCRIPTION_TEMPLATE)){Y.setProperty("/IDEA_DESCRIPTION_TEMPLATE",a1.IDEA_DESCRIPTION_TEMPLATE||"");Y.setProperty("/DESCRIPTION",a1.IDEA_DESCRIPTION_TEMPLATE||"");}};if(Z===0){$({NAME:"",SHORT_NAME:"",COLOR_CODE:"",PHASE_COUNT:4,IDEA_DESCRIPTION_TEMPLATE:""});}else{X.read("/CampaignSmall("+Z+")",{success:function(a1){$(a1);}});}}return U;}function f(Q){A.prototype.setData.apply(this,arguments);if(Q.CAMPAIGN_ID>0){this.setProperty("/CAMPAIGN_ID",Q.CAMPAIGN_ID);}}function i(Q){Q.Walls=jQuery.extend(true,[],Q.Walls||[]);Q.InternalWalls=jQuery.extend(true,[],Q.InternalWalls||[]);var W=Q.Walls.concat(Q.InternalWalls);if(W&&W.length>0){var S=[];jQuery.each(W,function(U,V){S.push(V.WALL_ID);});jQuery.sap.require("sap.ino.commons.models.object.Wall");var T=sap.ino.commons.models.object.Wall;T.readWalls(S,false).done(function(U){jQuery.each(W,function(V,X){jQuery.each(U,function(V,Y){if(X.WALL_ID===Y.ID){X.NAME=Y.NAME;X.BACKGROUND_IMAGE_URL=Y.BACKGROUND_IMAGE_URL;X.BACKGROUND_IMAGE_ZOOM=Y.BACKGROUND_IMAGE_ZOOM;X.BACKGROUND_IMAGE_REPEAT=Y.BACKGROUND_IMAGE_REPEAT;X.BACKGROUND_COLOR=Y.BACKGROUND_COLOR;X.BackgroundImage=Y.BackgroundImage||[];X.CREATED_BY_NAME=Y.CREATED_BY_NAME;X.Items=[];jQuery.each(Y.Items||[],function(V,Z){if(Z.WALL_ID===X.WALL_ID){X.Items.push(Z);}});}});});});}return Q;}function g(Q){var S=Q.ContributionShare;jQuery.each(Q.SubmitterContributorsCoach,function(T,U){if(U.ROLE_CODE==="IDEA_SUBMITTER"||U.ROLE_CODE==="IDEA_CONTRIBUTOR"){var V=S.filter(function(W){return W.AUTHOR_ID===U.IDENTITY_ID;});if(V.length>0){U.iContributionShare=V[0].PERCENTAGE;}}});}function h(Q,S){var T=jQuery.map(Q.Tags||[],function(W){return{ID:S.getNextHandle(),NAME:W};});var U=C.getCurrentUser();var V={"NAME":Q.NAME||"","DESCRIPTION":Q.DESCRIPTION||"","STATUS_CODE":b.Draft,"CREATED_AT":new Date(),"CREATED_BY_NAME":U.NAME,"STEP":-1,"STEPS":4,"CAMPAIGN_NAME":null,"CAMPAIGN_ID":Q.CAMPAIGN_ID||0,"Tags":T,"Walls":Q.Walls&&Q.Walls.length>0?Q.Walls:[]};V=i(V);return E.initExtensionNode(V,"Extension",S);}function _(Q){jQuery.each(Q.FieldsValue,function(S,T){if(T.VALUE_OPTION_LIST_CODE){var U="sap.ino.xs.object.basis.ValueOptionList.Root_"+T.VALUE_OPTION_LIST_CODE;T.valueOptionList=d.getCodes(U,function(V){return V.ACTIVE===1;});}});}function j(Q,S){Q=i(Q);Q.SubmitterContributorsCoach=(Q.Submitter||[]).concat(Q.Contributors||[]).concat(Q.Coach||[]);Q.SubmitterContributors=(Q.Submitter||[]).concat(Q.Contributors||[]);Q.SubmitterCoach=Q.Coach;g(Q);_(Q);if(S.getProperty("/EDITABLE")!==undefined){Q.EDITABLE=S.getProperty("/EDITABLE");}if(Q.FieldsValue&&Q.FieldsValue.length>0){Q.FieldsValue.sort(function(T,U){if(T.SEQUENCE_NO<U.SEQUENCE_NO){return-1;}else{return 1;}});}if(Q.AdminFieldsValue&&Q.AdminFieldsValue.length>0){Q.AdminFieldsValue.sort(function(T,U){if(T.SEQUENCE_NO<U.SEQUENCE_NO){return-1;}else{return 1;}});}return E.initExtensionNode(Q,"Extension",S);}function k(Q,S,T){var U=D.getDateInstance({pattern:"yyyy-MM-dd"});var V=U.format(new Date());var W="";var X=null;var Y=C.getCurrentUser();if(Y){W=Y.NAME;X=Y.USER_ID;}Q.STATUS_ACTION_CODE=T;var Z=S.getProperty("/actions/executeStatusTransition/customProperties/statusTransitions");var $=jQuery.grep(Z,function(b1){return b1.STATUS_ACTION_CODE===T;})[0];Q.REWARD_ACTIVE=$&&$.REWARD_ACTIVE;Q.NEXT_STATUS_CODE=$&&$.NEXT_STATUS_CODE;Q.NEXT_PHASE_CODE=$&&$.NEXT_PHASE_CODE;Q.IS_PHASE_CHANGE=$&&e.isPhaseChange(T);Q.IS_DECISION_RELEVANT=!!($&&$.DECISION_RELEVANT);Q.INCLUDE_RESPONSE=$&&$.INCLUDE_RESPONSE;Q.DECISION_REASON_LIST_CODE=$&&$.DECISION_REASON_LIST_CODE;Q.DECISION_REASON_LIST_VISIBLE=$&&$.DECISION_REASON_LIST_VISIBLE;Q.TEXT_MODULE_CODE=$&&$.TEXT_MODULE_CODE;Q.DECIDER_ID=X;if(Q.IS_DECISION_RELEVANT){Q.DECISION_DATE=V;Q.REASON="";Q.SEND_RESPONSE=Q.INCLUDE_RESPONSE;Q.RESPONSE="";Q.DECIDER_NAME=W;Q.NOTIFY_AUTHOR=true;Q.REASON_CODE="";Q.LINK_LABEL="";Q.LINK_URL="";if(Q.DECISION_REASON_LIST_CODE){var a1="sap.ino.xs.object.basis.ValueOptionList.ValueOptions";Q.reasonList=d.getCodes(a1,function(b1){return b1.LIST_CODE===Q.DECISION_REASON_LIST_CODE&&b1.ACTIVE===1;});}}}function l(Q){var W=this.getProperty("/Walls");var S=jQuery.grep(W,function(T){return T.WALL_ID===Q.WALL_ID;});if(S.length===0){delete Q.ID;this.addChild(Q,"Walls");Q.WALL_ASSIGN_ID=Q.ID;}}function r(W){var Q=this;var S=jQuery.grep(Q.getProperty("/Walls")||[],function(T){return T.WALL_ID===W;});jQuery.each(S,function(T,U){Q.removeChild(U);});}function m(Q){var W=this.getProperty("/InternalWalls");var S=jQuery.grep(W,function(T){return T.WALL_ID===Q.WALL_ID;});if(S.length===0){delete Q.ID;this.addChild(Q,"InternalWalls");Q.WALL_ASSIGN_ID=Q.ID;}}function n(W){var Q=this;var S=jQuery.grep(Q.getProperty("/InternalWalls")||[],function(T){return T.WALL_ID===W;});jQuery.each(S,function(T,U){Q.removeChild(U);});}function o(Q){var S;if(!Q.NAME||jQuery.trim(Q.NAME).length===0){S=new M({key:"MSG_IDEA_INVALID_EMPTY_CONTRIBUTOR",type:a.Error,group:"CONTRIBUTOR"});return S;}if(!Q.IDENTITY_ID){S=new M({key:"MSG_IDEA_INVALID_CONTRIBUTOR",type:a.Error,group:"CONTRIBUTOR"});return S;}var T=this.getProperty("/Contributors");var U=jQuery.grep(T,function(V){return V.IDENTITY_ID===Q.IDENTITY_ID;});if(U.length===0){this.addChild(Q,"Contributors");}}function p(Q){var S;if(!Q.NAME||jQuery.trim(Q.NAME).length===0){S=new M({key:"MSG_IDEA_INVALID_EMPTY_EXPERT",type:a.Error,group:"EXPERT"});return S;}if(!Q.IDENTITY_ID){S=new M({key:"MSG_IDEA_INVALID_EXPERT",type:a.Error,group:"EXPERT"});return S;}var T=this.getProperty("/Experts");var U=jQuery.grep(T,function(V){return V.IDENTITY_ID===Q.IDENTITY_ID;});if(U.length===0){this.addChild(Q,"Experts");}}function q(Q){var S=this.getProperty("/Experts");var T=jQuery.grep(S,function(V){return V.IDENTITY_ID===Q;});var U=T[0];if(U){this.removeChild(U,"Experts");}}function t(Q){var S;var T=this.getProperty("/Tags");if(!Q.NAME||jQuery.trim(Q.NAME).length===0){S=new M({key:"MSG_INVALID_EMPTY_TAG",type:a.Error,group:"TAG"});return S;}Q.NAME=jQuery.trim(Q.NAME);if(!Q.TAG_ID&&Q.NAME){Q.TAG_ID=this.getNextHandle();}var U=jQuery.grep(T,function(V){return V.NAME.toLowerCase()===Q.NAME.toLowerCase();});if(U.length===0){this.addChild(Q,"Tags");}else{return new M({key:"MSG_DUPLICATE_TAG",type:a.Error});}}function u(Q,U,S){return this.addLink(U,S,Q);}function v(U,Q,S){var T;U=U.trim();if(!U||U===""){T=new M({code:"IDEA_OBJECT_MSG_LINK_URL_NOT_ALLOWED",type:a.Error});return T;}if(U&&U.indexOf("http://")!==0&&U.indexOf("https://")!==0&&U.indexOf("mailto:")!==0){U="http://"+U;}if(!U||U===""||!jQuery.sap.validateUrl(U)){T=new M({code:"IDEA_OBJECT_MSG_LINK_URL_NOT_ALLOWED",type:a.Error});return T;}if(!Q||Q===""){Q=null;}var V={ID:S,LABEL:Q,URL:U};if(S!==undefined){this.updateNode(V,"Links");}else{this.addChild(V,"Links");}}function w(Q,S,T){this.addChild({TARGET_OBJECT_TYPE_CODE:Q,TARGET_OBJECT_ID:S,SEMANTIC:T},"Relations");}function x(Q){Q.ROLE_TYPE_CODE="ATTACHMENT";this.addChild(Q,"Attachments");}function y(Q){Q.ROLE_TYPE_CODE="ATTACHMENT";this.addChild(Q,"InternalAttachments");}function z(Q){var S=jQuery.grep(this.getProperty("/Attachments")||[],function(T){return T.ATTACHMENT_ID===Q;});var T=S&&S[0];if(T){if(T.ROLE_TYPE_CODE==="IDEA_TITLE_IMAGE"){this.setProperty("/TITLE_IMAGE_ASSIGN_ID",null);this.setProperty("/TITLE_IMAGE_ID",null);}this.removeChild(T);}var U=jQuery.grep(this.getProperty("/InternalAttachments")||[],function(V){return V.ID===Q;});var V=U&&U[0];if(V){this.removeChild(V);}}function B(Q){jQuery.each(Q,function(S,T){if(T.ROLE_TYPE_CODE===I.TitleImage){T.ROLE_TYPE_CODE=I.Standard;}});}function F(Q){return jQuery.grep(Q,function(S){return S.ROLE_TYPE_CODE!==I.TitleImage;});}function G(Q){var S=this.getProperty("/Attachments");var T=jQuery.grep(S||[],function(X){return X.ATTACHMENT_ID===Q.ATTACHMENT_ID;});S=F(S);var U=T&&T[0];if(!U){var V=this.getProperty("/InternalAttachments");var W=jQuery.grep(V||[],function(X){return X.ATTACHMENT_ID===Q.ATTACHMENT_ID;});U=W&&W[0];if(U){U=jQuery.extend({},U);}else{U={};}U.ID=this.getNextHandle();S.push(U);}U.ATTACHMENT_ID=Q.ATTACHMENT_ID;U.FILE_NAME=Q.FILE_NAME?Q.FILE_NAME:U.FILE_NAME;U.MEDIA_TYPE=Q.MEDIA_TYPE?Q.MEDIA_TYPE:U.MEDIA_TYPE;U.ROLE_TYPE_CODE=I.TitleImage;this.setProperty("/TITLE_IMAGE_ASSIGN_ID",U.ID);this.setProperty("/TITLE_IMAGE_ID",U.ATTACHMENT_ID);this.setProperty("/TITLE_IMAGE_MEDIA_TYPE",U.MEDIA_TYPE);this.setProperty("/Attachments",S);}function H(){var Q=this.getProperty("/Attachments");Q=F(Q);this.setProperty("/Attachments",Q);this.setProperty("/TITLE_IMAGE_ASSIGN_ID",null);this.setProperty("/TITLE_IMAGE_ID",null);this.setProperty("/TITLE_IMAGE_MEDIA_TYPE",null);}function J(Q){var S=this.getProperty("/DESCRIPTION");var T=this.getProperty("/IDEA_DESCRIPTION_TEMPLATE")||Q||"";var U="<p>"+T+"</p>";return!S||S===""||S==="<br>"||S==="<div><br></div>"||S===T||S===U;}function K(){return(this.getProperty("/SUBMITTED_AT")!==null);}function L(T){var Q={DOCUMENT:"DOCUMENT",IMAGE:"IMAGE",VIDEO:"VIDEO",AUDIO:"AUDIO",TEXT:"TEXT",ERROR:"ERROR",DEFAULT:"DOCUMENT"};if(T===Q.IMAGE||T.indexOf("image/")===0){T=Q.IMAGE;}else if(T===Q.VIDEO||T.indexOf("video/")===0){T=Q.VIDEO;}else if(T===Q.AUDIO||T.indexOf("audio/")===0){T=Q.AUDIO;}else if(T===Q.TEXT||T.indexOf("text/")===0){T=Q.TEXT;}else if(T===Q.ERROR){T=Q.ERROR;}else if(T===Q.DOCUMENT){T=Q.DOCUMENT;}else{T=Q.DEFAULT;}return T;}function N(){var Q=this.getProperty("/VOTE_TYPE_CODE")!==this.getProperty("/CAMPAIGN_VOTE_TYPE_CODE");var S=this.getProperty("/VOTE_COUNT")>0;return(Q&&S);}function O(Q){var S=this.getData();var T=this;var U=4900;var V=200;var W=1;var X=0;var Y=0;var Z=[];var $=[];function a1(l1,m1,n1,o1,p1){l1.POSITION_X=U+(m1||0);l1.POSITION_Y=U+(n1||0)+(V*X)+Y;l1.WIDTH=o1||V;l1.HEIGHT=p1||V;l1.ZINDEX=W;Z.push(l1);W++;X++;if(p1){Y+=(p1-(V/2));}}function b1(l1,m1,n1,o1,p1,q1){if(l1.length===0){return;}var r1=((o1||V)+(q1||0));var s1=l1.length*r1;jQuery.each(l1,function(t1,u1){u1.POSITION_X=U+(m1||0)-(s1/2)+(t1+0.5)*r1;u1.POSITION_Y=U+(n1||0)+(V*X)+Y;u1.WIDTH=o1||V;u1.HEIGHT=p1||V;u1.ZINDEX=W;Z.push(u1);W++;});X++;if(p1){Y+=(p1-(V/2));}}a1({"WALL_ITEM_TYPE_CODE":"sap.ino.config.LINK","CONTENT":{"TEXT":S.NAME||"","ICON":"IDEA","URL":Q.getNavigationLink("idea-display",{id:this.getKey()})}},50);a1({"WALL_ITEM_TYPE_CODE":"sap.ino.config.PERSON","CONTENT":{"NAME":S.SUBMITTER_NAME||"","PHONE":"","EMAIL":S.SUBMITTER_EMAIL||"","ORIGIN_ID":S.SUBMITTER_ID,"REQUEST_IMAGE":true}});if(S.Contributors&&S.Contributors.length>0){var c1=[];jQuery.each(S.Contributors,function(l1,m1){c1.push({"WALL_ITEM_TYPE_CODE":"sap.ino.config.PERSON","CONTENT":{"NAME":m1.NAME||"","PHONE":"","EMAIL":m1.EMAIL||"","ORIGIN_ID":m1.IDENTITY_ID,"REQUEST_IMAGE":true}});});b1(c1);}if(S.CAMPAIGN_NAME){a1({"WALL_ITEM_TYPE_CODE":"sap.ino.config.HEADLINE","CONTENT":{"TEXT":S.CAMPAIGN_NAME||"","STYLE":"BRAG","SIZE":"H3"}},-25,50);}if(S.DESCRIPTION){a1({"WALL_ITEM_TYPE_CODE":"sap.ino.config.TEXT","CONTENT":{"CAPTION":S.NAME||"","TEXT":S.DESCRIPTION||""}},-275,0,800,400);}if(S.Tags&&S.Tags.length>0){var d1=[];jQuery.each(S.Tags,function(l1,m1){d1.push({"WALL_ITEM_TYPE_CODE":"sap.ino.config.HEADLINE","CONTENT":{"TEXT":m1.NAME||"","STYLE":"COOL","SIZE":"H5"}});});b1(d1);}if(S.Links&&S.Links.length>0){var e1=[];jQuery.each(S.Links,function(l1,m1){$.push(m1.ID);e1.push({"WALL_ITEM_TYPE_CODE":"sap.ino.config.LINK","CONTENT":{"TEXT":m1.LABEL||m1.URL||"","ICON":"MISC","URL":m1.URL||""}});});b1(e1,50,-50);}if(S.Attachments&&S.Attachments.length>0){var f1=[];var g1=[];jQuery.each(S.Attachments,function(l1,m1){if(m1.MEDIA_TYPE.indexOf("image/")===0){f1.push({"WALL_ITEM_TYPE_CODE":"sap.ino.config.IMAGE","CONTENT":{"CAPTION":m1.FILE_NAME||"","SHOW_AS_ICON":false},"Image":[{"ATTACHMENT_ID":m1.ATTACHMENT_ID}]});}else{g1.push({"WALL_ITEM_TYPE_CODE":"sap.ino.config.ATTACHMENT","CONTENT":{"CAPTION":m1.FILE_NAME||"","TYPE":L(m1.MEDIA_TYPE),"FILE_NAME":m1.FILE_NAME||""},"Attachment":[{"ATTACHMENT_ID":m1.ATTACHMENT_ID}]});}});b1(f1,0,0,0,0,50);b1(g1,0,50,0,0,50);}jQuery.sap.require("sap.ino.commons.models.object.Wall");var h1=sap.ino.commons.models.object.Wall;var i1=new jQuery.Deferred();var j1=this;var k1=h1.create({ID:-1,NAME:S.NAME,WALL_TYPE_CODE:"sap.ino.config.WALL",BACKGROUND_COLOR:S.CAMPAIGN_COLOR||"FFFFFF",IDEA_ID:S.ID,Items:Z});k1.done(function(l1){var m1=l1.GENERATED_IDS[-1];var n1=false;if(C.getCurrentUser().USER_ID===S.SUBMITTER_ID){n1=true;}if(S.Contributors&&S.Contributors.length>0){jQuery.each(S.Contributors,function(o1,p1){if(C.getCurrentUser().USER_ID==p1.IDENTITY_ID){n1=true;}});}if(n1){var e1=[];jQuery.each($,function(o1,p1){e1.push({ID:p1});});e1.push({ID:-1,LABEL:Q.getModel("i18n").getResourceBundle().getText("IDEA_OBJECT_TIT_WALL",[S.NAME]),URL:Q.getNavigationLink("wall",{id:m1})});j1.setProperty("/Links",e1);j1.update();}i1.resolve(m1);});k1.fail(function(l1){T.getMessageParser().parse(l1);});return i1.promise();}return e;});
