/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
sap.ui.define(["sap/ui/base/Object"],function(O){"use strict";var C=O.extend("sap.ino.commons.application.Configuration",{});var b=window.location.protocol+'//'+window.location.host;C.getBackendRootURL=function(){return b;};C.getMailPreviewURL=function(P){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_MAIL_PREVIEW")+"?"+jQuery.sap.encodeURLParameters(P);};C.getTextMoudleURL=function(P){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_TEXT_MODULE")+"?"+jQuery.sap.encodeURLParameters(P);};C.getTagcloudServiceURL=function(i,t,S,v,E,h,F){var P=C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_TAGCLOUD")+"?";var j=[];if(i){j.push("CAMPAIGN="+i);}if(t){j=j.concat(t.map(function(T){return"TAG="+T;}));}if(S){j.push("SEARCHTERM="+jQuery.sap.encodeURL(S));}if(E){j.push("EXCL_STATUS=sap.ino.config.DRAFT");}if(v){j.push("FILTERNAME="+v);}j.push("FILTER_BACKOFFICE="+(h?1:0));jQuery.each(F,function(k,l){if(l.key&&l.value){j.push(l.key.toUpperCase()+"="+encodeURIComponent(l.value));}});return P+j.join("&");};function _(m,i,l,L){var P=m==="tag"?"TAG=":"ID=";var E=m==="tag"?"/bytag?":"/byid?";if(i&&!Array.isArray(i)){i=[i];}var h=l?"&limit="+l:"";var j=L?"&ideas="+L:"";return i?C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_EXPERT_SERVICE")+E+i.map(function(k){return P+encodeURIComponent(k);}).join("&")+h+j:null;}C.getIdeaExpertsByTagsURL=function(t,l,L){return _("tag",t,l,L);};C.getIdeaExpertsByIdeaURL=function(i,l,L){return _("id",i,l,L);};C.getRelatedIdeasURL=function(i){if(i&&i>0){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_RELATED_IDEAS_BY_ID")+"/"+i;}else{return null;}};C.getRelatedIdeasByTextURL=function(i){if(typeof i==='number'&&(i%1)===0){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_RELATED_IDEAS_BY_TEXT")+"/"+i;}else{return null;}};C.getUserProfileByTextURL=function(i){if(typeof i==='number'&&(i%1)===0){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_IAM_IDENTITY_PROFILE");}else{return null;}};C.getCampaignSettingsURL=function(i,E){if(typeof i==='number'&&(i%1)===0){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_UI_BACKOFFICE")+encodeURI('#campaign/{"id": '+i+', "mode": '+(E?'"edit"':'"display"')+'}');}else{return null;}};C.getAttachmentDownloadURL=function(A,D,h){if(A&&A>0){h=h?"?type="+h:'';return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_ATTACHMENT_DOWNLOAD")+"/"+A+h;}else{if(D){return D;}return null;}};C.getAttachmentTitleImageDownloadURL=function(A,D,h){if(A&&A>0){h=h?"?type="+h:'';return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_ATTACHMENT_TITLE_IMAGE_DOWNLOAD")+"/"+A+h;}else{if(D){return D;}return null;}};C.getResourceBundleURL=function(r){if(r){var R=C.getSystemSetting("sap.ino.config.URL_PATH_XS_RESOURCE");if(!R){return null;}return C.getBackendRootURL()+"/"+R+"/"+r+".properties";}else{return null;}};C.setBackendRootURL=function(t){b=t;};var B=!!jQuery.sap.getUriParameters().get("sap-ino-backendtrace");C.isBackendTraceActive=function(){return B;};C.setBackendTraceActive=function(A){B=A;};var e=!!jQuery.sap.getUriParameters().get("sap-ino-disable-extensions");C.isExtensionsDisabled=function(){return e;};C.getStylePaths=function(){return this.getBackendConfiguration().styles;};C.getComponentName=function(){return this.getBackendConfiguration().componentName;};C.isComponentActive=function(h){if(this.getBackendConfiguration().systemSettings[h]===undefined||isNaN(this.getBackendConfiguration().systemSettings[h].VALUE)){return false;}return!!parseInt(this.getBackendConfiguration().systemSettings[h].VALUE,10);};C.getSystemSetting=function(k){return this.getBackendConfiguration().systemSettings&&this.getBackendConfiguration().systemSettings[k]&&this.getBackendConfiguration().systemSettings[k].VALUE;};C.getApplicationPath=function(A){return this.getBackendConfiguration().systemSettings[A]&&this.getBackendConfiguration().systemSettings[A].VALUE;};C.getFullApplicationPath=function(A){return this.getBackendRootURL()+"/"+this.getApplicationPath(A);};C.getApplicationObjects=function(){return this.getBackendConfiguration().applicationObjects;};C.getApplicationObject=function(n){return this.getBackendConfiguration().applicationObjects[n];};C.getSystemDefaultLanguage=function(){return this.getBackendConfiguration().systemDefaultLanguage;};C.getURLWhitelist=function(){return this.getBackendConfiguration().urlWhitelist;};C.getCustomConfigurationPackage=function(){return this.getBackendConfiguration().customConfigurationPackage;};C.getInconsistentPackages=function(){return this.getBackendConfiguration().inconsistentPackages;};C.systemMessage=function(){return this.getBackendConfiguration().systemMessage;};C.getSWABaseURL=function(){var U=C.getSystemSetting("sap.ino.config.URL_PATH_SWA_BASE");if(C.isAbsoluteURL(U)){return U;}else{return C.getBackendRootURL()+"/"+U;}};C.getSWATrackerURL=function(){var U=C.getSystemSetting("sap.ino.config.URL_PATH_SWA_TRACKER");if(C.isAbsoluteURL(U)){return U;}else{return C.getBackendRootURL()+"/"+U;}};C.isUsageReportingActive=function(){var t=C.getSystemSetting("sap.ino.config.SWA_ACTIVE");var r=C.getSystemSetting("sap.ino.config.USAGE_REPORTING_ACTIVE");if(t==="0"){return false;}else if(t==="1"&&r==="0"&&(this.hasCurrentUserPrivilege("sap.ino.xs.rest.admin.application::execute")||this.hasCurrentUserPrivilege("sap.ino.ui::camps_coach_role")||this.hasCurrentUserPrivilege("sap.ino.ui::camps_mgr_role"))){return true;}else if(t==="1"&&r==="1"){return true;}else{return false;}};C.getFrontofficeDefaultBackgroundImageURL=function(i){var U=C.getSystemSetting("sap.ino.config.URL_PATH_UI_FRONTOFFICE_DEFAULT_BACKGROUND_IMAGE");if(i){U=C.getSystemSetting("sap.ino.config.URL_PATH_UI_FRONTOFFICE_DEFAULT_HC_BACKGROUND_IMAGE");}return U;};C.getMobileSmallDefaultBackgroundImageURL=function(){return C.getSystemSetting("sap.ino.config.URL_PATH_UI_MOBILE_SMALL_DEFAULT_BACKGROUND_IMAGE");};C.getPPMURL=function(){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_PPM");};C.setupCompleted=function(){return this.getBackendConfiguration().setupCompleted;};C.getXSRFToken=function(){return this.getBackendConfiguration().XSRFToken;};C.setXSRFToken=function(t){this.getBackendConfiguration().XSRFToken=t;jQuery.ajaxSetup({headers:{"X-CSRF-Token":t}});var j=jQuery.ajaxSetup.bind(jQuery);jQuery.ajaxSetup=function(h,i){var r=j(h,i);var R=new RegExp(C.getBackendRootURL(),"igm");if(r.type==="GET"&&i&&C.isAbsoluteURL(i.url)&&!R.test(i.url)){delete r.headers["X-CSRF-Token"];}return r;};};C.validateXSRFToken=function(r){if(r.status===403){var x=r.getResponseHeader("x-csrf-token");if(x&&x.toLowerCase()==="required"){var P=C.getBackendRootURL()+"/sap/ino/xs/rest/common/ping.xsjs";var A=jQuery.ajax({url:P,headers:{"X-CSRF-Token":"Fetch"},type:"GET",contentType:"application/json; charset=UTF-8",async:false});A.done(function(R,h,r){C.setXSRFToken(r.getResponseHeader("X-CSRF-Token"));});return false;}}return true;};C.getTheme=function(){return this.getBackendConfiguration().theme;};C.getCurrentUser=function(){return this.getBackendConfiguration().user;};C.getCurrentUserPrivileges=function(){return this.getBackendConfiguration().privileges;};C.hasCurrentUserPrivilege=function(P){return!!this.getCurrentUserPrivileges()[P];};C.getBackendConfiguration=function(){return g(this.getBackendRootURL());};C.refreshBackendConfiguration=function(){o=null;this.getBackendConfiguration();};C.isAbsoluteURL=function(U){if(U.search(/^http(s)?:\/\//)===-1){return false;}else{return true;}};C.isDevelopmentEnv=function(){return(window.location.search||"").indexOf("development")>-1;};var o;var c;C.getSystemSettingsModel=function(){if(!c){c=new sap.ui.model.json.JSONModel({});}return c;};var u;C.getUserModel=function(){if(!u){u=new sap.ui.model.json.JSONModel({});}return u;};var s;C.getSearchModel=function(){if(!s){s=new sap.ui.model.json.JSONModel({});}return s;};var a;C.getCampaignFilterCountModel=function(){if(!a){a=new sap.ui.model.json.JSONModel({});}return a;};C.getCampaignFilterCountProperty=function(){var m=this.getCampaignFilterCountModel();return m.getProperty('/CampaignFilterCountModel');};C.setCampaignFilterCountProperty=function(h){var m=this.getCampaignFilterCountModel();return m.setProperty("/CampaignFilterCountModel",h);};C.getCampaignFilterCount=function(h,j,v){var U=C.getBackendRootURL()+"/sap/ino/xs/rest/common/campaign_filter_count.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},data:h,type:"GET",contentType:"application/json; charset=UTF-8",async:true});C.getErrorMessage=function(){return A.responseText;};A.done(function(r){a={all:r[0].AMOUNT,active:r[1].AMOUNT,open:r[2].AMOUNT,future:r[3].AMOUNT,past:r[4].AMOUNT,registered:r[5].AMOUNT,manage:r[6].AMOUNT,draft:r[7].AMOUNT,publish:r[8].AMOUNT,submittable:r[9].AMOUNT};for(var i=0;i<v.length;i+=1){j.setProperty("/Variants/Values/"+i+"/COUNT",a[j.getProperty("/Variants/Values/"+i+"/ACTION")]);}});A.fail(function(r){o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(r.responseText);C.userErrorMessage=r.responseText;});return a;};var I,d;C.getIdeaFilterCountModel=function(){if(!d){d=new sap.ui.model.json.JSONModel({});}return d;};C.getIdeaFilterCountData=function(){return this.getIdeaFilterCountModel().getProperty('/FilterCountModel');};C.setIdeaFilterCountModel=function(h){var m=this.getIdeaFilterCountModel();return m.setProperty('/FilterCountModel',h);};C.getIdeaFilterCount=function(h,m,v,j){var U,t=this;U=C.getBackendRootURL()+"/sap/ino/xs/rest/common/idea_filter_count.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},data:h,type:"GET",contentType:"application/json; charset=UTF-8",async:true});C.getErrorMessage=function(){return A.responseText;};A.done(function(r){I={all:r.all||0,my:r.myAuthoredIdeas||0,voted:r.myVotedIdeas||0,commented:r.myCommentedIdeas||0,vote:r.ideasIcanVoteFor||0,completed:r.completedIdeas||0,eval:r.myEvaluatedIdeas||0,evalpending:r.myEvaluatableIdeas||0,manage:r.IdeaTobeManaged||0,managedcompleted:r.ManagedCompletedIdeas||0,follow:r.followedupIdeas||0,unassigned:r.unassignedCoach||0,coachme:r.coachedIdeasByMe||0,evaldone:r.evaluatedIdeas||0,evalopen:r.openForEvaluation||0,mygroup:r.myGroupAuthoredIdeas||0,mygroupvoted:r.myGroupVotedIdeas||0,mygroupcommented:r.myGroupCommentedIdeas||0,following:r.myFollowingIdeas||0};t.setIdeaFilterCountModel(I);for(var i=0;i<v.length;i+=1){if(m.getProperty("/Variants/Values/"+i+"/TYPE_CODE")==="QUICK_LINK_STANDARD_IDEA"){m.setProperty("/Variants/Values/"+i+"/COUNT",I[m.getProperty("/Variants/Values/"+i+"/ACTION")]);}if(j&&m.getProperty("/Variants/Values/"+i+"/ID")===j.ID){m.setProperty("/Variants/Values/"+i+"/COUNT",I[j.ACTION]);}}});A.fail(function(r){o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(r.responseText);C.userErrorMessage=r.responseText;});return m;};C.getCustomerCount=function(h,m){var U;U=C.getBackendRootURL()+"/sap/ino/xs/rest/common/idea_filter_count.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},data:{quickLinkId:h},type:"GET",contentType:"application/json; charset=UTF-8",async:true});C.getErrorMessage=function(){return A.responseText;};A.done(function(r){for(var i=0;i<m.getProperty("/Variants/Values/").length;i+=1){if(m.getProperty("/Variants/Values/"+i+"/ID")===h){m.setProperty("/Variants/Values/"+i+"/COUNT",r[0].AMOUNT);}}});A.fail(function(r){o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(r.responseText);C.userErrorMessage=r.responseText;});return true;};function g(r){if(!o||jQuery.isEmptyObject(o)){var U=r+"/sap/ino/xs/rest/login/login.xsjs/";U+="?locale="+sap.ui.getCore().getConfiguration().getLanguage();U+="&includePrivileges=true";var h=r+"/sap/ino/xs/rest/static/ui_config.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},type:"GET",contentType:"application/json; charset=UTF-8",async:false});C.getErrorMessage=function(){return A.responseText;};var i=function(R){var j={};jQuery.each(R.systemSettings,function(k,l){j[l.CODE]=l.VALUE;});j.BACKEND_ROOT_URL=C.getBackendRootURL();jQuery.each(R.gamificationSetting,function(k,v){j[k]=v;});C.getSystemSettingsModel().setData(j);};A.done(function(R,j,x){if(typeof R==='object'&&R.hasOwnProperty("user")){o=R;C.setXSRFToken(x.getResponseHeader("X-CSRF-Token"));var P={appName:gSAPInoAppName||""};if(C.isExtensionsDisabled()){P.disableExtensions=true;}A=jQuery.ajax({url:h,type:"GET",data:P,contentType:"application/json; charset=UTF-8",async:false});A.done(function(R){jQuery.extend(o,R);C.getUserModel().setProperty("/data",o.user);C.getUserModel().setProperty("/privileges",o.privileges);i(R);});A.fail(function(){o={};jQuery.sap.log.error("reading backend configuration failed.");});}else{o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(R.responseText);}});A.fail(function(R){o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(R.responseText);C.userErrorMessage=R.responseText;});}return o;}var p;function f(){var U=C.getBackendRootURL()+"/sap/ino/xs/rest/common/personalizeSettings.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},type:"GET",contentType:"application/json; charset=UTF-8",async:false});return A.responseText?JSON.parse(A.responseText):{};}C.personalizeModel=function(){if(!p){p=new sap.ui.model.json.JSONModel({});}return p;};C.getPersonalize=function(){var m=this.personalizeModel();var P=m.getProperty('/personalizeSetting');if(!P){P=f();m.setProperty('/personalizeSetting',P);}return m.getProperty('/personalizeSetting');};C.setPersonalize=function(h){var m=this.personalizeModel();return m.setProperty('/personalizeSetting',h);};C.updateCampaignViewCount=function(){var U=C.getBackendRootURL()+"/sap/ino/xs/rest/common/update_campaign_viewCount.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},type:"GET",contentType:"application/json; charset=UTF-8",async:false});C.getErrorMessage=function(){return A.responseText;};A.fail(function(r){o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(r.responseText);C.userErrorMessage=r.responseText;});return;};C.getGroupConfiguration=function(){var G={GROUP:this.getSystemSetting("sap.ino.config.IDEA_COMPANY_VIEW_OPTION")==="sap.ino.config.ORGANIZATION"?"ORGANIZATION":"COMPANY",DISPLAY_LABEL:this.getSystemSetting("sap.ino.config.IDEA_COMPANY_VIEW_TXT"),ENABLE_GROUP_VIEW:this.getSystemSetting("sap.ino.config.ENABLE_IDEA_COMPANY_VIEW")==="1"?true:false};return G;};C.getSysCompanyLabel=function(){return this.getGroupConfiguration().DISPLAY_LABEL;};C.getSysCompanyEnable=function(){if(this.getGroupConfiguration().ENABLE_GROUP_VIEW){return 1;}return 0;};C.getSysCompanyView=function(){if(this.getGroupConfiguration().GROUP==="ORGANIZATION"){return"2";}return"1";};C.getCustomReportsEnable=function(){if(this.getSystemSetting("sap.ino.config.ENABLE_CUSTOM_REPORTS")*1){return true;}return false;};C.getCustomReportsTile=function(){return this.getSystemSetting("sap.ino.config.CUSTOM_REPORTS_TILE_NAME")};return C;});
