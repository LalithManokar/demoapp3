/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
sap.ui.define(["sap/ui/core/format/DateFormat","sap/ui/model/odata/ODataModel","sap/ui/model/odata/v2/ODataModel","sap/ui/model/PropertyBinding","sap/ui/model/CompositeBinding","sap/ui/model/type/Date","sap/ui/model/type/DateTime","sap/ui/model/type/Time","sap/m/MessageBox","sap/m/MessageToast","sap/m/Link","sap/m/Text","sap/m/Label","sap/m/List","sap/m/Table","sap/ui/table/Table","sap/ui/core/Icon","sap/ui/core/BusyIndicator","sap/ino/commons/application/Configuration","sap/ino/commons/util/ExportPPT","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/HBox"],function(D,O,a,P,C,b,c,T,M,d,L,e,f,g,h,U,I,B,k,E,F,l,H){"use strict";var m="csv";var n="xls";var o="txt";var p="xml";var q="pptx";var r="utf-8";var s="text/csv";var t="application/vnd.ms-excel";var u="application/vnd.openxmlformats-officedocument.presentationml.presentation";var R=9999;var v=2500;var w=1000;var x=50;var y="Export";var z=";";function A(j,K){var N=j.getAggregation("customData");if(N){for(var i=0;i<N.length;i++){if(N[i].getKey()===K){return true;}}}return false;}function G(i){return!A(i,"exportIgnore");}function J(i){return A(i,"is_export");}return{_oBrowser:sap.ui.Device.browser,_getBinding:function(i){if(i instanceof g){return i.getBinding("items");}else if(i instanceof h||i instanceof U){return i.getBinding("rows");}return null;},_getModel:function(i){if(i instanceof g){return i.getModel("data");}else if(i instanceof h){return i.getModel("data");}else if(i instanceof U){return i.getModel()||i.getModel("data");}return null;},_getSelect:function(i){var j=this._getBinding(i);if(i instanceof g){return undefined;}else if(i instanceof h){return undefined;}else if(i instanceof U){if(!j.aAnalyticalInfo){return i.getSelectedIndices();}return j.aAnalyticalInfo&&j.aAnalyticalInfo.filter(function(K){return K.visible;}).map(function(K){return K.name;});}return undefined;},_getControls:function(i){var j={};function K(S,i,V){if(i&&(i instanceof L||i instanceof e||i instanceof H)){if(S){S=S.trim();if(S.indexOf(":",S.length-1)!==-1){S=S.substring(0,S.length-1);}V=V||S;if(!j[V]){j[V]={"label":S,"ctrl":i};return true;}}}return false;}if(i instanceof g){if(i.getItems().length>0){var N=i.getItems()[0];var Q=N.findAggregatedObjects(true);var S="",V="";jQuery.each(Q,function(X,Y){if(!G(Y)){return;}if(Y instanceof f&&Y.getText()){S=Y.getText();V=Y.sId;if(Y.getLabelFor()){var Z=sap.ui.getCore().byId(Y.getLabelFor());K(S,Z,V);}}if(!S&&Y.getTooltip()){S=Y.getTooltip();}if(Y.data("exportLabel")){S=Y.data("exportLabel");}if(K(S,Y)){S="";}V="";});}}else if(i instanceof h||i instanceof U){var W=i.getColumns();jQuery.each(W,function(X,Y){if(G(Y)&&(Y.getVisible()||J(Y)||i.data("bExportAllColumns"))){var S="",V;var Z=Y.getLabel();if(Z){S=Z.getText();V=Z.sId;}var $=Y.getTemplate();if(K(S,$,V)){S="";V="";}}});}return j;},_readContent:function(S,K,N){var Q=this;var V={headers:[],rows:[]};var W=this._getControls(S);jQuery.each(W,function(i,j){V.headers.push(j.label);});if(V.headers.length===0){d.show(Q._getText("GENERAL_EXPORT_TIT_EXPORT_NO_DATA"));return jQuery.Deferred().reject();}var X={"$inlinecount":"allpages","$format":"json"};if(S&&S.getModel()&&S.getModel().getHeaders()&&S.getModel().getHeaders().Accept&&S.getModel().getHeaders().Accept.indexOf("xml")>-1){X["$format"]="xml";}var Y;if(N>0){X.$top=N;}var Z=this._getSelect(S);if(Z){var $=function(i){var j=true;jQuery.each(i,function(h1,i1){if(isNaN(i1)){j=false;return false;}});return j;};if($(Z)){var _=[];var a1=[];var b1=S.getId().indexOf('gamificationReportTable')>-1?true:false;var c1=S.getId().indexOf('gamificationReportTableDetail')>-1?true:false;jQuery.each(Z,function(i,j){var h1=S.getContextByIndex(j).getProperty("REWARD_LIST_ID");if(!b1){if(a1.indexOf(h1)===-1){a1.push(h1);_.push(new F("REWARD_LIST_ID",l.EQ,parseInt(h1,10)));}}else{if(c1){var i1=S.getContextByIndex(j).getProperty("ACTIVITY_ID");_.push(new F("ACTIVITY_ID",l.EQ,i1));}else{var j1=S.getContextByIndex(j).getProperty("DIMENSION_ID");var k1=S.getContextByIndex(j).getProperty("IDENTITY_ID");_.push(new F([new F("DIMENSION_ID",l.EQ,j1),new F("IDENTITY_ID",l.EQ,k1)],true));}}});Y=new F(_,false);}else{X.$select=Z.join(",");}}var d1=this._getBinding(S);if(d1&&d1.aSorter){for(var e1=0;e1<d1.aSorter.length;e1++){if(Z.indexOf(d1.aSorter[e1].sPath)<0){if(X.$select&&X.$select.length>0){X.$select+=","+d1.aSorter[e1].sPath;}else{X.$select=d1.aSorter[e1].sPath;}}}}var f1=d1.getPath();var g1=jQuery.Deferred();this._getModel(S).read(f1,{filters:d1.aFilters.concat(d1.aApplicationFilters,d1.aFilter||[],d1.aApplicationFilter||[],Y||[]),sorters:d1.aSorters.concat(d1.aSorter||[]),urlParameters:X,success:function(h1){var i1=h1.results;if(K===q){g1.resolve(i1);}else{for(var i=0;i<i1.length;i++){var j1={cells:[]};if(i1[i].hasOwnProperty("DOWNLOAD_COUNT")){i1[i].DOWNLOAD_COUNT+=1;}jQuery.each(W,function(k1,l1){var m1={header:l1.label};var n1=i1[i];var o1=l1.ctrl;var p1="String";var q1="";var r1,s1,t1;if(o1 instanceof H&&o1.getItems().length>0){var u1=o1.getItems();var v1={content:"",contentRaw:""};for(var j=0;j<u1.length;j++){v1=Q.getHBoxContent(u1[j],p1,n1,v1);}q1=v1.content;r1=v1.contentRaw;}else{var w1=o1.getBindingInfo("href");if(w1){p1="Href";var x1=o1.getBindingInfo("href");w1=null;}if(!w1){w1=o1.getBindingInfo("text");}if(!w1){w1=o1.getBindingInfo("value");}if(!w1){w1=o1.getBindingInfo("checked");if(w1){p1="Boolean";}}if(!w1){w1=o1.getBindingInfo("tooltip");}if(w1){if(w1.binding){s1=Q._getDataForBinding(o1,n1,w1.binding);if(s1.type){p1=s1.type;}q1=s1.content;r1=s1.contentRaw;}else if(w1.parts){s1=Q._getDataForParts(o1,n1,w1);if(s1.type){p1=s1.type;}q1=s1.content;r1=s1.contentRaw;}}if(x1){if(x1.binding){s1=Q._getDataForBinding(o1,n1,x1.binding);}else if(x1.parts){s1=Q._getDataForParts(o1,n1,x1);}p1="Href";t1=k.getFullApplicationPath("sap.ino.config.URL_PATH_UI_FRONTOFFICE")+"/"+s1.content;}}if(q1===null||q1===undefined){q1="";}if(typeof q1==="boolean"){p1="Boolean";}else if(typeof q1==="number"){if(parseInt(q1,10)===q1){p1="Integer";}else{p1="Number";}}else if(jQuery.type(q1)==="date"){p1="String";q1=q1.toLocaleString();}if(q1&&typeof q1==="string"){q1=q1.replace(/(\r\n|\n|\r)/gm," ");q1=q1.replace('"','\"');}m1.content=q1;m1.contentRaw=r1;if(t1){m1.href=t1;}m1.type=p1;j1.cells.push(m1);});V.rows.push(j1);}g1.resolve(V);}},error:function(){g1.resolve(V);}});return g1.promise();},getHBoxContent:function(i,j,K,N){var Q=this;var S;var V;if(!V){V=i.getBindingInfo("text");}if(!V){V=i.getBindingInfo("value");}if(!V){V=i.getBindingInfo("tooltip");}if(V){if(V.binding){S=Q._getDataForBinding(i,K,V.binding);N.content=S.content?N.content+S.content:N.content;N.contentRaw=S.contentRaw?N.contentRaw+S.contentRaw:N.contentRaw;}else if(V.parts){S=Q._getDataForParts(i,K,V);N.content=S.content?N.content+S.content:N.content;N.contentRaw=S.contentRaw?N.contentRaw+S.contentRaw:N.contentRaw;}}return N;},_getDataForBinding:function(i,j,K){var N=this;var Q,S;var V=[];if(K instanceof C){jQuery.each(K.aBindings,function(Y,Z){S=N._getDataForPropertyBinding(i,j,Z);if(S.type){Q=S.type;}V.push(S.value);});}else if(K instanceof P){S=N._getDataForPropertyBinding(i,j,K);if(S.type){Q=S.type;}V.push(S.value);}if(K.getType()instanceof b){Q="Date";}else if(K.getType()instanceof T){Q="Time";}else if(K.getType()instanceof c){Q="DateTime";}var W="";var X;if(!i.data("exportRaw")){if(K instanceof C){if(K&&K.getFormatter()){W=K.getFormatter().apply(K,V);}else if(K&&K.getType()){W=K.getType().formatValue(V,K.sInternalType||"any");}else if(V.length>1){W=V.join(" ");}else if(V.length>0){W=V[0];}}else if(V.length>0){W=V[0];}}if(V.length>0){X=V[0];}return{type:Q,content:W,contentRaw:X};},_getDataForPropertyBinding:function(i,j,K){var N;var V=this._getDataForPath(i,j,K);if(K.getType()instanceof b){N="Date";}else if(K.getType()instanceof T){N="Time";}else if(K.getType()instanceof c){N="DateTime";}if(V instanceof Date){N="Date";}return{type:N,value:V};},_getDataForPath:function(i,j,K){var V;if(K.getModel()){if(K.getModel()===this.i18n){V=this._getText(K.getPath());}else{V=j[K.getPath()];}}if(!i.data("exportRaw")){if(K.getType()){V=K.getType().formatValue(V,K.sInternalType||"any");}if(K.getFormatter()){V=K.getFormatter().apply(K,[V]);}}return V;},_getDataForParts:function(i,j,K){var N=this;var Q;var V=[];if(K.type){if(K.type instanceof b){Q="Date";}else if(K.type instanceof T){Q="Time";}else if(K.type instanceof c){Q="DateTime";}}jQuery.each(K.parts,function(X,Y){V.push(N._getDataForPart(i,j,Y));});var S="";var W;if(!i.data("exportRaw")){if(K.formatter){S=K.formatter.apply(this,V);}else if(V.length>1){S=V.join(" ");}else if(V.length>0){S=V[0];}}if(V.length>0){W=V[0];}return{type:Q,content:S,contentRaw:W};},_getDataForPart:function(i,j,K){var V=j[K.path];if(!i.data("exportRaw")){if(K.type){V=K.type.formatValue(V,"any");}if(K.formatter){V=K.formatter.apply(K,[V]);}}return V;},_convertToFormat:function(i,j,K,N,Q){if(j===q){E.i18n=this.i18n;return E.convertToFormatPPTX(i);}else{var S=jQuery.Deferred();if(j==m){S.resolve(this._convertToFormatCSV(i,K,N,Q));}else if(j==n){S.resolve(this._convertToFormatXLS(i,K,N,Q));}else{S.resolve("");}return S.promise();}},_convertToFormatCSV:function(K,N,Q,S){var V=["\uFEFF"];for(var i=0;i<K.headers.length;i++){var W=K.headers[i];V.push('"'+W+'"');V.push(",");}V.push("\n");for(i=0;i<K.rows.length;i++){var X=K.rows[i];for(var j=0;j<X.cells.length;j++){var Y=X.cells[j];if(Y.type==="Date"&&Y.contentRaw){V.push('"'+Y.contentRaw.toLocaleDateString()+'"');}else{V.push('"'+Y.content+'"');}V.push(",");}V.push("\n");}return V.join("");},_convertToFormatXLS:function(K,N,Q,S){var V="<?xml version=\"1.0\"?>"+"<Workbook xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\" "+"xmlns:o=\"urn:schemas-microsoft-com:office:office\" "+"xmlns:x=\"urn:schemas-microsoft-com:office:excel\" "+"xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\" "+"xmlns:html=\"http://www.w3.org/TR/REC-html40\">"+"<DocumentProperties xmlns=\"urn:schemas-microsoft-com:office:office\">"+"<LastAuthor>"+jQuery.sap.encodeXML(Q?Q:"Microsoft Office User")+"</LastAuthor>"+"<Created>"+new Date().toISOString()+"</Created>"+"<Version>14.0</Version>"+"</DocumentProperties>"+"<OfficeDocumentSettings xmlns=\"urn:schemas-microsoft-com:office:office\">"+"<AllowPNG/>"+"</OfficeDocumentSettings>"+"<ExcelWorkbook xmlns=\"urn:schemas-microsoft-com:office:excel\">"+"<WindowHeight>10300</WindowHeight>"+"<WindowWidth>25720</WindowWidth>"+"<WindowTopX>900</WindowTopX>"+"<WindowTopY>100</WindowTopY>"+"<ProtectStructure>False</ProtectStructure>"+"<ProtectWindows>False</ProtectWindows>"+"</ExcelWorkbook>"+"<Styles>"+"<Style ss:ID=\"Default\" ss:Name=\"Normal\">"+"<Alignment ss:Vertical=\"Bottom\"/>"+"<Borders/>"+"<Font ss:FontName=\"Calibri\" ss:Size=\"12\" ss:Color=\"#000000\"/>"+"<Interior/>"+"<NumberFormat/>"+"<Protection/>"+"</Style>"+"<Style ss:ID=\"s62\">"+"<Font ss:FontName=\"Calibri\" ss:Size=\"12\" ss:Color=\"#000000\" ss:Bold=\"1\"/>"+"</Style>"+"<Style ss:ID=\"s63\">"+"<NumberFormat ss:Format=\"Short Date\"/>"+"</Style>"+"<Style ss:ID=\"s64\">"+"<NumberFormat ss:Format=\"Fixed\"/>"+"</Style>"+"<Style ss:ID=\"s65\">"+"<NumberFormat ss:Format=\"0\"/>"+"</Style>"+"<Style ss:ID=\"s66\" ss:Name=\"Hyperlink\">"+"<Font ss:Color=\"#0563C1\" ss:Underline=\"Single\"/>"+"</Style>"+"</Styles>";V+="<Worksheet ss:Name=\""+jQuery.sap.encodeXML(S?S:y)+"\">"+"<Names>"+"<NamedRange ss:Name=\"_FilterDatabase\" ss:RefersTo=\"=Export!R1C1:R1C"+K.headers.length+"\" ss:Hidden=\"1\"/>"+"</Names>"+"<Table ss:ExpandedColumnCount=\""+K.headers.length+"\" ss:ExpandedRowCount=\""+(K.rows.length+1)+"\" "+"x:FullColumns=\"1\" x:FullRows=\"1\" ss:DefaultColumnWidth=\"150\" ss:DefaultRowHeight=\"15\">";V+="<Row ss:AutoFitHeight=\"0\">";for(var i=0;i<K.headers.length;i++){var W=K.headers[i];V+="<Cell ss:StyleID=\"s62\"><Data ss:Type=\"String\">"+jQuery.sap.encodeXML(W)+"</Data><NamedCell ss:Name=\"_FilterDatabase\"/></Cell>";}V+="</Row>";for(i=0;i<K.rows.length;i++){var X=K.rows[i];V+="<Row ss:AutoFitHeight=\"0\">";for(var j=0;j<X.cells.length;j++){var Y=X.cells[j];var Z="String";var $=Y.content;var _="";if(Y.type=="Date"&&Y.contentRaw){Z="DateTime";var a1=new Date(Y.contentRaw);$=a1.toISOString();if($[$.length-1]=="Z"){$=$.substring(0,$.length-1);}_=" ss:StyleID=\"s63\"";}else if(Y.type=="Number"){Z="Number";_=" ss:StyleID=\"s64\"";}else if(Y.type=="Integer"){Z="Number";_=" ss:StyleID=\"s65\"";}else if(Y.type=="Boolean"){Z="Boolean";$=$?1:0;}else if(Y.type=="Href"){_=" ss:StyleID=\"s66\" ss:HRef=\""+Y.href+"\"";}if(Z==="String"){if($.indexOf("=")===0){$=$.replace(/=/," =");}$=jQuery.sap.encodeXML($);}V+="<Cell"+_+"><Data ss:Type=\""+Z+"\">"+$+"</Data></Cell>";}V+="</Row>";}V+="</Table>"+"<WorksheetOptions xmlns=\"urn:schemas-microsoft-com:office:excel\">"+"<PageSetup>"+"<Header x:Margin=\"0.3\"/>"+"<Footer x:Margin=\"0.3\"/>"+"<PageMargins x:Bottom=\"0.75\" x:Left=\"0.7\" x:Right=\"0.7\" x:Top=\"0.75\"/>"+"</PageSetup>"+"<Unsynced/>"+"<PageLayoutZoom>0</PageLayoutZoom>"+"<Selected/>"+"<FreezePanes/>"+"<FrozenNoSplit/>"+"<SplitHorizontal>1</SplitHorizontal>"+"<TopRowBottomPane>1</TopRowBottomPane>"+"<ActivePane>2</ActivePane>"+"<Panes>"+"<Pane><Number>3</Number></Pane>"+"<Pane><Number>2</Number><ActiveRow>1</ActiveRow></Pane>"+"</Panes>"+"<ProtectObjects>False</ProtectObjects>"+"<ProtectScenarios>False</ProtectScenarios>"+"</WorksheetOptions>"+"<AutoFilter xmlns=\"urn:schemas-microsoft-com:office:excel\" x:Range=\"R1C1:R1C"+K.headers.length+"\"/>"+"</Worksheet>";V+="</Workbook>";return V;},_downloadContent:function(i,j,K,N){var Q=jQuery("<a/>",{download:j,style:{display:"none"}});jQuery("body").append(Q);var S;if(this._oBrowser.name===this._oBrowser.BROWSER.SAFARI){if(K===u){S=window.URL.createObjectURL(i);}else{S="data:"+K+";"+N+","+encodeURIComponent(i);}var W=window.open(S,"_blank");setTimeout(function(){W.close();},250);}else if(this._oBrowser.name===this._oBrowser.BROWSER.INTERNET_EXPLORER){jQuery(Q).click(function(){window.navigator.msSaveOrOpenBlob(i,j);});Q[0].click();}else{if(K===u){S=window.URL.createObjectURL(i);}else{S="data:"+K;if(N){S+=";charset="+N;}S+=","+encodeURIComponent(i);}jQuery(Q).attr("href",S);Q[0].click();}},_saveContent:function(i,j,K,N){if(K===s){j+="."+o;}else if(K===t){if(this._oBrowser.version<11){j+="."+p;}}var Q=document.createElement("iframe");Q.id="if1";Q.location="about.blank";Q.style.display="none";document.getElementsByTagName("body")[0].appendChild(Q);var S=document.getElementById("if1").contentWindow.document;S.open(K,"replace");if(N){S.charset=N;}S.write(i);S.close();if(N){document.charset=N;}S.execCommand("SaveAs",false,j);document.getElementsByTagName("body")[0].removeChild(Q);},_showConfirmationPopup:function(i,j,K){M.confirm(this._getText("GENERAL_EXPORT_INS_EXPORT_CONFIRMATION",[K]),{title:this._getText("GENERAL_EXPORT_TIT_EXPORT_CONFIRMATION"),icon:M.Icon.NONE,onClose:function(N){if(N=="OK"){i();}else{j();}}});},_showConfirmationPopupMax:function(i,j,K,N){M.confirm(this._getText("GENERAL_EXPORT_INS_EXPORT_CONFIRMATION_MAX",[K,N]),{title:this._getText("GENERAL_EXPORT_TIT_EXPORT_CONFIRMATION"),icon:M.Icon.NONE,onClose:function(Q){if(Q=="OK"){i();}else{j();}}});},_showIEInstructionPopup:function(i,j,K){if(K===n&&this._oBrowser.version>=11){i();return;}var S=jQuery.sap.storage(jQuery.sap.storage.Type.local);var N="sap.ino.commons.util.Export-IEInstructionPopupNotShowAgain-"+K.toUpperCase();if(!S.get(N)){M.confirm(this._getText("GENERAL_EXPORT_INS_EXPORT_IE_INSTRUCTION_DESCR_"+K.toUpperCase()),{title:this._getText("GENERAL_EXPORT_INS_EXPORT_IE_INSTRUCTION_TITLE"),icon:M.Icon.NONE,onClose:function(Q){if(Q=="OK"){S.put(N,true);i();}else{j();}}});}else{i();}},_getText:function(){if(this.i18n){return this.i18n.getResourceBundle().getText.apply(this.i18n.getResourceBundle(),arguments);}return"";},exportEnabled:function(i){if(this._getModel(i)instanceof O||this._getModel(i)instanceof a){return true;}return false;},exportContent:function(i,j,K,N,Q,S,V){if(!this.exportEnabled(i)){return false;}if(j!=m&&j!=n&&j!=q){return false;}var W=this;function X(V){K=K||y+"."+j;var _,a1="";switch(j){case m:_=s;a1=r;break;case n:_=t;break;case q:_=u;break;default:break;}W._readContent(i,j,V).done(function(b1){var c1=W._convertToFormat(b1,j,K,Q,S);c1.done(function(d1){if(W._oBrowser.name!==W._oBrowser.BROWSER.INTERNET_EXPLORER||_===u){W._downloadContent(d1,K,_,a1);N();}else{W._showIEInstructionPopup(function(){W._saveContent(d1,K,_,a1);N();},function(){N();},j);}});c1.fail(function(){N();});}).fail(function(){N();});}var Y=this._getBinding(i);if(j===q&&Y.sPath.indexOf("/Idea")!==0){return false;}var Z=0;switch(j){case m:Z=v;break;case n:Z=w;break;case q:Z=x;break;default:break;}var $;if(Y.bLengthFinal||Y.iTotalSize){$=Y.iLength||Y.iTotalSize||Z;}else{$=Z;}if(V>0){$=V<$?V:$;}if($>Z){this._showConfirmationPopupMax(function(){X(Z);},N,$,Z);}else if($>=R){this._showConfirmationPopup(function(){X(V);},N,$,j);}else{X(V);}return true;},exportAdvanced:function(i,j,K,N,Q,S,V){var W=this;B.show(0);if(N){N.setEnabled(false);}K=K?this._getText(K):y;K=K.replace(new RegExp("[^a-zA-Z0-9 .-]"),"_");var X=K;var Y=D.getDateTimeInstance({pattern:"dd-MM-yyyy_HH-mm"});X+="_"+Y.format(new Date());X+="."+j;setTimeout(function(){if(!W.exportContent(i,j,X,function(){if(N){N.setEnabled(true);}B.hide();if(V){V();}},Q,K,S)){if(N){N.setEnabled(true);}B.hide();if(V){V();}}},0);},exportChartAdvanced:function(i,j,K,N){var Q=this;B.show(0);if(K){K.setEnabled(false);}var S=D.getDateTimeInstance({pattern:"dd-MM-yyyy_HH-mm"});var V=j;V+="_"+S.format(new Date());V+=".svg";setTimeout(function(){var W=i.exportToSVGString();if(Q._oBrowser.name!=Q._oBrowser.BROWSER.INTERNET_EXPLORER){Q._downloadContent(W,V,"image/svg+xml","");}else{Q._saveContent(W,V,"image/svg+xml","");}if(K){K.setEnabled(true);}B.hide();if(N){N();}},0);},exportAdvancedIdea:function(i,j,K,N){this._generateContent(i,j,K,this._autoDownloadContent,N);},_generateContent:function(i,j,K,N,Q){var S=this;B.show(0);if(K){K.setEnabled(false);}jQuery.ajax({url:k.getBackendRootURL()+"/sap/ino/xs/rest/common/export_idea.xsjs",data:j}).always(function(){if(K){K.setEnabled(true);}B.hide();}).done(function(V){d.show(Q(V.messageKey));N.call(S,V.downloadUrl);}).fail(function(V){d.show(Q(V.responseJSON.messageKey));});},_autoDownloadContent:function(i){if(!i){return;}if(!/^http(s)?/.test(i)){i=window.location.protocol+"//"+i;}var j=jQuery("<a/>",{style:{display:"none"}});jQuery("body").append(j);if(this._oBrowser.name===this._oBrowser.BROWSER.SAFARI){var W=window.open(i,"_blank");setTimeout(function(){W.close();},250);}else{jQuery(j).attr("href",i);j[0].click();}}};});
