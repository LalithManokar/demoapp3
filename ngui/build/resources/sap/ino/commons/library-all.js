jQuery.sap.declare('sap.ino.commons.library-all');if(!jQuery.sap.isDeclared('sap.ino.commons.application.Configuration')){
/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
jQuery.sap.declare('sap.ino.commons.application.Configuration');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/ino/commons/application/Configuration",["sap/ui/base/Object"],function(O){"use strict";var C=O.extend("sap.ino.commons.application.Configuration",{});var b=window.location.protocol+'//'+window.location.host;C.getBackendRootURL=function(){return b;};C.getMailPreviewURL=function(P){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_MAIL_PREVIEW")+"?"+jQuery.sap.encodeURLParameters(P);};C.getTextMoudleURL=function(P){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_TEXT_MODULE")+"?"+jQuery.sap.encodeURLParameters(P);};C.getTagcloudServiceURL=function(i,t,S,v,E,h,F){var P=C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_TAGCLOUD")+"?";var j=[];if(i){j.push("CAMPAIGN="+i);}if(t){j=j.concat(t.map(function(T){return"TAG="+T;}));}if(S){j.push("SEARCHTERM="+jQuery.sap.encodeURL(S));}if(E){j.push("EXCL_STATUS=sap.ino.config.DRAFT");}if(v){j.push("FILTERNAME="+v);}j.push("FILTER_BACKOFFICE="+(h?1:0));jQuery.each(F,function(k,l){if(l.key&&l.value){j.push(l.key.toUpperCase()+"="+encodeURIComponent(l.value));}});return P+j.join("&");};function _(m,i,l,L){var P=m==="tag"?"TAG=":"ID=";var E=m==="tag"?"/bytag?":"/byid?";if(i&&!Array.isArray(i)){i=[i];}var h=l?"&limit="+l:"";var j=L?"&ideas="+L:"";return i?C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_EXPERT_SERVICE")+E+i.map(function(k){return P+encodeURIComponent(k);}).join("&")+h+j:null;}C.getIdeaExpertsByTagsURL=function(t,l,L){return _("tag",t,l,L);};C.getIdeaExpertsByIdeaURL=function(i,l,L){return _("id",i,l,L);};C.getRelatedIdeasURL=function(i){if(i&&i>0){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_RELATED_IDEAS_BY_ID")+"/"+i;}else{return null;}};C.getRelatedIdeasByTextURL=function(i){if(typeof i==='number'&&(i%1)===0){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_RELATED_IDEAS_BY_TEXT")+"/"+i;}else{return null;}};C.getUserProfileByTextURL=function(i){if(typeof i==='number'&&(i%1)===0){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_IAM_IDENTITY_PROFILE");}else{return null;}};C.getCampaignSettingsURL=function(i,E){if(typeof i==='number'&&(i%1)===0){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_UI_BACKOFFICE")+encodeURI('#campaign/{"id": '+i+', "mode": '+(E?'"edit"':'"display"')+'}');}else{return null;}};C.getAttachmentDownloadURL=function(A,D,h){if(A&&A>0){h=h?"?type="+h:'';return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_ATTACHMENT_DOWNLOAD")+"/"+A+h;}else{if(D){return D;}return null;}};C.getAttachmentTitleImageDownloadURL=function(A,D,h){if(A&&A>0){h=h?"?type="+h:'';return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_ATTACHMENT_TITLE_IMAGE_DOWNLOAD")+"/"+A+h;}else{if(D){return D;}return null;}};C.getResourceBundleURL=function(r){if(r){var R=C.getSystemSetting("sap.ino.config.URL_PATH_XS_RESOURCE");if(!R){return null;}return C.getBackendRootURL()+"/"+R+"/"+r+".properties";}else{return null;}};C.setBackendRootURL=function(t){b=t;};var B=!!jQuery.sap.getUriParameters().get("sap-ino-backendtrace");C.isBackendTraceActive=function(){return B;};C.setBackendTraceActive=function(A){B=A;};var e=!!jQuery.sap.getUriParameters().get("sap-ino-disable-extensions");C.isExtensionsDisabled=function(){return e;};C.getStylePaths=function(){return this.getBackendConfiguration().styles;};C.getComponentName=function(){return this.getBackendConfiguration().componentName;};C.isComponentActive=function(h){if(this.getBackendConfiguration().systemSettings[h]===undefined||isNaN(this.getBackendConfiguration().systemSettings[h].VALUE)){return false;}return!!parseInt(this.getBackendConfiguration().systemSettings[h].VALUE,10);};C.getSystemSetting=function(k){return this.getBackendConfiguration().systemSettings&&this.getBackendConfiguration().systemSettings[k]&&this.getBackendConfiguration().systemSettings[k].VALUE;};C.getApplicationPath=function(A){return this.getBackendConfiguration().systemSettings[A]&&this.getBackendConfiguration().systemSettings[A].VALUE;};C.getFullApplicationPath=function(A){return this.getBackendRootURL()+"/"+this.getApplicationPath(A);};C.getApplicationObjects=function(){return this.getBackendConfiguration().applicationObjects;};C.getApplicationObject=function(n){return this.getBackendConfiguration().applicationObjects[n];};C.getSystemDefaultLanguage=function(){return this.getBackendConfiguration().systemDefaultLanguage;};C.getURLWhitelist=function(){return this.getBackendConfiguration().urlWhitelist;};C.getCustomConfigurationPackage=function(){return this.getBackendConfiguration().customConfigurationPackage;};C.getInconsistentPackages=function(){return this.getBackendConfiguration().inconsistentPackages;};C.systemMessage=function(){return this.getBackendConfiguration().systemMessage;};C.getSWABaseURL=function(){var U=C.getSystemSetting("sap.ino.config.URL_PATH_SWA_BASE");if(C.isAbsoluteURL(U)){return U;}else{return C.getBackendRootURL()+"/"+U;}};C.getSWATrackerURL=function(){var U=C.getSystemSetting("sap.ino.config.URL_PATH_SWA_TRACKER");if(C.isAbsoluteURL(U)){return U;}else{return C.getBackendRootURL()+"/"+U;}};C.isUsageReportingActive=function(){var t=C.getSystemSetting("sap.ino.config.SWA_ACTIVE");var r=C.getSystemSetting("sap.ino.config.USAGE_REPORTING_ACTIVE");if(t==="0"){return false;}else if(t==="1"&&r==="0"&&(this.hasCurrentUserPrivilege("sap.ino.xs.rest.admin.application::execute")||this.hasCurrentUserPrivilege("sap.ino.ui::camps_coach_role")||this.hasCurrentUserPrivilege("sap.ino.ui::camps_mgr_role"))){return true;}else if(t==="1"&&r==="1"){return true;}else{return false;}};C.getFrontofficeDefaultBackgroundImageURL=function(i){var U=C.getSystemSetting("sap.ino.config.URL_PATH_UI_FRONTOFFICE_DEFAULT_BACKGROUND_IMAGE");if(i){U=C.getSystemSetting("sap.ino.config.URL_PATH_UI_FRONTOFFICE_DEFAULT_HC_BACKGROUND_IMAGE");}return U;};C.getMobileSmallDefaultBackgroundImageURL=function(){return C.getSystemSetting("sap.ino.config.URL_PATH_UI_MOBILE_SMALL_DEFAULT_BACKGROUND_IMAGE");};C.getPPMURL=function(){return C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_PPM");};C.setupCompleted=function(){return this.getBackendConfiguration().setupCompleted;};C.getXSRFToken=function(){return this.getBackendConfiguration().XSRFToken;};C.setXSRFToken=function(t){this.getBackendConfiguration().XSRFToken=t;jQuery.ajaxSetup({headers:{"X-CSRF-Token":t}});var j=jQuery.ajaxSetup.bind(jQuery);jQuery.ajaxSetup=function(h,i){var r=j(h,i);var R=new RegExp(C.getBackendRootURL(),"igm");if(r.type==="GET"&&i&&C.isAbsoluteURL(i.url)&&!R.test(i.url)){delete r.headers["X-CSRF-Token"];}return r;};};C.validateXSRFToken=function(r){if(r.status===403){var x=r.getResponseHeader("x-csrf-token");if(x&&x.toLowerCase()==="required"){var P=C.getBackendRootURL()+"/sap/ino/xs/rest/common/ping.xsjs";var A=jQuery.ajax({url:P,headers:{"X-CSRF-Token":"Fetch"},type:"GET",contentType:"application/json; charset=UTF-8",async:false});A.done(function(R,h,r){C.setXSRFToken(r.getResponseHeader("X-CSRF-Token"));});return false;}}return true;};C.getTheme=function(){return this.getBackendConfiguration().theme;};C.getCurrentUser=function(){return this.getBackendConfiguration().user;};C.getCurrentUserPrivileges=function(){return this.getBackendConfiguration().privileges;};C.hasCurrentUserPrivilege=function(P){return!!this.getCurrentUserPrivileges()[P];};C.getBackendConfiguration=function(){return g(this.getBackendRootURL());};C.refreshBackendConfiguration=function(){o=null;this.getBackendConfiguration();};C.isAbsoluteURL=function(U){if(U.search(/^http(s)?:\/\//)===-1){return false;}else{return true;}};C.isDevelopmentEnv=function(){return(window.location.search||"").indexOf("development")>-1;};var o;var c;C.getSystemSettingsModel=function(){if(!c){c=new sap.ui.model.json.JSONModel({});}return c;};var u;C.getUserModel=function(){if(!u){u=new sap.ui.model.json.JSONModel({});}return u;};var s;C.getSearchModel=function(){if(!s){s=new sap.ui.model.json.JSONModel({});}return s;};var a;C.getCampaignFilterCountModel=function(){if(!a){a=new sap.ui.model.json.JSONModel({});}return a;};C.getCampaignFilterCountProperty=function(){var m=this.getCampaignFilterCountModel();return m.getProperty('/CampaignFilterCountModel');};C.setCampaignFilterCountProperty=function(h){var m=this.getCampaignFilterCountModel();return m.setProperty("/CampaignFilterCountModel",h);};C.getCampaignFilterCount=function(h,j,v){var U=C.getBackendRootURL()+"/sap/ino/xs/rest/common/campaign_filter_count.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},data:h,type:"GET",contentType:"application/json; charset=UTF-8",async:true});C.getErrorMessage=function(){return A.responseText;};A.done(function(r){a={all:r[0].AMOUNT,active:r[1].AMOUNT,open:r[2].AMOUNT,future:r[3].AMOUNT,past:r[4].AMOUNT,registered:r[5].AMOUNT,manage:r[6].AMOUNT,draft:r[7].AMOUNT,publish:r[8].AMOUNT,submittable:r[9].AMOUNT};for(var i=0;i<v.length;i+=1){j.setProperty("/Variants/Values/"+i+"/COUNT",a[j.getProperty("/Variants/Values/"+i+"/ACTION")]);}});A.fail(function(r){o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(r.responseText);C.userErrorMessage=r.responseText;});return a;};var I,d;C.getIdeaFilterCountModel=function(){if(!d){d=new sap.ui.model.json.JSONModel({});}return d;};C.getIdeaFilterCountData=function(){return this.getIdeaFilterCountModel().getProperty('/FilterCountModel');};C.setIdeaFilterCountModel=function(h){var m=this.getIdeaFilterCountModel();return m.setProperty('/FilterCountModel',h);};C.getIdeaFilterCount=function(h,m,v,j){var U,t=this;U=C.getBackendRootURL()+"/sap/ino/xs/rest/common/idea_filter_count.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},data:h,type:"GET",contentType:"application/json; charset=UTF-8",async:true});C.getErrorMessage=function(){return A.responseText;};A.done(function(r){I={all:r.all||0,my:r.myAuthoredIdeas||0,voted:r.myVotedIdeas||0,commented:r.myCommentedIdeas||0,vote:r.ideasIcanVoteFor||0,completed:r.completedIdeas||0,eval:r.myEvaluatedIdeas||0,evalpending:r.myEvaluatableIdeas||0,manage:r.IdeaTobeManaged||0,managedcompleted:r.ManagedCompletedIdeas||0,follow:r.followedupIdeas||0,unassigned:r.unassignedCoach||0,coachme:r.coachedIdeasByMe||0,evaldone:r.evaluatedIdeas||0,evalopen:r.openForEvaluation||0,mygroup:r.myGroupAuthoredIdeas||0,mygroupvoted:r.myGroupVotedIdeas||0,mygroupcommented:r.myGroupCommentedIdeas||0,following:r.myFollowingIdeas||0};t.setIdeaFilterCountModel(I);for(var i=0;i<v.length;i+=1){if(m.getProperty("/Variants/Values/"+i+"/TYPE_CODE")==="QUICK_LINK_STANDARD_IDEA"){m.setProperty("/Variants/Values/"+i+"/COUNT",I[m.getProperty("/Variants/Values/"+i+"/ACTION")]);}if(j&&m.getProperty("/Variants/Values/"+i+"/ID")===j.ID){m.setProperty("/Variants/Values/"+i+"/COUNT",I[j.ACTION]);}}});A.fail(function(r){o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(r.responseText);C.userErrorMessage=r.responseText;});return m;};C.getCustomerCount=function(h,m){var U;U=C.getBackendRootURL()+"/sap/ino/xs/rest/common/idea_filter_count.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},data:{quickLinkId:h},type:"GET",contentType:"application/json; charset=UTF-8",async:true});C.getErrorMessage=function(){return A.responseText;};A.done(function(r){for(var i=0;i<m.getProperty("/Variants/Values/").length;i+=1){if(m.getProperty("/Variants/Values/"+i+"/ID")===h){m.setProperty("/Variants/Values/"+i+"/COUNT",r[0].AMOUNT);}}});A.fail(function(r){o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(r.responseText);C.userErrorMessage=r.responseText;});return true;};function g(r){if(!o||jQuery.isEmptyObject(o)){var U=r+"/sap/ino/xs/rest/login/login.xsjs/";U+="?locale="+sap.ui.getCore().getConfiguration().getLanguage();U+="&includePrivileges=true";var h=r+"/sap/ino/xs/rest/static/ui_config.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},type:"GET",contentType:"application/json; charset=UTF-8",async:false});C.getErrorMessage=function(){return A.responseText;};var i=function(R){var j={};jQuery.each(R.systemSettings,function(k,l){j[l.CODE]=l.VALUE;});j.BACKEND_ROOT_URL=C.getBackendRootURL();jQuery.each(R.gamificationSetting,function(k,v){j[k]=v;});C.getSystemSettingsModel().setData(j);};A.done(function(R,j,x){if(typeof R==='object'&&R.hasOwnProperty("user")){o=R;C.setXSRFToken(x.getResponseHeader("X-CSRF-Token"));var P={appName:gSAPInoAppName||""};if(C.isExtensionsDisabled()){P.disableExtensions=true;}A=jQuery.ajax({url:h,type:"GET",data:P,contentType:"application/json; charset=UTF-8",async:false});A.done(function(R){jQuery.extend(o,R);C.getUserModel().setProperty("/data",o.user);C.getUserModel().setProperty("/privileges",o.privileges);i(R);});A.fail(function(){o={};jQuery.sap.log.error("reading backend configuration failed.");});}else{o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(R.responseText);}});A.fail(function(R){o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(R.responseText);C.userErrorMessage=R.responseText;});}return o;}var p;function f(){var U=C.getBackendRootURL()+"/sap/ino/xs/rest/common/personalizeSettings.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},type:"GET",contentType:"application/json; charset=UTF-8",async:false});return A.responseText?JSON.parse(A.responseText):{};}C.personalizeModel=function(){if(!p){p=new sap.ui.model.json.JSONModel({});}return p;};C.getPersonalize=function(){var m=this.personalizeModel();var P=m.getProperty('/personalizeSetting');if(!P){P=f();m.setProperty('/personalizeSetting',P);}return m.getProperty('/personalizeSetting');};C.setPersonalize=function(h){var m=this.personalizeModel();return m.setProperty('/personalizeSetting',h);};C.updateCampaignViewCount=function(){var U=C.getBackendRootURL()+"/sap/ino/xs/rest/common/update_campaign_viewCount.xsjs";var A=jQuery.ajax({url:U,headers:{"X-CSRF-Token":"Fetch"},type:"GET",contentType:"application/json; charset=UTF-8",async:false});C.getErrorMessage=function(){return A.responseText;};A.fail(function(r){o={};jQuery.sap.log.error("Reading user info failed.");jQuery.sap.log.error(r.responseText);C.userErrorMessage=r.responseText;});return;};C.getGroupConfiguration=function(){var G={GROUP:this.getSystemSetting("sap.ino.config.IDEA_COMPANY_VIEW_OPTION")==="sap.ino.config.ORGANIZATION"?"ORGANIZATION":"COMPANY",DISPLAY_LABEL:this.getSystemSetting("sap.ino.config.IDEA_COMPANY_VIEW_TXT"),ENABLE_GROUP_VIEW:this.getSystemSetting("sap.ino.config.ENABLE_IDEA_COMPANY_VIEW")==="1"?true:false};return G;};C.getSysCompanyLabel=function(){return this.getGroupConfiguration().DISPLAY_LABEL;};C.getSysCompanyEnable=function(){if(this.getGroupConfiguration().ENABLE_GROUP_VIEW){return 1;}return 0;};C.getSysCompanyView=function(){if(this.getGroupConfiguration().GROUP==="ORGANIZATION"){return"2";}return"1";};C.getCustomReportsEnable=function(){if(this.getSystemSetting("sap.ino.config.ENABLE_CUSTOM_REPORTS")*1){return true;}return false;};C.getCustomReportsTile=function(){return this.getSystemSetting("sap.ino.config.CUSTOM_REPORTS_TILE_NAME")};return C;});};if(!jQuery.sap.isDeclared('sap.ino.commons.application.Router')){jQuery.sap.declare('sap.ino.commons.application.Router');jQuery.sap.require('sap.m.routing.Router');jQuery.sap.require('sap.ui.core.routing.History');jQuery.sap.require('sap.ui.core.mvc.ViewType');sap.ui.define("sap/ino/commons/application/Router",["sap/m/routing/Router","sap/ui/core/routing/History","sap/ui/core/mvc/ViewType"],function(R,H,V){"use strict";return R.extend("sap.ino.commons.application.Router",{_fnRoutingCallback:undefined,_fnCloseCallback:undefined,onNavBack:function(r){var t=this;var h=H.getInstance();var p=h.getPreviousHash();var g=function(){if(p!==undefined){window.history.go(-1);}else{t.navTo("home",undefined,r);}};if(this._fnRoutingCallback){this._fnRoutingCallback(g);}else{g();}},onDeleteNavBack:function(o,r){var h=H.getInstance()&&H.getInstance().aHistory;var i=h&&h.length;if(i>2&&h[i-3].indexOf(o)>-1){window.history.go(-2);}else if(i>1&&h[i-2].indexOf(o)>-1){window.history.go(-1);}else{this.navTo("home",undefined,r);}},getContext:function(){var h=H.getInstance();if(typeof h.iHistoryPosition==="number"){return h.aHistory[h.iHistoryPosition];}else{return undefined;}},navTo:function(r,d,n,N){var o=this;var a=arguments;var f=function(){R.prototype.navTo.apply(o,a);};var c=this.getContext();if(this._fnRoutingCallback){this._fnRoutingCallback(f,r,c);}else{f();}},parse:function(n){var r=this;var N=function(){R.prototype.parse.apply(r,[n]);};if(this._fnRoutingCallback){this._fnRoutingCallback(N);}else{N();}},setRoutingCallback:function(c){this._fnRoutingCallback=c;},setCloseCallback:function(c){if(this._fnCloseCallback){jQuery(window).off('beforeunload',this._fnCloseCallback);}this._fnCloseCallback=c;jQuery(window).on('beforeunload',this._fnCloseCallback);}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.application.WebAnalytics')){jQuery.sap.declare("sap.ino.commons.application.WebAnalytics");jQuery.sap.declare('sap.ino.commons.application.WebAnalytics');sap.ui.define("sap/ino/commons/application/WebAnalytics",[],function(){"use strict";var S={campaignView:"CAMPAIGN",ideaView:"IDEA",wallView:"WALL"};sap.ino.commons.application.WebAnalytics={start:function(c){var t=c.isComponentActive('sap.ino.config.SWA_ACTIVE');if(!t){return;}var C=c.isComponentActive('sap.ino.config.SWA_CLICK_ACTIVE');var D=1;var a=c.getSystemSetting('sap.ino.config.SWA_DNT_LEVEL');if(a){D=parseInt(a,0);}var b=c.getSWABaseURL();var l=c.getSWATrackerURL();window.swa={pubToken:'HCO_INO',baseUrl:b,loggingUrl:l,dntLevel:D,bannerEnabled:false,loggingEnabled:t,clicksEnabled:false,pageLoadEnabled:true,customEventsEnabled:true,visitorCookieDuration:7776000000};var d=document,g=d.createElement('script'),s=d.getElementsByTagName('script')[0];g.type='text/javascript';g.defer=true;g.async=true;g.src=window.swa.baseUrl+'js/privacy.js';g.onload=function(){window.swa.trackLoad=function(){window.Matomo.getAsyncTracker().disableAlwaysUseSendBeacon();if((window.swa.loggingEnabled)&&(window.swa.pageLoadEnabled)&&(typeof window.Piwik!=="undefined")){window.Matomo.getAsyncTracker().trackPageView();}};};s.parentNode.insertBefore(g,s);},stop:function(){if(window.swa){window.swa.loggingEnabled=false;window.swa.disable();}},piwikPromise:function(){return new Promise(function(r,R){var c=0;window.Matomo.getAsyncTracker().disableAlwaysUseSendBeacon();var i=setInterval(function(){if(window.swa.trackCustomEvent&&window.Piwik){clearInterval(i);r();}c++;if(c>20){clearInterval(i);R();}},1000);});},logCampaignView:function(i){if(window.swa){sap.ino.commons.application.WebAnalytics.piwikPromise().then(function(){window.swa.trackCustomEvent(S.campaignView,i);},function(){throw"Event could not be logged: "+S.campaignView+" "+i;});}},logIdeaView:function(i){if(window.swa){sap.ino.commons.application.WebAnalytics.piwikPromise().then(function(){window.swa.trackCustomEvent(S.ideaView,i);},function(){throw"Event could not be logged: "+S.ideaView+" "+i;});}},logWallView:function(i){if(window.swa){sap.ino.commons.application.WebAnalytics.piwikPromise().then(function(){window.swa.trackCustomEvent(S.wallView,i);},function(){throw"Event could not be logged: "+S.wallView+" "+i;});}}};return sap.ino.commons.application.WebAnalytics;});};if(!jQuery.sap.isDeclared('sap.ino.commons.formatters.BaseFormatter')){jQuery.sap.declare('sap.ino.commons.formatters.BaseFormatter');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.ui.model.type.Date');jQuery.sap.require('sap.ui.model.FormatException');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.format.NumberFormat');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.ui.core.Locale');jQuery.sap.require('sap.m.ListType');sap.ui.define("sap/ino/commons/formatters/BaseFormatter",["sap/ino/commons/application/Configuration","sap/ui/base/Object","sap/ui/core/MessageType","sap/ui/core/IconPool","sap/ui/model/type/Date","sap/ui/model/FormatException","sap/ui/Device","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ui/core/Locale","sap/m/ListType"],function(C,O,M,I,D,F,a,N,b,L,c){"use strict";var m={};m[M.Error]="message-error";m[M.Warning]="message-warning";m[M.Success]="message-success";m[M.Information]="message-information";var d={};d[M.Error]=1;d[M.Warning]=2;d[M.Success]=3;d[M.Information]=4;function e(i){if(i.length===0){return undefined;}return i.reduce(function(s,o){if(d[o.type]===undefined){return s;}if(d[o.type]<d[s]){return o.type;}else{return s;}},M.Information);}function g(){return C.getSysCompanyView()==="1"?"LIST_TIT_FILTER_COMPANY_VIEW_HEADER":"LIST_TIT_FILTER_ORGANIZATION_VIEW_HEADER";}var B=O.extend("sap.ino.commons.formatters.BaseFormatter",{});var _;var G=function(t){if(!_){if(t.getOwnerComponent){_=b.getDateInstance({relative:true},new L(t.getOwnerComponent().getModel("user").getProperty("/data/LOCALE")));}else{return b.getDateInstance({relative:true});}}return _;};var f;var h=function(t){if(!f){if(t.getOwnerComponent){f=b.getDateInstance({relative:true,relativeScale:"auto"},new L(t.getOwnerComponent().getModel("user").getProperty("/data/LOCALE")));}else{return b.getDateInstance({relative:true,relativeScale:"auto"});}}return f;};var j;var k=function(t){if(!j){if(t.getOwnerComponent){j=b.getDateInstance({relative:false},new L(t.getOwnerComponent().getModel("user").getProperty("/data/LOCALE")));}else{return b.getDateInstance({relative:false});}}return j;};var l;var n=function(t){if(!l){if(t.getOwnerComponent){l=b.getTimeInstance({relative:false,format:'Hm'},new L(t.getOwnerComponent().getModel("user").getProperty("/data/LOCALE")));}else{return b.getTimeInstance({relative:false,format:'Hm'});}}return l;};B.showCreateButton=function(o,s){return o+s===2;};B.titleImageURL=function(i,o){var s=o instanceof Date?'&t='+o.getTime():'';var u=C.getAttachmentTitleImageDownloadURL(i,null,'small');if(s){return u+s;}return u;};B.campaignTitleImageURL=function(i,o){var s=o instanceof Date?'&t='+o.getTime():'';var u=C.getAttachmentTitleImageDownloadURL(i,null,'large');if(s){return u+s;}return u;};B.campaignListImageURL=function(t,i){if(i===null){return C.getAttachmentTitleImageDownloadURL(t,null,'small');}else{return C.getAttachmentTitleImageDownloadURL(i,null,'small');}};B.parameterizedText=function(t){var i=Array.prototype.slice.call(arguments);i.shift();if(t){jQuery.each(i||[],function(o,p){t=t.replace(new RegExp("\\{"+o+"\\}","g"),p||"");});}return t;};B.TagGroupName=function(t,p){if(p){return this.getText(t,p);}else{return this.getText(t);}return"";};B.TagGroupLinkEnable=function(t,T){var i={};var o=[];t.forEach(function(p,q){if(!i[p.ROOTGROUPID]){i[p.ROOTGROUPID]={};o.push(p.ROOTGROUPID);}});return!!~o.indexOf(T)||(o.length<5);};B.text=function(t,p){if(!t){return"";}if(p){return this.getText(t,p);}else{return this.getText(t);}return"";};B.getManageContinuesText=function(t,p){if(p){return this.getText("PERSONALIZE_FILTER_ACTIVE_IDEA_LABEL");}else{return this.getText("PERSONALIZE_MANAGED_ALL_IDEA_LABEL");}return"";};B.getManageContinuesTooltip=function(t,p){if(p){return this.getText("PERSONALIZE_MANAGED_ALL_IDEA_LABEL");}else{return this.getText("PERSONALIZE_FILTER_ACTIVE_IDEA_LABEL");}return"";};B.getManageContinuesToggle=function(t,p){if(p){return true;}else{return false;}return"";};B.getManageTextTooltip=function(t,p){if(p){return this.getText("PERSONALIZE_FILTER_ACTIVE_IDEA_LABEL_TOOLTIP");}else{return this.getText("PERSONALIZE_MANAGED_ALL_IDEA_LABEL_TOOLTIP");}return"";};B.campaignListCountNumber=function(p){if(p){var i=C.getCampaignFilterCount();return i[p];}};B.ideaListCountNumber=function(p){if(p){var i=C.getIdeaFilterCountData();return i[p];}};B.color=function(s){if(s&&s.length===6){return"#"+s;}else{return"#FFFFFF";}};B.isEqual=function(A,v){return A===v;};B.system=function(s){var S=false;if(!s){S=true;}else if(jQuery.type(s)==="array"){jQuery.each(s,function(i,o){S=S||a.system[o];});}else if(jQuery.type(s)==="string"){S=a.system[s];}return!!S;};B.mostSevereMessageTypeIcon=function(i){var s=e(i);return"sap-icon://"+m[s]||"";};B.uploadEnabled=function(i,o,E){if(E===undefined){var p=this.getView().data("editable");E=p==="true"||p===null;}return(E!==false)&&(i<0||o!==false);};B.downloadUrl=function(A,s){if(!s){return C.getAttachmentDownloadURL(A);}return C.getAttachmentDownloadURL(A)+"?filename="+encodeURIComponent(s);};B.previewUrl=function(s,A){if(s&&s.indexOf("image/")===0){return C.getAttachmentDownloadURL(A);}return undefined;};B.attachmentEditable=function(A){return A>0;};B.attachmentDeletable=function(A,i,E){if(E===undefined&&this.getView().data){var o=this.getView().data("editable");E=o==="true"||o===null;}return(E!==false)&&(A<0||i!==false);};B.navigationLink=function(r,p){return this.getOwnerComponent().getNavigationLink(r,p);};B.commentSaveTooltip=function(i,o,p){var s=p>0&&i>0||!p;if(!(s&&o>0)){return this.getText("MSG_COMMENT_HAS_PRIVILEGE");}else{return this.getText("MSG_COMMENT_SAVE_BUTTON");}};B.setIdeaListLatestUpdateBackGroundColor=function(i,u,o,s){if(!i&&!u&&!o&&!s){return"LATESTUPDATE_BACKGROUND";}else{return"null";}};B.setMgrCoachBackGroundColor=function(i,o,p,q){var r=this.getRouter();if(!i&&r.getContext().indexOf("sectionComments")<0){return"null";}var s=[];var t=[];if(p&&p.length>0){s=p.filter(function(u){return u.IDENTITY_ID===o;});}if(q&&q.length>0){t=q.filter(function(u){return u.IDENTITY_ID===o;});}if(t.length>0||s.length>0){return"MGRCOACH_BACKGROUND";}else{return"null";}};B.userIcon=function(i,o){if(!i||!o){return I.getIconURI("person-placeholder");}var s=o instanceof Date?'&t='+o.getTime():'&t='+(new Date(o)).getTime();var u=C.getAttachmentDownloadURL(i,null,'small');if(s){return u+s;}return u;};B.userIconEdit=function(i,o){if(!i){return I.getIconURI("person-placeholder");}var s=o instanceof Date?'&t='+o.getTime():'';var u=C.getAttachmentDownloadURL(i,null,'large');if(s){return u+s;}return u;};B.feedIdentityCard=function(i,p){if(i==="DATE_REACHED_SUBMIT_FROM"||i==="DATE_REACHED_SUBMIT_TO"||i==="DATE_REACHED_VALID_TO"||i==="DATE_REACHED_REGISTER_FROM"||i==="DATE_REACHED_REGISTER_TO"||p){return false;}};B.feedNoIdentityCard=function(i,p){if(p){return false;}if(i==="DATE_REACHED_SUBMIT_FROM"||i==="DATE_REACHED_SUBMIT_TO"||i==="DATE_REACHED_VALID_TO"||i==="DATE_REACHED_REGISTER_FROM"||i==="DATE_REACHED_REGISTER_TO"){return true;}return false;};B.feedLink=function(i,A){if(A<=0){return false;}if(i==="DATE_REACHED_SUBMIT_FROM"||i==="DATE_REACHED_SUBMIT_TO"||i==="DATE_REACHED_VALID_TO"||i==="DATE_REACHED_REGISTER_FROM"||i==="DATE_REACHED_REGISTER_TO"){return false;}};B.userImage=function(i){return!i?"":C.getAttachmentTitleImageDownloadURL(i);};B.isValidEmailAddr=function(s){if(!s||typeof s!=="string"){return false;}return/^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/g.test(s.trim());};B.isUsageReportingActive=function(){return C.isUsageReportingActive();};B.returnIfUsageReportingActive=function(o){return C.isUsageReportingActive()?o:undefined;};B.toInt=function(s){var i=parseInt(s,10);if(isNaN(i)){i=0;}else{throw new F("Don't know how to format "+s+" to int");}return i;};B.toFloat=function(s){var i=parseFloat(s);if(isNaN(i)){i=0;}else{throw new F("Don't know how to format "+s+" to float");}return i;};B.toString=function(o){return o.toString();};B.notEmpty=function(o){if(jQuery.type(o)==="array"){return o.length>0;}else{return!!o;}};B.toRelativeDate=function(o){if(!o){return"";}else if(typeof(o)==="number"){o=new Date(o);}else if(typeof(o)==="string"){o=new Date(o);}else if(typeof(o)==="object"){}else{throw new F("Don't know how to format "+o+" to relative Date");}return G(this).format(o);};B.toRelativeDateAuto=function(o){if(!o){return"";}else if(typeof(o)==="number"){o=new Date(o);}else if(typeof(o)==="string"){o=new Date(o);}else if(typeof(o)==="object"){}else{throw new F("Don't know how to format "+o+" to relative Date (Auto)");}return h(this).format(o);};B.toDate=function(o){if(!o){return"";}else if(typeof(o)==="number"){o=new Date(o);}else if(typeof(o)==="string"){o=new Date(o);}else if(typeof(o)==="object"){}else{throw new F("Don't know how to format "+o+" to Date");}return k(this).format(o);};B.toDateTime=function(o,w){if(!o){return"";}else if(typeof(o)==="number"){o=new Date(o);}else if(typeof(o)==="string"){o=new Date(o);}else if(typeof(o)==="object"){}else{throw new F("Don't know how to format "+o+" to oDateTime");}var s=k(this).format(o);var t=n(this).format(o);var r=sap.ui.getCore().getConfiguration().getRTL();if(r){return t+" "+s;}if(w){return s+" "+t;}return"<span style='display:inline-block'>"+s+" "+t+"</span>";};B.isVisible=function(o){return!!o;};B.isFutureDate=function(o){if(!o){return false;}else if(typeof(o)==="number"){o=new Date(o);}else if(typeof(o)==="string"){o=new Date(o);}else if(typeof(o)==="object"){}else{throw new F("Don't know how to format "+o);}var i=new Date();var p=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate());return o.getTime()>p;};B.toBool=function(s){return parseInt(s,10)===1;};B.toBoolNot=function(s){return parseInt(s,10)!==1;};B.toBoolText=function(s){if(typeof s==="boolean"){s=(s===true?1:0);}return parseInt(s,10)===1?this.getText("BOOL_FLD_TEXT_YES"):this.getText("BOOL_FLD_TEXT_NO");};B.toBoolInt=function(s){if(typeof s==="boolean"){return(s===true?1:0);}var i=parseInt(s,10);if(isNaN(i)||i===0){return 0;}else{return 1;}};B.atLeastOne=function(s){return parseInt(s,10)||1;};B.asPercent=function(v){return this.getText("PERCENTAGE_FLD_TEXT",[(v||0)]);};B.atLeastZero=function(v){return(v||0.0);};B.convertToInt=function(i){return Math.floor(i);};B.count=function(i){if(i){var o=N.getIntegerInstance({style:"short"});return o.format(i);}return"0";};B.isIdIncluded=function(i,p){p=p?p:[];return jQuery.grep(p,function(o){return o.ID===i;}).length>0;};B.isIdNotIncluded=function(i,p){p=p?p:[];return jQuery.grep(p,function(o){return o.ID===i;}).length===0;};B.incativeWhenIncluded=function(i,o){return this.formatter.isIdNotIncluded(i,o)?c.Active:c.Inactive;};B.expertRolesKeyToText=function(r){var t=this;var R=[];jQuery.each(r,function(i,s){switch(s){case"SUBMITTER":R.push(t.getText("CTRL_EXPERTS_GRP_SUBMITTER"));break;case"CONTRIBUTOR":R.push(t.getText("CTRL_EXPERTS_GRP_CONTRIBUTOR"));break;case"COMMENTATOR":R.push(t.getText("CTRL_EXPERTS_GRP_COMMENTATOR"));break;case"COACH":R.push(t.getText("CTRL_EXPERTS_GRP_COACH"));break;case"EVALUATOR":R.push(t.getText("CTRL_EXPERTS_GRP_EVALUATOR"));break;default:R.push(s);}});return R.join(", ");};B.wrapHTML=function(H){return"<div>"+(H||"")+"</div>";};B.wrapToHTML=function(H){if(H&&!(/^<(\w+)>.*<\/\1>$/gim.test(H))){return"<p>"+H+"</p>";}return H;};B.decodeURI=function(u){return decodeURIComponent(u);};B.termsConditions=function(s){if(s===null||s===undefined){return undefined;}var o=this.getView().getModel("module");return o.getProperty(s);};B.generateDescription=function(o,v,s){var t=this;if(o){if(s){return jQuery.sap.formatMessage(t.getText("INO_IDENTITY_DATA_VALIDATIONTO"),o,B.toDate(v),B.toDateTime(s,true));}return jQuery.sap.formatMessage(t.getText("INO_IDENTITY_DATA_VALIDATIONTO_WITHOUT_LAST_LOGIN"),o,B.toDate(v));}if(s){return jQuery.sap.formatMessage(t.getText("INO_IDENTITY_DATA_VALIDATIONTO_WITHOUT_ORGANIZATION"),B.toDate(v),B.toDateTime(s,true));}return jQuery.sap.formatMessage(t.getText("INO_IDENTITY_DATA_VALIDATIONTO_WITHOUT_ORGANIZATION_WITHOUT_LAST_LOGIN"),B.toDate(v));};B.checkVisibleText=function(t,p){if(p){return this.getText(t,p);}else{if(t!=="manage"&&t!=="draft"&&t!=="publish"&&t!=="submittable"){return true;}}return false;};B.ideaCheckVisibleText=function(t,p){if(p){return this.getText(t,p);}else{if(t!=="manage"&&t!=="follow"&&t!=="unassigned"&&t!=="coachme"&&t!=="evaldone"&&t!=="managedcompleted"){return true;}}return false;};B.checkVisibleText2=function(t,p){if(p){return this.getText(t,p);}else{if(t!=="all"&&t!=="active"&&t!=="open"&&t!=="future"&&t!=="past"&&t!=="registered"){return true;}}return false;};B.ideaCheckVisibleText2=function(t,p){if(p){return this.getText(t,p);}else{if(t!=="all"&&t!=="my"&&t!=="voted"&&t!=="commented"&&t!=="vote"&&t!=="eval"&&t!=="evalpending"&&t!=="evalopen"&&t!=="completed"){return true;}}return false;};B.parentText=function(t,p){if(p){return this.getText(t,p);}else{if(t==="CAMPAIGN_LIST_MIT_ALL"){return"Campaigns";}}return"";};B.parentText2=function(t,p){if(p){return this.getText(t,p);}else{if(t==="CAMPAIGN_LIST_MIT_MANAGE"){return"Managed Campaigns";}}return"";};B.checkList=function(p){if(p==="CAMPAIGN_LIST_TIT_NAME"||p==="IDEA_LIST_TIT_NAME"){return true;}return false;};B.i18nText=function(t){var i=this.getModel('i18n');return i.getResourceBundle().getText(t)||'';};B.formatGlobalSearchKey=function(t,i){if(i){return t;}var o=this.getModel('i18n');return o.getResourceBundle().getText(t)||'';};B.URIdecoding=function(t){return t&&window.decodeURIComponent(t)||'';};B.anonymousIconFormatter=function(i){if(i==="ALL"){return"sap-icon://theater";}else if(i==="PARTLY"){return"sap-icon://personnel-view";}};B.anonymousIconVisibleFormatter=function(i){if(i===null){return false;}else{return true;}};B.anonymousIconTooltipFormatter=function(i){if(i==="ALL"){return this.getText("IDEA_ANONYMOUS_FOR_ALL");}else if(i==="PARTLY"){return this.getText("IDEA_NOT_ANONYMOUS_CAMPAIGN_MANAGER");}};B.anonymousIconLabelFormatter=function(i){if(i==="ALL"){return this.getText("IDEA_ANONYMOUS_FOR_ALL");}else if(i==="PARTLY"){return this.getText("IDEA_NOT_ANONYMOUS_CAMPAIGN_MANAGER");}};B.adminFormTitle=function(i){if(i&&i.length>0){var r=i[0].FORM_DEFAULT_TEXT;return r;}else{return"";}};B.ideaPersonalizationFilterTextInDialog=function(t){switch(t){case'CAMPAIGN':return this.getText("LIST_TIT_FILTER_CAMPAIGN_HEADER");case'CUSTOM_IDEA_FORM':return this.getText("LIST_TIT_FILTER_CAMPAIGN_FORM_HEADER");case'PHASE':return this.getText("LIST_TIT_FILTER_PHASE_HEADER");case'STATUS_TYPE':return this.getText("LIST_TIT_FILTER_STATUS_HEADER");case'STATUS':return this.getText("LIST_TIT_FILTER_SUB_STATUS");case'VOTE_NUMBER':return this.getText("LIST_TIT_FILTER_VOTE_NUMBER");case'RESPONSIBILITY_LIST':return this.getText("LIST_TIT_FILTER_RESPONSIBILITY_LIST_HEADER");case'AUTHOR':return this.getText("LIST_TIT_FILTER_AUTHOR_HEADER");case'COACH':return this.getText("LIST_TIT_FILTER_COACH_HEADER");case'DUE_DATE':return this.getText("LIST_TIT_FILTER_DUE_HEADER");case'LATEST_UPDATE':return this.getText("LIST_TIT_FILTER_LATEST_UPDATE_HEADER");case'COMPANY_VIEW':return this.getText(g());}};B.quickLinkStandardListVisible=function(t,s){if(s){if(t!=="all"&&t!=="my"&&t!=="voted"&&t!=="commented"&&t!=="vote"&&t!=="eval"&&t!=="evalpending"&&t!=="evalopen"&&t!=="completed"){return true;}}else{if(t!=="manage"&&t!=="follow"&&t!=="unassigned"&&t!=="coachme"&&t!=="evaldone"&&t!=="managedcompleted"){return true;}}return false;};B.shortByQuickSortText=function(q){if(!q){return;}var Q=this.getListProperty('/QuickSorter');var t;Q.forEach(function(i){if(i.ACTION===q){t=i.TEXT;}});return this.getText(t);};B.shortBySortText1=function(s){if(!s){return;}var S=s.split(",");var i=S[0].split(" ");var q=this.getListProperty('/Sorter/Values');var t;q.forEach(function(o){if(o.ACTION===i[0]){t=o.TEXT;}});return this.getText(t);};B.shortBySortText2=function(s){if(!s){return;}if(s.indexOf(",")!==-1){var S=s.split(",");var i=S[1].split(" ");var q=this.getListProperty('/Sorter/Values');var t;q.forEach(function(o){if(o.ACTION===i[0]){t=o.TEXT;}});return this.getText(t);}else{return"";}};B.shortBySortVisible=function(s){if(!s){return false;}if(s.indexOf(",")!==-1){return true;}else{return false;}};B.quickLinkTextFormate=function(t,i,o){if(i){return i;}else{if(o){return this.getText(t,[o]);}else if(t){return this.getText(t);}else{return"";}}};B.quickLinkListSelected=function(A,i,s,S,o,p){if(!o&&(A===s||A===S)){return true;}if(o&&i&&p&&i===p){return true;}if(o&&!p&&(A===s||A===S)){return true;}return false;};B.commentEnabled=function(i,o,p){var s=p>0&&i>0||!p;return o>0&&s;};B.disableQuickLinkAllIdeas=function(t){if(t==="all"||t==="manage"){return false;}else{return true;}};B.formatInsufficientObjectId=function(t,p){return jQuery.sap.formatMessage(t,p);};B.formatInsufficientObjectExists=function(i,o){if(!o){return C.getBackendRootURL()+"/sap/ino/"+window.location.search;}var p={"sap.ino.xs.object.idea.Idea":function(s){return C.getBackendRootURL()+"/sap/ino/"+window.location.search+"#/campaign/"+s;}};return p[o](i);};B.getCommunityGroupViewTooltip=function(i){if(!i){return this.getText("IDEA_LIST_TIT_NAME_FOR_MY_VIEW");}else{return this.getText("IDEA_LIST_TIT_NAME");}};B.getIdeaListTitleText=function(E,i){if(!E){return this.getText("IDEA_LIST_TIT_NAME");}else{if(!i){return this.getText("IDEA_LIST_TIT_NAME");}else{return this.getText("IDEA_LIST_TIT_NAME_FOR_MY_VIEW");}}};B.getCommunityGroupViewToggle=function(i){if(i){return true;}else{return false;}};return B;});};if(!jQuery.sap.isDeclared('sap.ino.commons.library')){jQuery.sap.declare('sap.ino.commons.library');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.m.library');sap.ui.define("sap/ino/commons/library",['sap/ui/core/library','sap/m/library'],function(){"use strict";sap.ui.getCore().initLibrary({name:"sap.ino.commons",dependencies:["sap.ui.core","sap.m"],types:[],interfaces:[],controls:["sap.ino.commons.application.BaseComponent","sap.ino.commons.application.Configuration","sap.ino.commons.application.Router","sap.ino.commons.application.WebAnalytics","sap.ino.commons.formatters.BaseFormatter","sap.ino.commons.formatters.BaseListFormatter","sap.ino.commons.formatters.ListFormatter","sap.ino.commons.formatters.ObjectFormatter","sap.ino.commons.formatters.ObjectListFormatter","sap.ino.commons.models.aof.ApplicationObject","sap.ino.commons.models.aof.ApplicationObjectChange","sap.ino.commons.models.aof.MessageParser","sap.ino.commons.models.aof.MetaModel","sap.ino.commons.models.aof.PropertyModel","sap.ino.commons.models.aof.PropertyModelCache","sap.ino.commons.models.core.CoreModel","sap.ino.commons.models.core.Extensibility","sap.ino.commons.models.core.ModelSynchronizer","sap.ino.commons.models.core.ReadSource","sap.ino.commons.models.object.Attachment","sap.ino.commons.models.object.Campaign","sap.ino.commons.models.object.CampaignComment","sap.ino.commons.models.object.Evaluation","sap.ino.commons.models.object.Idea","sap.ino.commons.models.object.IdeaComment","sap.ino.commons.models.object.Notification","sap.ino.commons.models.object.UserSettings","sap.ino.commons.models.object.Vote","sap.ino.commons.models.object.Wall","sap.ino.commons.models.object.WallItem","sap.ino.commons.models.util.UUID","sap.ino.commons.models.util.WallMapper"],noLibraryCSS:true,elements:[],version:"2.4.16"});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.aof.ApplicationObjectChange')){jQuery.sap.declare('sap.ino.commons.models.aof.ApplicationObjectChange');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/ino/commons/models/aof/ApplicationObjectChange",["sap/ui/base/ManagedObject"],function(M){"use strict";var A={All:"",Create:"create",Copy:"copy",Update:"update",Del:"del",Action:"action"};var a=M.extend("sap.ino.commons.models.aof.ApplicationObjectChange",{metadata:{events:{"objectChanged":{},"objectCreated":{},"objectCopied":{},"objectUpdated":{},"objectDeleted":{},"objectCustomActionExecuted":{}}},fireChange:function(c){this.fireEvent("objectChanged",c);switch(c.actionName){case A.Create:this.fireEvent("objectCreated",c);break;case A.Copy:this.fireEvent("objectCopied",c);break;case A.Update:this.fireEvent("objectUpdated",c);break;case A.Del:this.fireEvent("objectDeleted",c);break;default:this.fireEvent("objectCustomActionExecuted",c);break;}},attachChange:function(s,f){switch(s){case A.Create:this.attachEvent("objectCreated",f);break;case A.Copy:this.attachEvent("objectCopied",f);break;case A.Update:this.attachEvent("objectUpdated",f);break;case A.Del:this.attachEvent("objectDeleted",f);break;case A.Action:this.attachEvent("objectCustomActionExecuted",f);break;default:this.attachEvent("objectChanged",f);break;}},detachChange:function(s,f){switch(s){case A.Create:this.detachEvent("objectCreated",f);break;case A.Copy:this.detachEvent("objectCopied",f);break;case A.Update:this.detachEvent("objectUpdated",f);break;case A.Del:this.detachEvent("objectDeleted",f);break;case A.Action:this.detachEvent("objectCustomActionExecuted",f);break;default:this.detachEvent("objectChanged",f);break;}}});a=new a();a.Action=A;return a;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.aof.MessageParser')){jQuery.sap.declare('sap.ino.commons.models.aof.MessageParser');jQuery.sap.require('sap.ui.core.message.MessageParser');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');sap.ui.define("sap/ino/commons/models/aof/MessageParser",["sap/ui/core/message/MessageParser","sap/ui/core/message/Message","sap/ui/core/MessageType"],function(M,a,b){"use strict";var m={'E':b.Error,'W':b.Warning,'I':b.Information,'S':b.Success};function c(A,p){var t=(A.REF_NODE===undefined||A.REF_NODE==="Root")?"/"+A.REF_FIELD:"/"+A.REF_NODE;return new a({type:m[A.TYPE]||b.None,code:A.MESSAGE,message:A.MESSAGE_TEXT,description:A.MESSAGE_TEXT,target:t,processor:p});}return M.extend("sap.ino.commons.models.aof.MessageParser",{constructor:function(){M.prototype.constructor.apply(this,arguments);this.aPreviousMessages=[];},parse:function(r){r=r||{};var p=this.getProcessor();var n=jQuery.map(r.MESSAGES||r.messages||[],function(o){return c(o,p);});this.getProcessor().fireMessageChange({oldMessages:this.aPreviousMessages,newMessages:n});this.aPreviousMessages=n;}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.aof.MetaModel')){jQuery.sap.declare('sap.ino.commons.models.aof.MetaModel');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.json.JSONPropertyBinding');sap.ui.define("sap/ino/commons/models/aof/MetaModel",["sap/ui/model/json/JSONModel","sap/ui/model/json/JSONPropertyBinding","sap/ino/commons/application/Configuration"],function(J,a,C){"use strict";var A=null;var M=J.extend("sap.ino.commons.models.aof.MetaModel",{metadata:{events:{"modelInitialized":{}}}});M=new M({});var g=b;M.getApplicationObjectMetadata=function(o,r){if(!M.getProperty("/"+o)){g(o,function(c){var d=m(c);M.setProperty("/"+o,d);if(r){r(d);r=undefined;}M.fireEvent("modelInitialized");});}var c=M.getProperty("/"+o);if(r){r(c);M.fireEvent("modelInitialized");}return c;};M.bindProperty=function(p,c,P){if(p){var d=p.split("/");if(d.length>2){var o=d[1];M.getApplicationObjectMetadata(o);}}var B=new a(this,p,c,P);return B;};M.getEndpoint=function(s){var B=C.getBackendRootURL();if(!A){A=C.getApplicationObjects();}return B+A[s];};M.getBackendAllMetadata=function(){if(C.isDevelopmentEnv()){return;}var c;var u=C.getBackendRootURL()+"/sap/ino/ngui/build/resources/sap/ino/corelib/allmetadata.json";var o=jQuery.ajax({url:u,async:false,datatype:"json"});o.done(function(d){for(var i=0,l=d.length;i<=l-1;i++){c=d[i].name;if(c&&!M.getProperty("/"+c)){var e=m(d[i]);M.setProperty("/"+c,e);}}});};function m(o){jQuery.each(o.nodes,function(n,N){jQuery.each(N.attributes,function(s,c){c.changeable=!c.readOnly;});});return o;}function b(o,s){var u=C.getBackendRootURL()+"/sap/ino/xs/rest/static/meta.xsjs/"+o;var c=jQuery.ajax({url:u,async:false,datatype:"json"});c.done(function(d){s(d);});}return M;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.aof.PropertyModelCache')){jQuery.sap.declare('sap.ino.commons.models.aof.PropertyModelCache');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/commons/models/aof/PropertyModelCache",["sap/ui/model/json/JSONModel"],function(J){"use strict";return J.extend("sap.ino.commons.models.aof.PropertyModelCache",{metadata:{events:{"modelCacheUpdated":{},"modelCacheInvalidated":{}}}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.core.ClipboardModel')){jQuery.sap.declare('sap.ino.commons.models.core.ClipboardModel');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/commons/models/core/ClipboardModel",["sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel"],function(A,C,J){"use strict";var O="object";var E="entry";var a="changed";var I="isEmpty";var b="enabled";var N={Root:"Root"};var c=J.extend("sap.ino.commons.models.core.ClipboardModel",{metadata:{events:{"objectAdded":{},"objectRemoved":{},"objectRevalidated":{},"objectInvalid":{},"clipboardOpen":{}}},constructor:function(n){J.apply(this,[]);this.initialized=false;this.namesRead=false;this.clipboardVisible=false;this.clipboardEnabled=false;this.name=n;var t=this;A.attachChange(A.Action.All,function(e){if(e.actionName===A.Action.Del){t.remove(e.getParameter("object"),e.getParameter("key"));}else{t._validateObject(e);}});},setODataModel:function(o){this._oODataModel=o;},setEnabled:function(e){if(e){this.clipboardEnabled=true;this._initialize();this.setProperty("/"+b,true);}else{this.clipboardEnabled=false;this.setProperty("/"+b,false);}},_changed:function(){this.setProperty("/"+a,new Date());this._isEmpty();},_isEmpty:function(){this.setProperty("/"+I,this.isClipboardEmpty());},_entry:function(o,k,n){return{objectName:o.getMetadata().getName(),key:k,name:n};},_setName:function(o,k){var d=new jQuery.Deferred();if(!o.readSource){return d;}var m=o.getApplicationObjectMetadata();var p=this.getObjectForKey(o,k);var t=this;p.done(function(D){if(D){var e=o.getMetadata().getName();var n=m.nodes[N.Root].nameAttribute;var f=D[n];var r=jQuery.grep(t.getProperty("/"+O)||[],function(g){return g.name==e;});if(r.length!=0){var g=r[0];r=jQuery.grep(g[E]||[],function(h){return h.key==k;});if(r.length!=0){var h=r[0];h.name=f;}}t.checkUpdate(true);d.resolve();}else{t._invalidObject(o,k,d);}});p.fail(function(e){t._invalidObject(o,k,d);});return d.promise();},_invalidObject:function(o,k,d){this.remove(o,k);this.fireEvent("objectInvalid",{applicationObject:o,key:k,entrySet:o.readSource.entitySetName,entityKey:this._getEntityKey(o,k)});d.reject();},prepare:function(){this._initialize();},_initialize:function(){if(!this.initialized){this.initialized=true;this._loadState();}},_validateObject:function(e){this._initialize();var t=this;var o=e.getParameter("object");var k=e.getParameter("key");if(this.isInClipboard(o,k)){t.revalidate(o,k);}},_getEntityKey:function(o,k){return o.readSource.entitySetName+"("+k+")";},clipboardOpened:function(){this._initialize();this.clipboardVisible=true;if(!this.namesRead){this.namesRead=true;this.revalidate();}this._storeState();},clipboardClosed:function(){this._initialize();this.clipboardVisible=false;this._storeState();},toggle:function(o,k,n){this._initialize();if(!this.isInClipboard(o,k)){this.add(o,k,n);return true;}this.remove(o,k);return false;},add:function(o,k,n){this._initialize();if(k<=0){return;}n=n||"";var d=new jQuery.Deferred();var e=o.getMetadata().getName();var f=this._entry(o,k,n);var g="/"+O;var h=this.getProperty(g);if(!h){h=[];this.setProperty(g,h);}var r=jQuery.grep(h||[],function(i){return i.name==e;});var i=null;if(r.length==0){i={name:e,};i[E]=[];h.push(i);}else{i=r[0];}r=jQuery.grep(i[E]||[],function(l){return l.key==k;});var j=null;if(r.length==0){j=f;i[E].push(j);this._setName(o,k).done(d.resolve);}else{j=r[0];j.name=n;d.resolve();}this._storeState();this.checkUpdate(true);this._changed();this.fireEvent("objectAdded",{objectName:e,key:k,entry:f});return d.promise();},remove:function(o,k){this._initialize();var d=undefined;if(o){d=o.getMetadata().getName();var e=this.getProperty("/"+O)||[];var r=jQuery.grep(e,function(f){return f.name==d;});if(r.length!==0){var f=r[0];if(k){r=jQuery.grep(f[E]||[],function(g){return g.key==k;});if(r.length!==0){var g=r[0];f[E].splice(jQuery.inArray(g,f[E]),1);}if(f[E].length===0){e.splice(jQuery.inArray(f,e),1);}}else{e.splice(jQuery.inArray(f,e),1);}}if(e&&e.length===0){this.setData({enabled:this.clipboardEnabled});}}else{this.setData({enabled:this.clipboardEnabled});}this._storeState();this.checkUpdate(true);this._changed();this.fireEvent("objectRemoved",{objectName:d,key:k});},revalidate:function(o,k){this._initialize();var t=this;if(o){var d=o.getMetadata().getName();if(k){this._setName(o,k).done(function(){t.fireEvent("objectRevalidated",{objectName:d,key:k});});}else{var r=jQuery.grep(this.getProperty("/"+O)||[],function(e){return e.name==d;});if(r.length!=0){var e=r[0];jQuery.each(e[E],function(i,f){var k=f.key;t._setName(o,k).done(function(){t.fireEvent("objectRevalidated",{objectName:e.name,key:k});});});}}}else{jQuery.each(this.getProperty("/"+O)||[],function(i,e){o=c.loadObject(e.name);jQuery.each(e[E],function(i,f){var k=f.key;t._setName(o,k).done(function(){t.fireEvent("objectRevalidated",{objectName:e.name,key:k});});});});}},isInClipboard:function(o,k){this._initialize();var r=jQuery.grep(this.getProperty("/"+O)||[],function(d){return d.name==o.getMetadata().getName();});if(r.length!=0){var d=r[0];r=jQuery.grep(d[E]||[],function(e){return e.key==k;});if(r.length!=0){return true;}}return false;},isClipboardEmpty:function(o){if(!o){return(this.getProperty("/"+O)||[]).length<=0;}var r=jQuery.grep(this.getProperty("/"+O)||[],function(d){return d.name==o.getMetadata().getName();});if(r.length!=0){var d=r[0];return(d[E]||[]).length<=0;}return true;},getObjectForKey:function(o,k){var m=o.getApplicationObjectMetadata();return o.readSource(k,o.getObjectName(),m,{onlyRoot:true,model:this._oODataModel});},getObjectKeys:function(o,f){this._initialize();var k=[];if(o){var r=jQuery.grep(this.getProperty("/"+O)||[],function(d){return d.name==o.getMetadata().getName();});if(r.length!=0){var d=r[0];jQuery.each(d[E],function(i,e){k.push(e.key);});}}if(f){var i=k.indexOf(f);if(i>-1){k.splice(i,1);}}return k;},setProperty:function(){this._initialize();J.prototype.setProperty.apply(this,arguments);},getProperty:function(){this._initialize();return J.prototype.getProperty.apply(this,arguments);},_loadState:function(){jQuery.sap.require("jquery.sap.storage");var t=this;var S=jQuery.sap.storage(jQuery.sap.storage.Type.local);var k=this._getStateKey();var d=S.get(k);if(d){try{var D={enabled:this.clipboardEnabled};D[O]=[];var o=JSON.parse(d);if(o.userId==C.getCurrentUser().USER_ID){delete o.userId;jQuery.each(o,function(f,K){var g={name:f};g[E]=[];var h=c.loadObject(f);jQuery.each(K,function(i,k){var j=t._entry(h,k,"");g[E].push(j);});D[O].push(g);});}this.setData(D);this._changed();this._storeState();}catch(e){jQuery.sap.log.debug("JSON string "+d+" from local storage for could not be parsed for key "+k,undefined,"ClipboardModel");}}},_storeState:function(){var S={userId:C.getCurrentUser().USER_ID};jQuery.each(this.getProperty("/"+O)||[],function(i,e){var K=[];jQuery.each(e[E],function(i,f){K.push(f.key);});S[e.name]=K;});var o=jQuery.sap.storage(jQuery.sap.storage.Type.local);var k=this._getStateKey();var d=o.put(k,JSON.stringify(S));if(!d){jQuery.sap.log.debug("State could not be stored in local storage for key "+k,undefined,"ClipboardModel");}},_getStateKey:function(){return this.getMetadata().getName()+"-"+this.name;}});c.loadObject=function(o){jQuery.sap.require(o);return jQuery.sap.getObject(o,0);};var s=null;c.sharedInstance=function(){if(!s){s=new c("__shared_instance__");}return s;};c.getInSharedClipboardFormatter=function(o){return function(k){return c.sharedInstance.isInClipboard(o,k);};};c.getSharedClipboardNotEmptyFormatter=function(o){return function(){return!c.sharedInstance().isClipboardEmpty(o);};};return c;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.core.Extensibility')){jQuery.sap.declare('sap.ino.commons.models.core.Extensibility');sap.ui.define("sap/ino/commons/models/core/Extensibility",[],function(){"use strict";return{initExtensionNode:function(d,e,o){var m=o.getApplicationObjectMetadata();if(!d[e]||d[e].length===0){d[e]=[{}];}var E=d[e][0];jQuery.each(m.nodes[e].attributes,function(a,A){if(!A.readOnly&&a!="_ID"&&E[a]===undefined){E[a]=null;}if((E[a]===null||E[a]===undefined)&&!A.required&&!(A.customProperties&&A.customProperties.valueOptionList)&&!A.foreignKeyTo){if(A.dataType==="INTEGER"){E[a]=A.minValue!==undefined?A.minValue:0;}else if(A.dataType==="DOUBLE"){E[a]=A.minValue!==undefined?A.minValue:0.0;}}});return d;}};});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.core.ReadSource')){jQuery.sap.declare('sap.ino.commons.models.core.ReadSource');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.core.format.DateFormat');sap.ui.define("sap/ino/commons/models/core/ReadSource",["sap/ino/commons/models/aof/MetaModel","sap/ui/base/ManagedObject","sap/ui/model/Sorter","sap/ui/core/format/DateFormat"],function(M,a,S,D){"use strict";var R={};var N={Root:"Root"};var d=D.getDateInstance({pattern:"yyyy-MM-dd"});R.getDefaultODataSource=function(e,s,o){var f=function(K,O,m,A){o=o||A.model;var j=A.groupSetting;var r={};K=typeof(K)==="string"?"'"+K+"'":K;if(jQuery.isPlainObject(K)){var n=jQuery.map(K,function(V,L){return L+"='"+V+"'";});K=n.join(",");}var B="/"+e+"("+K+")";var P=null;var q=jQuery.extend({},m.nodes);s=f.settings(A);if(s&&s.includeNodes){jQuery.each(s.includeNodes,function(i,L){if(!q[L.name]){q[L.name]=L;}});}var t=h(q);if(t.length>0){P=["$expand="+t.join(",")];}if(s&&s.projection&&s.projection.length>0){var u="$select=";jQuery.each(s.projection,function(i,L){if(s.projection.length-1===i){u+=L;}else{u+=L+",";}});if(!P){P=[];}P.push(u);}var w=true;if(s&&s.async!==undefined){w=s.async;}var U=s&&s.useBuffer;var x=[];var y=new jQuery.Deferred();if(!U){o.read(B,{urlParameters:P,success:function(L){jQuery.extend(r,g(c(L),t));y.resolve(L);},error:function(L){o.fireRequestFailed((L&&L.response)?L.response:{statusCode:400});y.reject(L);}});}else{o.createBindingContext("/"+B,null,P,function(L){if(L&&L.getObject()){var Q=L.getObject();jQuery.extend(r,g(c(Q),t));y.resolve(Q);}else{y.reject();}});}x.push(y);function z(E){var L=B+"/"+E;var y=new jQuery.Deferred();var F=m.nodes[E];var Q=F&&[new S(F.primaryKey)];if(!U){o.read(L,{async:true,groupId:j&&j[E],sorters:Q,success:function(T){r[E]=c(T);y.resolve(T);},error:function(T){if(T.statusCode==404){r[E]=[];y.resolve([]);}else{y.reject(T);}}});}else{o.createBindingContext("/"+L,null,null,function(T){if(T&&T.getObject()){var V=T.getObject();r[E]=c(V);y.resolve(V);}else{y.resolve([]);}});}return y;}var C=s&&s.onlyRoot;if(!C){for(var E in q){var F=q[E];if(F.name==N.Root||F.parentNode!=N.Root){continue;}if(s&&s.excludeNodes&&s.excludeNodes.indexOf(E)>=0){continue;}var G=false;for(var i=0;i<t.length;i++){var H=t[i];if(H.indexOf(E)===0){G=true;break;}}if(s&&s.deepChildPaths){if(s.deepChildPaths[E]){G=true;}}if(G){continue;}x.push(z(E));}}var I=new jQuery.Deferred();var J=jQuery.when.apply(jQuery,x);J.done(function(){var L=m.isConcurrencyControlEnabled?l(r,m.nodes[N.Root]):undefined;v(r,m,"Root",b);I.resolve(r,L);});J.fail(function(L){I.reject(L);});return I.promise();};function g(m,n){for(var i=0;i<n.length;i++){var q=n[i];var r=q.split("/");var t=m;for(var j=0;j<r.length;j++){var u=r[j];if(t[u]===undefined){break;}if(t[u]==null){t[u]=[];break;}t=t[u];}}return m;}function h(n){var i=[];var j;for(j in n){var m=n[j];if(m.name==N.Root){continue;}if(s&&s.excludeNodes&&s.excludeNodes.indexOf(j)>=0){continue;}if(s&&s.deepChildPaths&&s.deepChildPaths[j]){continue;}var C=k(m,n);if(C&&C.indexOf("/")!=-1){i.push(C);}}if(s&&s.deepChildPaths){for(j in s.deepChildPaths){if(s&&s.excludeNodes&&s.excludeNodes.indexOf(j)>=0){continue;}var q=s.deepChildPaths[j];if(q.indexOf("/")!==-1){i.push(q);}}}i=i.filter(function(r,t,u){return u.indexOf(r)===t;});i.sort();return i;}function k(n,i){var P=n.name;while(n.parentNode&&n.parentNode!=N.Root){n=i[n.parentNode];P=n.name+"/"+P;}return P;}function l(i,n){var t={};jQuery.each(n.attributes,function(A,j){if(j.concurrencyControl){var V=i[A];if(V instanceof Date){V=V.toISOString();}t[A]=V;}});return JSON.stringify(t);}(function(s){f.settings=function(A){if(A){return m(s,A);}return s;};function m(s,A){s=s||{};A=A||{};return{deepChildPaths:jQuery.extend(s.deepChildPaths||{},A.deepChildPaths||{}),excludeNodes:(s.excludeNodes||[]).concat(A.excludeNodes||[]),includeNodes:(s.includeNodes||[]).concat(A.includeNodes||[]),projection:(s.projection||[]).concat(A.projection||[]),async:A.async!==undefined?A.async:s.async,onlyRoot:A.onlyRoot!==undefined?A.onlyRoot:s.onlyRoot,useBuffer:A.useBuffer!==undefined?A.useBuffer:s.useBuffer};}}(s));f.entitySetName=e;return f;};R.getDefaultAOFSource=function(s){return function(k,o,m,A){var e=new jQuery.Deferred();var E=jQuery.extend({},s,A);var u=M.getEndpoint(o);var f=jQuery.ajax({url:u+"/"+k,type:"GET",dataType:"json",async:E.async!==undefined?E.async:true,cache:E.cache,contentType:"application/json",headers:E.headers||undefined});f.done(function(r,g,j){var C=j.getResponseHeader("ETag");v(r,m,"Root",p);e.resolve(r,C);});f.fail(function(r){e.reject(r);});return e.promise();};};function p(n,o,s){if(n&&o&&s&&jQuery.isPlainObject(n)){var e=o.nodes&&o.nodes[s]&&o.nodes[s].attributes;if(e){jQuery.each(e,function(i,A){if(A.dataType){if(A.dataType==="TIMESTAMP"){n[i]=new Date(n[i]);}}});}}}function b(n,o,s){if(n&&o&&s&&jQuery.isPlainObject(n)){var e=o.nodes&&o.nodes[s]&&o.nodes[s].attributes;if(e){jQuery.each(e,function(i,A){if(A.dataType&&A.dataType==="DOUBLE"){if(n[i]!==null){n[i]=parseFloat(n[i]);}}if(A.dataType==="DATE"){n[i]=d.format(n[i]);}});}}}function v(n,o,s,P){if(n&&o&&s&&P){P(n,o,s);for(var e in n){var C=n[e];if(C&&n.hasOwnProperty(e)&&jQuery.isArray(C)&&C.length>0){jQuery.each(C,function(i,f){if(jQuery.isPlainObject(f)){v(f,o,e,P);}});}}}}function c(o){if(!o){return{};}o=jQuery.extend(true,{},o);var C;if(o.results){C=[];jQuery.each(o.results,function(i,r){C.push(c(r));});}else{if(o.__metadata){delete o.__metadata;}jQuery.each(o,function(P,e){if(e&&e.constructor==Object){if(e.__deferred){delete o[P];}else{o[P]=c(e);}}if(e&&jQuery.isArray(e)){jQuery.each(e,function(i,f){c(f);});}});C=o;}return C;}R.cleanData=c;R.setMetaModel=function(m){M=m;};return R;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.misc.Notifications')){jQuery.sap.declare('sap.ino.commons.models.misc.Notifications');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/commons/models/misc/Notifications",["sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration"],function(J,C){var N=C.getBackendRootURL()+"/sap/ino/xs/rest/common/notification_messages.xsjs";var a=300000;return J.extend("sap.ino.commons.models.misc.Notifications",{constructor:function(p){J.apply(this,[]);this.bPollingActivated=p;this.setTimer();},setTimer:function(){if(!this.bPollingActivated){return;}if(this._oTimer){clearInterval(this._oTimer);}this._oTimer=setInterval(this.updateNotificationCount.bind(this),a);},updateNotificationCount:function(){this.loadData(N,"countOnly=true",true,"GET",true);},updateNotifications:function(){this.loadData(N);this.setTimer();},markNotificationsAsRead:function(l){this.setProperty("/NOTIFICATION_COUNT","0");this.setProperty("/NOTIFICATIONS",null);jQuery.sap.require("sap.ino.commons.models.object.Notification");var b=sap.ino.commons.models.object.Notification;return b.readAllNotifications(l);},markNotificationAsRead:function(n){var c=this.getProperty("/NOTIFICATION_COUNT");c--;this.setProperty("/NOTIFICATION_COUNT",c);jQuery.sap.require("sap.ino.commons.models.object.Notification");var b=sap.ino.commons.models.object.Notification;return b.readNotification(n);}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.types.FloatNullableType')){jQuery.sap.declare('sap.ino.commons.models.types.FloatNullableType');jQuery.sap.require('sap.ui.model.type.Float');jQuery.sap.require('sap.ui.model.ParseException');sap.ui.define("sap/ino/commons/models/types/FloatNullableType",["sap/ui/model/type/Float","sap/ui/model/ParseException"],function(F,P){"use strict";return F.extend("sap.ino.commons.models.types.FloatNullableType",{formatValue:function(v,i){if(v===null||v===undefined||v===""){return v;}return F.prototype.formatValue.apply(this,[v,i]);},parseValue:function(v,i){if(v===null||v===undefined||v===""){return v;}return F.prototype.parseValue.apply(this,[v,i]);},validateValue:function(v){if(v===null||v===undefined||v===""){return true;}return F.prototype.validateValue.apply(this,[v]);}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.types.FloatType')){jQuery.sap.declare('sap.ino.commons.models.types.FloatType');jQuery.sap.require('sap.ui.model.type.Float');jQuery.sap.require('sap.ui.model.ParseException');sap.ui.define("sap/ino/commons/models/types/FloatType",["sap/ui/model/type/Float","sap/ui/model/ParseException"],function(F,P){"use strict";return F.extend("sap.ino.commons.models.types.FloatType",{formatValue:function(v,i){return F.prototype.formatValue.apply(this,[v,i]);},parseValue:function(v,i){if(typeof v==="string"&&(v.indexOf(",")>-1||jQuery.trim(v).indexOf(" ")>-1)){var b=sap.ui.getCore().getLibraryResourceBundle();throw new P(b.getText("Integer.Invalid"));return;}return F.prototype.parseValue.apply(this,[v,i]);},validateValue:function(v){return F.prototype.validateValue.apply(this,[v]);}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.types.FollowUpRelativeDateType')){jQuery.sap.declare('sap.ino.commons.models.types.FollowUpRelativeDateType');jQuery.sap.require('sap.ui.model.SimpleType');sap.ui.define("sap/ino/commons/models/types/FollowUpRelativeDateType",["sap/ui/model/SimpleType"],function(S){"use strict";function s(d,D){return d.getFullYear()===D.getFullYear()&&d.getMonth()===D.getMonth()&&d.getDate()===D.getDate();}return S.extend("sap.ino.commons.models.types.FollowUpRelativeDateType",{formatValue:function(f){if(f){var c=new Date();var d=c.getDate();var m=c.getMonth();var y=c.getFullYear();var n=new Date(y,m,d);if(s(f,n)){return"TODAY";}if(s(f,new Date(y,m,d+1))){return"TOMORROW";}var D=new Date(y,m,d);D.setDate(D.getDate()+5-D.getDay());if(s(f,D)){return"THIS_WEEK";}D=new Date(y,m,d);D.setDate(D.getDate()+8-D.getDay());if(s(f,D)){return"NEXT_WEEK";}D=new Date(y,m,d);D.setDate(n.getDate()+7);if(s(f,D)){return"IN_A_WEEK";}D=new Date(y,m,d);D.setDate(n.getDate()+14);if(s(f,D)){return"IN_TWO_WEEKS";}if(s(f,new Date(y,m+1,0))){return"THIS_MONTH";}if(s(f,new Date(y,m+1,15))){return"NEXT_MONTH";}if(s(f,new Date(y,m+1,d))){return"IN_A_MONTH";}if(s(f,new Date(y,m+2,d))){return"IN_TWO_MONTHS";}}return"NONE";},parseValue:function(r){var c=new Date();var d=c.getDate();var m=c.getMonth();var y=c.getFullYear();var n=new Date(y,m,d);var D=null;switch(r){case"NONE":break;case"NO_FOLLOW_UP":break;case"TODAY":D=n;break;case"TOMORROW":D=new Date(y,m,d);D.setDate(n.getDate()+1);break;case"THIS_WEEK":D=new Date(y,m,d);D.setDate(D.getDate()+5-D.getDay());break;case"NEXT_WEEK":D=new Date(y,m,d);D.setDate(D.getDate()+8-D.getDay());break;case"IN_A_WEEK":D=new Date(y,m,d);D.setDate(n.getDate()+7);break;case"IN_TWO_WEEKS":D=new Date(y,m,d);D.setDate(n.getDate()+14);break;case"THIS_MONTH":D=new Date(y,m+1,0);break;case"NEXT_MONTH":D=new Date(y,m+1,15);break;case"IN_A_MONTH":D=new Date(y,m+1,d);break;case"IN_TWO_MONTHS":D=new Date(y,m+2,d);break;}return D;},validateValue:function(){return true;}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.types.IntBooleanType')){jQuery.sap.declare('sap.ino.commons.models.types.IntBooleanType');jQuery.sap.require('sap.ui.model.SimpleType');sap.ui.define("sap/ino/commons/models/types/IntBooleanType",["sap/ui/model/SimpleType"],function(S){"use strict";return S.extend("sap.ino.commons.models.types.IntBooleanType",{formatValue:function(v){return v===1;},parseValue:function(v){return v?1:0;},validateValue:function(v){return v===0||v===1;}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.types.IntNullableBooleanType')){jQuery.sap.declare('sap.ino.commons.models.types.IntNullableBooleanType');jQuery.sap.require('sap.ui.model.type.Integer');sap.ui.define("sap/ino/commons/models/types/IntNullableBooleanType",["sap/ui/model/type/Integer"],function(I){"use strict";return I.extend("sap.ino.commons.models.types.IntNullableBooleanType",{formatValue:function(v,i){if(v===null||v===undefined||v===""){return v;}return I.prototype.formatValue.apply(this,[v,i]);},parseValue:function(v,i){if(v===null||v===undefined||v===""){return v;}return I.prototype.parseValue.apply(this,[v,i]);},validateValue:function(v){if(v===null||v===undefined||v===""){return true;}return I.prototype.validateValue.apply(this,[v]);}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.types.IntegerNullableType')){jQuery.sap.declare('sap.ino.commons.models.types.IntegerNullableType');jQuery.sap.require('sap.ui.model.type.Integer');jQuery.sap.require('sap.ui.model.ParseException');sap.ui.define("sap/ino/commons/models/types/IntegerNullableType",["sap/ui/model/type/Integer","sap/ui/model/ParseException"],function(I,P){"use strict";return I.extend("sap.ino.commons.models.types.IntegerNullableType",{formatValue:function(v,i){if(v===null||v===undefined||v===""){return v;}return I.prototype.formatValue.apply(this,[v,i]);},parseValue:function(v,i){if(v===null||v===undefined||v===""){return v;}if(v.indexOf(",")>-1||jQuery.trim(v).indexOf(" ")>-1){var b=sap.ui.getCore().getLibraryResourceBundle();throw new P(b.getText("Integer.Invalid"));return;}return I.prototype.parseValue.apply(this,[v,i]);},validateValue:function(v){if(v===null||v===undefined||v===""){return true;}return I.prototype.validateValue.apply(this,[v]);}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.types.IntegerType')){jQuery.sap.declare('sap.ino.commons.models.types.IntegerType');jQuery.sap.require('sap.ui.model.type.Integer');jQuery.sap.require('sap.ui.model.ParseException');sap.ui.define("sap/ino/commons/models/types/IntegerType",["sap/ui/model/type/Integer","sap/ui/model/ParseException"],function(I,P){"use strict";return I.extend("sap.ino.commons.models.types.IntegerType",{formatValue:function(v,i){return I.prototype.formatValue.apply(this,[v,i]);},parseValue:function(v,i){if(v.indexOf(",")>-1||jQuery.trim(v).indexOf(" ")>-1){var b=sap.ui.getCore().getLibraryResourceBundle();throw new P(b.getText("Integer.Invalid"));return;}return I.prototype.parseValue.apply(this,[v,i]);},validateValue:function(v){return I.prototype.validateValue.apply(this,[v]);}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.types.StringBooleanType')){jQuery.sap.declare('sap.ino.commons.models.types.StringBooleanType');jQuery.sap.require('sap.ui.model.SimpleType');sap.ui.define("sap/ino/commons/models/types/StringBooleanType",["sap/ui/model/SimpleType"],function(S){"use strict";return S.extend("sap.ino.commons.models.types.StringBooleanType",{formatValue:function(v){return v==="1";},parseValue:function(v){return v?"1":"0";},validateValue:function(v){return v==="0"||v==="1";}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.types.StringNumberType')){jQuery.sap.declare('sap.ino.commons.models.types.StringNumberType');jQuery.sap.require('sap.ui.model.SimpleType');sap.ui.define("sap/ino/commons/models/types/StringNumberType",["sap/ui/model/SimpleType"],function(S){"use strict";return S.extend("sap.ino.commons.models.types.StringNumberType",{formatValue:function(v,i){if(v===null){return null;}if(i==="float"){return parseFloat(v);}return 0;},parseValue:function(v,i){return v.toString();},validateValue:function(v){return true;}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.util.UUID')){jQuery.sap.declare('sap.ino.commons.models.util.UUID');sap.ui.define("sap/ino/commons/models/util/UUID",[],function(){"use strict";return{generate:function(){var d=new Date().getTime();var u='xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c=='x'?r:(r&0x3|0x8)).toString(16);});return u.toUpperCase();}};});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.util.WallMapper')){jQuery.sap.declare('sap.ino.commons.models.util.WallMapper');sap.ui.define("sap/ino/commons/models/util/WallMapper",["sap/ino/commons/application/Configuration"],function(C){"use strict";var W={Readonly:"Readonly",Write:"Write"};var _=function(v){return v?v+"px":"0px";};var a=function(v){return parseInt(v,10);};var b=function(v){return e[v];};var c=function(u){return u?parseInt(u.substring(u.lastIndexOf("/")+1),10):undefined;};var d=function(I){return C.getAttachmentDownloadURL(I);};var e={"Yellow":"FCF294","FCF294":"Yellow","Pink":"E5B0E8","E5B0E8":"Pink","Cyan":"87E0FD","87E0FD":"Cyan","Green":"D2FF52","D2FF52":"Green","Neutral":"FFFFFF","FFFFFF":"Neutral","Orange":"FFA84C","FFA84C":"Orange","Red":"FF3019","FF3019":"Red","Rose":"F9D6D6","F9D6D6":"Rose","Lavender":"C4C6FF","C4C6FF":"Lavender","Black":"45484D","45484D":"Black"};var f=function(v){if(v.length===7&&v[0]==="#"){return v.substr(1);}else if(v.length===4&&v[0]==="#"){return v[1]+v[1]+v[2]+v[2]+v[3]+v[3];}return undefined;};var g=function(v){if(v.length===6){return"#"+v;}else if(v.length===3){return"#"+v[1]+v[1]+v[2]+v[2]+v[3]+v[3];}return undefined;};var h={"sap.ino.config.GROUP":"sap.ino.wall.WallItemGroup","sap.ino.wall.WallItemGroup":"sap.ino.config.GROUP","sap.ino.config.ATTACHMENT":"sap.ino.wall.WallItemAttachment","sap.ino.wall.WallItemAttachment":"sap.ino.config.ATTACHMENT","sap.ino.config.DOCUMENT":"sap.ino.wall.WallItemDocument","sap.ino.wall.WallItemDocument":"sap.ino.config.DOCUMENT","sap.ino.config.HEADLINE":"sap.ino.wall.WallItemHeadline","sap.ino.wall.WallItemHeadline":"sap.ino.config.HEADLINE","sap.ino.config.IMAGE":"sap.ino.wall.WallItemImage","sap.ino.wall.WallItemImage":"sap.ino.config.IMAGE","sap.ino.config.LINE":"sap.ino.wall.WallItemLine","sap.ino.wall.WallItemLine":"sap.ino.config.LINE","sap.ino.config.LINK":"sap.ino.wall.WallItemLink","sap.ino.wall.WallItemLink":"sap.ino.config.LINK","sap.ino.wall.WallItemPerson":"sap.ino.config.PERSON","sap.ino.config.PERSON":"sap.ino.wall.WallItemPerson","sap.ino.config.SPRITE":"sap.ino.wall.WallItemSprite","sap.ino.wall.WallItemSprite":"sap.ino.config.SPRITE","sap.ino.config.STICKER":"sap.ino.wall.WallItemSticker","sap.ino.wall.WallItemSticker":"sap.ino.config.STICKER","sap.ino.config.TEXT":"sap.ino.wall.WallItemText","sap.ino.wall.WallItemText":"sap.ino.config.TEXT","sap.ino.config.VIDEO":"sap.ino.wall.WallItemVideo","sap.ino.wall.WallItemVideo":"sap.ino.config.VIDEO","sap.ino.config.ARROW":"sap.ino.wall.WallItemArrow","sap.ino.wall.WallItemArrow":"sap.ino.config.ARROW"};var i={"WALL":{"storageId":{property:"ID"},"title":{property:"NAME"},"backgroundImage":{property:"BACKGROUND_IMAGE_URL"},"backgroundImageZoom":{property:"BACKGROUND_IMAGE_ZOOM",formatter:function(v){var V=parseInt(v,10);return isNaN(V)?1:V;}},"backgroundImageTiled":{property:"BACKGROUND_IMAGE_REPEAT",formatter:function(t){return t?1:0;}},"backgroundColor":{property:"BACKGROUND_COLOR"},"mode":{property:"IS_LOCKED",formatter:function(M){return M==W.Readonly?1:0;}},"type":{property:"WALL_TYPE_CODE",formatter:function(t){return t==="Template"?"sap.ino.config.TEMPLATE":"sap.ino.config.WALL";}},"actionCode":{property:"ACTION_CODE"}},"INO":{"ID":{property:"storageId"},"NAME":{property:"title"},"BACKGROUND_IMAGE_URL":{property:"backgroundImage"},"BACKGROUND_IMAGE_ZOOM":{property:"backgroundImageZoom",formatter:function(v){var V=parseInt(v,10);return isNaN(V)?1:V;}},"BACKGROUND_IMAGE_REPEAT":{property:"backgroundImageTiled",formatter:function(r){return r==1;}},"BACKGROUND_COLOR":{property:"backgroundColor"},"CREATED_BY_NAME":{property:"owner"},"IS_LOCKED":{property:"mode",formatter:function(I){return I==1?W.Readonly:W.Write;}},"WALL_TYPE_CODE":{property:"type",formatter:function(w){return w==="sap.ino.config.TEMPLATE"?"Template":"Wall";}},"ACTION_CODE":{property:"actionCode"}}};var j={"WALL":{"storageId":{property:"ID"},"id":{initial:true,property:"ID"},"parentId":{property:"PARENT_WALL_ITEM_ID",formatter:function(P){return(P!=="0")?P:null;}},"w":{property:"WIDTH",formatter:function(v){return a(v)||0;}},"h":{property:"HEIGHT",formatter:function(v){return a(v)||0;}},"depth":{property:"ZINDEX"},"className":{property:"WALL_ITEM_TYPE_CODE",formatter:function(s){return h[s];}},"title":{parent:"CONTENT",property:"TEXT"},"position":{children:{"x":{property:"POSITION_X",formatter:a},"y":{property:"POSITION_Y",formatter:a}}},"actionCode":{property:"ACTION_CODE"}},"INO":{"ID":{property:"storageId"},"PARENT_WALL_ITEM_ID":{property:"parentId"},"NAME":{property:"title"},"CONTENT":{children:{"TEXT":{property:"title"}}},"WIDTH":{property:"w",formatter:_},"HEIGHT":{property:"h",formatter:_},"ZINDEX":{property:"depth"},"WALL_ITEM_TYPE_CODE":{property:"className",formatter:function(s){return h[s];}},"POSITION_X":{parent:"position",property:"x",formatter:_},"POSITION_Y":{parent:"position",property:"y",formatter:_},"ACTION_CODE":{property:"actionCode"}}};var k={"WALL":{"sap.ino.wall.WallItemHeadline":{"size":{parent:"CONTENT",property:"SIZE"},"type":{parent:"CONTENT",property:"STYLE"}},"sap.ino.wall.WallItemLink":{"description":{parent:"CONTENT",property:"URL"},"type":{parent:"CONTENT",property:"ICON"}},"sap.ino.wall.WallItemSticker":{"color":{parent:"CONTENT",property:"COLOR",formatter:b},"description":{parent:"CONTENT",property:"TEXT"}},"sap.ino.wall.WallItemGroup":{"color":{parent:"CONTENT",property:"COLOR",formatter:f}},"sap.ino.wall.WallItemImage":{"content":{children:{"image":{parent:"Image",array:true,property:"ATTACHMENT_ID",formatter:c},"preview":{initial:true,parent:"Image",array:true,property:"ATTACHMENT_ID",formatter:c},"assignmentId":{parent:"Image",array:true,property:"ID"},"showAsIcon":{parent:"CONTENT",property:"SHOW_AS_ICON"}}},"title":{parent:"CONTENT",property:"CAPTION"}},"sap.ino.wall.WallItemText":{"description":{parent:"CONTENT",property:"TEXT"},"title":{parent:"CONTENT",property:"CAPTION"}},"sap.ino.wall.WallItemLine":{"orientation":{parent:"CONTENT",property:"ORIENTATION"},"thickness":{parent:"CONTENT",property:"THICKNESS"},"style":{parent:"CONTENT",property:"STYLE"},"color":{parent:"CONTENT",property:"COLOR",formatter:f},"title":{property:"NAME"}},"sap.ino.wall.WallItemSprite":{"color":{parent:"CONTENT",property:"COLOR",formatter:f},"type":{parent:"CONTENT",property:"SHAPE"}},"sap.ino.wall.WallItemPerson":{"title":{parent:"CONTENT",property:"NAME"},"content":{children:{"image":{parent:"Image",array:true,property:"ATTACHMENT_ID",formatter:c},"phone":{parent:"CONTENT",property:"PHONE"},"email":{parent:"CONTENT",property:"EMAIL"},"originId":{parent:"CONTENT",property:"ORIGIN_ID"},"requestImage":{parent:"CONTENT",property:"REQUEST_IMAGE"},"assignmentId":{parent:"Image",array:true,property:"ID"}}}},"sap.ino.wall.WallItemVideo":{"content":{children:{"video":{parent:"CONTENT",property:"URL"},"preview":{initial:true,parent:"CONTENT",property:"URL"}}},"title":{parent:"CONTENT",property:"CAPTION"}},"sap.ino.wall.WallItemDocument":{"title":{parent:"CONTENT",property:"CAPTION"},"description":{parent:"CONTENT",property:"URL"},"type":{parent:"CONTENT",property:"DOC_TYPE"}},"sap.ino.wall.WallItemAttachment":{"title":{parent:"CONTENT",property:"CAPTION"},"content":{children:{"URL":{parent:"Attachment",array:true,property:"ATTACHMENT_ID",formatter:c},"assignmentId":{parent:"Attachment",array:true,property:"ID"},"type":{parent:"CONTENT",property:"TYPE"},"fileName":{parent:"CONTENT",property:"FILE_NAME"}}}},"sap.ino.wall.WallItemArrow":{"thickness":{parent:"CONTENT",property:"THICKNESS"},"style":{parent:"CONTENT",property:"STYLE"},"headStyle":{parent:"CONTENT",property:"HEAD_STYLE"},"color":{parent:"CONTENT",property:"COLOR",formatter:f},"title":{parent:"CONTENT",property:"TEXT"},"x1":{parent:"CONTENT",property:"X1"},"y1":{parent:"CONTENT",property:"Y1"},"x2":{parent:"CONTENT",property:"X2"},"y2":{parent:"CONTENT",property:"Y2"}}},"INO":{"sap.ino.config.HEADLINE":{"CONTENT":{children:{"SIZE":{property:"size"},"STYLE":{property:"type"},"TEXT":{property:"title"}}}},"sap.ino.config.LINK":{"CONTENT":{children:{"URL":{property:"description"},"ICON":{property:"type"},"TEXT":{property:"title"}}}},"sap.ino.config.STICKER":{"CONTENT":{children:{"COLOR":{property:"color",formatter:b},"TEXT":{property:"description"}}}},"sap.ino.config.GROUP":{"CONTENT":{children:{"COLOR":{property:"color",formatter:g},"TEXT":{property:"title"}}}},"sap.ino.config.IMAGE":{"CONTENT":{children:{"CAPTION":{property:"title"},"SHOW_AS_ICON":{parent:"content",property:"showAsIcon"}}},"Image":{children:{"ATTACHMENT_ID":{parent:"content",property:["image","preview"],formatter:d},"ID":{parent:"content",property:"assignmentId"}}}},"sap.ino.config.TEXT":{"CONTENT":{children:{"CAPTION":{property:"title"},"TEXT":{property:"description"}}}},"sap.ino.config.LINE":{"CONTENT":{children:{"ORIENTATION":{property:"orientation"},"THICKNESS":{property:"thickness"},"STYLE":{property:"style"},"COLOR":{property:"color",formatter:g}}},"NAME":{property:"title"}},"sap.ino.config.SPRITE":{"CONTENT":{children:{"COLOR":{property:"color",formatter:g},"SHAPE":{property:"type"},"TEXT":{property:"title"}}}},"sap.ino.config.PERSON":{"CONTENT":{children:{"NAME":{property:"title"},"IMAGE":{property:"image",parent:"content"},"PHONE":{property:"phone",parent:"content"},"EMAIL":{property:"email",parent:"content"},"ORIGIN_ID":{property:"originId",parent:"content"},"REQUEST_IMAGE":{property:"requestImage",parent:"content"}}},"Image":{children:{"ATTACHMENT_ID":{parent:"content",property:["image","preview"],formatter:d},"ID":{parent:"content",property:"assignmentId"}}}},"sap.ino.config.VIDEO":{"CONTENT":{children:{"URL":{parent:"content",property:["video","preview"]},"CAPTION":{property:"title"}}}},"sap.ino.config.DOCUMENT":{"CONTENT":{children:{"URL":{property:"description"},"CAPTION":{property:"title"},"DOC_TYPE":{property:"type"}}}},"sap.ino.config.ATTACHMENT":{"CONTENT":{children:{"CAPTION":{property:"title"},"TYPE":{property:"type",parent:"content"},"FILE_NAME":{property:"fileName",parent:"content"}}},"Attachment":{children:{"ATTACHMENT_ID":{property:"URL",parent:"content",formatter:d},"ID":{property:"assignmentId",parent:"content"}}}},"sap.ino.config.ARROW":{"CONTENT":{children:{"THICKNESS":{property:"thickness"},"STYLE":{property:"style"},"HEAD_STYLE":{property:"headStyle"},"COLOR":{property:"color",formatter:g},"TEXT":{property:"title"},"X1":{property:"x1"},"Y1":{property:"y1"},"X2":{property:"x2"},"Y2":{property:"y2"}}}}}};var l=function(I,P,F,o,v){if(P){if(jQuery.type(P)=="array"){P.forEach(function(s){if(!o||!I[s]){I[s]=F?F(v):v;}});}else{if(!o||!I[P]){I[P]=F?F(v):v;}}}};var m=function(I,P,s,F,o,v,A){if(P){if(s){if(!I[s]){if(A){I[s]=[];}else{I[s]={};}}if(A&&I[s].length===0){I[s].push({});}var O=A?I[s][0]:I[s];l(O,P,F,o,v);if(A&&JSON.stringify(O)==="{}"){I[s].pop();}}else{l(I,P,F,o,v);}}};var n=function(I,M,v){var V=(jQuery.type(v)==="array")?v[0]:v;var F,P,s,A,o;if(V!==undefined){if(M.children){for(var q in M.children){F=M.children[q].formatter;P=M.children[q].property;s=M.children[q].parent;A=M.children[q].array;o=M.children[q].initial;m(I,P,s,F,o,V[q],A);}}else{F=M.formatter;P=M.property;s=M.parent;A=M.array;o=M.initial;m(I,P,s,F,o,V,A);}}};var p={};p.mapItemToIno=function(w){var I={};var s=w.className;var D=j.WALL;var S=k.WALL[s];for(var o in w){if(w.hasOwnProperty(o)){if(S&&S[o]){n(I,S[o],w[o]);}else if(D[o]){n(I,D[o],w[o]);}}}return I;};p.mapItemsFromIno=function(I,D){var M=function(o){var v={};var w=o.WALL_ITEM_TYPE_CODE;var x=j.INO;var S=k.INO[w];for(var t in o){if(o.hasOwnProperty(t)){if(S&&S[t]){n(v,S[t],o[t]);}else if(x[t]){n(v,x[t],o[t]);}}}return v;};var q=[];var r=jQuery.type(I)=="array"?I:[I];if(D){r.forEach(function(o){q.push(M(o));});}else{var P=[];var s={};r.forEach(function(o){var v=M(o);P.push(v);if(v.parentId>0){if(!s[v.parentId]){s[v.parentId]=[];}s[v.parentId].push(v);}else{q.push(v);}});for(var t in s){if(s.hasOwnProperty(t)){var u=P.filter(function(o){return o.storageId==t;});if(u&&u.length>0){u[0].childs=s[t];}}}}return q;};p.setInoProperty=function(w,I,v){if(jQuery.sap.startsWith(I,"/")){I=I.substring(1);}var M=i.INO[I];if(M&&M.property){var s="set"+M.property.substring(0,1).toUpperCase()+M.property.substring(1);if(typeof w[s]==="function"){w[s].apply(w,[M.formatter?M.formatter(v):v]);}else{w.setProperty(M.property,M.formatter?M.formatter(v):v);w._notifyChanged(M.property);}return true;}else{jQuery.sap.log.warning("no mapping available for property '"+I+"'",undefined,"WallMapper");return false;}};p._checkWallPrivilege=function(G,u){if(u===undefined){u=C.getCurrentUser().USER_ID;}if(G&&jQuery.type(G==="array")){var o=G.filter(function(I){return I.IDENTITY_ID===u;});if(o.length>0){return true;}}return false;};p.mapWallFromIno=function(I,D){var w;if(I){w={};for(var o in I){if(I.hasOwnProperty(o)&&i.INO[o]&&i.INO[o].property){w[i.INO[o].property]=i.INO[o].formatter?i.INO[o].formatter(I[o]):I[o];}}w.hits=0;w.favorite=false;w.timestamp=new Date(I.CHANGED_AT).getTime();var u=C.getCurrentUser().USER_ID;var M=p._checkWallPrivilege(I.Owner,u);var s="owner";if(!M){M=p._checkWallPrivilege(I.Admins,u);s="admin";}if(!M){M=p._checkWallPrivilege(I.Writers,u);s="write";}if(!M){M=p._checkWallPrivilege(I.Readers,u);s="read";}if(!M){s="none";}w.strongestAuth=s;var q=[];w.numberOfItems=I.Items?I.Items.length:0;if(w.numberOfItems>0){q=p.mapItemsFromIno(I.Items,D);}w.items=q;}return w;};p.mapWallToIno=function(w){var J=w.formatToJSON();var I=[];var o={};for(var q in J){if(J.hasOwnProperty(q)&&i.WALL[q]&&i.WALL[q].property){o[i.WALL[q].property]=i.WALL[q].formatter?i.WALL[q].formatter(J[q]):J[q];}}var r=w.getItems();if(jQuery.type(r)==="array"){r.forEach(function(s){I=I.concat(p.mapWallToInoItem(s));});}o.Items=I;return o;};p.mapWallToInoItem=function(I){var o=p.mapItemToIno(I.formatToJSON());var q=[o];if(I.getChilds().length>0){I.getChilds().forEach(function(r){q=q.concat(p.mapWallToInoItem(r));});}return q;};return p;});};if(!jQuery.sap.isDeclared('sap.ino.commons.util.DateUtil')){jQuery.sap.declare('sap.ino.commons.util.DateUtil');sap.ui.define("sap/ino/commons/util/DateUtil",[],function(){"use strict";return{convertToUtcString:function(d,e){if(!d){return d;}if(typeof d==="string"){d=new Date(d);}var m=(d.getMonth()+1)>=10?d.getMonth()+1:"0"+(d.getMonth()+1);var D=d.getDate()>=10?d.getDate():"0"+d.getDate();return d.getFullYear()+"-"+m+"-"+D+(e?'T23:59:59.999Z':'T00:00:00.000Z');},convertToLocalDate:function(d,e){if(!d){return d;}if(typeof d==="string"){d=new Date(d);}return new Date(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),e?23:0,e?59:0,e?59:0,e?999:0);}};});};if(!jQuery.sap.isDeclared('sap.ino.commons.util.INMBreadCrumbs')){jQuery.sap.declare('sap.ino.commons.util.INMBreadCrumbs');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/ino/commons/util/INMBreadCrumbs",["sap/ino/commons/application/Configuration","sap/ui/base/Object"],function(C,O){var b=[{"TEXT":"PAGE_TIT_HOME","name":"home","target":"home","available":"all","path":"home"},{"name":"home-explicit","target":"home"},{"TEXT":"PAGE_TIT_IDEAS","name":"idealist","target":"idealist","available":"idea-display","path":"home/idealist"},{"variant":true,"name":"idealistvariant","target":"idealist","available":"idea-display","path":"home/idealistvariant"},{"TEXT":"PAGE_TIT_WALLS","name":"walllist","target":"walllist","available":"wall","path":"home/walllist"},{"variant":true,"name":"walllistvariant","target":"walllist","path":"home/walllist"},{"oData":"Wall","pattern":"id","name":"wall","available":"wall","target":"wall","path":"home/walllist/wall"},{"oData":"Wall","pattern":"id","name":"wallremote","target":"wallremote","path":"home/walllist/wallremote","available":"wall"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-headline","target":"wallremoteitem-headline","path":"home/walllist/wallremote/wallremoteitem-headline"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-sticker","target":"wallremoteitem-sticker","path":"home/walllist/wallremote/wallremoteitem-sticker"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-link","target":"wallremoteitem-link","path":"home/walllist/wallremote/wallremoteitem-link"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-image","target":"wallremoteitem-image","path":"home/walllist/wallremote/wallremoteitem-image"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-text","target":"wallremoteitem-text","path":"home/walllist/wallremote/wallremoteitem-text"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-sprite","target":"wallremoteitem-sprite","path":"home/walllist/wallremote/wallremoteitem-sprite"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-person","target":"wallremoteitem-person","path":"home/walllist/wallremote/wallremoteitem-person"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-video","target":"wallremoteitem-video","path":"home/walllist/wallremote/wallremoteitem-video"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-attachment","target":"wallremoteitem-attachment","path":"home/walllist/wallremote/wallremoteitem-attachment"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-group","target":"wallremoteitem-group","path":"home/walllist/wallremote/wallremoteitem-group"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-line","target":"wallremoteitem-line","path":"home/walllist/wallremote/wallremoteitem-line"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-arrow","target":"wallremoteitem-arrow","path":"home/walllist/wallremote/wallremoteitem-arrow"},{"TEXT":"PAGE_TIT_CAMPAIGNS","name":"campaignlist","target":"campaignlist","available":"campaign","path":"home/campaignlist"},{"variant":true,"name":"campaignlistvariant","target":"campaignlist","available":"campaign","path":"home/campaignlistvariant"},{"TEXT":"PAGE_TIT_PEOPLE","name":"peoplelist","target":"peoplelist","path":"home/peoplelist"},{"name":"peoplelistvariant","target":"peoplelist","path":"home/peoplelistvariant"},{"TEXT":"PAGE_TIT_EXPERTFINDER","name":"expertfinder","target":"expertfinder","path":"home/expertfinder"},{"oData":"IdeaSmall","pattern":"id","name":"idea-display","target":"idea-display","available":"evaluation-display/evaluation-create/evaluationrequest-create/evaluationrequest-display/evaluationrequest-edit","path":"home/idealist/idea-display"},{"TEXT":"PAGE_TIT_IDEA_EDIT","oData":"IdeaSmall","name":"idea-edit","target":"idea-modify","path":"home/idealist/idea-display/idea-edit"},{"TEXT":"PAGE_TIT_IDEA_CREATE","name":"idea-create","target":"idea-modify","path":"home/idea-create"},{"oData":"CampaignSmall","pattern":"id","name":"campaign","target":"campaign","available":"campaign-idealist/campaign-idealistvariant/bloglist/campaign-comment/campaign-feeds/campaign-managerlist/blog-create","path":"home/campaignlist/campaign"},{"TEXT":"PAGE_TIT_CAMPAIGN_COMMENT","name":"campaign-comment","target":"campaign-comment","path":"home/campaignlist/campaign/campaign-comment"},{"TEXT":"PAGE_TIT_CAMPAIGN_FEEDS","name":"campaign-feeds","target":"campaign-feeds","path":"home/campaignlist/campaign/campaign-feeds"},{"TEXT":"PAGE_TIT_CAMPAIGN_IDEAS","name":"campaign-idealist","target":"campaign-idealist","available":"idea-display","path":"home/campaignlist/campaign/campaign-idealist"},{"variant":true,"name":"campaign-idealistvariant","target":"campaign-idealist","available":"idea-display","path":"home/campaignlist/campaign/campaign-idealistvariant"},{"name":"campaign-managerlist","target":"campaign-managerlist","path":"home/campaignlist/campaign/campaign-managerlist"},{"name":"search","target":"search"},{"name":"searchcategory","target":"searchcategory"},{"name":"message","target":"message"},{"name":"vote","target":"vote"},{"name":"identitycard","target":"identitycard"},{"name":"processindicator","target":"processindicator"},{"name":"ideacard","target":"ideacard"},{"name":"campaigncard","target":"campaigncard"},{"name":"votedisplay","target":"votedisplay","path":"home/votedisplay"},{"TEXT":"PAGE_TIT_REPORTS","name":"reportlist","target":"reportlist","path":"home/reportlist"},{"variant":true,"name":"reportlistvariant","target":"reportlist","path":"home/reportlistvariant"},{"pattern":"code","TEXT":"PAGE_TIT_REPORTS","name":"report","target":"report","path":"home/report"},{"TEXT":"PAGE_TIT_EVALUATION","name":"evaluation-display","target":"evaluation-display","path":"home/evaluation-display"},{"TEXT":"PAGE_TIT_EVALUATION_EDIT","name":"evaluation-edit","target":"evaluation-modify","path":"home/evaluation-display/evaluation-edit"},{"name":"welcomepage","target":"welcomepage"},{"TEXT":"PAGE_TIT_EVALUATION_CREATE","name":"evaluation-create","target":"evaluation-modify"},{"TEXT":"PAGE_TIT_FEEDS","name":"feedlist","target":"feedlist","path":"home/feedlist"},{"TEXT":"PAGE_TIT_TAGS","name":"taglist","target":"taglist","path":"home/taglist"},{"variant":true,"name":"taglistvariant","target":"taglist","path":"home/taglistvariant"},{"name":"followlist","target":"followlist","path":"home/followlist"},{"variant":true,"name":"followlistvariant","target":"followlist","path":"home/followlistvariant"},{"TEXT":"PAGE_TIT_REGISTER_PENDING","name":"registerapprovallist","target":"registerapprovallist","path":"home/registerapprovallist"},{"variant":true,"name":"registerapprovallistvariant","target":"registerapprovallist","path":"home/registerapprovallistvariant"},{"TEXT":"PAGE_TIT_BLOGS","name":"bloglist","target":"bloglist","available":"blog-display","path":"home/bloglist"},{"variant":true,"name":"bloglistvariant","target":"bloglist","available":"blog-display","path":"home/bloglistvariant"},{"TEXT":"PAGE_TIT_CAMPAIGN_IDEAS","name":"campaign-bloglist","target":"campaign-bloglist","available":"blog-display","path":"home/campaignlist/campaign/campaign-bloglist"},{"variant":true,"name":"campaign-bloglistvariant","target":"campaign-bloglist","path":"home/campaignlist/campaign/campaign-bloglistvariant"},{"TEXT":"PAGE_TIT_BLOG_EDIT","name":"blog-edit","target":"blog-modify","path":"home/bloglist/blog-display/blog-edit"},{"TEXT":"PAGE_TIT_BLOG_CREATE","name":"blog-create","target":"blog-modify","path":"home/blog-create"},{"oData":"CampaignBlogsSmall","pattern":"id","name":"blog-display","available":"blog-display/blog-edit","target":"blog-display","path":"home/bloglist/blog-display"},{"TEXT":"PAGE_TIT_EVALUATIONREQUEST_CREATE","name":"evaluationrequest-create","target":"evaluationrequestmodify","path":"home/evaluationrequest-create"},{"TEXT":"PAGE_TIT_EVALUATIONREQUEST_EDIT","name":"evaluationrequest-edit","target":"evaluationrequestmodify","path":"home/evalreqlist/evaluationrequest-display/evaluationrequest-edit"},{"TEXT":"PAGE_TIT_EVALUATIONREQUEST_DISPLAY","name":"evaluationrequest-display","target":"evaluationrequestdisplay","available":"evaluationrequest-edit/evaluationrequest-item","path":"home/evalreqlist/evaluationrequest-display"},{"TEXT":"PAGE_TIT_EVALUATIONREQUEST_ITEM","name":"evaluationrequest-item","target":"evaluationrequestitem","path":"home/evalreqlist/evaluationrequest-display/evaluationrequest-item"},{"TEXT":"PAGE_TIT_REWARDS","name":"rewardlist","target":"rewardlist","path":"home/rewardlist"},{"variant":true,"name":"rewardlistvariant","target":"rewardlist","path":"home/rewardlistvariant"},{"TEXT":"PAGE_TIT_EVALUATION_REQUESTS","name":"evalreqlist","target":"evalreqlist","path":"home/evalreqlist"},{"variant":true,"name":"evalreqlistvariant","target":"evalreqlist","path":"home/evalreqlistvariant"},{"TEXT":"PAGE_TIT_MY_SETTING","name":"mySetting","target":"mySetting","path":"home/mySetting"}];var I=O.extend("sap.ino.commons.util.INMBreadCrumbs",{});I.maintainBreadCrumbs=function(B,c,o,a,s,d){var g;var l;var p;var P=s.split("/").length>1?s.split("/")[1]:"";var v=c.variant?d.split("_").pop():"";if(a.getProperty("/CurrentAvailable")==="all"){g=false;}else if(a.getProperty("/CurrentAvailable")!=="none"){var A=a.getProperty("/CurrentAvailable").split("/");A.forEach(function(n,i){g=n===c.name?true:false;return;});}else{g=false;}if(g){l=true;p=null;this.addBreadCrumbs(B,c,P,a,l,p,v);}else{B.destroyLinks();var e=c.path.split("/");var f=e.length;e.forEach(jQuery.proxy(function(n,i){var h=this.getBreadObjectByName(n);if(h.pattern){p={};p[h.pattern]=P;}l=f===i+1;this.addBreadCrumbs(B,h,P,a,l,p,v);},this));}};I.addBreadCrumbs=function(B,c,p,o,l,P,v){var s=C.getBackendRootURL()+"/sap/ino/?env=development";var d=c.oData+"("+p+")";var n,t,V;var a=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")?"/sap/ino/xs/rest/backoffice/odata.xsodata/":"/sap/ino/xs/rest/community/odata.xsodata/";if(c.pattern){var e=jQuery.ajax({url:C.getBackendRootURL()+a+d,type:"GET",dataType:"json",async:false});e.done(function(r){n=r.d.SHORT_NAME?r.d.SHORT_NAME:r.d.NAME;t=r.d.TITLE?r.d.TITLE:n;});}if(c.variant){var A=this.getCurrentView().getController().list.Variants;V=this.getObjectListVariantText(A,v)?this.getObjectListVariantText(A,v):c.name;}else{V=this._i18n.getResourceBundle().getText(c.TEXT);}B.addLink(new sap.m.Link({text:c.pattern?t:V,target:"_top",enabled:l?false:true,href:l?window.location.href:s+this.getNavigationLink(c.name,P)}));if(l&&B.getLinks().length>1){var N=B.getLinks().length>1?B.getLinks().length-2:B.getLinks().length-1;B.getLinks()[N].setEnabled(true);}o.setProperty("/CurrentAvailable",c.available?c.available:"none");o.setProperty("/CurrentRoute",c.name);};I.setBreadCrumbsText=function(B,t){B.setCurrentLocationText(t);};I.getBreadObjectByPath=function(t){var a;jQuery.each(b,function(i,v){if(v.PATH===t){a=v;}});return a;};I.getBreadObjectByName=function(t){var a;jQuery.each(b,function(i,v){if(v.name===t){a=v;}});return a;};I.getObjectListVariantText=function(a,t){var v=a.Values;var c;jQuery.each(v,function(i,d){if(d.ACTION===t){c=d.TEXT;}});return this._i18n.getResourceBundle().getText(c);};return I;});};if(!jQuery.sap.isDeclared('sap.ino.commons.util.Mail')){jQuery.sap.declare('sap.ino.commons.util.Mail');sap.ui.define("sap/ino/commons/util/Mail",[],function(){"use strict";return{_getText:function(t,p){return this.i18n.getResourceBundle().getText(t,p);},createContent:function(c){if(c){var s="";var C=c.getProperty("/NAME");var a=c.getProperty("/_OBJECT_TYPE_CODE");if(a==="IDEA"){s=this._getText("MAIL_SUBJECT_TEMPLATE",[c.getProperty("/CAMPAIGN_NAME"),C]);}else{s=C;}var b="";var i=c.getProperty("/ID");if(a&&i){var u=document.location.origin+document.location.pathname+this.getNavigationLink(a.toLowerCase()+"-display",{id:i});b=this.getText("MAIL_TEMPLATE_"+a,u);}return{subject:s,body:b};}}};});};if(!jQuery.sap.isDeclared('sap.ino.commons.util.UIObjectConfig')){jQuery.sap.declare('sap.ino.commons.util.UIObjectConfig');sap.ui.define("sap/ino/commons/util/UIObjectConfig",[],function(){"use strict";var U=function(){throw"May not be instantiated directly";};var D={"sap.ino.xs.object.iam.Identity":{searchPath:"/SearchIdentity(searchToken='{searchToken}')/Results",instancePath:"Identity",selectionKey:"ID",selectionField:"NAME",secondarySelectionField:"USER_NAME",navigation:{path:"identity-display",key:"id"},quickView:"sap.ino.vc.iam.IdentityCard",parameters:{select:"searchToken,ID,NAME,USER_NAME"}},"sap.ino.xs.object.iam.User":{searchPath:"/SearchIdentity(searchToken='{searchToken}')/Results",instancePath:"Identity",selectionKey:"ID",selectionField:"NAME",secondarySelectionField:"USER_NAME",navigation:{path:"idea-display",key:"id"},quickView:"sap.ino.vc.iam.IdentityCard",parameters:{select:"searchToken,ID,NAME,USER_NAME",filter:"TYPE_CODE%20eq%20%27USER%27"}},"sap.ino.xs.object.iam.Group":{searchPath:"/SearchIdentity(searchToken='{searchToken}')/Results",instancePath:"Identity",selectionKey:"ID",selectionField:"NAME",secondarySelectionField:"USER_NAME",navigation:{path:"group-display",key:"id"},quickView:"sap.ino.vc.iam.IdentityCard",parameters:{select:"searchToken,ID,NAME,USER_NAME",filter:"TYPE_CODE%20eq%20%27GROUP%27"}},"sap.ino.xs.object.idea.Idea":{searchPath:"/IdeaMediumSearchParams(searchToken='{searchToken}',tagsToken='',filterName='',filterBackoffice=0)/Results",instancePath:"IdeaFull",selectionKey:"ID",selectionField:"NAME",secondarySelectionField:"",navigation:{path:"idea-display",key:"id"},parameters:{select:"searchToken,ID,NAME"}},"sap.ino.xs.object.campaign.Campaign":{searchPath:"/CampaignSearchParams(searchToken='{searchToken}',tagsToken='',filterName='',filterBackoffice=0)/Results",instancePath:"CampaignFull",selectionKey:"ID",selectionField:"NAME",secondarySelectionField:"",navigation:{path:"campaign-display",key:"id"},parameters:{select:"searchToken,ID,NAME"}}};U.getDefinition=function(o){var p=o.split(".");var n=p.pop();if(n==="Root"){o=p.join(".");}return D[o];};U.getSearchPath=function(o,s){s=jQuery.sap.encodeURL(s.replace(/'/g,"''"));s=jQuery.trim(s);var d=U.getDefinition(o);return d.searchPath.replace("{searchToken}",s);};jQuery.each(D,function(o,u){if(u.searchPath){U.getSearchPath(o,u.searchPath);}});return U;});};if(!jQuery.sap.isDeclared('sap.ino.controls.ActiveNavigationListItem')){jQuery.sap.declare('sap.ino.controls.ActiveNavigationListItem');jQuery.sap.require('sap.tnt.NavigationListItem');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.ui.core.RenderManager');sap.ui.define("sap/ino/controls/ActiveNavigationListItem",["sap/tnt/NavigationListItem","sap/m/Button","sap/m/ButtonType","sap/ui/core/RenderManager"],function(N,B,a,R){"use strict";var A=N.extend("sap.ino.controls.ActiveNavigationListItem",{metadata:{properties:{selected:{type:"boolean",defaultValue:false},visible:{type:"boolean",defaultValue:true},buttonIcon:{type:"sap.ui.core.URI"},buttonTooltip:{type:"string",defaultValue:""}},aggregations:{_button:{type:"sap.m.Button",multiple:false,visibility:"hidden"}},events:{press:{}}}});A.prototype.render=function(r,c){var t=this;var i=this.getAggregation("items");if(c.getExpanded()&&(!i||i.length===0)&&this.getButtonIcon()){var n=new R();if(N.prototype.render){N.prototype.render.apply(this,[n,c]);}var h=n.aBuffer.join("");var b=this.getAggregation("_button");if(!b){b=new B({icon:this.getButtonIcon(),type:a.Transparent,tooltip:this.getTooltip()});jQuery(b)[0].attachPress(t,function(e){e.cancelBubble();var p={item:t};t.firePress(p);});b.addStyleClass("sapInoActiveNavigationListItemButton");}var o=n.getHTML(b);var H=jQuery(h);H.append(o);H.addClass("sapInoActiveNavigationListItem");if(this.getText()!==''){r.unsafeHtml(H.outerHTML());}}else{if(N.prototype.render){N.prototype.render.apply(this,[r,c]);}}setTimeout(function(){if(t.getSelected()){t._inoSelect();}else{t._inoUnselect();}},0);};A.prototype._inoSelect=function(){var $=this.$(),n=this.getNavigationList();if(!n){return;}if(!$.hasClass('sapInoNavLIItemSelected')){$.addClass('sapInoNavLIItemSelected');}};A.prototype._inoUnselect=function(){var $=this.$(),n=this.getNavigationList();if(!n){return;}if($.hasClass('sapInoNavLIItemSelected')){$.removeClass('sapInoNavLIItemSelected');}};return A;});};if(!jQuery.sap.isDeclared('sap.ino.controls.AriaLivePriority')){jQuery.sap.declare("sap.ino.controls.AriaLivePriority");(function(){"use strict";sap.ino.controls.AriaLivePriority={NONE:"",OFF:"off",POLITE:"polite",ASSERTIVE:"assertive"};})();};if(!jQuery.sap.isDeclared('sap.ino.controls.BackHeadItem')){jQuery.sap.declare('sap.ino.controls.BackHeadItem');jQuery.sap.require('sap.ui.unified.ShellHeadItem');jQuery.sap.require('sap.ui.core.IconPool');sap.ui.define("sap/ino/controls/BackHeadItem",["sap/ui/unified/ShellHeadItem",'sap/ui/core/IconPool'],function(S,I){"use strict";return S.extend("sap.ino.controls.BackHeadItem",{metadata:{properties:{enabled:{type:"boolean",group:"Appearance",defaultValue:true}},events:{backMenuOpen:{}}},onclick:function(e){e.preventDefault();},_toggleIcon:function(l,i){if(I.isIconURI(i)){var o=I.getIconInfo(i);if(o){l.find("span").text(o.content).css("font-family","'"+o.fontFamily+"'");}}},_refreshIcon:function(){var t=this;var l=this.$();var i=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");var T;if(i){T=i.getText("CTRL_NAVIGATION_HISTORY");}S.prototype._refreshIcon.apply(this,arguments);if(!this.getVisible()||l.next(".sapInoBackBtnEnd").length>0){return;}l.addClass("sapInoBackBtnBegin");l.attr('title',this.getTooltip());if(!l.next().hasClass("sapInoBackBtnEnd")){l.after($("<a role='button' aria-haspopup='true' tabindex='0' title='"+T+"' href='javascript:void(0);' class='sapUiUfdShellHeadItm sapInoBackBtnEnd'><span></span></a>"));}var s="sap-icon://slim-arrow-down";var L=l.next();this._toggleIcon(L,s);if(!this.getEnabled()){l.addClass("sapMLnkDsbl").attr("aria-disabled",true).attr("disabled",true).unbind("click");L.addClass("sapMLnkDsbl").attr("aria-disabled",true).attr("disabled",true).unbind("click");}else{l.removeClass("sapMLnkDsbl").attr("aria-disabled",false).attr("disabled",false).bind("click",function(e){t.firePress();e.preventDefault();});L.removeClass("sapMLnkDsbl").attr("aria-disabled",false).attr("disabled",false).bind("click",function(e){t._toggleIcon(L,"sap-icon://slim-arrow-up");t.fireBackMenuOpen();e.preventDefault();});}},setEnabled:function(e){e=!!e;this.setProperty("enabled",e,true);if(this.getDomRef()){this._refreshIcon();}return this;}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.BlogStatusType')){jQuery.sap.declare("sap.ino.controls.BlogStatusType");(function(){"use strict";sap.ino.controls.BlogStatusType={Draft:"sap.ino.config.DRAFT",Published:"sap.ino.config.BLOG_PUBLISHED"};})();};if(!jQuery.sap.isDeclared('sap.ino.controls.CampaignStatusType')){jQuery.sap.declare("sap.ino.controls.CampaignStatusType");(function(){"use strict";sap.ino.controls.CampaignStatusType={Draft:"sap.ino.config.CAMP_DRAFT",Published:"sap.ino.config.CAMP_PUBLISHED"};})();};if(!jQuery.sap.isDeclared('sap.ino.controls.CampaignType')){jQuery.sap.declare("sap.ino.controls.CampaignType");(function(){"use strict";sap.ino.controls.CampaignType={Small:"Small",Normal:"Normal",Banner:"Banner",Managed:"Managed"};})();};if(!jQuery.sap.isDeclared('sap.ino.controls.CategorySearchField')){jQuery.sap.declare('sap.ino.controls.CategorySearchField');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.SearchField');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ActionSelect');jQuery.sap.require('sap.ui.core.InvisibleText');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/ino/controls/CategorySearchField",['sap/ui/core/Control','sap/m/SearchField','sap/m/Button','sap/m/ActionSelect','sap/ui/core/InvisibleText','sap/ui/core/ListItem',"sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/commons/application/Configuration"],function(C,S,B,A,I,L,F,a,b){'use strict';return C.extend("sap.ino.controls.CategorySearchField",{metadata:{properties:{enbaled:{type:'boolean'},selectedCategory:{type:'string'},category:{type:'object[]'}},aggregations:{_SearchField:{type:'sap.m.SearchField',multiple:false,visibility:false},_CategoryDropDown:{type:'sap.m.ActionSelect',multiple:false,visibility:false}},events:{search:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_onSearch:function(e,k){var s=this.getModel('search').getProperty('/searchAguments');this.fireSearch({category:this.getProperty('selectedCategory'),search:k||e.getParameters().query.trim(),param:s});},_selectCategory:function(e){var p=e.getParameters();var i=p&&p.selectedItem;var k=i&&i.getKey();this.setProperty('selectedCategory',k);this.getModel('search').setProperty('/selectedCategory',k);var s=this.getAggregation('_SearchField');if(k==='idealistbycompany'||k==='campaign-idealistbycompany'){if(!s.getEnableSuggestions()){s.attachSuggest(function(E){var v=E.getParameter("suggestValue");var g=b.getGroupConfiguration();var T=g.GROUP==='COMPANY'?1:2;s.getModel("data").read("/SearchIdentityOrgCompanyParams(searchToken='"+jQuery.sap.encodeURL(v)+"')/Results",{urlParameters:{"$skip":0,"$top":30,"$filter":'TYPENAME eq \''+T+'\''},success:function(d){s.removeAllSuggestionItems();for(var c=0;c<d.results.length-1;c++){s.addAggregation("suggestionItems",new sap.m.SuggestionItem({key:d.results[c][g.GROUP],text:d.results[c].DISPLAYLABEL}),true);}if(d.results.length>0){s.addSuggestionItem(new sap.m.SuggestionItem({key:d.results[d.results.length-1][g.GROUP],text:d.results[d.results.length-1].DISPLAYLABEL}));}s.suggest(true);}});});s.setEnableSuggestions(true);}}else{s.setEnableSuggestions(false);s.destroySuggestionItems();}},_SearchInput:function(){var s=this;var c=s.getAggregation('_SearchField');if(!c){c=new S({showSearchButton:true,value:"{path: 'search>/searchAguments/?query/search', formatter: 'sap.ino.commons.formatters.BaseFormatter.URIdecoding'}",search:function(e){var i=e.getParameter("suggestionItem");if(i){e.getSource().setValue(i.getKey());}var d=i?i.getKey():null;s._onSearch(e,d);}}).addStyleClass('sapInoGlobalSearchInput');s.setAggregation('_SearchField',c,true);}return c;},_SearchCategory:function(){var s=this;var c=s.getAggregation('_CategoryDropDown');if(!c){c=new A({autoAdjustWidth:true,selectedKey:'{search>/selectedCategory}',change:function(e){s._selectCategory(e);}}).bindItems({path:'search>/category',template:new L({key:'{search>key}',tooltip:"{parts: [{path: 'search>value'}, {path: 'search>bNotFormatter'}], formatter: 'sap.ino.commons.formatters.BaseFormatter.formatGlobalSearchKey'}",text:"{parts: [{path: 'search>value'}, {path: 'search>bNotFormatter'}], formatter: 'sap.ino.commons.formatters.BaseFormatter.formatGlobalSearchKey'}"})}).addStyleClass('sapInoGlobalSearchDropDown');s.setAggregation('_CategoryDropDown',c,true);}return c;},renderer:function(r,c){r.write('<div');r.addClass('sapInoGlobalSearch');r.writeClasses();r.write('>');r.renderControl(c._SearchCategory());r.renderControl(c._SearchInput());r.write('</div>');}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.ColorPicker')){jQuery.sap.declare('sap.ino.controls.ColorPicker');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.ui.core.HTML');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Slider');sap.ui.define("sap/ino/controls/ColorPicker",["sap/ui/core/Control","sap/m/HBox","sap/m/VBox","sap/ui/core/HTML","sap/m/Input","sap/m/Label","sap/m/Slider"],function(C,H,V,a,I,L,S){"use strict";var b=C.extend("sap.ino.controls.ColorPicker",{metadata:{properties:{colorString:{type:"string",group:"Misc",defaultValue:null}},events:{change:{parameters:{r:{type:"int"},g:{type:"int"},b:{type:"int"},h:{type:"int"},s:{type:"int"},v:{type:"int"},hex:{type:"string"},alpha:{type:"string"}}},liveChange:{parameters:{r:{type:"int"},g:{type:"int"},b:{type:"int"},h:{type:"int"},s:{type:"int"},v:{type:"int"},hex:{type:"string"},alpha:{type:"string"}}}}},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.writeClasses();r.write(">");r.renderControl(c.oMatrix);r.write("</div>");}});b.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");this.Color={r:255,g:255,b:255,h:0,s:0,v:100,a:1,a_old:1,hex:"#FFFFFF",old:"#FFFFFF"};this.HexString="FFFFFF";this.rgbString="";this.$cpBox=null;this.$cpCur=null;this.RGB={r:0,g:0,b:0};this.bRtl=sap.ui.getCore().getConfiguration().getRTL();this.oMatrix=new V({width:"270px"});this.oMatrix.setParent(this);this.oMatrix.addStyleClass("sapInoColorPicker-ColorPickerMatrix");var c=this.getId()+'-cpBox';var d=this.getId()+'-cpCur';this.oHtmlBox=new a({content:"<DIV id="+c+" class=sapInoColorPicker-ColorPickerBox><DIV id="+d+" class=sapInoColorPicker-ColorPickerCircle></DIV></DIV>"});var o=this.getId()+'-ocBox';this.oHtmlOldCol=new a({content:"<DIV id="+o+" class=sapInoColorPicker-ColorPickerOldColor></DIV>"});var n=this.getId()+'-ncBox';this.oHtmlNewCol=new a({content:"<DIV id="+n+" class=sapInoColorPicker-ColorPickerNewColor></DIV>"});var i=this.getId()+'-hxF';var h=this.Color.hex.substr(1);this.oHexField=new I({id:i,value:h});this.oHexField.addStyleClass("sapInoColorPicker-ColorPickerHexField");this.oHexField.setTooltip(r.getText("COLORPICKER_HEX"));this.oHexLabel=new L();this.oHexLabel.addStyleClass("sapInoColorPicker-ColorPickerLabels");this.oHexLabel.setText("#:");this.oHexLabel.setTooltip(r.getText("COLORPICKER_HEX"));this.oHexLabel.setLabelFor(this.oHexField);i=this.getId()+'-rF';this.oRedField=new I({id:i,value:this.Color.r,width:"3.5em"});this.oRedField.addStyleClass("sapInoColorPicker-ColorPickerInputFieldsLeft");this.oRedField.setTooltip(r.getText("COLORPICKER_RED"));this.oRedLabel=new L();this.oRedLabel.addStyleClass("sapInoColorPicker-ColorPickerLabels");this.oRedLabel.setText("R:");this.oRedLabel.setTooltip(r.getText("COLORPICKER_RED"));this.oRedLabel.setLabelFor(this.oRedField);i=this.getId()+'-gF';this.oGreenField=new I({id:i,value:this.Color.g,width:"3.5em"});this.oGreenField.addStyleClass("sapInoColorPicker-ColorPickerInputFieldsLeft");this.oGreenField.setTooltip(r.getText("COLORPICKER_GREEN"));this.oGreenLabel=new L();this.oGreenLabel.addStyleClass("sapInoColorPicker-ColorPickerLabels");this.oGreenLabel.setText("G:");this.oGreenLabel.setTooltip(r.getText("COLORPICKER_GREEN"));this.oGreenLabel.setLabelFor(this.oGreenField);i=this.getId()+'-bF';this.oBlueField=new I({id:i,value:this.Color.b,width:"3.5em"});this.oBlueField.addStyleClass("sapInoColorPicker-ColorPickerInputFieldsLeft");this.oBlueField.setTooltip(r.getText("COLORPICKER_BLUE"));this.oBlueLabel=new L();this.oBlueLabel.addStyleClass("sapInoColorPicker-ColorPickerLabels");this.oBlueLabel.setText("B:");this.oBlueLabel.setTooltip(r.getText("COLORPICKER_BLUE"));this.oBlueLabel.setLabelFor(this.oBlueField);i=this.getId()+'-hF';this.oHueField=new I({id:i,value:this.Color.h,width:"3.5em"});this.oHueField.addStyleClass("sapInoColorPicker-ColorPickerInputFieldsRight");this.oHueField.setTooltip(r.getText("COLORPICKER_HUE"));this.oHueLabel=new L();this.oHueLabel.addStyleClass("sapInoColorPicker-ColorPickerLabels");this.oHueLabel.setText("H:");this.oHueLabel.setTooltip(r.getText("COLORPICKER_HUE"));this.oHueLabel.setLabelFor(this.oHueField);i=this.getId()+'-sF';this.oSatField=new I({id:i,value:this.Color.s,width:"3.5em"});this.oSatField.addStyleClass("sapInoColorPicker-ColorPickerInputFieldsRight");this.oSatField.setTooltip(r.getText("COLORPICKER_SAT"));this.oSatLabel=new L();this.oSatLabel.addStyleClass("sapInoColorPicker-ColorPickerLabels");this.oSatLabel.setText("S:");this.oSatLabel.setTooltip(r.getText("COLORPICKER_SAT"));this.oSatLabel.setLabelFor(this.oSatField);i=this.getId()+'-vF';this.oValField=new I({id:i,value:this.Color.v,width:"3.5em"});this.oValField.addStyleClass("sapInoColorPicker-ColorPickerInputFieldsRight");this.oValField.setTooltip(r.getText("COLORPICKER_VALUE"));this.oValLabel=new L();this.oValLabel.addStyleClass("sapInoColorPicker-ColorPickerLabels");this.oValLabel.setText("V:");this.oValLabel.setTooltip(r.getText("COLORPICKER_VALUE"));this.oValLabel.setLabelFor(this.oValField);i=this.getId()+'-hSLD';this.oSlider=new S({id:i});this.oSlider.setStep(1);this.oSlider.setMax(360);this.oSlider.setValue(parseInt(this.oHueField.getValue(),10),10);this.oSlider.setTooltip(r.getText("COLORPICKER_HUE"));this.oSlider.addStyleClass("sapInoColorPicker-ColorPickerSlider");i=this.getId()+'-aSLD';this.oAlphaSlider=new S({id:i});this.oAlphaSlider.setMax(1);this.oAlphaSlider.setValue(1);this.oAlphaSlider.setStep(0.01);this.oAlphaSlider.setTooltip(r.getText("COLORPICKER_ALPHA"));this.oAlphaSlider.addStyleClass("sapInoColorPicker-ColorPickerAlphaSlider");this.oHLayout1=new H({items:[this.oRedLabel,this.oRedField]});this.oHLayout2=new H({items:[this.oGreenLabel,this.oGreenField]});this.oHLayout3=new H({items:[this.oBlueLabel,this.oBlueField]});this.oHLayout4=new H({items:[this.oHexLabel,this.oHexField]});this.oHLayout5=new H({items:[this.oHueLabel,this.oHueField]});this.oHLayout6=new H({items:[this.oSatLabel,this.oSatField]});this.oHLayout7=new H({items:[this.oValLabel,this.oValField]});this.oHLayout8=new H({items:[this.oHtmlOldCol,this.oHtmlNewCol]});this.oVLayout1=new V({items:[this.oHLayout1,this.oHLayout2,this.oHLayout3,this.oHLayout4]});this.oVLayout2=new V({items:[this.oHLayout5,this.oHLayout6,this.oHLayout7,this.oHLayout8]});this.oVLayout2.addStyleClass("sapInoColorPicker-ColorPickerLastColumn");this.oMatrix.addItem(new H({items:[this.oHtmlBox,this.oVLayout1,this.oVLayout2]}));this.oMatrix.addItem(this.oSlider);this.oMatrix.addItem(this.oAlphaSlider);this.oHexField.attachChange(jQuery.proxy(this._handleHexValueChange,this));this.oRedField.attachChange(jQuery.proxy(this._handleRedValueChange,this));this.oGreenField.attachChange(jQuery.proxy(this._handleGreenValueChange,this));this.oBlueField.attachChange(jQuery.proxy(this._handleBlueValueChange,this));this.oHueField.attachChange(jQuery.proxy(this._handleHueValueChange,this));this.oSatField.attachChange(jQuery.proxy(this._handleSatValueChange,this));this.oValField.attachChange(jQuery.proxy(this._handleValValueChange,this));this.oSlider.attachLiveChange(jQuery.proxy(this._handleSliderLiveChange,this));this.oSlider.attachChange(jQuery.proxy(this._handleSliderChange,this));this.oAlphaSlider.attachLiveChange(jQuery.proxy(this._handleAlphaSliderLiveChange,this));this.oAlphaSlider.attachChange(jQuery.proxy(this._handleAlphaSliderChange,this));this.data("sap-ui-fastnavgroup","true",true);};b.prototype.exit=function(){if(this.$cpBox){this.$cpBox.unbind("mousedown",this.handleMouseDown);this.$cpBox.unbind("touchstart",this.handleTouchStart);}jQuery(document).unbind("mousemove",this.handleMousePos).unbind("mouseup",this.handleMouseUp);jQuery(document).unbind("touchmove",this.handleMousePos).unbind("touchend",this.handleMouseUp);this.oMatrix.destroy();};b.prototype.setColorString=function(c){this._parseColorString(c);this.oHexField.setValue(this.Color.hex.substr(1));this.oRedField.setValue(this.Color.r);this.oGreenField.setValue(this.Color.g);this.oBlueField.setValue(this.Color.b);this.oHueField.setValue(this.Color.h);this.oSatField.setValue(this.Color.s);this.oValField.setValue(this.Color.v);this.oSlider.setValue(this.Color.h);this.oAlphaSlider.setValue(this.Color.a);this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype.handleMouseDown=function(e){if(this.oHexField.getValueState()==sap.ui.core.ValueState.Error){return;}this.handleMousePos(e);jQuery(document).bind("mousemove",jQuery.proxy(this.handleMousePos,this)).bind("mouseup",jQuery.proxy(this.handleMouseUp,this));};b.prototype.handleTouchStart=function(e){if(this.oHexField.getValueState()==sap.ui.core.ValueState.Error){return;}this.handleMousePos(e);jQuery(document).bind("touchmove",jQuery.proxy(this.handleMousePos,this)).bind("touchend",jQuery.proxy(this.handleMouseUp,this));};b.prototype.handleMouseUp=function(e){if(this.oHexField.getValueState()==sap.ui.core.ValueState.Error){return;}this.handleMousePos(e);jQuery(document).unbind("mousemove",this.handleMousePos).unbind("mouseup",this.handleMouseUp);jQuery(document).unbind("touchmove",this.handleMousePos).unbind("touchend",this.handleMouseUp);if(!jQuery(e.target).hasClass("sapInoColorPicker-ColorPickerBox")){return;}this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype.handleMousePos=function(e){if(!jQuery(e.target).hasClass("sapInoColorPicker-ColorPickerBox")){return;}var p=e.pageX;var P=e.pageY;if(isNaN(p)||isNaN(P)||typeof p==="undefined"||typeof P==="undefined"){if(e.targetTouches&&e.targetTouches.length>0){p=e.targetTouches[0].pageX;P=e.targetTouches[0].pageY;}}if(isNaN(p)||isNaN(P)||typeof p==="undefined"||typeof P==="undefined"){return;}var c=this.$cpBox.offset();if(this.zoomContext&&!this.zoomCapable){var z=this.zoomContext.getZoom();c.left=c.left*100/z;c.top=c.top*100/z;}var d=this.$cpBox.width();var f=this.$cpBox.height();var x=p-c.left;var y=P-c.top;x=Math.min(Math.max(x,0),d);if(this.bRtl){var r=d-x;x=r;}y=Math.min(Math.max(y,0),f);var v=parseInt(x/d*100,10);var s=parseInt((1-y/f)*100,10);this.oSatField.setValue(s);this.oValField.setValue(v);this._processHSVchanges();this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._handleSliderLiveChange=function(){var s=parseInt(this.oSlider.getValue(),10);this.oHueField.setValue(s);this._processHSVchanges();this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._handleSliderChange=function(){var s=parseInt(this.oSlider.getValue(),10);this.oHueField.setValue(s);this._processHSVchanges();this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._handleAlphaSliderLiveChange=function(){this.Color.a=this.oAlphaSlider.getValue();this._processHSVchanges();this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._handleAlphaSliderChange=function(){this.Color.a=this.oAlphaSlider.getValue();this._processHSVchanges();this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._handleHueValueChange=function(){var h=parseInt(this.oHueField.getValue(),10);if(h<0||isNaN(h)){h=0;}if(h>360){h=359.9;}this.oHueField.setValue(h);this.oSlider.setValue(h);this._processHSVchanges();this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._handleSatValueChange=function(){var s=parseInt(this.oSatField.getValue(),10);if(s<0||isNaN(s)){s=0;}if(s>100){s=100;}this.oSatField.setValue(s);this._processHSVchanges();this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._handleValValueChange=function(){var v=parseInt(this.oValField.getValue(),10);if(v<0||isNaN(v)){v=0;}if(v>100){v=100;}this.oValField.setValue(v);this._processHSVchanges();this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._handleRedValueChange=function(){var r=parseInt(this.oRedField.getValue(),10);if(r<0||isNaN(r)){r=0;}if(r>255){r=255;}this.oRedField.setValue(r);this._processRGBchanges();this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._handleGreenValueChange=function(){var g=parseInt(this.oGreenField.getValue(),10);if(g<0||isNaN(g)){g=0;}if(g>255){g=255;}this.oGreenField.setValue(g);this._processRGBchanges();this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._handleBlueValueChange=function(){var c=parseInt(this.oBlueField.getValue(),10);if(c<0||isNaN(c)){c=0;}if(c>255){c=255;}this.oBlueField.setValue(c);this._processRGBchanges();this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._processHSVchanges=function(){var h=parseInt(this.oHueField.getValue(),10);var s=parseInt(this.oSatField.getValue(),10);var v=parseInt(this.oValField.getValue(),10);this._calculateRGB(h,s,v);this.Color.r=this.RGB.r;this.Color.g=this.RGB.g;this.Color.b=this.RGB.b;this.oRedField.setValue(this.Color.r);this.oGreenField.setValue(this.Color.g);this.oBlueField.setValue(this.Color.b);this._calculateHEX(this.Color.r,this.Color.g,this.Color.b);this.oHexField.setValue(this.HexString);this.Color.hex="#"+this.oHexField.getValue();this.Color.h=h;this.Color.s=s;this.Color.v=v;this.oHueField.setValue(this.Color.h);this.oSatField.setValue(this.Color.s);this.oValField.setValue(this.Color.v);this._updateGradientBoxBackground(this.Color.h);this._updateCursorPosition();this._updateSelColorBackground();};b.prototype._processRGBchanges=function(){var r=Math.round(parseInt(this.oRedField.getValue(),10));var g=Math.round(parseInt(this.oGreenField.getValue(),10));var c=Math.round(parseInt(this.oBlueField.getValue(),10));this._calculateHEX(r,g,c);this.oHexField.setValue(this.HexString);this._calculateHSV(r,g,c);this.oHueField.setValue(this.Color.h);this.oSatField.setValue(this.Color.s);this.oValField.setValue(this.Color.v);this.oSlider.setValue(parseInt(this.oHueField.getValue(),10));this.Color.r=r;this.Color.g=g;this.Color.b=c;this.Color.hex="#"+this.oHexField.getValue();this._updateGradientBoxBackground(this.Color.h);this._updateCursorPosition();this._updateSelColorBackground();};b.prototype._handleHexValueChange=function(){var h=this.oHexField.getValue().toUpperCase();if(h.substr(0,1)==='#'){h=h.substr(1);}var r=/^([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/;if(r.test(h)===false){this.oHexField.setValueState(sap.ui.core.ValueState.Error);this.oSlider.setEnabled(false);this.oAlphaSlider.setEnabled(false);this.oHueField.setEnabled(false);this.oRedField.setEnabled(false);this.oGreenField.setEnabled(false);this.oBlueField.setEnabled(false);this.oSatField.setEnabled(false);this.oValField.setEnabled(false);return false;}else if(this.oHexField.getValueState()==sap.ui.core.ValueState.Error){this.oHexField.setValueState(sap.ui.core.ValueState.None);this.oSlider.setEnabled(true);this.oAlphaSlider.setEnabled(true);this.oHueField.setEnabled(true);this.oRedField.setEnabled(true);this.oGreenField.setEnabled(true);this.oBlueField.setEnabled(true);this.oSatField.setEnabled(true);this.oValField.setEnabled(true);}if(h.length===3){var t=h.charAt(0)+h.charAt(0)+h.charAt(1)+h.charAt(1)+h.charAt(2)+h.charAt(2);h=t;}this._processHexChanges(h);this.oHexField.setValue(h);this.oRedField.setValue(this.Color.r);this.oGreenField.setValue(this.Color.g);this.oBlueField.setValue(this.Color.b);this.oHueField.setValue(this.Color.h);this.oSatField.setValue(this.Color.s);this.oValField.setValue(this.Color.v);this.oSlider.setValue(parseInt(this.oHueField.getValue(),10));this.oAlphaSlider.setValue(1);this._updateGradientBoxBackground(this.Color.h);this._updateCursorPosition();this._updateSelColorBackground();this.fireLiveChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.fireChange({r:this.Color.r,g:this.Color.g,b:this.Color.b,h:this.Color.h,s:this.Color.s,v:this.Color.v,alpha:this.Color.a,hex:this.Color.hex});this.setProperty('colorString',this._getRGBString(),true);};b.prototype._processHexChanges=function(i){this._convertRGB(i);this._calculateHSV(this.Color.r,this.Color.g,this.Color.b);this.Color.hex="#"+i.toUpperCase();};b.prototype._updateCursorPosition=function(){var c=this.$cpCur.width();var d=this.$cpCur.height();var e=this.$cpBox.width();var f=this.$cpBox.height();var s=this.oSatField.getValue();var v=this.oValField.getValue();var x=parseInt(v*e/100,10);if(this.bRtl){var r=e-x;x=r;}var y=parseInt((1-s/100)*f,10);x=Math.min(Math.max(x,0),e-c/2)-c/2;y=Math.min(Math.max(y,0),f-d/2)-d/2;this.$cpCur.css("left",x).css("top",y);};b.prototype._calculateRGB=function(h,s,v){if(h==360){h=0;}h/=60;s/=100;v/=100;var c=v*s;var x=c*(1-Math.abs(h%2-1));var m=v-c;var r=0,g=0,d=0;var i=Math.floor(h);switch(i){case 0:r=c;g=x;break;case 1:r=x;g=c;break;case 2:g=c;d=x;break;case 3:g=x;d=c;break;case 4:r=x;d=c;break;case 5:r=c;d=x;break;default:break;}this.RGB.r=Math.floor((r+m)*255);this.RGB.g=Math.floor((g+m)*255);this.RGB.b=Math.floor((d+m)*255);};b.prototype._getRGBString=function(){if(this.Color.a<1){return"rgba("+this.Color.r+","+this.Color.g+","+this.Color.b+", "+this.Color.a+")";}else{return"rgb("+this.Color.r+","+this.Color.g+","+this.Color.b+")";}};b.prototype._calculateHEX=function(r,g,c){var d=r.toString(16);var e=g.toString(16);var f=c.toString(16);if(d.length==1){d='0'+d;}if(e.length==1){e='0'+e;}if(f.length==1){f='0'+f;}this.HexString=(d+e+f).toUpperCase();};b.prototype._calculateHSV=function(r,g,c){var m=Math.max(Math.max(r,g),c);var d=Math.min(Math.min(r,g),c);var e=(m-d);var v=Math.round(m*100/255);var s=(m===0.0)?0:(100*e/m);var h=0;if(s===0){h=0;}else if(r===m){h=60.0*(g-c)/e;}else if(g===m){h=120.0+60.0*(c-r)/e;}else if(c===m){h=240.0+60.0*(r-g)/e;}if(h<0.0){h+=359.9;}h=Math.round(h);s=Math.round(s);this.Color.h=h;this.Color.s=s;this.Color.v=v;};b.prototype._convertRGB=function(h){var r=parseInt(h.substr(0,2),16);var g=parseInt(h.substr(2,2),16);var c=parseInt(h.substr(4,2),16);this.Color.r=r;this.Color.g=g;this.Color.b=c;};b.prototype._updateGradientBoxBackground=function(h){this._calculateRGB(h,100,100);this._calculateHEX(this.RGB.r,this.RGB.g,this.RGB.b);this.$cpBox.css('background-color','rgb('+this.RGB.r+', '+this.RGB.g+', '+this.RGB.b+')');};b.prototype._updateSelColorBackground=function(){this.$("ncBox").css('background-color',this._getRGBString());};b.prototype._parseColorString=function(c){if(!c){return;}if(c.substr(0,1)==='#'){c=c.substr(1);}c=c.replace(/ /g,'');c=c.toLowerCase();var s;var h;var d={aliceblue:'f0f8ff',antiquewhite:'faebd7',aqua:'00ffff',aquamarine:'7fffd4',azure:'f0ffff',beige:'f5f5dc',bisque:'ffe4c4',black:'000000',blanchedalmond:'ffebcd',blue:'0000ff',blueviolet:'8a2be2',brown:'a52a2a',burlywood:'deb887',cadetblue:'5f9ea0',chartreuse:'7fff00',chocolate:'d2691e',coral:'ff7f50',cornflowerblue:'6495ed',cornsilk:'fff8dc',crimson:'dc143c',cyan:'00ffff',darkblue:'00008b',darkcyan:'008b8b',darkgoldenrod:'b8860b',darkgray:'a9a9a9',darkgreen:'006400',darkkhaki:'bdb76b',darkmagenta:'8b008b',darkolivegreen:'556b2f',darkorange:'ff8c00',darkorchid:'9932cc',darkred:'8b0000',darksalmon:'e9967a',darkseagreen:'8fbc8f',darkslateblue:'483d8b',darkslategray:'2f4f4f',darkturquoise:'00ced1',darkviolet:'9400d3',deeppink:'ff1493',deepskyblue:'00bfff',dimgray:'696969',dodgerblue:'1e90ff',feldspar:'d19275',firebrick:'b22222',floralwhite:'fffaf0',forestgreen:'228b22',fuchsia:'ff00ff',gainsboro:'dcdcdc',ghostwhite:'f8f8ff',gold:'ffd700',goldenrod:'daa520',gray:'808080',green:'008000',greenyellow:'adff2f',honeydew:'f0fff0',hotpink:'ff69b4',indianred:'cd5c5c',indigo:'4b0082',ivory:'fffff0',khaki:'f0e68c',lavender:'e6e6fa',lavenderblush:'fff0f5',lawngreen:'7cfc00',lemonchiffon:'fffacd',lightblue:'add8e6',lightcoral:'f08080',lightcyan:'e0ffff',lightgoldenrodyellow:'fafad2',lightgrey:'d3d3d3',lightgreen:'90ee90',lightpink:'ffb6c1',lightsalmon:'ffa07a',lightseagreen:'20b2aa',lightskyblue:'87cefa',lightslateblue:'8470ff',lightslategray:'778899',lightsteelblue:'b0c4de',lightyellow:'ffffe0',lime:'00ff00',limegreen:'32cd32',linen:'faf0e6',magenta:'ff00ff',maroon:'800000',mediumaquamarine:'66cdaa',mediumblue:'0000cd',mediumorchid:'ba55d3',mediumpurple:'9370d8',mediumseagreen:'3cb371',mediumslateblue:'7b68ee',mediumspringgreen:'00fa9a',mediumturquoise:'48d1cc',mediumvioletred:'c71585',midnightblue:'191970',mintcream:'f5fffa',mistyrose:'ffe4e1',moccasin:'ffe4b5',navajowhite:'ffdead',navy:'000080',oldlace:'fdf5e6',olive:'808000',olivedrab:'6b8e23',orange:'ffa500',orangered:'ff4500',orchid:'da70d6',palegoldenrod:'eee8aa',palegreen:'98fb98',paleturquoise:'afeeee',palevioletred:'d87093',papayawhip:'ffefd5',peachpuff:'ffdab9',peru:'cd853f',pink:'ffc0cb',plum:'dda0dd',powderblue:'b0e0e6',purple:'800080',red:'ff0000',rosybrown:'bc8f8f',royalblue:'4169e1',saddlebrown:'8b4513',salmon:'fa8072',sandybrown:'f4a460',seagreen:'2e8b57',seashell:'fff5ee',sienna:'a0522d',silver:'c0c0c0',skyblue:'87ceeb',slateblue:'6a5acd',slategray:'708090',snow:'fffafa',springgreen:'00ff7f',steelblue:'4682b4',tan:'d2b48c',teal:'008080',thistle:'d8bfd8',tomato:'ff6347',turquoise:'40e0d0',violet:'ee82ee',violetred:'d02090',wheat:'f5deb3',white:'ffffff',whitesmoke:'f5f5f5',yellow:'ffff00',yellowgreen:'9acd32'};var r,R;for(s in d){if(c===s){h=d[s].toUpperCase();}}if(h){this._processHexChanges(h);this.Color.old=this.Color.hex;}r=/^([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/;if(r.test(c)===true){if(c.length===3){h=c.charAt(0)+c.charAt(0)+c.charAt(1)+c.charAt(1)+c.charAt(2)+c.charAt(2);}else{h=c;}this._processHexChanges(h);this.Color.old=this.Color.hex;}if(c.substr(0,4)==='rgba'){c=c.substr(4);c=c.replace("(",'');c=c.replace(")",'');c=c.split(' ').join('');r=/^(((\d{1,2})|(1\d{2})|(2[0-4]\d)|(25[0-5])),){2}(((\d{1,2})|(1\d{2})|(2[0-4]\d)|(25[0-5])),){1}(([0]\.[0-9]*)|(\.[0-9]{2})|[1]){1}$/;if(r.test(c)===true){R=c.split(",");var A=c.substr(c.lastIndexOf(",")+1,(c.length-c.lastIndexOf(",")));this._calculateHEX(parseInt(R[0],10),parseInt(R[1],10),parseInt(R[2],10));this._processHexChanges(this.HexString);this.Color.old=this.Color.hex;this.Color.a=this.Color.a_old=parseFloat(A);}}if(c.substr(0,3)==='rgb'){c=c.substr(3);c=c.replace("(",'');c=c.replace(")",'');c=c.split(' ').join('');r=/^(((\d{1,2})|(1\d{2})|(2[0-4]\d)|(25[0-5])),){2}(((\d{1,2})|(1\d{2})|(2[0-4]\d)|(25[0-5]))){1}$/;if(r.test(c)===true){R=c.split(",");this._calculateHEX(parseInt(R[0],10),parseInt(R[1],10),parseInt(R[2],10));this._processHexChanges(this.HexString);this.Color.old=this.Color.hex;}}if(c.substr(0,3)==='hsv'){c=c.substr(3);c=c.replace("(",'');c=c.replace(")",'');c=c.split(' ').join('');r=/^(((\d{1,2})|([1,2]\d{2})|(3[0-5]\d)|(360)),){1}(((\d{1,2})|(100)),){1}((\d{1,2})|(100)){1}$/;if(r.test(c)===true){var e=c.split(",");this._calculateRGB(parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10));this._calculateHEX(this.RGB.r,this.RGB.g,this.RGB.b);this.Color.r=this.RGB.r;this.Color.g=this.RGB.g;this.Color.b=this.RGB.b;this.Color.h=parseInt(e[0],10);this.Color.s=parseInt(e[1],10);this.Color.v=parseInt(e[2],10);this.Color.hex="#"+this.HexString;this.Color.old=this.Color.hex;}}else{return false;}};b.prototype.onAfterRendering=function(){this.$cpBox=this.$("cpBox");this.$cpCur=this.$("cpCur");this.$cpBox.bind("mousedown",jQuery.proxy(this.handleMouseDown,this));this.$cpBox.bind("touchstart",jQuery.proxy(this.handleTouchStart,this));this.$("ncBox").css('background-color',this._getRGBString());this.$("ocBox").css('background-color',this._getRGBString());this._updateGradientBoxBackground(this.Color.h);this._updateCursorPosition();};b.prototype.onBeforeRendering=function(){this.$("cpBox").unbind("mousedown",this.handleMouseDown);this.$("cpBox").unbind("touchstart",this.handleTouchStart);};b.prototype.getRGB=function(){return{r:this.Color.r,g:this.Color.g,b:this.Color.b};};return b;});};if(!jQuery.sap.isDeclared('sap.ino.controls.ColorPickerLite')){jQuery.sap.declare('sap.ino.controls.ColorPickerLite');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.ToggleButton');jQuery.sap.require('sap.m.Input');sap.ui.define("sap/ino/controls/ColorPickerLite",["sap/ui/core/Control","sap/m/ToggleButton","sap/m/Input"],function(C,T,I){"use strict";var a=C.extend("sap.ino.controls.ColorPickerLite",{metadata:{properties:{color:{type:"string",defaultValue:"FFFFFF"},valueStateText:{type:"string",defaultValue:null},showValueStateMessage:{type:"boolean",defaultValue:true},defaultColors:{type:"string[]",defaultValue:["#ffffff","f0ab00","f27020","e52929","ab218e","009de0","007cc0","004990","73bf93","008a3b","#bfbfbf","#777777"]},preview:{type:"boolean",defaultValue:true},showHex:{type:"boolean",defaultValue:true}},aggregations:{"_colorButtons":{type:"sap.m.ToggleButton",multiple:true,visibility:"hidden"},"_input":{type:"sap.m.Input",multiple:false,visibility:"hidden"}},events:{change:{}}},_getButtons:function(){var b=this.getAggregation("_colorButtons");if(!b||b.length===0){var t=this;b=[];for(var i=0;i<this.getDefaultColors().length;i++){var B=new T({customData:{Type:"sap.ui.core.CustomData",key:"button-color",value:t._cleanColor(this.getDefaultColors()[i].trim())},press:function(e){t._onPress(e.getSource().data("button-color"));}});B.addStyleClass("sapInoColorPickerColorButton");this.addAggregation("_colorButtons",B);}b=this.getAggregation("_colorButtons");}return b;},_getInput:function(){var i=this.getAggregation("_input");if(!i){var t=this;i=new I({valueStateText:this.getValueStateText(),maxLength:7,showValueStateMessage:this.getShowValueStateMessage(),liveChange:function(e){t._setCurrentColor(e.getParameter("newValue"),false,false);},change:function(e){var v=e.getParameter("newValue");t._setCurrentColor(v,false,true);v=t._cleanColor(v);t.fireChange({value:v,hashValue:"#"+v});}});this.setAggregation("_input",i,true);}return i;},_setCurrentColor:function(v,u,s){if(this._validateLiveInput(v)){if(/(^[0-9A-F]{6}$)|(^[0-9A-F]{3}$)/i.test(v)){this._setColor(v,u,s);}else if(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(v)){this._setColor(v.substr(1),u,s);}else if(s){this._getInput.setValueState("Error");}}},_setColor:function(v,u,s){jQuery(".sapInoColorPickerLitePreview").css("background","#"+v);if(u){this._getInput().setValue("#"+v);}if(s){this.setProperty("color",v,true);}},_validateLiveInput:function(v){if(/(^[0-9A-F]{0,6}$)/i.test(v)){this._getInput().setValueState("None");return true;}if(/(^#[0-9A-F]{0,7}$)/i.test(v)){this._getInput().setValueState("None");return true;}this._getInput().setValueState("Error");return false;},_onPress:function(c){var b=this.getAggregation("_colorButtons");b.forEach(function(B){B.setPressed(B.data("button-color")===c);});this._setCurrentColor(c,true,true);c=this._cleanColor(c);this.fireChange({value:c,hashValue:"#"+c});},_cleanColor:function(c){if(c&&c.substr(0,1)==='#'){c=c.substr(1);}return c.toUpperCase();},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapInoColorPickerLite");r.writeClasses("");r.write(">");r.write("<div");r.addClass("sapInoColorPickerLiteButtonContainer");r.writeClasses("");r.write(">");c._getButtons().forEach(function(b){r.renderControl(b);});r.write("</div>");if(c.getShowHex()){r.write("<div");r.addClass("sapInoColorPickerLitePreviewInput");r.writeClasses("");r.write(">");if(c.getPreview()){r.write("<div");r.addClass("sapInoColorPickerLitePreview");r.writeClasses("");r.write(">");r.write("</div>");}r.renderControl(c._getInput());r.write("</div>");}r.write("</div>");}});a.prototype.onAfterRendering=function(){var c=this._cleanColor(this.getColor());this._setCurrentColor(c,true,true);var b=this.getAggregation("_colorButtons");for(var i=0;i<b.length;i++){jQuery(b[i].getDomRef().children[0]).css("background","#"+b[i].data("button-color"));jQuery(b[i].getDomRef().children[0]).attr("aria-label","#"+b[i].data("button-color"));jQuery(b[i].getDomRef().children[0]).attr("title","#"+b[i].data("button-color"));b[i].setPressed(b[i].data("button-color")===c);}};return a;});};if(!jQuery.sap.isDeclared('sap.ino.controls.ColorRibbon')){jQuery.sap.declare('sap.ino.controls.ColorRibbon');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.layout.HorizontalLayout');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/ColorRibbon",["sap/ui/core/Control","sap/ui/layout/HorizontalLayout","sap/ui/core/Icon","sap/base/security/sanitizeHTML"],function(C,H,I,s){"use strict";var a=C.extend("sap.ino.controls.ColorRibbon",{metadata:{properties:{color:{type:"string"}}},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.writeClasses();var b=s(c.getColor());if(b&&b.length===6){b="#"+b;}else{b="#FFFFFF";}r.addStyle("background-color",b);r.writeStyles();r.write("></div>");}});return a;});};if(!jQuery.sap.isDeclared('sap.ino.controls.EvalRequestFeedListItem')){jQuery.sap.declare('sap.ino.controls.EvalRequestFeedListItem');jQuery.sap.require('sap.m.FeedListItem');sap.ui.define("sap/ino/controls/EvalRequestFeedListItem",["sap/m/FeedListItem"],function(F){"use strict";var E=F.extend("sap.ino.controls.EvalRequestFeedListItem",{metadata:{properties:{"prefixSender":{type:"string",group:'Data',defaultValue:null},"prefixToSender":{type:"string",group:'Data',defaultValue:null},"toSender":{type:"string",group:'Data',defaultValue:null}},events:{toSenderPress:{parameters:{domRef:{type:'string'},getDomRef:{type:'function'}}}}}});E.prototype._getLinkToSender=function(){if(!this._oLinkToControl){jQuery.sap.require('sap.m.Link');var t=this;this._oLinkToControl=new sap.m.Link({press:function(){t.fireToSenderPress({domRef:this.getDomRef(),getDomRef:this.getDomRef.bind(this)});}});this._oLinkToControl.setParent(this,null,true);}this._oLinkToControl.setProperty('text',this.getToSender(),true);this._oLinkToControl.setProperty('enabled',this.getSenderActive(),true);return this._oLinkToControl;};return E;});};if(!jQuery.sap.isDeclared('sap.ino.controls.EvalRequestFeedListItemRenderer')){jQuery.sap.declare('sap.ino.controls.EvalRequestFeedListItemRenderer');jQuery.sap.require('sap.m.FeedListItemRenderer');jQuery.sap.require('sap.ui.core.Renderer');sap.ui.define("sap/ino/controls/EvalRequestFeedListItemRenderer",["sap/m/FeedListItemRenderer",'sap/ui/core/Renderer'],function(F,R){'use strict';var E=R.extend(F);E._writeToPrefixSender=function(r,f,m){r.write('<span class="sapMFeedListItemTextPrefixName" id="'+m+'-prefixtosender">');r.writeEscaped(f.getPrefixToSender());r.write('</span>');r.write(' ');};E._writePrefixSender=function(r,f,m){r.write('<span class="sapMFeedListItemTextPrefixName" id="'+m+'-prefixsender">');r.writeEscaped(f.getPrefixSender());r.write('</span>');r.write(' ');};E._writeSender=function(r,f,m){r.write('<p id="'+m+'-fullsender" class="sapMFeedListItemTextText"');r.writeAttribute("aria-hidden",true);r.write('>');if(f.getPrefixToSender()){this._writeToPrefixSender(r,f,m);}if(f.getToSender()){r.write('<span id="'+m+'-toname" class="sapMFeedListItemTextName">');r.renderControl(f._getLinkToSender());r.write(' ');r.write('</span>');}if(f.getPrefixSender()){this._writePrefixSender(r,f,m);}if(f.getSender()){r.write('<span id="'+m+'-name" class="sapMFeedListItemTextName">');r.renderControl(f._getLinkSender(false));r.write(' ');r.write('</span>');}r.write('</p>');};E._writeMainText=function(r,f,m){r.write('<p id="'+m+'-text" class="sapMFeedListItemTextText"');r.writeAttribute("aria-hidden",true);r.write('>');r.write('<span id="'+m+'-realtext" class="sapMFeedListItemTextString">');if(f._checkTextIsExpandable()){this._writeCollapsedText(r,f,m);}else{r.writeEscaped(f.getText(),true);r.write('</span>');}r.write('</p>');};E._writeDate=function(r,f,m){if(f.getInfo()||!!f.getTimestamp()){r.write('<p class="sapMFeedListItemFooter sapUiSmallMarginBottom">');if(!sap.ui.getCore().getConfiguration().getRTL()){if(f.getInfo()){this._writeInfo(r,f,m);if(f.getTimestamp()){r.write("<span>&#160&#160&#x00B7&#160&#160</span>");}}if(f.getTimestamp()){this._writeTimestamp(r,f,m);}}else{if(f.getTimestamp()){this._writeTimestamp(r,f,m);}if(f.getInfo()){if(f.getTimestamp()){r.write("<span>&#160&#160&#x00B7&#160&#160</span>");}this._writeInfo(r,f,m);}}r.write('</p>');}};E._RenderPhone=function(r,f,m){r.write('<div class= "sapMFeedListItemHeader ');if(f.getShowIcon()){r.write('sapMFeedListItemHasFigure ');}if(!!f.getSender()&&!!f.getTimestamp()){r.write('sapMFeedListItemFullHeight');}r.write('" >');r.write('<p id="'+m+'-fullsender" class="sapMFeedListItemTextText"');if(f.getPrefixToSender()){this._writeToPrefixSender(r,f,m);}if(f.getToSender()){r.write('<span id="'+m+'-toname" class="sapMFeedListItemTextName">');r.renderControl(f._getLinkToSender());r.write(' ');r.write('</span>');}if(f.getPrefixSender()){this._writePrefixSender(r,f,m);}if(f.getSender()){r.write('<span id="'+m+'-name" class="sapMFeedListItemTextName">');r.renderControl(f._getLinkSender(false));r.write('</span>');}r.write('</p>');if(f.getTimestamp()){r.write('<p class="sapMFeedListItemTimestamp">');r.writeEscaped(f.getTimestamp());r.write('</p>');}r.write('</div>');r.write('<p class="sapMFeedListItemText">');r.write('<span id="'+m+'-realtext" class="sapMFeedListItemText">');if(f._checkTextIsExpandable()){this._writeCollapsedText(r,f,m);}else{r.writeEscaped(f.getText(),true);r.write('</span>');}r.write('</p>');if(f.getInfo()){r.write('<p class="sapMFeedListItemFooter">');if(f.getInfo()){r.write('<span id="'+m+'-info" class="sapMFeedListItemInfo">');r.writeEscaped(f.getInfo());r.write('</span>');}r.write('</p>');}};E._RenderDesktop=function(r,f,m){r.write('<div class= "sapMFeedListItemText ');if(f.getShowIcon()){r.write('sapMFeedListItemHasFigure');}r.write('" >');this._writeSender(r,f,m);this._writeDate(r,f,m);this._writeMainText(r,f,m);r.write('</div>');};E.renderLIContent=function(r,f){var m=f.getId(),i=sap.ui.Device.system.phone;r.write('<div');r.addClass('sapMFeedListItem');r.writeClasses();r.write('>');if(f.getShowIcon()){this._writeImageControl(r,f,m);}if(i){this._RenderPhone(r,f,m);}else{this._RenderDesktop(r,f,m);}r.write('</div>');};return E;},true);};if(!jQuery.sap.isDeclared('sap.ino.controls.EvaluationData')){jQuery.sap.declare('sap.ino.controls.EvaluationData');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ino/controls/EvaluationData",["sap/ui/core/Element"],function(E){"use strict";return E.extend("sap.ino.controls.EvaluationData",{metadata:{properties:{evaluationId:{type:"int"},modelCode:{type:"string"},modelName:{type:"string"},modelDescription:{type:"string"},ideaId:{type:"int"},statusCode:{type:"string"},status:{type:"string"},ideaPhaseCode:{type:"string"},ideaPhase:{type:"string"},evaluatorId:{type:"int"},evaluatorName:{type:"string"},evaluationDate:{type:"string"},overallResult:{type:"string"}},aggregations:{"values":{type:"sap.ino.controls.EvaluationDataCriterionValue",multiple:true,singularName:"value",bindable:true}}},findTopLevelCriterionValue:function(I){var v=this.getValues();var r=[];for(var i=0;i<v.length;i++){if(!v[i].getParentCriterionCode()&&(this.criterionHasChildren(v[i].getCriterionCode())||!v[i].getAggregationType()||(I||!v[i].getIsOverallResult()))){r.push(v[i]);}}return r.sort(function(c,C){return c.getSequenceNo()-C.getSequenceNo();});},criterionHasChildren:function(c){if(c){var v=this.getValues();for(var i=0;i<v.length;i++){if(v[i].getParentCriterionCode()===c){return true;}}}return false;},findValuesByParentCriterionCode:function(p){if(p){var v=this.getValues();var r=[];for(var i=0;i<v.length;i++){if(v[i].getParentCriterionCode()===p){r.push(v[i]);}}return r.sort(function(c,C){return c.getSequenceNo()-C.getSequenceNo();});}return[];},findValueByAggregationTypeMatrix:function(){var v=this.getValues();for(var i=0;i<v.length;i++){if(v[i].getAggregationType()==="MATRIX"){return v[i];}}return null;},findValueByCriterionCode:function(c){if(c){var v=this.getValues();for(var i=0;i<v.length;i++){if(v[i].getCriterionCode()===c){return v[i];}}}return null;},findOverallCriterionCode:function(){var v=this.getValues();for(var i=0;i<v.length;i++){if(v[i].getIsOverallResult()===1){return v[i];}}return null;}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.EvaluationDataCriterionValue')){jQuery.sap.declare('sap.ino.controls.EvaluationDataCriterionValue');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ino/controls/EvaluationDataCriterionValue",["sap/ui/core/Element"],function(E){"use strict";return E.extend("sap.ino.controls.EvaluationDataCriterionValue",{metadata:{properties:{criterionId:{type:"int"},criterionCode:{type:"string"},parentCriterionCode:{type:"string"},parentCriterionId:{type:"int"},criterionName:{type:"string"},criterionDescription:{type:"string"},criterionDataType:{type:"string"},criterionLabel:{type:"string"},numValueMin:{type:"float"},numValueMax:{type:"float"},numValueStepSize:{type:"float"},comment:{type:"string"},isDone:{type:"int"},sequenceNo:{type:"int"},isOverallResult:{type:"int"},uomCode:{type:"string"},valueOptionListLabelCodes:{type:"object"},aggregationType:{type:"string"},weight:{type:"string"},xAxisCriterionCode:{type:"string"},xAxisCriterionCodeLabel:{type:"string"},xAxisSegmentNo:{type:"int"},yAxisCriterionCode:{type:"string"},yAxisCriterionCodeLabel:{type:"string"},yAxisSegmentNo:{type:"int"},visParam1CriterionCode:{type:"string"},visParam1CriterionCodeLabel:{type:"string"},visParam2CriterionCode:{type:"string"},visParam2CriterionCodeLabel:{type:"string"},criterionValue:{type:"string"}}},getValueMin:function(){switch(this.getCriterionDataType()){case'INTEGER':case'NUMERIC':return this.getNumValueMin();default:return null;}},getValueMax:function(){switch(this.getCriterionDataType()){case'INTEGER':case'NUMERIC':return this.getNumValueMax();default:return null;}},getStepSize:function(){switch(this.getCriterionDataType()){case'INTEGER':case'NUMERIC':return this.getNumValueStepSize();default:return null;}},getMaxLength:function(){switch(this.getCriterionDataType()){case'INTEGER':case'NUMERIC':var n=this.getNumValueMax();if(n){var m=n.toString();return m.length;}return 16;case'BOOLEAN':return 1;default:return 5000;}}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.EvaluationMatrixItem')){jQuery.sap.declare('sap.ino.controls.EvaluationMatrixItem');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ino/controls/EvaluationMatrixItem",["sap/ui/core/Element"],function(E){"use strict";return E.extend("sap.ino.controls.EvaluationMatrixItem",{metadata:{properties:{name:{type:"string",defaultValue:"item"},dataType:"string",xValue:{type:"float",defaultValue:0},xValueDataType:"string",yValue:{type:"float",defaultValue:0},yValueDataType:"string",r1Value:{type:"float",defaultValue:0},r1ValueDataType:"string",r2Value:{type:"float",defaultValue:0},r2ValueDataType:"string"}}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.ExpertGraph')){jQuery.sap.declare('sap.ino.controls.ExpertGraph');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/ino/controls/ExpertGraph",["sap/ui/core/Control","sap/ui/thirdparty/d3"],function(C,a){"use strict";return C.extend("sap.ino.controls.ExpertGraph",{metadata:{properties:{experts:{type:"object",defaultValue:{}}},events:{"mouseOverNode":{},"mouseOutNode":{},"clickNode":{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},renderer:function(r,c){r.write("<div ");r.writeControlData(c);r.addClass("sapInoExpertGraphContainer");r.writeClasses();r.write("></div>");},onAfterRendering:function(){var i;var z=a.behavior.zoom().scaleExtent([0.1,10]).on("zoom",Z);var $=a.select("#"+this.getId());var b=$[0][0].scrollWidth;var c=$[0][0].scrollHeight;var s=1;var f=$.append("svg").call(z).attr("transform","translate(0,0)");var r=7;var g=a.layout.force().gravity(0.1).distance(100).charge(-500).size([b,c]);a.behavior.drag().origin(function(d){return d;}).on("dragstart",D).on("drag",k).on("dragend",m);var j=f.append("g");function D(d){a.event.sourceEvent.stopPropagation();a.select(this).classed("dragging",true);g.start();}function k(d){a.select(this).attr("cx",d.x=a.event.x).attr("cy",d.y=a.event.y);}function m(d){a.select(this).classed("dragging",false);}f.on("dblclick.zoom",null);f.on("dblclick",function(){s=1;z.scale(1);z.translate([0,0]);j.transition().duration(500).attr('transform','');g.resume();});function Z(){s=a.event.scale;if(s>1){j.attr("transform","translate("+a.event.translate+")scale("+a.event.scale+")");}else{j.attr("transform","scale("+a.event.scale+")");}g.resume();}function n(d){var G={nodes:[],links:[]};function h(F,H){var I=jQuery.grep(G.links,function(e){return e.source===F&&e.target===H;});if(I.length===0){G.links.push({source:F,target:H});return G.links[G.links.length-1];}return I[0];}function l(F,H){var I=jQuery.grep(G.nodes,function(e){return e.tag_id===F;});if(I.length===0){var N={NAME:H,tag_id:F,group:0};G.nodes.push(N);return G.nodes[G.nodes.length-1];}return I[0];}function w(e){var N=jQuery.grep(G.nodes,function(H){return H.PERSON_ID===e.ID;});if(N.length===0){var F={NAME:e.NAME,PERSON_ID:e.ID,EMAIL:e.EMAIL,PHONE:e.PHONE,MOBILE:e.MOBILE,OFFICE:e.OFFICE,group:1,x:150,y:150,RANK:e.RANK,CORRELATION:e.CORRELATION};G.nodes.push(F);return F;}else{return N[0];}}jQuery.each(d,function(e,F){var H=w(F);jQuery.each(F.CORRELATION,function(I,J){jQuery.each(J.TAGS,function(K,L){var M=l(L.ID,L.NAME);var p=h(H,M);});});});return G;}var o=n(this.getExperts());if(o.nodes.length===0){f.append("text").text(this._oRB.getText("CTRL_EXPERTFINDER_EMPTY_SCREEN")).classed("sapInoExpertGraphEmptyScreenText",true);var x=($[0][0].scrollWidth-f.select("text")[0][0].getBBox().width)/3;var y=($[0][0].scrollHeight-f.select("text")[0][0].getBBox().height)/2;f.select("text").attr("x",x).attr("y",y);}else{g.nodes(o.nodes).links(o.links).start();}var p=j.selectAll(".sapInoExpertLink").data(o.links).enter().append("line").classed("sapInoExpertLink",true);var q=j.selectAll(".sapInoExpertNode").data(o.nodes).enter().append("g").attr("class","sapInoExpertNode").call(g.drag);var t=this;var S=[];var u=[];q.append("circle").attr("r",function(d){if(d.group===0){return 12;}else{if(r+(5/d.RANK)<8){return 8;}else{return r+(5/d.RANK);}}}).style("cursor",function(d){return d.group!==0?"pointer":"auto";}).on("click",function(d,i){if(d.group!==0){if(S.length>0||u.length>0){for(i=0;i<S.length;i++){a.select(S[i]).classed("sapInoExpertGraphSelectedPerson",false).classed("sapInoExpertGraphSelectedTag",false).classed("sapInoExpertGraphSelectText",false).classed("sapInoExpertGraphHighlightLine",false).classed("sapInoExpertGraphSelectedPerson",false);}S=[];for(i=0;i<u.length;i++){a.select(u[i]).classed("sapInoExpertGraphSelectLine",false).classed("sapInoExpertLink",true);}u=[];}var e=[];var h=p.filter(function(l){if(l.source.index===d.index||l.target.index===d.index){e.push(l.source.index);e.push(l.target.index);return true;}else{return false;}});var w=q.filter(function(l){return(e.indexOf(l.index)>=0);});h.each(function(){u.push(this);a.select(this).classed("sapInoExpertLink",false).classed("sapInoExpertGraphHighlightLine",false).classed("sapInoExpertGraphSelectLine",true);});w.each(function(N){S.push(this.childNodes[0]);S.push(this.childNodes[1]);a.select(this.childNodes[1]).classed("sapInoExpertGraphSelectText",true);if(N.group!==1){a.select(this.childNodes[0]).classed("sapInoExpertGraphSelectedTag",true);}else{a.select(this.childNodes[0]).classed("sapInoExpertGraphSelectedPerson",true);}});t.fireClickNode(d);}});q.append("text").attr("dx",14).attr("dy",".35em").attr("x",-0).attr("y",function(d){if(d.group===0){return-12;}else{if(r+(5/d.RANK)<8){return 8;}else{return r+(5/d.RANK);}}}).text(function(d){return d.NAME?d.NAME:"["+t._oRB.getText("CTRL_EXPERTFINDER_GRP_NO_NAME")+"]";}).classed("sapInoExpertGraphText",true);q.each(function(N){if(N.group!==0){a.select(this).classed("sapInoExpertGraphPerson",true);}else{a.select(this).classed("sapInoExpertGraphTag",true);}});var T=[];var v=[];var A=function(N){if(N.group===0){return 12;}else{if(r+(10/N.RANK)<8){return 8;}else{return r+(10/N.RANK);}}};g.on("tick",function(){q.attr("cx",function(d){var w=s>1?b:b/s;d.x=Math.max(A(d),Math.min(w-A(d),d.x));return d.x;}).attr("cy",function(d){var h=s>1?c:c/s;d.y=Math.max(A(d),Math.min(h-A(d),d.y));return d.y;}).on("mouseover",function(d){var e=[];var h=p.filter(function(l){if(l.source.index===d.index||l.target.index===d.index){e.push(l.source.index);e.push(l.target.index);return true;}else{return false;}});var w=q.filter(function(l){return(e.indexOf(l.index)>=0);});h.each(function(){v.push(this);a.select(this).classed("sapInoExpertLink",false).classed("sapInoExpertGraphHiglightLine",true);});w.each(function(){T.push(this.childNodes[0]);T.push(this.childNodes[1]);a.select(this.childNodes[0]).classed("sapInoExpertGraphHiglightCircle",true);a.select(this.childNodes[1]).classed("sapInoExpertGraphHiglightText",true);});t.fireMouseOverNode(d);}).on("mouseout",function(d){for(i=0;i<T.length;i++){a.select(v[i]).classed("sapInoExpertGraphHiglightCircle",false).classed("sapInoExpertGraphHiglightText",false).classed("sapInoExpertGraphHiglightLine",false);}T=[];for(i=0;i<v.length;i++){var e=v[i];var R=jQuery.grep(u,function(h){return h===e;});if(R.length===0){a.select(e).classed("sapInoExpertLink",true);}}v=[];t.fireMouseOutNode(d);});q.attr("transform",function(d){return"translate("+d.x+","+d.y+")";});p.attr("x1",function(d){return d.source.x;}).attr("y1",function(d){return d.source.y;}).attr("x2",function(d){return d.target.x;}).attr("y2",function(d){return d.target.y;});});var B=0;while(g.alpha()>0.03){g.tick();if(B++>500){break;}}function E(){var b=$[0][0].scrollWidth;var c=$[0][0].scrollHeight;f.attr("width",b).attr("height",c);if(g.nodes().length!==0){g.size([b,c]).resume();}else{var x=($[0][0].scrollWidth-f.select("text")[0][0].getBBox().width)/3;var y=($[0][0].scrollHeight-f.select("text")[0][0].getBBox().height)/2;f.select("text").attr("x",x).attr("y",y);}}a.select(window).on('resize',E);}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.Follow')){jQuery.sap.declare('sap.ino.controls.Follow');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.m.ToggleButton');jQuery.sap.require('sap.ui.core.InvisibleText');sap.ui.define("sap/ino/controls/Follow",["sap/m/ButtonType","sap/m/Button","sap/ui/core/IconPool","sap/m/ToggleButton","sap/ui/core/InvisibleText"],function(B,a,I,T,b){'use strict';return a.extend("sap.ino.controls.Follow",{metadata:{properties:{"Id":{type:"int"},"objectId":{type:"int"},"enabled":{type:"boolean"},"type":{type:"string"},"value":{type:"float"},"tooltip":{type:"string"},"onlyIcon":{type:"boolean"},"styleType":{type:"string"},"visible":{type:"boolean"},"showType":{type:"string",defaultValue:"card"}},aggregations:{"_follow":{type:"sap.m.ToggleButton",multiple:false,visibility:"hidden"},"_followDescription":{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"}},events:{follow:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_onFollow:function(){var v=this.getProperty('value');var o=this.getProperty('objectId');var t=this.getProperty('type');this.setProperty('value',this.getProperty('value')?0:1);this.fireFollow({value:v,objectId:o,type:t});},_followButton:function(){var f=this.getAggregation("_follow");var s=this;var v=s.getProperty('value');var c=s.getProperty('showType');var i=s.getModel("i18n").getResourceBundle();var t=v?'UNFOLLOW_TOOLTIP_'+s.getProperty('type'):'FOLLOW_TOOLTIP_'+s.getProperty('type');var d=v?i.getText('FOLLOW_STATUS_FOLLOWING'):i.getText('FOLLOW_STATUS_FOLLOW');var e=v?I.getIconURI('following','InoIcons'):I.getIconURI('follow','InoIcons');if(f){f.setText(d);f.setPressed(!!v);f.setEnabled(s.getProperty('enabled'));f.setVisible(s.getProperty('visible'));f.setTooltip(i.getText(t));f.setIcon(e);}else{f=new T({ariaDescribedBy:this._getFollowDescription(i.getText(t)),text:d,icon:e,enabled:this.getProperty("enabled"),visible:this.getProperty('visible'),press:function(){s._onFollow();},pressed:!!v,tooltip:i.getText(t),type:B.Transparent});this.setAggregation("_follow",f,true);}if(v){f.attachBrowserEvent('mouseenter focus',function(){f.setIcon(I.getIconURI('unfollow','InoIcons'));f.$().removeClass('isHover').addClass('isHover');f.setText(i.getText('FOLLOW_STATUS_UNFOLLOW'));return false;});f.attachBrowserEvent('mouseleave blur',function(){f.setIcon(I.getIconURI('following','InoIcons'));f.$().removeClass('isHover');f.setText(i.getText('FOLLOW_STATUS_FOLLOWING'));return false;});}else{f.$().removeClass('isHover');f.aBindParameters=[];}return f;},_followIcon:function(){var f=this.getAggregation("_follow");var s=this;var v=s.getProperty('value');var c=s.getProperty('showType');var i=s.getModel("i18n");var d;if(i){d=i.getResourceBundle();}var t=v?'UNFOLLOW_TOOLTIP_'+s.getProperty('type'):'FOLLOW_TOOLTIP_'+s.getProperty('type');var e=v?I.getIconURI('following','InoIcons'):I.getIconURI('follow','InoIcons');if(f){f.setPressed(!!v);f.setEnabled(s.getProperty('enabled'));f.setVisible(s.getProperty('visible'));f.setTooltip(d?d.getText(t):"");f.setIcon(e);}else{f=new T({ariaDescribedBy:this._getFollowDescription(d?d.getText(t):""),enabled:this.getProperty("enabled"),visible:this.getProperty('visible'),icon:e,press:function(){s._onFollow();},pressed:!!v,tooltip:d?d.getText(t):"",type:B.Transparent});this.setAggregation("_follow",f,true);}if(v){f.attachBrowserEvent('mouseenter focus',function(){f.setIcon(I.getIconURI('unfollow','InoIcons'));f.$().removeClass('isHover').addClass('isHover');return false;});f.attachBrowserEvent('mouseleave blur',function(){f.setIcon(I.getIconURI('following','InoIcons'));f.$().removeClass('isHover');return false;});}else{f.$().removeClass('isHover');f.aBindParameters=[];}return f;},_getFollowDescription:function(t){var d=this.getAggregation("_followDescription");if(!d){d=new b({text:t});this.setAggregation("_followDescription",d);}return d;},renderer:function(r,c){var f,d;var o=c.getProperty('onlyIcon');var s=c.getProperty('showType');var e=c.getProperty('styleType')?c.getProperty('styleType'):'';var i=c.getProperty('value')?'isActive':'';if(o){f=c._followIcon();d='sapFollowIcon';}else{f=c._followButton();d='sapFollowButton';}if(s==="card"){r.write("<div");r.writeControlData(c);r.addClass(d);r.addClass(e);r.addClass(i);r.writeClasses();r.write(">");if(f){r.renderControl(f);r.renderControl(c._getFollowDescription());}r.write("</div>");}else if(s==="list"){if(f){r.renderControl(f);r.renderControl(c._getFollowDescription());}}}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.GenericStyle')){jQuery.sap.declare('sap.ino.controls.GenericStyle');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.IconPool');sap.ui.define("sap/ino/controls/GenericStyle",["sap/ui/core/Control","sap/ui/core/IconPool"],function(C,I){"use strict";var G=C.extend("sap.ino.controls.GenericStyle",{constructor:function(){throw new Error("Control is not instantiatable.");}});G.getImage=function(i,p){if(!p){p="sap.ino.controls";}var c=sap.ui.getCore().getConfiguration().getTheme();var r=sap.ui.getCore().getConfiguration().getRTL();return sap.ui.resource(p,"themes/"+c+"/img"+(r?"-RTL":"")+"/GenericStyle/"+i);};I.addIcon("campaign","InoIcons","InoIcons","e900");I.addIcon("campaign-add","InoIcons","InoIcons","e901");I.addIcon("wall-add","InoIcons","InoIcons","e902");I.addIcon("wall","InoIcons","InoIcons","e903");I.addIcon("heart","InoIcons","InoIcons","e904");I.addIcon("heart-filled","InoIcons","InoIcons","e905");I.addIcon("idea","InoIcons","InoIcons","e906");I.addIcon("idea-add","InoIcons","InoIcons","e907");I.addIcon("thumbsdown","InoIcons","InoIcons","e908");I.addIcon("thumbsdown-filled","InoIcons","InoIcons","e909");I.addIcon("thumbsup","InoIcons","InoIcons","e90a");I.addIcon("line3","InoIcons","InoIcons","e90c");I.addIcon("line4","InoIcons","InoIcons","e90d");I.addIcon("line5","InoIcons","InoIcons","e90e");I.addIcon("line-both","InoIcons","InoIcons","e90f");I.addIcon("line-dashed","InoIcons","InoIcons","e910");I.addIcon("line-dotted","InoIcons","InoIcons","e911");I.addIcon("line-end","InoIcons","InoIcons","e912");I.addIcon("line-start","InoIcons","InoIcons","e913");I.addIcon("line-vertical","InoIcons","InoIcons","e914");I.addIcon("follow","InoIcons","InoIcons","e915");I.addIcon("following","InoIcons","InoIcons","e916");I.addIcon("unfollow","InoIcons","InoIcons","e917");I.addIcon("register","InoIcons","InoIcons","e918");I.addIcon("pending","InoIcons","InoIcons","e919");I.addIcon("raise_hand","InoIcons","InoIcons","e91a");I.addIcon("shake_hands","InoIcons","InoIcons","e91b");I.addIcon("lightbulb_check","InoIcons","InoIcons","e91c");I.addIcon("information","InoIcons","InoIcons","e612");I.addIcon("quicklink","InoIcons","InoIcons","e610");I.addIcon("quicklink-custom","InoIcons","InoIcons","e60f");I.addIcon("quicklink-standard","InoIcons","InoIcons","e611");I.addIcon("latest-update","InoIcons","InoIcons","e91d");I.addIcon("latest-update-selected","InoIcons","InoIcons","e91e");I.addIcon("status-update","InoIcons","InoIcons","e91f");I.addIcon("status-update-selected","InoIcons","InoIcons","e920");I.addIcon("comment-update","InoIcons","InoIcons","e921");I.addIcon("comment-update-selected","InoIcons","InoIcons","e914");I.addIcon("active-participates","InoIcons","InoIcons","e922");I.addIcon("new_comment","InoIcons","InoIcons","e923");I.addIcon("new_status","InoIcons","InoIcons","e924");I.addIcon("idea_read","InoIcons","InoIcons","e925");I.addIcon("idea_update","InoIcons","InoIcons","e926");I.addIcon("idea-news","InoIcons","InoIcons","e927");I.addIcon("idea_create","InoIcons","InoIcons","e928");I.addIcon("leaderboard_fire","InoIcons","InoIcons","e929");I.insertFontFaceStyle();return G;});};if(!jQuery.sap.isDeclared('sap.ino.controls.HorizontalLine')){jQuery.sap.declare('sap.ino.controls.HorizontalLine');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/HorizontalLine",["sap/ui/core/Control","sap/base/security/sanitizeHTML"],function(C,s){"use strict";return C.extend("sap.ino.controls.HorizontalLine",{metadata:{properties:{"height":{type:"string",defaultValue:"1px"},"width":{type:"string",defaultValue:"100%"}}},renderer:function(r,c){var h=s(c.getHeight());var w=s(c.getWidth());r.write("<div");r.writeControlData(c);r.addStyle("width",w);r.addStyle("overflow","hidden");r.writeStyles();r.addClass("sapInoHorizontalLine");r.writeClasses();r.write(">");r.write("<svg");r.writeAttribute("focusable","false");r.addStyle("width",w);r.addStyle("height",h);r.writeStyles();r.writeClasses();r.write(">");r.write("<rect");r.writeAttributeEscaped("x",0);r.writeAttributeEscaped("y",0);r.writeAttributeEscaped("width",w);r.writeAttributeEscaped("height",h);r.write("/>");r.write("</svg>");r.write("</div>");}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.IFrame')){jQuery.sap.declare("sap.ino.controls.IFrame");(function(){"use strict";sap.ui.core.HTML.extend("sap.ino.controls.IFrame",{metadata:{properties:{content:"string",width:{type:"string",defaultValue:"100%"},height:{type:"string",defaultValue:"100%"},backgroundColor:{type:"string",defaultValue:"white"}}},constructor:function(c){this.sanitizeContent=true;sap.ui.core.HTML.apply(this,arguments);},onAfterRendering:function(){var d=this.getDomRef();var D=d.contentWindow.document;D.open();D.write(this.getContent()||"");D.close();},renderer:function(r,c){r.write("<iframe");r.writeControlData(c);r.writeAttributeEscaped("style","width:"+c.getWidth()+";height:"+c.getHeight()+";background-color:"+c.getBackgroundColor()+";border:0");r.write("></iframe>");}});})();};if(!jQuery.sap.isDeclared('sap.ino.controls.IdeaAttachmentRoleType')){jQuery.sap.declare("sap.ino.controls.IdeaAttachmentRoleType");(function(){"use strict";sap.ino.controls.IdeaAttachmentRoleType={Standard:"ATTACHMENT",TitleImage:"IDEA_TITLE_IMAGE"};})();};if(!jQuery.sap.isDeclared('sap.ino.controls.IdeaStatusActionType')){jQuery.sap.declare("sap.ino.controls.IdeaStatusActionType");(function(){"use strict";sap.ino.controls.IdeaStatusActionType={nextPhase:"sap.ino.config.START_NEXT_PHASE",prevPhase:"sap.ino.config.RESTART_PREV_PHASE"};})();};if(!jQuery.sap.isDeclared('sap.ino.controls.IdeaStatusType')){jQuery.sap.declare("sap.ino.controls.IdeaStatusType");(function(){"use strict";sap.ino.controls.IdeaStatusType={Draft:"sap.ino.config.DRAFT",Completed:"sap.ino.config.COMPLETED",Discontinued:"sap.ino.config.DISCONTINUED",Merged:"sap.ino.config.MERGED",TypeNew:"NEW",TypeCompleted:"COMPLETED",TypeDiscontinued:"DISCONTINUED",TypeInProcess:"IN_PROCESS"};})();};if(!jQuery.sap.isDeclared('sap.ino.controls.IdeaVolunteer')){jQuery.sap.declare('sap.ino.controls.IdeaVolunteer');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.m.ToggleButton');sap.ui.define("sap/ino/controls/IdeaVolunteer",["sap/m/ButtonType","sap/ui/core/Control","sap/ui/core/IconPool","sap/m/ToggleButton"],function(B,C,I,T){'use strict';return C.extend("sap.ino.controls.IdeaVolunteer",{metadata:{properties:{"key":{type:"int"},"ideaId":{type:"int"},"value":{type:"boolean"},"onlyIcon":{type:"boolean"},"tooltip":{type:"string"},"visible":{type:"boolean"},"enabled":{type:"boolean"},"styleClass":{type:"string"}},aggregations:{"_volunteer":{type:"sap.m.ToggleButton",multiple:false,visibility:"hidden"}},events:{volunteer:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_onVolunteer:function(){var v=this.getProperty("value");var i=this.getProperty("ideaId");var k=this.getProperty("key");this.setProperty("value",!v);this.fireVolunteer({Key:k,Value:v,IdeaId:i});},_getIcon:function(){var s=this;var v=this.getAggregation("_volunteer");var i=I.getIconURI('raise_hand','InoIcons');var a=this.getModel("i18n").getResourceBundle();var V=this.getProperty("value");var t=V?a.getText("LEAVE_VOLUNTEERS"):a.getText("ADD_VOLUNTEERS");if(!v){v=new T({icon:i,visible:this.getProperty('visible'),enabled:this.getProperty("enabled"),pressed:V,tooltip:t,type:"Transparent",press:function(){s._onVolunteer();}});this.setAggregation("_volunteer",v,true);}else{v.setPressed(V);v.setVisible(this.getProperty("visible"));v.setEnabled(this.getProperty('enabled'));v.setTooltip(t);v.setIcon(i);}return v;},renderer:function(r,c){var v=c._getIcon();var i=c.getProperty('value')?'isActive':'';r.write("<div");r.writeControlData(c);r.addClass(jQuery.sap.encodeHTML(c.getProperty('styleClass')));r.addClass(i);r.writeClasses();if(c.getTooltip_Text()){r.writeAttributeEscaped("title",c.getTooltip());}r.write(">");r.renderControl(v);r.write("</div>");}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.IdentityCard')){jQuery.sap.declare('sap.ino.controls.IdentityCard');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Image');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Size');jQuery.sap.require('sap.ui.core.Orientation');sap.ui.define("sap/ino/controls/IdentityCard",["sap/ui/core/Control","sap/m/Image","sap/ui/core/Icon","sap/m/Link","sap/m/Text","sap/m/Size","sap/ui/core/Orientation"],function(C,I,a,L,T,S,O){"use strict";var b=C.extend("sap.ino.controls.IdentityCard",{metadata:{properties:{identityId:{type:"int"},userImageUrl:{type:"sap.ui.core.URI"},imageSize:{type:"sap.m.Size",defaultValue:"M"},userName:{type:"string"},userOrganization:{type:"string"},orientation:{type:"sap.ui.core.Orientation",defaultValue:"Horizontal"}},aggregations:{actions:{type:"sap.ui.core.Control",multiple:true,singularName:"action"},content:{type:"sap.ui.core.Control",multiple:true},contribution:{type:"sap.ui.core.Control",multiple:false},_nameLink:{type:"sap.m.Link",multiple:false,visibility:"hidden"},_organizationLabel:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_userImage:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},events:{identityPress:{}},defaultAggregation:"content"},init:function(){},setUserImageUrl:function(u){var i=this.getAggregation("_userImage");var o;if(i){if(u&&this.getProperty("userImageUrl")!==u){o=new I({src:u,decorative:true,press:this.fireNavigateToUser.bind(this)});o.addStyleClass("sapInoUserImage");}else if(!u&&i.getMetadata().getName()==="sap.m.Image"){o=new a({src:"sap-icon://person-placeholder",decorative:true,useIconTooltip:false,press:this.fireNavigateToUser.bind(this)});o.addStyleClass("sapInoUserIcon");}}else{if(u){o=new I({src:u,decorative:true,press:this.fireNavigateToUser.bind(this)});o.addStyleClass("sapInoUserImage");}else{o=new a({src:"sap-icon://person-placeholder",decorative:true,useIconTooltip:false,press:this.fireNavigateToUser.bind(this)});o.addStyleClass("sapInoUserIcon");}}if(o){this.setAggregation("_userImage",o);}this.setProperty("userImageUrl",u);return this;},setUserName:function(u){if(u&&this.getProperty("userName")!==u&&this.getIdentityId()!==0){this.setAggregation("_nameLink",new L({text:u,press:this.fireNavigateToUser.bind(this),wrapping:false}).setTooltip(u));}this.setProperty("userName",u);return this;},setUserOrganization:function(o){if(o){this.setAggregation("_organizationLabel",new T({text:o,wrapping:true}));}this.setProperty("userOrganization",o);return this;},fireNavigateToUser:function(e){this.fireIdentityPress({identityId:this.getIdentityId(),actualSource:e.getSource()});return this;},getImageAggregation:function(){if(!this.getAggregation("_userImage")){this.setUserImageUrl();}return this.getAggregation("_userImage");},renderer:function(r,c){r.write("<div ");r.writeControlData(c);r.addClass("sapInoIdentityCard");if(c.getOrientation()===O.Vertical){r.addClass("sapInoIdentityCardVertical");}else{r.addClass("sapInoIdentityCardHorizontal");}r.writeClasses();r.writeStyles();r.write(">");var o=c.getImageAggregation();var s=c.getImageSize();if(s===S.XS){o.addStyleClass("sapInoUserImageXSmall");}else if(s===S.S){o.addStyleClass("sapInoUserImageSmall");}else if(s===S.L){o.addStyleClass("sapInoUserImageLarge");}else{o.addStyleClass("sapInoUserImageMedium");}r.write("<div ");r.addClass("sapInoUserImageWrapper");r.writeClasses();r.write(">");r.renderControl(o);r.write("</div>");r.write("<div");r.addClass("sapInoUserContentWrapper");r.writeClasses();r.write(">");var n=c.getAggregation("_nameLink");if(n){r.renderControl(n);}var d=c.getAggregation("_organizationLabel");if(d){r.renderControl(d);}var e=c.getContent();if(e&&e.length>0){for(var i=0;i<e.length;i=i+1){r.renderControl(e[i]);}}r.write("</div>");var A=c.getActions();if(A&&A.length>0){r.write("<div");r.addClass("sapInoUserActionWrapper");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoActionBtnWrapper");r.writeClasses();r.write(">");for(i=0;i<A.length;i=i+1){r.renderControl(A[i]);}r.write("</div>");var f=c.getAggregation("contribution");if(f){r.renderControl(f);}r.write("</div>");}r.write("</div>");},onAfterRendering:function(){var i=this.getImageAggregation();if(i){i.$().attr("tabindex","-1");}}});return b;});};if(!jQuery.sap.isDeclared('sap.ino.controls.ImageCropping')){jQuery.sap.declare('sap.ino.controls.ImageCropping');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/ImageCropping",["sap/ui/core/Control","sap/m/Button","sap/ui/Device","sap/base/security/sanitizeHTML"],function(C,B,D,s){"use strict";return C.extend("sap.ino.controls.ImageCropping",{metadata:{properties:{url:{type:"string"},width:{type:"sap.ui.core.CSSSize",defaultValue:"216px"},height:{type:"sap.ui.core.CSSSize",defaultValue:"121px"},showZoom:{type:"boolean",defaultValue:true},showMove:{type:"boolean",defaultValue:false},showClear:{type:"boolean",defaultValue:false},showCrop:{type:"boolean",defaultValue:false},zoomStep:{type:"int",defaultValue:1},moveStep:{type:"int",defaultValue:1},enabled:{type:"boolean",defaultValue:true}},aggregations:{"_zoomPlusButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_zoomMinusButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_moveUpButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_moveDownButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_moveLeftButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_moveRightButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_clearButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_cropButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"}},events:{clear:{},crop:{},cropImg:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");this._bImgLoaded=false;},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapInoImageCrop");r.writeClasses();r.addStyle("width",s(c.getWidth()));r.addStyle("height",s(c.getHeight()));r.writeStyles();r.write(">");if(c.getUrl()){r.write("<div");r.writeAttributeEscaped("tabindex","0");r.writeAttributeEscaped("title",c._oRB.getText("IMAGE_CROP_DETAIL"));r.addClass("sapInoImageCropImageContainer");r.addClass("sapInoImageCropImageContainerHidden");if(!c.getEnabled()){r.addClass("sapInoImageCropImageContainerDisabled");}r.writeClasses();r.write(">");r.write("<img");r.writeAttributeEscaped("src",c.getUrl());r.writeAttributeEscaped("title",c._oRB.getText("IMAGE_CROP_DETAIL"));r.addClass("sapInoImageCropImage");r.writeClasses();r.write("></img>");r.write("</div>");if(c.getEnabled()){if(c.getShowZoom()){r.renderControl(c.getZoomPlusButton());r.renderControl(c.getZoomMinusButton());}if(c.getShowMove()){r.renderControl(c.getMoveUpButton());r.renderControl(c.getMoveDownButton());r.renderControl(c.getMoveLeftButton());r.renderControl(c.getMoveRightButton());}if(c.getShowClear()){r.renderControl(c.getClearButton());}if(c.getShowCrop()){r.renderControl(c.getCropButton());}}}r.write("</div>");},onAfterRendering:function(){var i=this.cropImage();if(i){var t=this;i.onload=function(){t.cropInit();jQuery(t.cropImageContainer()).removeClass("sapInoImageCropImageContainerHidden");t._bImgLoaded=true;};if(this._bImgLoaded){jQuery(this.cropImageContainer()).removeClass("sapInoImageCropImageContainerHidden");}}},setFocus:function(){if(this.cropImage()){jQuery(this.cropImage()).parent().focus();}},getZoomPlusButton:function(){var t=this;var z=this.getAggregation("_zoomPlusButton");if(!z){z=new B({icon:"sap-icon://zoom-in",tooltip:this._oRB.getText("IMAGE_CROP_ZOOM_PLUS"),press:function(e){e.cancelBubble();e.preventDefault();t.cropZoom(t.getZoomStep());t.getFocusDomRef().focus();},enabled:false}).addStyleClass("sapInoImageCropButton").addStyleClass("sapInoImageCropZoomPlus");this.setAggregation("_zoomPlusButton",z);}return z;},getZoomMinusButton:function(){var t=this;var z=this.getAggregation("_zoomMinusButton");if(!z){z=new B({icon:"sap-icon://zoom-out",tooltip:this._oRB.getText("IMAGE_CROP_ZOOM_MINUS"),press:function(e){e.cancelBubble();e.preventDefault();t.cropZoom(-t.getZoomStep());t.getFocusDomRef().focus();},enabled:false}).addStyleClass("sapInoImageCropButton").addStyleClass("sapInoImageCropZoomMinus");this.setAggregation("_zoomMinusButton",z);}return z;},getMoveUpButton:function(){var t=this;var m=this.getAggregation("_moveUpButton");if(!m){m=new B({icon:"sap-icon://slim-arrow-up",tooltip:this._oRB.getText("IMAGE_CROP_MOVE_UP"),press:function(e){e.cancelBubble();e.preventDefault();t.cropMoveBy(0,-t.getMoveStep());t.getFocusDomRef().focus();},enabled:false}).addStyleClass("sapInoImageCropButton").addStyleClass("sapInoImageCropMoveUp");this.setAggregation("_moveUpButton",m);}return m;},getMoveDownButton:function(){var t=this;var m=this.getAggregation("_moveDownButton");if(!m){m=new B({icon:"sap-icon://slim-arrow-down",tooltip:this._oRB.getText("IMAGE_CROP_MOVE_DOWN"),press:function(e){e.cancelBubble();e.preventDefault();t.cropMoveBy(0,t.getMoveStep());t.getFocusDomRef().focus();},enabled:false}).addStyleClass("sapInoImageCropButton").addStyleClass("sapInoImageCropMoveDown");this.setAggregation("_moveDownButton",m);}return m;},getMoveLeftButton:function(){var t=this;var m=this.getAggregation("_moveLeftButton");if(!m){m=new B({icon:"sap-icon://slim-arrow-left",tooltip:this._oRB.getText("IMAGE_CROP_MOVE_LEFT"),press:function(e){e.cancelBubble();e.preventDefault();t.cropMoveBy(-t.getMoveStep(),0);t.getFocusDomRef().focus();},enabled:false}).addStyleClass("sapInoImageCropButton").addStyleClass("sapInoImageCropMoveLeft");this.setAggregation("_moveLeftButton",m);}return m;},getMoveRightButton:function(){var t=this;var m=this.getAggregation("_moveRightButton");if(!m){m=new B({icon:"sap-icon://slim-arrow-right",tooltip:this._oRB.getText("IMAGE_CROP_MOVE_RIGHT"),press:function(e){e.cancelBubble();e.preventDefault();t.cropMoveBy(t.getMoveStep(),0);t.getFocusDomRef().focus();},enabled:false}).addStyleClass("sapInoImageCropButton").addStyleClass("sapInoImageCropMoveRight");this.setAggregation("_moveRightButton",m);}return m;},getClearButton:function(){var t=this;var c=this.getAggregation("_clearButton");if(!c){c=new B({icon:"sap-icon://sys-cancel",tooltip:this._oRB.getText("IMAGE_CROP_CLEAR"),press:function(e){e.cancelBubble();e.preventDefault();t.fireClear();t.getFocusDomRef().focus();},enabled:true}).addStyleClass("sapInoImageCropButton").addStyleClass("sapInoImageCropClear");this.setAggregation("_clearButton",c);}return c;},getCropButton:function(){var t=this;var c=this.getAggregation("_cropButton");if(!c){c=new B({icon:"sap-icon://crop",tooltip:this._oRB.getText("IMAGE_CROP_CROP"),press:function(e){e.cancelBubble();e.preventDefault();t.fireCropImg();t.getFocusDomRef().focus();},enabled:false}).addStyleClass("sapInoImageCropButton").addStyleClass("sapInoImageCropCrop");this.setAggregation("_cropButton",c);}return c;},cropInit:function(S){this.cropInitMove();this.cropInitScrollZoom();if(!S){this.cropInitImage();}this.cropCheckButtons();},cropImageContainer:function(){return jQuery(this.getDomRef()).find(".sapInoImageCropImageContainer")[0];},cropImage:function(){return jQuery(this.getDomRef()).find(".sapInoImageCropImage")[0];},cropInitImage:function(){var i=this.cropImage();var d=jQuery(this.getDomRef());var r=i.naturalWidth/i.naturalHeight;var z=d.width()-i.naturalWidth;var a=d.height()-i.naturalHeight;var b=z>a*r?z:a*r;this.cropZoomBy(b);jQuery(i).css({"left":0,"top":0,"position":"relative"});},cropInitMove:function(){if(!this.getEnabled()){return;}var a=this;var i=this.cropImage();var I=jQuery(i);I.on("mousedown",function(e){e.preventDefault();var p=I.offset().left-e.pageX;var b=I.offset().top-e.pageY;I.on("mousemove",function(e){a.cropMoveAt(p+e.pageX,b+e.pageY);});}).on("mouseup",function(){I.off("mousemove");}).on("mouseout",function(){I.off("mousemove");});I.on("touchstart",function(e){e.preventDefault();if(e.touches&&e.touches.length>0){var t=e.touches[0];var p=I.offset().left-t.pageX;var b=I.offset().top-t.pageY;var d=-1;I.on("touchmove",function(e){if(e.touches&&e.touches.length>0){if(e.touches.length==2){var c=e.touches[0];var f=e.touches[1];var n=Math.sqrt(Math.pow(c.pageX-f.pageX,2)+Math.pow(c.pageY-f.pageY,2));if(d>0){a.cropZoomBy(n-d);}d=n;}else{var t=e.touches[0];a.cropMoveAt(p+t.pageX,b+t.pageY);}}});}}).on("touchend",function(){I.off("touchmove");});},cropInitScrollZoom:function(){if(!this.getEnabled()){return;}var t=this;var i=this.cropImage();var I=jQuery(i);I.parent().bind("wheel mousewheel",function(e){if(e.originalEvent.deltaY>0){t.cropZoom(-1.0);}else{t.cropZoom(1.0);}e.originalEvent.preventDefault();e.originalEvent.stopPropagation();e.originalEvent.stopImmediatePropagation();return false;});},onkeydown:function(e){if(!this.getEnabled()){return;}var S=true;switch(e.keyCode){case jQuery.sap.KeyCodes.ARROW_LEFT:this.cropMoveBy(-1,0);break;case jQuery.sap.KeyCodes.ARROW_UP:this.cropMoveBy(0,-1);break;case jQuery.sap.KeyCodes.ARROW_RIGHT:this.cropMoveBy(1,0);break;case jQuery.sap.KeyCodes.ARROW_DOWN:this.cropMoveBy(0,1);break;case jQuery.sap.KeyCodes.PLUS:case jQuery.sap.KeyCodes.NUMPAD_PLUS:case 171:this.cropZoom(1.0);break;case jQuery.sap.KeyCodes.SLASH:case jQuery.sap.KeyCodes.MINUS:case jQuery.sap.KeyCodes.NUMPAD_MINUS:case 173:this.cropZoom(-1.0);break;default:S=false;break;}if(S){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();}},cropCheckButtons:function(){if(!this.getEnabled()){return;}var i=jQuery(this.cropImage());var d=jQuery(this.getDomRef());var m=-(i.width()-d.width());var a=-(i.height()-d.height());var l=parseInt(i.css("left"),10);var t=parseInt(i.css("top"),10);if(this.getAggregation("_zoomPlusButton")){this.getAggregation("_zoomPlusButton").setEnabled(true);}if(this.getAggregation("_zoomMinusButton")){this.getAggregation("_zoomMinusButton").setEnabled(i.width()>d.width()&&i.height()>d.height());}if(this.getAggregation("_moveUpButton")){this.getAggregation("_moveUpButton").setEnabled(t>a);}if(this.getAggregation("_moveDownButton")){this.getAggregation("_moveDownButton").setEnabled(t<0);}if(this.getAggregation("_moveLeftButton")){this.getAggregation("_moveLeftButton").setEnabled(l>m);}if(this.getAggregation("_moveRightButton")){this.getAggregation("_moveRightButton").setEnabled(l<0);}if(this.getAggregation("_cropButton")){this.getAggregation("_cropButton").setEnabled(i.width()!==d.width()||i.height()!==d.height());}},cropMoveAt:function(x,y){if(!this.getEnabled()){return;}var i=this.cropImage();var I=jQuery(i);var d=jQuery(this.getDomRef());I.offset({left:x,top:y});var m=-(I.width()-d.width());var a=-(I.height()-d.height());var l=parseInt(I.css("left"),10);var t=parseInt(I.css("top"),10);if(t>0){I.css("top",0);}if(t<a){I.css("top",a);}if(l>0){I.css("left",0);}if(l<m){I.css("left",m);}this.cropCheckButtons();},cropMoveBy:function(d,a){if(!this.getEnabled()){return;}var i=this.cropImage();var p=jQuery(i).offset();this.cropMoveAt(p.left+d,p.top+a);},cropZoom:function(f){if(!this.getEnabled()){return;}this.cropZoomBy(10.0*(f||1.0));},cropZoomBy:function(d){if(!this.getEnabled()){return;}var i=this.cropImage();var I=jQuery(i);var j=jQuery(this.getDomRef());var r=I.width()/I.height();var n=I.width()+d;var a=n/r;if(n<j.width()||a<j.height()){if(n-j.width()<a-j.height()){n=j.width();a=n/r;}else{a=j.height();n=r*a;}}I.width(n);I.height(a);var p=I.offset();this.cropMoveAt(p.left-d/2.0,p.top-d/2.0);this.cropCheckButtons();},crop:function(){var t=this;var I=this.cropImage();if(I){var j=jQuery(I);var d=jQuery(this.getDomRef());if(j.width()!==d.width()||j.height()!==d.height()){var c=document.createElement("canvas");var o=c.getContext("2d");o.mozImageSmoothingEnabled=true;o.webkitImageSmoothingEnabled=true;o.msImageSmoothingEnabled=true;o.imageSmoothingEnabled=true;c.width=d.width();c.height=d.height();o.fillStyle="#FFFFFF";o.fillRect(0,0,c.width,c.height);var a=Math.abs(parseInt(j.css("left"),10));var b=Math.abs(parseInt(j.css("top"),10));var l=a*(I.naturalWidth/j.width());var e=b*(I.naturalHeight/j.height());var w=I.naturalWidth;var h=I.naturalHeight;this.cropDrawImage(o,I,l,e,w-l,h-e,0,0,j.width()-a,j.height()-b);var f=c.toDataURL();var g=atob(f.split(",")[1]);var A=[];for(var i=0;i<g.length;i++){A.push(g.charCodeAt(i));}var F=new Blob([new Uint8Array(A)],{type:"image/png",name:"image.png"});return F;}}return null;},cropCalcVerticalRatio:function(i){if(!D.os.ios){return 1.0;}var n=i.naturalHeight;var c=document.createElement("canvas");c.width=1.0;c.height=n;var o=c.getContext("2d");o.drawImage(i,0,0);var d=o.getImageData(0,0,1,n).data;var S=0;var a=n;var p=n;while(p>S){var A=d[(p-1)*4+3];if(A===0){a=p;}else{S=p;}p=(a+S)>>1;}var r=(p/n);return(r===0)?1.0:r;},cropDrawImage:function(c,i,a,b,d,e,x,y,w,h){var v=1.0;c.drawImage(i,a*v,b*v,d*v,e*v,x,y,w,h);}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.LabelledIcon')){jQuery.sap.declare('sap.ino.controls.LabelledIcon');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.HBox');sap.ui.define("sap/ino/controls/LabelledIcon",["sap/ui/core/Control","sap/ui/core/Icon","sap/m/Text","sap/m/HBox"],function(C,I,T,H){"use strict";var L=C.extend("sap.ino.controls.LabelledIcon",{metadata:{properties:{"iconUrl":{type:"string"},"label":{type:"string"},"exportLabel":{type:"string"}},aggregations:{"_box":{type:"sap.m.HBox",multiple:false,visibility:"hidden"},"_exportText":{type:"sap.m.Text",multiple:false,visibility:"hidden"}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_getIcon:function(){return this._getBox().getItems()[0];},_getLabel:function(){return this._getBox().getItems()[1];},_getExportLabel:function(){var e=this.getAggregation("_exportText");if(!e){e=new T({text:this.getExportLabel(),wrapping:false});this.setAggregation("_exportText",e);}return e;},_getBox:function(){var b=this.getAggregation("_box");if(!b){var i=new I({src:this.getIconUrl(),useIconTooltip:false}).addStyleClass("sapInoLabelledIconIcon");var t=new T({text:this.getLabel(),wrapping:false,}).addStyleClass("sapInoLabelledIconLabel");b=new H({items:[i,t],displayInline:true});this.setAggregation("_box",b,true);}return b;},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapInoLabelledIcon");r.writeClasses();if(c.getTooltip_Text()){r.writeAttributeEscaped("title",c.getTooltip_Text());}r.write(">");r.renderControl(c._getBox());r.write("</div>");}});L.prototype.onAfterRendering=function(){this._getLabel().data(this.data());this._getExportLabel().data(this.data());};L.prototype.bindProperty=function(k,b){C.prototype.bindProperty.apply(this,arguments);switch(k){case"label":this._getLabel().bindProperty("text",b);break;case"exportLabel":this._getExportLabel().bindProperty("text",b);break;default:break;}};L.prototype.setIconUrl=function(v){this.setProperty("iconUrl",v);this._getIcon().setSrc(v);};L.prototype.setLabel=function(v){this.setProperty("label",v);this._getLabel().setText(v);};L.prototype.setExportLabel=function(v){this.setProperty("exportLabel",v);};return L;});};if(!jQuery.sap.isDeclared('sap.ino.controls.ListBox')){jQuery.sap.declare('sap.ino.controls.ListBox');jQuery.sap.require('sap.ui.commons.ListBox');sap.ui.define("sap/ino/controls/ListBox",["sap/ui/commons/ListBox"],function(L){"use strict";return L.extend("sap.ino.controls.ListBox",{_handleUserActivationPlain:function(i,I){if(this.getAllowMultiSelect()){this._handleUserActivationCtrl(i,I);}else{L.prototype._handleUserActivationPlain.apply(this,[i,I]);}},renderer:"sap.ui.commons.ListBoxRenderer"});});};if(!jQuery.sap.isDeclared('sap.ino.controls.Milestone')){jQuery.sap.declare('sap.ino.controls.Milestone');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/ino/controls/Milestone",["sap/ui/core/Control","sap/ui/thirdparty/d3"],function(C,c){'use strict';return C.extend("sap.ino.controls.Milestone",{metadata:{properties:{"Id":{type:"int"},"tasks":{type:"array"},"visible":{type:"boolean"},"max-point":{type:'int'}},aggregations:{},events:{}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},controlConfig:{width:'900',height:'300',maxPoints:2,defaultThemeColor:'E50082',defaultFontColor:'666666',fontSizeX:14,fontSizeM:12,fontSizeS:10,defaultBarColor:'5f95c2',defaultBgColor:'f3f3f3',barHeight:20,gap:60,topPadding:5,bottomPadding:15,sidePadding:150,outPadding:200,labelMaxLength:18,milestoneMaxLength:220,milestoneNameMaxFactorLength:30,minWidth:768,normalWidth:800},nowTime:new Date().getTime(),onAfterRendering:function(){this.handleInfinity();this.dataMixin();this.resetting();this.initSVG();this.drawMileStone();},resetting:function(){$.extend(this.controlConfig,{width:this.getParent().$().width()*0.95,height:this.getProperty('tasks')&&this.getProperty('tasks').length*100+10});},initSVG:function(){var t=this.getProperty('tasks');if(this.controlConfig.width<this.controlConfig.minWidth){return c.selectAll(".mile-stone-svg").style({'display':'none'});}this.svg=c.selectAll(".mile-stone-svg").style({'display':'block'}).append("svg").attr("width",this.controlConfig.width).attr("height",this.controlConfig.height).attr("class","svg-content");this.timeScale=c.time.scale().domain([c.min(t,function(d){return d.START_DATE;}),c.max(t,function(d){return d.END_DATE;})]).range([0,this.controlConfig.width-this.controlConfig.outPadding]);},_mileStoneMerge:function(s){this.MILESTONE_NAME='...';this.MILESTONE_DATE=undefined;this.MILESTONE_MERGE=[];this.MILESTONE_COLOR_CODE=s.controlConfig.defaultThemeColor;this.MILESTONE_IS_MERGE=true;this.IS_MILESTONE_DISPLAY=true;},_timeSort:function(a,b){return a.MILESTONE_DATE.getTime()-b.MILESTONE_DATE.getTime();},_isClean:function(t){return t.END_DATE.getFullYear()<9999;},_isInfinity:function(t){return t.END_DATE.getFullYear()===9999;},_isShowTask:function(t){return!!t.IS_TASK_DISPLAY;},_isShowMilestone:function(m){return!!m.IS_MILESTONE_DISPLAY;},handleInfinity:function(){var s=this;var d=this.getProperty('tasks')&&this.getProperty('tasks').sort(function(a,b){return a.SEQUENCE_NO-b.SEQUENCE_NO;});var t=d.filter(this._isShowTask);if(!t&&!t.length){return false;}t.forEach(function(a){a.Milestones=a.Milestones.filter(s._isShowMilestone);});var e=t.filter(this._isClean);var i=t.filter(this._isInfinity);var f=[],g=[];var n=new Date(this.nowTime);if(!i||!i.length){return this.setProperty('tasks',t);}t.forEach(function(v){f=f.concat(v.Milestones);});var m=f.length&&c.max(f,function(v){return v.MILESTONE_DATE;});var h=e&&e.length&&c.max(e,function(v){return v.END_DATE;});i.forEach(function(v){if(!m&&!m){v.END_DATE=new Date(n.getFullYear()+1,n.getMonth(),n.getDate());}if(m&&h){var a=m.getTime()>h.getTime()?m:h;v.END_DATE=new Date(a);}if(m&&!h){v.END_DATE=new Date(m.getTime()*1.01);}if(!m&&h){v.END_DATE=new Date(h.getTime()*1.01);}v.IS_INFINITY=true;});g=e.concat(i);this.setProperty('tasks',g.sort(function(a,b){return a.SEQUENCE_NO-b.SEQUENCE_NO;}));},dataMixin:function(){var s=this.getProperty('tasks');if(!s){return false;}var n=this.nowTime,t,p,a,b;var m=this.controlConfig.maxPoints;var d=this.controlConfig;for(var i=0;i<s.length;i++){t=s[i];t.TASK_INDEX=i;t.LINEGAP=0;t.left=[];t.right=[];this.getTemplateText(t);if(!t.Milestones||!t.Milestones.length){continue;}t.Milestones.sort(this._timeSort);for(var x=0;x<t.Milestones.length;x++){p=t.Milestones[x];a=t.Milestones[x+1];b=t.Milestones[x-1];p.INDEX=i;p.yAxis=0;if(p.MILESTONE_IS_MERGE){t.HAS_MERGE=true;}if(a){p.NEXT=a.MILESTONE_DATE;}else{p.NEXT=t.END_DATE;}if(b){p.PRE=b.MILESTONE_DATE;}else{p.PRE=t.START_DATE;}if(!p.MILESTONE_COLOR_CODE){p.MILESTONE_COLOR_CODE=d.defaultThemeColor;}if(p.MILESTONE_DATE.getTime()<=n){t.left.push(p);}if(p.MILESTONE_DATE.getTime()>n){t.right.push(p);}}if(t.left.length>m&&!t.HAS_MERGE){this._mergeToLeft(t.left);}if(t.right.length>m&&!t.HAS_MERGE){this._mergeToRight(t.right);}t.Milestones=t.left.concat(t.right);}this.setProperty('tasks',s);},getTemplateText:function(t){if(!t){return false;}var s=this;$.extend(t,{TEMPLATE_TEXT:{TASK:s._oRB.getText('MILESTONE_TASK'),START:s._oRB.getText('MILESTONE_START'),END:s._oRB.getText('MILESTONE_END'),INFINITY:s._oRB.getText('MILESTONE_INFINITY')}});},_mergeToLeft:function(a){if(!a){return false;}var l=new this._mileStoneMerge(this);var t=a[0].INDEX;var m=this.controlConfig.maxPoints;var b=this.getProperty('tasks');for(var i=0;i<a.length;i++){if(i<a.length-m){l.MILESTONE_MERGE.push(a[i]);}}l.MILESTONE_DATE=b[t].START_DATE;l.INDEX=t;l.NEXT=b[t].Milestones[a.length-m].NEXT;a[a.length-m].PRE=l.MILESTONE_DATE;a.splice(0,a.length-m,l);},_mergeToRight:function(a){if(!a){return false;}var r=new this._mileStoneMerge(this);var t=a[0].INDEX;var m=this.controlConfig.maxPoints;var b=this.getProperty('tasks');for(var i=0;i<a.length;i++){if(i+1>m){r.MILESTONE_MERGE.push(a[i]);}}r.MILESTONE_DATE=b[t].END_DATE;r.INDEX=t;r.NEXT=b[t].Milestones[a.length-m].NEXT;r.PRE=a[m-1].MILESTONE_DATE;a.splice(m,a.length-m,r);},_getTextWidth:function(t,a){var b=this.controlConfig;var a=a||b.fontSizeM;var s=document.createElement("span");document.body.appendChild(s);var d=c.select(s).append("svg");var e=d.append("text").text(t).attr("style","font-size:"+a+"px");var B=e.node().getBBox();s.parentNode.removeChild(s);return B.width>b.milestoneMaxLength?b.milestoneMaxLength:Math.round(B.width);},drawMileStone:function(){var a=new Array();var t=this.getProperty('tasks');var w=this.controlConfig.width;var h=this.controlConfig.height;var m=this.controlConfig.minWidth;if(w<m){return false;}if(!t||!t.length){return false;}for(var i=0;i<t.length;i++){a.push(t[i].TASK_NAME);}this.categories=a;this.makeGant(t,w,h);},makeGant:function(t,p,a){var b=this.controlConfig;var d=b.barHeight;var g=b.gap;var e=b.topPadding;var s=b.sidePadding;this.drawRects(t,g,e,s,d,p,a);this.vertLabels(g,e);},drawRects:function(t,a,b,e,f,w,h){var s=this.svg;var g=this;var j=this.timeScale;var n=this.nowTime;var l=this.controlConfig;var D=sap.ui.core.format.DateFormat.getDateInstance({style:"medium"});var m=c.max(t,function(d){return d.END_DATE;});var o=c.min(t,function(d){return d.START_DATE;});if(!s||!s.length){return false;}var p=s.append("g").selectAll(".bar").data(t).enter().append("rect");var r=s.append('g').selectAll(".bar").data(t).enter();if(n<m&&n>o){var q=r.append('line').attr('class','now').attr('x1',function(){var d=n<m?n:m;return j(new Date(d))+e;}).attr('y1',b).attr('x2',function(){var d=n<m?n:m;return j(new Date(d))+e;}).attr('y2',function(){return t.length*l.gap+b+15;}).attr('stroke','#'+l.defaultThemeColor);var u=r.append('text').text(function(){var T=D.format(new Date(n));return g._oRB.getText('MILESTONE_TODAY')+': '+T;}).attr('class','now-date').attr('x',function(){var d=n<m?n:m;return j(new Date(d))+e;}).attr('y',function(){return t.length*90+b+15;}).attr("font-size",l.fontSizeX).attr("text-height",f).attr("fill",'#'+l.defaultThemeColor).attr('text-anchor',function(){var i=j(new Date(m))-j(new Date(n));var d=this.textContent.length*l.fontSizeX;if(i-d>0){return'start';}return'end';});}var v=r.append('g').attr('class','points').selectAll(".point").data(function(d){return d.Milestones;}).enter();var x=v.append('rect').attr("x",function(d){return j(d.MILESTONE_DATE)+e+10;}).attr("y",function(d,i){var H=d.INDEX*a+b+f+l.fontSizeM*1.4;var I=true;if(d.INDEX>0){H=g.getLineGapYAxis(d.INDEX,H,t);}return g.setPointYAxis(d,i,H,I)-l.fontSizeM+2;}).attr('width',function(d){if(d.MILESTONE_IS_MERGE){return 12;}var i=g._getTextWidth(d.MILESTONE_NAME,l.fontSizeM);return j(m)-j(d.MILESTONE_DATE)<i?j(m)-j(d.MILESTONE_DATE):i;}).attr('height',function(){return l.fontSizeM;}).attr("fill",'#FFFFFF');var y=v.append('text').attr('class','point-text').text(function(d){if(l.width<l.minWidth){return'...';}if(!d.NEXT){return d.MILESTONE_NAME;}var i=j(m)-j(d.MILESTONE_DATE);var H=g._getTextWidth(d.MILESTONE_NAME,l.fontSizeM)+15;if(i<H){var I=Math.round(g._getTextWidth(d.MILESTONE_NAME,l.fontSizeM)/d.MILESTONE_NAME.length);var J=Math.floor(i/I);if(d.MILESTONE_NAME.length>J+8){var K=J+8;var L=d.MILESTONE_NAME.slice(0,K);return L+'...';}else{var L=d.MILESTONE_NAME;return L;}}if(d.MILESTONE_NAME.length<=l.milestoneNameMaxFactorLength){return d.MILESTONE_NAME;}else{var L=d.MILESTONE_NAME.slice(0,l.milestoneNameMaxFactorLength-1);return L+'...';}}).attr("x",function(d){return j(d.MILESTONE_DATE)+e+10;}).attr("y",function(d,i){var H=d.INDEX*a+b+f+l.fontSizeM*1.4;if(d.INDEX>0){H=g.getLineGapYAxis(d.INDEX,H,t);}d.yAxis=g.setPointYAxis(d,i,H);return d.yAxis;}).attr("font-size",function(d){return d.MILESTONE_IS_MERGE?l.fontSizeX:l.fontSizeM;}).attr("text-anchor","start").attr("text-height",f).attr("fill",function(d){return d.MILESTONE_IS_MERGE?'#'+l.defaultThemeColor:'#'+l.defaultFontColor;});var z=v.append('rect').attr('class','point').attr('rx',2).attr('ry',2).attr('width',10).attr('height',10).attr("x",function(d){return j(d.MILESTONE_DATE)+e;}).attr("y",function(d){return d.yAxis-l.fontSizeM;}).attr("fill",function(d){return'#'+d.MILESTONE_COLOR_CODE;}).attr("stroke","none").attr('transform',function(){return'rotate(45 '+this.getAttribute('x')+' '+this.getAttribute('y')+')';});var A=r.append("rect").attr('class','backgroundBar').attr("rx",10).attr("ry",10).attr("x",l.sidePadding).attr("y",function(d,i){var H=i*a+b;if(i>0){H=g.getLineGapYAxis(i,H,t);}return H;}).attr("width",function(){return j(m);}).attr("height",f).attr("stroke","none").attr("fill",'#'+l.defaultBgColor);var B=r.append("rect").attr('class','bar').attr("rx",10).attr("ry",10).attr("x",function(d){return j(d.START_DATE)+e;}).attr("y",function(d,i){var H=i*a+b;if(i>0){H=g.getLineGapYAxis(i,H,t);}return H;}).attr("width",function(d){return j(d.END_DATE)-j(d.START_DATE);}).attr("height",f).attr("stroke","none").attr("fill",function(d){return'#'+(d.TASK_COLOR_CODE||l.defaultBarColor);});var E=r.append('rect').attr('class','passed').attr("rx",10).attr("ry",10).attr("x",function(d){return j(d.START_DATE)+e;}).attr("y",function(d,i){var H=i*a+b;if(i>0){H=g.getLineGapYAxis(i,H,t);}return H;}).attr("width",function(d){var i=j(d.END_DATE);var H=j(new Date(n));var I=H<i?H:i;var J=I-j(d.START_DATE)>0?I-j(d.START_DATE):0;return J;}).attr("height",f).attr("stroke","none").attr("fill","#ffffff").attr('opacity',0.5);if(n<m&&n>o){var F=r.append('line').attr('class','now').attr('x1',function(){var d=n<m?n:m;return j(new Date(d))+e;}).attr("y1",function(d,i){var H=i*a+b;if(i>0){H=g.getLineGapYAxis(i,H,t);}return H;}).attr('x2',function(){var d=n<m?n:m;return j(new Date(d))+e;}).attr("y2",function(d,i){var H=i*a+b;if(i>0){H=g.getLineGapYAxis(i,H,t);}return H+f;}).attr('stroke','#'+l.defaultThemeColor);}if(n<m&&n>o){q.attr('y2',function(){var G=t.length*a+b+20;for(var k=0;k<t.length;k++){G+=t[k].LINEGAP;}return G;});u.attr('y',function(){var G=t.length*a+b+20;for(var k=0;k<t.length;k++){G+=t[k].LINEGAP;}return G;});}var G=t.length*a+b;for(var k=0;k<t.length;k++){G+=t[k].LINEGAP;}s.attr('height',G+l.bottomPadding);B.on('mouseenter',this.showPopUp).on('mouseleave',this.hidePopUp);E.on('mouseenter',this.showPopUp).on('mouseleave',this.hidePopUp);z.on('click',this.showMileStone);c.select('.mile-stone-screen-cover').on('click',this.hideMileStone);},getLineGapYAxis:function(i,n,t){var a=n;for(var j=i-1;j>=0;j--){a+=t[j].LINEGAP;}return a;},setPointYAxis:function(o,i,n,a){var t=this.getProperty('tasks');var b=this.timeScale;var d=this.controlConfig;var p=b(o.MILESTONE_DATE)-b(o.PRE);var e=n;var f=t[o.INDEX].Milestones[i-1]||undefined;var g=f?f.yAxis:e;o.yAxis=e;if(f&&p<this._getTextWidth(f.MILESTONE_NAME,d.fontSizeM)+15){o.yAxis=g+d.fontSizeM*1.4;if(a){for(var k=i-1;k>=0;k--){if(t[o.INDEX].Milestones[k].yAxis>=o.yAxis){continue;}else{t[o.INDEX].LINEGAP+=d.fontSizeM*1.4;break;}}}}return o.yAxis;},vertLabels:function(t,a){var p=0;var s=this.svg;var b=this.getProperty('tasks');var d=this.categories;var e=this.controlConfig;var f=[];for(var i=0;i<d.length;i++){var l=false;if(d[i].length>e.labelMaxLength){f=d[i].split(" ")||[];for(var k=0;k<f.length;k++){if(f[k+1]){var g=f[k]+" "+f[k+1];if(g.length<e.labelMaxLength){f[k]=f[k]+" "+f[k+1];f.splice(k+1,1);k--;}}}l=true;}var h=i*t+a+15;if(i>0){for(var j=i-1;j>=0;j--){h+=b[j].LINEGAP;}}if(l){var m=this.svg.append("g").append("text").attr('class','milestone-label').attr("font-size",e.fontSizeM).attr("text-anchor","start").attr("text-height",e.fontSizeX).attr('fill','#'+e.defaultFontColor);var L=f.length;if(L>3){f=f.slice(0,3);f[2]+='...';}for(var k=0;k<L;k++){m.append("tspan").text(f[k]).attr("x",20).attr("y",h+k*e.fontSizeX);}}else{var m=this.svg.append("g").append("text").text(d[i]).attr('class','milestone-label').attr("font-size",e.fontSizeM).attr("text-anchor","start").attr("text-height",e.fontSizeX).attr('fill','#'+e.defaultFontColor).attr("x",20).attr("y",h);}}},showPopUp:function(){var d=sap.ui.core.format.DateFormat.getDateInstance({style:"medium"});var a=c.select(this).data()[0];var o=document.getElementsByClassName("mile-stone-tag")[0];if(o.style.display==="block"){return false;}var x=(this.x.animVal.value+this.width.animVal.value/2)+"px";var y=this.y.animVal.value+40+"px";var s,e;switch(a.DATE_TYPE_CODE){case'MONTH':s=a.START_MONTH+'  '+a.START_YEAR;e=a.END_MONTH+'  '+a.END_YEAR;break;case'YEAR':s=a.START_YEAR;e=a.END_YEAR;break;case'DAY':s=d.format(a.START_DATE);e=d.format(a.END_DATE);break;case'QUARTER':s=a.START_QUARTER+'  '+a.START_YEAR;e=a.END_QUARTER+'  '+a.END_YEAR;break;default:break;}if(a.IS_INFINITY){e=a.TEMPLATE_TEXT.INFINITY;}var t="<span class='mile-stone-task'>"+a.TEMPLATE_TEXT.TASK+a.TASK_NAME+"</span>"+"<br/>"+"<span class='mile-stone-task'>"+a.TEMPLATE_TEXT.START+s+"</span>"+"<br/>"+"<span class='mile-stone-task'>"+a.TEMPLATE_TEXT.END+e+"</span>";o.innerHTML=t;o.style.top=y;o.style.left=x;o.style.display="block";c.select('.svg-content').on('click',this.hideMileStone);},hidePopUp:function(){var o=document.getElementsByClassName("mile-stone-tag")[0];if(o.style.display==="none"){return false;}o.style.display="none";},showMileStone:function(){var t,d=c.select(this).data()[0];var D=sap.ui.core.format.DateFormat.getDateInstance({style:"medium"});var o=document.getElementsByClassName("mile-stone")[0];if(o.style.display==="block"){return false;}var x=(this.x.animVal.value+this.width.animVal.value/2)+"px";var y=this.y.animVal.value+40+"px";var m;if(!d.MILESTONE_MERGE||!d.MILESTONE_MERGE.length){switch(d.DATE_TYPE_CODE){case'MONTH':m=d.MILESTONE_MONTH+'  '+d.MILESTONE_YEAR;break;case'YEAR':m=d.MILESTONE_YEAR;break;case'DAY':m=D.format(d.MILESTONE_DATE);break;case'QUARTER':m=d.MILESTONE_QUARTER+'  '+d.MILESTONE_YEAR;break;default:break;}t="<p><span class='tag-point' style='background:#"+d.MILESTONE_COLOR_CODE+"'></span><span style='color:#"+d.MILESTONE_COLOR_CODE+"'>"+m+"</span></p>"+"<p class='mile-stone-date'>"+d.MILESTONE_NAME+"</p>";}if(d.Attachment&&d.Attachment.length){for(var i=0;i<d.Attachment.length;i++){t+='<a class="mile-stone-attachment" target="_blank" rel="'+d.Attachment[i].LABEL+'" href="'+d.Attachment[i].ATTACHMENT_URL+'">'+d.Attachment[i].LABEL+'</a>';}}if(d.MILESTONE_MERGE&&d.MILESTONE_MERGE.length){t='';for(var i=0;i<d.MILESTONE_MERGE.length;i++){switch(d.MILESTONE_MERGE[i].DATE_TYPE_CODE){case'MONTH':m=d.MILESTONE_MERGE[i].MILESTONE_MONTH+'  '+d.MILESTONE_MERGE[i].MILESTONE_YEAR;break;case'YEAR':m=d.MILESTONE_MERGE[i].MILESTONE_YEAR;break;case'DAY':m=D.format(d.MILESTONE_MERGE[i].MILESTONE_DATE);break;case'QUARTER':m=d.MILESTONE_MERGE[i].MILESTONE_QUARTER+'  '+d.MILESTONE_MERGE[i].MILESTONE_YEAR;break;default:break;}t+="<p><span class='tag-point' style='background:#"+d.MILESTONE_MERGE[i].MILESTONE_COLOR_CODE+"'></span><span style='color:#"+d.MILESTONE_MERGE[i].MILESTONE_COLOR_CODE+"'>"+m+"</span></p>"+"<p class='mile-stone-date'>"+d.MILESTONE_MERGE[i].MILESTONE_NAME+"</p>";if(d.MILESTONE_MERGE[i].Attachment&&d.MILESTONE_MERGE[i].Attachment.length){t+='<a class="mile-stone-attachment" target="_blank" rel="'+d.MILESTONE_MERGE[i].Attachment[0].LABEL+'" href="'+d.MILESTONE_MERGE[i].Attachment[0].ATTACHMENT_URL+'">'+d.MILESTONE_MERGE[i].Attachment[0].LABEL+'</a>';}}}o.innerHTML=t;o.style.top=y;o.style.left=x;o.style.display="block";c.select('.mile-stone-screen-cover').style({'display':'block'});},hideMileStone:function(){var o=document.getElementsByClassName("mile-stone")[0];if(o.style.display==="none"){return false;}o.style.display="none";c.select('.mile-stone-screen-cover').style({'display':'none'});},renderer:function(r,o){r.write('<div');r.addClass('mile-stone-container');r.writeClasses();r.write('>');r.write('<div');r.addClass('mile-stone-svg');r.writeClasses();r.write('>');r.write("</div>");r.write('<div');r.addClass('mile-stone-screen-cover');r.writeClasses();r.write('>');r.write("</div>");r.write('<div');r.addClass('mile-stone-tag');r.writeClasses();r.write('>');r.write("</div>");r.write('<div');r.addClass('mile-stone');r.writeClasses();r.write('>');r.write("</div>");r.write("</div>");}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.MobileTextEditor')){jQuery.sap.declare('sap.ino.controls.MobileTextEditor');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.TextArea');jQuery.sap.require('sap.m.Toolbar');jQuery.sap.require('sap.m.ToolbarDesign');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.m.ToggleButton');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.InputBase');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/MobileTextEditor",["sap/ui/core/Control","sap/m/TextArea","sap/m/Toolbar","sap/m/ToolbarDesign","sap/ui/core/IconPool","sap/m/ToggleButton","sap/m/Dialog","sap/m/InputBase","sap/ui/core/ResizeHandler","sap/base/security/sanitizeHTML"],function(C,T,a,b,I,B,D,c,R,s){"use strict";return C.extend("sap.ino.controls.MobileTextEditor",{metadata:{properties:{dialogTitle:{type:"string",defaultValue:""},editable:{type:"boolean",defaultValue:true},enabled:{type:"boolean",defaultValue:true},height:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},minHeight:{type:"sap.ui.core.CSSSize",defaultValue:"1rem"},maxHeight:{type:"sap.ui.core.CSSSize",defaultValue:""},openInDialog:{type:"boolean",defaultValue:false},showToolbar:{type:"boolean",defaultValue:true},showValueStateMessage:{type:"boolean",defaultValue:true},value:{type:"string",defaultValue:""},valueState:{type:"sap.ui.core.ValueState",defaultValue:sap.ui.core.ValueState.None},valueStateText:{type:"string",defaultValue:null},width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"}},aggregations:{"_editorControls":{type:"sap.m.Toolbar",multiple:false,fitContainer:true,visibility:"hidden"},"_dialog":{type:"sap.m.Dialog",multiple:false,visibility:"hidden"}},events:{change:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");this._sResizeRegId=R.register(this,this._onResize);},exit:function(){R.deregister(this._sResizeRegId);},setValue:function(v){this.setProperty("value",v,true);var e=this._getNicEditor();if(!e){jQuery.sap.log.warning("NicEditor not found in method setValue",undefined,"sap.ino.controls.MobileTextEditor");return;}this._getNicEditor().setContent(v||"");},onAfterRendering:function(){this._recalculateHeight();jQuery.sap.require("sap.ino.thirdparty.nicEdit");this._oNicEditor=new nicEditor({buttonList:["bold","italic","underline","ol","ul"]});if(this.getShowToolbar()){this._oNicEditor.addEvent("buttonActivate",jQuery.proxy(this._nicButtonActivate,this));this._oNicEditor.addEvent("buttonDeactivate",jQuery.proxy(this._nicButtonDeactivate,this));}this._oNicEditor.setPanel(this.getId()+"-nicPanel");this._oNicEditor.panelInstance(this.getId()+"-nicContentTA");if(!(this.getEnabled()&&this.getEditable())){this.$().addClass("sapMInputBaseDisabled");this._getNicEditor().disable();}else{if(this.getShowToolbar()){this._oNicEditor.setPanel(this.getId()+"-editorControls");}}},_nicButtonActivate:function(i){this._syncButtonState(i.name,true);},_nicButtonDeactivate:function(i){this._syncButtonState(i.name,false);},_syncButtonState:function(n,t){var o=sap.ui.getCore().byId(this.getId()+"-"+n);o.setPressed(t);},focus:function(){var $=this.$();if(!$){return;}jQuery.sap.focus($.find('.nicEdit-main').first());},onfocusin:function(){this.openValueStateMessage();},onfocusout:function(e){var E=this._getNicEditor();if(!E){return;}var d=E.getContent();this.setProperty("value",d,true);this.closeValueStateMessage();if(this.getEditable()){this.fireChange({value:d});}},ontap:function(e){this._openInDialog();},ontouchmove:function(e){e.setMarked();},_onResize:function(e){e.control._recalculateHeight();},_getNicEditor:function(){return this._oNicEditor&&this._oNicEditor.instanceById(this.getId()+"-nicContentTA");},_recalculateHeight:function(){var i=this._bOpenInDialog;if(i&&(!this.getHeight()||this.getHeight()==="100%")){var p=this.$().parents(".sapMDialog");var h=(p[0].clientHeight-152)/2;if(h>0){this.$().height(h);}}},_openInDialog:function(){if(!this.getOpenInDialog()||this._bOpenInDialog===true){return;}var d=new D({stretch:true,horizontalScrolling:false,verticalScrolling:true,showHeader:true,title:this.getDialogTitle(),beginButton:new B({text:this._oRB.getText("CTRL_MTE_DONE"),press:function(){d.close();}})});var e=new this.constructor({value:this.getValue(),editable:this.getEditable(),enabled:this.getEnabled()}).addStyleClass("sapInoMTEDialog");e._bOpenInDialog=true;this.setAggregation("_dialog",d);d.addContent(e);d.attachAfterOpen(this._onOpenDialog,this);d.attachAfterClose(this._onCloseDialog,this);d.open();},_onCloseDialog:function(e){var d=e.getSource();var v=d.getContent()[0].getValue();this.setAggregation("_dialog",null);d.destroy();this.setValue(v);if(this.getEditable()){this.fireChange({value:v});}},_onOpenDialog:function(e){e.getSource().getContent()[0].focus();},setValueStateText:function(t){this.setProperty("valueStateText",t,true);return this;},setValueState:function(v){this.setProperty("valueState",v,true);var $=this.$();if(!$){return;}var d=$.find(".sapInoMTEContent");d.removeClass("sapMInputBaseErrorInner");d.removeClass("sapMInputBaseSuccessInner");d.removeClass("sapMInputBaseWarningInner");d.removeClass("sapMInputBaseStateInner");var S=this._getStyleClassForValueState();if(S){d.addClass(S);d.addClass("sapMInputBaseStateInner");}return this;},_getStyleClassForValueState:function(){switch(this.getValueState()){case(sap.ui.core.ValueState.Error):return"sapMInputBaseErrorInner";case(sap.ui.core.ValueState.Success):return"sapMInputBaseSuccessInner";case(sap.ui.core.ValueState.Warning):return"sapMInputBaseWarningInner";}},refreshDataState:c.prototype.refreshDataState,propagateMessages:c.prototype.propagateMessages,openValueStateMessage:c.prototype.openValueStateMessage,closeValueStateMessage:c.prototype.closeValueStateMessage,getDomRefForValueStateMessage:c.prototype.getDomRefForValueStateMessage,_getEditorControls:function(e){var t=this;var o=this.getAggregation("_editorControls");if(!o){o=new a({design:b.Solid,content:[new B(this.getId()+"-bold",{press:function(e){t._getNicEditor().nicCommand("Bold");},text:"B"}).addStyleClass("sapInoMTEButton").addStyleClass("sapInoMTEButtonBold"),new B(this.getId()+"-italic",{press:function(e){t._getNicEditor().nicCommand("Italic");},text:"I"}).addStyleClass("sapInoMTEButton").addStyleClass("sapInoMTEButtonItalic"),new B(this.getId()+"-underline",{press:function(e){t._getNicEditor().nicCommand("Underline");},text:"U"}).addStyleClass("sapInoMTEButton").addStyleClass("sapInoMTEButtonUnderline"),new B(this.getId()+"-ol",{press:function(e){t._getNicEditor().nicCommand("insertorderedlist");},icon:I.getIconURI("multi-select")}).addStyleClass("sapInoMTEButton"),new B(this.getId()+"-ul",{press:function(e){t._getNicEditor().nicCommand("insertunorderedlist");},icon:I.getIconURI("menu")}).addStyleClass("sapInoMTEButton")]});this.setAggregation("_editorControls",o,true);}return o;},renderer:function(r,o){r.write("<div ");r.writeControlData(o);r.addClass("sapInoMTE");r.writeClasses();r.write(">");r.write("<div");r.writeAttribute("id",s(o.getId())+"-nicPanel");r.addClass("sapInoMTENicPanel");r.writeClasses();r.write("/>");if(o.getShowToolbar()){r.write("<div");r.writeAttribute("id",s(o.getId())+"-editorControls");r.writeAttribute("role","toolbar");r.writeAttributeEscaped("aria-label",o._oRB.getText("CRTL_MTE_TOOLBAR_LABEL"));r.addClass("sapInoMTEControls");r.writeClasses();r.write(">");r.renderControl(o._getEditorControls());r.write("</div>");}r.write("<div");r.writeAttribute("id",s(o.getId())+"-nicContent");r.addClass("sapInoMTEContent");r.addClass("sapMInputBaseInner");r.addClass("sapMTextAreaInner");if(!(o.getEnabled()&&o.getEditable())){r.addClass("sapMInputBaseDisabledInner");}r.writeClasses();r.addStyle("width",s(o.getWidth()));r.addStyle("height",s(o.getHeight()));if(o.getMinHeight()){r.addStyle("min-height",s(o.getMinHeight()));}if(o.getMaxHeight()){r.addStyle("max-height",s(o.getMaxHeight()));}r.writeStyles();r.write(">");r.write("<textarea");r.writeAttribute("id",s(o.getId())+"-nicContentTA");r.addClass("sapInoMTEContent");r.addClass("sapMInputBaseInner");r.writeClasses();r.writeStyles();r.write(">");r.writeEscaped(o.getValue());r.write("</textarea>");r.write("</div>");r.write("</div>");}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.NoticeSegmentedButton')){jQuery.sap.declare('sap.ino.controls.NoticeSegmentedButton');jQuery.sap.require('sap.m.SegmentedButton');jQuery.sap.require('sap.ui.core.library');sap.ui.define("sap/ino/controls/NoticeSegmentedButton",["sap/m/SegmentedButton","sap/ui/core/library"],function(S,c){"use strict";var T=c.TextDirection;return S.extend("sap.ino.controls.NoticeSegmentedButtonItem",{renderer:function(r,C){var b=C.getButtons(),s=C.getSelectedButton(),B,t,a,d;if(C._bInOverflow){r.write("<div");r.writeControlData(C);r.writeClasses();r.write(">");r.renderControl(C.getAggregation("_select"));r.write("</div>");return;}r.write("<ul");if(this._addAllIconsClass(b)){r.addClass("sapMSegBIcons");}r.addClass("sapMSegB");r.writeClasses();if(C.getWidth()&&C.getWidth()!==''){r.addStyle('width',C.getWidth());}r.writeStyles();r.writeControlData(C);t=C.getTooltip_AsString();if(t){r.writeAttributeEscaped("title",t);}r.writeAccessibilityState(C,{role:"radiogroup"});r.write(">");var I=C.getItems();for(var i=0;i<b.length;i++){B=b[i];var e=false,f;jQuery.each(I,function(l,m){if(B.getId().indexOf(m.getId())>-1){e=m.getDisplayNotice()?true:false;f=m.getTextVisible()?true:false;}});r.write("<li");if(!f){r.addClass("sapInoBtnNarrowWidth");}else{r.addClass("sapInoBtnExpandWidth");}if(B.getVisible()){var g=B.getText(),o=B.getIcon(),h="",k;if(o){k=B._getImage((B.getId()+"-img"),o);if(k instanceof sap.m.Image){C._overwriteImageOnload(k);}else if(!B.getTooltip()){h=C._getIconAriaLabel(k);}}r.writeControlData(B);r.writeAttribute("aria-posinset",i+1);r.writeAttribute("aria-setsize",b.length);r.addClass("sapMSegBBtn");r.addClass("sapInoButtonLi");if(B.aCustomStyleClasses!==undefined&&B.aCustomStyleClasses instanceof Array){for(var j=0;j<B.aCustomStyleClasses.length;j++){r.addClass(B.aCustomStyleClasses[j]);}}if(B.getEnabled()){r.addClass("sapMSegBBtnFocusable");}else{r.addClass("sapMSegBBtnDis");}if(s===B.getId()){r.addClass("sapMSegBBtnSel");}if(o&&g!==''){}r.writeClasses();a=B.getWidth();if(a){r.addStyle('width',a);r.writeStyles();}t=B.getTooltip_AsString();if(t){r.writeAttributeEscaped("title",t);}r.writeAttribute("tabindex",B.getEnabled()?"0":"-1");d=B.getTextDirection();if(d!==T.Inherit){r.writeAttribute("dir",d.toLowerCase());}r.writeAccessibilityState(B,{role:"radio",checked:s===B.getId()});if(k&&h!==""){if(g!==""){h+=" "+g;}else{r.writeAttributeEscaped("title",h);}r.writeAttributeEscaped("aria-label",h);}r.write('>');r.write("<div");r.addClass("sapInoTextWithoutBorder");r.writeClasses();r.write(">");if(o&&k){r.renderControl(k);}r.write("<div");r.addClass("sapInoSegBtnText");if(!f){r.addClass("sapInoSegBtnTextInVisible");}r.writeClasses();r.write(">");if(g!==''){r.writeEscaped(g,false);}r.write("</div>");r.write("</div>");if(e){r.write("<div");r.addClass("sapInoDisplayNoticePoint");r.writeClasses();r.write(">");r.write("</div>");}r.write("</li>");}else{r.writeInvisiblePlaceholderData(B);r.write('>');r.write("</li>");}}r.write("</ul>");},_addAllIconsClass:function(b){for(var i=0;i<b.length;i++){if(!b[i].getIcon()){return false;}}return true;}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.NoticeSegmentedButtonItem')){jQuery.sap.declare('sap.ino.controls.NoticeSegmentedButtonItem');jQuery.sap.require('sap.m.SegmentedButtonItem');sap.ui.define("sap/ino/controls/NoticeSegmentedButtonItem",["sap/m/SegmentedButtonItem"],function(S){"use strict";return S.extend("sap.ino.controls.NoticeSegmentedButtonItem",{metadata:{properties:{displayNotice:{type:"boolean",default:false},textVisible:{type:"boolean",default:false}}}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.NotificationHeadItem')){jQuery.sap.declare('sap.ino.controls.NotificationHeadItem');jQuery.sap.require('sap.ui.unified.ShellHeadItem');sap.ui.define("sap/ino/controls/NotificationHeadItem",["sap/ui/unified/ShellHeadItem"],function(S){"use strict";return S.extend("sap.ino.controls.NotificationHeadItem",{metadata:{properties:{notificationCount:{type:"string"}}},setNotificationCount:function(c){if(c){this.setProperty("notificationCount",c,true);}return this._refreshIcon();},_refreshIcon:function(){var i=S.prototype._refreshIcon.apply(this,arguments);var c=this.getNotificationCount();if(c===undefined){return i;}var C=parseInt(c,10);if(jQuery("#notificationCount").length===0&&C===0){return i;}if(jQuery("#notificationCount").length===0&&C>0){this.$().append("<div id='notificationCount'/>");}if(C>0){jQuery("#notificationCount").addClass("sapInoNotificationCount");jQuery("#notificationCount").text(c);}else{jQuery("#notificationCount").remove();}return i;}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.ObjectPageSubSectionEnhance')){jQuery.sap.declare('sap.ino.controls.ObjectPageSubSectionEnhance');jQuery.sap.require('sap.uxap.ObjectPageSubSection');jQuery.sap.require('sap.m.Label');sap.ui.define("sap/ino/controls/ObjectPageSubSectionEnhance",["sap/uxap/ObjectPageSubSection","sap/m/Label"],function(O,L){"use strict";return O.extend("sap.ino.controls.ObjectPageSubSectionEnhance",{metadata:{properties:{displayNewFlag:{type:"boolean",default:false}}},renderer:function(r,c){var a,h,H,b,u,d;if(!c.getVisible()||!c._getInternalVisible()){return;}a=c.getActions()||[];b=a.length>0;h=(c._getInternalTitleVisible()&&(c.getTitle().trim()!==""));H=h||b;d=c._hasVisibleActions();r.write("<div ");r.writeAttribute("role","region");r.writeControlData(c);r.addClass("sapUxAPObjectPageSubSection");r.addClass("ui-helper-clearfix");r.writeClasses(c);r.writeClasses();r.write(">");if(H){r.write("<div");r.addClass("sapUxAPObjectPageSubSectionHeader");if(!h&&!d){r.addClass("sapUiHidden");}u=c._getUseTitleOnTheLeft();if(u&&c._onDesktopMediaRange()){r.addClass("titleOnLeftLayout");}r.writeAttributeEscaped("id",c.getId()+"-header");r.writeClasses();r.write(">");r.write("<div");if(h){r.writeAttribute("role","heading");r.writeAttribute("aria-level",c._getARIALevel());}r.addClass('sapUxAPObjectPageSubSectionHeaderTitle');if(c.getTitleUppercase()){r.addClass("sapUxAPObjectPageSubSectionHeaderTitleUppercase");}r.writeAttributeEscaped("id",c.getId()+"-headerTitle");r.writeClasses();r.writeAttribute("data-sap-ui-customfastnavgroup",true);r.write(">");if(h){r.writeEscaped(c.getTitle());}r.write("</div>");if(b){r.write("<div");r.addClass('sapUxAPObjectPageSubSectionHeaderActions');r.writeClasses();r.writeAttribute("data-sap-ui-customfastnavgroup",true);r.write(">");a.forEach(r.renderControl);r.write("</div>");}r.write("</div>");}r.write("<div");r.addClass("ui-helper-clearfix");r.addClass("sapUxAPBlockContainer");r.addClass("sapUxAPBlockContainer"+c._getMediaString());r.writeClasses();if(c._isHidden){r.addStyle("display","none");}r.writeStyles();r.write(">");r.renderControl(c._getGrid());r.write("<div");r.addClass("sapUxAPSubSectionSeeMoreContainer");r.writeClasses();r.write(">");r.renderControl(c._getSeeMoreButton());r.write("</div>");r.write("</div>");r.write("</div>");}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.OrientationType')){jQuery.sap.declare("sap.ino.controls.OrientationType");(function(){"use strict";sap.ino.controls.OrientationType={PORTRAIT:0,LANDSCAPE:1};})();};if(!jQuery.sap.isDeclared('sap.ino.controls.ProcessIndicator')){jQuery.sap.declare('sap.ino.controls.ProcessIndicator');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.FlexBox');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/ProcessIndicator",["sap/ui/core/Control","sap/m/Label","sap/m/Text","sap/m/FlexBox","sap/ui/core/Icon","sap/base/security/sanitizeHTML"],function(C,L,T,F,I,s){"use strict";var P=C.extend("sap.ino.controls.ProcessIndicator",{metadata:{properties:{currentStep:{type:"int",defaultValue:0},isDraft:{type:"boolean",defaultValue:false},phase:{type:"string"},processSteps:{type:"int",defaultValue:6},processStopped:{type:"boolean",defaultValue:false},renderProcessFirst:{type:"boolean",defaultValue:false},status:{type:"string"},statusColor:{type:"string"},width:{type:"sap.ui.core.CSSSize",defaultValue:"160px"},displaySvg:{type:"boolean",defaultValue:true},displayStatus:{type:"boolean",defaultValue:true},visibleNewFlag:{type:"boolean",defaultValue:false}},aggregations:{"_status":{type:"sap.m.FlexBox",multiple:false,visibility:"hidden"},"_phase":{type:"sap.m.FlexBox",multiple:false,visibility:"hidden"}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");if(sap.ui.core.Control.prototype.init){sap.ui.core.Control.prototype.init.apply(this,arguments);}},_getPhase:function(){var p=this.getAggregation("_phase");if(!p){p=new F({items:[this._getPhaseLabel(),this._getPhaseText()],alignItems:"Start",justifyContent:"Start",alignContent:"Start"}).addStyleClass("sapInoProcessIndicatorPhase");this.setAggregation("_phase",p);}return p;},_getStatus:function(){var S=this.getAggregation("_status");if(!S){S=new F({items:[this._getStatusLabel(),this._getStatusText(),this._getStatusNewIcon()],alignItems:"Start",justifyContent:"Start",alignContent:"Start"}).addStyleClass("sapInoProcessIndicatorStatus");this.setAggregation("_status",S);}return S;},_getPhaseLabel:function(){var p=this.getProperty("phase");if(this.getProperty("isDraft")){p="";}return new L({text:this._oRB.getText("CTRL_PROCESSINDICATOR_FLD_PHASE_LABEL"),tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_PHASE_TOOLTIP",p)}).addStyleClass("sapInoProcessIndicatorPhaseLabel");},_getPhaseText:function(){var p=this.getProperty("phase");if(this.getProperty("isDraft")){p="";}return new T({text:p,tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_PHASE_TOOLTIP",p)}).addStyleClass("sapInoProcessIndicatorPhaseText");},_getStatusLabel:function(){var S=this.getProperty("status");return new L({text:this._oRB.getText("CTRL_PROCESSINDICATOR_FLD_STATUS_LABEL"),tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_STATUS_TOOLTIP",S)}).addStyleClass("sapInoProcessIndicatorStatusLabel");},_getStatusNewIcon:function(){return new I({tooltip:this._oRB.getText("CTRL_IDEA_OBJECT_LATEST_UPDATE_NEW"),visible:this.getProperty("visibleNewFlag"),src:"sap-icon://InoIcons/idea-news"}).addStyleClass("sapInoIdeaLatestUpdateNewIcon");},_getStatusText:function(){var S=this.getProperty("status");return new T({text:S,tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_STATUS_TOOLTIP",S)}).addStyleClass("sapInoProcessIndicatorStatusText");},_renderInfoText:function(r,c,R){if(R&&!c.getProperty("isDraft")&&this.getProperty("phase")){r.renderControl(c._getPhase());}if((R||c.getProperty("isDraft"))&&this.getProperty("status")&&c.getDisplayStatus()){r.renderControl(c._getStatus());}},renderer:function(r,c){var S=c.getProperty("processSteps");var a=c.getProperty("currentStep");var w=s(c.getProperty("width").replace("px",""));var R=false;if(c.getProperty("phase")||c.getProperty("status")){R=true;}var d=12;var f=d/2;var b=d/2;if(R){b=d/2;f=d/2;}var l=d/2.5;var e=0;if(S>=2){e=(w-b*2)/(S-1);}var p=((a<0)?0:a*e);if(a>=S){p=w;}function g(x,y,w,H,m){r.write("<rect");r.writeAttributeEscaped("x",x);r.writeAttributeEscaped("y",y-H/2);r.writeAttributeEscaped("width",w+"px");r.writeAttributeEscaped("height",H+"px");r.addClass(m);r.writeClasses();r.write("/>");}function h(x,y,m,n){r.write("<circle");r.writeAttributeEscaped("cx",x);r.writeAttributeEscaped("cy",y);r.writeAttributeEscaped("r",m);r.addClass(n);r.writeClasses();r.write("/>");}r.write("<div");r.writeControlData(c);r.addStyle("width",w+"px");r.addStyle("overflow","hidden");r.writeStyles();r.writeClasses();if(c.getProperty('phase')&&c.getProperty('status')){r.writeAttributeEscaped("title",c._oRB.getText("CTRL_PROCESSINDICATOR_ALT_NOTE",[c.getProperty('phase'),c.getProperty('status')]));}else if(c.getProperty('phase')&&!c.getProperty('status')){r.writeAttributeEscaped("title",c._oRB.getText("CTRL_PROCESSINDICATOR_ALT_NOTE_WITHOUT_STATUS",[c.getProperty('phase')]));}else if(!c.getProperty('phase')&&c.getProperty('status')){r.writeAttributeEscaped("title",c._oRB.getText("CTRL_PROCESSINDICATOR_ALT_NOTE_WITHOUT_PHASE",[c.getProperty('status')]));}r.write(">");r.write("<span style=\"position:absolute;clip:rect(1px,1px,1px,1px)\">");if(c.getProperty('phase')&&c.getProperty('status')){r.writeEscaped(c._oRB.getText("CTRL_PROCESSINDICATOR_ALT_NOTE",[c.getProperty('phase'),c.getProperty('status')]));}else if(c.getProperty('phase')&&!c.getProperty('status')){r.writeEscaped(c._oRB.getText("CTRL_PROCESSINDICATOR_ALT_NOTE_WITHOUT_STATUS",[c.getProperty('phase')]));}else if(!c.getProperty('phase')&&c.getProperty('status')){r.writeEscaped(c._oRB.getText("CTRL_PROCESSINDICATOR_ALT_NOTE_WITHOUT_PHASE",[c.getProperty('status')]));}r.write("</span>");if(c.getDisplaySvg()){r.write("<svg");r.writeAttribute("focusable","false");r.addStyle("width",w+"px");r.addStyle("height",d+"px");r.writeStyles();r.writeClasses();r.write(">");var j="sapInoProcessIndicatorActive";if(c.getProcessStopped()){j="sapInoProcessIndicatorStopped";}if(S>1){g(b,f,p,l,j);g(b+p,f,w-p-d,l,"sapInoProcessIndicatorInactive");}for(var i=0;i<S;i++){var x=i*e+b;var k=j;if(i>a||c.getProperty("isDraft")){k="sapInoProcessIndicatorInactive";}h(x,f,d/2,k);}r.write("</svg>");}if(!c.getRenderProcessFirst()){c._renderInfoText(r,c,R);}if(c.getRenderProcessFirst()){c._renderInfoText(r,c,R);}r.write("</div>");},onAfterRendering:function(){var S=this.getModel("object")?this.getModel("object").getProperty("/STATUS_COLOR"):null||this.getProperty("statusColor");if(S&&S.length===6){S="#"+S;}else{S="#333333";}if(this.getModel("object")){$(".sapInoProcessIndicatorStatusText").css('color',S);}else{if(this.getDomRef()){$(this.getDomRef()).find('.sapInoProcessIndicatorStatusText').css("color",S);}}}});P.prototype.bindProperty=function(k,b){C.prototype.bindProperty.apply(this,arguments);switch(k){case"status":var S=this._getStatus().getItems()[1];S.bindProperty("text",b);break;case"phase":C.prototype.bindProperty.apply(this,arguments);var p=this._getPhase().getItems()[1];p.bindProperty("text",b);break;default:break;}};P.prototype.setVisibleNewFlag=function(v){this.setProperty("visibleNewFlag",v);var S=this._getStatus().getItems()[2];S.setVisible(v);};P.prototype.setStatus=function(v){this.setProperty("status",v);var S=this._getStatus().getItems()[0];S.setText(this._oRB.getText("CTRL_PROCESSINDICATOR_FLD_STATUS_LABEL",v));S.setTooltip(this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_STATUS_TOOLTIP",v));var o=this._getStatus().getItems()[1];o.setText(v);};P.prototype.setPhase=function(v){this.setProperty("phase",v);var p=this._getPhase().getItems()[0];p.setText(this._oRB.getText("CTRL_PROCESSINDICATOR_FLD_PHASE_LABEL",v));p.setTooltip(this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_PHASE_TOOLTIP",v));var o=this._getPhase().getItems()[1];o.setText(v);};return P;});};if(!jQuery.sap.isDeclared('sap.ino.controls.QuickViewGroupDimension')){jQuery.sap.declare('sap.ino.controls.QuickViewGroupDimension');jQuery.sap.require('sap.m.QuickViewGroup');sap.ui.define("sap/ino/controls/QuickViewGroupDimension",["sap/m/QuickViewGroup"],function(Q){"use strict";return Q.extend("sap.ino.controls.QuickViewGroupDimension",{metadata:{properties:{dimensionTitle:{type:"string",defaultValue:""},headingIcon:{type:"string",defaultValue:""},totalPoints:{type:"int",defaultValue:""},pointsToNextLevel:{type:"int",defaultValue:""},currentPointsBWBadge:{type:"int",defaultValue:""},diffPointsToNextLevel:{type:"int",defaultValue:""},startLevel:{type:"string",defaultValue:""},nextLevel:{type:"string",defaultValue:""},dimensionUnit:{type:"string",defaultValue:""},redeemPoints:{type:"int",default:""},redeemEnabled:{type:"boolean",defaultValue:false},showOnlyDimension:{type:"boolean",defaultValue:false}}}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.QuickViewPageEnhance')){jQuery.sap.declare('sap.ino.controls.QuickViewPageEnhance');jQuery.sap.require('sap.m.QuickViewPage');jQuery.sap.require('sap.m.Toolbar');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.m.Title');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.Image');jQuery.sap.require('sap.ui.layout.VerticalLayout');jQuery.sap.require('sap.ui.layout.HorizontalLayout');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.ui.layout.form.SimpleForm');jQuery.sap.require('sap.ui.layout.library');jQuery.sap.require('sap.ui.layout.form.ResponsiveGridLayout');jQuery.sap.require('sap.ui.core.Title');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.ProgressIndicator');jQuery.sap.require('sap.ui.layout.GridData');jQuery.sap.require('sap.ui.layout.Grid');jQuery.sap.require('sap.ui.core.LayoutData');sap.ui.define("sap/ino/controls/QuickViewPageEnhance",["sap/m/QuickViewPage","sap/m/Toolbar","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/ui/core/Icon","sap/m/Title","sap/m/Button","sap/m/Image",'sap/ui/layout/VerticalLayout','sap/ui/layout/HorizontalLayout','sap/m/HBox','sap/m/VBox','sap/ui/layout/form/SimpleForm','sap/ui/layout/library','sap/ui/layout/form/ResponsiveGridLayout','sap/ui/core/Title','sap/m/Label','sap/m/Text',"sap/m/ProgressIndicator","sap/ui/layout/GridData","sap/ui/layout/Grid","sap/ui/core/LayoutData"],function(Q,T,O,a,I,b,B,c,V,H,d,e,S,l,R,C,L,f,P,G,g,h){"use strict";var i=l.form.SimpleFormLayout;return Q.extend("sap.ino.controls.QuickViewPageEnhance",{metadata:{properties:{headerToolBarIcon:{type:"string",group:"Misc",defaultValue:""},headerToolBarText:{type:"string",group:"Misc",defaultValue:""},visibleLeaderBoard:{type:"boolean",defaultValue:false},visibleDimension:{type:"boolean",defaultValue:false}},aggregations:{horizontalBox:{type:"sap.m.HBox"},dimensionGroups:{type:"sap.ino.controls.QuickViewGroupDimension",multiple:true}},events:{navigate:{}}},init:function(){Q.prototype.init.apply(this,arguments);this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_createPage:function(){var t=this;var p=Q.prototype._createPage.apply(this,arguments);if(!this.getVisibleLeaderBoard()){return p;}var o=new c({src:this.getHeaderToolBarIcon()});var j=new b({text:this.getHeaderToolBarText()});var k=new B({icon:"sap-icon://navigation-right-arrow",tooltip:this._oRB.getText("CTRL_GAMIFICATION_NAVIGATION_TO_LEADER_BOARD"),press:function(){t._onNavigateTo();}});o.addStyleClass("sapInoQuickViewPageHeaderImage");j.addStyleClass("sapInoQuickViewPageHeaderText");k.addStyleClass("sapInoQuickViewPageHeaderButton");var m=new T();m.addContent(o);m.addContent(j);m.addContent(new a());m.addContent(k);m.addStyleClass("sapInoQuickViewPageHeaderToolBar");p.setSubHeader(m);p.addStyleClass("sapInoQuickViewPageEnhanceHeader");if(this._mPageContent.header){p.insertContent(this._mPageContent.dimensionForm,1);}else{p.insertContent(this._mPageContent.dimensionForm,0);}return p;},_onNavigateTo:function(){this.fireNavigate();},_createPageContent:function(){var p=Q.prototype._createPageContent.apply(this,arguments);if(!this.getVisibleDimension()){return this._mPageContent;}var D=this._createDimensionForm();this._mPageContent.dimensionForm=D;this._mPageContent=p;return this._mPageContent;},_createDimensionForm:function(){var D=this.getAggregation("dimensionGroups");var o=new g({width:"100%",defaultSpan:"XL12 L12 M12 S12"});if(D){for(var j=0;j<D.length;j++){if(D[j].getVisible()){this._renderDimensionGroup(D[j],o);}}}o.addStyleClass("sapInoDimensionGrid");return o;},_renderDimensionGroup:function(o,j){var v=new e({width:"100%",layoutData:new G({span:"XL12 L12 M12 S12"})});v.addStyleClass("sapInoDimensionVBox");var r=o.getRedeemEnabled();if(o.getHeading()){var t=new L({text:o.getHeading(),tooltip:o.getHeading()});t.addStyleClass("sapInoDimensionTitle");var k=new c({src:o.getHeadingIcon()});if(o.getHeadingIcon()){k.addStyleClass("sapInoDimensionImage");}var m=new d({items:[k,t]});m.addStyleClass("sapInoDimensionHBoxLine sapInoDimensionHBoxHeader");v.addItem(m);}if(!o.getShowOnlyDimension()){var s=this._oRB.getText('CTRL_GAMIFICATION_DIMENSION_TOTAL_POINTS',[o.getDimensionUnit()]);var n=new L({text:s,tooltip:s});var p=new L({text:o.getTotalPoints()});var q=new L({text:":"});var u=new d({items:[n,q,p]});n.addStyleClass("sapInoDimensionLblDesc");p.addStyleClass("sapInoDimensionSmallMarginleft sapInoDimensionNumberText");if(r){var w=this._oRB.getText('CTRL_GAMIFICATION_DIMENSION_TOTAL_REDEEM_POINTS',[o.getDimensionUnit()]);var x=new L({text:w,tooltip:w});var y=new L({text:o.getRedeemPoints()});var z=new L({text:":"});x.addStyleClass("sapInoDimensionSmallMarginleft sapInoDimensionLblReedemDesc");y.addStyleClass("sapInoDimensionSmallMarginleft sapInoDimensionNumberText");u.addItem(x);u.addItem(z);u.addItem(y);}u.addStyleClass("sapInoDimensionHBoxLine sapInoDimensionHBoxTotalPoints");v.addItem(u);if(!r){if(o.getNextLevel()){var A=this._oRB.getText('CTRL_GAMIFICATION_DIMENSION_NEED');var D=this._oRB.getText('CTRL_GAMIFICATION_DIMENSION_TO_NEXT_LEVEL',[o.getDimensionUnit()]);var E=new L({text:A,tooltip:A+o.getPointsToNextLevel()+" "+D});var F=new L({text:o.getPointsToNextLevel(),tooltip:A+o.getPointsToNextLevel()+" "+D});var J=new L({text:D,tooltip:A+o.getPointsToNextLevel()+" "+D});F.addStyleClass("sapInoDimensionSmallMarginleft sapInoDimensionNeedPointsText");J.addStyleClass("sapInoDimensionSmallMarginleft sapInoDimensionLblLevelDesc");var K=new d({items:[E,F,J]});K.addStyleClass("sapInoDimensionHBoxLine");v.addItem(K);}var M;var N=o.getDiffPointsToNextLevel();var U=o.getCurrentPointsBWBadge();if(N>0&&N>U){M=parseInt((U/N*100).toFixed(),10);}else{M=0;}if(!o.getNextLevel()){M=100;}if(o.getStartLevel()||o.getNextLevel()){var W=new P({percentValue:M,state:"Warning"});W.addStyleClass("sapInoDimensionProgressIndicator");v.addItem(W);var X=new L({text:o.getStartLevel()});var Y=new L({text:o.getNextLevel()});var Z=new d({items:[X,Y]});Z.addStyleClass("sapInoDimensionHBoxLine sapInoDimensionHBoxLevel");v.addItem(Z);}}}j.addContent(v);}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.QuickViewPageEnhanceRenderer')){
/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
jQuery.sap.declare('sap.ino.controls.QuickViewPageEnhanceRenderer');jQuery.sap.require('sap.ui.layout.GridData');sap.ui.define("sap/ino/controls/QuickViewPageEnhanceRenderer",["sap/ui/layout/GridData"],function(G){"use strict";var Q={};Q.render=function(r,q){var p=q.getPageContent();r.write("<div");r.addClass("sapMQuickViewPage sapInoMySettingPage");r.writeControlData(q);r.writeClasses();r.write(">");if(p.header){r.renderControl(p.header);}if(p.dimensionForm){var c=p.dimensionForm.getContent();for(var i=0;i<c.length;i++){c[i].setLayoutData(new G({span:"XL5 L5 M12 S12"}));}r.renderControl(p.dimensionForm);}r.renderControl(p.form);r.write("</div>");};return Q;},true);};if(!jQuery.sap.isDeclared('sap.ino.controls.ReportMicroChart')){jQuery.sap.declare('sap.ino.controls.ReportMicroChart');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.suite.ui.microchart.ColumnMicroChart');jQuery.sap.require('sap.suite.ui.microchart.AreaMicroChart');jQuery.sap.require('sap.suite.ui.microchart.ComparisonMicroChart');jQuery.sap.require('sap.suite.ui.microchart.HarveyBallMicroChart');jQuery.sap.require('sap.suite.ui.microchart.RadialMicroChart');sap.ui.define("sap/ino/controls/ReportMicroChart",["sap/ui/core/Control","sap/suite/ui/microchart/ColumnMicroChart","sap/suite/ui/microchart/AreaMicroChart","sap/suite/ui/microchart/ComparisonMicroChart","sap/suite/ui/microchart/HarveyBallMicroChart","sap/suite/ui/microchart/RadialMicroChart"],function(C,c,A,d,H,R){"use strict";var m=["Good","Error","Critical","Neutral"];return C.extend("sap.ino.controls.ReportMicroChart",{metadata:{properties:{chartType:{type:"string",defaultValue:"Column"}},aggregations:{_chart:{multiple:false,visibility:"hidden"}},events:{}},init:function(){sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");},_createChart:function(){var o;switch(this.getProperty("chartType")){case"Column":o=new c();break;case"Area":o=new A({width:"160px",height:"120px"});break;case"Comparison":o=new d();break;case"HarveyBall":o=new H({total:100,totalScale:" ",showFractions:true});break;case"Radial":o=new R();break;default:o=new c();break;}return o;},addChartItems:function(D,t){var o=this.getAggregation("_chart");var M=t.Chart.Type;this.getAggregation("_chart").setTooltip(this._createChartTooltip(D,t));switch(M){case"Column":jQuery.each(D,function(I,a){o.addColumn(new sap.suite.ui.microchart.ColumnMicroChartData({color:m[I%4],label:a[t.Dimensions[0]],value:a[t.Measures[0]]}));});break;case"Area":var e=new sap.suite.ui.microchart.AreaMicroChartItem({color:"Good"});var x=100/D.length;jQuery.each(D,function(I,a){e.addPoint(new sap.suite.ui.microchart.AreaMicroChartPoint({x:x*I,y:a[t.Measures[0]]}));});o.addLine(e);break;case"Comparison":jQuery.each(D,function(I,a){o.addData(new sap.suite.ui.microchart.ComparisonMicroChartData({color:m[I%4],title:a[t.Dimensions[0]],value:a[t.Measures[0]]}));});break;case"HarveyBall":var T=0;jQuery.each(D,function(I,a){o.addItem(new sap.suite.ui.microchart.HarveyBallMicroChartItem({color:"Good",fractionLabel:a[t.Dimensions[0]],fraction:a[t.Measures[0]],fractionScale:" "}));T+=a[t.Measures[0]];});if(T){o.setTotal(T);}break;case"Radial":var r=0;jQuery.each(D,function(I,a){r+=a[t.Measures[0]];});o.setTotal(r);o.setFraction(D[0][t.Measures[0]]);o.setValueColor("Good");break;case"TopList":D.sort(function(a,b){return b[t.Measures[0]]-a[t.Measures[0]];});var f=D.length<3?D.length:3;for(var i=0;i<f;i++){o.addColumn(new sap.suite.ui.microchart.ColumnMicroChartData({color:m[i%4],label:D[i][t.Dimensions[0]],value:D[i][t.Measures[0]]}));}break;default:jQuery.each(D,function(I,a){o.addColumn(new sap.suite.ui.microchart.ColumnMicroChartData({color:m[I%4],label:a[t.Dimensions[0]],value:a[t.Measures[0]]}));});break;}},_createChartTooltip:function(D,t){var T="";if(t.Content==="TopList"){D.sort(function(a,b){return b[t.Measures[0]]-a[t.Measures[0]];});var e=D.length<3?D.length:3;for(var i=0;i<e;i++){T+=D[i][t.Dimensions[0]]+" "+D[i][t.Measures[0]];T+=(i!==e-1)?"\n":"";}}else{jQuery.each(D,function(I,r){T+=r[t.Dimensions[0]]+" "+r[t.Measures[0]];T+=(I!==D.length)?"\n":"";});}return T;},renderer:function(r,o){o.setAggregation("_chart",o._createChart());r.write("<div");r.writeControlData(o);r.writeClasses();r.write(">");r.renderControl(o.getAggregation("_chart"));r.write("</div>");}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.RichTextEditor')){
/*!
 * SAP Innovation Management (c) Copyright 2014 SAP AG. All rights reserved.
 */
jQuery.sap.declare('sap.ino.controls.RichTextEditor');jQuery.sap.require('sap.ui.richtexteditor.RichTextEditor');jQuery.sap.require('sap.ui.core.Popup');sap.ui.define("sap/ino/controls/RichTextEditor",["sap/ui/richtexteditor/RichTextEditor",'sap/ui/core/Popup'],function(R,P){"use strict";return R.extend("sap.ino.controls.RichTextEditor",{metadata:{properties:{"valueState":{type:"sap.ui.core.ValueState",defaultValue:sap.ui.core.ValueState.None},"valueStateText":{type:"string",defaultValue:null}}},exit:function(){if(this._popup){this._popup.destroy();this._popup=null;}},refreshDataState:function(n,d){if(n==="value"){this.propagateMessages(n,d.getMessages());}},propagateMessages:function(n,m){if(m&&m.length>0){this.setValueState(m[0].type);this.setValueStateText(m[0].message);}else{this.setValueState(sap.ui.core.ValueState.None);this.setValueStateText('');this.closeValueStateMessage();}},setValueStateText:function(t){this.setProperty("valueStateText",t,true);this.$("message-text").text(this.getValueStateText());return this;},setValueState:function(v){this.setProperty("valueState",v,true);var $=this.$();if($){$.removeClass("sapUiInoRteTfErr");$.removeClass("sapUiInoRteTfSucc");$.removeClass("sapUiInoRteTfWarn");var s=this._getStyleClassForValueState();if(s){$.addClass(s);}}},_getStyleClassForValueState:function(){switch(this.getValueState()){case(sap.ui.core.ValueState.Error):return"sapUiInoRteTfErr";case(sap.ui.core.ValueState.Success):return"sapUiInoRteTfSucc";case(sap.ui.core.ValueState.Warning):return"sapUiInoRteTfWarn";}},getDomRefForValueStateMessage:function(){return this.getFocusDomRef();},closeValueStateMessage:function(){if(this._popup){this._popup.close();}var i=jQuery(this.getFocusDomRef());i.removeAriaDescribedBy(this.getId()+"-message");},openValueStateMessage:function(){var s=this.getValueState();if(this.getEditable()){var t=this.getValueStateText();if(!t){t=sap.ui.core.ValueStateSupport.getAdditionalText(this);}if(!t){return;}var m=this.getId()+"-message";if(!this._popup){this._popup=new P(jQuery("<span></span>")[0],false,false,false);this._popup.attachClosed(function(){jQuery.sap.byId(m).remove();});}var i=jQuery(this.getFocusDomRef());var d=P.Dock;var I=i.css("text-align")==="right";var c="sapMValueStateMessage sapMValueStateMessage"+s;var T="sapMInputBaseMessageText";var r=sap.ui.getCore().getLibraryResourceBundle("sap.m");if(s===sap.ui.core.ValueState.Success){c="sapUiInvisibleText";t="";}var C=jQuery("<div>",{"id":m,"class":c,"role":"tooltip","aria-live":"assertive"}).append(jQuery("<span>",{"aria-hidden":true,"class":"sapUiHidden","text":r.getText("INPUTBASE_VALUE_STATE_"+s.toUpperCase())})).append(jQuery("<span>",{"id":m+"-text","class":T,"text":t}));this._popup.setContent(C[0]);this._popup.close(0);var a=this;this._popup.open(200,I?d.EndTop:d.BeginTop,I?d.EndBottom:d.BeginBottom,this.getDomRefForValueStateMessage(),"0 4",null,function(){a._popup.close();});if(i.offset().top<this._popup._$().offset().top){this._popup._$().addClass("sapMInputBaseMessageBottom");}else{this._popup._$().addClass("sapMInputBaseMessageTop");}i.addAriaDescribedBy(m);}},renderer:"sap.ui.richtexteditor.RichTextEditorRenderer",onfocusin:function(e){this._bIgnoreNextInput=!this.bShowLabelAsPlaceholder&&sap.ui.Device.browser.msie&&sap.ui.Device.browser.version>9&&(jQuery.type(this.getPlaceholder)==="function"&&!!this.getPlaceholder())&&!this._getInputValue();this.$().toggleClass("sapMFocus",true);if(sap.ui.Device.support.touch){jQuery(document).on('touchstart.sapMIBtouchstart',jQuery.proxy(this._touchstartHandler,this));}this.openValueStateMessage();},onfocusout:function(e){this.$().toggleClass("sapMFocus",false);jQuery(document).off(".sapMIBtouchstart");this.closeValueStateMessage();}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.SidePanel')){jQuery.sap.declare('sap.ino.controls.SidePanel');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.layout.HorizontalLayout');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/SidePanel",["sap/ui/core/Control","sap/ui/layout/HorizontalLayout","sap/ui/core/Icon","sap/base/security/sanitizeHTML"],function(C,H,I,s){"use strict";var O={LEFT:0,RIGHT:1};var S=C.extend("sap.ino.controls.SidePanel",{metadata:{properties:{openerSide:{type:"int",defaultValue:O.RIGHT},openerPosition:{type:"sap.ui.core.CSSSize",defaultValue:"10%"},openerIcon:{type:"sap.ui.core.URI",defaultValue:"sap-icon://settings"},expanded:{type:"boolean",defaultValue:false},openerTooltipShow:{type:"string",defaultValue:undefined},openerTooltipHide:{type:"string",defaultValue:undefined},showOpener:{type:"boolean",defaultValue:true},showBorder:{type:"boolean",defaultValue:true},width:{type:"string"}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false},_openerIcon:{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},_panel:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},events:{changed:{}}},getOpenerIconControl:function(){var o=this.getAggregation("_openerIcon");if(!o){o=new I({src:this.getOpenerIcon()});this.setAggregation("_openerIcon",o,true);}return o;},getPanel:function(){var o=this.getAggregation("_panel");if(!o){o=new H();this.setAggregation("_panel",o,true);}return o;},constructor:function(){C.apply(this,arguments);var c=this.getContent();if(c){this.getPanel().addContent(c);}},exit:function(){var o=this.getId()+"-opener";jQuery("#"+o).off();},open:function(){if(this.getExpanded()){return;}this.toggle();},close:function(){if(!this.getExpanded()){return;}this.toggle();},toggle:function(){var t=this;var a=t.getExpanded()?"sapInoSidePanelCollapsed":"sapInoSidePanelExpanded";var r=t.getExpanded()?"sapInoSidePanelExpanded":"sapInoSidePanelCollapsed";jQuery("#"+t.getId()).addClass(a);jQuery("#"+t.getId()).removeClass(r);jQuery("#"+t.getId()+"-content").addClass(a+"Content");jQuery("#"+t.getId()+"-content").removeClass(r+"Content");jQuery("#"+t.getId()+"-content").attr("aria-expanded",!t.getExpanded());if(t.getExpanded()){jQuery("#"+t.getId()+"-opener").attr("title",t.getOpenerTooltipShow()||"");}else{jQuery("#"+t.getId()+"-opener").attr("title",t.getOpenerTooltipHide()||"");}t.setProperty("expanded",!t.getExpanded(),true);t.fireChanged({"expanded":t.getExpanded()});},onAfterRendering:function(){var t=this;var o=this.getId()+"-opener";var c=this.getId()+"-content";jQuery("#"+o).off();var f=function(e){if(e.originalEvent&&e.originalEvent.keyCode===jQuery.sap.KeyCodes.TAB){return;}t.toggle();};jQuery("#"+o).on("click",f);jQuery("#"+o).on("keypress",f);},renderer:function(r,c){var a=((c.getOpenerSide()===0)?"sapInoSidePanelLeft":"sapInoSidePanelRight");var b=((c.getOpenerSide()===0)?"sapInoSidePanelContentLeft":"sapInoSidePanelContentRight");var o=((c.getOpenerSide()===0)?"sapInoSidePanelOpenerLeft":"sapInoSidePanelOpenerRight");var e=((c.getExpanded())?"sapInoSidePanelExpanded":"sapInoSidePanelCollapsed");r.write('<div');r.writeControlData(c);r.addClass(a);r.addClass(e);r.writeClasses();if(c.getWidth()){r.addStyle("width",s(c.getWidth()));r.writeStyles();}r.write(">");if(c.getShowOpener()){r.write('<div id="'+s(c.getId())+'-opener" tabindex="0" aria-controls="'+s(c.getId())+'-content" role="button"');if(c.getExpanded()){r.writeAttributeEscaped("title",c.getOpenerTooltipHide()||"");}else{r.writeAttributeEscaped("title",c.getOpenerTooltipShow()||"");}r.addClass(o);r.writeClasses();r.write(">");var d=c.getOpenerIconControl();r.renderControl(d);r.write("</div>");}r.write('<div id="'+s(c.getId())+'-content" aria-expanded="'+s(c.getExpanded())+'" role="region"');r.addClass(b);r.addClass(e+"Content");r.writeClasses();if(!c.getShowBorder()){r.addStyle("border",0);r.writeStyles();}r.write(">");var p=c.getPanel();r.renderControl(p);r.write("</div>");r.write("</div>");}});S.Orientation=O;return S;});};if(!jQuery.sap.isDeclared('sap.ino.controls.StatusText')){jQuery.sap.declare('sap.ino.controls.StatusText');jQuery.sap.require('sap.m.TextRenderer');jQuery.sap.require('sap.m.Text');sap.ui.define("sap/ino/controls/StatusText",["sap/m/TextRenderer","sap/m/Text"],function(T,a){"use strict";var S=a.extend("sap.ino.controls.StatusText",{metadata:{properties:{statusColor:{type:"string"}}},renderer:T,onAfterRendering:function(){var s=this.getProperty("statusColor");if(s&&s.length===6){s="#"+s;}else{s="#333333";}if(this.getDomRef()){$(this.getDomRef()).css("color",s);}}});return S;});};if(!jQuery.sap.isDeclared('sap.ino.controls.TagCard')){jQuery.sap.declare('sap.ino.controls.TagCard');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.ui.core.TextAlign');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.m.ToggleButton');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/TagCard",["sap/ui/core/Control","sap/m/Button","sap/m/ButtonType","sap/m/Label","sap/m/Link","sap/m/Text","sap/ui/core/TextAlign","sap/ui/core/Icon","sap/m/ToggleButton","sap/base/security/sanitizeHTML"],function(C,B,a,L,b,T,c,I,d,s){"use strict";var e=C.extend("sap.ino.controls.TagCard",{metadata:{properties:{"tagId":{type:"int"},"tagName":{type:"string"},"campaignCount":{type:"string"},"ideaCount":{type:"string"},"tagGroupId":{type:"int"},"campaignHref":{type:"sap.ui.core.URI"},"ideaHref":{type:"sap.ui.core.URI"}},aggregations:{"followPlaceholder":{type:"sap.ui.core.Control",multiple:false},_campaignLink:{type:"sap.m.Link",multiple:false,visibility:"hidden"},_ideaLink:{type:"sap.m.Link",multiple:false,visibility:"hidden"},_tagLabel:{type:"sap.m.Text",multiple:false,visibility:"hidden"}},events:{press:{},openCampaign:{},openIdea:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_getCampaignLink:function(){var t=this;var A="_campaignLink";var o=new b({href:this.getProperty("campaignHref"),text:this.getProperty("campaignCount"),enabled:this.getProperty("campaignCount")==="0"?false:true,press:function(E){E.preventDefault();t.fireOpenCampaign({tagId:t.getProperty("tagId"),tagName:t.getProperty("tagName"),tagGroupId:t.getProperty("tagGroupId")});}});this.setAggregation(A,o,true);return o;},_getIdeaLink:function(){var t=this;var A="_ideaLink";var i=new b({href:this.getProperty("ideaHref"),text:this.getProperty("ideaCount"),enabled:this.getProperty("ideaCount")==="0"?false:true,press:function(E){E.preventDefault();t.fireOpenIdea({tagId:t.getProperty("tagId"),tagName:t.getProperty("tagName"),tagGroupId:t.getProperty("tagGroupId")});}});this.setAggregation(A,i,true);return i;},_getTagIcon:function(){return new I({src:"sap-icon://tag"}).addStyleClass("log");},_follow:function(E){var t=this;t.fireFollow();},_getFeedIcon:function(){var t=this;return new I({src:"sap-icon://feed",press:function(E){t._follow();}}).addStyleClass("follow");},setTagName:function(t){if(t){this.setAggregation("_tagLabel",new T({maxLines:1}).setText(t).setTooltip(t));}this.setProperty("tagName",t);return this;},renderer:function(r,o){r.write("<div");r.writeControlData(o);r.addClass("container");r.writeClasses();r.write(">");r.write("<header");r.addClass("tagheader");r.writeClasses();r.write(">");r.write("<div");r.addClass("bio");r.writeClasses();r.write(">");r.write("<div");r.addClass("desc");r.writeClasses();r.write(">");r.write("<div>");var t=o.getAggregation("_tagLabel");if(t){r.renderControl(t);}r.write("</div>");r.write("</div>");r.write("</div>");r.write("</header>");r.write("<div");r.addClass("content");r.writeClasses();r.write(">");r.write("<div");r.addClass("data");r.writeClasses();r.write(">");r.write("<ul>");r.write("<li");r.addClass("cardleft");r.writeClasses();r.write(">");r.renderControl(o._getCampaignLink());r.write("<span class=\"tagContentText\">"+s(o._oRB.getText('CTRL_TAG_CARD_CAMPAIGN')));r.write("</span>");r.write("</li>");r.write("<li");r.addClass("split");r.writeClasses();r.write(">");r.write("</li>");r.write("<li");r.addClass("cardright");r.writeClasses();r.write(">");r.renderControl(o._getIdeaLink());r.write("<span class=\"tagContentText\">"+s(o._oRB.getText('CTRL_TAG_CARD_IDEA')));r.write("</span>");r.write("</li>");r.write("</ul>");r.write("</div>");r.write("</div>");r.write("<div");r.addClass("splitH");r.writeClasses();r.write(">");r.write("</div>");r.write("<div>");var f=o.getAggregation("followPlaceholder");if(f){r.renderControl(f);}r.write("</div>");r.write("</div>");},onAfterRendering:function(){this._initTabs();},_getTabs:function(){return this._tabs;},_initTabs:function(){this._tabs=[];if(this.getAggregation("_campaignLink")&&this.getAggregation("_campaignLink").$().length){this._tabs.push(this.getAggregation("_campaignLink").$()[0].id);}if(this.getAggregation("_ideaLink")&&this.getAggregation("_ideaLink").$().length){this._tabs.push(this.getAggregation("_ideaLink").$()[0].id);}if(this.getAggregation("followPlaceholder")){this._tabs.push(this.getAggregation("followPlaceholder").$().find("[tabindex=0],button")[0].id);}},_defaultOnKeyDown:function(E){if(C.prototype.onkeydown){C.prototype.onkeydown.apply(this,arguments);}},onkeydown:function(E){var t=this._getTabs();var u=this._incr;if(E.shiftKey||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){u=this._decr;}if(E.keyCode===jQuery.sap.KeyCodes.ESCAPE){this.getParent().focus();}else if(E.keyCode===jQuery.sap.KeyCodes.TAB||E.keyCode===jQuery.sap.KeyCodes.ARROW_DOWN||E.keyCode===jQuery.sap.KeyCodes.ARROW_RIGHT||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){var $=jQuery(":focus");var i=-1;if($&&$.length>0){i=t.indexOf($[0].id);i=u(i,t.length-1);this._focus(jQuery("#"+t[i]));E.preventDefault();E.stopPropagation();}else{this.getParent().focus();}}else{this._defaultOnKeyDown(E);}},_incr:function(v,m){v++;if(v>m){return 0;}return v;},_decr:function(v,m){v--;if(v<0){return m;}return v;},_focus:function(E){if(jQuery.type(E.focus)==="function"){setTimeout(function(){E.focus();},0);}}});return e;});};if(!jQuery.sap.isDeclared('sap.ino.controls.TitleHeadItem')){jQuery.sap.declare('sap.ino.controls.TitleHeadItem');jQuery.sap.require('sap.ui.unified.ShellHeadItem');sap.ui.define("sap/ino/controls/TitleHeadItem",["sap/ui/unified/ShellHeadItem"],function(S){"use strict";return S.extend("sap.ino.controls.TitleHeadItem",{metadata:{properties:{text:{type:"string"}}},setText:function(t){if(t){this.setProperty("text",t,true);}this._refreshIcon();},_refreshIcon:function(){var t=this.getText();if(jQuery("#sapInoLogoTextInfo").length===0){this.$().append("<div tabindex='0' id='sapInoLogoTextInfo'/>");}this.$().removeAttr('tabindex');jQuery("#sapInoLogoTextInfo").addClass("sapInoLogoTextInfo");jQuery("#sapInoLogoTextInfo").text(t);}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.VBoxWithSubmitEvent')){jQuery.sap.declare('sap.ino.controls.VBoxWithSubmitEvent');jQuery.sap.require('sap.m.VBox');sap.ui.define("sap/ino/controls/VBoxWithSubmitEvent",["sap/m/VBox"],function(V){"use strict";var a=V.extend("sap.ino.controls.VBoxWithSubmitEvent",{metadata:{events:{submit:{}}},renderer:"sap.m.VBoxRenderer"});a.prototype.onkeydown=function(e){if(e.which===jQuery.sap.KeyCodes.ENTER){this.fireSubmit({});}};return a;});};if(!jQuery.sap.isDeclared('sap.ino.controls.VoteType')){jQuery.sap.declare("sap.ino.controls.VoteType");(function(){"use strict";sap.ino.controls.VoteType={TYPE_STAR:"STAR",TYPE_LIKE:"LIKE",TYPE_LIKE_DISLIKE:"LIKE_DISLIKE"};})();};if(!jQuery.sap.isDeclared('sap.ino.controls.WrappingList')){jQuery.sap.declare('sap.ino.controls.WrappingList');jQuery.sap.require('sap.m.List');sap.ui.define("sap/ino/controls/WrappingList",["sap/m/List"],function(L){"use strict";return L.extend("sap.ino.controls.WrappingList",{metadata:{properties:{wrapping:{type:"boolean",defaultValue:false},overwirteOnkeydown:{type:"boolean",defaultValue:true}}},init:function(){var t=this;L.prototype.init.apply(this,arguments);this.addEventDelegate({onAfterRendering:function(){var w=t.getWrapping();var T=t.$();T.addClass("sapInoWrappingList");if(w){T.removeClass("sapInoWrappingListNoWrap");T.addClass("sapInoWrappingListWrap");}else{T.removeClass("sapInoWrappingListWrap");T.addClass("sapInoWrappingListNoWrap");}}});},setNavigationItems:function(){this.getItemNavigation().setTableMode(!this.getWrapping());L.prototype.setNavigationItems.apply(this,arguments);},_isRendered:function(){if(this._bIsInDOM===undefined||this._bIsInDOM===0){this._bIsInDOM=jQuery.sap.byId(this.getId()).length;}return this._bIsInDOM;},setWrapping:function(w){if(this.getWrapping()!==w){this.setProperty("wrapping",w,true);if(this._isRendered()){var t=this.$();if(w){t.removeClass("sapInoWrappingListNoWrap");t.addClass("sapInoWrappingListWrap");}else{t.removeClass("sapInoWrappingListWrap");t.addClass("sapInoWrappingListNoWrap");}}}return this;},onkeydown:function(e){if(!this.getWrapping()||!this.getOverwirteOnkeydown()){return;}var c=this.$();var n;var C;var d=false;var i=false;var a=this.$().find("[tabindex!=-1]:focusable");if(a&&a.length>0){if(a[a.length-1]===e.target){i=true;}}if(!i&&e.keyCode===jQuery.sap.KeyCodes.TAB){if(e.shiftKey){do{n=c.prev();if(n&&n.length>0){C=n.find("[tabindex!=-1]:focusable");if(C&&C.length>0){this._focus(jQuery(C[C.length-1]));d=true;break;}if(n.attr("tabindex")!=="-1"&&n.is(":focusable")){this._focus(n);d=true;break;}}n=c.parent();c=n;}while(n&&n.length>0);}else{var l=jQuery(a[a.length-1]);n=l.next();do{if(n&&n.length>0){if(n.attr("tabindex")!=="-1"&&n.is(":focusable")){this._focus(n);d=true;break;}C=n.find("[tabindex!=-1]:focusable");if(C&&C.length>0){this._focus(jQuery(C[0]));d=true;break;}l=n;}else{l=l.parent();}n=l.next();while(n.length===0&&l.parent().length>0){l=l.parent();n=l.next();}}while(n&&n.length>0);}if(!d){this._focus(jQuery("html").find("[tabindex!=-1]:focusable")[0]);}e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();}else{L.prototype.onkeydown.apply(this,arguments);}},_focus:function(e){if(e&&jQuery.type(e.focus)==="function"){setTimeout(function(){e.focus();},10);}},renderer:"sap.m.ListRenderer"});});};if(!jQuery.sap.isDeclared('sap.ino.controls.library')){jQuery.sap.declare('sap.ino.controls.library');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.m.library');sap.ui.define("sap/ino/controls/library",["sap/ui/core/library","sap/m/library"],function(){"use strict";sap.ui.getCore().initLibrary({name:"sap.ino.controls",dependencies:["sap.ui.core","sap.m"],types:[],interfaces:[],controls:["sap.ino.controls.ActiveNavigationListItem","sap.ino.controls.Campaign","sap.ino.controls.ColorBar","sap.ino.controls.ColorPicker","sap.ino.controls.ColorPickerLite","sap.ino.controls.ColorRibbon","sap.ino.controls.EvaluationMatrix","sap.ino.controls.EvaluationMatrixItem","sap.ino.controls.GenericStyle","sap.ino.controls.HorizontalLine","sap.ino.controls.IdeaCard","sap.ino.controls.Image","sap.ino.controls.ImageCropping","sap.ino.controls.LabelledIcon","sap.ino.controls.MobileTextEditor","sap.ino.controls.NotificationHeadItem","sap.ino.controls.ProcessIndicator","sap.ino.controls.RichTextEditor","sap.ino.controls.SidePanel","sap.ino.controls.Vote","sap.ino.controls.VoteDisplay","sap.ino.controls.WrappingList"],elements:["sap.ino.controls.EvaluationData","sap.ino.controls.EvaluationDataCriterionValue","sap.ino.controls.EvaluationMatrixItem","sap.ino.controls.NotificationHeadItem"],version:"2.4.16"});});};if(!jQuery.sap.isDeclared('sap.ino.controls.util.ColorSupport')){jQuery.sap.declare("sap.ino.controls.util.ColorSupport");(function(){"use strict";sap.ino.controls.util.ColorSupport={};sap.ino.controls.util.ColorSupport.calculateTitleTextColor=function(r,g,b){var a;a=(parseInt(r,16)*0.299)+(parseInt(g,16)*0.587)+(parseInt(b,16)*0.114);if((255-a)<105){return"Dark";}else{return"Light";}};sap.ino.controls.util.ColorSupport.calculateMediaTextColor=function(r,g,b){var a;a=(parseInt(r,16)*299)+(parseInt(g,16)*587)+(parseInt(b,16)*114);a=a/255000;if(a>=0.9){var R=parseInt(r,16);R=(R-40>0)?R-40:0;r=R.toString(16);var G=parseInt(g,16);G=(G-40>0)?G-40:0;g=G.toString(16);var B=parseInt(b,16);B=(B-40>0)?B-40:0;b=B.toString(16);return"#"+r+g+b;}else{return"#FFFFFF";}};})();};if(!jQuery.sap.isDeclared('sap.ino.corelib.library')){jQuery.sap.declare('sap.ino.corelib.library');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.m.library');sap.ui.define("sap/ino/corelib/library",["sap/ui/core/library","sap/m/library"],function(){"use strict";sap.ui.getCore().initLibrary({name:"sap.ino.corelib",dependencies:["sap.ui.core","sap.m"],types:[],interfaces:[],controls:["sap.ino.commons.application.BaseComponent","sap.ino.commons.application.Configuration","sap.ino.commons.application.Router","sap.ino.commons.application.WebAnalytics","sap.ino.commons.formatters.BaseFormatter","sap.ino.commons.formatters.BaseListFormatter","sap.ino.commons.formatters.ListFormatter","sap.ino.commons.formatters.ObjectFormatter","sap.ino.commons.formatters.ObjectListFormatter","sap.ino.commons.models.aof.ApplicationObject","sap.ino.commons.models.aof.ApplicationObjectChange","sap.ino.commons.models.aof.MessageParser","sap.ino.commons.models.aof.MetaModel","sap.ino.commons.models.aof.PropertyModel","sap.ino.commons.models.aof.PropertyModelCache","sap.ino.commons.models.core.CoreModel","sap.ino.commons.models.core.Extensibility","sap.ino.commons.models.core.ModelSynchronizer","sap.ino.commons.models.core.ReadSource","sap.ino.commons.models.object.Attachment","sap.ino.commons.models.object.Campaign","sap.ino.commons.models.object.CampaignComment","sap.ino.commons.models.object.Evaluation","sap.ino.commons.models.object.Idea","sap.ino.commons.models.object.IdeaComment","sap.ino.commons.models.object.Notification","sap.ino.commons.models.object.UserSettings","sap.ino.commons.models.object.Vote","sap.ino.commons.models.object.Wall","sap.ino.commons.models.object.WallItem","sap.ino.commons.models.util.UUID","sap.ino.commons.models.util.WallMapper","sap.ino.controls.ActiveNavigationListItem","sap.ino.controls.Campaign","sap.ino.controls.ColorBar","sap.ino.controls.ColorPicker","sap.ino.controls.ColorPickerLite","sap.ino.controls.ColorRibbon","sap.ino.controls.EvaluationMatrix","sap.ino.controls.EvaluationMatrixItem","sap.ino.controls.GenericStyle","sap.ino.controls.HorizontalLine","sap.ino.controls.IdeaCard","sap.ino.controls.Image","sap.ino.controls.ImageCropping","sap.ino.controls.LabelledIcon","sap.ino.controls.MobileTextEditor","sap.ino.controls.NotificationHeadItem","sap.ino.controls.ProcessIndicator","sap.ino.controls.RichTextEditor","sap.ino.controls.SidePanel","sap.ino.controls.Vote","sap.ino.controls.VoteDisplay","sap.ino.controls.WrappingList","sap.ino.vc.commons.BaseController","sap.ino.vc.commons.BaseListController","sap.ino.vc.commons.BaseObjectController","sap.ino.vc.commons.BaseObjectModifyController","sap.ino.vc.commons.BaseVariantListController","sap.ino.vc.commons.TopLevelPageFacet","sap.ino.vc.evaluation.EvaluationFacet","sap.ino.vc.evaluation.EvaluationFormatter","sap.ino.vc.idea.ActivitiesBlock","sap.ino.vc.idea.AttachmentBlock","sap.ino.vc.idea.CommentBlock","sap.ino.vc.idea.EvaluationsBlock","sap.ino.vc.idea.ExpertFinderBlock","sap.ino.vc.idea.ListInIdeaBlock","sap.ino.vc.idea.RelatedIdeasBlock","sap.ino.vc.wall.util.Helper","sap.ino.vc.wall.util.WallFactory"],elements:["sap.ino.controls.EvaluationData","sap.ino.controls.EvaluationDataCriterionValue","sap.ino.controls.EvaluationMatrixItem","sap.ino.controls.NotificationHeadItem"],version:"2.4.16"});});};if(!jQuery.sap.isDeclared('sap.ino.vc.blog.CommentBlock-back')){jQuery.sap.declare('sap.ino.vc.blog.CommentBlock-back');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/blog/CommentBlock-back",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.blog.CommentBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.comment.Comment",type:"XML"},Expanded:{viewName:"sap.ino.vc.comment.Comment",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.blog.mixins.BlogCardMixin')){jQuery.sap.declare('sap.ino.vc.blog.mixins.BlogCardMixin');sap.ui.define("sap/ino/vc/blog/mixins/BlogCardMixin",[],function(){"use strict";var B=function(){throw"Mixin may not be instantiated directly";};B.onOpenCreator=function(e){var s=e.getSource();var i=s.getBindingContext("data").getProperty("CREATED_BY_ID");if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(s,i);};return B;});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.mixins.CampaignInstanceRolesMixin')){jQuery.sap.declare('sap.ino.vc.campaign.mixins.CampaignInstanceRolesMixin');sap.ui.define("sap/ino/vc/campaign/mixins/CampaignInstanceRolesMixin",[],function(){"use strict";var C=function(){throw"Mixin may not be instantiated directly";};C.getCampaignInstanceRolesData=function(i){var t=this;var c="/CampaignFull("+i+")/InstanceRoles";if(!this.getModel("data").getProperty(c)){this.getModel("data").read(c,{async:true,success:function(d){t.getModel("component").setProperty(c,d);},error:function(){t.getModel("component").setProperty(c,undefined);}});}};return C;});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.mixins.CampaignProfileMixin')){jQuery.sap.declare('sap.ino.vc.campaign.mixins.CampaignProfileMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/campaign/mixins/CampaignProfileMixin",["sap/ui/model/json/JSONModel"],function(J){"use strict";var I=function(){throw"Mixin may not be instantiated directly";};I.bindIdentityProfile=function(i,s,c,o){this._mIdentityMixinIdentityProfile=i;this._setIdentityProfileContext(c||0);if(i){i.bindElement("data>"+s.PATH);i.setModel(new J(s),"IdentityProfile");if(o){o.bindElement("data>"+this.getView().getBindingContext("data").sPath);}}};I.onIdentityProfileCreateIdea=function(){this.navigateTo("idea-create",{query:{campaign:this._getIdentityProfileContext()}});};I.onIdentityProfileCreateWall=function(){jQuery.sap.require("sap.ino.commons.models.object.Wall");var W=sap.ino.commons.models.object.Wall;var t=this;W.create({ID:-1,NAME:t.getText("WALL_BUT_CREATE_WALL_NAME"),WALL_TYPE_CODE:"sap.ino.config.WALL",BACKGROUND_IMAGE_REPEAT:0,BACKGROUND_IMAGE_URL:"cork.jpg",BACKGROUND_IMAGE_ZOOM:0}).done(function(r){t.navigateToWall("wall",{id:r.GENERATED_IDS[-1]});});};I.onIdentityProfileCreateBlog=function(){this.navigateTo("blog-create",{query:{campaign:this._getIdentityProfileContext()}});};I.formatIdentityProfileText=function(k){var p=this._mIdentityMixinIdentityProfile;if(p){var t=p.getModel("i18n");if(!t){return"";}return t.getResourceBundle().getText(k);}return"";};I.formatIdentityProfileCount=function(c){var p=this._mIdentityMixinIdentityProfile;if(p){var b=p.getElementBinding("data");if(!b){return"0";}var C=b.getBoundContext();if(!C){return"0";}var e=C.getObject();if(!e){return"0";}return e[c]||"0";}return"0";};I.formatIdentityProfileNavigationLink=function(r,p){p=p||{};p.id=this._getIdentityProfileContext();return this.getOwnerComponent().getNavigationLink(r,p);};I._setIdentityProfileContext=function(c){this._vIdentityProfileContext=c;};I._getIdentityProfileContext=function(){return this._vIdentityProfileContext;};I.navigateToList=function(e){var c=this.getView().getController();var l=e.oSource;var p=l.oPropagatedProperties.oBindingContexts.IdentityProfile.sPath;var r=l.getModel("IdentityProfile").getProperty(p).Route;if(r.NAME==="campaign-idealist"||r.NAME==="campaign-idealistvariant"||r.NAME==="campaign-bloglist"){r.QUERY.id=c.getCampaignId();}c.navigateTo(r.NAME,r.QUERY);};I.formatIdentityProfileCountVisibility=function(c,v,e,n,r){if(r&&!this._formatIdentityProfileVisByRole(r)){return false;}return true;};I._formatIdentityProfileVisByRole=function(r){if(r[0].indexOf("sap.ino.ui::")>-1){return this._hasCampaignsPrivileges(r);}return this._hasCampaignInstanceRole(r);};I._hasCampaignsPrivileges=function(r){return this._checkCampaignsPrivileges(r,this.getModel("user").getProperty("/privileges"));};I._hasCampaignInstanceRole=function(r){return this._checkCampaignsPrivileges(r,this.getModel("data").getProperty("/CampaignInstanceRoles("+this.getCampaignId()+")"));};I._checkCampaignsPrivileges=function(r,e){if(!e){return false;}var E=false;for(var R=0;R<=r.length-1;R++){if(e[r[R]]){E=true;break;}}if(!E){return false;}return true;};return I;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.TopLevelPageFacet')){jQuery.sap.declare('sap.ino.vc.commons.TopLevelPageFacet');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.define("sap/ino/vc/commons/TopLevelPageFacet",["sap/ui/Device","sap/ino/commons/application/Configuration","sap/ui/core/UIComponent"],function(D,C,U){"use strict";var T=function(){throw"Facet may not be instantiated directly";};T._onInit=function(){var t=this;this._oComponent=this.getOwnerComponent();this._oRouter=this._oComponent?this._oComponent.getRouter():undefined;if(this.routes&&this._oRouter){if(jQuery.type(this.routes)==="array"){jQuery.each(this.routes,function(i,r){t._oRouter.getRoute(r).attachMatched(t._onRouteMatched,t);});}else if(jQuery.type(this.routes)==="string"){t._oRouter.getRoute(this.routes).attachMatched(t._onRouteMatched,t);}}this._oNavEventDelegate={onBeforeShow:function(e){if(this.onBeforeShow){this.onBeforeShow(e);}if(!this._bOrientationHandlerAttached&&!D.system.desktop){this._bOrientationHandlerAttached=true;D.orientation.attachHandler(this._onOrientationChange,this);}},onAfterShow:function(e){if(this.onAfterShow){this.onAfterShow(e);}if(this.setViewFocus){this.setViewFocus();}},onBeforeHide:function(e){if(this.onBeforeHide){this.onBeforeHide(e);}},onAfterHide:function(e){if(this.onAfterHide){this.onAfterHide(e);}this._bOrientationHandlerAttached=false;D.orientation.detachHandler(this._onOrientationChange,this);}};this.getView().addEventDelegate(this._oNavEventDelegate,this);if(!this.getView().hasStyleClass("sapInoViewNoBackground")){this.getView().addStyleClass("sapUiGlobalBackgroundColor sapUiGlobalBackgroundColorForce");}if(this._oRouter){this._oRouter.attachRouteMatched(this._onAnyRouteMatched,this);this._oRouter.attachBypassed(t._onBypassed,t);}};T._onExit=function(){this.getView().removeEventDelegate(this._oNavEventDelegate);};T._onOrientationChange=function(e){if(this._onBaseOrientationChange){this._onBaseOrientationChange(e);}if(this.onOrientationChange){this.onOrientationChange(e);}};T.setBackgroundImages=function(b,s){var B=this._selectAppropriateBackgroundImageURL(b,s);if(B){this._setBackgroundImage(B);}};T.resetBackgroundImage=function(){var d=this.getDefaultBackgroundImageURL();if(d){this._setBackgroundImage(d);}else{this._removeBackgroundImage();}};T.getDefaultBackgroundImageURL=function(){var i=C.getTheme()==="THEME_HIGHCONTRAST";var b=C.getFrontofficeDefaultBackgroundImageURL(i);var s=C.getMobileSmallDefaultBackgroundImageURL();return this._selectAppropriateBackgroundImageURL(b,s);};T.updateBackgroundColor=function(s){function h(c){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null;}function a(j,l){j=String(j).replace(/[^0-9a-f]/gi,'');if(j.length<6){j=j[0]+j[0]+j[1]+j[1]+j[2]+j[2];}l=l||0;var k="#",c,i;for(i=0;i<3;i++){c=parseInt(j.substr(i*2,2),16);c=Math.round(Math.min(Math.max(0,c+(c*l)),220)).toString(16);k+=("00"+c).substr(c.length);}return k;}if(s){var o=this.getOwnerComponent();var r=o.getRootController();var S=r.byId("innerShell").getDomRef();var R=h(s);var b=a(s,0.7);var d=h(b);$(S).css("background-color","#"+s);if(s==="FFFFFF"){this.resetBackgroundImage();}else{$(S).css('background-image','none');var B="-webkit-linear-gradient(top, rgba("+R.r+","+R.g+","+R.b+","+"0.2) 70%, rgba("+R.r+","+R.g+","+R.b+","+"0.9) 100%)";var e="-ms-linear-gradient(top, #ffffff 10%, rgba("+R.r+","+R.g+","+R.b+","+"0.9) 100%)";var f="linear-gradient(to bottom, rgba("+d.r+","+d.g+","+d.b+","+"1) 30%, rgba("+R.r+","+R.g+","+R.b+","+"1) 90%)";var g="-moz-linear-gradient(top, #ffffff 10%, rgba("+R.r+","+R.g+","+R.b+","+"0.9) 100%)";$(S).css("background-image",B);$(S).css("background-image",e);$(S).css("background-image",f);$(S).css("background-image",g);}}else{this.resetBackgroundImage();}};T.reusePropertiesOnNavigation=function(s){return false;};T._selectAppropriateBackgroundImageURL=function(b,s){var i=b;if(D.system.phone){i=s;}if(jQuery.isNumeric(i)){return C.getAttachmentTitleImageDownloadURL(i);}else{return null;}};T._setBackgroundImage=function(u){var c=this.getOwnerComponent();var r=c.getRootController();var s=r.byId("innerShell").getDomRef();if($(s).css("background-image")!==u){if(u){$(s).css("background-image","url("+u+")");r.byId("app").setBackgroundOpacity(0.5);}else{$(s).css("background-image","");r.byId("app").setBackgroundOpacity(1);}}};T._removeBackgroundImage=function(){this._setBackgroundImage(undefined);};T._onRouteMatched=function(e){this._oComponent.setCurrentRoute(e.getParameter("name"));if(jQuery.type(this.onRouteMatched)==="function"){if(this.getViewProperty("/HIDE_SYS_MSG")===true||this._oComponent.getRootController().byId("systemMessage").data().msgClosed){this._oComponent.getRootController().byId("systemMessage").setProperty("visible",false);this._oComponent.getRootController().byId("innerShell").removeStyleClass("sapInoInnoMgmtMShellMsg");}else{this._oComponent.getRootController().byId("systemMessage").setProperty("visible",true);this._oComponent.getRootController().byId("innerShell").addStyleClass("sapInoInnoMgmtMShellMsg");}this.onRouteMatched(e);}if(!this.bKeepMessages){var m=sap.ui.getCore().getMessageManager();m.removeAllMessages();}if(!this.hasBackgroundImage||!this.hasBackgroundImage()){this.resetBackgroundImage();}this._oComponent.getRootController().onAfterNavigate();};T._onAnyRouteMatched=function(e){if(jQuery.type(this.onAnyRouteMatched)==="function"){this.onAnyRouteMatched(e);}};T._onBypassed=function(e){this._oComponent.setCurrentRoute("home");this._oComponent.getRootController().onBypassedNavigate();};return T;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.IdentityQuickviewMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.IdentityQuickviewMixin');sap.ui.define("sap/ino/vc/commons/mixins/IdentityQuickviewMixin",["sap/ino/commons/application/Configuration"],function(C){"use strict";var I=function(){throw"Mixin may not be instantiated directly";};I.openIdentityQuickView=function(s,i){if(s&&i){if(!this._oIdentityCardView||!this._oIdentityCardView.getController()){this._oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});s.addDependent(this._oIdentityCardView);}this._oIdentityCardView.getController().open(s,i);}};I.onOpenIdentityQuickView=function(e){var s=e.getSource();var i=e.getParameter("identityId")||e.getParameter("ideaSubmitterId");if(s&&i){if(!this._oIdentityCardView||!this._oIdentityCardView.getController()){this._oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});s.addDependent(this._oIdentityCardView);}this._oIdentityCardView.getController().open(s,i);}};return I;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.SimilarIdeasMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.SimilarIdeasMixin');sap.ui.define("sap/ino/vc/commons/mixins/SimilarIdeasMixin",[],function(){"use strict";var S=function(){throw"Mixin may not be instantiated directly";};S.groupByCampaignId=function(i,n,a){if(!i){return i;}var t=this;var I=[];var s=[];var o=[];jQuery.each(i,function(b,c){if(c.CAMPAIGN_ID===n){s.push(c);}else{o.push(c);}});I.push({GROUP_NAME:t.getText("IDEA_SIMILAR_CURRENT_CAMPAIGN_NAME"),IDEAS:s});I.push({GROUP_NAME:t.getText("IDEA_SIMILAR_OTHER_CAMPAIGN_NAME"),IDEAS:o});return I;};S._sort=function(p,n,s){if(p[s]===null){return 1;}if(n[s]===null){return-1;}var P=p[s];var N=n[s];if(P>N){return 1;}if(P<N){return-1;}return 0;};S._getIdeas=function(i,c){var t=this;var r=jQuery.map(t._filterByCampaignId(i,c.CAMPAIGN_ID),function(I){return{ID:I.ID,NAME:I.NAME,AGG_SCORE:I.AGG_SCORE};});r.sort(function(p,n){return t._sort(p,n,"AGG_SCORE");});return r;};S._filterByCampaignId=function(i,n){return jQuery.grep(i,function(e){return n===e.CAMPAIGN_ID;});};return S;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.TagGroupMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.TagGroupMixin');sap.ui.define("sap/ino/vc/commons/mixins/TagGroupMixin",[],function(){"use strict";var T=function(){throw"Mixin may not be instantiated directly";};T.groupByTagGroup=function(g,s,o){if(!g){return g;}var t=this;var r=g;r.sort(function(p,n){return t._sortTag(p,n,"GROUP_NAME");});var a=[];jQuery.each(r,function(i,G){if(t._filterByGroupId(a,G.GROUP_ID).length===0){a.push({GROUP_EXPANDED:t._filterByGroupId(s,G.GROUP_ID).length>0,GROUP_DESCRIPTION:G.GROUP_DESCRIPTION,GROUP_ID:G.GROUP_ID,GROUP_NAME:G.GROUP_NAME||o,GROUP_TAGS:t._getTagFromGroup(r,G)});}});return a;};T.setTagCloudProperty=function(t,h){if(t.length===1&&!h){t[0].GROUP_EXPANDED=true;this.setViewProperty("/List/TAGCLOUD_EXPABLE",false);this.setViewProperty("/List/TAGCLOUD_EXP",true);this.setViewProperty("/List/TAGCLOUD_BAR_VISIBLE",false);}else{this.setViewProperty("/List/TAGCLOUD_EXPABLE",true);this.setViewProperty("/List/TAGCLOUD_EXP",false);this.setViewProperty("/List/TAGCLOUD_BAR_VISIBLE",true);}};T._sortTag=function(p,n,s){if(p[s]===null){return 1;}if(n[s]===null){return-1;}var P=p[s].toUpperCase();var N=n[s].toUpperCase();if(P>N){return 1;}if(P<N){return-1;}return 0;};T._getTagFromGroup=function(r,c){var t=this;var a=jQuery.map(t._filterByGroupId(r,c.GROUP_ID),function(g){return{GROUP_ID:c.GROUP_ID,ID:g.ID,NAME:g.NAME,RANK:g.RANK};});a.sort(function(p,n){return t._sortTag(p,n,"NAME");});return a;};T._filterByGroupId=function(g,G){return jQuery.grep(g,function(e){return G===e.GROUP_ID;});};return T;});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.mixins.ExpertFinderMixin')){jQuery.sap.declare('sap.ino.vc.evaluation.mixins.ExpertFinderMixin');sap.ui.define("sap/ino/vc/evaluation/mixins/ExpertFinderMixin",[],function(){"use strict";var E=function(){throw"Mixin may not be instantiated directly";};E.getExpertFinderDialog=function(){if(!this._oExpertFinderDialog){this._oExpertFinderDialog=this.createFragment("sap.ino.vc.evaluation.fragments.ExpertFinder",this.getView().createId());this.getView().addDependent(this._oExpertFinderDialog);}return this._oExpertFinderDialog;};E.onFindExpert=function(e){var m=this.getObjectModel();var d=this.getExpertFinderDialog();this.setViewProperty("/IS_DIALOG",true);this._aExperts=[].concat(m.getProperty("/Experts")||[]);d.open();};E.onExpertFinderDialogOK=function(e){var d=this.getExpertFinderDialog();d.close();};E.onExpertFinderDialogCancel=function(e){var m=this.getObjectModel();var d=this.getExpertFinderDialog();m.setProperty("/Experts",this._aExperts);d.close();};return E;});};if(!jQuery.sap.isDeclared('sap.ino.vc.iam.mixins.IdentityProfileMixin')){jQuery.sap.declare('sap.ino.vc.iam.mixins.IdentityProfileMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/iam/mixins/IdentityProfileMixin",["sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration"],function(J,C){"use strict";var I=function(){throw"Mixin may not be instantiated directly";};I.bindIdentityProfile=function(i,s,c,o){this._mIdentityMixinIdentityProfile=i;this._setIdentityProfileContext(c||0);if(i){i.bindElement("data>"+s.PATH);i.setModel(new J(s),"IdentityProfile");if(o){o.bindElement("data>"+this.getView().getBindingContext("data").sPath);}}};I.onIdentityProfileCreateIdea=function(){if(this._getIdentityProfileContext()){this.navigateTo("idea-create",{query:{campaign:this._getIdentityProfileContext()}});}else{this.navigateTo("idea-create");}};I.onIdentityProfileCreateWall=function(){jQuery.sap.require("sap.ino.commons.models.object.Wall");var W=sap.ino.commons.models.object.Wall;var t=this;W.create({ID:-1,NAME:t.getText("WALL_BUT_CREATE_WALL_NAME"),WALL_TYPE_CODE:"sap.ino.config.WALL",BACKGROUND_IMAGE_REPEAT:0,BACKGROUND_IMAGE_URL:"cork.jpg",BACKGROUND_IMAGE_ZOOM:0}).done(function(r){t.navigateToWall("wall",{id:r.GENERATED_IDS[-1]});});};I.onIdentityProfileCreateBlog=function(){this.navigateTo("blog-create",{query:{campaign:this._getIdentityProfileContext()}});};I.formatIdentityProfileText=function(k){var p=this._mIdentityMixinIdentityProfile;if(p){var t=p.getModel("i18n");if(!t||!k){return"";}return t.getResourceBundle().getText(k);}return"";};I.formatIdentityProfileCount=function(c){var p=this._mIdentityMixinIdentityProfile;if(p){var b=p.getElementBinding("data");if(!b){return"0";}var o=b.getBoundContext();if(!o){return"0";}var e=o.getObject();if(!e){return"0";}return e[c]||"0";}return"0";};I.formatIdentityProfileNavigationLink=function(r,p){p=p||{};p.id=this._getIdentityProfileContext();return this.getOwnerComponent().getNavigationLink(r,p);};I._setIdentityProfileContext=function(c){this._vIdentityProfileContext=c;};I._getIdentityProfileContext=function(){return this._vIdentityProfileContext;};I.navigateToList=function(e){var c=this.getView().getController();var l=e.oSource;var p=l.oPropagatedProperties.oBindingContexts.IdentityProfile.sPath;var r=l.getModel("IdentityProfile").getProperty(p).Route;if(r.NAME==="campaign-idealistvariant"||r.NAME==="campaign-idealist"||r.NAME==="campaign-registerapprovallistvariant"){r.QUERY.id=c.getCampaignId();}c.navigateTo(r.NAME,r.QUERY);};I.formatIdentityProfileCountVisibility=function(c,v,e,n,r,V){if(r&&!this._formatIdentityProfileVisByRole(r,c)){return false;}var s=!!(C.getSystemSetting("sap.ino.config.REWARD_ACTIVE")*1);if(c==="QUALIFIED_IDEAS_FOR_REWARDS"){if(!V||!s){return false;}}if(c==="MY_PENDING_APPR_COUNT"&&this.getCurrentRoute()==="campaign"){if(!V){return false;}}return true;};I._formatIdentityProfileVisByRole=function(r,c){if(r[0].indexOf("sap.ino.ui::")>-1){return this._hasCampaignsPrivileges(r);}return this._hasCampaignInstanceRole(r);};I._hasCampaignsPrivileges=function(r){return this._checkCampaignsPrivileges(r,this.getModel("user").getProperty("/privileges"));};I._hasCampaignInstanceRole=function(r){return this._checkCampaignsPrivileges(r,this.getModel("data").getProperty("/CampaignInstanceRoles("+this.getCampaignId()+")"));};I._checkCampaignsPrivileges=function(r,e){if(!e){return false;}var E=false;for(var R=0;R<=r.length-1;R++){if(e[r[R]]){E=true;break;}}if(!E){return false;}return true;};return I;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.ActivitiesBlock')){jQuery.sap.declare('sap.ino.vc.idea.ActivitiesBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/ActivitiesBlock",['sap/uxap/BlockBase'],function(B){"use strict";var b=B.extend("sap.ino.vc.idea.ActivitiesBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.idea.Activities",type:"XML"},Expanded:{viewName:"sap.ino.vc.idea.Activities",type:"XML"}}}});return b;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.AttachmentBlock')){jQuery.sap.declare('sap.ino.vc.idea.AttachmentBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/AttachmentBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.AttachmentBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.attachment.Attachment",type:"XML"},Expanded:{viewName:"sap.ino.vc.attachment.Attachment",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.CommentBlock')){jQuery.sap.declare('sap.ino.vc.idea.CommentBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/CommentBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.CommentBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.comment.Comment",type:"XML"},Expanded:{viewName:"sap.ino.vc.comment.Comment",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.CommentRichBlock')){jQuery.sap.declare('sap.ino.vc.idea.CommentRichBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/CommentRichBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.CommentRichBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.comment.RichComment",type:"XML"},Expanded:{viewName:"sap.ino.vc.comment.RichComment",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.EvaluationsBlock')){jQuery.sap.declare('sap.ino.vc.idea.EvaluationsBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/EvaluationsBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.EvaluationsBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.idea.Evaluations",type:"XML"},Expanded:{viewName:"sap.ino.vc.idea.Evaluations",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.ExpertsBlock')){jQuery.sap.declare('sap.ino.vc.idea.ExpertsBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/ExpertsBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.ExpertsBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.idea.Experts",type:"XML"},Expanded:{viewName:"sap.ino.vc.idea.Experts",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.IntegrationBlock')){jQuery.sap.declare('sap.ino.vc.idea.IntegrationBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/IntegrationBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.IntegrationBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.idea.Integration",type:"XML"},Expanded:{viewName:"sap.ino.vc.idea.Integration",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.InternalAttachmentBlock')){jQuery.sap.declare('sap.ino.vc.idea.InternalAttachmentBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/InternalAttachmentBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.InternalAttachmentBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.internal.InternalAttachment",type:"XML"},Expanded:{viewName:"sap.ino.vc.internal.InternalAttachment",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.InternalCommentBlock')){jQuery.sap.declare('sap.ino.vc.idea.InternalCommentBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/InternalCommentBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.InternalCommentBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.internal.InternalNote",type:"XML"},Expanded:{viewName:"sap.ino.vc.internal.InternalNote",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.InternalSectionBlock')){jQuery.sap.declare('sap.ino.vc.idea.InternalSectionBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/InternalSectionBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.InternalSectionBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.internal.InternalSection",type:"XML"},Expanded:{viewName:"sap.ino.vc.internal.InternalSection",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.InternalWallBlock')){jQuery.sap.declare('sap.ino.vc.idea.InternalWallBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/InternalWallBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.InternalWallBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.internal.InternalWall",type:"XML"},Expanded:{viewName:"sap.ino.vc.internal.InternalWall",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.PPMBlock')){jQuery.sap.declare('sap.ino.vc.idea.PPMBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/PPMBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.PPMBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.idea.PPM",type:"XML"},Expanded:{viewName:"sap.ino.vc.idea.PPM",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.RelatedIdeasBlock')){jQuery.sap.declare('sap.ino.vc.idea.RelatedIdeasBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/RelatedIdeasBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.RelatedIdeasBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.idea.RelatedIdeas",type:"XML"},Expanded:{viewName:"sap.ino.vc.idea.RelatedIdeas",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.RewardsBlock')){jQuery.sap.declare('sap.ino.vc.idea.RewardsBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/RewardsBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.RewardsBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.idea.Rewards",type:"XML"},Expanded:{viewName:"sap.ino.vc.idea.Rewards",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.VolunteersBlock')){jQuery.sap.declare('sap.ino.vc.idea.VolunteersBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/VolunteersBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.VolunteersBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.idea.Volunteers",id:"volunteerView",type:"XML"},Expanded:{viewName:"sap.ino.vc.idea.Volunteers",id:"volunteerView",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.VotesBlock')){jQuery.sap.declare('sap.ino.vc.idea.VotesBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/VotesBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.VotesBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.idea.Votes",id:"voteView",type:"XML"},Expanded:{viewName:"sap.ino.vc.idea.Votes",id:"voteView",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.WallListBlock')){jQuery.sap.declare('sap.ino.vc.idea.WallListBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/idea/WallListBlock",['sap/uxap/BlockBase'],function(B){"use strict";return B.extend("sap.ino.vc.idea.WallListBlock",{metadata:{views:{Collapsed:{viewName:"sap.ino.vc.wall.ListInIdea",type:"XML"},Expanded:{viewName:"sap.ino.vc.wall.ListInIdea",type:"XML"}}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.CampaignFormFilterMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.CampaignFormFilterMixin');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/ino/vc/idea/mixins/CampaignFormFilterMixin",["sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(F,a){var C=function(){throw"Mixin may not be instantiated directly";};C.initCampaignFormItems=function(){var i=this.getFilterItem("/CAMPAIGNFORM");if(!i){return;}var m=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");var t=this;var I=this._check4ManagingList();m.read("/CampaignFormSuggestionParams(searchToken='',filterBackoffice="+(I?1:0)+")/Results",{urlParameters:{"$orderby":"DEFAULT_TEXT","$filter":"CODE eq '"+(i||"")+"'"},success:function(d){t.setFilterItem("/campaignFormSuggestion",d.results);var c=t.byId("campaignFormFilterList")||t.getFilterElementById("campaignFormFilterList");c.setFilterSuggests(false);if(c.getSuggestionItems().length>0){c.setSelectionItem(c.getSuggestionItems()[0]);}}});};C.onCampaignFormSuggestion=function(e){var t=this;var m=t.getDefaultODataModel?t.getDefaultODataModel():t.getModel("data");var E=jQuery.extend({},e,true);var T=jQuery.sap.encodeURL(E.getParameter("suggestValue"));t.resetClientMessages();var i=this._check4ManagingList();m.read("/CampaignFormSuggestionParams(searchToken='"+T+"',filterBackoffice="+(i?1:0)+")/Results",{urlParameters:{"$orderby":"DEFAULT_TEXT"},success:function(d){t.setFilterItem("/campaignFormSuggestion",d.results);var c=t.byId("campaignFormFilterList")||t.getFilterElementById("campaignFormFilterList");c.setFilterSuggests(false);}});};C.hasCampaignFormFilter=function(){return!!this.getFilterItem("/CAMPAIGNFORM");};C.getCampaignFormFilter=function(){return new F({filters:[new F("CAMPAIGN_FORM_CODE",a.EQ,(this.getFilterItem("/CAMPAIGNFORM")||"")),new F("CAMPAIGN_ADMIN_FORM_CODE",a.EQ,(this.getFilterItem("/CAMPAIGNFORM")||""))],and:false});};C.getCampaignFormQuery=function(){return this.getFilterItem("/CAMPAIGNFORM");};C.restCampaignForm=function(){this.setCampaignForm("");};C.setCampaignForm=function(i){this.setFilterItem("/CAMPAIGNFORM",i);};C.onHandleCampaignFormFilterHelp=function(){var t=this;var m=t.getDefaultODataModel?t.getDefaultODataModel():t.getModel("data");var i=this._check4ManagingList();m.read("/CampaignFormSuggestionParams(searchToken='',filterBackoffice="+(i?1:0)+")/Results",{urlParameters:{"$orderby":"DEFAULT_TEXT"},success:function(d){t.setFilterItem("/campaignFormSuggestion",d.results);var c=t.byId("campaignFormFilterList")||t.getFilterElementById("campaignFormFilterList");c.setFilterSuggests(false);var o=t.createCampaignFormListDialog();o.open();}});};C.createCampaignFormListDialog=function(){if(!this._campaignFormDialog){this._campaignFormDialog=this.createFragment("sap.ino.vc.idea.fragments.CampaignFormSuggestionSelectList",this.getView().getId());this.getView().addDependent(this._campaignFormDialog);}return this._campaignFormDialog;};C.onCampaignFormDialogSearch=function(e){var v=jQuery.sap.encodeURL(e.getParameter("value"));var m=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");var t=this;var i=this._check4ManagingList();m.read("/CampaignFormSuggestionParams(searchToken='"+v+"',filterBackoffice="+(i?1:0)+")/Results",{urlParameters:{"$orderby":"DEFAULT_TEXT"},success:function(d){t.setFilterItem("/campaignFormSuggestion",d.results);}});};C.onCampaignFormDialogItemsSelect=function(e){var s=e.getParameter("selectedItem").data("CODE")+"";var c=this.byId("campaignFormFilterList")||this.getFilterElementById("campaignFormFilterList");var o=c.getSuggestionItems();for(var i=0;i<o.length;i++){if(o[i].getProperty("key")===s){c.setSelectionItem(o[i]);break;}}this.setFilterItem("/CAMPAIGNFORM",s);this.clearIdeaFormFieldsCriterias();this.getIdeaFormFieldsCriterias();};C.onFilterCampaignFormChange=function(e){var s=e.getParameter("selectedItem");if(s){var S=s.getProperty("key");this.setFilterItem("/CAMPAIGNFORM",S);this.clearIdeaFormFieldsCriterias();this.getIdeaFormFieldsCriterias();}};C.onClearCampaignFormFilter=function(e){var v=e.getParameter("value");if(v.trim()===""){this.setFilterItem("/CAMPAIGNFORM","");}this.clearIdeaFormFieldsCriterias();};C.campaignFormFormatter=function(v,p){return!v&&!!p;};C.campaignFormLabelFormatter=function(v,p,i,I){if(!p){return false;}if(!v){return true;}return I&&I.length>1;};return C;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.ChangeAuthorActionFormatter')){jQuery.sap.declare('sap.ino.vc.idea.mixins.ChangeAuthorActionFormatter');sap.ui.define("sap/ino/vc/idea/mixins/ChangeAuthorActionFormatter",[],function(){"use strict";var c=function(){};c.formatterMoveRewardMessage=function(o,n){return this.getText("IDEA_OBJECT_MSG_MOVE_REWARDS",[o,n]);};c.formatterMoveSelfEvluMessage=function(o,n){return this.getText("IDEA_OBJECT_MSG_MOVE_EVALUATION_AUTHOR",[o,n]);};return c;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.ChangeStatusActionFormatter')){jQuery.sap.declare('sap.ino.vc.idea.mixins.ChangeStatusActionFormatter');sap.ui.define("sap/ino/vc/idea/mixins/ChangeStatusActionFormatter",[],function(){"use strict";var c=function(){};c.reponseTextMinLength=function(t){return t?0:1;};return c;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.CommonFilterMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.CommonFilterMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/idea/mixins/CommonFilterMixin",["sap/ui/model/json/JSONModel"],function(J){var C=function(){throw"Mixin may not be instantiated directly";};C.initFilterItemModel=function(){this.setModel(new J(),"filterItemModel");this.setFilterItem("/IsValidDueFrom",true);this.setFilterItem("/IsValidDueTo",true);};C.getFilterItemModel=function(){return this.getModel("filterItemModel");};C.getFilterItem=function(p){return this.getModel("filterItemModel").getProperty(p);};C.setFilterItem=function(p,v){return this.getModel("filterItemModel").setProperty(p,v);};C.isCanApply=function(){return this.getModel("filterItemModel").getProperty("/IsValidDueFrom")&&this.getModel("filterItemModel").getProperty("/IsValidDueTo");};return C;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.CompanyViewFilterMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.CompanyViewFilterMixin');sap.ui.define("sap/ino/vc/idea/mixins/CompanyViewFilterMixin",["sap/ino/commons/application/Configuration"],function(C){var a=function(){throw"Mixin may not be instantiated directly";};function i(){this.setFilterItem("/CompanyViewCriterias",{CriteriaType:C.getSysCompanyView(),CriteriaToken:'',CriteriaRole:'1',CriteriaEnable:C.getSysCompanyEnable(),CriteriaLabel:C.getSysCompanyLabel()});}function b(q){var t=this;var c={CriteriaType:C.getSysCompanyView(),CriteriaToken:'',CriteriaRole:'1',CriteriaEnable:C.getSysCompanyEnable(),CriteriaLabel:C.getSysCompanyLabel()};if(q.hasOwnProperty("cvt")){c.CriteriaToken=decodeURIComponent(q.cvt);}if(q.hasOwnProperty("cvr")){c.CriteriaRole=decodeURIComponent(q.cvr);}t.setFilterItem("/CompanyViewCriterias",c);}a.initCompanyView=function(){i.call(this);this.setFilterItem("/CompanyViewRoleList",[{KEY:"1",TEXT:this.getText("LIST_TIT_FILTER_ORGANIZATION_VIEW_ROLE_SUBMITTER")},{KEY:"2",TEXT:this.getText("LIST_TIT_FILTER_ORGANIZATION_VIEW_ROLE_VOTER")},{KEY:"3",TEXT:this.getText("LIST_TIT_FILTER_ORGANIZATION_VIEW_ROLE_COMMENTER")}]);};a.hasCompanyViewFilters=function(){var c=this.getFilterItem("/CompanyViewCriterias");if(!c){return false;}return c.CriteriaToken;};a.initCompanyViewItems=function(q){if(!q||!q.hasOwnProperty("cvt")){i.call(this);return;}b.call(this,q);};a.getCompanyViewQuery=function(q){var c=this.getFilterItem("/CompanyViewCriterias");if(!c){return;}q.cvt=decodeURIComponent(this.getFilterItem("/CompanyViewCriterias/CriteriaToken"));q.cvr=this.getFilterItem("/CompanyViewCriterias/CriteriaRole");q.cvy=this.getFilterItem("/CompanyViewCriterias/CriteriaType");};a.getEmptyCompanyViewFilters=function(){return",cvt='',cvr=1,cvy=1";};a.setQueryObjectCompanyViewFilters=function(p){var c=this.getFilterItem("/CompanyViewCriterias");p.cvt='';p.cvr='1';p.cvy=C.getSysCompanyView();if(!c){return;}p.cvy=this.getFilterItem("/CompanyViewCriterias/CriteriaType");p.cvr=this.getFilterItem("/CompanyViewCriterias/CriteriaRole");p.cvt=encodeURIComponent(this.getFilterItem("/CompanyViewCriterias/CriteriaToken"));};a.getCompanyViewFilters=function(){var c=this.getFilterItem("/CompanyViewCriterias");if(!c||!C.getSysCompanyEnable()){return this.getEmptyCompanyViewFilters();}return",cvt='"+encodeURIComponent(this.getFilterItem("/CompanyViewCriterias/CriteriaToken"))+"',cvr="+this.getFilterItem("/CompanyViewCriterias/CriteriaRole")+",cvy="+this.getFilterItem("/CompanyViewCriterias/CriteriaType");};a.setCompanyCriteriaToQuery=function(q){var c=this.getFilterItem("/CompanyViewCriterias");if(!c||!c.CriteriaToken){return;}q.cvy=C.getSysCompanyView();q.cvr=this.getFilterItem("/CompanyViewCriterias/CriteriaRole");q.cvt=encodeURIComponent(this.getFilterItem("/CompanyViewCriterias/CriteriaToken"));};a.resetCompanyCriterias=function(){i.call(this);};a.onCompanyViewRoleChange=function(e){this.setFilterItem("/CompanyViewCriterias/CriteriaRole",e.getParameter("selectedItem").getKey());};a.onFilterCompanyViewChange=function(e){var s=e.getParameter("selectedItem");if(s){var S=s.getProperty("key");this.setFilterItem("/CompanyViewCriterias/CriteriaToken",S);}};a.onCompanyViewSuggestion=function(e){var t=this;var m=t.getDefaultODataModel?t.getDefaultODataModel():t.getModel("data");var E=jQuery.extend({},e,true);var T=jQuery.sap.encodeURL(E.getParameter("suggestValue"));var c=C.getSysCompanyView(),s=c==="1"?"COMPANY":"ORGANIZATION";t.resetClientMessages();m.read("/SearchIdentityOrgCompanyParams(searchToken='"+T+"')/Results",{urlParameters:{"$orderby":"SEARCH_SCORE","$filter":"TYPENAME eq '"+c+"'"},success:function(d){var S=[];if(d.results){d.results.forEach(function(I){S.push({"DEFAULT_TEXT":I[s],"DISPLAY_LABEL":I.DISPLAYLABEL});});}t.setFilterItem("/companyViewSuggestion",S);var o=t.byId("companyViewFilterList")||t.getFilterElementById("companyViewFilterList");o.setFilterSuggests(false);}});};a.companyViewTitle=function(v){if(!v){return"";}return v==="1"?this.getText("LIST_TIT_FILTER_COMPANY_VIEW_HEADER"):this.getText("LIST_TIT_FILTER_ORGANIZATION_VIEW_HEADER");};return a;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.DueFilterMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.DueFilterMixin');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.core.ValueState');jQuery.sap.require('sap.ui.core.format.DateFormat');sap.ui.define("sap/ino/vc/idea/mixins/DueFilterMixin",["sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/ValueState","sap/ui/core/format/DateFormat"],function(F,a,V,D){var K="FOLLOW_UP_DATE";var f={from:undefined,to:undefined};var b=D.getInstance({pattern:"YYYY-MM-dd"});function v(e,d){if(!e.getParameter("valid")){e.getSource().setValueState(V.Error);return false;}e.getSource().setValueState(V.None);var s=b.format(e.getSource().getDateValue());if(d&&f.to&&s>f.to){e.getSource().setValueState(V.Error);return false;}if(!d&&f.from&&s<f.from){e.getSource().setValueState(V.Error);return false;}return true;}var c=function(){throw"Mixin may not be instantiated directly";};c.hasDueFromFilter=function(){return!!f.from;};c.hasDueToFilter=function(){return!!f.to;};c.hasDueFilter=function(){return this.hasDueFromFilter()||this.hasDueToFilter();};c.getDueFilter=function(){if(f.from&&f.to){return new F({filters:[new F({filters:[new F(K,a.EQ,b.parse(f.from)),new F(K,a.GE,b.parse(f.from))],and:false}),new F({filters:[new F(K,a.EQ,b.parse(f.to)),new F(K,a.LE,b.parse(f.to))],and:false})],and:true});}if(f.from){return new F(K,a.EQ,b.parse(f.from));}if(f.to){return new F(K,a.EQ,b.parse(f.to));}return new F(K,a.EQ,'');};c.setDueFrom=function(e){if(!v(e,true)){e.getSource().setValueStateText(this.getText("LIST_TIT_FILTER_DUEFROM_GT_DUETO"));this.setFilterItem("/IsValidDueFrom",false);return;}var d=b.format(e.getSource().getDateValue());this.setFilterItem("/DueFrom",d);this.setFilterItem("/IsValidDueFrom",true);f.from=d;};c.setDueTo=function(e){if(!v(e,false)){e.getSource().setValueStateText(this.getText("LIST_TIT_FILTER_DUEFROM_GT_DUETO"));this.setFilterItem("/IsValidDueTo",false);return;}var d=b.format(e.getSource().getDateValue());this.setFilterItem("/DueTo",d);this.setFilterItem("/IsValidDueTo",true);f.to=d;};c.setDueFromValue=function(o){var d="";if(o){d=b.format(b.parse(o));}this.setFilterItem("/DueFrom",d);f.from=d;};c.setDueToValue=function(o){var d="";if(o){d=b.format(b.parse(o));}this.setFilterItem("/DueTo",d);f.to=d;};c.restDue=function(){f={from:undefined,to:undefined};this.setFilterItem("/DueFrom",undefined);this.setFilterItem("/DueTo",undefined);};c.clearDueValueState=function(){var C=[this.byId("dpDue"),this.byId("dpDueTo")];jQuery.each(C,function(i,d){d.setValueState(V.None);});};return c;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.IdeaFormCriteriaFilterMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.IdeaFormCriteriaFilterMixin');jQuery.sap.require('sap.ui.core.format.DateFormat');sap.ui.define("sap/ino/vc/idea/mixins/IdeaFormCriteriaFilterMixin",["sap/ino/commons/application/Configuration","sap/ui/core/format/DateFormat","sap/ino/commons/models/types/StringBooleanType"],function(C,D,S){var I=function(){throw"Mixin may not be instantiated directly";};var a=D.getInstance({pattern:"YYYY-MM-dd"});var O={empty:{TEXT:"",ACTION:-1},eq:{TEXT:"OPERATOR_MIT_EQ",ACTION:0},ge:{TEXT:"OPERATOR_MIT_GE",ACTION:1},le:{TEXT:"OPERATOR_MIT_LE",ACTION:2},like:{TEXT:"OPERATOR_MIT_LIKE",ACTION:3}};var b={"BOOLEAN":1,"INTEGER":2,"NUMERIC":2,"DATE":4,"TEXT":8,"RICHTEXT":8,"VALUEOPTIONLIST":16};var c={"BOOLEAN":[O.eq],"INTEGER":[O.eq,O.ge,O.le],"NUMERIC":[O.eq,O.ge,O.le],"DATE":[O.eq,O.ge,O.le],"TEXT":[O.like],"RICHTEXT":[O.like]};function s(p,i,v){var o=[O.eq];if(!i){o=[O.empty];}else if(!v){o=c[i];}var j=this.getFilterItem(p+"/CriteriaOp");if(!this.getFilterItem(p+"/CriteriaOp")){j=o[0].ACTION;}this.setFilterItem(p+"/IdeaFormOperator",o);this.setFilterItem(p+"/CriteriaOp",j);}function d(p,i,v){var j=-1;if(v){i="VALUEOPTIONLIST";}if(i){j=b[i];}this.setFilterItem(p+"/CriteriaValueDataType",j);}function g(v){var i=new jQuery.Deferred();var M=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");var p=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")?"/StagingValueOptions":"/ValueOptions";M.read(p,{urlParameters:{"$orderby":"SEQUENCE_NO","$filter":"LIST_CODE eq '"+v+"'"},success:function(o){var r=o.results;r.unshift({CODE:"",DEFAULT_TEXT:""});i.resolve(r);}});return i.promise();}function e(p,v){var t=this;if(!v){if(p){this.setFilterItem(p+"/CriteriaValueList",[]);}return;}g.call(this,v).then(function(r){t.setFilterItem(p+"/CriteriaValueList",r);});}function f(){var r=[];r.unshift({CODE:"",DATATYPE_CODE:"",DEFAULT_TEXT:""});this.setFilterItem("/IdeaFormList",r);}function h(){this.setFilterItem("/IdeaFormCriterias",[{CriteriaID:0,CriteriaCode:'',CriteriaOp:-1,CriteriaType:-1,CriteriaValue:undefined,CriteriaValueCode:undefined,IdeaFormOperator:[],CriteriaValueDataType:0,CriteriaValueList:[],CriteriaTime:new Date().getTime()}]);}function k(){var i=this.getFilterItem("/CAMPAIGNFORM");var j=this.getViewProperty("/List/CAMPAIGN");var o=new jQuery.Deferred();if(!i&&!j){o.resolve();return o.promise();}var p=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");var M=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");M.read("/IdeaFormFieldSuggestionParams(CampaignID="+(j||-1)+",FormID='"+(i||"")+"',filterBackoffice="+(p?1:0)+")/Results",{success:function(q){var r=jQuery.extend(true,{},q).results;r.unshift({CODE:"",DATATYPE_CODE:"",DEFAULT_TEXT:""});o.resolve(r);}});return o.promise();}function l(q){var t=this;var o=[],p=t.getFilterItem("/IdeaFormList");for(var r=1;r<=3;r++){if(q.hasOwnProperty("c"+r)){o.push({CriteriaID:r-1,CriteriaCode:q["c"+r],CriteriaOp:q["o"+r],CriteriaType:q["t"+r],CriteriaValue:q["v"+r],CriteriaValueCode:q["vc"+r],IdeaFormOperator:[],CriteriaValueDataType:q["vdt"+r],CriteriaValueList:[],CriteriaTime:new Date().getTime()});}}o[0].CriteriaValue=decodeURIComponent(o[0].CriteriaValue);t.setFilterItem("/IdeaFormCriterias",o);function u(){p=t.getFilterItem("/IdeaFormList");for(var i=0;i<o.length;i++){for(var j=0;j<p.length;j++){if(p[j].CODE===o[i].CriteriaCode){s.call(t,"/IdeaFormCriterias/"+i,p[j].DATATYPE_CODE,p[j].VALUE_OPTION_LIST_CODE);d.call(t,"/IdeaFormCriterias/"+i,p[j].DATATYPE_CODE,p[j].VALUE_OPTION_LIST_CODE);e.call(t,"/IdeaFormCriterias/"+i,p[j].VALUE_OPTION_LIST_CODE);}}}}if(!p){k.call(t).then(function(R){t.setFilterItem("/IdeaFormList",R);u();});}else{u();}}function m(v){var r=JSON.stringify(new Date(v+" 00:00:00"));return r.replace(/"/g,"");}function n(i){if(this.getFilterItem("/IdeaFormCriterias/"+i+"/CriteriaValueDataType")===4&&!!this.getFilterItem("/IdeaFormCriterias/"+i+"/CriteriaValue")){return m.call(this,this.getFilterItem("/IdeaFormCriterias/"+i+"/CriteriaValue"));}return this.getFilterItem("/IdeaFormCriterias/"+i+"/CriteriaValue")||"";}I.hasIdeaformFilters=function(){var i=this.getFilterItem("/IdeaFormCriterias");if(!i||i.length<=0){return false;}return i[0].CriteriaCode;};I.initIdeaFormItems=function(q){if(!q||!q.hasOwnProperty("c1")){h.call(this);return;}l.call(this,q);};I.getIdeaformQuery=function(q){var i=this.getFilterItem("/IdeaFormCriterias");if(!i||i.length<=0){return;}for(var j=0;j<3;j++){if(j>i.length-1||!this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaCode")){continue;}q["c"+(j+1)]=this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaCode");q["o"+(j+1)]=this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaOp");q["v"+(j+1)]=n.call(this,j);}};I.getEmptyIdeaformFilters=function(){return",c1='',o1=-1,v1='',c2='',o2=-1,v2='',c3='',o3=-1,v3=''";};I.setQueryObjectIdeaformFilters=function(p){var i=this.getFilterItem("/IdeaFormCriterias");for(var j=0;j<3;j++){p["c"+(j+1)]='';p["o"+(j+1)]=-1;p["v"+(j+1)]='';}if(!i||i.length<=0){return;}for(j=0;j<3;j++){if(j>i.length-1||!this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaCode")){continue;}p["c"+(j+1)]=this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaCode");p["o"+(j+1)]=this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaOp");p["v"+(j+1)]=encodeURIComponent(n.call(this,j));}};I.getIdeaformFilters=function(){var i=this.getFilterItem("/IdeaFormCriterias");if(!i||i.length<=0){return this.getEmptyIdeaformFilters();}var r="";for(var j=0;j<3;j++){if(j>i.length-1||!this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaCode")){r+=",c"+(j+1)+"=''";r+=",o"+(j+1)+"=-1";r+=",v"+(j+1)+"=''";continue;}r+=",c"+(j+1)+"='"+this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaCode")+"'";r+=",o"+(j+1)+"="+this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaOp");r+=",v"+(j+1)+"='"+encodeURIComponent(n.call(this,j))+"'";}return r;};I.setIdeaformCriteriaToQuery=function(q){var i=this.getFilterItem("/IdeaFormCriterias");if(!i||i.length<=0||!i[0].CriteriaCode){return;}for(var j=0;j<i.length;j++){q["c"+(j+1)]=this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaCode");q["o"+(j+1)]=this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaOp");q["v"+(j+1)]=encodeURIComponent(this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaValue"));q["vc"+(j+1)]=this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaValueCode");q["vdt"+(j+1)]=this.getFilterItem("/IdeaFormCriterias/"+j+"/CriteriaValueDataType");}};I.restIdeaFormFieldsCriterias=function(){f.call(this);h.call(this);};I.clearIdeaFormFieldsCriterias=function(){f.call(this);h.call(this);};I.getIdeaFormFieldsCriterias=function(){var t=this;k.call(t).then(function(r){t.setFilterItem("/IdeaFormList",r);});};I.CriteriaCodeChange=function(E){var o=E.getSource();var i=E.getParameter("selectedItem").getAggregation("customData");var j=i[0].getProperty("value");var v=i[1].getProperty("value");var p=o.getBinding("selectedKey").getContext().sPath;s.call(this,p,j,v);d.call(this,p,j,v);e.call(this,p,v);this.setFilterItem(p+"/CriteriaValue",(j==="BOOLEAN"?"0":""));this.setFilterItem(p+"/CriteriaValueCode","");};I.onAddCriteriaFilter=function(){var i=this.getFilterItem("/IdeaFormCriterias");i.push({CriteriaID:i.length,CriteriaCode:'',CriteriaOp:-1,CriteriaType:-1,CriteriaValue:undefined,CriteriaValueCode:undefined,IdeaFormOperator:[],CriteriaValueDataType:0,CriteriaValueList:[],CriteriaTime:new Date().getTime()});this.setFilterItem("/IdeaFormCriterias",i);for(var j=0;j<i.length;j++){this.setFilterItem("/IdeaFormCriterias/"+j+"/CriteriaTime",new Date().getTime());}};I.onRemoveCriteriaFilter=function(){var i=this.getFilterItem("/IdeaFormCriterias");i.pop();this.setFilterItem("/IdeaFormCriterias",i);for(var j=0;j<i.length;j++){this.setFilterItem("/IdeaFormCriterias/"+j+"/CriteriaTime",new Date().getTime());}};I.onDataPickerCriteriaValueChange=function(E){var p=E.getSource().getBindingInfo("value").binding.getContext().sPath;this.setFilterItem(p+"/CriteriaValue",a.format(E.getSource().getDateValue()));};I.onCriteriaValueCodeChange=function(E){var p=E.getSource().getBindingInfo("selectedKey").binding.getContext().sPath;var i='',v=this.getFilterItem(p+"/CriteriaValueList"),j={"BOOLEAN":"BOOL_VALUE","INTEGER":"NUM_VALUE","NUMERIC":"NUM_VALUE","TEXT":"TEXT_VALUE"};if(v){for(var o=0;o<v.length;o++){if(v[o].CODE===this.getFilterItem(p+"/CriteriaValueCode")&&j.hasOwnProperty(v[o].DATATYPE_CODE)){i=v[o][j[v[o].DATATYPE_CODE]];break;}}}this.setFilterItem(p+"/CriteriaValue",i);};I.addCriteriaFilterFormatter=function(i,j,o){return i&&i.length<3&&i.length-1===j&&o>0;};I.removeCriteriaFilterFormatter=function(i,j,o){return i&&i.length>1&&i.length-1===j&&o>0;};I.campaignIdeaFormFormatter=function(i,j,o,p){if(!p){return false;}if(!i&&!j){return false;}return o&&o.length>1;};return I;});};if(!jQuery.sap.isDeclared('sap.ino.vc.library')){jQuery.sap.declare('sap.ino.vc.library');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.m.library');sap.ui.define("sap/ino/vc/library",["sap/ui/core/library","sap/m/library"],function(){"use strict";sap.ui.getCore().initLibrary({name:"sap.ino.vc",dependencies:["sap.ui.core","sap.m"],types:[],interfaces:[],controls:["sap.ino.vc.commons.BaseController","sap.ino.vc.commons.BaseListController","sap.ino.vc.commons.BaseObjectController","sap.ino.vc.commons.BaseObjectModifyController","sap.ino.vc.commons.BaseVariantListController","sap.ino.vc.commons.TopLevelPageFacet","sap.ino.vc.evaluation.EvaluationFacet","sap.ino.vc.evaluation.EvaluationFormatter","sap.ino.vc.idea.ActivitiesBlock","sap.ino.vc.idea.AttachmentBlock","sap.ino.vc.idea.CommentBlock","sap.ino.vc.idea.EvaluationsBlock","sap.ino.vc.idea.ExpertFinderBlock","sap.ino.vc.idea.ListInIdeaBlock","sap.ino.vc.idea.RelatedIdeasBlock","sap.ino.vc.wall.util.Helper","sap.ino.vc.wall.util.WallFactory"],noLibraryCSS:true,elements:[],version:"2.4.16"});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.aof.PropertyModel')){jQuery.sap.declare('sap.ino.commons.models.aof.PropertyModel');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/commons/models/aof/PropertyModel",["sap/ui/model/json/JSONModel","sap/ino/commons/models/aof/MetaModel","sap/ino/commons/models/aof/PropertyModelCache"],function(J,M,P){"use strict";var N={Root:"Root",Extension:"Extension"};var p=new P({});var a=J.extend("sap.aof.PropertyModel",{metadata:{events:{"modelInitialized":{},"modelCacheUpdated":{},"modelCacheInvalidated":{}}},constructor:function(A,k,s,S,m,o){J.apply(this,[]);if(m){this.attachEvent("modelInitialized",m);}this.applicationObjectName=A;this.key=k;this.scope=s;this.syncRead=S;this.propertyDefault=o;this.initDefault=false;this._load();},bindProperty:function(s,C,m){return J.prototype.bindProperty.apply(this,arguments);},_load:function(){var t=this;if(!this.initDefault){var D={nodes:{},actions:{}};if(this.scope.staticNodes){jQuery.each(this.scope.staticNodes,function(i,n){var f=e(t.propertyDefault,"readOnly",n);D.nodes[n]={readOnly:f!==undefined?f:true,messages:[]};});}if(this.scope.staticActions){jQuery.each(this.scope.staticActions,function(i,A){var s=_(A);var f=e(t.propertyDefault,"enabled",undefined,s);D.actions[s]={enabled:f!==undefined?f:false,messages:[]};});}if(this.scope.nodes){jQuery.each(this.scope.nodes,function(i,n){var f=e(t.propertyDefault,"readOnly",n);D.nodes[n]={readOnly:f!==undefined?f:true,messages:[]};D.nodes[n][t.key]={readOnly:f!==undefined?f:true,messages:[]};});}if(this.scope.actions){jQuery.each(this.scope.actions,function(i,A){var s=_(A);var f=e(t.propertyDefault,"enabled",undefined,s);D.actions[s]={enabled:f!==undefined?f:false,messages:[]};});}if(t.propertyDefault){if(t.propertyDefault.nodes){jQuery.each(t.propertyDefault.nodes,function(n,f){var g=f.readOnly;if(!D.nodes[n]){D.nodes[n]={readOnly:g!==undefined?g:true,messages:[]};}});}if(t.propertyDefault.actions){jQuery.each(t.propertyDefault.actions,function(A,f){var g=f.enabled;if(!D.actions[A]){D.actions[A]={enabled:g!==undefined?g:false,messages:[]};}});}}this.setData(D);this.initDefault=true;}var o=new jQuery.Deferred();this._oDataInitPromise=o.promise();b(this.applicationObjectName,this.key,this.scope,!this.syncRead,function(f){if(f.properties&&f.properties[t.key]){if(f.properties[t.key].nodes){jQuery.each(f.properties[t.key].nodes,function(n,g){if(n===N.Root&&g[t.key]){jQuery.each(g[t.key],function(s,h){g[s]=h;});}if(n===N.Extension){var k=Object.keys(g);if(k.length===1){jQuery.each(g[k[0]],function(s,h){g[s]=h;});}}});if(f.properties[t.key].nodes){jQuery.each(f.properties[t.key].nodes,function(n,g){t.setPropertyInternal("/nodes/"+n,g);});}if(f.properties[t.key].actions){jQuery.each(f.properties[t.key].actions,function(A,g){t.setPropertyInternal("/actions/"+A,g);});}}}if(f.staticProperties){if(f.staticProperties.nodes){jQuery.each(f.staticProperties.nodes,function(n,g){if(!t.getProperty("/nodes/"+n)){t.setPropertyInternal("/nodes/"+n,g);}});}if(f.staticProperties.actions){jQuery.each(f.staticProperties.actions,function(A,g){t.setPropertyInternal("/actions/"+A,g);});}}o.resolve(t.getData());setTimeout(function(){t.fireEvent("modelInitialized");},0);});},setProperty:function(){return;},setPropertyInternal:function(){J.prototype.setProperty.apply(this,arguments);},getNodeReadOnlyFormatter:function(n){var t=this;return function(k){k=k?k:t.key;return!!t.getProperty("/nodes/"+n+"/"+k+"/readOnly");};},getNodeChangeableFormatter:function(n){var t=this;return function(k){k=k?k:t.key;return!!t.getProperty("/nodes/"+n+"/"+k+"/changeable");};},getAttributeReadOnlyFormatter:function(n,A){var t=this;return function(k){k=k?k:t.key;return!!t.getProperty("/nodes/"+n+"/"+k+"/attributes/"+A+"/readOnly");};},getAttributeChangeableFormatter:function(n,A){var t=this;return function(k){k=k?k:t.key;return!!t.getProperty("/nodes/"+n+"/"+k+"/attributes/"+A+"/changeable");};},getActionEnabledFormatter:function(A){var t=this;return function(k){return!!t.getProperty("/actions/"+A+"/enabled");};},getStaticActionEnabledFormatter:function(A){return this.getActionEnabledFormatter(A);},getProperties:function(){return this.getData();},sync:function(k,s){if(!s){a.invalidateCachedProperties(this.applicationObjectName,this.key);}this.key=k||this.key;this._load();},getDataInitializedPromise:function(){return this._oDataInitPromise;}});function _(A){if(typeof A==="object"){return Object.keys(A)[0];}return A;}function b(A,k,s,f,S){var r=false;var o=p.getProperty("/"+A);if(!o){p.setProperty("/"+A,{nodes:{},actions:{}});r=true;}if(k&&(!o||!o[k])){p.setProperty("/"+A+"/"+k,{nodes:{},actions:{}});r=true;}else{if(k){if(!r&&s.nodes){jQuery.each(s.nodes,function(i,n){if(!p.getProperty("/"+A+"/"+k+"/nodes/"+n)){r=true;}});}if(!r&&s.actions){jQuery.each(s.actions,function(i,v){if(typeof v==="object"){r=true;}else{if(!p.getProperty("/"+A+"/"+k+"/actions/"+v)){r=true;}}});}}else{if(!r&&s.staticNodes){jQuery.each(s.staticNodes,function(i,n){if(!p.getProperty("/"+A+"/nodes/"+n)){r=true;}});}if(!r&&!jQuery.isEmptyObject(s.staticActions)){r=true;}}}var g={properties:{},staticProperties:{}};if(r){c(A,k,s,f).done(function(n){if(n.properties){var h=n.properties[k];if(h){if(h.nodes){jQuery.each(h.nodes,function(j,l){p.setProperty("/"+A+"/"+k+"/nodes/"+j,l);});}if(h.actions){jQuery.each(h.actions,function(j,l){p.setProperty("/"+A+"/"+k+"/actions/"+j,l);});}}g.properties=n.properties;}if(n.staticProperties){var i=n.staticProperties;if(i){if(i.nodes){jQuery.each(i.nodes,function(j,l){p.setProperty("/"+A+"/nodes/"+j,l);});}if(i.actions){jQuery.each(i.actions,function(j,l){p.setProperty("/"+A+"/actions/"+j,l);});}}g.staticProperties=n.staticProperties;}p.fireEvent("modelCacheUpdated",n);if(S){S(n);}});}else{if(k){g.properties[k]=o[k];}g.staticProperties={nodes:o.nodes,actions:o.actions};if(S){S({properties:g.properties,staticProperties:g.staticProperties});}}return g;}function c(A,k,s,f){var u,U;var E=M.getEndpoint(A);var r=k&&k>0&&((!!s.nodes&&s.nodes.length>0)||(!!s.actions&&s.actions.length>0));var R=(!!s.staticNodes&&s.staticNodes.length>0)||(!!s.staticActions&&s.staticActions.length>0);var o;if(r){u=[];if(s.nodes){jQuery.each(s.nodes,function(i,n){u.push("node="+n);});}if(s.actions){jQuery.each(s.actions,function(i,v){if(typeof v==="object"){u.push("action="+encodeURI(JSON.stringify(v)));}else{u.push("action="+v);}});}U=u.length>0?"?"+u.join("&"):"";o=jQuery.ajax({url:E+"/"+k+"/properties"+U,async:f,dataType:"json"});o.fail(function(){jQuery.sap.log.debug("Property request failed");});}var S;if(R){u=[];if(s.staticNodes){jQuery.each(s.staticNodes,function(i,n){u.push("node="+n);});}if(s.staticActions){jQuery.each(s.staticActions,function(i,v){if(typeof v==="object"){u.push("action="+encodeURI(JSON.stringify(v)));}else{u.push("action="+v);}});}U=u.length>0?"?"+u.join("&"):"";S=jQuery.ajax({url:E+"/staticProperties"+U,async:f,dataType:"json"});S.fail(function(){jQuery.sap.log.debug("Static property request failed");});}var D=new jQuery.Deferred();jQuery.when(o,S).done(function(g,h){var i={};if(g&&g.length>0){var j=g[0];if(j){if(j[k]&&j[k].nodes){jQuery.each(j[k].nodes,function(n,m){jQuery.each(m,function(k,I){I.changeable=!I.readOnly;jQuery.each(I.attributes,function(q,t){t.changeable=!t.readOnly;});});});}i.properties=j;}}if(h&&h.length>0){var l=h[0];if(l){if(l.nodes){jQuery.each(l.nodes,function(n,m){m.changeable=!m.readOnly;jQuery.each(m.attributes,function(q,t){t.changeable=!t.readOnly;});});}i.staticProperties=l;}}D.resolve(i);});return D.promise();}function d(o,s,k,n,v,A,f){if(k){if(o.properties&&o.properties[k]){var i=o.properties[k];if(f&&i.actions&&i.actions[f]){var g=i.actions[f];return g[s];}else if(n&&i.nodes&&i.nodes[n]&&i.nodes[n][v]){var h=i.nodes[n][v];if(A&&h.attributes&&h.attributes[A]){var j=h.attributes[A];return j[s];}else{return h[s];}}}}else{if(f&&o.staticProperties&&o.staticProperties.actions&&o.staticProperties.actions[f]){var S=o.staticProperties.actions[f];return S[s];}else if(n&&o.staticProperties&&o.staticProperties.nodes&&o.staticProperties.nodes[n]){var l=o.staticProperties.nodes[n];return l[s];}}return undefined;}function e(o,s,n,A){if(o){if(A&&o.actions&&o.actions[A]){var f=o.actions[A];return f[s];}else if(n&&o.nodes&&o.nodes[n]){var g=o.nodes[n];return g[s];}}return undefined;}a.getNodeReadOnlyStaticFormatter=function(A,n){return function(k,v){var o=b(A,k,{nodes:[n]},false);return!!d(o,"readOnly",k,n,v||k);};};a.getNodeChangeableStaticFormatter=function(A,n){return function(k,v){var o=b(A,k,{nodes:[n]},false);return!!d(o,"changeable",k,n,v||k);};};a.getAttributeReadOnlyStaticFormatter=function(A,n,s){return function(k,v){var o=b(A,k,{nodes:[n]},false);return!!d(o,"readOnly",k,n,v||k,s);};};a.getAttributeChangeableStaticFormatter=function(A,n,s){return function(k,v){var o=b(A,k,{nodes:[n]},false);return!!d(o,"changeable",k,n,v||k,s);};};a.getActionEnabledStaticFormatter=function(A,s,o){var r;var R;var f=typeof o==="function"?o:undefined;return function(k,n){if(f){if(!k){return false;}o=f(k,n||k);}var C=JSON.stringify({key:k,parameter:o});if(R===C&&r!==undefined){return r;}R=C;var g=null;if(o){g={};g[s]=o;}else{g=s;}var h=b(A,k,{actions:[g]},false);r=!!d(h,"enabled",k,undefined,undefined,undefined,s);return r;};};a.getStaticActionEnabledStaticFormatter=function(A,s,o){var r;var R;var f=typeof o==="function"?o:undefined;return function(k,n){if(f){if(!k){return false;}o=f(k,n||k);}var C=JSON.stringify({parameter:o});if(R===C&&r!==undefined){return r;}R=C;var S={};S[s]=o;var g=b(A,undefined,{staticActions:[S]},false);r=!!d(g,"enabled",undefined,undefined,undefined,undefined,s);return r;};};a.getStaticActionEnabledDynamicFormatter=function(A,s,o){var f=typeof o==="function"?o:undefined;return function(k,n){var r;if(f){if(!k){return false;}o=f(k,n||k);}var S={};S[s]=o;var g=b(A,undefined,{staticActions:[S]},false);r=!!d(g,"enabled",undefined,undefined,undefined,undefined,s);return r;};};a.getCacheModel=function(){return p;};a.getCachedProperties=function(A){if(!A){return p.getData();}else{return p.getProperty("/"+A);}};a.invalidateCachedProperties=function(A,k){if(!k){if(A){var D=p.getData();delete D[A];p.setData(D);}else{p.setData({});}}else{var o=p.getProperty("/"+A);if(o){if(jQuery.isArray(k)){jQuery.each(k,function(i,v){delete o[v];});}else{delete o[k];}p.setProperty("/"+A,o);}}p.fireEvent("modelCacheInvalidated",{applicationObjectName:A,key:k});};a.refresh=function(){a.invalidateCachedProperties();};a.setMetaModel=function(m){M=m;};return a;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.core.ModelSynchronizer')){jQuery.sap.declare('sap.ino.commons.models.core.ModelSynchronizer');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.ui.model.odata.v2.ODataListBinding');sap.ui.define("sap/ino/commons/models/core/ModelSynchronizer",["sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/commons/models/aof/PropertyModel","sap/ui/base/ManagedObject","sap/ui/model/odata/v2/ODataListBinding"],function(A,P,M,O){"use strict";var o={};var d={};var a;var b=M.extend("sap.ino.commons.models.core.ModelSynchronizer",{metadata:{}});b=new b({});function u(n,h){if(h&&n){for(var p in n){if(n.hasOwnProperty(p)){h.setProperty("/"+p,n[p]);}}return true;}return false;}function c(S,t){if(S&&t){for(var p in t){if(S.hasOwnProperty(p)&&t.hasOwnProperty(p)){if(t[p]&&typeof t[p]==="object"&&(t[p].hasOwnProperty("__deferred")||t[p].hasOwnProperty("__list")||t[p].hasOwnProperty("__ref"))){continue;}t[p]=S[p];}}return true;}return false;}function g(E,k){var C=new RegExp("^"+E+"\\(.*"+k+"\\)$");var h=new RegExp("^"+E+"\\(.*(')("+k+")\\1\\)$");var i=new RegExp("^"+E+"\\(.*="+k+"\\)$");var j=new RegExp("^"+E+"\\(.*(=')("+k+")\\1\\)$");var D=a.getProperty("/");var l;var m=[];jQuery.each(D,function(K){if(C.test(K)||h.test(K)){m.push(K);}});if(m.length>1){m.forEach(function(K){if(i.test(K)||j.test(K)){l=K;}});}else{l=m&&m[0];}return l;}function r(E,l){var U;if(l&&l.length>0){U=[];l.forEach(function(B){var C=-1;if(B.aLastContexts&&B.aLastContexts.length>0){B.aLastContexts.forEach(function(L,i){if(L.getPath()==="/"+E){C=i;}});}if(C>-1){U.push({"index":C,"bindingContext":B.aLastContexts[C],"bindingToUpdate":B,"isClientOperation":B.bClientOperation,"allKeys":B.aAllKeys});B.bClientOperation=true;B.aAllKeys=B.aKeys.slice();B.aKeys.splice(C,1);B.aLastContexts.splice(C,1);}});}return U;}function e(B){jQuery.each(B,function(E,C){C.forEach(function(t){t.bindingToUpdate.bClientOperation=true;t.bindingToUpdate.aAllKeys=t.bindingToUpdate.aKeys.slice();t.bindingToUpdate.aKeys.splice(t.index,0,E);t.bindingToUpdate.aLastContexts.splice(t.index,0,t.bindingContext);});});}function f(B){jQuery.each(B,function(E,C){C.forEach(function(t){t.bindingToUpdate.bClientOperation=t.isClientOperation;t.bindingToUpdate.aAllKeys=t.allKeys;});});}function s(E,k,D){var B={};var C={};var l=false;jQuery.each(E,function(i,h){function j(p){function q(N){if(N&&N.length>3){return N.substring(0,N.length-4);}return N;}if(p instanceof O){var v=p&&p.oEntityType&&p.oEntityType.name;v=q(v)+"Type"===v?q(v):undefined;return v===h||p.getPath()==="/"+h;}return false;}var m=g(h,k);var t=a.getProperty("/"+m);if(t){c(D,t);C[m]=true;var L=a.aBindings.filter(j);l=L.length>0;if(l){var n=r(m,L);if(n){B[m]=n;}}}});a.checkUpdate(true,false,C);if(l){e(B);a.checkUpdate(true,false,C);f(B);}}b.putApplicationObject=function(h,i){var j=i.getApplicationObject().getMetadata().getName();if(!o[j]){o[j]={};}if(!o[j][h]){o[j][h]=[];}var I=o[j][h];if(jQuery.inArray(i,I)===-1){I.push(i);}};b.removeApplicationObject=function(h,i){var j=i.getApplicationObject().getMetadata().getName();var I=o&&o[j]&&o[j][h];if(I){o[j][h]=jQuery.grep(I,function(k,l){return i!==k;});}};b.getApplicationObject=function(h,i){return o&&o[h]&&o[h][i];};b.addAOInstanceDependency=function(h,D,S){if(h&&D&&S){var i=d[h];if(!i){d[h]={};i=d[h];}i[D]={"dependentModel":D,"syncFunction":S};return true;}return false;};b.setODataModel=function(n){a=n;};b.getODataModel=function(){return a;};b._getApplicationObjectByName=function(i){jQuery.sap.require(i);return jQuery.sap.getObject(i,0);};b.syncEntity=function(E){var D=new jQuery.Deferred();var h=g(E.entitySetName,E.entitySetKey);if(h){a.read("/"+h,{success:function(i){s([E.entitySetName],E.entitySetKey,i);D.resolve({success:true});},error:function(R){if(R.response.statusCode!==404){jQuery.sap.log.error("Error when retrieving "+E.entitySetKey,undefined,"sap.ino.commons.models.core.ModelSynchronizer");}D.reject({success:true});}});}else{D.reject({success:true});}return D.promise();};b.update=function(I,h,j,k,D,C){if(I){j=j||I.getApplicationObject();k=k||I.getKey();D=D||I.getData();}var E=j&&j.invalidation&&j.invalidation.entitySets;var l;if(D){if(E){s(E,k,D);}l=k&&j&&b.getApplicationObject(j.getMetadata().getName(),k);if(l&&l.length>1){jQuery.each(l,function(i,v){if(v!==I){u(D,v);}});if(I&&I.getPropertyModel()){I.getPropertyModel().getDataInitializedPromise().done(function(){jQuery.each(l,function(i,v){if(v!==I&&v.getPropertyModel()){v.getPropertyModel().sync(k,true);}});});}}}else{if(!I&&k&&h!=="del"){var m=j.getMetadata().getName();var S=b._getApplicationObjectByName(m);var n=S.readData(k,{model:a,onlyRoot:true});if(n){n.done(function(i){if(E){s(E,k,i);}var v=b.getApplicationObject(m,k);if(v){jQuery.each(v,function(w,x){u(i,x);});}});}P.invalidateCachedProperties(j.getObjectName(),k);}}var p=h&&j.actionImpacts&&j.actionImpacts[h];var q=[];if(p){p.forEach(function(i){if(i.objectName!==undefined){q.push(i);}});}if(q&&q.length>0){jQuery.each(q,function(i,v){var w=v.objectName;var x=C&&v.objectKey&&C[v.objectKey];if(x&&!Array.isArray(x)){x=[x];}if(x&&w){var y=b._getApplicationObjectByName(w);var z=y.getMetadata().getName();var B={model:a,projection:v.impactedAttributes};jQuery.each(x,function(F,G){var H=y.readSource(G,z,{},B);H.done(function(T){var J=y&&y.invalidation&&y.invalidation.entitySets;s(J,G,T);l=b.getApplicationObject(w,G);if(l){jQuery.each(l,function(K,L){u(T,L);});}});});}});}if(p){p.forEach(function(i){if(i.entitySetName!==undefined){b.syncEntity(i);}});}var t=I&&d&&d[I];if(t){jQuery.each(t,function(i,v){if(v&&v.dependentModel&&v.syncFunction){v.syncFunction(I,v.dependentModel);}});}if(h==="del"&&l){l.forEach(function(i){b.removeApplicationObject(I.getKey(),i);i._isDeleted=true;});delete o[j.getMetadata().getName()][k];}};A.attachChange(A.Action.All,function(E){var i=E.getParameter("instance");var h=E.getParameter("actionName");var j=E.getParameter("object");var k=E.getParameter("key");var D=E.getParameter("dataUpdate");var C=E.getParameter("changeRequest");b.update(i,h,j,k,D,C);});return b;});};if(!jQuery.sap.isDeclared('sap.ino.controls.Campaign')){jQuery.sap.declare('sap.ino.controls.Campaign');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.InvisibleText');jQuery.sap.require('sap.m.Image');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.FormattedText');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/Campaign",["sap/ui/core/Control","sap/ui/core/InvisibleText","sap/m/Image","sap/m/Link","sap/m/Text","sap/m/FormattedText","sap/m/Button","sap/ino/controls/util/ColorSupport","sap/ino/controls/LabelledIcon","sap/ui/Device","sap/ui/core/ResizeHandler","sap/ino/controls/CampaignType","sap/ino/controls/CampaignStatusType","sap/ino/commons/application/Configuration","sap/base/security/sanitizeHTML"],function(C,I,a,L,T,F,B,b,c,D,R,d,e,f,s){"use strict";var g=C.extend("sap.ino.controls.Campaign",{metadata:{properties:{"color":{type:"sap.ui.core.CSSColor",defaultValue:"#FFFFFF"},"objectId":{type:"int"},"isManaged":{type:"string",defaultValue:"false"},"href":{type:"sap.ui.core.URI"},"title":{type:"string"},"type":{type:"sap.ino.controls.CampaignType",defaultValue:"Banner"},"status":{type:"sap.ino.controls.CampaignStatusType",defaultValue:e.Published},"width":{type:"sap.ui.core.CSSSize",defaultValue:"300px"},"height":{type:"sap.ui.core.CSSSize",defaultValue:"160px"},"image":{type:"sap.ui.core.URI"},"date":{type:"string"},"submissionDate":{type:"string"},"registrationDate":{type:"string"},"dateTooltip":{type:"string"},"submissionDateTooltip":{type:"string"},"registrationDateTooltip":{type:"string"},"ideaCount":{type:"sap.ui.model.odata.type.Int64"},"participantCount":{type:"sap.ui.model.odata.type.Int64"},"activeParticipantCount":{type:"sap.ui.model.odata.type.Int64"},"viewCount":{type:"sap.ui.model.odata.type.Int64"},"openForSubmission":{type:"boolean"},"openForRegistration":{type:"boolean"},"isInnovationView":{type:"string",defaultValue:"true"},},aggregations:{"_image":{type:"sap.m.Image",multiple:false,visibility:"hidden"},"_title":{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},"_date":{type:"sap.m.FormattedText",multiple:false,visibility:"hidden"},"_submissionDate":{type:"sap.m.FormattedText",multiple:false,visibility:"hidden"},"_registrationDate":{type:"sap.m.FormattedText",multiple:false,visibility:"hidden"},"_ideaCount":{type:"sap.ino.controls.LabelledIcon",multiple:false,visibility:"hidden"},"_participantCount":{type:"sap.ino.controls.LabelledIcon",multiple:false,visibility:"hidden"},"_activeParticipantCount":{type:"sap.ino.controls.LabelledIcon",multiple:false,visibility:"hidden"},"_isManaged":{type:"string",defaultValue:"false"},"_viewCount":{type:"sap.ino.controls.LabelledIcon",multiple:false,visibility:"hidden"},"_createIdeaButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"registerButton":{type:"sap.ui.core.Control",multiple:false},"campaignSettingButton":{type:"sap.ui.core.Control",multiple:false},"_titleDescription":{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},"_createIdeaDescription":{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},"_registerDescription":{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},"_settingDescription":{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},"followButton":{type:"sap.ui.core.Control",multiple:false}},events:{press:{},createIdea:{},openSetting:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");this._sResizeRegId=R.register(this,this._onResize);},exit:function(){R.deregister(this._sResizeRegId);this.destroyAggregation('_image');},_onResize:function(E){var o=this.oControl||this;var i;if(o.getType()===d.Banner){var $=o.$().find(".sapInoCampaignInfo");var h=30;var j=20;if($&&$.length>0){var l=parseInt($.css("margin-left"),10)||0;if(E.size.width<2*parseInt(o.getWidth(),10)&&!o.$().hasClass("sapInoCampaignSqueeze")){o.$().addClass("sapInoCampaignSqueeze");return;}if(E.size.width<l+parseInt(o.getWidth(),10)+h&&!o.$().hasClass("sapInoCampaignShrink")){o._iLeftMargin=l;o.$().addClass("sapInoCampaignShrink");return;}if(E.size.width>(o._iLeftMargin||0)+parseInt(o.getWidth(),10)+h+j&&o.$().hasClass("sapInoCampaignShrink")){o.$().removeClass("sapInoCampaignShrink");if(D.system.phone){i=o._getImage();if(i&&!i.getVisible()){i.setVisible(true);}}return;}if(E.size.width>=2*parseInt(o.getWidth(),10)&&o.$().hasClass("sapInoCampaignSqueeze")){o.$().removeClass("sapInoCampaignSqueeze");return;}}}else{if(D.system.phone){i=o._getImage();if(i&&!i.getVisible()){i.setVisible(true);}}}},_getCount:function(k,i,t){var o=this.getAggregation("_"+k);if(!o&&this.getProperty(k)!==undefined){o=new c({iconUrl:i,label:this.getProperty(k),tooltip:this._oRB.getText(t)});this.setAggregation("_"+k,o,true);}return o;},_getIdeaCount:function(){return this._getCount("ideaCount","sap-icon://InoIcons/idea","CTRL_CAMPAIGN_EXP_IDEA_COUNT");},_getParticipantCount:function(){return this._getCount("participantCount","sap-icon://group","CTRL_CAMPAIGN_EXP_PARTICIPANT_COUNT");},_getActiveParticipantCount:function(){return this._getCount("activeParticipantCount","sap-icon://InoIcons/active-participates","CTRL_CAMPAIGN_EXP_ACTIVE_PARTICIPANT_COUNT");},_getViewCount:function(){return this._getCount("viewCount","sap-icon://show","CTRL_CAMPAIGN_EXP_VIEW_COUNT");},_getDate:function(){var o=this.getAggregation("_date");if(!o){o=new F({htmlText:this.getProperty("date")||"",tooltip:this.getProperty("dateTooltip")}).addStyleClass("sapInoCampaignDate sapInoCampaignMaxSize");this.setAggregation("_date",o,true);}return o;},_getSubmissionDate:function(){var o=this.getAggregation("_submissionDate");if(!o){o=new F({htmlText:this.getProperty("submissionDate")||"",tooltip:this.getProperty("submissionDateTooltip")}).addStyleClass("sapInoCampaignDate sapInoCampaignMaxSize");this.setAggregation("_submissionDate",o,true);}return o;},_getManaged:function(){var i=this.getAggregation("_isManaged");if(!i){i="false";}return i;},_getRegistrationDate:function(){var o=this.getAggregation("_registrationDate");if(!o){o=new F({htmlText:this.getProperty("registrationDate")||"",tooltip:this.getProperty("registrationDateTooltip")}).addStyleClass("sapInoCampaignDate sapInoCampaignMaxSize");this.setAggregation("_registrationDate",o,true);}return o;},_getImage:function(){var i=this.getAggregation("_image");if(!i){var u=this.getProperty("image");if(u){i=new a({src:u,mode:"Background",width:"100%",height:"100%",visible:!D.system.phone,densityAware:false});this.setAggregation("_image",i);}}return i;},_getTitleDescription:function(){var o=this.getAggregation("_titleDescription");if(!o){o=new I().setText(this._oRB.getText("CTRL_CAMPAIGN_EXP_NAV_LINK",[this.getProperty("title")]));if(this.getProperty("title")){this.setAggregation("_titleDescription",o);}}return o;},_getTitle:function(){var t=this;var o=this.getAggregation("_title");if(!o){var h=this.getProperty("title");if(h){if(this.getType()===d.Banner){if(this.hasListeners("press")){o=new L({ariaDescribedBy:t._getTitleDescription(),wrapping:true,href:jQuery.sap.validateUrl(this.getProperty("href"))?this.getProperty("href"):"",press:function(E){E.preventDefault();t.firePress({campaignId:t.getProperty("objectId")});}}).setText(h).addStyleClass("sapInoCampaignTitle sapInoCampaignMaxSize");}else{o=new T({wrapping:true}).setText(h).addStyleClass("sapInoCampaignTitle sapInoCampaignMaxSize");}}else{o=new L({ariaDescribedBy:t._getTitleDescription(),wrapping:true,href:jQuery.sap.validateUrl(this.getProperty("href"))?this.getProperty("href"):"",press:function(E){E.preventDefault();t.firePress({campaignId:t.getProperty("objectId")});}}).setText(h).addStyleClass("sapInoCampaignTitle sapInoCampaignMaxSize");}this.setAggregation("_title",o);}}return o;},_getCreateIdeaDescription:function(){var o=this.getAggregation("_createIdeaDescription");if(!o){o=new I({text:this._oRB.getText("CTRL_CAMPAIGN_EXP_CREATE_IDEA_DESCRIPTION",[this.getProperty("title")])});if(this.getProperty("title")){this.setAggregation("_createIdeaDescription",o);}}return o;},_getFollowButton:function(){var h=this.getAggregation("followButton");return h;},_getRegisterDescription:function(){var o=this.getAggregation("_registerDescription");if(!o){o=new I({text:this._oRB.getText("CTRL_CAMPAIGN_EXP_REGISTER_DESCRIPTION")});this.setAggregation("_registerDescription",o);}return o;},_getSettingButton:function(){var t=this;var S=this.getAggregation("campaignSettingButton");if(!S){S=new B({ariaDescribedBy:t._getSettingDescription(),icon:"sap-icon://action-settings",tooltip:t._oRB.getText("CTRL_CAMPAIGN_EXP_SETTING_DESCRIPTION"),press:function(E){E.preventDefault();t.fireOpenSetting();},enabled:true});this.setAggregation("campaignSettingButton",S,true);}return S;},_getSettingDescription:function(){var o=this.getAggregation("_settingDescription");if(!o){o=new I({text:this._oRB.getText("CTRL_CAMPAIGN_EXP_SETTING_DESCRIPTION")});this.setAggregation("_settingDescription",o);}return o;},_getRegisterButton:function(){var r=this.getAggregation('registerButton');if(r){r.addAriaDescribedBy(this._getRegisterDescription());}return r;},_getCreateIdeaButton:function(){var t=this;var o=this.getAggregation("_createIdeaButton");if(!o){o=new B({ariaDescribedBy:t._getCreateIdeaDescription(),icon:"sap-icon://InoIcons/idea-add",tooltip:t._oRB.getText("CTRL_CAMPAIGN_EXP_BTN_CREATE_IDEA"),press:function(E){E.preventDefault();t.fireCreateIdea({campaignId:t.getProperty("objectId")});},enabled:true});this.setAggregation("_createIdeaButton",o,true);}return o;},_displayCreateIdeaButton:function(){return this.getOpenForSubmission()&&this.hasListeners("createIdea");},onAfterRendering:function(){this._onResize({size:{width:this.$().width()}});var h=[".sapInoCampaignInfoBottomCounts",".sapInoCampaignInfoBottom"];var t=this;h.forEach(function(i){var $=t.$().find(".sapInoCampaignInfo");var j=t.$().find(".sapInoCampaignInfoTop");var k=t.$().find(".sapInoCampaignInfoBottom");var l=t.$().find(i);if($&&$.length>0&&j&&j.length>0&&k&&k.length>0){var m=(parseInt(j.css("padding-top"),10)||0)+(parseInt(j.css("padding-bottom"),10)||0);var n=(parseInt(k.css("padding-top"),10)||0)+(parseInt(k.css("padding-bottom"),10)||0);if($.height()<j.height()+m+k.height()+n){if(!l.hasClass("sapInoCampaignHide")){l.addClass("sapInoCampaignHide");}}}});this._initTabs();},renderer:function(r,o){var h=s(o.getColor());r.write("<div");r.writeControlData(o);r.addStyle("background-color",h);r.writeStyles();r.addClass("sapInoCampaign");r.addClass("sapInoCampaign"+s(o.getType()));if(!h){h="#FFFFFF";}r.addClass("sapInoCampaign"+b.calculateTitleTextColor(h.substr(1,2),h.substr(3,2),h.substr(5,2)));r.writeClasses();r.write(">");if(o.getType()===d.Banner){r.write("<style>#"+s(o.getId())+".sapInoCampaignSqueeze { height : "+s(o.getHeight())+"; }</style>");}o._renderContent(r,o);r.write("</div>");},_renderContent:function(r,o){var h=s(o.getColor());r.write("<div");r.addStyle("width",s(o.getWidth()));r.addStyle("height",s(o.getHeight()));r.writeStyles();r.write(">");var i=o.getWidth();if(o._getImage()&&o.getType()===d.Normal){i="60%";}else if(o._getImage()&&o.getType()===d.Small){i="50%";}else if(o._getImage()&&o.getType()===d.Banner){if(D.system.phone){i="97%";}r.write("<div");r.addStyle("width","100%");r.addStyle("height","100%");r.writeStyles();r.addClass("sapInoCampaignImage");r.writeClasses();r.write(">");r.renderControl(o._getImage());r.write("</div>");}r.write("<div");r.addStyle("width",i);r.addStyle("height",s(o.getHeight()));r.addStyle("background-color",h);r.writeStyles();r.addClass("sapInoCampaignInfo");r.writeClasses();r.write(">");r.write("<style>#"+s(o.getId())+" .sapInoCampaignMaxSize { max-width : calc("+s(o.getWidth())+" - 2rem); }</style>");r.write("<div");r.addClass("sapInoCampaignInfoTop");r.writeClasses();r.write(">");var t=o._getTitle();if(t){r.renderControl(t);if(o.getStatus()===e.Draft){r.write("<div");r.addClass("sapInoCampaignInfoDraftIndicator");r.writeClasses();r.write(">");r.write(o._oRB.getText("CTRL_CAMPAIGNCARD_MSG_DRAFT"));r.write("</div>");}if(t instanceof L){r.renderControl(o._getTitleDescription());}}r.write("</div>");r.write("<div");r.addClass("sapInoCampaignInfoBottom");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoCampaignInfoBottomDate");r.writeClasses();r.write(">");if(o.getOpenForRegistration()&&o._getRegistrationDate()){r.renderControl(o._getRegistrationDate());}else if(o._getSubmissionDate()){r.renderControl(o._getSubmissionDate());}if(o._getDate()){r.renderControl(o._getDate());}r.write("</div>");r.write("<div");r.addClass("sapInoCampaignInfoBottomCounts");r.writeClasses();r.write(">");if(o._getIdeaCount()){r.renderControl(o._getIdeaCount().addStyleClass("sapInoCampaignInfoBottomCount"));}if(o._getViewCount()&&this.getProperty("isInnovationView")==="true"){r.renderControl(o._getViewCount().addStyleClass("sapInoCampaignInfoBottomCount"));}if(o._getParticipantCount()&&this.getProperty("isInnovationView")==="true"){r.renderControl(o._getParticipantCount().addStyleClass("sapInoCampaignInfoBottomCount"));}if(o._getActiveParticipantCount()&&this.getProperty("isInnovationView")==="true"){r.renderControl(o._getActiveParticipantCount().addStyleClass("sapInoCampaignInfoBottomCount"));}r.write("</div>");r.write("</div>");r.write("</div>");if(o._getImage()&&(o.getType()===d.Normal||o.getType()===d.Small)){var w=100-parseInt(i,10);r.write("<div");r.addStyle("width",w+"%");r.addStyle("height",o.getHeight());r.writeStyles();r.addClass("sapInoCampaignImage");r.writeClasses();r.write(">");r.renderControl(o._getImage());r.write("</div>");}r.write("<div");r.addClass("sapInoCampaignClear");r.writeClasses();r.write(">");r.write("</div>");r.write("<div");r.addClass('sapInoCampaignButtons');r.writeClasses();r.write('>');r.write("<div");r.addClass('sapInoCampaignRegisterButton');r.writeClasses();r.write('>');if(o._getRegisterButton()&&o._getRegisterButton().getVisible()){r.renderControl(o._getRegisterButton());r.renderControl(o._getRegisterDescription());}r.write('</div>');r.write("<div");r.addClass("sapInoCampaignCreateIdeaButton");r.writeClasses();r.write(">");if(o._displayCreateIdeaButton()&&o.getType()==="Normal"){r.renderControl(o._getCreateIdeaButton());r.renderControl(o._getCreateIdeaDescription());}r.write("</div>");r.write("<div");r.addClass('sapInoCampaignFollowButton');r.writeClasses();r.write('>');r.renderControl(o._getFollowButton());r.write('</div>');r.write("<div");r.addClass('sapInoCampaignFollowButton');r.writeClasses();r.write('>');if(this.getProperty("isManaged")==="true"){r.renderControl(o._getSettingButton());}r.write('</div>');r.write("</div>");r.write("</div>");},ontap:function(E){if((E.srcControl&&E.srcControl.sParentAggregationName==="_follow")||(E.srcControl.getParent()&&E.srcControl.getParent().sParentAggregationName==="_follow")){return false;}if((E.srcControl&&E.srcControl.sParentAggregationName==="registerButton")||(E.srcControl.getParent()&&E.srcControl.getParent().sParentAggregationName==="registerButton")){return false;}if((!E.srcControl||E.srcControl!==this._getCreateIdeaButton())&&(!E.srcControl.getParent()||(E.srcControl.getParent()&&E.srcControl.getParent()!==this._getCreateIdeaButton()))){if((!E.srcControl||E.srcControl!==this._getSettingButton())&&(!E.srcControl.getParent()||(E.srcControl.getParent()&&E.srcControl.getParent()!==this._getSettingButton()))){E.stopPropagation();this.firePress({campaignId:this.getObjectId()});}}},getFocusDomRef:function(){if(this._getTitle()instanceof L){return this._getTitle().$();}else if(this._displayCreateIdeaButton()){this._getCreateIdeaButton().$();}else{return undefined;}},_initTabs:function(){this._tabs=[];if(this._getTitle()instanceof L){this._tabs.push(this._getTitle().$()[0].id);}if(this._displayCreateIdeaButton()&&this.getType()==="Normal"){this._tabs.push(this._getCreateIdeaButton().$()[0].id);}if(this.getAggregation("followButton")){this._tabs.push(this.getAggregation("followButton").$().find("[tabindex=0],button")[0].id);}if(this.getAggregation('registerButton')&&this.getAggregation('registerButton').$().length){this._tabs.push(this.getAggregation('registerButton').$()[0].id);}},_getTabs:function(){return this._tabs;},_defaultOnKeyDown:function(E){if(C.prototype.onkeydown){C.prototype.onkeydown.apply(this,arguments);}},onkeydown:function(E){var t=this._getTabs();var u=this._incr;if(this.getType()!==d.Normal){this._defaultOnKeyDown(E);return;}if(E.shiftKey||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){u=this._decr;}if(E.keyCode===jQuery.sap.KeyCodes.ESCAPE){this.getParent().focus();}else if(E.keyCode===jQuery.sap.KeyCodes.TAB||E.keyCode===jQuery.sap.KeyCodes.ARROW_DOWN||E.keyCode===jQuery.sap.KeyCodes.ARROW_RIGHT||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){var $=jQuery(":focus");var i=-1;if($&&$.length>0){i=t.indexOf($[0].id);if(i!==-1){i=u(i,t.length-1);this._focus(jQuery("#"+t[i]));E.preventDefault();E.stopPropagation();}else{this.getParent().focus();}}else{this.getParent().focus();}}else{this._defaultOnKeyDown(E);}event.stopPropagation();},_incr:function(v,m){v++;if(v>m){return 0;}return v;},_decr:function(v,m){v--;if(v<0){return m;}return v;},_focus:function(E){if(jQuery.type(E.focus)==="function"){setTimeout(function(){E.focus();},0);}}});g.prototype.setDate=function(v){this.setProperty("date",v);this._getDate().setHtmlText(v);};g.prototype.setSubmissionDate=function(v){this.setProperty("submissionDate",v);this._getSubmissionDate().setHtmlText(v);};g.prototype.setRegistrationDate=function(v){this.setProperty("registrationDate",v);this._getRegistrationDate().setHtmlText(v);};g.prototype.setDateTooltip=function(v){this.setProperty("dateTooltip",v);this._getDate().setTooltip(v);};g.prototype.setSubmissionDateTooltip=function(v){this.setProperty("submissionDateTooltip",v);this._getSubmissionDate().setTooltip(v);};g.prototype.setRegistrationDateTooltip=function(v){this.setProperty("registrationDateTooltip",v);this._getRegistrationDate().setTooltip(v);};g.prototype.setIdeaCount=function(v){this.setProperty("ideaCount",v);if(this._getIdeaCount()){this._getIdeaCount().setLabel(v);}};g.prototype.setParticipantCount=function(v){this.setProperty("participantCount",v);if(this._getParticipantCount()){this._getParticipantCount().setLabel(v);}};g.prototype.setActiveParticipantCount=function(v){this.setProperty("activeParticipantCount",v);if(this._getActiveParticipantCount()){this._getActiveParticipantCount().setLabel(v);}};g.prototype.setViewCount=function(v){this.setProperty("viewCount",v);if(this._getViewCount()){this._getViewCount().setLabel(v);}};g.prototype.RegistrationenForSubmission=function(v){this.setProperty("openForSubmission",v);};g.prototype.setOpenForRegistration=function(v){this.setProperty("openForRegistration",v);};g.prototype.setTitle=function(v){this.setProperty("title",v);if(this._getTitle()){this._getTitle().setText(v);}};g.prototype.setHref=function(v){this.setProperty("href",v);if(this._getTitle()&&this._getTitle().setHref){this._getTitle().setHref(v);}};g.prototype.setImage=function(v){this.setProperty("image",v);if(this._getImage()){this._getImage().setSrc(v);}};return g;});};if(!jQuery.sap.isDeclared('sap.ino.controls.CampaignFollowButton')){jQuery.sap.declare('sap.ino.controls.CampaignFollowButton');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.InvisibleText');jQuery.sap.require('sap.m.Image');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/CampaignFollowButton",["sap/ui/core/Control","sap/ui/core/InvisibleText","sap/m/Image","sap/m/Link","sap/m/Text","sap/m/Button","sap/ino/controls/util/ColorSupport","sap/ino/controls/LabelledIcon","sap/ui/Device","sap/ui/core/ResizeHandler","sap/ino/controls/CampaignType","sap/ino/controls/CampaignStatusType","sap/ino/commons/application/Configuration","sap/base/security/sanitizeHTML"],function(C,I,a,L,T,B,b,c,D,R,d,e,f,s){"use strict";var g=C.extend("sap.ino.controls.CampaignFollowButton",{metadata:{properties:{"objectId":{type:"int"},"type":{type:"sap.ino.controls.CampaignType",defaultValue:"Normal"},"openForSubmission":{type:"boolean"},"openForRegistration":{type:"boolean"}},aggregations:{"_createIdeaButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"registerButton":{type:"sap.ui.core.Control",multiple:false},"campaignSettingButton":{type:"sap.ui.core.Control",multiple:false},"_createIdeaDescription":{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},"_registerDescription":{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},"_settingDescription":{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},"followButton":{type:"sap.ui.core.Control",multiple:false}},events:{createIdea:{},openSetting:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");this._sResizeRegId=R.register(this,this._onResize);},exit:function(){R.deregister(this._sResizeRegId);this.destroyAggregation('_image');},_getCreateIdeaDescription:function(){var o=this.getAggregation("_createIdeaDescription");return o;},_getFollowButton:function(){var h=this.getAggregation("followButton");return h;},_getRegisterDescription:function(){var o=this.getAggregation("_registerDescription");if(!o){o=new I({text:this._oRB.getText("CTRL_CAMPAIGN_EXP_REGISTER_DESCRIPTION")});this.setAggregation("_registerDescription",o);}return o;},_getSettingButton:function(){var t=this;var S=this.getAggregation("campaignSettingButton");if(!S){S=new B({ariaDescribedBy:t._getSettingDescription(),icon:"sap-icon://action-settings",tooltip:t._oRB.getText("CTRL_CAMPAIGN_EXP_SETTING_DESCRIPTION"),type:"Transparent",press:function(E){E.preventDefault();t.fireOpenSetting();},enabled:true});this.setAggregation("campaignSettingButton",S,true);}return S;},_getSettingDescription:function(){var o=this.getAggregation("_settingDescription");if(!o){o=new I({text:this._oRB.getText("CTRL_CAMPAIGN_EXP_SETTING_DESCRIPTION")});this.setAggregation("_settingDescription",o);}return o;},_getRegisterButton:function(){var r=this.getAggregation('registerButton');if(r){r.addAriaDescribedBy(this._getRegisterDescription());}return r;},_getCreateIdeaButton:function(){var t=this;var o=this.getAggregation("_createIdeaButton");if(!o){o=new B({ariaDescribedBy:t._getCreateIdeaDescription(),icon:"sap-icon://InoIcons/idea-add",tooltip:t._oRB.getText("CTRL_CAMPAIGN_EXP_BTN_CREATE_IDEA"),type:"Transparent",press:function(E){E.preventDefault();t.fireCreateIdea({campaignId:t.getProperty("objectId")});},enabled:true});this.setAggregation("_createIdeaButton",o,true);}return o;},_displayCreateIdeaButton:function(){return this.getOpenForSubmission()&&this.hasListeners("createIdea");},renderer:function(r,o){r.renderControl(o._getRegisterButton());r.renderControl(o._getRegisterDescription());if(o._displayCreateIdeaButton()){r.renderControl(o._getCreateIdeaButton());r.renderControl(o._getCreateIdeaDescription());}r.renderControl(o._getFollowButton());if(o.getType()==="Managed"){r.renderControl(o._getSettingButton());}},ontap:function(E){if((E.srcControl&&E.srcControl.sParentAggregationName==="_follow")||(E.srcControl.getParent()&&E.srcControl.getParent().sParentAggregationName==="_follow")){return false;}if((E.srcControl&&E.srcControl.sParentAggregationName==="registerButton")||(E.srcControl.getParent()&&E.srcControl.getParent().sParentAggregationName==="registerButton")){return false;}if((!E.srcControl||E.srcControl!==this._getCreateIdeaButton())&&(!E.srcControl.getParent()||(E.srcControl.getParent()&&E.srcControl.getParent()!==this._getCreateIdeaButton()))){if((!E.srcControl||E.srcControl!==this._getSettingButton())&&(!E.srcControl.getParent()||(E.srcControl.getParent()&&E.srcControl.getParent()!==this._getSettingButton()))){E.stopPropagation();this.firePress({campaignId:this.getObjectId()});}}},_initTabs:function(){this._tabs=[];if(this._displayCreateIdeaButton()){this._tabs.push(s(this._getCreateIdeaButton().$()[0].id));}if(this.getAggregation("followButton")){this._tabs.push(s(this.getAggregation("followButton").$().find("[tabindex=0],button")[0].id));}if(this.getAggregation('registerButton')&&this.getAggregation('registerButton').$().length){this._tabs.push(s(this.getAggregation('registerButton').$()[0].id));}},_getTabs:function(){return this._tabs;},_defaultOnKeyDown:function(E){if(C.prototype.onkeydown){C.prototype.onkeydown.apply(this,arguments);}},onkeydown:function(E){var t=this._getTabs();var u=this._incr;if(this.getType()!==d.Normal){this._defaultOnKeyDown(E);return;}if(E.shiftKey||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){u=this._decr;}if(E.keyCode===jQuery.sap.KeyCodes.ESCAPE){this.getParent().focus();}else if(E.keyCode===jQuery.sap.KeyCodes.TAB||E.keyCode===jQuery.sap.KeyCodes.ARROW_DOWN||E.keyCode===jQuery.sap.KeyCodes.ARROW_RIGHT||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){var $=jQuery(":focus");var i=-1;if($&&$.length>0){i=t.indexOf($[0].id);if(i!==-1){i=u(i,t.length-1);this._focus(jQuery("#"+t[i]));E.preventDefault();E.stopPropagation();}else{this.getParent().focus();}}else{this.getParent().focus();}}else{this._defaultOnKeyDown(E);}event.stopPropagation();},_incr:function(v,m){v++;if(v>m){return 0;}return v;},_decr:function(v,m){v--;if(v<0){return m;}return v;},_focus:function(E){if(jQuery.type(E.focus)==="function"){setTimeout(function(){E.focus();},0);}}});g.prototype.RegistrationenForSubmission=function(v){this.setProperty("openForSubmission",v);};g.prototype.setOpenForRegistration=function(v){this.setProperty("openForRegistration",v);};return g;});};if(!jQuery.sap.isDeclared('sap.ino.controls.ColorBar')){jQuery.sap.declare('sap.ino.controls.ColorBar');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.OverflowToolbarRenderer');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/ino/controls/ColorBar",["sap/ino/controls/util/ColorSupport","sap/m/OverflowToolbar","sap/m/OverflowToolbarRenderer","sap/ui/Device"],function(C,B,a,D){"use strict";return B.extend("sap.ino.controls.ColorBar",{metadata:{properties:{"backgroundColor":{type:"sap.ui.core.CSSColor"},"enablePhone":{type:"boolean",defaultValue:false}}},renderer:a,onAfterRendering:function(){var $=jQuery(this.getDomRef());$.addClass("sapInoColorBar");if(this.getProperty("enablePhone")){$.addClass("sapInoColorBarPhoneEnabled");}if(!D.system.phone||this.getProperty("enablePhone")){var b=this.getProperty("backgroundColor");if(b&&b.length===7){var t=C.calculateTitleTextColor(b.substr(1,2),b.substr(3,2),b.substr(5,2));$.css("background-color",b);$.css("background",b);$.addClass("sapInoColorBarText"+t);}}},onfocusin:function(){}});});};if(!jQuery.sap.isDeclared('sap.ino.controls.EvaluationMatrix')){jQuery.sap.declare('sap.ino.controls.EvaluationMatrix');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/ino/controls/EvaluationMatrix",["sap/ui/core/Control","sap/ino/controls/EvaluationMatrixItem","sap/ui/thirdparty/d3"],function(C,E,a){"use strict";return C.extend("sap.ino.controls.EvaluationMatrix",{metadata:{properties:{width:{type:"float",defaultValue:500},height:{type:"float",defaultValue:500},xMin:{type:"float",defaultValue:0},xMax:{type:"float",defaultValue:50},xLabel:{type:"string"},xLabelUom:{type:"string"},yMin:{type:"float",defaultValue:0},yMax:{type:"float",defaultValue:50},yLabel:{type:"string"},yLabelUom:{type:"string"},r1Min:{type:"float",defaultValue:0},r1Max:{type:"float",defaultValue:null},r2Min:{type:"float",defaultValue:0},r2Max:{type:"float",defaultValue:null},rMin:{type:"float",defaultValue:6},rMax:{type:"float",defaultValue:25},xSegments:{type:"int",defaultValue:2},ySegments:{type:"int",defaultValue:2},mode:{type:"string",defaultValue:"radio"},clickable:{type:"boolean",defaultValue:true},selectedItemName:{type:"string",defaultValue:"item"},legendHeight:{type:"float",defaultValue:0},displayLegend:{type:"boolean",defaultValue:false},innerCircleText:"string",outerCircleText:"string"},aggregations:{"items":{type:"sap.ino.controls.EvaluationMatrixItem",multiple:true,singularName:"item",bindable:true},"evalData":{type:"sap.ino.controls.EvaluationData",multiple:true,singularName:"datum",bindable:true}},events:{"itemSelected":{}}},renderer:function(c,d){c.write("<div");c.writeControlData(d);c.addClass("matrix");c.writeClasses();c.write(">");c.write("</div>");},determineRadiusMax:function(){var I=this.getItems();var i,c;this._r1MaxCalc=null;if(this.getR1Max()){this._r1MaxCalc=this.getR1Max();}else if(I.length>0){for(i=0;i<I.length;i++){c=I[i];if(!this._r1MaxCalc||this._r1MaxCalc<c.getR1Value()){this._r1MaxCalc=c.getR1Value();}}}this._r2MaxCalc=null;if(this.getR2Max()){this._r2MaxCalc=this.getR2Max();}else if(I.length>0){for(i=0;i<I.length;i++){c=I[i];if(!this._r2MaxCalc||this._r2MaxCalc<c.getR2Value()){this._r2MaxCalc=c.getR2Value();}}}},onBeforeRendering:function(){this.prepareMatrix();},prepareMatrix:function(){this.removeAllAggregation("items",true);var d=this.getEvalData();var c;var j;if(d.length===0){return;}for(var i=0;i<d.length;i++){var M=d[i].findValueByAggregationTypeMatrix();if(M){this.setXSegments(M.getXAxisSegmentNo());this.setYSegments(M.getYAxisSegmentNo());var x=d[i].findValueByCriterionCode(M.getXAxisCriterionCode());var y=d[i].findValueByCriterionCode(M.getYAxisCriterionCode());if(y&&x){this.setXLabel(x.getCriterionName());if(x.getUomCode()){this.setXLabelUom(x.getXAxisCriterionCodeLabel());}this.setYLabel(y.getCriterionName());if(y.getUomCode()){this.setYLabelUom(y.getYAxisCriterionCodeLabel());}if(M.getVisParam1CriterionCode()){c=d[i].findValueByCriterionCode(M.getVisParam1CriterionCode());}if(M.getVisParam2CriterionCode()){j=d[i].findValueByCriterionCode(M.getVisParam2CriterionCode());}var l=new sap.ino.controls.EvaluationMatrixItem({name:d[i].getEvaluationId()});if(x.getCriterionValue()){l.setXValue(parseFloat(x.getCriterionValue()));l.setXValueDataType(x.getCriterionDataType());}if(x.getValueMin()){this.setXMin(x.getValueMin());}if(x.getValueMax()){this.setXMax(x.getValueMax());}if(y.getCriterionValue()){l.setYValue(parseFloat(y.getCriterionValue()));l.setYValueDataType(y.getCriterionDataType());}if(y.getValueMin()){this.setYMin(y.getValueMin());}if(y.getValueMax()){this.setYMax(y.getValueMax());}if(c){if(c.getCriterionValue()){l.setR1Value(parseFloat(c.getCriterionValue()));l.setR1ValueDataType(c.getCriterionDataType());}if(c.getValueMin()){this.setR1Min(c.getValueMin());}if(c.getValueMax()){this.setR1Max(c.getValueMax());}}if(j){if(j.getCriterionValue()){l.setR2Value(parseFloat(j.getCriterionValue()));l.setR2ValueDataType(j.getCriterionDataType());}if(j.getValueMin()){this.setR2Min(j.getValueMin());}if(j.getValueMax()){this.setR2Max(j.getValueMax());}}this.addItem(l);}}}},onAfterRendering:function(){var c={top:10,right:10,bottom:30,left:30};if(this.getDisplayLegend()){c.bottom+=this.getLegendHeight();}this.determineRadiusMax();var d=D(this.getItems());var l=this.getWidth()-c.left-c.right;var p=this.getHeight()-c.top-c.bottom;var x=a.scale.linear().domain([this.getXMin(),this.getXMax()]).range([0,l]);var y=a.scale.linear().domain([this.getYMin(),this.getYMax()]).range([p,0]);var G=this.getR1Min()<this.getR2Min()?this.getR1Min():this.getR2Min();var H=this._r1MaxCalc>this._r2MaxCalc?this._r1MaxCalc:this._r2MaxCalc;var r=a.scale.linear().domain([G,H]).range([this.getRMin(),this.getRMax()]);var I=a.select("#"+this.getId());var J=s(I,l,p,c);var K=this.getXMax()-this.getXMin();var X=K/this.getXSegments();var i,j;for(i=1;i<=this.getXSegments();i++){e(J,x(this.getXMin()+i*X),y(this.getYMin()),y(this.getYMax()));}var L=this.getYMax()-this.getYMin();var Y=L/this.getYSegments();for(j=1;j<=this.getYSegments();j++){b(J,x(this.getXMin()),x(this.getXMax()),y(this.getYMin()+j*Y));}f(J,x(this.getXMin()),x(this.getXMax()),y(this.getYMin()),this.getXLabel(),this.getXLabelUom());g(J,y(this.getYMin()),this.getYLabel(),this.getYLabelUom());var M=this.getEvalData();for(i=0;i<M.length;i++){var N=M[i].findValueByAggregationTypeMatrix();if(N){var O=N.getValueOptionListLabelCodes();if(O){for(j=0;j<O.length;j++){var Q=O[j];var P=Q.CODE-1;if(P>=0){var R=P%this.getXSegments();var S=Math.floor(P/this.getXSegments());h(J,x(this.getXMin()+R*X+0.5*X),y(this.getYMin()+(1+S)*Y)+20,Q.TEXT,x(this.getXMin()+X),this.getXSegments());}}}}}var T=k(this,J,x,y,d);m(this,T,x,y,d);o(this,T,r,this.getMode(),this.getClickable());var U=jQuery(this.getDomRef()).find("g[name='circleGroup_"+this.getSelectedItemName()+"']")[0];if(U){t(this,U,this.getMode());}}});function w(c){var d=a.select(this),i=d.node().getComputedTextLength(),j=d.text();while(i>260&&j.length>0){j=j.slice(0,-1);d.text(j+'...');i=d.node().getComputedTextLength();}}function s(c,d,i,j){var l=c.append("svg").attr("width",d+j.left+j.right).attr("focusable","false").attr("height",i+j.top+j.bottom).attr("class","sapUiInoEvaluationMatrixSvgElement").append("g").attr("transform","translate("+j.left+","+j.top+")");return l;}function b(c,x,d,y){var l=c.append("g").attr("class","sapUiInoEvaluationMatrixLine").attr("transform","translate("+x+","+y+")").append("svg:line").attr("x1",0).attr("y1",0).attr("x2",d-x).attr("y2",0);return l;}function e(c,x,y,d){var l=c.append("g").attr("class","sapUiInoEvaluationMatrixLine").attr("transform","translate("+x+","+y+")").append("svg:line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",d-y);return l;}function f(c,x,d,y,l,i){var L=i?l+" ["+i+"]":l;var j=c.append("g").attr("class","sapUiInoEvaluationMatrixAxis").attr("transform","translate("+x+","+y+")");j.append("svg:line").attr("x1",0).attr("y1",0).attr("x2",d+1).attr("y2",0);j.append("svg:text").attr("transform","translate("+d+",0)").attr("class","sapUiInoEvaluationMatrixLabel").attr("y","25").attr("x","0").style("text-anchor","end").text(L);return j;}function g(c,y,l,d){var L=d?l+" ["+d+"]":l;var i=c.append("g").attr("class","sapUiInoEvaluationMatrixAxis");i.append("svg:line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",y+1);i.append("svg:text").attr("transform","rotate(-90)").attr("class","sapUiInoEvaluationMatrixLabel").attr("x","0").attr("y","-18").style("text-anchor","end").text(L);return i;}function h(c,x,y,l,d,i){var j="sapUiInoEvaluationMatrixQuadrant sapUiInoEvaluationMatrixQuadrantSegments"+i;var p=c.append("g").attr("transform","translate("+x+","+y+")").append("svg:text").attr("class",j).style("text-anchor","middle").text(l);return p;}function k(c,i,x,y,j){var l=i.selectAll("circle").data(j).enter().append("g").attr("name","circleEnter").attr("transform",function(d){return"translate("+x(d.xValue)+","+y(d.yValue)+")";});return l;}function m(c,i,x,y,j){var l=i.append("g").attr("class","sapUiInoEvaluationMatrixHidden").attr("name",function(d){return"coord_"+d.name;});l.append("svg:line").attr("x1",0).attr("y1",0).attr("x2",function(d){var p=-x(d.xValue);return p;}).attr("y2",0).attr("class","sapUiInoEvaluationMatrixValueLine");l.append("svg:line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",function(d){var p=y(c.getYMax()-d.yValue+c.getYMin());return p;}).attr("class","sapUiInoEvaluationMatrixValueLine");l.append("svg:text").attr("transform",function(d){var p=-x(d.xValue);return"translate("+(p-17)+", 5)";}).attr("class","sapUiInoEvaluationMatrixCoordinate").text(function(d){return F(d.yValueDataType,d.yValue);});l.append("svg:text").attr("transform",function(d){var p=y(c.getYMax()-d.yValue+c.getYMin());return"translate(0, "+(p+14)+")";}).attr("class","sapUiInoEvaluationMatrixCoordinate").style("text-anchor","middle").text(function(d){return F(d.xValueDataType,d.xValue);});n(c,l,x,y);return l;}function n(c,j,x,y){var l=c.getEvalData();var r,R,p,G;for(var i=0;i<l.length;i++){var M=l[i].findValueByAggregationTypeMatrix();if(M){var H,I;if(M.getVisParam1CriterionCode()){H=l[i].findValueByCriterionCode(M.getVisParam1CriterionCode());if(H){r=H.getCriterionLabel();p=H.getVisParam1CriterionCodeLabel();}}if(M.getVisParam2CriterionCode()){I=l[i].findValueByCriterionCode(M.getVisParam2CriterionCode());if(I){R=I.getCriterionLabel();G=I.getVisParam2CriterionCodeLabel();}}}}if(c.getDisplayLegend()&&r&&R){j.append("svg:circle").attr("cx",function(d){var J=-x(d.xValue);return J+3;}).attr("cy",function(d){var J=y(c.getYMax()-d.yValue+c.getYMin());return J+40;}).attr("r",6).attr("class",function(d){if(d.r1Value<=d.r2Value){return"sapUiInoEvaluationMatrixInnerCircleHighlight";}else{return"sapUiInoEvaluationMatrixOuterCircleHighlight";}});j.append("svg:text").attr("transform",function(d){var J=-x(d.xValue);var K=y(c.getYMax()-d.yValue+c.getYMin());return"translate("+(J+15)+", "+(K+45)+")";}).text(function(d){var L;if(d.r1Value<=d.r2Value){L=r;if(p){L=L+" "+p;}}else{L=R;if(G){L=L+" "+G;}}return L+" ("+c.getInnerCircleText()+")";}).each(w);j.append("svg:circle").attr("cx",function(d){var J=-x(d.xValue);return J+3;}).attr("cy",function(d){var J=y(c.getYMax()-d.yValue+c.getYMin());return J+60;}).attr("r",6).attr("class",function(d){if(d.r1Value>d.r2Value){return"sapUiInoEvaluationMatrixInnerCircleHighlight";}else{return"sapUiInoEvaluationMatrixOuterCircleHighlight";}});j.append("svg:text").attr("transform",function(d){var J=-x(d.xValue);var K=y(c.getYMax()-d.yValue+c.getYMin());return"translate("+(J+15)+", "+(K+65)+")";}).text(function(d){var L;if(d.r1Value>d.r2Value){L=r;if(p){L=L+" "+p;}}else{L=R;if(G){L=L+" "+G;}}return L+" ("+c.getOuterCircleText()+")";}).each(w);}}function o(i,j,r,l,p){var c=j.append("g").attr("name",function(d){return"circleGroup_"+d.name;});c.append("svg:circle").attr("cx",0).attr("cy",0).attr("r",function(d){return r(d.r2Value);}).attr("class","sapUiInoEvaluationMatrixOuterCircle").attr("name","outerCircle").attr("title",function(d){return d.r2Value;});c.append("svg:circle").attr("cx",0).attr("cy",0).attr("r",function(d){return r(d.r1Value);}).attr("class","sapUiInoEvaluationMatrixInnerCircle").attr("name","innerCircle").attr("title",function(d){return d.r1Value;});c.select("circle").each(function(d){if(d.r2Value<d.r1Value){var x=this.parentNode;x.appendChild(x.removeChild(this));}});if(p){c.on("click",function(d){i.setSelectedItemName(q(this),true);i.fireItemSelected({itemName:q(this)});});}c.append("svg:text").attr("transform",function(d){var x=d.r1Value>d.r2Value?d.r1Value:d.r2Value;return"translate("+(r(x)+4)+", 4)";}).attr("class","sapUiInoEvaluationMatrixItemName").text(function(d){return d.name;});}function q(c){var p=c.attributes.name.value.split("_");if(p&&p.length>1){return p[1];}return c.attributes.name.value;}function t(c,d,i){var j=jQuery(d).find("> circle[name*='innerCircle']")[0];z(j,"sapUiInoEvaluationMatrixInnerCircleHighlight");A(j,"sapUiInoEvaluationMatrixInnerCircle");var l=jQuery(d).find("> circle[name*='outerCircle']")[0];z(l,"sapUiInoEvaluationMatrixOuterCircleHighlight");A(l,"sapUiInoEvaluationMatrixOuterCircle");jQuery(d.parentNode.parentNode.parentNode).find("g[name*='circleGroup']").each(function(x,y){if(y!==d){var j=jQuery(y).find("> circle[name*='innerCircle']")[0];z(j,"sapUiInoEvaluationMatrixInnerCircle");A(j,"sapUiInoEvaluationMatrixInnerCircleHighlight");var l=jQuery(y).find("> circle[name*='outerCircle']")[0];z(l,"sapUiInoEvaluationMatrixOuterCircle");A(l,"sapUiInoEvaluationMatrixOuterCircleHighlight");}});var p=d.previousSibling;A(p,"sapUiInoEvaluationMatrixHidden");if(i==="radio"){jQuery(d.parentNode.parentNode.parentNode).find("g[name*='coord']").each(function(x,y){if(y!==p){z(y,"sapUiInoEvaluationMatrixHidden");}});}var r=p.parentNode;r.parentNode.appendChild(r.parentNode.removeChild(r));}function u(c,d,i){if(B(c,d)){A(c,d);if(!B(c,i)){z(c,i);}}else if(B(c,i)){A(c,i);if(!B(c,d)){z(c,d);}}}function v(c,d){var i=c.getAttribute("class");var p=new RegExp("\\b"+d+"\\b");if(p.test(i)){i=i.replace(p,"");}else{i=i.concat(" "+d);}c.setAttribute("class",i);return c;}function z(c,d){var i=c.getAttribute("class");var p=new RegExp("\\b"+d+"\\b");if(!p.test(i)){i=i.concat(" "+d);c.setAttribute("class",i);}return c;}function A(c,d){var i=c.getAttribute("class");var p=new RegExp("\\b"+d+"\\b");if(p.test(i)){i=i.replace(p,"");c.setAttribute("class",i);}return c;}function B(c,d){var i=c.getAttribute("class");var p=new RegExp("\\b"+d+"\\b");return(p.test(i));}function D(c){var d=[];for(var i=0;i<c.length;i++){var l={};for(var j in c[i].mProperties){l[j]=c[i].mProperties[j];}d.push(l);}return d;}function F(d,V){if(isNaN(V)||V===undefined||V===null){return 0;}switch(d){case"INTEGER":V=Math.round(V);break;case"NUMERIC":V=(Math.round(V*100)/100).toLocaleString();break;default:break;}return V;}});};if(!jQuery.sap.isDeclared('sap.ino.controls.IdeaCard')){jQuery.sap.declare('sap.ino.controls.IdeaCard');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.ui.core.HTML');jQuery.sap.require('sap.ui.core.TextAlign');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/IdeaCard",["sap/ui/core/Control","sap/ino/controls/util/ColorSupport","sap/m/Button","sap/m/ButtonType","sap/m/Label","sap/m/Link","sap/m/Text","sap/ui/core/HTML","sap/ui/core/TextAlign","sap/ui/core/Icon","sap/ino/controls/VoteType","sap/base/security/sanitizeHTML"],function(C,a,B,b,L,c,T,H,d,I,V,s){"use strict";var e=C.extend("sap.ino.controls.IdeaCard",{metadata:{properties:{"ideaCreatedAt":{type:"string"},"ideaDescription":{type:"string"},"ideaHref":{type:"sap.ui.core.URI"},"ideaId":{type:"int"},"ideaName":{type:"string"},"ideaSubmittedAt":{type:"string"},"ideaSubmitter":{type:"string"},"ideaSubmitterId":{type:"int"},"ideaSubmitterHref":{type:"sap.ui.core.URI"},"isDraft":{type:"boolean"},"isOpenForContributors":{type:"boolean"},"color":{type:"sap.ui.core.CSSColor"},"campaignId":{type:"int"},"campaignHref":{type:"sap.ui.core.URI"},"campaignName":{type:"string"}},aggregations:{"commentDisplayPlaceholder":{type:"sap.ui.core.Control",multiple:false},"processDisplayPlaceholder":{type:"sap.ui.core.Control",multiple:false},"viewDisplayPlaceholder":{type:"sap.ui.core.Control",multiple:false},"anonymousDisplayPlaceholder":{type:"sap.ui.core.Control",multiple:false},"voteDisplayPlaceholder":{type:"sap.ui.core.Control",multiple:false},"votePlaceholder":{type:"sap.ui.core.Control",multiple:false},"followButton":{type:"sap.ui.core.Control",multiple:false},"image":{type:"sap.m.Image",multiple:false},"_campaignLink":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_campaignLinkBack":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_draftLabel":{type:"sap.m.Label",multiple:false,visibility:"hidden"},"_ideaDescription":{type:"sap.ui.core.HTML",multiple:false,visibility:"hidden"},"_ideaLink":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_ideaLinkBack":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_ideaMoreLink":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_ideaSubmitter":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_flipButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_commentButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_flipButtonBack":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"contributorButton":{type:"sap.ui.core.Control",multiple:false},"_noticeStatusIcon":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_noticeCommentIcon":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_noticeUpdateIcon":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_noticeCreateIcon":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_IdeaReadButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"}},events:{openIdea:{},openSubmitter:{},press:{},openCampaign:{},openIdeaComment:{},readIdea:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");this.isFront=true;},_getCampaignLink:function(A){var t=this;var f="_campaignLink";if(A){f+=A;}var o=this.getAggregation(f);var g=this.getProperty("campaignName");if(!o){o=new c({id:this.getId()+f,href:this.getProperty("campaignHref"),press:function(E){E.preventDefault();t.fireOpenCampaign({campaignId:t.getProperty("campaignId")});},text:g}).addStyleClass("sapInoIdeaCardAccessibilityCampaignLink");this.setAggregation(f,o,true);}return o;},_getIdeaLink:function(A){var t=this;var f="_ideaLink";if(A){f+=A;}var i=this.getAggregation(f);var g=this.getProperty("ideaName");if(!i){i=new c({id:this.getId()+f,href:this.getProperty("ideaHref"),press:function(E){E.preventDefault();t.fireOpenIdea({ideaId:t.getProperty("ideaId")});}}).setText(g).addStyleClass("sapInoIdeaCardAccessibilityIdeaLink");this.setAggregation(f,i,true);}if(this.getProperty("ideaHref")){i.setHref(this.getProperty("ideaHref"));}return i;},_getIdeaDescription:function(){var i=this.getAggregation("_ideaDescription");if(!i){i=new H({content:"<span>"+(this.getProperty("ideaDescription")||"")+"</span>",sanitizeContent:true,preferDOM:false});this.setAggregation("_ideaDescription",i,true);}return i;},_getIdeaSubmitter:function(){var t=this;var i=this.getAggregation("_ideaSubmitter");if(!i){i=new c({id:this.getId()+"_ideaSubmitter",press:function(E){E.preventDefault();t._bIsFlipped=true;t.fireOpenSubmitter({ideaSubmitterId:t.getProperty("ideaSubmitterId")});},href:this.getProperty("ideaSubmitterHref"),text:t._getIdeaSubmitterText()}).addStyleClass("sapInoIdeaCardAccessibilitySubmitter");this.setAggregation("_ideaSubmitter",i,true);}return i;},_getIdeaSubmitterText:function(){return this._oRB.getText("CTRL_IDEACARD_FLD_SUBMITTED_BY",[this.getProperty("ideaSubmitter"),this.getProperty("ideaSubmittedAt")||this.getProperty("ideaCreatedAt")]);},_getDraftLabel:function(){var t=this;var D=this.getAggregation("_draftLabel");if(!D){D=new L({id:this.getId()+"_draftLabel",text:t._oRB.getText("CTRL_IDEACARD_TIT_DRAFT"),tooltip:t._oRB.getText("CTRL_IDEACARD_TIT_DRAFT"),textAlign:d.Center});this.setAggregation("_draftLabel",D,true);}return D;},_getIdeaMoreLink:function(A){var t=this;var f="_ideaMoreLink";if(A){f+=A;}var i=this.getAggregation(f);var g=this.getProperty("ideaName");if(!i){i=new c({id:this.getId()+f,href:t.getProperty("ideaHref"),press:function(E){E.preventDefault();t.fireOpenIdea({ideaId:t.getProperty("ideaId")});},text:t._oRB.getText("CTRL_IDEACARD_XLNK_MORE")}).setTooltip(t._oRB.getText("CTRL_IDEACARD_ALT_IDEA_TOOLTIP",[g])).addStyleClass("sapInoIdeaCardAccessibilityMoreButton");this.setAggregation(f,i,true);}return i;},_getFlipButton:function(A){var t=this;var f="_flipButton";if(A){f+=A;}var F=this.getAggregation(f);if(!F){F=new B({type:b.Transparent,icon:"sap-icon://redo",tooltip:t._oRB.getText("CTRL_IDEACARD_BUT_FLIP_BUTTON"),press:function(){t._flip();},enabled:true}).addStyleClass("sapInoIdeaCardAccessibilityFlipButton"+A);this.setAggregation(f,F,true);}return F;},_getCommentButton:function(A){var t=this;var f="_commentButton";if(A){f+=A;}var o=this.getAggregation(f);if(!o){o=new B({type:b.Transparent,icon:"sap-icon://comment",tooltip:{parts:[{path:'data>COMMENT_HAS_PRIVILEGE'},{path:'data>PARTICIPANT_CAN_COMMENT'},{path:'data>OPEN_STATUS_SETTING'}],formatter:function(i,g,O){var S=O>0&&i>0||!O;if(g>0&&S){return t._oRB.getText("CTRL_IDEACARD_BUT_COMMENT_BUTTON");}return t._oRB.getText("VOTE_MSG_COMMENT_NO_PRIVILEGE");}},press:function(){t.fireOpenIdeaComment({ideaId:t.getProperty("ideaId")});},enabled:{parts:[{path:'data>COMMENT_HAS_PRIVILEGE'},{path:'data>PARTICIPANT_CAN_COMMENT'},{path:'data>OPEN_STATUS_SETTING'}],formatter:function(i,g,O){var S=O>0&&i>0||!O;return g>0&&S;}}}).addStyleClass("sapInoIdeaCardBottomRibbonContent sapInoIdeaCardAccessibilityCommentButton");this.setAggregation(f,o,true);}return o;},_getIdeaReadButton:function(){var t=this;var A="_IdeaReadButton";var i=this.getAggregation(A);if(!i){i=new B({type:b.Transparent,icon:"sap-icon://InoIcons/idea_read",tooltip:t._oRB.getText("IDEA_LIST_FLD_READ"),press:function(){t.fireReadIdea({ideaId:t.getProperty("ideaId")});},visible:"{= !!${data>SHOW_UPDATED_VIEWER} || !!${data>SHOW_COMMENT_VIEWER} || !!${data>SHOW_STATUSCHANGE_VIEWER}}"}).addStyleClass("ideaNoticeReadButton");this.setAggregation(A,i,true);}return i;},_getNoticeStatusIcon:function(){var t=this;var n=this.getAggregation("_noticeStatusIcon");if(!n){n=new I({src:"sap-icon://InoIcons/new_status",tooltip:t._oRB.getText("IDEA_LIST_ITEM_IDEA_STATUS"),size:"1.5rem",visible:"{= !!${data>SHOW_STATUSCHANGE_VIEWER}}",press:function(){t.fireOpenIdea({ideaId:t.getProperty("ideaId")});}}).addStyleClass("ideaNoticeStatusIcon");this.setAggregation("_noticeStatusIcon",n,true);}return n;},_getNoticeCommentIcon:function(){var t=this;var n=this.getAggregation("_noticeCommentIcon");if(!n){n=new I({src:"sap-icon://InoIcons/new_comment",tooltip:t._oRB.getText("IDEA_LIST_ITEM_IDEA_COMMENT"),size:"1.5rem",visible:"{= !!${data>SHOW_COMMENT_VIEWER}}",press:function(){t.fireOpenIdeaComment({ideaId:t.getProperty("ideaId")});}}).addStyleClass("ideaNoticeCommentIcon");this.setAggregation("_noticeCommentIcon",n,true);}return n;},_getNoticeUpdateIcon:function(){var t=this;var n=this.getAggregation("_noticeUpdateIcon");if(!n){n=new I({src:"sap-icon://InoIcons/idea_update",tooltip:t._oRB.getText("IDEA_LIST_ITEM_IDEA_UPDATE"),size:"1.5rem",visible:"{= !!${data>SHOW_UPDATED_VIEWER}}",press:function(){t.fireOpenIdea({ideaId:t.getProperty("ideaId")});}}).addStyleClass("ideaNoticeUpdateIcon");this.setAggregation("_noticeUpdateIcon",n,true);}return n;},_getNoticeCreateIcon:function(){var t=this;var n=this.getAggregation("_noticeCreateIcon");if(!n){n=new I({src:"sap-icon://InoIcons/idea_create",tooltip:t._oRB.getText("IDEA_LIST_ITEM_IDEA_CREATE"),size:"1.5rem",visible:"{= !!${data>SHOW_CREATED_VIEWER}}",press:function(){t.fireOpenIdea({ideaId:t.getProperty("ideaId")});}}).addStyleClass("ideaNoticeCreateIcon");this.setAggregation("_noticeCreateIcon",n,true);}return n;},_flip:function(){var f=this._getFlipper(this);if(f){this._bIsFlipped=!this._bIsFlipped;f.classList.toggle("flip");if(!jQuery(f).hasClass("flip")){this._getFlipButton().focus();}else{this._getFlipButton("Back").focus();}}},_getFlipper:function(o){var f=o.$().find(".sapInoIdeaCardFlipContainer");if(f&&f.length>0){return f[0];}return undefined;},onAfterRendering:function(){if(C.prototype.onAfterRendering){C.prototype.onAfterRendering.apply(this,arguments);}this.initTabIndex();this.setAccessibility();this._initTabs();},setAccessibility:function(){var l=this.getParent();if(l&&l.attachBrowserEvent){l.attachBrowserEvent('focus',function(f){var t=f.target;$(t).find('.ideaListFollow button').attr("tabindex","0");});l.attachBrowserEvent('blur',function(f){var t=f.target;var g=$(t).find('.starVote');$(t).find('.ideaListFollow button').attr('tabindex','-1');if(g&&g.length){g.attr('tabindex','-1');}});}},initTabIndex:function(){this._getIdeaLink().$().attr("tabindex","-1");this._getIdeaLink("Back").$().attr("tabindex","-1");this._getFlipButton().$().attr("tabindex","-1");this._getCommentButton().$().attr("tabindex","-1");this._getFlipButton("Back").$().attr("tabindex","-1");this._getCampaignLink().$().attr("tabindex","-1");this._getCampaignLink("Back").$().attr("tabindex","-1");this._getIdeaMoreLink().$().attr("tabindex","-1");this._getIdeaSubmitter().$().attr("tabindex","-1");this.getAggregation("votePlaceholder").$().find('.starVote, button').attr('tabindex','-1');this.getAggregation("followButton").$().find('button').attr("tabindex","-1");this.getAggregation("contributorButton").$().find('button').attr("tabindex","-1");},renderer:function(r,o){r.write("<div");r.writeControlData(o);r.addClass("sapInoIdeaCard");r.addClass("sapUiSizeCompact");r.writeClasses();r.write(">");o._renderContent(r,o);r.write("</div>");},_renderContent:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardFlipContainer");if(this._bIsFlipped){r.addClass("flip");}r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoIdeaCardFlipper");r.writeClasses();r.write(">");o._renderFrontContent(r,o);o._renderBackContent(r,o);r.write("</div>");r.write("</div>");},_renderImage:function(r,o){var i=o.getAggregation("image");if(i){r.renderControl(i);}},_renderFrontContent:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardFront");r.writeClasses();r.write(">");o._renderTopRibbon(r,o);o._renderImage(r,o);o._renderTopPlaceholder(r,o);o._renderIdeaLink(r,o);o._renderBottomPlaceholder(r,o);o._renderIdeaNoticeIcon(r,o);o._renderBottomRibbon(r,o);o._renderFollowButton(r,o);r.write("</div>");},_renderBackContent:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardBack");r.writeClasses();r.write(">");o._renderTopRibbon(r,o,true);o._renderIdeaLink(r,o,true);o._renderIdeaSubmitter(r,o);o._renderIdeaDescription(r,o);o._renderIdeaMoreLink(r,o);o._renderBottomRibbon(r,o,true);r.write("</div>");},_renderIdeaLink:function(r,o,R){r.write("<div");r.addClass("sapInoIdeaCardIdeaLink");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoIdeaCardIdeaLinkTooltip");r.writeAttributeEscaped("title",o._oRB.getText("CTRL_IDEACARD_ALT_IDEA_TOOLTIP",[this.getProperty("ideaName")]));r.writeClasses();r.write(">");if(R){r.renderControl(o._getIdeaLink("Back"));}else{r.renderControl(o._getIdeaLink());}r.write("</div>");if(this.getProperty("isOpenForContributors")){r.renderControl(new I({src:"sap-icon://InoIcons/shake_hands",tooltip:o._oRB.getText("CTRL_IDEACARD_ALT_OPEN_CONTRIBUTION_TOOLTIP")}));}r.write("</div>");},_renderTopPlaceholder:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardTopPlaceholder");r.writeClasses();r.write(">");var v=o.getAggregation("voteDisplayPlaceholder");if(v){r.renderControl(v);}var f=o.getAggregation("commentDisplayPlaceholder");if(f){r.renderControl(f);}var g=o.getAggregation("viewDisplayPlaceholder");if(g){r.renderControl(g);}var A=o.getAggregation("anonymousDisplayPlaceholder");if(A){r.renderControl(A);}r.write("</div>");},_renderBottomPlaceholder:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardBottomPlaceholder");r.writeClasses();r.write(">");if(o.getProperty("isDraft")){o._renderDraftLabel(r,o);}else{var p=o.getAggregation("processDisplayPlaceholder");if(p){r.renderControl(p);}}r.write("</div>");},_renderIdeaNoticeIcon:function(r,o){r.write("<div");r.addClass("sapInoIdeaNoticeIconPlaceholder");r.writeClasses();r.write(">");r.renderControl(o._getNoticeStatusIcon());r.renderControl(o._getNoticeCommentIcon());r.renderControl(o._getNoticeUpdateIcon());r.write("</div>");},_renderFollowButton:function(r,o){r.write("<div");r.write(">");var f=o.getAggregation("followButton");r.renderControl(f);r.write("</div>");},_renderContributorButton:function(r,o){var f=o.getAggregation("contributorButton");f.addStyleClass("sapInoIdeaCardBottomRibbonContent sapInoIdeaCardAccessibilityContributorButton");r.renderControl(f);},_renderDraftLabel:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardDraftLabel");r.writeClasses();r.write(">");var D=o._getDraftLabel();r.renderControl(D);r.write("</div>");},_renderIdeaSubmitter:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardIdeaSubmitter");r.writeClasses();r.write(">");var i=o._getIdeaSubmitter();r.renderControl(i);r.write("</div>");},_renderIdeaDescription:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardIdeaDescription");r.writeClasses();r.write(">");var i=o._getIdeaDescription();r.renderControl(i);r.write("</div>");},_renderIdeaMoreLink:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardIdeaMoreLink");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoIdeaCardIdeaMoreLinkTooltip");r.writeAttributeEscaped("title",o._oRB.getText("CTRL_IDEACARD_ALT_IDEA_TOOLTIP",[this.getProperty("ideaName")]));r.writeClasses();r.write(">");var i=o._getIdeaMoreLink();r.renderControl(i);r.write("</div>");r.write("</div>");},_renderBottomRibbon:function(r,o,R){r.write("<div");r.addClass("sapInoIdeaCardRibbon");r.addClass("sapInoIdeaCardBottomRibbon");r.writeClasses();r.write(">");if(!R){var v=o.getAggregation("votePlaceholder");if(v){v.addStyleClass("sapInoIdeaCardAccessibilityVote");v.addStyleClass("sapInoIdeaCardBottomRibbonContent");r.renderControl(v);}r.renderControl(o._getCommentButton());o._renderContributorButton(r,o);}r.write("<div");r.addClass("sapInoIdeaCardBottomRibbonContent");r.writeClasses();r.write(">");if(R){r.renderControl(o._getFlipButton("Back"));}else{r.renderControl(o._getFlipButton());}r.renderControl(o._getIdeaReadButton());r.write("</div>");r.write("</div>");},_renderTopRibbon:function(r,o,R){r.write("<div");r.addClass("sapInoIdeaCardRibbon sapInoIdeaCardTopRibbon");r.writeClasses();var f=o.getProperty("color");if(f&&f.length===7){r.writeAttributeEscaped("style","background-color: "+f);}r.write(">");r.write("<span");r.addClass("sapInoIdeaCardAccessibilityText");r.addClass("sapUiInvisibleText");r.writeAttributeEscaped("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_IDEA_LINK",[this.getProperty("ideaName")]));r.writeClasses();r.write("></span>");r.write("<div");r.addClass("sapInoIdeaCardCampaignLink");if(!f){f="#FFFFFF";}r.addClass("sapInoIdeaCardCampaignTitle"+a.calculateTitleTextColor(f.substr(1,2),f.substr(3,2),f.substr(5,2)));r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoIdeaCardCampaignLinkTooltip");r.writeAttributeEscaped("title",o._oRB.getText("CTRL_CARD_ALT_CAMPAIGN_TOOLTIP"));r.writeClasses();r.write(">");if(R){r.renderControl(o._getCampaignLink("Back"));}else{r.renderControl(o._getCampaignLink());}r.write("</div>");r.write("</div>");r.write("</div>");},ontouchstart:function(E){E.setMarked();},ontap:function(E){this.firePress();},getFocusDomRef:function(){if(this._bIsFlipped){return this._getIdeaLink("Back").$();}return this._getIdeaLink().$();},onfocusin:function(E){if(!this._$AccessibilityText){this._$AccessibilityText=this.$().find(".sapInoIdeaCardAccessibilityText");}if(!E||!E.target||!E.target.className){this._$AccessibilityText.attr("title","");return;}if(E.target.className.indexOf("sapInoIdeaCardAccessibilityCampaignLink")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_CAMPAIGN_LINK",[this.getProperty("campaignName")]));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilityFlipButtonBack")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_FLIP_BACK"));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilityFlipButton")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_FLIP"));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilitySubmitter")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_SUBMITTER"));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilityIdeaLink")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_IDEA_LINK",[this.getProperty("ideaName")]));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilityMoreButton")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_MORE",[this.getProperty("ideaName")]));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilityVote")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_VOTE",[this.getProperty("ideaName")]));}else if(E.target.className.indexOf('sapInoIdeaCardAccessibilityCommentButton')!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_COMMENT",[this.getProperty("ideaName")]));}else if(E.target.className.indexOf('sapInoIdeaCardAccessibilityContributorButton')!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_CONTRIBUTOR",[this.getProperty("ideaName")]));}else{var v=jQuery(E.target).closest(".sapInoIdeaCardAccessibilityVote");if(v&&v.length>0){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_VOTE",[this.getProperty("ideaName")]));}}},_initTabs:function(){var f=this._getFlipButton();var o=this._getFlipButton("Back");f.addStyleClass("sapInoIdeaCardFlipButton");o.addStyleClass("sapInoIdeaCardFlipButton");var F=this.getAggregation("votePlaceholder");var g=this.getAggregation("followButton");var h=this.getAggregation("contributorButton");this._aFrontTabs=[];this._aFrontTabs.push(this._getCampaignLink().$()[0].id);this._aFrontTabs.push(this._getIdeaLink().$()[0].id);if(F.getEnabled()){var i=F.$().find(".starVote, button");if(i&&i.length>0){this._aFrontTabs.push(i[0].id);for(var j=1;j<i.length;j++){this._aFrontTabs.push(i[j].id);}}}if(g.getEnabled()){var k=g.$().find("button");if(k&&k.length){this._aFrontTabs.push(k[0].id);}}if(h.getEnabled()){var l=h.$().find('button');if(l&&l.length){this._aFrontTabs.push(l[0].id);}}this._aFrontTabs.push(this._getFlipButton().$()[0].id);this._aFrontTabs.push(this._getCommentButton().$()[0].id);this._aBackTabs=[];this._aBackTabs.push(this._getCampaignLink("Back").$()[0].id);this._aBackTabs.push(this._getIdeaLink("Back").$()[0].id);this._aBackTabs.push(this._getIdeaSubmitter().$()[0].id);this._aBackTabs.push(s(this._getIdeaMoreLink().$()[0].id));this._aBackTabs.push(this._getFlipButton("Back").$()[0].id);},_getTabs:function(){if(this._bIsFlipped){return this._aBackTabs;}return this._aFrontTabs;},_defaultOnKeyDown:function(E){if(C.prototype.onkeydown){C.prototype.onkeydown.apply(this,arguments);}},onkeydown:function(E){var t=this._getTabs();var u=this._incr;if(E.shiftKey||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){u=this._decr;}if(E.keyCode===jQuery.sap.KeyCodes.ESCAPE){this.getParent().focus();}else if(E.keyCode===jQuery.sap.KeyCodes.TAB||E.keyCode===jQuery.sap.KeyCodes.ARROW_DOWN||E.keyCode===jQuery.sap.KeyCodes.ARROW_RIGHT||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){var f=jQuery(":focus");var i=-1;if(f&&f.length>0){i=t.indexOf(f[0].id);if(i!==-1){i=u(i,t.length-1);this._focus(jQuery("#"+t[i]));E.preventDefault();E.stopPropagation();}else{this.getParent().focus();}}else{this.getParent().focus();}}else{this._defaultOnKeyDown(E);}},_incr:function(v,m){v++;if(v>m){return 0;}return v;},_decr:function(v,m){v--;if(v<0){return m;}return v;},_focus:function(E){if(jQuery.type(E.focus)==="function"){setTimeout(function(){E.focus();},0);}}});e.prototype.setIdeaDescription=function(v){this.setProperty("ideaDescription",v);this._getIdeaDescription().setContent("<span>"+(v||"")+"</span>");};e.prototype.setIdeaName=function(v){this.setProperty("ideaName",v);var i=this._getIdeaLink();if(i){i.setText(v);}i=this._getIdeaLink("Back");if(i){i.setText(v);}};e.prototype.setIdeaSubmittedAt=function(v){this.setProperty("ideaSubmittedAt",v);this._getIdeaSubmitter().setText(this._getIdeaSubmitterText());};e.prototype.setIdeaCreatedAt=function(v){this.setProperty("ideaCreatedAt",v);this._getIdeaSubmitter().setText(this._getIdeaSubmitterText());};e.prototype.setIdeaSubmitter=function(v){this.setProperty("ideaSubmitter",v);this._getIdeaSubmitter().setText(this._getIdeaSubmitterText());};return e;});};if(!jQuery.sap.isDeclared('sap.ino.controls.IdeaCardNoImage')){jQuery.sap.declare('sap.ino.controls.IdeaCardNoImage');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.ui.core.HTML');jQuery.sap.require('sap.ui.core.TextAlign');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.m.FlexBox');jQuery.sap.require('sap.ui.commons.Label');jQuery.sap.require('sap.base.security.sanitizeHTML');sap.ui.define("sap/ino/controls/IdeaCardNoImage",["sap/ui/core/Control","sap/ino/controls/util/ColorSupport","sap/m/Button","sap/m/ButtonType","sap/m/Label","sap/m/Link","sap/m/Text","sap/ui/core/HTML","sap/ui/core/TextAlign","sap/ui/core/Icon","sap/ino/controls/VoteType","sap/m/FlexBox","sap/ui/commons/Label","sap/base/security/sanitizeHTML"],function(C,a,B,b,L,c,T,H,d,I,V,F,e,s){"use strict";var f=C.extend("sap.ino.controls.IdeaCardNoImage",{metadata:{properties:{"ideaCreatedAt":{type:"string"},"ideaDescription":{type:"string"},"ideaHref":{type:"sap.ui.core.URI"},"ideaId":{type:"int"},"ideaName":{type:"string"},"ideaSubmittedAt":{type:"string"},"ideaSubmitter":{type:"string"},"ideaSubmitterId":{type:"int"},"ideaSubmitterHref":{type:"sap.ui.core.URI"},"isDraft":{type:"boolean"},"isOpenForContributors":{type:"boolean"},"color":{type:"sap.ui.core.CSSColor"},"campaignId":{type:"int"},"campaignHref":{type:"sap.ui.core.URI"},"campaignName":{type:"string"},"phase":{type:"string"},"status":{type:"string"},statusColor:{type:"string"},"respValue":{type:"string"},"voteType":{type:"string"},'voteCount':{type:"int"},'voteLike':{type:"int"},'voteDislike':{type:'int'},'likeVotes':{type:'float'},'negativeVotes':{type:'int'},'positiveVotes':{type:'int'}},aggregations:{"commentDisplayPlaceholder":{type:"sap.ui.core.Control",multiple:false},"viewDisplayPlaceholder":{type:"sap.ui.core.Control",multiple:false},"voteDisplayPlaceholder":{type:"sap.ui.core.Control",multiple:false},"votePlaceholder":{type:"sap.ui.core.Control",multiple:false},"followButton":{type:"sap.ui.core.Control",multiple:false},"_campaignLink":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_campaignLinkBack":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_draftLabel":{type:"sap.m.Label",multiple:false,visibility:"hidden"},"_ideaDescription":{type:"sap.ui.core.HTML",multiple:false,visibility:"hidden"},"_ideaLink":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_ideaLinkBack":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_ideaMoreLink":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_ideaSubmitter":{type:"sap.m.Link",multiple:false,visibility:"hidden"},"_flipButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_commentButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"_flipButtonBack":{type:"sap.m.Button",multiple:false,visibility:"hidden"},"contributorButton":{type:"sap.ui.core.Control",multiple:false},"_status":{type:"sap.m.FlexBox",multiple:false,visibility:"hidden"},"_phase":{type:"sap.m.FlexBox",multiple:false,visibility:"hidden"},"_ideaId":{type:"sap.m.FlexBox",multiple:false,visibility:"hidden"},"_respValue":{type:"sap.m.FlexBox",multiple:false,visibility:"hidden"},"_voteCount":{type:"sap.m.FlexBox",multiple:false,visibility:"hidden"},"_noticeStatusIcon":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_noticeCommentIcon":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_noticeUpdateIcon":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_noticeCreateIcon":{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},"_IdeaReadButton":{type:"sap.m.Button",multiple:false,visibility:"hidden"}},events:{openIdea:{},openSubmitter:{},press:{},openCampaign:{},openIdeaComment:{},readIdea:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");this.isFront=true;},_getCampaignLink:function(A){var t=this;var g="_campaignLink";if(A){g+=A;}var o=this.getAggregation(g);var h=this.getProperty("campaignName");if(!o){o=new c({id:this.getId()+g,href:this.getProperty("campaignHref"),press:function(E){E.preventDefault();t.fireOpenCampaign({campaignId:t.getProperty("campaignId")});},text:h}).addStyleClass("sapInoIdeaCardAccessibilityCampaignLink");this.setAggregation(g,o,true);}return o;},_getIdeaLink:function(A){var t=this;var g="_ideaLink";if(A){g+=A;}var i=this.getAggregation(g);var h=this.getProperty("ideaName");if(!i){i=new c({id:this.getId()+g,href:this.getProperty("ideaHref"),press:function(E){E.preventDefault();t.fireOpenIdea({ideaId:t.getProperty("ideaId")});}}).setText(h).addStyleClass("sapInoIdeaCardAccessibilityIdeaLink");this.setAggregation(g,i,true);}if(this.getProperty("ideaHref")){i.setHref(this.getProperty("ideaHref"));}return i;},_getIdeaDescription:function(){var i=this.getAggregation("_ideaDescription");if(!i){i=new H({content:"<span>"+(this.getProperty("ideaDescription")||"")+"</span>",sanitizeContent:true,preferDOM:false});this.setAggregation("_ideaDescription",i,true);}return i;},_getIdeaSubmitter:function(){var t=this;var i=this.getAggregation("_ideaSubmitter");if(!i){i=new c({id:this.getId()+"_ideaSubmitter",press:function(E){E.preventDefault();t._bIsFlipped=true;t.fireOpenSubmitter({ideaSubmitterId:t.getProperty("ideaSubmitterId")});},href:this.getProperty("ideaSubmitterHref"),text:t._getIdeaSubmitterText()}).addStyleClass("sapInoIdeaCardAccessibilitySubmitter");this.setAggregation("_ideaSubmitter",i,true);}return i;},_getIdeaSubmitterText:function(){var g=this.getProperty("ideaSubmitter");if(this.getProperty("ideaSubmitterId")===0){g=this.getModel("i18n").getProperty("IDEA_OBJECT_TIT_IDEA_Anonymity");}return this._oRB.getText("CTRL_IDEACARD_FLD_SUBMITTED_BY",[g,this.getProperty("ideaSubmittedAt")||this.getProperty("ideaCreatedAt")]);},_getDraftLabel:function(){var t=this;var D=this.getAggregation("_draftLabel");if(!D){D=new L({id:this.getId()+"_draftLabel",text:t._oRB.getText("CTRL_IDEACARD_TIT_DRAFT"),tooltip:t._oRB.getText("CTRL_IDEACARD_TIT_DRAFT"),textAlign:d.Center});this.setAggregation("_draftLabel",D,true);}return D;},_getIdeaMoreLink:function(A){var t=this;var g="_ideaMoreLink";if(A){g+=A;}var i=this.getAggregation(g);var h=this.getProperty("ideaName");if(!i){i=new c({id:this.getId()+g,href:t.getProperty("ideaHref"),press:function(E){E.preventDefault();t.fireOpenIdea({ideaId:t.getProperty("ideaId")});},text:t._oRB.getText("CTRL_IDEACARD_XLNK_MORE")}).setTooltip(t._oRB.getText("CTRL_IDEACARD_ALT_IDEA_TOOLTIP",[h])).addStyleClass("sapInoIdeaCardAccessibilityMoreButton");this.setAggregation(g,i,true);}return i;},_getFlipButton:function(A){var t=this;var g="_flipButton";if(A){g+=A;}var o=this.getAggregation(g);if(!o){o=new B({type:b.Transparent,icon:"sap-icon://redo",tooltip:t._oRB.getText("CTRL_IDEACARD_BUT_FLIP_BUTTON"),press:function(E){t._flip();},enabled:true}).addStyleClass("sapInoIdeaCardAccessibilityFlipButton"+A);this.setAggregation(g,o,true);}return o;},_getCommentButton:function(A){var t=this;var g="_commentButton";if(A){g+=A;}var o=this.getAggregation(g);if(!o){o=new B({type:b.Transparent,icon:"sap-icon://comment",tooltip:{parts:[{path:'data>COMMENT_HAS_PRIVILEGE'},{path:'data>PARTICIPANT_CAN_COMMENT'},{path:'data>OPEN_STATUS_SETTING'}],formatter:function(i,h,O){var S=O>0&&i>0||!O;if(h>0&&S){return t._oRB.getText("CTRL_IDEACARD_BUT_COMMENT_BUTTON");}return t._oRB.getText("VOTE_MSG_COMMENT_NO_PRIVILEGE");}},press:function(E){t.fireOpenIdeaComment({ideaId:t.getProperty("ideaId")});},enabled:{parts:[{path:'data>COMMENT_HAS_PRIVILEGE'},{path:'data>PARTICIPANT_CAN_COMMENT'},{path:'data>OPEN_STATUS_SETTING'}],formatter:function(i,h,O){var S=O>0&&i>0||!O;return h>0&&S;}}}).addStyleClass("sapInoIdeaCardBottomRibbonContent sapInoIdeaCardAccessibilityCommentButton");this.setAggregation(g,o,true);}return o;},_getIdeaReadButton:function(){var t=this;var A="_IdeaReadButton";var i=this.getAggregation(A);if(!i){i=new B({type:b.Transparent,icon:"sap-icon://InoIcons/idea_read",tooltip:t._oRB.getText("IDEA_LIST_FLD_READ"),press:function(){t.fireReadIdea({ideaId:t.getProperty("ideaId")});},visible:"{= !!${data>SHOW_UPDATED_VIEWER} || !!${data>SHOW_COMMENT_VIEWER} || !!${data>SHOW_STATUSCHANGE_VIEWER}}"}).addStyleClass("ideaNoticeReadButton");this.setAggregation(A,i,true);}return i;},_getNoticeStatusIcon:function(){var t=this;var n=this.getAggregation("_noticeStatusIcon");if(!n){n=new I({src:"sap-icon://InoIcons/new_status",tooltip:t._oRB.getText("IDEA_LIST_ITEM_IDEA_STATUS"),size:"1.5rem",visible:"{= !!${data>SHOW_STATUSCHANGE_VIEWER}}",press:function(){t.fireOpenIdea({ideaId:t.getProperty("ideaId")});}}).addStyleClass("ideaNoticeStatusIcon");this.setAggregation("_noticeStatusIcon",n,true);}return n;},_getNoticeCommentIcon:function(){var t=this;var n=this.getAggregation("_noticeCommentIcon");if(!n){n=new I({src:"sap-icon://InoIcons/new_comment",tooltip:t._oRB.getText("IDEA_LIST_ITEM_IDEA_COMMENT"),size:"1.5rem",visible:"{= !!${data>SHOW_COMMENT_VIEWER}}",press:function(){t.fireOpenIdeaComment({ideaId:t.getProperty("ideaId")});}}).addStyleClass("ideaNoticeCommentIcon");this.setAggregation("_noticeCommentIcon",n,true);}return n;},_getNoticeUpdateIcon:function(){var t=this;var n=this.getAggregation("_noticeUpdateIcon");if(!n){n=new I({src:"sap-icon://InoIcons/idea_update",tooltip:t._oRB.getText("IDEA_LIST_ITEM_IDEA_UPDATE"),size:"1.5rem",visible:"{= !!${data>SHOW_UPDATED_VIEWER}}",press:function(){t.fireOpenIdea({ideaId:t.getProperty("ideaId")});}}).addStyleClass("ideaNoticeUpdateIcon");this.setAggregation("_noticeUpdateIcon",n,true);}return n;},_getNoticeCreateIcon:function(){var t=this;var n=this.getAggregation("_noticeCreateIcon");if(!n){n=new I({src:"sap-icon://InoIcons/idea_create",tooltip:t._oRB.getText("IDEA_LIST_ITEM_IDEA_CREATE"),size:"1.5rem",visible:"{= !!${data>SHOW_CREATED_VIEWER}}",press:function(){t.fireOpenIdea({ideaId:t.getProperty("ideaId")});}}).addStyleClass("ideaNoticeCreateIcon");this.setAggregation("_noticeCreateIcon",n,true);}return n;},_getVoteCountLabel:function(){var v=this.getProperty('voteType');var l=[];var g,h,t;switch(v){case V.TYPE_LIKE:g="sap-icon://InoIcons/heart";h=this.getProperty('voteCount');t=this._oRB.getText('CTRL_IDEACARD_FLD_VOTE_LABEL',[h]);break;case V.TYPE_LIKE_DISLIKE:g="sap-icon://InoIcons/thumbsup";h=this.getProperty('positiveVotes');t=this._oRB.getText('CTRL_IDEACARD_FLD_LIKE_LABEL',[h]);break;case V.TYPE_STAR:g="sap-icon://favorite";h=this.getProperty('voteCount');t=this._oRB.getText('CTRL_IDEACARD_FLD_VOTE_LABEL',[h]);break;default:g="sap-icon://InoIcons/heart";h=this.getProperty('voteCount');t=this._oRB.getText('CTRL_IDEACARD_FLD_VOTE_LABEL',[h]);break;}l.push(new e({icon:g,text:h,tooltip:t}));if(v===V.TYPE_LIKE_DISLIKE){l.push(new e({icon:"sap-icon://InoIcons/thumbsdown",text:this.getProperty('negativeVotes'),tooltip:this._oRB.getText('CTRL_IDEACARD_FLD_DISLIKE_LABEL',[this.getProperty('voteDislike')])}));}return l;},_getVoteCount:function(){var v=this.getAggregation('_voteCount');var l=this._getVoteCountLabel();if(!v){v=new F({items:l,alignItems:"Start",justifyContent:"Start",alignContent:"Start"});this.setAggregation('_voteCount',v);}return v;},_flip:function(){var o=this._getFlipper(this);if(o){this._bIsFlipped=!this._bIsFlipped;o.classList.toggle("flip");if(!jQuery(o).hasClass("flip")){this._getFlipButton().focus();}else{this._getFlipButton("Back").focus();}}},_getFlipper:function(o){var g=o.$().find(".sapInoIdeaCardFlipContainer");if(g&&g.length>0){return g[0];}return undefined;},onAfterRendering:function(){if(C.prototype.onAfterRendering){C.prototype.onAfterRendering.apply(this,arguments);}this.initTabIndex();this.setAccessibility();this._initTabs();var S=this.getProperty("statusColor");if(S&&S.length===6){S="#"+S;}else{S="#333333";}if(this.getDomRef()){$(this.getDomRef()).find('.sapInoNoImageStatusText').css("color",S);}},setAccessibility:function(){var l=this.getParent();if(l){l.attachBrowserEvent('focus',function(g){var t=g.target;$(t).find('.ideaListFollow button').attr("tabindex","0");});l.attachBrowserEvent('blur',function(g){var t=g.target;var h=$(t).find('.starVote');$(t).find('.ideaListFollow button').attr('tabindex','-1');if(h&&h.length){h.attr('tabindex','-1');}});}},initTabIndex:function(){this._getIdeaLink().$().attr("tabindex","-1");this._getIdeaLink("Back").$().attr("tabindex","-1");this._getFlipButton().$().attr("tabindex","-1");this._getCommentButton().$().attr("tabindex","-1");this._getFlipButton("Back").$().attr("tabindex","-1");this._getCampaignLink().$().attr("tabindex","-1");this._getCampaignLink("Back").$().attr("tabindex","-1");this._getIdeaMoreLink().$().attr("tabindex","-1");this._getIdeaSubmitter().$().attr("tabindex","-1");this.getAggregation("votePlaceholder").$().attr('tabindex','-1');this.getAggregation("votePlaceholder").$().find('.starVote, button').attr('tabindex','-1');this.getAggregation("followButton").$().find('button').attr("tabindex","-1");this.getAggregation("contributorButton").$().find('button').attr("tabindex","-1");},renderer:function(r,o){r.write("<div");r.writeControlData(o);r.addClass("sapInoIdeaCard");r.addClass("sapUiSizeCompact");r.writeClasses();r.write(">");o._renderContent(r,o);r.write("</div>");},_renderContent:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardFlipContainer sapInoIdeaCardFlipContainerNoImage");if(this._bIsFlipped){r.addClass("flip");}r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoIdeaCardFlipper");r.writeClasses();r.write(">");o._renderFrontContent(r,o);o._renderBackContent(r,o);r.write("</div>");r.write("</div>");},_renderFrontContent:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardFront");r.writeClasses();r.write(">");o._renderTopRibbon(r,o);o._renderIdeaLink(r,o);o._renderTopDesciption(r,o);o._renderVotePlaceholder(r,o);o._renderVoteCount(r,o);o._renderBottomPlaceholder(r,o);o._renderIdeaNoticeIcon(r,o);o._renderBottomRibbon(r,o);r.write("</div>");},_renderBackContent:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardBack sapInoIdeaCardBackNoImage");r.writeClasses();r.write(">");o._renderTopRibbon(r,o,true);o._renderIdeaLink(r,o,true);o._renderIdeaSubmitter(r,o);o._renderIdeaDescription(r,o);o._renderIdeaMoreLink(r,o);o._renderBottomRibbon(r,o,true);r.write("</div>");},_renderIdeaLink:function(r,o,R){r.write("<div");r.addClass("sapInoIdeaCardIdeaLink");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoIdeaCardIdeaLinkTooltip");r.writeAttributeEscaped("title",o._oRB.getText("CTRL_IDEACARD_ALT_IDEA_TOOLTIP",[this.getProperty("ideaName")]));r.writeClasses();r.write(">");if(R){r.renderControl(o._getIdeaLink("Back"));}else{r.renderControl(o._getIdeaLink());}r.write("</div>");if(this.getProperty("isOpenForContributors")){r.renderControl(new I({src:"sap-icon://InoIcons/shake_hands",tooltip:o._oRB.getText("CTRL_IDEACARD_ALT_OPEN_CONTRIBUTION_TOOLTIP")}));}r.write("</div>");},_renderVotePlaceholder:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardNoImageVotePlaceholder");r.writeClasses();r.write(">");var v=o.getAggregation("votePlaceholder");if(v){v.addStyleClass("sapInoIdeaCardNoImageVote");r.renderControl(v);}r.write("</div>");},_renderVoteCount:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardNoImageVoteCount");r.writeClasses();r.write(">");r.renderControl(o._getVoteCount());r.write("</div>");},_renderTopDesciption:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardNoImageTopDes");r.writeClasses();r.write(">");o._renderTopInfoText(r,o);r.write("</div>");},_renderPhaseStatus:function(r,o){var R=false;if(o.getProperty("phase")||o.getProperty("status")){R=true;}r.write("<div>");o._renderInfoText(r,o,R);r.write("</div>");},_renderBottomPlaceholder:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardNoImageBottomPlaceholder");r.writeClasses();r.write(">");if(o.getProperty("isDraft")){o._renderDraftLabel(r,o);}else{o._renderPhaseStatus(r,o);}r.write("</div>");},_renderIdeaNoticeIcon:function(r,o){r.write("<div");r.addClass("sapInoIdeaNoticeIconPlaceholder");r.writeClasses();r.write(">");r.renderControl(o._getNoticeStatusIcon());r.renderControl(o._getNoticeCommentIcon());r.renderControl(o._getNoticeUpdateIcon());r.write("</div>");},_getPhase:function(){var p=this.getAggregation("_phase");if(!p){p=new F({items:[this._getPhaseLabel(),this._getPhaseText()],alignItems:"Start",justifyContent:"Start",alignContent:"Start"});this.setAggregation("_phase",p);}return p;},_getIdeaId:function(){var i=this.getAggregation("_ideaId");if(!i){i=new F({items:[this._getIdeaIdLabel(),this._getIdeaIdLink()],alignItems:"Start",justifyContent:"Start",alignContent:"Start"}).addStyleClass("sapInoNoImagesId");this.setAggregation("_ideaId",i);}return i;},_getResponsibility:function(){var r=this.getAggregation("_respValue");if(!r){r=new F({items:[this._getRespValueLabel(),this._getRespValueText()],alignItems:"Start",justifyContent:"Start",alignContent:"Start"}).addStyleClass("sapInoNoImageResp");this.setAggregation("_respValue",r);}return r;},_getStatus:function(){var S=this.getAggregation("_status");if(!S){S=new F({items:[this._getStatusLabel(),this._getStatusText()],alignItems:"Start",justifyContent:"Start",alignContent:"Start"}).addStyleClass("sapInoNoImageStatus");this.setAggregation("_status",S);}return S;},_getStatusReason:function(){var S=this.getAggregation("_statusReason");if(!S){S=new F({items:[this._getStatusReasonLabel(),this._getStatusReasonText()],alignItems:"Start",justifyContent:"Start",alignContent:"Start"}).addStyleClass("sapInoNoImageStatus");this.setAggregation("_statusReason",S);}return S;},_getPhaseLabel:function(){var p=this.getProperty("phase");if(this.getProperty("isDraft")){p="";}return new L({text:this._oRB.getText("CTRL_PROCESSINDICATOR_FLD_PHASE_LABEL"),tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_PHASE_TOOLTIP",p)}).addStyleClass("sapInoNoImagePhaseLabel");},_getPhaseText:function(){var p=this.getProperty("phase");if(this.getProperty("isDraft")){p="";}return new T({text:p,tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_PHASE_TOOLTIP",p)});},_getStatusLabel:function(){var S=this.getProperty("status");return new L({text:this._oRB.getText("CTRL_PROCESSINDICATOR_FLD_STATUS_LABEL"),tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_STATUS_TOOLTIP",S)}).addStyleClass("sapInoNoImageStatusLabel");},_getStatusText:function(){var S=this.getProperty("status");return new T({text:S,tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_STATUS_TOOLTIP",S)}).addStyleClass("sapInoNoImageStatusText");},_getStatusReasonLabel:function(){var S=this.getProperty("statusReason");return new L({text:"Reason:",tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_STATUS_TOOLTIP",S)}).addStyleClass("sapInoNoImageStatusLabel");},_getStatusReasonText:function(){var S=this.getProperty("statusReason");return new T({text:S,tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_STATUS_TOOLTIP",S)});},_getIdeaIdLabel:function(){var i=this.getProperty("ideaId");return new L({text:this._oRB.getText("CTRL_PROCESSINDICATOR_FLD_IDEA_LABEL"),tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_IDEA_TOOLTIP",i)}).addStyleClass("sapInoNoImageStatusLabel");},_getIdeaIdLink:function(){var t=this;var i=this.getProperty("ideaId");var A="_ideaIdLink";return new c({id:this.getId()+A,href:this.getProperty("ideaHref"),tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_IDEA_TOOLTIP",i),press:function(E){E.preventDefault();t.fireOpenIdea({ideaId:t.getProperty("ideaId")});}}).setText(i).addStyleClass("sapInoIdeaCardAccessibilityIdeaLink");},_getRespValueLabel:function(){var r=this.getProperty("respValue");return new L({text:this._oRB.getText("CTRL_PROCESSINDICATOR_FLD_RESP_LABEL"),tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_RESP_TOOLTIP",r)}).addStyleClass("sapInoNoImageStatusLabel");},_getRespValueText:function(){var r=this.getProperty("respValue");return new T({text:r,tooltip:this._oRB.getText("CTRL_PROCESSINDICATOR_ALT_RESP_TOOLTIP",r)});},_renderTopInfoText:function(r,o){r.renderControl(o._getIdeaId());r.renderControl(o._getResponsibility());},_renderInfoText:function(r,o,R){if(R&&!o.getProperty("isDraft")&&!!this.getProperty("phase")){r.renderControl(o._getPhase());}if((R||o.getProperty("isDraft"))&&!!this.getProperty("status")){r.renderControl(o._getStatus());}},_renderFollowButton:function(r,o){r.write("<div");r.write(">");var g=o.getAggregation("followButton");r.renderControl(g);r.write("</div>");},_renderContributorButton:function(r,o){var g=o.getAggregation("contributorButton");g.addStyleClass("sapInoIdeaCardBottomRibbonContent sapInoIdeaCardAccessibilityContributorButton");r.renderControl(g);},_renderDraftLabel:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardDraftLabel");r.writeClasses();r.write(">");var D=o._getDraftLabel();r.renderControl(D);r.write("</div>");},_renderIdeaSubmitter:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardIdeaSubmitter");r.writeClasses();r.write(">");var i=o._getIdeaSubmitter();r.renderControl(i);r.write("</div>");},_renderIdeaDescription:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardIdeaDescription");r.writeClasses();r.write(">");var i=o._getIdeaDescription();r.renderControl(i);r.write("</div>");},_renderIdeaMoreLink:function(r,o){r.write("<div");r.addClass("sapInoIdeaCardIdeaMoreLink");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoIdeaCardIdeaMoreLinkTooltip");r.writeAttributeEscaped("title",o._oRB.getText("CTRL_IDEACARD_ALT_IDEA_TOOLTIP",[this.getProperty("ideaName")]));r.writeClasses();r.write(">");var i=o._getIdeaMoreLink();r.renderControl(i);r.write("</div>");r.write("</div>");},_renderBottomRibbon:function(r,o,R){r.write("<div");r.addClass("sapInoIdeaCardRibbon");r.addClass("sapInoIdeaCardBottomRibbon");r.writeClasses();r.write(">");if(!R){var g=o.getAggregation("followButton");if(g){g.addStyleClass("sapInoIdeaCardAccessibilityVote");g.addStyleClass("sapInoIdeaCardBottomRibbonContent");r.renderControl(g);}r.renderControl(o._getCommentButton());o._renderContributorButton(r,o);}r.write("<div");r.addClass("sapInoIdeaCardBottomRibbonContent");r.writeClasses();r.write(">");if(R){r.renderControl(o._getFlipButton("Back"));}else{r.renderControl(o._getFlipButton());}r.write("</div>");r.renderControl(o._getIdeaReadButton());r.write("</div>");},_renderTopRibbon:function(r,o,R){r.write("<div");r.addClass("sapInoIdeaCardRibbon sapInoIdeaCardTopRibbon");r.writeClasses();var g=o.getProperty("color");if(g&&g.length===7){r.writeAttributeEscaped("style","background-color: "+g);}r.write(">");r.write("<span");r.addClass("sapInoIdeaCardAccessibilityText");r.addClass("sapUiInvisibleText");r.writeAttributeEscaped("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_IDEA_LINK",[this.getProperty("ideaName")]));r.writeClasses();r.write("></span>");r.write("<div");r.addClass("sapInoIdeaCardCampaignLink");if(!g){g="#FFFFFF";}r.addClass("sapInoIdeaCardCampaignTitle"+a.calculateTitleTextColor(g.substr(1,2),g.substr(3,2),g.substr(5,2)));r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoIdeaCardCampaignLinkTooltip");r.writeAttributeEscaped("title",o._oRB.getText("CTRL_CARD_ALT_CAMPAIGN_TOOLTIP"));r.writeClasses();r.write(">");if(R){r.renderControl(o._getCampaignLink("Back"));}else{r.renderControl(o._getCampaignLink());}r.write("</div>");r.write("</div>");r.write("</div>");},ontouchstart:function(E){E.setMarked();},ontap:function(E){this.firePress();},getFocusDomRef:function(){if(this._bIsFlipped){return this._getIdeaLink("Back").$();}return this._getIdeaLink().$();},onfocusin:function(E){if(!this._$AccessibilityText){this._$AccessibilityText=this.$().find(".sapInoIdeaCardAccessibilityText");}if(!E||!E.target||!E.target.className){this._$AccessibilityText.attr("title","");return;}if(E.target.className.indexOf("sapInoIdeaCardAccessibilityCampaignLink")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_CAMPAIGN_LINK",[this.getProperty("campaignName")]));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilityFlipButtonBack")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_FLIP_BACK"));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilityFlipButton")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_FLIP"));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilitySubmitter")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_SUBMITTER"));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilityIdeaLink")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_IDEA_LINK",[this.getProperty("ideaName")]));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilityMoreButton")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_MORE",[this.getProperty("ideaName")]));}else if(E.target.className.indexOf("sapInoIdeaCardAccessibilityVote")!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_VOTE",[this.getProperty("ideaName")]));}else if(E.target.className.indexOf('sapInoIdeaCardAccessibilityCommentButton')!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_COMMENT",[this.getProperty("ideaName")]));}else if(E.target.className.indexOf('sapInoIdeaCardAccessibilityContributorButton')!==-1){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_CONTRIBUTOR",[this.getProperty("ideaName")]));}else{var v=jQuery(E.target).closest(".sapInoIdeaCardAccessibilityVote");if(v&&v.length>0){this._$AccessibilityText.attr("title",this._oRB.getText("CTRL_IDEACARD_ALT_ACCESSIBILITY_TEXT_VOTE",[this.getProperty("ideaName")]));}}},_initTabs:function(){var o=this._getFlipButton();var g=this._getFlipButton("Back");o.addStyleClass("sapInoIdeaCardFlipButton");g.addStyleClass("sapInoIdeaCardFlipButton");var h=this.getAggregation("votePlaceholder");var i=this.getAggregation("followButton");var j=this.getAggregation("contributorButton");this._aFrontTabs=[];this._aFrontTabs.push(this._getCampaignLink().$()[0].id);this._aFrontTabs.push(this._getIdeaLink().$()[0].id);if(h.getEnabled()){var k=h.$().find(".starVote, button");if(k&&k.length>0){this._aFrontTabs.push(k[0].id);for(var l=1;l<k.length;l++){this._aFrontTabs.push(k[l].id);}}}if(i.getEnabled()){var m=i.$().find("button");if(m&&m.length){this._aFrontTabs.push(m[0].id);}}if(j.getEnabled()){var n=j.$().find('button');if(n&&n.length){this._aFrontTabs.push(n[0].id);}}this._aFrontTabs.push(this._getFlipButton().$()[0].id);this._aFrontTabs.push(this._getCommentButton().$()[0].id);this._aBackTabs=[];this._aBackTabs.push(this._getCampaignLink("Back").$()[0].id);this._aBackTabs.push(this._getIdeaLink("Back").$()[0].id);this._aBackTabs.push(this._getIdeaSubmitter().$()[0].id);this._aBackTabs.push(s(this._getIdeaMoreLink().$()[0].id));this._aBackTabs.push(this._getFlipButton("Back").$()[0].id);},_getTabs:function(){if(this._bIsFlipped){return this._aBackTabs;}return this._aFrontTabs;},_defaultOnKeyDown:function(E){if(C.prototype.onkeydown){C.prototype.onkeydown.apply(this,arguments);}},onkeydown:function(E){var t=this._getTabs();var u=this._incr;if(E.shiftKey||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){u=this._decr;}if(E.keyCode===jQuery.sap.KeyCodes.ESCAPE){this.getParent().focus();}else if(E.keyCode===jQuery.sap.KeyCodes.TAB||E.keyCode===jQuery.sap.KeyCodes.ARROW_DOWN||E.keyCode===jQuery.sap.KeyCodes.ARROW_RIGHT||E.keyCode===jQuery.sap.KeyCodes.ARROW_UP||E.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){var g=jQuery(":focus");var i=-1;if(g&&g.length>0){i=t.indexOf(g[0].id);if(i!==-1){i=u(i,t.length-1);this._focus(jQuery("#"+t[i]));E.preventDefault();E.stopPropagation();}else{this.getParent().focus();}}else{this.getParent().focus();}}else{this._defaultOnKeyDown(E);}},_incr:function(v,m){v++;if(v>m){return 0;}return v;},_decr:function(v,m){v--;if(v<0){return m;}return v;},_focus:function(E){if(jQuery.type(E.focus)==="function"){setTimeout(function(){E.focus();},0);}}});f.prototype.setIdeaDescription=function(v){this.setProperty("ideaDescription",v);this._getIdeaDescription().setContent("<span>"+(v||"")+"</span>");};f.prototype.setIdeaName=function(v){this.setProperty("ideaName",v);var i=this._getIdeaLink();if(i){i.setText(v);}i=this._getIdeaLink("Back");if(i){i.setText(v);}};f.prototype.setIdeaSubmittedAt=function(v){this.setProperty("ideaSubmittedAt",v);this._getIdeaSubmitter().setText(this._getIdeaSubmitterText());};f.prototype.setIdeaCreatedAt=function(v){this.setProperty("ideaCreatedAt",v);this._getIdeaSubmitter().setText(this._getIdeaSubmitterText());};f.prototype.setIdeaSubmitter=function(v){this.setProperty("ideaSubmitter",v);this._getIdeaSubmitter().setText(this._getIdeaSubmitterText());};return f;});};if(!jQuery.sap.isDeclared('sap.ino.controls.IdentityActionCard')){jQuery.sap.declare('sap.ino.controls.IdentityActionCard');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.ToggleButton');jQuery.sap.require('sap.m.ButtonType');sap.ui.define("sap/ino/controls/IdentityActionCard",["sap/ui/core/Control","sap/ino/controls/IdentityCard","sap/m/Button","sap/m/Text","sap/m/ToggleButton","sap/m/ButtonType"],function(C,I,B,T,a,b){"use strict";var c=I.extend("sap.ino.controls.IdentityActionCard",{metadata:{properties:{userRole:{type:"string"},actionable:{type:"boolean"},mailable:{type:"boolean"},pinnable:{type:"boolean"},isAdd:{type:"boolean"},isPinned:{type:"boolean"}},events:{pinPressed:{},addRemovePressed:{},mailPressed:{}}},init:function(){I.prototype.init.call(this,arguments);this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");this.addStyleClass("sapInoIdentityBox sapUiTinyMarginBeginEnd sapUiTinyMarginTopBottom sapThemeBaseBG sapUiResponsiveContentPadding");this.addContent(new T({text:"",visible:false,wrapping:true}));this.addAction(new a({type:b.Transparent,icon:"sap-icon://pushpin-off",visible:false,press:this._firePinPressed.bind(this)}).addStyleClass("sapInoPinBtn"));this.addAction(new B({type:b.Transparent,icon:"sap-icon://add",visible:false,press:this._fireAddRemovePressed.bind(this)}).addStyleClass("sapInoIdentityAddRemoveBtn"));this.addAction(new B({type:b.Transparent,icon:"sap-icon://email",visible:false,press:this._fireMailPressed.bind(this)}));},setUserRole:function(r){var R=this.getContent()[0];R.setText(r);R.setVisible(!!r);this.setProperty("userRole",r);return this;},setActionable:function(i){var A=this.getActions()[1];A.setVisible(i);this.setProperty("actionable",i);return this;},setMailable:function(i){var A=this.getActions()[2];A.setVisible(i);this.setProperty("mailable",i);return this;},setIsAdd:function(i){var A=this.getActions()[1];A.setIcon(i?"sap-icon://add":"sap-icon://decline");A.setTooltip(this._oRB.getText(i?"CTRL_IDENTITY_CARD_BTN_TOOLTIP_ADD":"CTRL_IDENTITY_CARD_BTN_TOOLTIP_REMOVE"));this.setProperty("isAdd",i);return this;},setPinnable:function(i){var p=this.getActions()[0];p.setVisible(i);this.setProperty("pinnable",i);return this;},setIsPinned:function(i){var p=this.getActions()[0];p.setTooltip(this._oRB.getText(i?"CTRL_CLIPBOARD_BTN_TOOLTIP_PERSON_REMOVE":"CTRL_CLIPBOARD_BTN_TOOLTIP_PERSON_ADD"));p.setPressed(i);this.setProperty("isPinned",i);return this;},_firePinPressed:function(e){this.firePinPressed({identityId:this.getIdentityId(),userName:this.getUserName(),pinned:e.getSource().getPressed()});},_fireAddRemovePressed:function(e){this.fireAddRemovePressed({identityId:this.getIdentityId(),userName:this.getUserName(),action:this.getIsAdd()?"add":"remove"});},_fireMailPressed:function(e){this.fireMailPressed({identityId:this.getIdentityId(),userName:this.getUserName()});},renderer:"sap.ino.controls.IdentityCardRenderer",onAfterRendering:function(){I.prototype.onAfterRendering.call(this,arguments);this._initTabs();},_initTabs:function(){this._tabs=[];var t=this;if(this.getAggregation("_nameLink")){this._tabs.push(this.getAggregation("_nameLink").$()[0].id);}this.getActions().forEach(function(i){if(i.$().length>0){t._tabs.push(i.$()[0].id);}});},_getTabs:function(){return this._tabs;},onkeydown:function(e){var t=this._getTabs();var f=true;var u=this._incr;if(e.shiftKey||e.keyCode===jQuery.sap.KeyCodes.ARROW_UP||e.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){u=this._decr;f=false;}if(e.keyCode===jQuery.sap.KeyCodes.ESCAPE){this.getParent().focus();}else if(e.keyCode===jQuery.sap.KeyCodes.TAB||e.keyCode===jQuery.sap.KeyCodes.ARROW_DOWN||e.keyCode===jQuery.sap.KeyCodes.ARROW_RIGHT||e.keyCode===jQuery.sap.KeyCodes.ARROW_UP||e.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){var i=-1;if(document.activeElement){i=t.indexOf(document.activeElement.id);if(i===-1){return;}if((f&&i<t.length-1)||(!f&&i>0)){i=u(i,t.length-1);this._focus(jQuery("#"+t[i]));e.preventDefault();e.stopPropagation();}}}},_incr:function(v,m){v++;if(v>m){return 0;}return v;},_decr:function(v,m){v--;if(v<0){return m;}return v;},_focus:function(e){if(jQuery.type(e.focus)==="function"){setTimeout(function(){e.focus();},0);}}});return c;});};if(!jQuery.sap.isDeclared('sap.ino.controls.Image')){jQuery.sap.declare('sap.ino.controls.Image');jQuery.sap.require('sap.m.Image');jQuery.sap.require('sap.m.ImageRenderer');sap.ui.define("sap/ino/controls/Image",["sap/ino/controls/util/ColorSupport","sap/m/Image","sap/m/ImageRenderer"],function(C,I,a){"use strict";var b=I.extend("sap.ino.controls.Image",{metadata:{properties:{"foregroundColor":{type:"sap.ui.core.CSSColor"},"objectId":{type:"int"},"objectName":{type:"string"},"imageAlt":{type:"string"},"disableImage":{type:'boolean'}},aggregations:{"followButton":{type:"sap.ui.core.Control",multiple:false}},events:{press:{parameters:{objectId:{type:"int"}}}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},renderDisableImage:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapInoImage sapInoImageTextContainer");if(c.hasListeners("press")){r.addClass("sapInoImageTextContainerNav");}var s="";if(c.getProperty("width")){s="width:"+c.getProperty("width")+";";}if(c.getProperty("height")){s=s+"height:"+c.getProperty("height")+";";}if(s){r.writeAttributeEscaped("style",s);}r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoImageDescription");var f=c.getProperty("foregroundColor");if(f&&f.length===7){r.writeAttributeEscaped("style","color: "+C.calculateMediaTextColor(f.substr(1,2),f.substr(3,2),f.substr(5,2))+"; background-color: "+f);}r.writeClasses();if(c.hasListeners("press")){if(c.getTooltip_Text()){r.writeAttributeEscaped("title",c.getTooltip_Text());}}r.write(">");var i=c.getProperty("imageAlt");if(i&&i.length>100){i=i.slice(0,99)+'...';}if(i){r.writeEscaped(i);}r.write("</div>");c._renderFollowButton(r,c);r.write("</div>");},renderImage:function(r,c){r.write("<div>");c._renderFollowButton(r,c);a.render.apply(this,arguments);r.write("</div>");},renderDefault:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapInoImage sapInoImageTextContainer");if(c.hasListeners("press")){r.addClass("sapInoImageTextContainerNav");}var s="";if(c.getProperty("width")){s="width:"+c.getProperty("width")+";";}if(c.getProperty("height")){s=s+"height:"+c.getProperty("height")+";";}if(s){r.writeAttributeEscaped("style",s);}r.writeClasses();r.write(">");r.write("<div");r.addClass("sapInoImageDefaultText");var f=c.getProperty("foregroundColor");if(f&&f.length===7){r.writeAttributeEscaped("style","opacity: 0.4; color: "+C.calculateMediaTextColor(f.substr(1,2),f.substr(3,2),f.substr(5,2))+"; background-color: "+f);}r.writeClasses();if(c.hasListeners("press")){if(c.getTooltip_Text()){r.writeAttributeEscaped("title",c.getTooltip_Text());}}r.write(">");var o=c.getProperty("objectName");if(o){r.writeEscaped(o);}r.write("</div>");c._renderFollowButton(r,c);r.write("</div>");},renderer:function(r,c){var d=c.getProperty('disableImage');var i=c.getProperty("src");if(d){return c.renderDisableImage(r,c);}if(!i){return c.renderDefault(r,c);}return c.renderImage(r,c);},_renderFollowButton:function(r,c){var f=c.getAggregation("followButton");r.renderControl(f);},onAfterRendering:function(){var $=jQuery(this.getDomRef());$.addClass("sapInoImage");if($.is("img")){$.addClass("sapInoImageMargins");$.attr("tabindex","-1");}else if(this.getWidth()){var p=this.getWidth().match(/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/);if(p&&p[1]){var P=(p[2]==="px")?0:2;var f=""+(p[1]*0.37).toFixed(P)+p[2];$.children(".sapInoImageText").css("font-size",f);}}}});b.prototype.setSrc=function(v){this.setProperty("src",v);};return b;});};if(!jQuery.sap.isDeclared('sap.ino.controls.Vote')){jQuery.sap.declare('sap.ino.controls.Vote');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.RatingIndicator');jQuery.sap.require('sap.m.ToggleButton');sap.ui.define("sap/ino/controls/Vote",["sap/m/ButtonType","sap/ui/core/Control","sap/ui/core/IconPool","sap/m/HBox","sap/m/RatingIndicator","sap/m/ToggleButton","sap/ino/controls/VoteType"],function(B,C,I,H,R,T,V){"use strict";var a=C.extend("sap.ino.controls.Vote",{metadata:{properties:{"voteId":{type:"int"},"objectId":{type:"int"},"enabled":{type:"boolean"},"type":{type:"string"},"value":{type:"float"},"maxStar":{type:"int"},"tooltip":{type:"string"}},aggregations:{"_like":{type:"sap.m.ToggleButton",multiple:false,visibility:"hidden"},"_likeDislike":{type:"sap.m.HBox",multiple:false,visibility:"hidden"},"_star":{type:"sap.m.RatingIndicator",multiple:false,visibility:"hidden"}},events:{userVote:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_getLike:function(){var l=this.getAggregation("_like");var t=this;if(!l){l=new T({enabled:this.getProperty("enabled"),icon:I.getIconURI("heart","InoIcons"),press:function(){t._onButtonPressed();},pressed:this.getProperty("value")===1,tooltip:this.getProperty("tooltip"),type:B.Transparent});this.setAggregation("_like",l,true);}return l;},_getLikeDislike:function(){var l=this.getAggregation("_likeDislike");var t=this;if(!l){var L=new T({enabled:this.getProperty("enabled"),icon:I.getIconURI("thumbsup","InoIcons"),press:function(){t._onButtonPressed(true);},pressed:this.getValue()===1,tooltip:this.getProperty("tooltip")+'('+this._oRB.getText("VOTE_FLD_LIKE_THUMBS_UP_TOOLTIP")+')',type:B.Transparent});L.addStyleClass("sapInoVoteLikeDislikeLike");var d=new T({enabled:this.getProperty("enabled"),icon:I.getIconURI("thumbsdown","InoIcons"),press:function(){t._onButtonPressed();},pressed:this.getValue()===-1,tooltip:this.getProperty("tooltip")+'('+this._oRB.getText("VOTE_FLD_DISLIKE_THUMBS_DOWN_TOOLTIP")+')',type:B.Transparent});d.addStyleClass("sapInoVoteLikeDislikeDislike");l=new H({displayInline:true,items:[L,d],tooltip:this.getProperty("tooltip")});this.setAggregation("_likeDislike",l,true);}return l;},_getLikeDislikeLike:function(){return this._getLikeDislike().getItems()[0];},_getLikeDislikeDislike:function(){return this._getLikeDislike().getItems()[1];},_getStar:function(){var s=this.getAggregation("_star");var t=this;if(!s){s=new R({change:function(){t._onButtonPressed();},enabled:this.getEnabled(),maxValue:this.getMaxStar(),value:this.getValue(),tooltip:this.getProperty("tooltip")}).addStyleClass('starVote');this.setAggregation("_star",s,true);}return s;},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapInoVote");r.writeClasses();if(c.getTooltip_Text()){r.writeAttributeEscaped("title",c.getTooltip());}r.write(">");var v;switch(c.getProperty("type")){case V.TYPE_LIKE:v=c._getLike();break;case V.TYPE_LIKE_DISLIKE:v=c._getLikeDislike();break;case V.TYPE_STAR:v=c._getStar();break;default:break;}if(v){r.renderControl(v);}r.write("</div>");},_onButtonPressed:function(l){var v=this.getProperty("value");var t=this.getProperty("type");if(t){switch(t){case V.TYPE_LIKE:this.setProperty("value",(v===1)?0:1);break;case V.TYPE_LIKE_DISLIKE:var L=this._getLikeDislikeLike();var d=this._getLikeDislikeDislike();if(l&&L&&d){d.setPressed(false);L.setPressed(L.getPressed());this.setProperty("value",(L.getPressed())?1:0);}else if(L&&d){d.setPressed(d.getPressed());L.setPressed(false);this.setProperty("value",(d.getPressed())?-1:0);}break;case V.TYPE_STAR:var s=this._getStar();this.setProperty("value",s.getValue());break;default:break;}this.fireUserVote({voteId:this.getVoteId(),value:this.getValue(),objectId:this.getObjectId(),type:this.getType(),oldValue:v});}}});a.prototype.setEnabled=function(v){this.setProperty("enabled",v);if(this.getProperty("type")){switch(this.getProperty("type")){case V.TYPE_LIKE:this._getLike().setEnabled(v);break;case V.TYPE_LIKE_DISLIKE:this._getLikeDislikeLike().setEnabled(v);this._getLikeDislikeDislike().setEnabled(v);break;case V.TYPE_STAR:this._getStar().setEnabled(v);break;default:break;}}};a.prototype.setValue=function(v){this.setProperty("value",v);if(this.getProperty("type")){switch(this.getProperty("type")){case V.TYPE_LIKE:this._getLike().setPressed(v===1);break;case V.TYPE_LIKE_DISLIKE:this._getLikeDislikeLike().setPressed(v===1);this._getLikeDislikeDislike().setPressed(v===-1);break;case V.TYPE_STAR:this._getStar().setValue(v);break;default:break;}}};a.prototype.setType=function(v){this.setProperty("type",v);this.setValue(this.getValue());this.setEnabled(this.getEnabled());};a.prototype.setMaxStar=function(m){this.setProperty("maxStar",m);if(this.getProperty("type")===V.TYPE_STAR){this._getStar().setMaxValue(m);}};a.prototype.setTooltip=function(v){this.setProperty("tooltip",v);if(this.getProperty("type")){switch(this.getProperty("type")){case V.TYPE_LIKE:this._getLike().setTooltip(v);break;case V.TYPE_LIKE_DISLIKE:this._getLikeDislikeLike().setTooltip(v);this._getLikeDislikeDislike().setTooltip(v);break;case V.TYPE_STAR:this._getStar().setTooltip(v);break;default:break;}}else{this.setAggregation("_like",undefined);this.setAggregation("_likeDislike",undefined);this.setAggregation("_star",undefined);}};return a;});};if(!jQuery.sap.isDeclared('sap.ino.controls.VoteDisplay')){jQuery.sap.declare('sap.ino.controls.VoteDisplay');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.ui.core.format.NumberFormat');sap.ui.define("sap/ino/controls/VoteDisplay",["sap/ui/core/Control","sap/ui/core/IconPool","sap/m/Text","sap/m/HBox","sap/ino/controls/LabelledIcon","sap/ui/core/format/NumberFormat","sap/ino/controls/VoteType"],function(C,I,T,H,L,N,V){"use strict";var i=N.getIntegerInstance({style:"short"});var f=N.getFloatInstance({decimals:1});var a=C.extend("sap.ino.controls.VoteDisplay",{metadata:{properties:{"likeVotes":{type:"int"},"negativeVotes":{type:"int"},"positiveVotes":{type:"int"},"starVoteCount":{type:"int"},"starVotes":{type:"float"},"score":{type:"float"},"type":{type:"string"},"isExpert":{type:"boolean",defaultValue:false}},aggregations:{"_like":{type:"sap.ino.controls.LabelledIcon",multiple:false,visibility:"hidden"},"_likeDislike":{type:"sap.m.HBox",multiple:false,visibility:"hidden"},"_star":{type:"sap.ino.controls.LabelledIcon",multiple:false,visibility:"hidden"},"_score":{type:"sap.m.Text",multiple:false,visibility:"hidden"}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_getLike:function(){var l=this.getAggregation("_like");if(!l){l=new L({iconUrl:this.getIsExpert()?"sap-icon://person-placeholder":I.getIconURI("heart","InoIcons"),label:i.format(this.getLikeVotes())});this.setAggregation("_like",l,true);}return l;},_getLikeDislike:function(){var l=this.getAggregation("_likeDislike");if(!l){var o=new L({iconUrl:this.getIsExpert()?"sap-icon://employee-approvals":I.getIconURI("thumbsup","InoIcons"),label:i.format(this.getPositiveVotes())}).addStyleClass("sapInoVoteDisplayLike");var d=new L({iconUrl:this.getIsExpert()?"sap-icon://employee-rejections":I.getIconURI("thumbsdown","InoIcons"),label:i.format(this.getNegativeVotes())}).addStyleClass("sapInoVoteDisplayDislike");l=new H({items:[o,d],displayInline:true});this.setAggregation("_likeDislike",l,true);}return l;},_getLikeDislikeLike:function(){return this._getLikeDislike().getItems()[0];},_getLikeDislikeDislike:function(){return this._getLikeDislike().getItems()[1];},_getStarLabel:function(){var l;var s=this.getStarVotes();var S=this.getStarVoteCount();if(s!==undefined&&s!==null&&S!==undefined&&S!==null){if(S!==1){l=this._oRB.getText("CTRL_VOTE_DISPLAY_FLD_STARS",[f.format(s),i.format(S)]);}else{l=this._oRB.getText("CTRL_VOTE_DISPLAY_FLD_STAR",[f.format(s),S]);}}return l;},_getStar:function(){var s=this.getAggregation("_star");if(!s){s=new L({iconUrl:this.getIsExpert()?"sap-icon://person-placeholder":"sap-icon://favorite",label:this._getStarLabel()});this.setAggregation("_star",s,true);}return s;},_getScore:function(){var s=this.getAggregation("_score");if(!s){s=new T({text:this.getScore()});this.setAggregation("_score",s,true);}return s;},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapInoVoteDisplay");r.writeClasses();if(c.getTooltip_Text()){r.writeAttributeEscaped("title",c.getTooltip_Text());}r.write(">");var v;switch(c.getProperty("type")){case V.TYPE_LIKE:v=c._getLike();break;case V.TYPE_LIKE_DISLIKE:v=c._getLikeDislike();break;case V.TYPE_STAR:v=c._getStar();break;default:break;}if(v){r.renderControl(v);}r.write("</div>");}});a.prototype.onAfterRendering=function(){this._getLike().data("ignoreExport",true);this._getLikeDislikeLike().data("ignoreExport",true);this._getLikeDislikeDislike().data("ignoreExport",true);this._getStar().data("ignoreExport",true);};a.prototype.bindProperty=function(k,b){C.prototype.bindProperty.apply(this,arguments);switch(k){case"likeVotes":this._getLike().bindProperty("label",b);break;case"positiveVotes":this._getLikeDislikeLike().bindProperty("label",b);break;case"negativeVotes":this._getLikeDislikeDislike().bindProperty("label",b);break;case"starVotes":this._getStar().bindProperty("label",b);break;case"score":this._getScore().bindProperty("text",b);break;default:break;}};a.prototype.setLikeVotes=function(v){this.setProperty("likeVotes",v);this._getLike().setLabel(i.format(v));};a.prototype.setStarVotes=function(v){this.setProperty("starVotes",v);this._getStar().setLabel(this._getStarLabel());};a.prototype.setStarVoteCount=function(v){this.setProperty("starVoteCount",v);this._getStar().setLabel(this._getStarLabel());};a.prototype.setPositiveVotes=function(v){this.setProperty("positiveVotes",v);this._getLikeDislikeLike().setLabel(i.format(v));};a.prototype.setNegativeVotes=function(v){this.setProperty("negativeVotes",v);this._getLikeDislikeDislike().setLabel(i.format(v));};return a;});};if(!jQuery.sap.isDeclared('sap.ino.controls.VoteNoImage')){jQuery.sap.declare('sap.ino.controls.VoteNoImage');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.RatingIndicator');jQuery.sap.require('sap.m.ToggleButton');jQuery.sap.require('sap.ui.core.format.NumberFormat');jQuery.sap.require('sap.m.Label');sap.ui.define("sap/ino/controls/VoteNoImage",["sap/m/ButtonType","sap/ui/core/Control","sap/ui/core/IconPool","sap/m/HBox","sap/m/RatingIndicator","sap/m/ToggleButton","sap/ino/controls/VoteType","sap/ui/core/format/NumberFormat","sap/ino/controls/LabelledIcon","sap/m/Label"],function(B,C,I,H,R,T,V,N,L,a){"use strict";var i=N.getIntegerInstance({style:"short"});var f=N.getFloatInstance({decimals:1});var b=C.extend("sap.ino.controls.VoteNoImage",{metadata:{properties:{"voteId":{type:"int"},"objectId":{type:"int"},"enabled":{type:"boolean"},"type":{type:"string"},"value":{type:"float"},"maxStar":{type:"int"},"tooltip":{type:"string"},"likeVotes":{type:"int"},"starVoteCount":{type:"int"},"starVotes":{type:"float"},"score":{type:"float"},"voteCount":{type:"int"}},aggregations:{"_like":{type:"sap.m.ToggleButton",multiple:false,visibility:"hidden"},"_likeDislike":{type:"sap.m.HBox",multiple:false,visibility:"hidden"},"_star":{type:"sap.m.RatingIndicator",multiple:false,visibility:"hidden"},"_score":{type:"sap.m.Text",multiple:false,visibility:"hidden"}},events:{userVote:{}}},init:function(){this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");},_getLike:function(){var l=this.getAggregation("_like");var t=this;if(!l){l=new T({enabled:this.getProperty("enabled"),icon:I.getIconURI("heart","InoIcons"),press:function(){t._onButtonPressed();},pressed:this.getProperty("value")===1,tooltip:this.getProperty("tooltip"),type:B.Transparent});this.setAggregation("_like",l,true);}return l;},_getLikeDislike:function(){var l=this.getAggregation("_likeDislike");var t=this;if(!l){var o=new T({enabled:this.getProperty("enabled"),icon:I.getIconURI("thumbsup","InoIcons"),press:function(){t._onButtonPressed(true);},pressed:this.getValue()===1,tooltip:this.getProperty("tooltip"),type:B.Transparent});o.addStyleClass("sapInoVoteLikeDislikeLike");var d=new T({enabled:this.getProperty("enabled"),icon:I.getIconURI("thumbsdown","InoIcons"),press:function(){t._onButtonPressed();},pressed:this.getValue()===-1,tooltip:this.getProperty("tooltip"),type:B.Transparent});d.addStyleClass("sapInoVoteLikeDislikeDislike");l=new H({displayInline:true,items:[o,d],tooltip:this.getProperty("tooltip")});this.setAggregation("_likeDislike",l,true);}return l;},_getLikeDislikeLike:function(){return this._getLikeDislike().getItems()[0];},_getLikeDislikeDislike:function(){return this._getLikeDislike().getItems()[1];},_getStar:function(){var s=this.getAggregation("_star");var t=this;if(!s){s=new R({change:function(){t._onButtonPressed();},enabled:this.getEnabled(),maxValue:this.getMaxStar(),value:this.getValue(),tooltip:this.getProperty("tooltip")}).addStyleClass('starVote');this.setAggregation("_star",s,true);}return s;},_getStatusText:function(){var v=this.getValue()===1||this.getValue()===-1?this._oRB.getText('CTRL_VOTE_DISPLAY_VOTED'):this._oRB.getText('CTRL_VOTE_DISPLAY_VOTE');return v;},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapInoVoteNoImage");r.writeClasses();if(c.getTooltip_Text()){r.writeAttributeEscaped("title",c.getTooltip());}r.write(">");var v;switch(c.getProperty("type")){case V.TYPE_LIKE:v=c._getLike();break;case V.TYPE_LIKE_DISLIKE:v=c._getLikeDislike();break;case V.TYPE_STAR:v=c._getStar();break;default:break;}if(v){r.renderControl(v);if(c.getProperty("type")===V.TYPE_STAR){var d=c._getStarLabel();r.renderControl(d);}}r.write("</div>");},_getStarLabel:function(){var l;var v=this.getVoteId()?this._oRB.getText('CTRL_VOTE_DISPLAY_VOTED'):this._oRB.getText('CTRL_VOTE_DISPLAY_VOTE');var s=this.getVoteId()?'sapInoStarVoted':'';var S=this.getStarVotes();var c=this.getStarVoteCount();if(S!==undefined&&S!==null&&c!==undefined&&c!==null){l=v+'  '+f.format(S);}var o=new L({label:l}).addStyleClass(s);return o;},_onButtonPressed:function(l){var v=this.getProperty("value");var t=this.getProperty("type");if(t){switch(t){case V.TYPE_LIKE:this.setProperty("value",(v===1)?0:1);break;case V.TYPE_LIKE_DISLIKE:var o=this._getLikeDislikeLike();var d=this._getLikeDislikeDislike();if(l&&o&&d){d.setPressed(false);o.setPressed(o.getPressed());this.setProperty("value",(o.getPressed())?1:0);}else if(o&&d){d.setPressed(d.getPressed());o.setPressed(false);this.setProperty("value",(d.getPressed())?-1:0);}break;case V.TYPE_STAR:var s=this._getStar();this.setProperty("value",s.getValue());break;default:break;}this.fireUserVote({voteId:this.getVoteId(),value:this.getValue(),objectId:this.getObjectId(),type:this.getType(),oldValue:v});}}});b.prototype.setEnabled=function(v){this.setProperty("enabled",v);if(this.getProperty("type")){switch(this.getProperty("type")){case V.TYPE_LIKE:this._getLike().setEnabled(v);break;case V.TYPE_LIKE_DISLIKE:this._getLikeDislikeLike().setEnabled(v);this._getLikeDislikeDislike().setEnabled(v);break;case V.TYPE_STAR:this._getStar().setEnabled(v);break;default:break;}}};b.prototype.setValue=function(v){this.setProperty("value",v);if(this.getProperty("type")){switch(this.getProperty("type")){case V.TYPE_LIKE:this._getLike().setPressed(v===1).setText(this._getStatusText());break;case V.TYPE_LIKE_DISLIKE:this._getLikeDislikeLike().setPressed(v===1);this._getLikeDislikeDislike().setPressed(v===-1);if(v===1){this._getLikeDislikeLike().setText(this._getStatusText());}else if(v===-1){this._getLikeDislikeDislike().setText(this._getStatusText());}else{this._getLikeDislikeLike().setText(this._getStatusText());this._getLikeDislikeDislike().setText(this._getStatusText());}break;case V.TYPE_STAR:this._getStar().setValue(v);break;default:break;}}};b.prototype.setType=function(v){this.setProperty("type",v);this.setValue(this.getValue());this.setEnabled(this.getEnabled());};b.prototype.setMaxStar=function(m){this.setProperty("maxStar",m);if(this.getProperty("type")===V.TYPE_STAR){this._getStar().setMaxValue(m);}};b.prototype.setTooltip=function(v){this.setProperty("tooltip",v);if(this.getProperty("type")){switch(this.getProperty("type")){case V.TYPE_LIKE:this._getLike().setTooltip(v);break;case V.TYPE_LIKE_DISLIKE:this._getLikeDislikeLike().setTooltip(v);this._getLikeDislikeDislike().setTooltip(v);break;case V.TYPE_STAR:this._getStar().setTooltip(v);break;default:break;}}else{this.setAggregation("_like",undefined);this.setAggregation("_likeDislike",undefined);this.setAggregation("_star",undefined);}};return b;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.ExportMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.ExportMixin');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.core.BusyIndicator');sap.ui.define("sap/ino/vc/commons/mixins/ExportMixin",["sap/ino/commons/application/Configuration","sap/ui/core/format/DateFormat","sap/m/MessageToast","sap/ui/core/BusyIndicator","sap/ino/vc/idea/mixins/IdeaFormCriteriaFilterMixin"],function(C,D,M,B){"use strict";var E=function(){throw"Mixin may not be instantiated directly";};var a=function(f,e){var t=this;var p=this._getExportParam(f,e);if(!p){B.hide();return;}jQuery.ajax({url:C.getBackendRootURL()+"/sap/ino/xs/rest/common/export_idea.xsjs",data:p,beforeSend:function(){t.setBusy(true);},success:function(r,s,x){t.setBusy(false);B.hide();M.show(t.getText(r.messageKey));},error:function(r,s,x){t.setBusy(false);B.hide();M.show(t.getText(r.responseJSON.messageKey));}});};E.onListExport=function(e){if(!this._oExportActionSheet){this._oExportActionSheet=this.createFragment("sap.ino.vc.commons.fragments.ExportActionSheet",this.getView().getId());this.getView().addDependent(this._oExportActionSheet);}if(e.getSource().data("placement")){this._oExportActionSheet.setPlacement(e.getSource().data("placement"));}this._oExportActionSheet.triggerButton=e.getSource();this._oExportActionSheet.openBy(e.getSource());};E.onListExportXLS=function(e){var t=this,l={xls:2000};if(!t._checkExportCount("xls",l)){M.show(t.getText("EXPORT_XLS_LIMIT_COUNT_MSG",l.xls));return;}B.show(0);setTimeout(function(){sap.ui.require(["sap/ino/commons/util/Export"],function(b){b.i18n=t.getModel("i18n");var o=typeof t.getExportControl==="function"?t.getExportControl():t.getList();var c=typeof t.fnCompleted==="function"?t.fnCompleted:null;if(t._IsExportIdeaViaEmail()){a.call(t,"xls",o);}else if(t._IsExportIdeaDirectly()){var p=t._getExportParam("xls",o);if(!p){B.hide();return;}p.ISNOTSENDEMAIL=true;b.exportAdvancedIdea("xls",p,t._oExportActionSheet.triggerButton,t.getText.bind(t));}else if(c){b.exportAdvanced(o,"xls",t.getExportPrefix&&t.getExportPrefix(),t._oExportActionSheet.triggerButton,C.getCurrentUser().NAME,null,c(t));}else{b.exportAdvanced(o,"xls",t.getExportPrefix&&t.getExportPrefix(),t._oExportActionSheet.triggerButton,C.getCurrentUser().NAME);}});});};E.onListExportCSV=function(e){var t=this,l={csv:3000};if(!t._checkExportCount("csv",l)){M.show(t.getText("EXPORT_CSV_LIMIT_COUNT_MSG",l.csv));return;}B.show(0);setTimeout(function(){sap.ui.require(["sap/ino/commons/util/Export"],function(b){b.i18n=t.getModel("i18n");var o=typeof t.getExportControl==="function"?t.getExportControl():t.getList();var c=typeof t.fnCompleted==="function"?t.fnCompleted:null;if(t._IsExportIdeaViaEmail()){a.call(t,"csv",o);}else if(t._IsExportIdeaDirectly()){var p=t._getExportParam("csv",o);if(!p){B.hide();return;}p.ISNOTSENDEMAIL=true;b.exportAdvancedIdea("csv",p,t._oExportActionSheet.triggerButton,t.getText.bind(t));}else if(c){b.exportAdvanced(o,"csv",t.getExportPrefix&&t.getExportPrefix(),t._oExportActionSheet.triggerButton,C.getCurrentUser().NAME,null,c(t));}else{b.exportAdvanced(o,"csv",t.getExportPrefix&&t.getExportPrefix(),t._oExportActionSheet.triggerButton,C.getCurrentUser().NAME);}});});};E.onListExportPPT=function(e){var t=this,l={pptx:2000};if(!t._checkExportCount("pptx",l)){M.show(t.getText("EXPORT_PPTX_LIMIT_COUNT_MSG",l.pptx));return;}B.show(0);setTimeout(function(){sap.ui.require(["sap/ino/commons/util/Export"],function(b){b.i18n=t.getModel("i18n");var o=typeof t.getExportControl==="function"?t.getExportControl():t.getList();var c=typeof t.fnCompleted==="function"?t.fnCompleted:null;if(t._IsExportIdeaViaEmail()){a.call(t,"pptx",o);}else if(t._IsExportIdeaDirectly()){var p=t._getExportParam("pptx",o);if(!p){B.hide();return;}p.ISNOTSENDEMAIL=true;b.exportAdvancedIdea("pptx",p,t._oExportActionSheet.triggerButton,t.getText.bind(t));}else if(c){b.exportAdvanced(o,"pptx",t.getExportPrefix&&t.getExportPrefix(),t._oExportActionSheet.triggerButton,C.getCurrentUser().NAME,null,c(t));}else{b.exportAdvanced(o,"pptx",t.getExportPrefix&&t.getExportPrefix(),t._oExportActionSheet.triggerButton,C.getCurrentUser().NAME,50);}});});};E._IsExportIdeaViaEmail=function(){return this.getExportPrefix&&this.getExportPrefix()===this.getText("EXPORT_PREFIX_IDEA")&&this.getViewProperty("/List/EXPORT_IDEA_VIA_EMAIL");};E._IsExportIdeaDirectly=function(){return this.getExportPrefix&&this.getExportPrefix()===this.getText("EXPORT_PREFIX_IDEA");};E._getExportParam=function(f,e){var b=this.getBindingParameter();var i=this._check4ManagingList();var F=e.getBinding('items').sFilterParams;var d=D.getDateTimeInstance({pattern:"dd-MM-yyyy_HH-mm"});var s=this.getText("EXPORT_PREFIX_IDEA")+"_"+d.format(new Date());var I=typeof this.getIdeaformFilters==="function"?this.getIdeaformFilters().replace(/\'/g,"").replace(/\"/g,"").split(","):undefined;var c=typeof this.getCompanyViewFilters==="function"?this.getCompanyViewFilters().replace(/\'/g,"").replace(/\"/g,"").split(","):undefined;var t=this.getViewProperty("/List/TAGS");var g={};var h=[];t.forEach(function(l,m){if(!g[l.ROOTGROUPID]){g[l.ROOTGROUPID]=[];g[l.ROOTGROUPID].push(l.ID);h.push(l.ROOTGROUPID);}else{g[l.ROOTGROUPID].push(l.ID);}});var P={searchToken:b.SearchTerm||"",tagsToken:g[h[0]]?g[h[0]].join(","):"",tagsToken1:g[h[1]]?g[h[1]].join(","):"",tagsToken2:g[h[2]]?g[h[2]].join(","):"",tagsToken3:g[h[3]]?g[h[3]].join(","):"",tagsToken4:g[h[4]]?g[h[4]].join(","):"",filterName:b.VariantFilter||"",filterBackoffice:i?"1":"0",c1:I?(I[1].slice(3)||""):"",o1:I?(I[2].slice(3)||-1):-1,v1:I?(decodeURIComponent(I[3].slice(3))||""):"",c2:I?(I[4].slice(3)||""):"",o2:I?(I[5].slice(3)||-1):"",v2:I?(decodeURIComponent(I[6].slice(3))||""):"",c3:I?(I[7].slice(3)||""):"",o3:I?(I[8].slice(3)||-1):-1,v3:I?(decodeURIComponent(I[9].slice(3))||""):"",cvy:c?(c[3].slice(4)||0):0,cvr:c?(c[2].slice(4)||0):0,cvt:c?(decodeURIComponent(c[1].slice(4))||""):"",filterString:F||"",fileName:s,fileFormat:f};if(!i){var G=typeof this.getGroupViewParameters==="function"?this.getGroupViewParameters(b):undefined;P.cvy=G?G.groupType:0;P.cvr=G?G.groupRole:0;P.cvt=G?G.groupToken:"";}else{P.searchType=typeof this.getSearchType==="function"?this.getSearchType():0;}var j=P.filterString?(/\$filter=(.*)/gm.exec(F)[1]):"";var k=[];if(this.getViewProperty("/List/SELECT_ALL")||this.getViewProperty("/List/EXPORT_ALL")){P.ideasId="";for(var p in this._oDeselectionMap){if(this._oDeselectionMap.hasOwnProperty(p)){j+="%20and%20ID%20ne%20"+p;}}if(j.indexOf("%20and%20")===0){j=j.slice(9);}P.filterString="$filter=("+j+")";}else{jQuery.each(this._oSelectionMap,function(l,o){k.push(o.ID);});if(k.length===0){M.show(this.getText("MSG_EXPORT_IDEA_NO_SELECTED"));return undefined;}P.ideasId=k.join(",");}return P;};E.onChartExportSVG=function(e){var t=this;B.show(0);setTimeout(function(){sap.ui.require(["sap/ino/commons/util/Export"],function(b){b.i18n=t.getModel("i18n");var o=typeof t.getExportChartControl==="function"?t.getExportChartControl():t.getChart();b.exportChartAdvanced(o,t.getChartTitle&&t.getChartTitle(),e.getSource());});});};E._checkExportCount=function(t,l){var b=this,c={"xls":2000,"csv":3000,"pptx":2000};var v=b.getView().getProperty("viewName");if(v&&v.indexOf("idea")<=0){return true;}var s=C.getSystemSetting("sap.ino.config.COUNT_LIMIT_EXPORT_IDEAS"),d;if(s){d=s.split("|");c.xls=Number(d[0]);c.csv=Number(d[1]);c.pptx=Number(d[2]);}l[t]=c[t];var e=typeof b.getExportControl==="function"?b.getExportControl():b.getList();if(!e){return true;}var p=b._getExportParam(t,e);if(!p){return true;}if(p.ideasId&&p.ideasId.split(",").length<=c[t]){return true;}if(!b.getView().getModel("view")||!b.getView().getModel("view").getProperty("/List/VARIANT")){return true;}var f=b.getView().getModel("view").getProperty("/List/VARIANT");var o=C.getIdeaFilterCountData();if(o&&o[f]&&o[f]>c[t]){return false;}return true;};return E;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.GlobalSearchMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.GlobalSearchMixin');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/commons/mixins/GlobalSearchMixin",["sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration"],function(P,M,J,C){var G=function(){throw"Mixin may not be instantiated directly";};var o={'search':{key:'search',value:'CTRL_GLOBAL_SEARCH_ALL'},'campaignlist':{key:'campaignlist',value:'CTRL_GLOBAL_SEARCH_CAMPAIGNS'},'campaignlistvariant':{key:'campaignlistvariant',value:'CTRL_GLOBAL_SEARCH_CAMPAIGNS'},'idealist':{key:'idealist',value:'CTRL_GLOBAL_SEARCH_IDEAS'},'idealistbycompany':{key:'idealistbycompany',value:C.getGroupConfiguration().DISPLAY_LABEL,bNotFormatter:true},'idealistvariant':{key:'idealistvariant',value:'CTRL_GLOBAL_SEARCH_IDEAS'},'peoplelist':{key:'peoplelist',value:'CTRL_GLOBAL_SEARCH_USERS'},'peoplelistvariant':{key:'peoplelistvariant',value:'CTRL_GLOBAL_SEARCH_USERS'},'walllist':{key:'walllist',value:'CTRL_GLOBAL_SEARCH_WALLS'},'walllistvariant':{key:'walllistvariant',value:'CTRL_GLOBAL_SEARCH_WALLS'},'taglist':{key:'taglist',value:'CTRL_GLOBAL_SEARCH_TAGS'},'taglistvariant':{key:'taglistvariant',value:'CTRL_GLOBAL_SEARCH_TAGS'},'campaign':{key:'campaign',value:'CTRL_GLOBAL_SEARCH_CURRENT_CAMPAIGN'},'searchcategory':{key:'searchcategory',value:'CTRL_GLOBAL_SEARCH_CURRENT_CAMPAIGN'},'campaign-idealist':{key:'campaign-idealist',value:'CTRL_GLOBAL_SEARCH_CAMPAIGN_IDEAS'},'campaign-idealistvariant':{key:'campaign-idealistvariant',value:'CTRL_GLOBAL_SEARCH_CAMPAIGN_IDEAS'},'campaign-idealistbycompany':{key:'campaign-idealistbycompany',value:C.getGroupConfiguration().DISPLAY_LABEL,bNotFormatter:true},'campaign-bloglist':{key:'campaign-bloglist',value:'CTRL_GLOBAL_SEARCH_CAMPAIGN_BLOGS'},'campaign-bloglistvariant':{key:'campaign-bloglistvariant',value:'CTRL_GLOBAL_SEARCH_CAMPAIGN_BLOGS'},'bloglist':{key:'bloglist',value:'CTRL_GLOBAL_SEARCH_BLOGS'},'bloglistvariant':{key:'bloglistvariant',value:'CTRL_GLOBAL_SEARCH_BLOGS'}};var s=[o.search,o.campaignlist,o.idealist,o.peoplelist,o.walllist,o.taglist];var a={ALL:'all',CAMPAIGN:'campaign'};var b={ALL:'all',MANAGE:'manage'};G.setCategroyData=function(){var c=this.getOwnerComponent().getModel('search');if(c){if(C.getSystemSetting("sap.ino.config.PEOPLE_MENU_FOR_ALL_ACTIVE")!=="1"){this._removeCategory(o.peoplelist.key);}c.setProperty('/category',s);}};G.listenRouteMatch=function(){var c=this;this.getOwnerComponent().getRootView().attachEvent('routeMatchedEvent',function(e){var d=e.getParameters().name;var f=this.getModel('search').getProperty('/selectedCategory');var g=$.extend({},e.getParameters().arguments);c._handleSearchRule(d,g,f);});};G._handleSearchRule=function(k,c,d){var e=this;var f=e.getOwnerComponent().getModel('search');var p=c;var g=(k==="idea-display"?o.campaign.key:k);var u=this.getOwnerComponent().getModel("component").getProperty("/SHOW_BACKOFFICE");var h=C.getGroupConfiguration().ENABLE_GROUP_VIEW;if(!u||!h){this._removeCategory(o['campaign-idealistbycompany'].key);this._removeCategory(o.idealistbycompany.key);d=g;}else if(u&&h){if(g==='campaign-idealistvariant'||g==='campaign-idealist'){this._addCategory(o['campaign-idealistbycompany']);this._removeCategory(o.idealistbycompany.key);d=d!=='campaign-idealistbycompany'?g:d;}else if(g==='idealistvariant'||g==='idealist'){this._addCategory(o.idealistbycompany);this._removeCategory(o['campaign-idealistbycompany'].key);d=d!=='idealistbycompany'?g:d;}else if(g==='home'){this._addCategory(o.idealistbycompany);this._removeCategory(o['campaign-idealistbycompany'].key);d=g;}else{this._removeCategory(o['campaign-idealistbycompany'].key);this._removeCategory(o.idealistbycompany.key);d=g;}}switch(g){case o.campaignlistvariant.key:this._replaceKey([o.campaignlist.key],o.campaignlistvariant.key);break;case o.campaignlist.key:this._replaceKey([o.campaignlistvariant.key],o.campaignlist.key);break;case o.idealistvariant.key:this._replaceKey([o.idealist.key],o.idealistvariant.key);break;case o.idealist.key:this._replaceKey([o.idealistvariant.key],o.idealist.key);break;case o.campaign.key:this._addCategory(o.campaign);break;case o.searchcategory.key:this._addCategory(o.searchcategory);break;case o.walllist.key:this._replaceKey([o.walllistvariant.key],o.walllist.key);break;case o.walllistvariant.key:this._replaceKey([o.walllist.key],o.walllistvariant.key);break;case o.taglist.key:this._replaceKey([o.taglistvariant.key],o.taglist.key);break;case o.taglistvariant.key:this._replaceKey([o.taglist.key],o.taglistvariant.key);break;case o.peoplelist.key:this._replaceKey([o.peoplelistvariant.key],o.peoplelist.key);break;case o.peoplelistvariant.key:this._replaceKey([o.peoplelist.key],o.peoplelistvariant.key);break;case o['campaign-idealist'].key:this._addCategory(o['campaign-idealist']);break;case o['campaign-idealistvariant'].key:this._addCategory(o['campaign-idealistvariant']);break;case o['campaign-bloglist'].key:this._addCategory(o['campaign-bloglist']);break;case o['campaign-bloglistvariant'].key:this._addCategory(o['campaign-bloglistvariant']);break;case o.bloglist.key:this._addCategory(o.bloglist);break;case o.bloglistvariant.key:this._addCategory(o.bloglistvariant);break;default:g=this._getSelectedCate(k,g);break;}if(g!==o.campaign.key){this._removeCategory(o.campaign.key);}if(g!==o.searchcategory.key){this._removeCategory(o.searchcategory.key);}if(g!==o['campaign-idealist'].key){this._removeCategory(o['campaign-idealist'].key);}if(g!==o['campaign-idealistvariant'].key){this._removeCategory(o['campaign-idealistvariant'].key);}if(g!==o['campaign-bloglist'].key){this._removeCategory(o['campaign-bloglist'].key);}if(g!==o['campaign-bloglistvariant'].key){this._removeCategory(o['campaign-bloglistvariant'].key);}if(g!==o.bloglist.key){this._removeCategory(o.bloglist.key);}if(g!==o.bloglistvariant.key){this._removeCategory(o.bloglistvariant.key);}if(k!=="idea-display"){f.setProperty('/searchAguments',p);}if(d==='idealistbycompany'||d==='campaign-idealistbycompany'){f.setProperty('/selectedCategory',d);}else{f.setProperty('/selectedCategory',g);}};G._getParams=function(k,p){if(k==="idea-display"){return o.campaign.key;}return p;};G._getSelectedCate=function(k,c){if(k==="idea-display"){return o.campaign.key;}return o[k]?c:o.search.key;};G._replaceKey=function(k,r){var c=this._findCategory(k);if(!c.value||!o[r]){return false;}s[c.index]=o[r];};G._findCategory=function(k){var r={};for(var i=0;i<s.length;i++){if(~k.indexOf(s[i].key)){r.value=s[i];r.index=i;break;}}return r;};G._addCategory=function(c){if(!c||!c.key||!c.value){return false;}var r=this._findCategory([c.key]);if(r.value){return false;}s.unshift(c);};G._removeCategory=function(k){var r=this._findCategory([k]);if(!r.value){return false;}s.splice(r.index,1);};G._handleSearchNavgate=function(k,d){var c=o[d.category]?d.category:o.search.key;if(!d.param.variant&&c==="idealistvariant"){c="idealist";}var q=$.extend({},d.param['?query']);var u=this.getOwnerComponent().getModel("component").getProperty("/SHOW_BACKOFFICE");var e=u?b.MANAGE:b.ALL;var n={query:q,variant:d.param.variant||e};if(k){n.query.search=k;}if(!k&&!$.isEmptyObject(n.query)){delete n.query.search;}if(!k&&$.isEmptyObject(n.query)){return false;}if(n.query.type){delete n.query.type;}if(n.query.id){delete n.query.id;}switch(c){case o.searchcategory.key:$.extend(n,{query:{type:a.CAMPAIGN,id:d.param['?query'].id,search:k||'',managed:0}});break;case o.campaign.key:c=o.searchcategory.key;$.extend(n,{query:{type:a.CAMPAIGN,id:d.param.id,search:k||'',managed:0}});break;case o['campaign-bloglist'].key:case o['campaign-bloglistvariant'].key:case o['campaign-idealistvariant'].key:case o['campaign-idealist'].key:case o['campaign-idealistbycompany'].key:$.extend(true,n,{id:d.param.id});break;case o.search.key:$.extend(n,{query:{type:a.ALL,search:k||'',managed:Number(u||false)}});break;default:$.extend(true,n,{query:{search:k||''}});break;}if(c==='idealistbycompany'){if(d.param.variant){c='idealistvariant';}else{c='idealist';}}else if(c==='campaign-idealistbycompany'){if(d.param.variant){c='campaign-idealistvariant';}else{c='campaign-idealist';}}this.getOwnerComponent().navigateTo(c,n);};G.onSearch=function(e){var p=e.getParameters();var c=window.encodeURIComponent(p.search);if(p.search&&p.category&&p.param&&(p.param.variant==='all'||p.param.variant==='manage')){p.param['?query']=p.param['?query']||{};p.param['?query'].sort="SEARCH_SCORE DESC";}else if(p.param&&p.param['?query']){p.param['?query'].sort="";}this._handleSearchNavgate(c,p);};return G;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.MailMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.MailMixin');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/commons/mixins/MailMixin",["sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast"],function(){"use strict";var M=function(){throw"Mixin may not be instantiated directly";};M.createMailContent=function(){var c=this.getView().getModel("object")||this.getView().getModel("contextObject");if(c){var s="";var C=c.getProperty("/NAME");var a=c.getProperty("/_OBJECT_TYPE_CODE");if(a==="IDEA"){s=this.getText("MAIL_SUBJECT_TEMPLATE",[c.getProperty("/CAMPAIGN_NAME"),C]);}else{s=C;}var b="";var i=c.getProperty("/ID");if(a&&i){var n=a.toLowerCase();if(n==="idea"||n==="evaluation"){n+="-display";}var o=document.location.origin;if(!o){o=window.location.protocol+"//"+window.location.hostname+(window.location.port?':'+window.location.port:'');}var u=o+document.location.pathname+this.getOwnerComponent().getNavigationLink(n,{id:i});b=this.getText("MAIL_TEMPLATE_"+a,u);}return{subject:s,body:b};}else{var s="";var b="";var o=document.location.origin;if(!o){o=window.location.protocol+"//"+window.location.hostname+(window.location.port?':'+window.location.port:'');}var u=o+document.location.pathname;b=this.getText("MAIL_TEMPLATE_INM",u);return{subject:s,body:b};}};return M;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.UI5Mixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.UI5Mixin');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/commons/mixins/UI5Mixin",["sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast"],function(){"use strict";var U=function(){throw"Mixin may not be instantiated directly";};U.changeMethodGetObjectInV2ODataModel=function(){sap.ui.model.odata.v2.ODataModel.prototype._getObject=function(p,c,o){var n=this.isLegacySyntax()?this.oData:null,C,O,r=this.resolve(p,c),s,d,m,M,k,a;if(!r){return n;}if(this._isMetadataPath(r)){if(this.oMetadata&&this.oMetadata.isLoaded()){if(this.isMetaModelPath(r)){s=r.indexOf('/##');a=this.getMetaModel();if(!this.bMetaModelLoaded){return null;}d=r.substr(0,s);m=r.substr(s+3);M=a.getMetaContext(d);n=a.getProperty(m,M);}else{n=this.oMetadata._getAnnotation(r);}}}else if(/^\/IdeaEvaluation\(\d+\)\/EvalAttachments$/gi.test(r)){n=undefined;}else{if(r==="/"){return this.oData;}var P=r.split("/"),i=0;k=P[1];P.splice(0,2);C=this.mChangedEntities[k];O=this._getEntity(k);n=o?O:C||O;while(n&&P[i]){var h=C&&C.hasOwnProperty(P[i]);C=C&&C[P[i]];O=O&&O[P[i]];n=o||!h?O:C;if(n){if(n.__ref){C=this.mChangedEntities[n.__ref];O=this._getEntity(n.__ref);n=o?O:C||O;}else if(n.__list){n=n.__list;}else if(n.__deferred){n=undefined;}}i++;}}if(jQuery.isPlainObject(C)){n=o?O:jQuery.sap.extend(true,{},O,C);}return n;};};return U;});};if(!jQuery.sap.isDeclared('sap.ino.vc.follow.mixins.FeedsMixin')){jQuery.sap.declare('sap.ino.vc.follow.mixins.FeedsMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.Label');sap.ui.define("sap/ino/vc/follow/mixins/FeedsMixin",["sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/m/Label","sap/ino/controls/IdentityActionCard","sap/ino/vc/commons/mixins/IdentityQuickviewMixin"],function(C,J,L,I,a){"use strict";var F=function(){throw"Mixin may not be instantiated directly";};F.onOpenActor=function(e){var s=e.getSource();var m=s.getBindingInfo("text")&&s.getBindingInfo("text").parts[0].model||"data";var i=s.getBindingContext(m).getProperty("ACTOR_ID");if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(s,i);};F._createPanelIdentity=function(s,i){var S=s;var c;};F._createPanelTag=function(s,t){var S=s;var c;if(t){var p="/SearchTagsAllFull(searchToken='',ID="+t+")/";var b=this;var d=this.getModel("data");d.read(p,{async:true,success:function(){S.removeAllContent();c=b.getFragment("sap.ino.vc.tag.fragments.TagCard").clone();c.addStyleClass("sapInoFeedDetailBox");c.bindElement({path:"data>/SearchTagsAllFull(searchToken='',ID="+t+")"});S.addContent(c);},error:function(){S.removeAllContent();c=new L({text:{path:"i18n>ACTIVITIES_MSG_TAG_NON_EXISTENT"}});c.addStyleClass("sapInoFeedDetailBox");S.addContent(c);}});}else{S.removeAllContent();c=new L({text:this.getText("ACTIVITIES_MSG_TAG_NON_EXISTENT")});c.addStyleClass("sapInoFeedDetailBox");S.addContent(c);}};F._createPanelAttachment=function(s,A,b,i){var S=s;var c;var t=this;if(A){var p="/"+(b==="CAMPAIGN"?"Campaign":"Idea")+(i?"Internal":"")+"Attachment("+A+")/";var d=this.getModel("data");d.read(p,{async:true,success:function(){S.removeAllContent();c=t.getFragment("sap.ino.vc.attachment.fragments.AttachmentListItem").clone((new Date()).getTime()+"-0");c.bindElement({path:"data>"+p});S.addContent(c);},error:function(){S.removeAllContent();c=new L({text:{path:"i18n>ACTIVITIES_MSG_ATTACHMENT_NON_EXISTENT"}});c.addStyleClass("sapInoFeedDetailBox");S.addContent(c);}});}else{S.removeAllContent();c=new L({text:this.getText("ACTIVITIES_MSG_ATTACHMENT_NON_EXISTENT")});c.addStyleClass("sapInoFeedDetailBox");S.addContent(c);}};F.onOpenWall=function(e){var w=e.getSource().getBindingContext("data").getProperty("INVOLVED_ID");if(w){this.navigateToWall("wall",{id:w});}};F._onAfterRendering=function(e){var s=e.getSource();var m=s.getBindingInfo("content")&&s.getBindingInfo("content").parts[0].model||"data";var b=s.getBindingContext(m);var i=b.getProperty("INVOLVED_OBJ_TYPE_CODE");var c=b.getProperty("INVOLVED_ID");var o=b.getProperty("OBJECT_TYPE_CODE");var O=b.getProperty("OBJECT_ID");var S=s.getParent().getParent().getItems();var d=b.getProperty("FILTER_TYPE_CODE")==="BACKOFFICE";S=S[S.length-1];if(o==="TAG"){this._createPanelTag(S,O);}else if(i==="TAG"){this._createPanelTag(S,c);}if(i==="ATTACHMENT"||i==="TITLE_IMAGE"||i==="BACKGROUND_IMAGE"||i==="CAMPAIGN_LIST_IMAGE"){this._createPanelAttachment(S,c,o,d);}if(i==="EXPERT"||i==="CONTRIBUTOR"||i==="COACH"){this._createPanelIdentity(S,c);}};return F;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.aof.ApplicationObject')){jQuery.sap.declare('sap.ino.commons.models.aof.ApplicationObject');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.json.JSONListBinding');jQuery.sap.require('sap.ui.model.json.JSONPropertyBinding');jQuery.sap.require('sap.ui.model.PropertyBinding');jQuery.sap.require('sap.ui.model.BindingMode');jQuery.sap.require('sap.ui.model.type.String');jQuery.sap.require('sap.ui.model.type.Date');jQuery.sap.require('sap.ui.model.type.DateTime');jQuery.sap.require('sap.ui.model.type.Time');sap.ui.define("sap/ino/commons/models/aof/ApplicationObject",["./ApplicationObjectChange","./MetaModel","./PropertyModel","./MessageParser","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/ui/model/json/JSONListBinding","sap/ui/model/json/JSONPropertyBinding","sap/ui/model/PropertyBinding","sap/ui/model/BindingMode","sap/ino/commons/models/types/IntegerType","sap/ino/commons/models/types/FloatType","sap/ino/commons/models/types/IntBooleanType","sap/ui/model/type/String","sap/ui/model/type/Date","sap/ui/model/type/DateTime","sap/ui/model/type/Time","sap/ino/commons/models/core/ModelSynchronizer"],function(A,M,P,a,C,J,b,c,d,B,I,F,f,S,D,g,T,h){"use strict";var O={Standard:"STANDARD",Configuration:"CONFIGURATION",Stage:"STAGE",SystemConfiguration:"SYSTEM_CONFIGURATION"};var N={Root:"Root"};var j={Create:"create",Copy:"copy",Update:"update",Del:"del",Modify:"modify"};var k=J.extend("sap.ino.commons.models.aof.ApplicationObject",{constructor:function(e,i){J.apply(this,[]);this._initKey=e;this._isDeleted=false;this._continuousUse=(i&&i.continuousUse)||false;this._oSettings=i;this._oReadSourceSettings=i&&i.readSource;this._bLastBackendSyncSuppressed=false;this._oMessageParser=new a();this._oMessageParser.setProcessor(this);if(e===undefined||(jQuery.isNumeric(e)&&e<=0)){e={};}var r1;if(!e||m(e)){if(m(e)){r1=e;}f1(this,r1);h1(e,this,{actions:i&&i.actions,staticActions:i&&i.staticActions,nodes:i&&i.nodes},r1,i&&i.propertyDefaults);}else{g1(this,e);r1={};var s1=this.getApplicationObjectMetadata();r1[s1.nodes.Root.primaryKey]=e;h1(e,this,{actions:i&&i.actions,staticActions:i&&i.staticActions,nodes:i&&i.nodes},r1,i&&i.propertyDefaults);h.putApplicationObject(e,this);}}});k.ObjectType=O;k.Action=j;k.Node=N;var l=k.extend;k.extend=function(e,i){var r1=M.getApplicationObjectMetadata(i.objectName);if(!r1){l.call(this,e,i);return;}var s1=l.call(this,e,i);s1.prototype.getApplicationObject=function(){return s1;};s1.getApplicationObjectMetadata=function(){return r1;};s1.getObjectName=function(){return i.objectName;};s1.getEndpointURL=s1.prototype.getEndpointURL=function(){return M.getEndpoint(i.objectName);};s1.readData=function(v1,w1){if(s1.readSource){return s1.readSource(v1,s1.getObjectName(),s1.getApplicationObjectMetadata(),w1);}return null;};var t1=0;s1.beginAction=function(){t1++;};s1.endAction=function(){t1--;};s1.isInitiatingAction=function(){return t1===1;};s1.process=u;s1.parseResponse=w;s1.registerDirtyObject=x;var u1=t(s1);jQuery.extend(s1.prototype,u1.instanceMethods);jQuery.extend(s1,u1.staticMethods,i);return s1;};function m(e){if(!e){return false;}return e.constructor===Object;}function n(e){if(typeof e==="object"){return Object.keys(e)[0];}return e;}function v(e,i,r1,s1,t1){if(!m(e)){return;}r1(e,i,s1,t1);var u1=jQuery.extend(true,{},t1,{parentNodeName:i,parentData:e});jQuery.each(e,function(v1,w1){if(jQuery.isArray(w1)){jQuery.each(w1,function(x1,y1){v(y1,v1,r1,w1,u1);});}else{v(w1,i,r1,s1,u1);}});}function o(e,i,r1,s1,t1){if(!m(e)&&!jQuery.isArray(e)){return;}r1(jQuery.isArray(e)?e:[e],i,s1,t1);if(m(e)){var u1=jQuery.extend(true,{},t1,{parentNodeName:i,parentData:e});jQuery.each(e,function(v1,w1){if(jQuery.isArray(w1)){o(w1,v1,r1,e,u1);}});}else if(jQuery.isArray(e)){jQuery.each(e,function(v1,w1){jQuery.each(w1,function(x1,y1){if(jQuery.isArray(y1)){var u1=jQuery.extend(true,{},t1,{parentNodeName:i,parentData:e});o(y1,x1,r1,w1,u1);}});});}}function p(e,i,r1,s1){if(r1===N.Root&&i[e.nodes.Root.primaryKey]===s1){return i;}var t1;v(i,N.Root,function(u1,v1,w1){if(v1===r1&&e.nodes[v1]&&u1[e.nodes[v1].primaryKey]===s1){t1=u1;}});return t1;}function q(e,i,r1){if(r1===N.Root){return[i];}var s1;o(i,N.Root,function(t1,u1,v1){if(u1===r1){s1=t1;}});return s1;}function r(e,i){if(i===N.Root&&e){return true;}var r1=false;v(e,N.Root,function(s1,t1,u1){if(t1===i){r1=true;}});return r1;}function s(e,i,r1,s1,t1){var u1=e.getApplicationObjectMetadata();function v1(y1){var z1=jQuery.extend(true,{},y1);v(z1,N.Root,function(A1,B1){jQuery.each(A1,function(C1){var D1=u1.nodes[B1]&&u1.nodes[B1].attributes[C1];var E1=u1.nodes[C1];if(!s1&&!D1&&!E1){delete A1[C1];return;}if(!s1&&D1&&D1.readOnly&&!D1.isPrimaryKey){delete A1[C1];return;}if(!s1&&E1&&E1.readOnly){delete A1[C1];return;}if(D1){A1[C1]=m1(A1[C1],D1);}});});return z1;}if(e.determinations&&e.determinations.onNormalizeData){r1=jQuery.extend(true,{},r1);r1=e.determinations.onNormalizeData(r1,t1);i=jQuery.extend(true,{},i);i=e.determinations.onNormalizeData(i,t1);}var w1=v1(r1);var x1=v1(i);if(!s1){v(w1,N.Root,function(y1,z1){var A1=u1.nodes[z1].primaryKey;var B1=y1[A1];var i=p(u1,x1,z1,B1);if(y1[A1]<=0){return;}jQuery.each(y1,function(C1,D1){var E1=i&&i[C1];if(jQuery.sap.equal(E1,D1)&&C1!==A1){delete y1[C1];}});});}return w1;}function t(e){var i={instanceMethods:{create:E(e),copy:K(e),update:R(e),modify:V(e),del:Y(e)},staticMethods:{create:G(e),copy:L(e),update:U(e),modify:W(e),del:Z(e)}};function r1(u1){return jQuery.map(j,function(v1){return v1;}).indexOf(u1)>=0;}var s1=e.getApplicationObjectMetadata();var t1=jQuery.extend({},s1.actions||{});jQuery.each(e.prototype.actions||[],function(u1,v1){if(!s1.actions[u1]&&v1.execute&&jQuery.isFunction(v1.execute)){t1[u1]={name:u1};}});jQuery.each(t1,function(u1,v1){if(r1(u1)){return;}if(v1.isStatic===true){i.staticMethods[u1]=c1(e,v1);}else{i.instanceMethods[u1]=a1(e,v1);i.staticMethods[u1]=b1(e,v1);}var w1=u1+"Model";var x1=d1(e,v1);i.instanceMethods[w1]=x1;i.staticMethods[w1]=x1;});return i;}function u(e){var i=new jQuery.Deferred();var r1=[];if(C.isExtensionsDisabled()){r1.push("$disableExtensions=true");}if(C.isBackendTraceActive()){r1.push("$trace=true");}if(r1.length>0){e.url+="?"+r1.join("&");}var s1=jQuery.ajax(e);s1.done(function(t1,u1,v1){i.resolve(t1,u1,v1);});s1.fail(function(t1){var u1=C.validateXSRFToken(t1);if(!u1){s1=jQuery.ajax(e);s1.done(function(t1,v1,w1){i.resolve(t1,v1,w1);});s1.fail(function(t1){i.reject(w(t1));});}else{i.reject(w(t1));}});return i.promise();}function w(i){var r1={};if(!i.responseText){r1=i;}else{try{r1=JSON.parse(i.responseText);}catch(e){var s1=i.responseText;if(s1){s1=s1.replace(/<(.|\n)*?>/g," ").replace(/\s+/g," ").trim();}r1.MESSAGES=[{MESSAGE:i.status===403?"MSG_GENERIC_AUTH_ERROR":"MSG_GENERIC_ERROR",TYPE:"E",PARAMETERS:[s1]}];}}if(i.status===412){r1.concurrencyConflict=true;}r1.getHeader=jQuery.proxy(i.getResponseHeader,i);return r1;}function x(e,i){var r1=this;var s1=new Date();jQuery.each(e,function(t1,u1){var v1={object:r1,key:u1,actionName:i};A.fireChange(v1);});}function y(e,i){return function(r1){var s1=r1.getHeader("ETag");e.setConflictConcurrencyToken(s1);i.reject(r1);};}function z(e,i,r1,s1){var t1=e.getEndpointURL();var u1=e.getApplicationObjectMetadata();if(!i[u1.nodes.Root.primaryKey]){i[u1.nodes.Root.primaryKey]=-1;}r1=r1||{};return e.process({url:t1,type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(i),headers:r1,async:!s1});}function E(e){var i=e.getApplicationObjectMetadata();if(!i.actions.create){return undefined;}return function(r1){e.beginAction();var s1=(r1&&r1.suppressBackendSync)?true:false;var t1=(r1&&r1.processSync)?true:false;var u1=this;var v1=this.getChangeRequest();var w1=z(e,v1,u1.processHeaders(),t1);var x1=new jQuery.Deferred();w1.always(function(){u1._parseMessages.apply(u1,arguments);});w1.done(function(y1){if(y1.GENERATED_IDS){i1(u1,y1.GENERATED_IDS);u1._isNew=false;}e1(e,u1.getKey(),v1,u1,i.actions.create,s1);if(!s1){delete u1._oDeterminationData;}u1._bLastBackendSyncSuppressed=s1;u1._resolveAfterInitialize(x1,y1,true);});w1.fail(e.endAction,x1.reject);return x1.promise();};}function G(e){var i=e.getApplicationObjectMetadata();if(!i.actions.create){return undefined;}return function(r1){e.beginAction();var s1=z(e,r1);s1.done(function(t1){var u1;if(t1.GENERATED_IDS){u1=t1.GENERATED_IDS[r1[i.nodes.Root.primaryKey]];}e1(e,u1,r1,undefined,i.actions.create);});s1.fail(e.endAction);return s1;};}function H(e,i,r1,s1,t1){var u1=e.getEndpointURL();var v1=e.getApplicationObjectMetadata();if(!r1[v1.nodes.Root.primaryKey]){r1[v1.nodes.Root.primaryKey]=-1;}s1=s1||{};return e.process({url:u1+"/"+i+"/copy",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(r1),headers:s1,async:!t1});}function K(e){var i=e.getApplicationObjectMetadata();if(!i.actions.copy){return undefined;}return function(r1,s1){e.beginAction();var t1=this;var u1=this.getKey();if(this.isNew()){jQuery.sap.log.error("Backend copy cannot be done on new objects");return;}var v1=(s1&&s1.processSync)?true:false;var w1=jQuery.extend({},this._oSettings);var x1=(r1&&r1[i.nodes.Root.primaryKey])||-1;var y1=H(e,u1,r1,t1.processHeaders(),v1);var z1=new jQuery.Deferred();y1.done(function(A1){var B1=new e(A1.GENERATED_IDS[x1],w1);e1(e,B1.getInitKey(),r1,B1,i.actions.copy);z1.resolve(B1);});y1.fail(e.endAction,z1.reject);return z1.promise();};}function L(e){var i=e.getApplicationObjectMetadata();if(!i.actions.copy){return undefined;}return function(r1,s1){e.beginAction();var t1=H(e,r1,s1);t1.done(function(u1){e1(e,u1.GENERATED_IDS[-1],s1,undefined,i.actions.copy);});t1.fail(e.endAction);return t1;};}function Q(e,i,r1,s1,t1,u1){var v1=e.getEndpointURL();var w1=e.getApplicationObjectMetadata();if(!r1[w1.nodes.Root.primaryKey]){r1[w1.nodes.Root.primaryKey]=i;}var x1={};x1[w1.nodes.Root.primaryKey]=i;if(jQuery.sap.equal(r1,x1)){var y1=new jQuery.Deferred();y1.resolve({});return y1.promise();}t1=t1||{};if(s1){t1["If-Match"]=s1;}return e.process({url:v1+"/"+i,type:"PUT",contentType:"application/json; charset=UTF-8",data:JSON.stringify(r1),headers:t1,async:!u1});}function R(e){var i=e.getApplicationObjectMetadata();if(!i.actions.update){return undefined;}return function(r1){e.beginAction();var s1=(jQuery.isPlainObject(r1)&&r1.suppressBackendSync)?r1.suppressBackendSync:false;var t1=(jQuery.isPlainObject(r1))?r1.bIgnoreConcurrencyConflict:r1;var u1=(jQuery.isPlainObject(r1)&&r1.processSync)?r1.processSync:false;var v1=this;var w1=new jQuery.Deferred();var x1=this.getKey();var y1=this.getChangeRequest();this.applyConflictConcurrencyToken(t1);var z1=Q(e,x1,y1,v1._sConcurrencyToken,v1.processHeaders(),u1);z1.always(function(){v1._parseMessages.apply(v1,arguments);});z1.done(function(A1){if(A1.GENERATED_IDS){if(!v1._continuousUse){i1(v1,A1.GENERATED_IDS);}}e1(e,v1.getKey(),y1,v1,i.actions.update,s1);v1._bLastBackendSyncSuppressed=s1;v1._resolveAfterInitialize(w1,A1);});z1.fail(y(v1,w1),e.endAction);return w1.promise();};}function U(e){var i=e.getApplicationObjectMetadata();if(!i.actions.update){return undefined;}return function(r1,s1){e.beginAction();var t1=Q(e,r1,s1);t1.done(function(){e1(e,r1,s1,undefined,i.actions.update);});t1.fail(e.endAction);return t1;};}function V(e){var i=e.getApplicationObjectMetadata();if(!i.actions.create&&!i.actions.update){return undefined;}return function(r1){if(this.isNew()){return this.create(r1);}else{return this.update(r1);}};}function W(e){var i=e.getApplicationObjectMetadata();if(!i.actions.create&&!i.actions.update){return undefined;}return function(r1,s1){var t1;if(r1===undefined||(jQuery.isNumeric(r1)&&r1<=0)){e.beginAction();t1=z(e,s1);t1.done(function(u1){var r1;if(u1.GENERATED_IDS){r1=u1.GENERATED_IDS[s1[i.nodes.Root.primaryKey]];}e1(e,r1,s1,undefined,i.actions.create);});t1.fail(e.endAction);return t1;}else{e.beginAction(e,i.actions.update);t1=Q(e,r1,s1);t1.done(function(){e1(e,r1,s1,undefined,i.actions.update);});t1.fail(e.endAction);return t1;}};}function X(e,i,r1,s1,t1){var u1=e.getEndpointURL();s1=s1||{};if(r1){s1["If-Match"]=r1;}return e.process({url:u1+"/"+i,type:"DELETE",headers:s1,async:!t1});}function Y(e){var i=e.getApplicationObjectMetadata();if(!i.actions.del){return undefined;}return function(r1,s1){var t1=this;if(this.isNew()){var u1=new jQuery.Deferred();u1.resolve({MESSAGES:[]});return u1.promise();}e.beginAction();var v1=(s1&&s1.processSync)?true:false;var w1=new jQuery.Deferred();this._oDataInitPromise.done(function(){t1.applyConflictConcurrencyToken(r1);var x1=X(e,t1.getKey(),t1._sConcurrencyToken,t1.processHeaders(),v1);x1.always(function(){t1._parseMessages.apply(t1,arguments);});x1.done(function(){t1.revertChanges();var y1;var z1=e&&e.actionImpacts&&e.actionImpacts.del;if(z1){y1={};jQuery.each(z1,function(A1,B1){if(t1.oData.hasOwnProperty(B1.objectKey)){y1[B1.objectKey]=t1.getProperty("/"+B1.objectKey);}});if(y1==={}){y1=undefined;}}e1(e,t1.getKey(),y1,t1,i.actions.del);w1.resolve.apply(undefined,arguments);});x1.fail(y(t1,w1),e.endAction);});return w1.promise();};}function Z(e){var i=e.getApplicationObjectMetadata();if(!i.actions.del){return undefined;}return function(r1,s1){e.beginAction();var t1=X(e,r1);t1.done(function(){e1(e,r1,s1,undefined,i.actions.del);});t1.fail(e.endAction);return t1;};}function $(e,i,r1,s1,t1,u1,v1){var w1=e.getEndpointURL();var x1={url:w1+"/"+r1+"/"+i.name,type:"POST",};if(s1){x1.contentType="application/json; charset=UTF-8";x1.data=JSON.stringify(s1);}u1=u1||{};if(t1){u1["If-Match"]=t1;}x1.headers=u1;x1.async=!v1;return e.process(x1);}function _(e,i,r1,s1){e.beginAction();var t1=e.getEndpointURL();var u1={url:t1+"/"+i.name,type:"POST",};if(r1){u1.contentType="application/json; charset=UTF-8";u1.data=JSON.stringify(r1);}s1=s1||{};var v1=e.process(u1);v1.always(e.endAction);var w1;v1.done(function(){if(i.isMassAction){jQuery.each(r1.keys,function(x1,y1){w1={object:e,key:y1,actionName:i.name};A.fireChange(w1);});}else{w1={object:e,changeRequest:r1,actionName:i.name};A.fireChange(w1);}});return v1;}function a1(e,i){var r1=function(s1,t1){e.beginAction();var u1=e.getApplicationObjectMetadata();var v1=(jQuery.isPlainObject(t1)&&t1.suppressBackendSync)?t1.suppressBackendSync:false;var w1=(jQuery.isPlainObject(t1))?t1.bIgnoreConcurrencyConflict:t1;var x1=(jQuery.isPlainObject(t1)&&t1.processSync)?t1.processSync:false;var y1=this;var z1=this.getKey();var A1=new jQuery.Deferred();var B1;var C1=!!u1.actions[i.name];if(C1){y1.applyConflictConcurrencyToken(w1);B1=$(e,i,z1,s1,y1._sConcurrencyToken,y1.processHeaders(),x1);B1.fail(e.endAction,y(y1,A1));B1.done(function(G1,H1,I1){var J1=I1.getResponseHeader("ETag");y1.setConcurrencyToken(J1);});}else{var D1=this.actions[i.name].execute;B1=D1(z1,y1,s1,i,t1);if(B1&&jQuery.isFunction(B1.done)){B1.fail(e.endAction,A1.reject);}else{var E1=new jQuery.Deferred();var F1=B1;B1=E1.promise();E1.resolve(F1);}}B1.always(function(){y1._parseMessages.apply(y1,arguments);});B1.done(function(G1){z1=y1.getKey();e1(e,z1,s1,y1,i,v1||!C1);y1._bLastBackendSyncSuppressed=v1;y1._resolveAfterInitialize(A1,G1);});return A1.promise();};r1.isCustomAction=true;return r1;}function b1(e,i){return function(r1,s1){var t1;var u1=e.getApplicationObjectMetadata();e.beginAction();if(u1.actions[i.name]){var v1=e.getEndpointURL();var w1={url:v1+"/"+r1+"/"+i.name,type:"POST",};if(s1){w1.contentType="application/json; charset=UTF-8";w1.data=JSON.stringify(s1);}t1=$(e,i,r1,s1);}else{var x1=new jQuery.Deferred();var y1=e.prototype.actions[i.name].execute;var z1=y1(r1,undefined,s1,i);if(z1&&jQuery.isFunction(z1.done)){z1.done(x1.resolve);z1.fail(x1.reject);}else{x1.resolve(z1);}t1=x1.promise();}t1.done(function(){e1(e,r1,s1,undefined,i);});t1.fail(e.endAction);return t1;};}function c1(e,i){return function(r1){return _(e,i,r1);};}function d1(e,i){return function(){var r1=new J();var s1={};var t1=e.prototype.actions[i.name].initParameter;if(t1){t1.apply(undefined,[s1].concat(jQuery.makeArray(arguments)));}r1.setData(s1);return r1;};}function e1(e,i,r1,s1,t1,u1){var v1=new Date();var w1=s1&&s1._continuousUse&&t1.name!=j.Del&&!u1;if(w1&&s1._oPropertyModel){s1._oPropertyModel.sync(i);}if(w1){g1(s1,i);}if(s1&&u1){s1._oBeforeData=jQuery.extend(true,{},s1.getData());}if(e.determinations&&e.determinations.onPersist){var x1=function(e,i,z1){};e.determinations.onPersist(i,r1,s1&&s1.getData(),t1,x1,s1);}var y1={object:e,key:i,actionName:t1.name,changeRequest:r1,instance:s1};if(w1){s1.getDataInitializedPromise().done(function(z1){y1.dataUpdate=z1;if(e.isInitiatingAction()){A.fireChange(y1);}e.endAction();});s1.getDataInitializedPromise().fail(function(){if(e.isInitiatingAction()){A.fireChange(y1);}e.endAction();});}else{if(e.isInitiatingAction()){A.fireChange(y1);}e.endAction();}}function f1(e,i){function r1(x1){if(j1[x1.dataType]==="sap.ui.model.type.String"){return"";}else{return null;}}var s1=e.getApplicationObjectMetadata();var t1={};jQuery.each(s1.nodes.Root.attributes,function(x1,y1){t1[x1]=r1(y1);});jQuery.each(s1.nodes,function(x1,y1){if(y1.parentNode&&y1.parentNode===N.Root){var z1=e.readSource&&e.readSource.settings&&e.readSource.settings(e._oReadSourceSettings);if(!(z1&&z1.excludeNodes&&z1.excludeNodes.indexOf(y1.name)>-1)){t1[y1.name]=[];}}});jQuery.extend(t1,i);var u1=new jQuery.Deferred();e._oDataInitPromise=u1.promise();e._isNew=true;function v1(x1){if(x1){jQuery.extend(t1,x1);}t1[s1.nodes.Root.primaryKey]=e.getNextHandle();e.setData(t1);t1=e.getData();e._oDeterminationData=jQuery.extend(true,{},t1);u1.resolve(t1);}if(e.determinations&&e.determinations.onCreate){var w1=e.determinations.onCreate(t1,e);if(w1&&jQuery.isFunction(w1.done)){w1.done(v1);}else{v1(w1);}}else{v1({});}}function g1(e,i,r1){var s1=e.getApplicationObjectMetadata();var t1=new jQuery.Deferred();e._oDataInitPromise=t1.promise();e._isNew=false;if(e.readSource){e._lastReadDate=new Date();var u1=e.readSource(i,e.getObjectName(),s1,e._oReadSourceSettings);u1.done(function(v1,w1){var x1;if(!v1){jQuery.sap.log.error("Object "+i+" does not exist ("+e.getObjectName()+")");return;}if(r1){x1=v1;v1=e._mergeConcurrentChanges(v1);}k1(v1,e.getApplicationObject());function y1(A1){if(A1){jQuery.extend(v1,A1);}v1[s1.nodes.Root.primaryKey]=i;e.setData(v1);e._oBeforeData=jQuery.extend(true,{},x1||v1);e.setConcurrencyToken(w1);t1.resolve(v1);}if(e.determinations&&e.determinations.onRead){var z1=e.determinations.onRead(v1,e);if(z1&&jQuery.isFunction(z1.done)){z1.done(y1);}else{y1(z1);}}else{y1({});}});u1.fail(function(){jQuery.sap.log.error("Reading object "+i+" failed ("+e.getObjectName()+")");t1.reject();});}else{var v1={};v1[s1.nodes.Root.primaryKey]=i;e.setData(v1);e._oBeforeData=jQuery.extend(true,{},v1);t1.resolve(v1);}}function h1(e,i,r1,s1,t1){if(!r1.nodes&&!r1.actions&&!r1.staticActions){return;}var u1=i.getApplicationObjectMetadata();var v1={nodes:[],actions:[],staticActions:[]};if(r1.nodes){jQuery.each(r1.nodes,function(G1,H1){if(u1.nodes[H1]){v1.nodes.push(H1);}});}var w1=[];if(r1.actions){jQuery.each(r1.actions,function(G1,H1){var I1=n(H1);if(u1.actions[I1]&&I1!=j.Create){v1.actions.push(H1);}w1.push(I1);});}var x1=[];if(r1.staticActions){jQuery.each(r1.staticActions,function(G1,H1){var I1=n(H1);if(u1.actions[I1]){v1.staticActions.push(H1);}x1.push(I1);});}var y1=w1.indexOf(j.Modify);if(y1>=0){if(w1.indexOf(j.Update)<0){v1.actions.push(j.Update);}}var z1=w1.indexOf(j.Create);var A1=x1.indexOf(j.Create);if(i._isNew&&(y1>=0||z1>=0)&&A1<0){var B1={};B1[j.Create]=s1;v1.staticActions.push(B1);}var C1=new jQuery.Deferred();i._oPropertyModelInitPromise=C1.promise();function D1(G1){var F1=G1.getSource();i._oPropertyModel=F1;i.getDataInitializedPromise().done(function(){if(y1>=0){var H1;if(i._isNew){H1=F1.getProperty("/actions/create/enabled");}else{H1=F1.getProperty("/actions/update/enabled");}if(H1!==undefined){F1.setPropertyInternal("/actions/modify",{enabled:H1});}}jQuery.each((r1.actions||[]).concat(r1.staticActions||[]),function(I1,J1){var K1=n(J1);var L1=i.actions&&i.actions[K1]&&i.actions[K1].enabledCheck;if(L1){var M1="/actions/"+K1;var N1=F1.getProperty(M1+"/enabled");var O1=L1(i,N1);if(O1!==undefined){F1.setPropertyInternal(M1,{enabled:O1});}}});C1.resolve(F1.getData());});F1.fireEvent("modelModified");}var E1={actions:{modify:{enabled:false}}};jQuery.each((r1.actions||[]).concat(r1.staticActions||[]),function(G1,H1){var I1=n(H1);var J1=i.actions&&i.actions[I1]&&i.actions[I1].execute;if(J1){E1.actions[I1]={enabled:false};}});if(t1){E1=jQuery.extend(true,E1,t1);}var F1=new P(i.getObjectName(),e,v1,false,D1,E1);i._oPropertyModel=F1;}function i1(e,i){var r1=e.getApplicationObjectMetadata();var s1=e.getApplicationObject();var t1=e.getProperty("/");if(s1.determinations&&s1.determinations.onUpdateHandles){t1=s1.determinations.onUpdateHandles(t1,i);}else{v(t1,N.Root,function(t1,u1){var v1=r1.nodes[u1];if(!v1){return;}var w1=v1.primaryKey;var x1=t1[w1];if(i[x1]){t1[w1]=i[x1];h.putApplicationObject(t1[w1],e);}});}e.setData(t1);}var j1={"NVARCHAR":"sap.ui.model.type.String","NCLOB":"sap.ui.model.type.String","VARCHAR":"sap.ui.model.type.String","CHAR":"sap.ui.model.type.String","NCHAR":"sap.ui.model.type.String","INTEGER":"sap.ui.model.type.Integer","INT":"sap.ui.model.type.Integer","TINYINT":"sap.ui.model.type.Integer","SMALLINT":"sap.ui.model.type.Integer","BIGINT":"sap.ui.model.type.Integer","SMALLDECIMAL":"sap.ui.model.type.Float","DECIMAL":"sap.ui.model.type.Float","DOUBLE":"sap.ui.model.type.Float","REAL":"sap.ui.model.type.Float","FLOAT":"sap.ui.model.type.Float","DATE":"sap.ui.model.type.Date","SECONDDATE":"sap.ui.model.type.DateTime","TIMESTAMP":"sap.ui.model.type.DateTime","TIME":"sap.ui.model.type.Time"};function k1(e,i){var r1=i.getApplicationObjectMetadata();v(e,N.Root,function(s1,t1){jQuery.each(s1,function(u1){var v1=r1.nodes[t1]&&r1.nodes[t1].attributes[u1];if(v1){s1[u1]=l1(s1[u1],v1);}});});}function l1(e,i){if(e!==null){return e;}if(!i){return e;}var r1=j1[i.dataType];if(!r1){return null;}switch(r1){case"sap.ui.model.type.String":return"";default:return null;}}function m1(e,i){if(!i){return e;}var r1=j1[i.dataType];if(!r1){return e;}switch(r1){case"sap.ui.model.type.String":return(e==="")?null:e;default:return e;}}function n1(e,i){var r1=e.getPath();var s1=e.getContext();if(s1&&s1.getPath()!=="/"){r1=s1.getPath();}else{r1=(r1[0]==="/")?r1:"/"+r1;}var t1=r1.split("/");var u1=t1.shift();if(p1(u1)){return undefined;}var v1=t1.pop();var w1;if(t1.length===0){w1=N.Root;}if(t1.length===1){w1=t1.pop();}if(t1.length>1){w1=t1.pop()&&t1.pop();}jQuery.sap.log.debug(w1,"getBindingType could not retrieve node for "+r1);if(i.nodes[w1]===undefined){return undefined;}var x1=i.nodes[w1].attributes[v1];if(!x1){return undefined;}var y1=j1[x1.dataType];if(!y1){return undefined;}var z1;switch(y1){case"sap.ui.model.type.String":z1=new S(null,{minLength:(x1.required?1:undefined),maxLength:(x1.maxLength||undefined)});break;case"sap.ui.model.type.Integer":if(x1.dataType==="TINYINT"){z1=new f();}else{z1=new I({groupingEnabled:false,minFractionDigits:0,maxFractionDigits:0},{minimum:x1.minValue!=x1.maxValue?x1.minValue:undefined,maximum:x1.maxValue!=x1.minValue?x1.maxValue:undefined});}break;case"sap.ui.model.type.Float":z1=new F({groupingEnabled:false,minFractionDigits:0},{minimum:x1.minValue!=x1.maxValue?x1.minValue:undefined,maximum:x1.maxValue!=x1.minValue?x1.maxValue:undefined});break;case"sap.ui.model.type.Date":z1=new D({source:{pattern:"yyyy-MM-dd"},style:"medium"},{minimum:x1.required?"1970-01-01":undefined});break;case"sap.ui.model.type.DateTime":z1=new g({style:"medium"},{minimum:x1.required?"1970-01-01T00:00:00Z":undefined});break;case"sap.ui.model.type.Time":z1=new T({style:"medium"},{minimum:x1.required?"00:00:00":undefined});break;default:break;}return z1;}var o1={Meta:"meta",Property:"property"};function p1(e){return jQuery.map(o1,function(e){return e;}).indexOf(e)>=0;}function q1(e,i){if(i){var r1=i[0]==="/";var s1=i.split("/");if(!r1){s1.splice(0,0,"");}if(s1.length>2){var t1=s1[1];if(t1===o1.Meta){var u1=e.getObjectName();var v1=[u1].concat(s1.slice(2));var w1=(r1?"/":"")+v1.join("/");return{model:M,path:w1};}if(t1===o1.Property){var x1=(r1?"/":"")+s1.slice(2).join("/");if(!e._oPropertyModel){jQuery.sap.log.error("Scope for property binding needs to be defined when creating the object");}return{model:e._oPropertyModel,path:x1};}}}return undefined;}k.prototype.bindProperty=function(e,i,r1){var s1=q1(this,e);if(!s1||!s1.model){return J.prototype.bindProperty.apply(this,arguments);}return new c(s1.model,s1.path,i,r1);};k.prototype.bindList=function(e,i,r1,s1,t1){var u1=q1(this,e);if(!u1||!u1.model){return J.prototype.bindList.apply(this,arguments);}return new b(u1.model,u1.path,i,r1,s1,t1);};k.prototype.getProperty=function(e,i){var r1=q1(this,e);if(!r1||!r1.model){return J.prototype.getProperty.apply(this,arguments);}return r1.model.getProperty(r1.path);};k.prototype.getPropertyModel=function(){return this._oPropertyModel;};k.prototype.addBinding=function(e){J.prototype.addBinding.apply(this,arguments);if(e instanceof sap.ui.model.PropertyBinding&&e.getBindingMode()===B.TwoWay){var i=e.getType();if(i===undefined){var r1=n1(e,this.getApplicationObjectMetadata());if(r1){e.setType(r1,e.sInternalType);}}}};k.prototype.process=u;k.prototype.calculateChangeRequest=s;k.prototype.processHeaders=function(){return null;};k.prototype.parseResponse=w;k.prototype.readData=function(e){return this.getApplicationObject().readData(this.getKey(),e);};k.prototype.getLastReadDate=function(){return this._lastReadDate;};k.prototype.getKey=function(){var e=this.getData();var i=this.getApplicationObjectMetadata();var r1=e[i.nodes.Root.primaryKey];if(!r1){return this.getInitKey();}return r1;};k.prototype.getInitKey=function(){return this._initKey;};k.prototype.getApplicationObjectMetadata=function(){return this.getApplicationObject().getApplicationObjectMetadata();};k.prototype.getObjectName=function(){return this.getApplicationObject().getObjectName();};k.prototype.getDataInitializedPromise=function(){return this._oDataInitPromise;};k.prototype.getPropertyModelInitializedPromise=function(){return this._oPropertyModelInitPromise;};k.prototype.hasPendingChanges=function(){var e=this.getApplicationObjectMetadata();var i=this.getUserChanges();delete i[e.nodes.Root.primaryKey];var r1=!jQuery.sap.equal(i,{});if(r1){jQuery.sap.log.info("Pending changes: user change:"+JSON.stringify(i));}return r1;};k.prototype.getChangeRequest=function(e){return this.calculateChangeRequest(this.getApplicationObject(),this._oBeforeData||{},this.getData(),e,this);};k.prototype.getUserChanges=function(){var e={};var i=this.getApplicationObjectMetadata();var r1;if(this._oDeterminationData){r1=this.calculateChangeRequest(this.getApplicationObject(),{},this._oDeterminationData,false,this);}var s1=this.getChangeRequest();e=s1;if(r1){if(jQuery.sap.equal(r1,s1)){return{};}v(e,N.Root,function(t1,u1,v1){var w1=p(i,r1,u1,t1[i.nodes[u1].primaryKey]);if(w1){jQuery.each(t1,function(x1,y1){if(jQuery.isArray(y1)){return;}if(jQuery.sap.equal(w1[x1],y1)){delete t1[x1];}});}});o(e,N.Root,function(t1,u1,v1){if(u1!=N.Root){var w1=q(i,r1,u1);if(w1){if(t1.length==w1.length){var x1=false;jQuery.each(t1,function(y1,z1){if(!jQuery.isEmptyObject(z1)){x1=true;return false;}return true;});if(!x1){delete v1[u1];}}}}});}return e;};k.prototype._parseMessages=function(e){this._oMessageParser.parse(e);};k.prototype.getMessageParser=function(){return this._oMessageParser;};k.prototype._resolveAfterInitialize=function(e){var i=this.getDataInitializedPromise();var r1=Array.prototype.slice.call(arguments,1);if(i){i.done(function(){e.resolve.apply(e,r1);});i.fail(function(){e.resolve.apply(e,r1);});}else{e.resolve.apply(e,r1);}};k.prototype._mergeConcurrentChanges=function(e){var r1=this;var s1=this.getApplicationObjectMetadata();var t1=this.getApplicationObject();var u1=this.getUserChanges();var v1=this.getChangeRequest(true);var w1=jQuery.extend(true,{},e);var x1=r1._oBeforeData;if(t1.determinations&&t1.determinations.onNormalizeData){x1=jQuery.extend(true,{},x1);x1=t1.determinations.onNormalizeData(x1,this);}v(w1,N.Root,function(e,y1,z1){if(!s1.nodes[y1]){return;}var A1=s1.nodes[y1].primaryKey;var B1=e[A1];var C1=r(u1,y1);if(C1){var D1=p(s1,u1,y1,B1);if(D1){jQuery.each(e,function(F1,G1){if(jQuery.isArray(G1)){return;}if(D1[F1]!==undefined){e[F1]=D1[F1];}});}else{var E1=p(s1,x1,y1,B1);if(E1){for(var i=0;i<z1.length;i++){if(z1[i][A1]===B1){z1.splice(i,1);return;}}}}}});v(u1,N.Root,function(e,i,y1,z1){var A1=s1.nodes[i].primaryKey;var B1=s1.nodes[i].parentNode;var C1=B1&&s1.nodes[B1].primaryKey;var D1=p(s1,w1,i,e[A1]);if(!D1){if(Object.keys(e).length===1&&e[A1]){return;}var E1=jQuery.extend(true,{},e);var F1=p(s1,v1,i,E1[A1]);if(F1){E1=jQuery.extend(true,{},F1);}if(E1[A1]>=0){E1[A1]=r1.getNextHandle();}var G1=z1.parentData[C1];var H1=p(s1,w1,B1,G1);if(H1){H1[i]=H1[i]||[];H1[i].push(E1);}else{jQuery.sap.log.fatal("Merging may only be enabled for objects where deleting parents is impossible");}}});if(t1.determinations&&t1.determinations.onMergeConcurrentChanges){w1=t1.determinations.onMergeConcurrentChanges(w1,u1);}return w1;};k.prototype.isNew=function(){if(this._isNew===undefined){this._isNew=true;}return this._isNew;};k.prototype.isDeleted=function(){return this._isDeleted;};k.prototype.setProperty=function(e,i,r1){return J.prototype.setProperty.apply(this,arguments);};k.prototype.revertChanges=function(){if(this.isNew()){this.setData({});}else{this.setData(jQuery.extend(true,{},this._oBeforeData)||{});}};k.prototype.sync=function(){if(this._oPropertyModel){this._oPropertyModel.sync(this.getKey());}g1(this,this.getKey());};k.prototype.mergeConcurrentChanges=function(){g1(this,this.getKey(),true);};k.prototype.setConcurrencyToken=function(e){if(this._oSettings&&this._oSettings.concurrencyEnabled){this._sConcurrencyToken=e;}};k.prototype.setConflictConcurrencyToken=function(e){if(this._oSettings&&this._oSettings.concurrencyEnabled){this._sConflictConcurrencyToken=e;}};k.prototype.applyConflictConcurrencyToken=function(i){if(i){this._sConcurrencyToken=this._sConflictConcurrencyToken;}this._sConflictConcurrencyToken=undefined;};k.prototype.resolveConflictManually=function(){this.applyConflictConcurrencyToken(true);};k.prototype.updateNode=function(e,i){var r1=this.getApplicationObject().getApplicationObjectMetadata();var s1=r1.nodes[i];if(!s1){jQuery.sap.log.error(i+" in "+this.getObjectName()+" is not known");return;}v(this.getData(),"Root",function(t1,u1,v1){if(u1===i&&t1[s1.primaryKey]===e[s1.primaryKey]){t1=jQuery.extend(t1,e);}});this.checkUpdate(true);};k.prototype.addChild=function(e,i){var r1=this.getApplicationObject().getApplicationObjectMetadata();var s1=r1.nodes[i];if(!s1){jQuery.sap.log.error(i+" in "+this.getObjectName()+" is not known");return 0;}if(s1.parentNode!==N.Root){jQuery.sap.log.error("addChild only works for subnodes of Root");return 0;}var t1=this.getNextHandle();e[s1.primaryKey]=t1;var u1=this.getProperty("/"+i);if(!u1){u1=[];this.setProperty("/"+i,u1);}u1.push(e);this.checkUpdate(true);return t1;};k.prototype.removeChild=function(e){v(this.getData(),N.Root,function(i,r1,s1){if(i===e){if(!s1||!jQuery.isArray(s1)){jQuery.sap.log.error("No parent available to remove child");return;}var t1=s1.indexOf(e);if(t1>=0){s1.splice(t1,1);}else{jQuery.sap.log.error("Child not found");}}});this.checkUpdate(true);};k.prototype.getReadSourceModel=function(){return this._oReadSourceSettings?this._oReadSourceSettings.model:undefined;};k.prototype.setAfterInitChanges=function(){if(this.isNew()){this._oDeterminationData=jQuery.extend(true,{},this.getData());}else{this._oBeforeData=jQuery.extend(true,{},this.getData());}};k.prototype.getNextHandle=function(){if(!this._iNextHandle){this._iNextHandle=-1;}return this._iNextHandle--;};k.prototype.getBeforeData=function(){return this._oBeforeData;};k.setMetaModel=function(e){M=e;};k.prototype.releaseFromSyncMode=function(){h.removeApplicationObject(this.getKey(),this);};k.prototype.destroy=function(){if(this._oPropertyModel){this._oPropertyModel.destroy();}return J.prototype.destroy.apply(this,arguments);};return k;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.core.CodeModel')){jQuery.sap.declare('sap.ino.commons.models.core.CodeModel');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.BindingMode');jQuery.sap.require('sap.ui.model.json.JSONListBinding');jQuery.sap.require('sap.ui.model.odata.ODataModel');jQuery.sap.require('sap.ui.model.resource.ResourceModel');sap.ui.define("sap/ino/commons/models/core/CodeModel",["sap/ui/model/json/JSONModel","sap/ino/commons/models/aof/MetaModel","sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/commons/application/Configuration","sap/ui/model/BindingMode","sap/ui/model/json/JSONListBinding","sap/ui/model/odata/ODataModel","sap/ui/model/resource/ResourceModel"],function(J,M,A,a,C,B,b,O,R){"use strict";jQuery.sap.declare("sap.ino.commons.models.core.CodeModel");var c=A.ObjectType;sap.ino.commons.models.core.CodeModel=new J({});var d=sap.ino.commons.models.core.CodeModel;d.sDefaultBindingMode=B.OneWay;d.mSupportedBindingModes={"OneWay":true,"OneTime":true,"TwoWay":false};a.attachChange(undefined,function(E){var z=E.getParameter("object").getApplicationObjectMetadata();if(z.type===c.Stage){var F=z.name.substring(0,z.name.length-5);d.refresh(F);}});var V="sap.ino.xs.object.basis.ValueOptionList.Root_";var e="sap.ino.xs.object.basis.ValueOptionList.ValueOptions";var f="sap.ino.xs.object.basis.ValueOptionList.Root";var D="INTEGER";var g="NUMERIC";var h="BOOLEAN";var i="TEXT";var _=null;function j(){if(_===null){_=new O(C.getFullApplicationPath("sap.ino.config.URL_PATH_OD_CONFIGURATION"),true);}return _;}function k(z){return jQuery.sap.startsWith(z,V);}function l(z){var P=z.split(V,2);if(P.length===2){return P[1];}else{return null;}}function m(z,E){if(z.TEXT>E.TEXT){return 1;}if(z.TEXT<E.TEXT){return-1;}return 0;}function n(z,E){if(z.TEXT>E.TEXT){return-1;}if(z.TEXT<E.TEXT){return 1;}return 0;}function o(z){return function(E,F){if(z==="NUM_VALUE"){E[z]=parseFloat(E[z]);F[z]=parseFloat(F[z]);}if(E[z]>F[z]){return 1;}if(E[z]<F[z]){return-1;}return 0;};}function p(z){return function(E,F){if(E[z]<F[z]){return-1;}else{return 1;}};}function q(z){var E=j();var P=z;if(k(z)){var F=l(z);var G=r(e,function(N){return N.LIST_CODE===F;});var H=r(f,F);var I="";switch(H.DATATYPE_CODE){case D:case g:I="NUM_VALUE";break;case h:I="BOOL_VALUE";break;case i:I="NUM_VALUE";break;default:break;}G.sort(p("SEQUENCE_NO"));var K=jQuery.map(G,function(N){var Q=jQuery.extend({},N);switch(H.DATATYPE_CODE){case D:Q.NUM_VALUE=parseInt(Q.NUM_VALUE,10);Q.CODE=Q.NUM_VALUE;break;case g:Q.NUM_VALUE=parseFloat(Q.NUM_VALUE);Q.CODE=Q.NUM_VALUE;break;case h:Q.CODE=Q.BOOL_VALUE;break;case i:Q.CODE=Q.TEXT_VALUE;break;default:break;}return Q;});return K;}var L=[];E.read(P,null,null,false,function(N){if(N&&N.results&&N.results.length>0){jQuery.each(N.results,function(Q,S){S=jQuery.extend({},S);delete S.__metadata;S.TEXT=s(z,S.CODE);if(S.DEFAULT_TEXT&&(S.TEXT===null||!S.TEXT)){S.TEXT=S.DEFAULT_TEXT;}if(["sap.ino.xs.object.iam.IdentityLogSetting.Root"].indexOf(z)===-1){S.LONG_TEXT=t(z,S.CODE);}if(S.LONG_TEXT===null){if(S.DEFAULT_LONG_TEXT){S.LONG_TEXT=S.DEFAULT_LONG_TEXT;}else{S.LONG_TEXT=S.TEXT;}}L.push(S);});}});if(P!=="sap.ino.xs.object.basis.ValueOptionList.ValueOptions"){return L.sort(m);}else{return L.sort(p("SEQUENCE_NO"));}}function r(z,E,P){var F=d.getProperty("/"+z);var G;if(P){G=d.getProperty("/"+JSON.stringify(P)+"/"+z);}if(F===null||F===undefined){F=q(z);d.setProperty("/"+z,F);}if(P&&G){F=G;}if(P&&!G){if(P.includeEmptyCode===true){var H={CODE:"",TEXT:"",LONG_TEXT:""};G=[H].concat(F);}else{G=F;}F=G;var I=d.getProperty("/"+JSON.stringify(P))||{};I[z]=G;d.setProperty("/"+JSON.stringify(P),I);}if(E===undefined||E===""){return F;}var K=E;if(!jQuery.isFunction(K)){K=function(N){return(N.CODE===E);};}if(K&&jQuery.isFunction(K)){var L=jQuery.grep(F,K);if(!jQuery.isFunction(E)){return L[0];}else{return L;}}return F;}function s(z,E){var T;if(v(z)){T=v(z).getProperty(E);}if(T===E){return null;}else{return T;}}function t(z,E){var L=E+"_LONG";var T;if(v(z)){T=v(z).getProperty(L);}if(T===L){return null;}else{return T;}}var u={};function v(z){if(u[z]){return u[z];}var N=z.split(".");var E=N.pop();var F=N.join(".");var G=M.getApplicationObjectMetadata(F);if(!G){throw Error("Please provide valid fully qualified AOF object node reference");}var H;if(G.nodes[E].customProperties&&G.nodes[E].customProperties.codeTextBundle){H=new sap.ui.model.resource.ResourceModel({bundleUrl:w(G.nodes[E].customProperties.codeTextBundle)});}u[z]=H;return H;}function w(z){if(z.indexOf("::")>-1){var P=arguments[0].split("::");z=P[1];}return C.getResourceBundleURL(z);}function x(T,z){if(z){return function(E){return T(z,E);};}else{return function(z,E){return T(z,E);};}}function y(z,E,T){if(E===null||E===undefined){return"";}var F=r(z,E);if(!F){return E;}return F[T];}d.bindList=function(P,z,S,F,E){var G=P.substring(1,P.length);if(!z&&P!="/"){d.getCodes(G,undefined,E);}if(E){P="/"+JSON.stringify(E)+"/"+G;}var H=new b(this,P,z,S,F,E);return H;};d.getCodes=function(z,F,P){return r(z,F,P);};d.getText=function(z,E){return y(z,E,"TEXT");};d.getLongText=function(z,E){return y(z,E,"LONG_TEXT");};d.getFormatter=function(z){return x(d.getText,z);};d.getLongTextFormatter=function(z){return x(d.getLongText,z);};d.getConfigObjectNodeForValueOptionList=function(z){return V+z;};d.refresh=function(z){if(!z){d.setData({});return;}var P=[];jQuery.each(d.getData(),function(E,F){if(E.lastIndexOf(z)!=-1){P.push("/"+E);return;}if(jQuery.isPlainObject(F)){jQuery.each(F,function(G){if(G.lastIndexOf(z)!=-1){P.push("/"+E+"/"+G);}});}});jQuery.each(P,function(I,E){d.setProperty(E,null);});};return sap.ino.commons.models.core.CodeModel;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Attachment')){jQuery.sap.declare('sap.ino.commons.models.object.Attachment');jQuery.sap.require('sap.ui.unified.FileUploaderParameter');jQuery.sap.require('sap.ino.thirdparty.jimp.min');sap.ui.define("sap/ino/commons/models/object/Attachment",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource","sap/ino/commons/application/Configuration","sap/ui/unified/FileUploaderParameter","sap/ino/thirdparty/jimp.min"],function(A,R,C,F){"use strict";var a=A.extend("sap.ino.commons.models.object.Attachment",{objectName:"sap.ino.xs.object.attachment.Attachment",readSource:R.getDefaultODataSource("Attachment")});function b(u,o,s,t,S,e,c){var d=new FormData();if(Array.isArray(o)){o.map(function(f){if(s!==null&&s!==undefined){d.append("upload",f,s);}else{d.append("upload",f,s);}});}else{if(s!==null&&s!==undefined){d.append("upload",o,s);}else{d.append("upload",o);}}var h={};h.label=c;return jQuery.ajax({url:u,type:t,headers:h,success:function(r){var f=a.parseUploadResponse(r);if(jQuery.type(S)==="function"){S(f);}},error:function(r){if(jQuery.type(e)==="function"){e(r);}},data:d,cache:false,contentType:false,processData:false});}a.prepareFileUploader=function(f,c){f.removeAllHeaderParameters();var o=new F({name:"x-csrf-token",value:C.getXSRFToken()});f.addHeaderParameter(o);var d=new F({name:"unicode_filename",value:a.stringToUnicode(c[0].name)});f.addHeaderParameter(d);};a.uploadFile=function(f,s,i,c){var d=new jQuery.Deferred();var e=f.name||f.type.replace(/\//g,".");var u=i?'/'+i:'';var U=a.getEndpointURL()+u;var t=i?'PUT':'POST';var g=s&&!i?true:false;if(c){this.compressFile(f,s,g).then(function(D){b(U,D,e,t,function(r){d.resolve(r);},function(){d.reject();});}).catch(function(){d.reject();});}else{b(U,f,e,t,function(r){d.resolve(r);},function(){d.reject();});}return d.promise();};a.uploadFileIncludeFileLabel=function(f,s,S,i,c){var d=new jQuery.Deferred();var e=f.name||f.type.replace(/\//g,".");var u=i?'/'+i:'';var U=a.getEndpointURL()+u;var t=i?'PUT':'POST';var g=S&&!i?true:false;if(c){this.compressFile(f,S,g).then(function(D){b(U,D,e,t,function(r){d.resolve(r);},function(){d.reject();},s);}).catch(function(){d.reject();});}else{b(U,f,e,t,function(r){d.resolve(r);},function(){d.reject();},s);}return d.promise();};function _(B,q){return new Promise(function(r){if(!q){r(B);}else{try{if(B.type.startsWith('image')&&Jimp){var c=new FileReader();c.onload=function(){var f=c.result;Jimp.read(f).then(function(i){var d=i;d=d.quality(q);d.getBufferAsync(B.type).then(function(g){var n=new Blob([g],{type:B.type});n.name=B.name;if(n.size>B.size){r(B);}else{r(n);}});});};c.readAsArrayBuffer(B);}else{r(B);}}catch(e){r(B);}}});}a.compressFile=function(f,s,u){var p=[];if(u&&s){p.push(_(s));}p.push(_(f,20));p.push(_(f,80));return Promise.all(p);};a.parseUploadResponse=function(r){var c=r.match(new RegExp("^<html.*<body>.*((?:[0-9]*...))\]:(.*)</body></html>"));if(c&&c.length===3&&!isNaN(parseInt(c[1],10))){var s=parseInt(c[1],10);try{var o=JSON.parse(c[2]);var d=JSON.parse(c[2]);return{success:s<300,attachmentId:d.GENERATED_IDS&&d.GENERATED_IDS[-1]||null,fileName:d.FILE_NAME,mediaType:d.MEDIA_TYPE,messages:d.MESSAGES};}catch(e){return null;}}else{return null;}};a.stringToUnicode=function(s){return s.replace(/[\s\S]/g,function(e){return"\\u"+("0000"+e.charCodeAt().toString(16)).slice(-4);});};a.unicodeToString=function(s){return s.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,function(m){return String.fromCharCode(parseInt(m.replace(/\\u/g,""),16));});};return a;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Blog')){jQuery.sap.declare('sap.ino.commons.models.object.Blog');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');sap.ui.define("sap/ino/commons/models/object/Blog",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource","sap/ui/core/message/Message","sap/ui/core/MessageType","sap/ino/commons/application/Configuration","sap/ino/controls/BlogStatusType"],function(A,R,M,a,C,B){"use strict";var b=A.extend("sap.ino.commons.models.object.Blog",{objectName:"sap.ino.xs.object.blog.Blog",readSource:R.getDefaultODataSource("CampaignBlogsFull",{excludeNodes:["Relations"]}),invalidation:{entitySets:["CampaignBlogsFull"]},actionImpacts:{},determinations:{onCreate:_},actions:{submit:{execute:k},majorPublishSubmit:{execute:l},publishSubmit:{execute:m},unPublishSubmit:{execute:j}},setData:c,setProperty:d,addTag:g,addAttachment:h,removeAttachment:i});function _(D,o){var t=jQuery.map(D.Tags||[],function(T){return{ID:o.getNextHandle(),NAME:T};});var p=C.getCurrentUser();return{"TITLE":D.TITLE||"","DESCRIPTION":D.DESCRIPTION||"","CREATED_AT":new Date(),"CREATED_BY_NAME":p.NAME,"STATUS_CODE":B.Draft,"OBJECT_TYPE_CODE":"CAMPAIGN","OBJECT_ID":D.OBJECT_ID||0,"Tags":t};}function c(D){A.prototype.setData.apply(this,arguments);if(D.OBJECT_ID>0){this.setProperty("/OBJECT_ID",D.OBJECT_ID);}}function d(p,v,o,q){var s=false;s=A.prototype.setProperty.apply(this,arguments);e.call(this,p,v,o,q);return s;}function e(p,v,o,q){var P=(p[0]==="/"?p.substring(1):p);if(P!=="OBJECT_ID"){return;}var D=this.getReadSourceModel();var r=this;var s=v;if(s===""||s==="0"){s=0;A.prototype.setProperty.apply(r,[p,s,o,q]);return;}if(s===0){f.call(r,{NAME:"",SHORT_NAME:"",COLOR_CODE:"",PHASE_COUNT:4,IDEA_DESCRIPTION_TEMPLATE:""});return;}D.read("/CampaignSmall("+s+")",{success:function(t){f.call(r,t);}});}function f(o){this.setProperty("/CAMPAIGN_NAME",o.NAME);this.setProperty("/CAMPAIGN_SHORT_NAME",o.SHORT_NAME);this.setProperty("/CAMPAIGN_COLOR",o.COLOR_CODE);this.setProperty("/STEPS",o.PHASE_COUNT);this.setProperty("/CAMPAIGN_BACKGROUND_IMAGE_ID",o.CAMPAIGN_BACKGROUND_IMAGE_ID);this.setProperty("/CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID",o.CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID);this.setProperty("/CAMPAIGN_VOTE_TYPE_CODE",o.VOTE_TYPE_CODE);}function g(N){var o;var t=this.getProperty("/Tags");if(!N.NAME||jQuery.trim(N.NAME).length===0){o=new M({key:"MSG_INVALID_EMPTY_TAG",type:a.Error,group:"TAG"});return o;}N.NAME=jQuery.trim(N.NAME);if(!N.TAG_ID&&N.NAME){N.TAG_ID=this.getNextHandle();}var p=jQuery.grep(t,function(T){return T.NAME.toLowerCase()===N.NAME.toLowerCase();});if(p.length===0){this.addChild(N,"Tags");}else{return new M({key:"MSG_DUPLICATE_TAG",type:a.Error});}}function h(N){N.ROLE_TYPE_CODE="ATTACHMENT";this.addChild(N,"Attachments");}function i(I){var o=jQuery.grep(this.getProperty("/Attachments")||[],function(p){return p.ATTACHMENT_ID===I;});var F=o&&o[0];if(F){this.removeChild(F);}}function j(K,o,p,q,s){var D=new jQuery.Deferred();var u=o.unPublish(s);u.fail(D.reject);u.done(D.resolve);return D.promise();}function k(K,o,p,q,s){return n.call(this,K,o,p,q,s);}function l(K,o,p,q,s){return n.call(this,K,o,p,q,s,"majorPublish");}function m(K,o,p,q,s){return n.call(this,K,o,p,q,s,"publish");}function n(K,o,p,q,s,r){var D=new jQuery.Deferred();var t=o.modify(s);t.fail(D.reject);if(!r){t.done(D.resolve);}else{t.done(function(){var S=o[r](p,s);S.fail(D.reject);S.done(D.resolve);});}return D.promise();}return b;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.BlogComment')){jQuery.sap.declare('sap.ino.commons.models.object.BlogComment');sap.ui.define("sap/ino/commons/models/object/BlogComment",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend("sap.ino.commons.models.object.BlogComment",{objectName:"sap.ino.xs.object.blog.Comment",readSource:R.getDefaultAOFSource(),invalidation:{entitySets:["BlogComment"]},actionImpacts:{"del":[{"objectName":"sap.ino.commons.models.object.Blog","objectKey":"OBJECT_ID","impactedAttributes":["COMMENT_COUNT"]}],"create":[{"objectName":"sap.ino.commons.models.object.Blog","objectKey":"OBJECT_ID","impactedAttributes":["COMMENT_COUNT"]}]}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Campaign')){jQuery.sap.declare('sap.ino.commons.models.object.Campaign');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.format.DateFormat');sap.ui.define("sap/ino/commons/models/object/Campaign",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/models/core/ReadSource","sap/ino/commons/models/core/Extensibility","sap/ino/commons/application/Configuration","sap/ui/core/message/Message","sap/ui/core/MessageType","sap/ui/core/format/DateFormat","sap/ino/commons/models/core/CodeModel"],function(A,P,R,E,C,M,c,D,d){"use strict";var S={Draft:"sap.ino.config.CAMP_DRAFT",Published:"sap.ino.config.CAMP_PUBLISHED"};var f=A.extend("sap.ino.commons.models.object.Campaign",{objectName:"sap.ino.xs.object.campaign.Campaign",readSource:R.getDefaultODataSource("CampaignFull"),invalidation:{entitySets:["CampaignFull","CampaignSmall","CampaignSmallIdeaAssign","CampaignCount","CampaignSearch","CampaignSearchParams","CampaignEntityCount","MyCampaignFollow"]},determinations:{onCreate:function(o,a){var t=D.setBeginOfDay(new Date());var O=new Date();O.setFullYear(O.getFullYear()+1);sap.ui.ino.models.util.Date.setEndOfDay(O);var v=d.getCodes("sap.ino.xs.object.campaign.VoteType.Root");var V;if(v&&v.length>0){V=v[0].CODE;}var i={VALID_FROM:t,VALID_TO:O,SUBMIT_FROM:t,SUBMIT_TO:O,IS_BLACK_BOX:0,STATUS_CODE:S.Draft,COLOR_CODE:"FFFFFF",VOTE_TYPE_CODE:V,LanguageTexts:[],Managers:[],Experts:[],Coaches:[],Participants:[],LanguagePages:[],Attachments:[]};_(i,a);E.initExtensionNode(i,"Extension",a);return i;},onRead:function(o,e){_(o,e);o.LanguagePages.sort(function(a,b){return a.PAGE_NO-b.PAGE_NO;});o.Phases.sort(function(a,b){return a.SEQUENCE_NO-b.SEQUENCE_NO;});E.initExtensionNode(o,"Extension",e);return o;},onPersist:function(o,a){P.invalidateCachedProperties("sap.ino.xs.object.iam.Group");},onNormalizeData:function(o){jQuery.each(o.LanguagePages||[],function(i,p){p.PAGE_NO=i;});jQuery.each(o.Phases||[],function(i,p){p.SEQUENCE_NO=i;});return o;},onMergeConcurrentChanges:function(m,u){jQuery.each(u.LanguageTexts||[],function(I,t){if(t.ID<0){var l=t.LANG;var a=t.ID;var b=jQuery.grep(m.LanguageTexts||[],function(t,I){return t.LANG===l&&t.ID!==a;});if(b.length===1){t.ID=b[0].ID;jQuery.extend(b[0],t);for(var i=0;m.LanguageTexts;i++){if(m.LanguageTexts[i].ID===a){m.LanguageTexts.splice(i,1);return;}}}}});return m;}},actions:{publish:{enabledCheck:function(o,e){if(e===undefined){return o.getProperty("/property/actions/create/enabled");}else{var u=o.getProperty("/property/actions/update/enabled");var s=o.getProperty("/property/actions/submit/enabled");return u&&s&&e;}},execute:function(k,o,p,a,s){var b=(o.getProperty("/STATUS_CODE")==S.Draft);var e=new jQuery.Deferred();var m=o.modify(s);m.fail(e.reject);if(b){m.done(function(){var g=o.submit(s);g.fail(e.reject);g.done(e.resolve);});}else{m.done(e.resolve);}return e.promise();}},save:{enabledCheck:function(o){if(o.getProperty("/ID")<0){return o.getProperty("/property/actions/create/enabled");}else{var u=o.getProperty("/property/actions/update/enabled");var b=(o.getProperty("/STATUS_CODE")==S.Draft);return u&&b;}},execute:function(k,o,p,a,s){return o.modify(s);}}},setProperty:function(p,v){if(p==="/SUBMIT_TO"||p==="/VALID_TO"){sap.ui.ino.models.util.Date.setEndOfDay(v);}return A.prototype.setProperty.apply(this,arguments);},setCampaignImage:function(o){this._setImage(o,"CAMPAIGN_DETAIL_IMG","/CAMPAIGN_IMAGE_ASSIGN_ID","/CAMPAIGN_IMAGE_ID");},setCampaignBackgroundImage:function(o){this._setImage(o,"BACKGROUND_IMG","/CAMPAIGN_BACKGROUND_IMAGE_ASSIGN_ID","/CAMPAIGN_BACKGROUND_IMAGE_ID");},setCampaignMobileSmallBackgroundImage:function(o){this._setImage(o,"SMALL_BACKGROUND_IMG","/CAMPAIGN_SMALL_BACKGROUND_IMAGE_ASSIGN_ID","/CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID");},setCampaignListImage:function(o){this._setImage(o,"CAMPAIGN_LIST_IMG","/CAMPAIGN_LIST_IMAGE_ASSIGN_ID","/CAMPAIGN_LIST_IMAGE_ID");},_setImage:function(o,r,a,s){var p="/Attachments";o.ROLE_TYPE_CODE=r;var b=this.getProperty(p);b=b?b:[];var i=0;var e=0;jQuery.each(b,function(k,g){if(g.ATTACHMENT_ID==o.ATTACHMENT_ID){i=g.ID;jQuery.each(b,function(k,g){if(g.ROLE_TYPE_CODE===r){g.ROLE_TYPE_CODE="ATTACHMENT";e=g.ATTACHMENT_ID;}});g.ROLE_TYPE_CODE=o.ROLE_TYPE_CODE;return false;}return true;});if(i===0){i=this.getNextHandle();o.ID=i;jQuery.each(b,function(k,g){if(g.ROLE_TYPE_CODE===r){g.ROLE_TYPE_CODE="ATTACHMENT";e=g.ATTACHMENT_ID;}});b.push(o);}else{b=jQuery.grep(b,function(g,I){if(g.ATTACHMENT_ID!==e){return true;}return false;});}this.setProperty(a,i);this.setProperty(s,o.ATTACHMENT_ID);this.setProperty(p,b);},clearCampaignImage:function(a){this._clearImage(a,"/CAMPAIGN_IMAGE_ASSIGN_ID","/CAMPAIGN_IMAGE_ID");},clearCampaignBackgroundImage:function(a){this._clearImage(a,"/CAMPAIGN_BACKGROUND_IMAGE_ASSIGN_ID","/CAMPAIGN_BACKGROUND_IMAGE_ID");},clearCampaignMobileSmallBackgroundImage:function(a){this._clearImage(a,"/CAMPAIGN_SMALL_BACKGROUND_IMAGE_ASSIGN_ID","/CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID");},clearCampaignListImage:function(a){this._clearImage(a,"/CAMPAIGN_LIST_IMAGE_ASSIGN_ID","/CAMPAIGN_LIST_IMAGE_ID");},_clearImage:function(a,s,b){this.setProperty(s,null);this.setProperty(b,null);var p="/Attachments";var e=this.getProperty(p);e=jQuery.grep(e,function(o,i){if(o.ID!==a){return true;}return false;});this.setProperty(p,e);},addAttachment:function(n){n.ROLE_TYPE_CODE="ATTACHMENT";this.addChild(n,"Attachments");},removeAttachment:function(i){var a=jQuery.grep(this.getProperty("/Attachments"),function(o){return o.ID===i;});var o=a&&a[0];if(o){if(o.ROLE_TYPE_CODE==="CAMPAIGN_DETAIL_IMG"){this.setProperty("/CAMPAIGN_IMAGE_ASSIGN_ID",null);this.setProperty("/CAMPAIGN_IMAGE_ID",null);}else if(o.ROLE_TYPE_CODE==="BACKGROUND_IMG"){this.setProperty("/CAMPAIGN_BACKGROUND_IMAGE_ASSIGN_ID",null);this.setProperty("/CAMPAIGN_BACKGROUND_IMAGE_ID",null);}else if(o.ROLE_TYPE_CODE==="SMALL_BACKGROUND_IMG"){this.setProperty("/CAMPAIGN_SMALL_BACKGROUND_IMAGE_ASSIGN_ID",null);this.setProperty("/CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID",null);}else if(o.ROLE_TYPE_CODE==="CAMPAIGN_LIST_IMG"){this.setProperty("/CAMPAIGN_LIST_IMAGE_ASSIGN_ID",null);this.setProperty("/CAMPAIGN_LIST_IMAGE_ID",null);}this.removeChild(o);}},addTag:function(n){var m;var t=this.getProperty("/Tags");if(!n.NAME||jQuery.trim(n.NAME).length===0){m=new sap.ui.ino.application.Message({key:"MSG_INVALID_EMPTY_TAG",level:sap.ui.core.MessageType.Error,group:"TAG"});return m;}n.NAME=jQuery.trim(n.NAME);if(!n.TAG_ID&&n.NAME){n.TAG_ID=this.getNextHandle();}var a=jQuery.grep(t,function(T){return T.TAG_ID===n.TAG_ID;});if(a.length===0){this.addChild(n,"Tags");}},validateHTML:function(I){var m=[];jQuery.each(this.getData().LanguagePages,function(i,l){if(I&&l.ID!=I){return;}var a=d.getCodes("sap.ino.xs.object.basis.Language.Root",function(L){return L.ISO_CODE==l.LANG;});var o={"TYPE":"E","MESSAGE":"MSG_CAMPAIGN_INVALID_HTML","REF_ID":l.ID,"REF_NODE":"LanguagePages","REF_FIELD":"HTML_CONTENT","PARAMETERS":[l.TITLE,"{code>sap.ino.xs.object.basis.Language.Root:"+a[0].CODE+"}"]};try{var r=new jQuery(l.HTML_CONTENT);if(!r||r.length===0){m.push(o);}}catch(e){m.push(o);}});return m;},determinePageCreate:function(l){return{ID:this.getNextHandle(),PAGE_NO:0,HTML_CONTENT:"<p></p>",TITLE:"",IS_VISIBLE:1,LANG:l};},determinePhaseCreate:function(){var p=this.getProperty("/Phases");var s=0;for(var i=0;i<p.length;++i){s=p[i].SEQUENCE_NO>=s?p[i].SEQUENCE_NO+1:s;}var a=d.getCodes("sap.ino.xs.object.campaign.Phase.Root");var b="";var e=true;for(var j=0;j<a.length;++j){b=a[j].CODE;e=true;for(var k=0;k<p.length;++k){if(b===p[k].PHASE_CODE){e=false;break;}}if(e){break;}}var g=d.getCodes("sap.ino.xs.object.status.Model.Root");var h=(g&&g.length>0)?g[0].CODE:"";return{PHASE_CODE:b,STATUS_MODEL_CODE:h,EVALUATION_MODEL_CODE:"",VOTING_ACTIVE:1,SHOW_IDEA_IN_COMMUNITY:1,IDEA_CONTENT_EDITABLE:1,SEQUENCE_NO:s,AUTO_EVAL_PUB_CODE:""};},setData:function(o){A.prototype.setData.apply(this,arguments);var e=sap.ui.getCore().getEventBus();e.publish("sap.ui.ino.models.object.Campaign","language_update",{});}});function _(o,a){var e=o.LanguageTexts;var b=d.getCodes("sap.ino.xs.object.basis.Language.Root",function(l){var F=jQuery.grep(e,function(L){return L.LANG==l.ISO_CODE;});return F.length===0;});var i=jQuery.map(b,function(l){return{LANG:l.ISO_CODE,ID:a.getNextHandle(),NAME:"",SHORT_NAME:"",DESCRIPTION:"",IDEA_DESCRIPTION_TEMPLATE:""};});o.LanguageTexts=o.LanguageTexts.concat(i);return o;}f.Status=S;return f;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.CampaignComment')){jQuery.sap.declare('sap.ino.commons.models.object.CampaignComment');sap.ui.define("sap/ino/commons/models/object/CampaignComment",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend("sap.ino.commons.models.object.CampaignComment",{objectName:"sap.ino.xs.object.campaign.Comment",readSource:R.getDefaultAOFSource(),invalidation:{entitySets:["CampaignComment"]},actionImpacts:{"del":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"OBJECT_ID","impactedAttributes":["COMMENT_COUNT"]}],"create":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"OBJECT_ID","impactedAttributes":["COMMENT_COUNT"]}]}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.CampaignFollow')){jQuery.sap.declare('sap.ino.commons.models.object.CampaignFollow');sap.ui.define("sap/ino/commons/models/object/CampaignFollow",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend('sap.ino.commons.models.object.CampaignFollow',{objectName:"sap.ino.xs.object.follow.Follow",readSource:R.getDefaultAOFSource(),actionImpacts:{"create":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"OBJECT_ID","impactedAttributes":["FOLLOW"]}],"del":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"OBJECT_ID","impactedAttributes":["FOLLOW"]}]},follow:function(o,t,v){return!v?this.modify(v,{OBJECT_ID:o,OBJECT_TYPE_CODE:t}):this.del(v,{OBJECT_ID:o,OBJECT_TYPE_CODE:t});}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Evaluation')){jQuery.sap.declare('sap.ino.commons.models.object.Evaluation');jQuery.sap.require('sap.ui.model.type.Float');jQuery.sap.require('sap.ui.model.type.Integer');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.model.ParseException');sap.ui.define("sap/ino/commons/models/object/Evaluation",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/CodeModel","sap/ino/commons/application/Configuration","sap/ui/model/type/Float","sap/ui/model/type/Integer","sap/ui/core/message/Message","sap/ui/core/MessageType","sap/ui/model/ParseException","sap/ino/commons/models/core/ReadSource"],function(ApplicationObject,CodeModel,Configuration,Float,Integer,Message,MessageType,ParseException,ReadSource){"use strict";var Status={Draft:"sap.ino.config.EVAL_DRAFT"};var Evaluation=ApplicationObject.extend("sap.ino.commons.models.object.Evaluation",{objectName:"sap.ino.xs.object.evaluation.Evaluation",readSource:ReadSource.getDefaultODataSource("IdeaEvaluation",{excludeNodes:["Owner"]}),invalidation:{entitySets:["IdeaEvaluation","IdeaMyEvaluation","IdeaPublishedEvaluation","EvaluationRequestItems"]},actionImpacts:{"del":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["EVALUATION_COUNT"]}],"create":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["EVALUATION_COUNT"]}],"modifyAndSubmit":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["EVALUATION_COUNT"]},{"objectName":"sap.ino.commons.models.object.EvaluationRequestItem","objectKey":"EVAL_REQ_ITEM_ID","impactedAttributes":["STATUS_CODE"]}],"executeStatusTransition":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["EVALUATION_COUNT"]}]},determinations:{onCreate:function(d,o){var i=d.IDEA_ID;var D=jQuery.Deferred();var t=D.promise();if(i>0){var m=o.getReadSourceModel();var c=[];var T=new jQuery.Deferred();m.read("/IdeaFull("+i+")/EvaluationTemplate",{success:function(e){T.resolve({"oEvaluation":e});},error:function(e){T.reject(e);}});c.push(T);var C=new jQuery.Deferred();m.read("/IdeaFull("+i+")/EvaluationTemplate/CriterionValues",{success:function(e){C.resolve({"oEvaluationCriterionValues":e});},error:function(e){C.reject(e);}});c.push(C);jQuery.when.apply(jQuery,c).done(function(){var e,E;jQuery.each(arguments,function(a,b){if(b.hasOwnProperty("oEvaluation")){e=b.oEvaluation;}else if(b.hasOwnProperty("oEvaluationCriterionValues")){E=b.oEvaluationCriterionValues;}});e.CriterionValues=E.results;e=ReadSource.cleanData(e);h(e);D.resolve(e);});}else{h(d);D.resolve(d);}var h=function(e){var s=new Date();if(e){e.EVALUATOR_NAME=Configuration.getCurrentUser()&&Configuration.getCurrentUser().NAME;e.CREATED_AT=s;e.CHANGED_AT=s;if(e.CriterionValues){jQuery.each(e.CriterionValues,function(I,v){if(!v.NUM_VALUE&&v.NUM_VALUE_MIN!==null){v.NUM_VALUE=v.NUM_VALUE_MIN;}if(v.NUM_VALUE===null){v.NUM_VALUE=0;}v.NUM_VALUE=parseFloat(v.NUM_VALUE);if(v.AGGREGATION_TYPE==="MATRIX"){v.NUM_VALUE=1;}v.ID=o.getNextHandle();});}else{e.CriterionValues=[];}}var f=e.CriterionValues;if(d&&d.aggregationData){if(f){for(var g in d.aggregationData){var j=_getCriterionByCode(f,g);if(j&&(j.DATATYPE_CODE==="INTEGER"||j.DATATYPE_CODE==="NUMERIC")){j.NUM_VALUE=d.aggregationData[g];}else if(j&&j.DATATYPE_CODE==="BOOLEAN"){j.BOOL_VALUE=d.aggregationData[g];}}}}if(d&&d.totalData){if(f){for(var g in d.totalData){var j=_getCriterionByCode(f,g);if(j&&(j.DATATYPE_CODE==="INTEGER"||j.DATATYPE_CODE==="NUMERIC")){j.NUM_VALUE=d.totalData[g].value;}else if(j&&j.DATATYPE_CODE==="BOOLEAN"){j.BOOL_VALUE=d.totalData[g].value;}else if(j&&j.DATATYPE_CODE==="TEXT"){j.TEXT_VALUE=d.totalData[g].value;}j.MSG=d.totalData[g].msg;j.MSG_TOOLTIP=d.totalData[g].msg_tooltip;j.COMMENT=d.totalData[g].comment;}}}e.CriterionValues.sort(function(a,b){return a.SEQUENCE_NO-b.SEQUENCE_NO;});if(f){_updateCompleteCalculations(f);}_buildCriteriaHierarchy(e);};if(d.averEval){jQuery.each(d.EvalAttachments,function(a,e){e.ID=o.getNextHandle();});}return t;},onRead:function(d,o){if(d&&d.CriterionValues){d.CriterionValues.sort(function(a,b){return a.SEQUENCE_NO-b.SEQUENCE_NO;});_buildCriteriaHierarchy(d);}},onPersist:function(k,c,i,a,r,o){},onNormalizeData:function(e){var c=e.CriterionValues;if(c){jQuery.each(e.CriterionValues,function(i,v){v.NUM_VALUE=parseFloat(v.NUM_VALUE);if(v.DATATYPE_CODE==="TEXT"){v.NUM_VALUE=null;}});}return e;}},actions:{modifyAndSubmit:{enabledCheck:function(o,e){var s=o.getProperty("/STATUS_CODE");return s===Status.Draft;},execute:function(k,o,p,a){var d=new jQuery.Deferred();var m=o.modify();m.fail(d.reject);m.done(function(){var s=o.submit();s.fail(d.reject);s.done(d.resolve);});return d.promise();}},del:{enabledCheck:function(i,e){if(e===undefined){return false;}}},executeStatusTransition:{initParameter:function(p,s){p.STATUS_ACTION_CODE=s;}}},setProperty:setProperty,updateDeltaCalculation:updateDeltaCalculation,addBinding:addBinding,addAttachment:_addAttachment,removeAttachment:_removeAttachment});Evaluation.Status=Status;var aNumValuePaths=["NUM_VALUE","criterion/NUM_VALUE"];function addBinding(b){ApplicationObject.prototype.addBinding.apply(this,arguments);var p=b&&b.sPath;var c=b.getContext();if(p&&aNumValuePaths&&aNumValuePaths.indexOf(p)>-1&&c){var o;if(p==="NUM_VALUE"){o=c.getObject();}else if(p==="criterion/NUM_VALUE"){o=c.getObject().criterion;}if(o){switch(o.DATATYPE_CODE){case"INTEGER":b.setType(new Integer(),b.sInternalType);break;case"NUMERIC":b.setType(new Float(),b.sInternalType);break;}}}}function setProperty(sPath,vValue,oContext){var MIN_INT=Number.MIN_SAFE_INTEGER||-9007199254740991;var MAX_INT=Number.MAX_SAFE_INTEGER||9007199254740991;var bSuccess=false;var oObject=oContext&&oContext.getObject();if(!oContext&&sPath.indexOf("/")===0){oObject=this.getData();sPath=sPath.substr(1);}if(sPath.indexOf("NUM_VALUE")>-1&&(vValue>MAX_INT||vValue<MIN_INT)){var oMsg=sap.ui.getCore().getModel(sap.ui.ino.application.ApplicationBase.MODEL_MSG);throw new ParseException(oMsg.getResourceBundle().getText("MSG_NUMERIC_INTERVAL",[vValue,MIN_INT,MAX_INT]));}if(oObject&&sPath){if(oObject&&sPath&&oObject.hasOwnProperty(sPath)){if(oObject.VALUE_OPTION_LIST_CODE){if(sPath==="COMMENT"){oObject[sPath]=vValue;}if(oObject.DATATYPE_CODE==="INTEGER"&&sPath.indexOf("NUM_VALUE")>-1){oObject[sPath]=vValue;}else if(oObject.DATATYPE_CODE==="NUMERIC"&&sPath.indexOf("NUM_VALUE")>-1){oObject[sPath]=vValue;}else if(oObject.DATATYPE_CODE==="TEXT"&&sPath.indexOf("TEXT_VALUE")>-1){oObject[sPath]=vValue;}else if(oObject.DATATYPE_CODE==="BOOLEAN"&&sPath.indexOf("BOOL_VALUE")>-1){oObject[sPath]=vValue;}}else{oObject[sPath]=vValue;}}else if(sPath.indexOf("criterion")>-1){var sPropertyName=sPath.replace("criterion/","");var oCriterion=oObject.criterion;if(oCriterion.hasOwnProperty(sPropertyName)){if(oCriterion.VALUE_OPTION_LIST_CODE){if(sPropertyName==="COMMENT"){oCriterion[sPropertyName]=vValue;bSuccess=true;}if(oCriterion.DATATYPE_CODE==="INTEGER"&&sPath.indexOf("NUM_VALUE")>-1){oCriterion[sPropertyName]=vValue;bSuccess=true;}else if(oCriterion.DATATYPE_CODE==="NUMERIC"&&sPath.indexOf("NUM_VALUE")>-1){oCriterion[sPropertyName]=vValue;bSuccess=true;}else if(oCriterion.DATATYPE_CODE==="TEXT"&&sPath.indexOf("TEXT_VALUE")>-1){oCriterion[sPropertyName]=vValue;bSuccess=true;}else if(oCriterion.DATATYPE_CODE==="BOOLEAN"&&sPath.indexOf("BOOL_VALUE")>-1){oCriterion[sPropertyName]=vValue;bSuccess=true;}}else{oCriterion[sPropertyName]=vValue;bSuccess=true;}}}}var aCriterionValue=this.getData().CriterionValues;if(arguments.length>=3){if(oContext&&(sPath.indexOf("NUM_VALUE")>-1||sPath.indexOf("BOOL_VALUE")>-1)){this.updateDeltaCalculation(aCriterionValue,oContext,sPath);}}else if(arguments.length===2){if(sPath==="/CriterionValues"){_updateCompleteCalculations(aCriterionValue);}}var oData=oContext&&oContext.getModel()&&oContext.getModel().getData();if(oData){var aRootCriteria=oContext.getModel().getData().CriterionValues;var aOverallResult=jQuery.grep(aRootCriteria,function(c,I){return c.IS_OVERALL_RESULT;});var aCriterionValues=oData.CriterionValues;var sCriterionValues=_getNumCriterion(aCriterionValues);var aCalcFormula=oData.MODEL_CALC_FORMULA;var aEnableFormula=oData.MODEL_ENABLE_FORMULA;if(aEnableFormula){for(var i=0;i<sCriterionValues.length;i++){var sCriterionValue=sCriterionValues[i];if(sCriterionValue.DATATYPE_CODE==="NUMERIC"||sCriterionValue.DATATYPE_CODE==="INTEGER"){var sCriterionCode=sCriterionValue.CRITERION_CODE.split('.');sCriterionCode=sCriterionCode.slice(sCriterionCode.length-1).toString();var sCriterionNumValue=sCriterionValue.NUM_VALUE||0;sCriterionNumValue=(!sCriterionValue.AGGREGATION_TYPE&&sCriterionValue.WEIGHT!==null&&sCriterionValue.WEIGHT!==undefined)?sCriterionNumValue*sCriterionValue.WEIGHT*0.01:sCriterionNumValue;aCalcFormula=aCalcFormula.replace(new RegExp("\\$"+sCriterionCode+"(?=[\\/+\\-*\\s,)(]|$)",'g'),sCriterionNumValue);}else{aCalcFormula=aCalcFormula.replace(new RegExp("\\$"+sCriterionCode+"(?=[\\/+\\-*\\s,)(]|$)",'g'),0);}}oData.OV_RES_NUM_VALUE=eval(aCalcFormula);oData.OV_RES_DATATYPE_CODE="NUMERIC";}else if(aOverallResult&&aOverallResult[0]){switch(oData.OV_RES_DATATYPE_CODE){case"INTEGER":oData.OV_RES_NUM_VALUE=aOverallResult[0].NUM_VALUE;break;case"NUMERIC":oData.OV_RES_NUM_VALUE=aOverallResult[0].NUM_VALUE;break;case"BOOLEAN":oData.OV_RES_BOOL_VALUE=aOverallResult[0].BOOL_VALUE;break;case"TEXT":oData.OV_RES_TEXT_VALUE=aOverallResult[0].TEXT_VALUE;break;}}}this.checkUpdate(false,false);return bSuccess;}function updateDeltaCalculation(c,C,a){var p=C.getPath();if(p.indexOf("/CriterionValues/")===0||p.indexOf("/criteriaHierarchy/")===0){var b=false;if(_calcParentAggregation(c,a,this.getProperty("PARENT_CRITERION_CODE",C))){b=true;}if(_calcMatrixAggregation(c)){b=true;}if(b){this.getData().CriterionValues=c;}}}function _updateCompleteCalculations(c){for(var i=0;i<c.length;i++){var C=c[i];if(!C.PARENT_CRITERION_CODE){var d=C.DATATYPE_CODE;if(d==="INTEGER"||d==="NUMERIC"){_calcParentAggregation(c,"NUM_VALUE",C.CODE);}else if(d==="BOOLEAN"){_calcParentAggregation(c,"BOOL_VALUE",C.CODE);}}}_calcMatrixAggregation(c);}function _calcMatrixAggregation(c){var m=_getCriterionByAggregationTypeMatrix(c);if(m.length<=0){return;}for(var i=0;i<m.length;i++){var M=m[i];if(!M.X_AXIS_SEGMENT_NO||!M.X_AXIS_SEGMENT_NO){return;}var d=M.DATATYPE_CODE;if(d!=="INTEGER"&&d!=="NUMERIC"){return;}var x=_getCriterionByCode(c,M.X_AXIS_CRITERION_CODE);var y=_getCriterionByCode(c,M.Y_AXIS_CRITERION_CODE);if(!x||!y){return;}if(x.NUM_VALUE_MIN===null||x.NUM_VALUE_MAX===null||y.NUM_VALUE_MIN===null||y.NUM_VALUE_MAX===null){return;}if(x.NUM_VALUE<x.NUM_VALUE_MIN||x.NUM_VALUE>x.NUM_VALUE_MAX){return;}if(y.NUM_VALUE<y.NUM_VALUE_MIN||y.NUM_VALUE>y.NUM_VALUE_MAX){return;}var a=Math.floor((x.NUM_VALUE-x.NUM_VALUE_MIN)/((x.NUM_VALUE_MAX-x.NUM_VALUE_MIN)/M.X_AXIS_SEGMENT_NO))+1;a=a>M.X_AXIS_SEGMENT_NO?M.X_AXIS_SEGMENT_NO:a;var b=Math.floor((y.NUM_VALUE-y.NUM_VALUE_MIN)/((y.NUM_VALUE_MAX-y.NUM_VALUE_MIN)/M.Y_AXIS_SEGMENT_NO))+1;b=b>M.Y_AXIS_SEGMENT_NO?M.Y_AXIS_SEGMENT_NO:b;M.NUM_VALUE=a+(b-1)*M.X_AXIS_SEGMENT_NO;}return true;}function _calcParentAggregation(c,a,p){if(a!=="NUM_VALUE"&&a!=="BOOL_VALUE"){return;}var C=false;if(p){var P=_getCriterionByCode(c,p);if(!P){return;}var b=_getCriterionsByParentCode(c,p);var d=P.DATATYPE_CODE;var A=P.AGGREGATION_TYPE;if(d==="INTEGER"||d==="NUMERIC"){if(A==="SUM"||A==="AVG"){C=_aggregate(b,P,a);}else if(A==="FORMULA"){C=_getFormulaValue(c,P,a);}}else if(d==="BOOLEAN"){if(A==="AND"||A==="OR"){var e=true;var o=false;jQuery.each(b,function(i,f){if(f.DATATYPE_CODE===d){e=e&&f[a]&&f[a]===1;if(f[a]){o=o||f[a]===1;}}});if(A==="AND"){P[a]=e?1:0;}else if(A==="OR"){P[a]=o?1:0;}C=true;}if(A==="AVG"){C=_aggregate(b,P,a);}}if(P.PARENT_CRITERION_CODE){if(_calcParentAggregation(c,a,P.PARENT_CRITERION_CODE)){return true;}}}return C;}function _aggregate(c,p,a){var d=p.DATATYPE_CODE;var A=p.AGGREGATION_TYPE;if((d==="BOOL_VALUE"||a==="BOOL_VALUE")&&d!==a){return;}var s=0;var f=0;jQuery.each(c,function(i,C){if(((C.DATATYPE_CODE==="INTEGER"||C.DATATYPE_CODE==="NUMERIC")&&a==="NUM_VALUE")||(C.DATATYPE_CODE==="BOOLEAN"&&a==="BOOL_VALUE")){if(C[a]){if(C.WEIGHT===undefined||C.WEIGHT===null){s+=C[a];}else{s+=C[a]*C.WEIGHT*0.01;}}f++;}});if(A==="SUM"){if(d==="BOOLEAN"){p[a]=Math.max(s,1);}else if(d==="INTEGER"){if(p.WEIGHT===undefined||p.WEIGHT===null){p[a]=Math.round(s);}else{p[a]=Math.round(s*p.WEIGHT*0.01);}}else{if(p.WEIGHT===undefined||p.WEIGHT===null){p[a]=s;}else{p[a]=s*p.WEIGHT*0.01;}}}else if(A==="AVG"){p[a]=s/f;if(d==="BOOLEAN"){p[a]=Math.round(p[a]);}else if(d==="INTEGER"){p[a]=(p.WEIGHT===undefined||p.WEIGHT===null)?Math.round(p[a]):Math.round(p[a]*p.WEIGHT*0.01);}else{p[a]=(p.WEIGHT===undefined||p.WEIGHT===null)?p[a]:p[a]*p.WEIGHT*0.01;}}return true;}function _getFormulaValue(a,p,A){var d=p.DATATYPE_CODE;if((d==="BOOL_VALUE"||A==="BOOL_VALUE")&&d!==A){return false;}function g(c){if(!c){return"";}if(c.lastIndexOf(".")>-1){return c.substr(c.lastIndexOf(".")+1);}return c;}var v=a,f=p.FORMULA,r=f.match(/\$([^+\-*\/\s\)\(,]+)/gm),n=void 0;for(var i=0;i<v.length;i++){for(var j=0;j<r.length;j++){if(r[j]==="$"+g(v[i].CODE)){n=v[i][A];if(!v[i].AGGREGATION_TYPE&&(v[i].DATATYPE_CODE==="NUMERIC"||v[i].DATATYPE_CODE==="INTEGER")){var w=v[i].WEIGHT;if(!w){w=100;}n*=(Number(w)||100)/100;}f=f.replace(r[j],n);}}}try{var P=p.WEIGHT;if(!P){P=100;}var R=Math.round(Number(window.eval(f))*Number(P))/100;if(d==="INTEGER"){R=Math.round(R);}p[A]=R;}catch(e){p[A]=0;}return true;}function _getCriterionByCode(c,C){return jQuery.map(c,function(o){if(o.CODE===C){return o;}})[0];}function _getCriterionsByParentCode(c,p){return jQuery.map(c,function(C){if(C.PARENT_CRITERION_CODE===p){return C;}});}function _getRootCriteria(c){return jQuery.map(c,function(C){if(C.PARENT_CRITERION_CODE===null||C.PARENT_CRITERION_CODE===""){return C;}});}function _getNumCriterion(c){return jQuery.map(c,function(C){if(C.DATATYPE_CODE==="NUMERIC"||C.DATATYPE_CODE==="INTEGER"){return C;}});}function _getCriterionByAggregationTypeMatrix(c,C){return jQuery.map(c,function(o){if(o.AGGREGATION_TYPE==="MATRIX"){return o;}});}function _calculateOVResult(oDefaultData){var oOverallResultCriterion=oDefaultData&&oDefaultData.criteriaHierarchy&&oDefaultData.criteriaHierarchy.overallResultCriterion;var aCriterionValues=oDefaultData.CriterionValues;var sCriterionValues=_getNumCriterion(aCriterionValues);var aCalcFormula=oDefaultData.MODEL_CALC_FORMULA;var aEnableFormula=oDefaultData.MODEL_ENABLE_FORMULA;if(aEnableFormula){for(var i=0;i<sCriterionValues.length;i++){var sCriterionValue=sCriterionValues[i];if(sCriterionValue.DATATYPE_CODE==="NUMERIC"||sCriterionValue.DATATYPE_CODE==="INTEGER"){var sCriterionCode=sCriterionValue.CRITERION_CODE.split('.');sCriterionCode=sCriterionCode.slice(sCriterionCode.length-1).toString();var sCriterionNumValue=sCriterionValue.NUM_VALUE||0;if(isNaN(sCriterionNumValue)){sCriterionNumValue=0;}sCriterionNumValue=(!sCriterionValue.AGGREGATION_TYPE&&sCriterionValue.WEIGHT!==null&&sCriterionValue.WEIGHT!==undefined)?sCriterionNumValue*sCriterionValue.WEIGHT*0.01:sCriterionNumValue;aCalcFormula=aCalcFormula.replace(new RegExp("\\$"+sCriterionCode+"(?=[\\/+\\-*\\s,)(]|$)",'g'),sCriterionNumValue);}else{aCalcFormula=aCalcFormula.replace(new RegExp("\\$"+sCriterionCode+"(?=[\\/+\\-*\\s,)(]|$)",'g'),0);}}oDefaultData.OV_RES_NUM_VALUE=eval(aCalcFormula);oDefaultData.OV_RES_DATATYPE_CODE="NUMERIC";}else if(oOverallResultCriterion){oDefaultData.OV_RES_NUM_VALUE=oOverallResultCriterion.NUM_VALUE;oDefaultData.OV_RES_BOOL_VALUE=oOverallResultCriterion.BOOL_VALUE;oDefaultData.OV_RES_DATATYPE_CODE=oOverallResultCriterion.DATATYPE_CODE;oDefaultData.OV_RES_VALUE_OPTION_LIST_CODE=oOverallResultCriterion.VALUE_OPTION_LIST_CODE;oDefaultData.OV_RES_UOM_CODE=oOverallResultCriterion.UOM_CODE;}}function _buildCriteriaHierarchy(d){var h={};var c=d.CriterionValues;var r=_getRootCriteria(c);var o=jQuery.grep(r,function(C,i){return C.IS_OVERALL_RESULT;});h.overallResultCriterion=o[0];var a=jQuery.grep(r,function(C,i){return C.IS_OVERALL_RESULT===0;});h.aggregatingCriteria=[];if(o&&o.length>0&&o[0].AGGREGATION_TYPE!=="MATRIX"){h.aggregatingCriteria.push({criterion:h.overallResultCriterion,children:_getCriterionsByParentCode(c,h.overallResultCriterion.CRITERION_CODE)});}if(a&&a.length>0){jQuery.each(a,function(i,C){h.aggregatingCriteria.push({criterion:C,children:_getCriterionsByParentCode(c,C.CRITERION_CODE)});});}jQuery.each(c,function(i,C){if(C.VALUE_OPTION_LIST_CODE){var s="sap.ino.xs.object.basis.ValueOptionList.Root_"+C.VALUE_OPTION_LIST_CODE;C.valueOptionList=CodeModel.getCodes(s,function(b){return b.ACTIVE===1;});}if(C.NUM_VALUE){C.NUM_VALUE=Math.round(C.NUM_VALUE*100)/100;}});d.criteriaHierarchy=h;if(d.OV_RES_DATATYPE_CODE||d.MODEL_ENABLE_FORMULA){_calculateOVResult(d);}}function _addAttachment(n){n.ROLE_TYPE_CODE="ATTACHMENT";this.addChild(n,"EvalAttachments");}function _removeAttachment(i){var a=jQuery.grep(this.getProperty("/EvalAttachments")||[],function(A){return A.ID===i;});var f=a&&a[0];if(f){this.removeChild(f);}}Evaluation.createAverageEvaluation=function(i,e,s,E,c){var a={};var A={};var o={};var f=function(j,V){var k=a[j.CRITERION_CODE];if(!k){k=0;}k+=parseFloat(j[V])||0;a[j.CRITERION_CODE]=k;var l=A[j.CRITERION_CODE];if(!l){l=0;}l++;A[j.CRITERION_CODE]=l;var m=o[j.CRITERION_CODE];if(!m){m=j.DATATYPE_CODE;o[j.CRITERION_CODE]=m;}};jQuery.each(e,function(I,j){jQuery.each(j,function(k,l){if(l.DATATYPE_CODE==="INTEGER"||l.DATATYPE_CODE==="NUMERIC"){f(l,"NUM_VALUE");}else if(l.DATATYPE_CODE==="BOOLEAN"){f(l,"BOOL_VALUE");}});});for(var C in a){var v=a[C];var b=A[C];var d=o[C];v=v/b;if(d==="INTEGER"||d==="BOOLEAN"){v=Math.round(v);}else if(d==="NUMERIC"){v=Math.round(v*100)/100;}a[C]=v;}var g=[];jQuery.each(E,function(j,k){g=g.concat(k);});var h=new Evaluation({IDEA_ID:i,aggregationData:a,averEval:true,COMMENT:c,EvalAttachments:g},s);return h;};Evaluation.createTotalEvaluation=function(i,e,s,E,c,n,f){var t={};var a={};var A=function(j,v){t[j.CRITERION_CODE]=t[j.CRITERION_CODE]||{comment:""};var k=t[j.CRITERION_CODE].value;if(!k){k=0;}k+=parseFloat(j[v])||0;t[j.CRITERION_CODE].value=k;t[j.CRITERION_CODE].maxVal=parseFloat(j.NUM_VALUE_MAX)||0;t[j.CRITERION_CODE].minVal=parseFloat(j.NUM_VALUE_MIN)||-9007199254740991;var l=a[j.CRITERION_CODE];if(!l){l=j.DATATYPE_CODE;a[j.CRITERION_CODE]=l;}};jQuery.each(e,function(I,j){jQuery.each(j,function(k,l){t[l.CRITERION_CODE]=t[l.CRITERION_CODE]||{comment:""};if(l.DATATYPE_CODE==="INTEGER"||l.DATATYPE_CODE==="NUMERIC"){A(l,"NUM_VALUE");}else if(l.DATATYPE_CODE==="BOOLEAN"){if(t[l.CRITERION_CODE].value===undefined||t[l.CRITERION_CODE].value===null){t[l.CRITERION_CODE].value=l.BOOL_VALUE;}}else if(l.DATATYPE_CODE==="TEXT"){if(!t[l.CRITERION_CODE].value||t[l.CRITERION_CODE].value.trim().length===0){t[l.CRITERION_CODE].value=l.TEXT_VALUE;}}t[l.CRITERION_CODE].comment+=" "+(l.COMMENT||"");});});for(var C in t){var d=a[C];if(t[C].hasOwnProperty("maxVal")){var b=t[C].maxVal;if(b&&t[C].value>b){var m=f([t[C].value,b],1);t[C].msg=m.msg;t[C].msg_tooltip=m.msg_tooltip;t[C].value=b;}}if(t[C].hasOwnProperty("minVal")){var g=t[C].minVal;if(g&&t[C].value<g){var M=f([t[C].value,g],2);t[C].msg=M.msg;t[C].msg_tooltip=M.msg_tooltip;t[C].value=g;}}if(d==="INTEGER"){t[C].value=Math.round(t[C].value);}else if(d==="NUMERIC"){t[C].value=Math.round(t[C].value*100)/100;}}var h=[];jQuery.each(E,function(j,k){h=h.concat(k);});var o=new Evaluation({IDEA_ID:i,totalData:t,averEval:true,EvalAttachments:h,COMMENT:c},s);return o;};return Evaluation;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.EvaluationRequest')){jQuery.sap.declare('sap.ino.commons.models.object.EvaluationRequest');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');sap.ui.define("sap/ino/commons/models/object/EvaluationRequest",["sap/ino/commons/models/aof/ApplicationObject","sap/ui/core/message/Message","sap/ui/core/MessageType","sap/ino/commons/models/core/ReadSource","sap/ino/commons/util/DateUtil"],function(A,M,a,R,D){"use strict";var E=A.extend("sap.ino.commons.models.object.EvaluationRequest",{objectName:"sap.ino.xs.object.evaluation.EvaluationRequest",readSource:R.getDefaultODataSource("EvaluationRequest",{}),invalidation:{},determinations:{onCreate:_,onRead:d},actionImpacts:{"create":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["EvaluationRequests","IDEA_HAS_INCOMPLETED_EVAL_REQ"]}],"del":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["EvaluationRequests","IDEA_HAS_INCOMPLETED_EVAL_REQ"]}]},addExpert:e,removeExpert:r,onNormalizeData:function(o){o.ACCEPT_DATE=D.convertToUtcString(o.ACCEPT_DATE);o.COMPLETE_DATE=D.convertToUtcString(o.COMPLETE_DATE);return o;}});function _(){var g=new Date();g.setDate(g.getDate()+1);var C=new Date();C.setDate(C.getDate()+7);return{"STATUS":"sap.ino.config.EVAL_REQ_DEFAULT"};}function f(g){var h={"Data":g[0],"Index":0};jQuery.each(g,function(i,j){if(h.Data.CREATED_AT>j.CREATED_AT){h.Data=j;h.Index=i;}});return h;}function b(g){return["ITEM_ID_"+g.EVAL_REQ_ITEM_ID+"_CREATED_BY_ID_"+g.CREATED_BY_ID+"_TO_IDENTITY_"+g.TO_IDENTITY,"ITEM_ID_"+g.EVAL_REQ_ITEM_ID+"_CREATED_BY_ID_"+g.TO_IDENTITY+"_TO_IDENTITY_"+g.CREATED_BY_ID];}function c(o){var g=[];if(!o||o.length===0){return g;}var G={};jQuery.each(o,function(i,h){var k=b(h);if(G.hasOwnProperty(k[0])){G[k[0]].push(h);}else if(G.hasOwnProperty(k[1])){G[k[1]].push(h);}else{G[k[0]]=[];G[k[0]].push(h);}});jQuery.each(G,function(i,h){var F=f(h);h.splice(F.Index,1);g.push({"CLARIFICATION_ENABLED":F.Data.CLARIFICATION_ENABLED,"CREATED_BY_ID":F.Data.CREATED_BY_ID,"EVAL_REQ_ITEM_ID":F.Data.EVAL_REQ_ITEM_ID,"TO_IDENTITY":F.Data.TO_IDENTITY,"CREATED_BY_NAME":F.Data.CREATED_BY_NAME,"CREATED_BY_IMAGE_ID":F.Data.CREATED_BY_IMAGE_ID,"CONTENT":F.Data.CONTENT,"CREATED_AT":F.Data.CREATED_AT,"Communications":h});});return g;}function d(o){var g=o;if(!(g.ACCEPT_DATE instanceof Date)){g.ACCEPT_DATE=new Date(o.ACCEPT_DATE);}else{g.ACCEPT_DATE=D.convertToLocalDate(o.ACCEPT_DATE);}if(!(g.COMPLETE_DATE instanceof Date)){g.COMPLETE_DATE=new Date(o.COMPLETE_DATE);}else{g.COMPLETE_DATE=D.convertToLocalDate(o.COMPLETE_DATE);}if(g.Clarifications){g.ExpertsClarifications=c(g.Clarifications);}return g;}function e(n){var m;if(!n.NAME||jQuery.trim(n.NAME).length===0){m=new M({key:"MSG_IDEA_INVALID_EMPTY_EXPERT",type:a.Error,group:"EXPERT"});return m;}if(!n.IDENTITY_ID){m=new M({key:"MSG_IDEA_INVALID_EXPERT",type:a.Error,group:"EXPERT"});return m;}var g=this.getProperty("/Experts");var h=jQuery.grep(g,function(o){return o.IDENTITY_ID===n.IDENTITY_ID;});if(h.length===0){this.addChild(n,"Experts");}}function r(i){var g=this.getProperty("/Experts");var m=jQuery.grep(g,function(h){return h.IDENTITY_ID===i;});var o=m[0];if(o){this.removeChild(o,"Experts");}}return E;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.EvaluationRequestComment')){jQuery.sap.declare('sap.ino.commons.models.object.EvaluationRequestComment');sap.ui.define("sap/ino/commons/models/object/EvaluationRequestComment",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend("sap.ino.commons.models.object.EvaluationRequestComment",{objectName:"sap.ino.xs.object.evaluation.EvalReqComment",readSource:R.getDefaultAOFSource(),invalidation:{entitySets:["EvaluationRequestComment"]},actionImpacts:{"del":[{"objectName":"sap.ino.commons.models.object.EvaluationRequest","objectKey":"OBJECT_ID","impactedAttributes":["COMMENT_COUNT"]}],"create":[{"objectName":"sap.ino.commons.models.object.EvaluationRequest","objectKey":"OBJECT_ID","impactedAttributes":["COMMENT_COUNT"]}]}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.EvaluationRequestItem')){jQuery.sap.declare('sap.ino.commons.models.object.EvaluationRequestItem');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.model.ParseException');sap.ui.define("sap/ino/commons/models/object/EvaluationRequestItem",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/application/Configuration","sap/ui/core/message/Message","sap/ui/core/MessageType","sap/ui/model/ParseException","sap/ino/commons/models/core/ReadSource"],function(A,C,M,a,P,R){"use strict";var E=A.extend("sap.ino.commons.models.object.EvaluationRequestItem",{objectName:"sap.ino.xs.object.evaluation.EvaluationRequestItem",readSource:R.getDefaultODataSource("EvaluationRequestItem",{}),invalidation:{entitySets:[]},actions:{executeStatusTransition:{}},determinations:{onRead:b}});function f(d){var r={"Data":d[0],"Index":0};jQuery.each(d,function(i,e){if(r.Data.CREATED_AT>e.CREATED_AT){r.Data=e;r.Index=i;}});return r;}function _(d){return"ITEM_ID_"+d.EVAL_REQ_ITEM_ID+"_CREATED_BY_ID_"+(d.CREATED_BY_ID^d.TO_IDENTITY);}function c(e){var r=[];if(!e||e.length===0){return r;}var g={};jQuery.each(e,function(i,d){var k=_(d);if(!g.hasOwnProperty(k)){g[k]=[];}g[k].push(d);});jQuery.each(g,function(i,d){var F=f(d);d.splice(F.Index,1);r.push({"CLARIFICATION_ENABLED":F.Data.CLARIFICATION_ENABLED,"CREATED_BY_ID":F.Data.CREATED_BY_ID,"EVAL_REQ_ITEM_ID":F.Data.EVAL_REQ_ITEM_ID,"CREATED_BY_NAME":F.Data.CREATED_BY_NAME,"CREATED_BY_IMAGE_ID":F.Data.CREATED_BY_IMAGE_ID,"CONTENT":F.Data.CONTENT,"CREATED_AT":F.Data.CREATED_AT,"Communications":d});});return r;}function b(d){var e=d;if(e.Clarifications){e.ExpertsClarifications=c(e.Clarifications);e.InitRefObjectId=e.EVAL_REQ_ID;}return e;}return E;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Group')){jQuery.sap.declare('sap.ino.commons.models.object.Group');sap.ui.define("sap/ino/commons/models/object/Group",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend('sap.ino.commons.models.object.Group',{objectName:"sap.ino.xs.object.iam.Group",readSource:R.getDefaultAOFSource(),createMember:function(g){return this.massCreateMember(g);}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Homepagewidget')){jQuery.sap.declare('sap.ino.commons.models.object.Homepagewidget');sap.ui.define("sap/ino/commons/models/object/Homepagewidget",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend('sap.ino.commons.models.object.Homepagewidget',{objectName:"sap.ino.xs.object.homepagewidget.Homepagewidget",readSource:R.getDefaultAOFSource()});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Idea')){jQuery.sap.declare('sap.ino.commons.models.object.Idea');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.format.DateFormat');sap.ui.define("sap/ino/commons/models/object/Idea",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/models/core/ReadSource","sap/ino/commons/models/core/Extensibility","sap/ino/commons/application/Configuration","sap/ui/core/message/Message","sap/ui/core/MessageType","sap/ui/core/format/DateFormat","sap/ino/controls/IdeaAttachmentRoleType","sap/ino/controls/IdeaStatusType","sap/ino/controls/IdeaStatusActionType","sap/ino/commons/models/core/CodeModel"],function(A,P,R,E,C,M,a,D,I,b,c,d){"use strict";var e=A.extend("sap.ino.commons.models.object.Idea",{objectName:"sap.ino.xs.object.idea.Idea",readSource:R.getDefaultODataSource("IdeaFull",{excludeNodes:["Relations"],includeNodes:["Evaluations"]}),invalidation:{entitySets:["IdeaFull","IdeaMedium","IdeaMediumCommunity","IdeaSmall","IdeaMediumSearch","IdeaMediumBackofficeSearch","CampaignEntityCount","MyIdeaMediumCommunity","MyIdeaFollow"]},actionImpacts:{"create":[{"entitySetName":"EntityCount","entitySetKey":"1","impactedAttributes":["AUTHORED_IDEA_COUNT"]}],"modifyAndSubmit":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["UNASSIGNED_IDEAS_COUNT"]}],"assignCoach":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["UNASSIGNED_IDEAS_COUNT"]}],"modifyAndAutoAssignCoach":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["UNASSIGNED_IDEAS_COUNT"]}],"autoAssignCoach":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["UNASSIGNED_IDEAS_COUNT"]}],"unassignCoach":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["UNASSIGNED_IDEAS_COUNT"]}],"del":[{"entitySetName":"EntityCount","entitySetKey":"1","impactedAttributes":["AUTHORED_IDEA_COUNT"]}]},determinations:{onCreate:h,onRead:j},actions:{executeStatusTransition:{initParameter:k},modifyAndSubmit:{enabledCheck:function(Q){var S=Q.getProperty("/STATUS_CODE");return S===b.Draft;},execute:function(Q,S,T,U,V){var W=new jQuery.Deferred();var X=S.modify(V);X.fail(W.reject);X.done(function(){var Y=S.submit(T,V);Y.fail(W.reject);Y.done(function(){T.VOTE_TYPE_TYPE_CODE=S.getProperty("/VOTE_TYPE_TYPE_CODE");T.MAX_STAR_NO=S.getProperty("/MAX_STAR_NO");if(S.getProperty("/VOTING_ACTIVE")&&S.getProperty("/AUTO_VOTE")){var Z=S.autoVote(T,V);Z.fail(W.reject);Z.done(W.resolve);}else{W.resolve();}});});return W.promise();}},del:{enabledCheck:function(Q,S){if(S===undefined){return false;}}},modifyAndAutoAssignCoach:{execute:function(Q,S,T,U,V){var W=new jQuery.Deferred();var X=S.modify(V);X.fail(W.reject);if(S.getData().COACH_ID===T.DEFAULT_COACH){X.done(W.resolve);}else{X.done(function(){var Y=S.autoAssignCoach(T,V);Y.fail(W.reject);Y.done(W.resolve);});}return W.promise();}}},setProperty:s,setData:f,addWall:l,removeWall:r,addInternalWall:m,removeInternalWall:n,addContributor:o,addTag:t,modifyLink:u,addLink:v,addAttachment:x,addInternalAttachment:y,removeAttachment:z,setTitleImage:G,clearTitleImage:H,hasInitialDescription:J,isSubmitted:K,createWall:O,delVotesSimulate:N});e.isPhaseChange=function(S){return S===c.nextPhase||S===c.prevPhase;};e.isFinalStatus=function(S){return S===b.Discontinued||S===b.Completed||S===b.Merged;};function s(Q,V,S,T){var U=false;U=A.prototype.setProperty.apply(this,arguments);var W=(Q[0]==="/"?Q.substring(1):Q);if(W==="CAMPAIGN_ID"){var X=this.getReadSourceModel();var Y=this;var Z=V;if(Z===""||Z==="0"){Z=0;A.prototype.setProperty.apply(this,[Q,Z,S,T]);}var $=function(a1){Y.setProperty("/CAMPAIGN_NAME",a1.NAME);Y.setProperty("/CAMPAIGN_SHORT_NAME",a1.SHORT_NAME);Y.setProperty("/CAMPAIGN_COLOR",a1.COLOR_CODE);Y.setProperty("/STEPS",a1.PHASE_COUNT);Y.setProperty("/CAMPAIGN_BACKGROUND_IMAGE_ID",a1.CAMPAIGN_BACKGROUND_IMAGE_ID);Y.setProperty("/CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID",a1.CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID);Y.setProperty("/CAMPAIGN_VOTE_TYPE_CODE",a1.VOTE_TYPE_CODE);Y.setProperty("/RESP_NAME",a1.RESP_NAME);Y.setProperty("/RESP_CODE",a1.RESP_CODE);Y.setProperty("/RESP_DESCRIPTION",a1.RESP_DESCRIPTION);Y.setProperty("/RESP_LIST_VISIBLE",false);Y.setProperty("/REWARD_ACTIVE",a1.REWARD_ACTIVE);Y.setProperty("/AUTO_ASSIGN_RL_COACH",a1.IS_AUTO_ASSIGN_RL_COACH);Y.setProperty("/OPEN_ANONYMOUS_FOR_IDEA",a1.IS_OPEN_ANONYMOUS_FUNCTION);if(a1.RESP_CODE){Y.setProperty("/RESP_LIST_VISIBLE",true);}if(Y.hasInitialDescription(a1.IDEA_DESCRIPTION_TEMPLATE)){Y.setProperty("/IDEA_DESCRIPTION_TEMPLATE",a1.IDEA_DESCRIPTION_TEMPLATE||"");Y.setProperty("/DESCRIPTION",a1.IDEA_DESCRIPTION_TEMPLATE||"");}};if(Z===0){$({NAME:"",SHORT_NAME:"",COLOR_CODE:"",PHASE_COUNT:4,IDEA_DESCRIPTION_TEMPLATE:""});}else{X.read("/CampaignSmall("+Z+")",{success:function(a1){$(a1);}});}}return U;}function f(Q){A.prototype.setData.apply(this,arguments);if(Q.CAMPAIGN_ID>0){this.setProperty("/CAMPAIGN_ID",Q.CAMPAIGN_ID);}}function i(Q){Q.Walls=jQuery.extend(true,[],Q.Walls||[]);Q.InternalWalls=jQuery.extend(true,[],Q.InternalWalls||[]);var W=Q.Walls.concat(Q.InternalWalls);if(W&&W.length>0){var S=[];jQuery.each(W,function(U,V){S.push(V.WALL_ID);});jQuery.sap.require("sap.ino.commons.models.object.Wall");var T=sap.ino.commons.models.object.Wall;T.readWalls(S,false).done(function(U){jQuery.each(W,function(V,X){jQuery.each(U,function(V,Y){if(X.WALL_ID===Y.ID){X.NAME=Y.NAME;X.BACKGROUND_IMAGE_URL=Y.BACKGROUND_IMAGE_URL;X.BACKGROUND_IMAGE_ZOOM=Y.BACKGROUND_IMAGE_ZOOM;X.BACKGROUND_IMAGE_REPEAT=Y.BACKGROUND_IMAGE_REPEAT;X.BACKGROUND_COLOR=Y.BACKGROUND_COLOR;X.BackgroundImage=Y.BackgroundImage||[];X.CREATED_BY_NAME=Y.CREATED_BY_NAME;X.Items=[];jQuery.each(Y.Items||[],function(V,Z){if(Z.WALL_ID===X.WALL_ID){X.Items.push(Z);}});}});});});}return Q;}function g(Q){var S=Q.ContributionShare;jQuery.each(Q.SubmitterContributorsCoach,function(T,U){if(U.ROLE_CODE==="IDEA_SUBMITTER"||U.ROLE_CODE==="IDEA_CONTRIBUTOR"){var V=S.filter(function(W){return W.AUTHOR_ID===U.IDENTITY_ID;});if(V.length>0){U.iContributionShare=V[0].PERCENTAGE;}}});}function h(Q,S){var T=jQuery.map(Q.Tags||[],function(W){return{ID:S.getNextHandle(),NAME:W};});var U=C.getCurrentUser();var V={"NAME":Q.NAME||"","DESCRIPTION":Q.DESCRIPTION||"","STATUS_CODE":b.Draft,"CREATED_AT":new Date(),"CREATED_BY_NAME":U.NAME,"STEP":-1,"STEPS":4,"CAMPAIGN_NAME":null,"CAMPAIGN_ID":Q.CAMPAIGN_ID||0,"Tags":T,"Walls":Q.Walls&&Q.Walls.length>0?Q.Walls:[]};V=i(V);return E.initExtensionNode(V,"Extension",S);}function _(Q){jQuery.each(Q.FieldsValue,function(S,T){if(T.VALUE_OPTION_LIST_CODE){var U="sap.ino.xs.object.basis.ValueOptionList.Root_"+T.VALUE_OPTION_LIST_CODE;T.valueOptionList=d.getCodes(U,function(V){return V.ACTIVE===1;});}});}function j(Q,S){Q=i(Q);Q.SubmitterContributorsCoach=(Q.Submitter||[]).concat(Q.Contributors||[]).concat(Q.Coach||[]);Q.SubmitterContributors=(Q.Submitter||[]).concat(Q.Contributors||[]);Q.SubmitterCoach=Q.Coach;g(Q);_(Q);if(S.getProperty("/EDITABLE")!==undefined){Q.EDITABLE=S.getProperty("/EDITABLE");}if(Q.FieldsValue&&Q.FieldsValue.length>0){Q.FieldsValue.sort(function(T,U){if(T.SEQUENCE_NO<U.SEQUENCE_NO){return-1;}else{return 1;}});}if(Q.AdminFieldsValue&&Q.AdminFieldsValue.length>0){Q.AdminFieldsValue.sort(function(T,U){if(T.SEQUENCE_NO<U.SEQUENCE_NO){return-1;}else{return 1;}});}return E.initExtensionNode(Q,"Extension",S);}function k(Q,S,T){var U=D.getDateInstance({pattern:"yyyy-MM-dd"});var V=U.format(new Date());var W="";var X=null;var Y=C.getCurrentUser();if(Y){W=Y.NAME;X=Y.USER_ID;}Q.STATUS_ACTION_CODE=T;var Z=S.getProperty("/actions/executeStatusTransition/customProperties/statusTransitions");var $=jQuery.grep(Z,function(b1){return b1.STATUS_ACTION_CODE===T;})[0];Q.REWARD_ACTIVE=$&&$.REWARD_ACTIVE;Q.NEXT_STATUS_CODE=$&&$.NEXT_STATUS_CODE;Q.NEXT_PHASE_CODE=$&&$.NEXT_PHASE_CODE;Q.IS_PHASE_CHANGE=$&&e.isPhaseChange(T);Q.IS_DECISION_RELEVANT=!!($&&$.DECISION_RELEVANT);Q.INCLUDE_RESPONSE=$&&$.INCLUDE_RESPONSE;Q.DECISION_REASON_LIST_CODE=$&&$.DECISION_REASON_LIST_CODE;Q.DECISION_REASON_LIST_VISIBLE=$&&$.DECISION_REASON_LIST_VISIBLE;Q.TEXT_MODULE_CODE=$&&$.TEXT_MODULE_CODE;Q.DECIDER_ID=X;if(Q.IS_DECISION_RELEVANT){Q.DECISION_DATE=V;Q.REASON="";Q.SEND_RESPONSE=Q.INCLUDE_RESPONSE;Q.RESPONSE="";Q.DECIDER_NAME=W;Q.NOTIFY_AUTHOR=true;Q.REASON_CODE="";Q.LINK_LABEL="";Q.LINK_URL="";if(Q.DECISION_REASON_LIST_CODE){var a1="sap.ino.xs.object.basis.ValueOptionList.ValueOptions";Q.reasonList=d.getCodes(a1,function(b1){return b1.LIST_CODE===Q.DECISION_REASON_LIST_CODE&&b1.ACTIVE===1;});}}}function l(Q){var W=this.getProperty("/Walls");var S=jQuery.grep(W,function(T){return T.WALL_ID===Q.WALL_ID;});if(S.length===0){delete Q.ID;this.addChild(Q,"Walls");Q.WALL_ASSIGN_ID=Q.ID;}}function r(W){var Q=this;var S=jQuery.grep(Q.getProperty("/Walls")||[],function(T){return T.WALL_ID===W;});jQuery.each(S,function(T,U){Q.removeChild(U);});}function m(Q){var W=this.getProperty("/InternalWalls");var S=jQuery.grep(W,function(T){return T.WALL_ID===Q.WALL_ID;});if(S.length===0){delete Q.ID;this.addChild(Q,"InternalWalls");Q.WALL_ASSIGN_ID=Q.ID;}}function n(W){var Q=this;var S=jQuery.grep(Q.getProperty("/InternalWalls")||[],function(T){return T.WALL_ID===W;});jQuery.each(S,function(T,U){Q.removeChild(U);});}function o(Q){var S;if(!Q.NAME||jQuery.trim(Q.NAME).length===0){S=new M({key:"MSG_IDEA_INVALID_EMPTY_CONTRIBUTOR",type:a.Error,group:"CONTRIBUTOR"});return S;}if(!Q.IDENTITY_ID){S=new M({key:"MSG_IDEA_INVALID_CONTRIBUTOR",type:a.Error,group:"CONTRIBUTOR"});return S;}var T=this.getProperty("/Contributors");var U=jQuery.grep(T,function(V){return V.IDENTITY_ID===Q.IDENTITY_ID;});if(U.length===0){this.addChild(Q,"Contributors");}}function p(Q){var S;if(!Q.NAME||jQuery.trim(Q.NAME).length===0){S=new M({key:"MSG_IDEA_INVALID_EMPTY_EXPERT",type:a.Error,group:"EXPERT"});return S;}if(!Q.IDENTITY_ID){S=new M({key:"MSG_IDEA_INVALID_EXPERT",type:a.Error,group:"EXPERT"});return S;}var T=this.getProperty("/Experts");var U=jQuery.grep(T,function(V){return V.IDENTITY_ID===Q.IDENTITY_ID;});if(U.length===0){this.addChild(Q,"Experts");}}function q(Q){var S=this.getProperty("/Experts");var T=jQuery.grep(S,function(V){return V.IDENTITY_ID===Q;});var U=T[0];if(U){this.removeChild(U,"Experts");}}function t(Q){var S;var T=this.getProperty("/Tags");if(!Q.NAME||jQuery.trim(Q.NAME).length===0){S=new M({key:"MSG_INVALID_EMPTY_TAG",type:a.Error,group:"TAG"});return S;}Q.NAME=jQuery.trim(Q.NAME);if(!Q.TAG_ID&&Q.NAME){Q.TAG_ID=this.getNextHandle();}var U=jQuery.grep(T,function(V){return V.NAME.toLowerCase()===Q.NAME.toLowerCase();});if(U.length===0){this.addChild(Q,"Tags");}else{return new M({key:"MSG_DUPLICATE_TAG",type:a.Error});}}function u(Q,U,S){return this.addLink(U,S,Q);}function v(U,Q,S){var T;U=U.trim();if(!U||U===""){T=new M({code:"IDEA_OBJECT_MSG_LINK_URL_NOT_ALLOWED",type:a.Error});return T;}if(U&&U.indexOf("http://")!==0&&U.indexOf("https://")!==0&&U.indexOf("mailto:")!==0){U="http://"+U;}if(!U||U===""||!jQuery.sap.validateUrl(U)){T=new M({code:"IDEA_OBJECT_MSG_LINK_URL_NOT_ALLOWED",type:a.Error});return T;}if(!Q||Q===""){Q=null;}var V={ID:S,LABEL:Q,URL:U};if(S!==undefined){this.updateNode(V,"Links");}else{this.addChild(V,"Links");}}function w(Q,S,T){this.addChild({TARGET_OBJECT_TYPE_CODE:Q,TARGET_OBJECT_ID:S,SEMANTIC:T},"Relations");}function x(Q){Q.ROLE_TYPE_CODE="ATTACHMENT";this.addChild(Q,"Attachments");}function y(Q){Q.ROLE_TYPE_CODE="ATTACHMENT";this.addChild(Q,"InternalAttachments");}function z(Q){var S=jQuery.grep(this.getProperty("/Attachments")||[],function(T){return T.ATTACHMENT_ID===Q;});var T=S&&S[0];if(T){if(T.ROLE_TYPE_CODE==="IDEA_TITLE_IMAGE"){this.setProperty("/TITLE_IMAGE_ASSIGN_ID",null);this.setProperty("/TITLE_IMAGE_ID",null);}this.removeChild(T);}var U=jQuery.grep(this.getProperty("/InternalAttachments")||[],function(V){return V.ID===Q;});var V=U&&U[0];if(V){this.removeChild(V);}}function B(Q){jQuery.each(Q,function(S,T){if(T.ROLE_TYPE_CODE===I.TitleImage){T.ROLE_TYPE_CODE=I.Standard;}});}function F(Q){return jQuery.grep(Q,function(S){return S.ROLE_TYPE_CODE!==I.TitleImage;});}function G(Q){var S=this.getProperty("/Attachments");var T=jQuery.grep(S||[],function(X){return X.ATTACHMENT_ID===Q.ATTACHMENT_ID;});S=F(S);var U=T&&T[0];if(!U){var V=this.getProperty("/InternalAttachments");var W=jQuery.grep(V||[],function(X){return X.ATTACHMENT_ID===Q.ATTACHMENT_ID;});U=W&&W[0];if(U){U=jQuery.extend({},U);}else{U={};}U.ID=this.getNextHandle();S.push(U);}U.ATTACHMENT_ID=Q.ATTACHMENT_ID;U.FILE_NAME=Q.FILE_NAME?Q.FILE_NAME:U.FILE_NAME;U.MEDIA_TYPE=Q.MEDIA_TYPE?Q.MEDIA_TYPE:U.MEDIA_TYPE;U.ROLE_TYPE_CODE=I.TitleImage;this.setProperty("/TITLE_IMAGE_ASSIGN_ID",U.ID);this.setProperty("/TITLE_IMAGE_ID",U.ATTACHMENT_ID);this.setProperty("/TITLE_IMAGE_MEDIA_TYPE",U.MEDIA_TYPE);this.setProperty("/Attachments",S);}function H(){var Q=this.getProperty("/Attachments");Q=F(Q);this.setProperty("/Attachments",Q);this.setProperty("/TITLE_IMAGE_ASSIGN_ID",null);this.setProperty("/TITLE_IMAGE_ID",null);this.setProperty("/TITLE_IMAGE_MEDIA_TYPE",null);}function J(Q){var S=this.getProperty("/DESCRIPTION");var T=this.getProperty("/IDEA_DESCRIPTION_TEMPLATE")||Q||"";var U="<p>"+T+"</p>";return!S||S===""||S==="<br>"||S==="<div><br></div>"||S===T||S===U;}function K(){return(this.getProperty("/SUBMITTED_AT")!==null);}function L(T){var Q={DOCUMENT:"DOCUMENT",IMAGE:"IMAGE",VIDEO:"VIDEO",AUDIO:"AUDIO",TEXT:"TEXT",ERROR:"ERROR",DEFAULT:"DOCUMENT"};if(T===Q.IMAGE||T.indexOf("image/")===0){T=Q.IMAGE;}else if(T===Q.VIDEO||T.indexOf("video/")===0){T=Q.VIDEO;}else if(T===Q.AUDIO||T.indexOf("audio/")===0){T=Q.AUDIO;}else if(T===Q.TEXT||T.indexOf("text/")===0){T=Q.TEXT;}else if(T===Q.ERROR){T=Q.ERROR;}else if(T===Q.DOCUMENT){T=Q.DOCUMENT;}else{T=Q.DEFAULT;}return T;}function N(){var Q=this.getProperty("/VOTE_TYPE_CODE")!==this.getProperty("/CAMPAIGN_VOTE_TYPE_CODE");var S=this.getProperty("/VOTE_COUNT")>0;return(Q&&S);}function O(Q){var S=this.getData();var T=this;var U=4900;var V=200;var W=1;var X=0;var Y=0;var Z=[];var $=[];function a1(l1,m1,n1,o1,p1){l1.POSITION_X=U+(m1||0);l1.POSITION_Y=U+(n1||0)+(V*X)+Y;l1.WIDTH=o1||V;l1.HEIGHT=p1||V;l1.ZINDEX=W;Z.push(l1);W++;X++;if(p1){Y+=(p1-(V/2));}}function b1(l1,m1,n1,o1,p1,q1){if(l1.length===0){return;}var r1=((o1||V)+(q1||0));var s1=l1.length*r1;jQuery.each(l1,function(t1,u1){u1.POSITION_X=U+(m1||0)-(s1/2)+(t1+0.5)*r1;u1.POSITION_Y=U+(n1||0)+(V*X)+Y;u1.WIDTH=o1||V;u1.HEIGHT=p1||V;u1.ZINDEX=W;Z.push(u1);W++;});X++;if(p1){Y+=(p1-(V/2));}}a1({"WALL_ITEM_TYPE_CODE":"sap.ino.config.LINK","CONTENT":{"TEXT":S.NAME||"","ICON":"IDEA","URL":Q.getNavigationLink("idea-display",{id:this.getKey()})}},50);a1({"WALL_ITEM_TYPE_CODE":"sap.ino.config.PERSON","CONTENT":{"NAME":S.SUBMITTER_NAME||"","PHONE":"","EMAIL":S.SUBMITTER_EMAIL||"","ORIGIN_ID":S.SUBMITTER_ID,"REQUEST_IMAGE":true}});if(S.Contributors&&S.Contributors.length>0){var c1=[];jQuery.each(S.Contributors,function(l1,m1){c1.push({"WALL_ITEM_TYPE_CODE":"sap.ino.config.PERSON","CONTENT":{"NAME":m1.NAME||"","PHONE":"","EMAIL":m1.EMAIL||"","ORIGIN_ID":m1.IDENTITY_ID,"REQUEST_IMAGE":true}});});b1(c1);}if(S.CAMPAIGN_NAME){a1({"WALL_ITEM_TYPE_CODE":"sap.ino.config.HEADLINE","CONTENT":{"TEXT":S.CAMPAIGN_NAME||"","STYLE":"BRAG","SIZE":"H3"}},-25,50);}if(S.DESCRIPTION){a1({"WALL_ITEM_TYPE_CODE":"sap.ino.config.TEXT","CONTENT":{"CAPTION":S.NAME||"","TEXT":S.DESCRIPTION||""}},-275,0,800,400);}if(S.Tags&&S.Tags.length>0){var d1=[];jQuery.each(S.Tags,function(l1,m1){d1.push({"WALL_ITEM_TYPE_CODE":"sap.ino.config.HEADLINE","CONTENT":{"TEXT":m1.NAME||"","STYLE":"COOL","SIZE":"H5"}});});b1(d1);}if(S.Links&&S.Links.length>0){var e1=[];jQuery.each(S.Links,function(l1,m1){$.push(m1.ID);e1.push({"WALL_ITEM_TYPE_CODE":"sap.ino.config.LINK","CONTENT":{"TEXT":m1.LABEL||m1.URL||"","ICON":"MISC","URL":m1.URL||""}});});b1(e1,50,-50);}if(S.Attachments&&S.Attachments.length>0){var f1=[];var g1=[];jQuery.each(S.Attachments,function(l1,m1){if(m1.MEDIA_TYPE.indexOf("image/")===0){f1.push({"WALL_ITEM_TYPE_CODE":"sap.ino.config.IMAGE","CONTENT":{"CAPTION":m1.FILE_NAME||"","SHOW_AS_ICON":false},"Image":[{"ATTACHMENT_ID":m1.ATTACHMENT_ID}]});}else{g1.push({"WALL_ITEM_TYPE_CODE":"sap.ino.config.ATTACHMENT","CONTENT":{"CAPTION":m1.FILE_NAME||"","TYPE":L(m1.MEDIA_TYPE),"FILE_NAME":m1.FILE_NAME||""},"Attachment":[{"ATTACHMENT_ID":m1.ATTACHMENT_ID}]});}});b1(f1,0,0,0,0,50);b1(g1,0,50,0,0,50);}jQuery.sap.require("sap.ino.commons.models.object.Wall");var h1=sap.ino.commons.models.object.Wall;var i1=new jQuery.Deferred();var j1=this;var k1=h1.create({ID:-1,NAME:S.NAME,WALL_TYPE_CODE:"sap.ino.config.WALL",BACKGROUND_COLOR:S.CAMPAIGN_COLOR||"FFFFFF",IDEA_ID:S.ID,Items:Z});k1.done(function(l1){var m1=l1.GENERATED_IDS[-1];var n1=false;if(C.getCurrentUser().USER_ID===S.SUBMITTER_ID){n1=true;}if(S.Contributors&&S.Contributors.length>0){jQuery.each(S.Contributors,function(o1,p1){if(C.getCurrentUser().USER_ID==p1.IDENTITY_ID){n1=true;}});}if(n1){var e1=[];jQuery.each($,function(o1,p1){e1.push({ID:p1});});e1.push({ID:-1,LABEL:Q.getModel("i18n").getResourceBundle().getText("IDEA_OBJECT_TIT_WALL",[S.NAME]),URL:Q.getNavigationLink("wall",{id:m1})});j1.setProperty("/Links",e1);j1.update();}i1.resolve(m1);});k1.fail(function(l1){T.getMessageParser().parse(l1);});return i1.promise();}return e;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.IdeaComment')){jQuery.sap.declare('sap.ino.commons.models.object.IdeaComment');sap.ui.define("sap/ino/commons/models/object/IdeaComment",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend("sap.ino.commons.models.object.IdeaComment",{objectName:"sap.ino.xs.object.idea.Comment",readSource:R.getDefaultAOFSource(),invalidation:{entitySets:["IdeaComment"]},actionImpacts:{"del":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["COMMENT_COUNT","FOLLOW"]}],"create":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["COMMENT_COUNT","FOLLOW"]}],"delComment":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["COMMENT_COUNT","FOLLOW"]}]}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.IdeaFollow')){jQuery.sap.declare('sap.ino.commons.models.object.IdeaFollow');sap.ui.define("sap/ino/commons/models/object/IdeaFollow",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend('sap.ino.commons.models.object.IdeaFollow',{objectName:"sap.ino.xs.object.follow.Follow",readSource:R.getDefaultAOFSource(),actionImpacts:{"create":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["FOLLOW","NEG_VOTES","POS_VOTES","SCORE","USER_SCORE","VOTE_COUNT","VOTE_ID"]}],"del":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["FOLLOW","NEG_VOTES","POS_VOTES","SCORE","USER_SCORE","VOTE_COUNT","VOTE_ID"]}]},follow:function(o,t,v){return!v?this.modify(v,{OBJECT_ID:o,OBJECT_TYPE_CODE:t}):this.del(v,{OBJECT_ID:o,OBJECT_TYPE_CODE:t});}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.IdeaLatest')){jQuery.sap.declare('sap.ino.commons.models.object.IdeaLatest');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');sap.ui.define("sap/ino/commons/models/object/IdeaLatest",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource","sap/ui/core/message/Message","sap/ui/core/MessageType"],function(A,R,M,a){"use strict";var I=A.extend("sap.ino.commons.models.object.IdeaLatest",{objectName:"sap.ino.xs.object.idea.IdeaLatest",readSource:R.getDefaultAOFSource()});return I;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.IdeaObjectIntegration')){jQuery.sap.declare('sap.ino.commons.models.object.IdeaObjectIntegration');sap.ui.define("sap/ino/commons/models/object/IdeaObjectIntegration",["sap/ino/commons/models/aof/ApplicationObject"],function(A){"use strict";var I=A.extend("sap.ino.commons.models.object.IdeaObjectIntegration",{objectName:"sap.ino.xs.object.integration.IdeaObjectIntegration"});return I;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.IdeaRead')){jQuery.sap.declare('sap.ino.commons.models.object.IdeaRead');sap.ui.define("sap/ino/commons/models/object/IdeaRead",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend('sap.ino.commons.models.object.IdeaRead',{objectName:"sap.ino.xs.object.idea.IdeaRead",readSource:R.getDefaultAOFSource(),invalidation:{entitySets:["IdeaRead"]},actionImpacts:{"markRead":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["IS_READ","READ_ID"]}]}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.IdeaVolunteer')){jQuery.sap.declare('sap.ino.commons.models.object.IdeaVolunteer');sap.ui.define("sap/ino/commons/models/object/IdeaVolunteer",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend("sap.ino.commons.models.object.IdeaVolunteer",{objectName:"sap.ino.xs.object.idea.Volunteer",readSource:R.getDefaultAOFSource(),invalidation:{entitySets:["IdeaVolunteers"]},actionImpacts:{"create":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["VOLUNTEER_ID"]}],"del":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["VOLUNTEER_ID"]}]},toggleVolunteer:function(k,i){return!!k?this.del(k,{IDEA_ID:i}):this.create({IDEA_ID:i});}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.InternalNote')){jQuery.sap.declare('sap.ino.commons.models.object.InternalNote');sap.ui.define("sap/ino/commons/models/object/InternalNote",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend("sap.ino.commons.models.object.InternalNote",{objectName:"sap.ino.xs.object.idea.InternalNote",readSource:R.getDefaultAOFSource(),invalidation:{entitySets:["IdeaInternalNote"]},actionImpacts:{"del":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["INTERNAL_NOTE_COUNT","INTERNAL_ATTACHMENT_COUNT"]}],"create":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["INTERNAL_NOTE_COUNT","INTERNAL_ATTACHMENT_COUNT"]}],"delComment":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["INTERNAL_NOTE_COUNT","INTERNAL_ATTACHMENT_COUNT"]}]}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.MergeConfig')){jQuery.sap.declare('sap.ino.commons.models.object.MergeConfig');sap.ui.define("sap/ino/commons/models/object/MergeConfig",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend('sap.ino.commons.models.object.MergeConfig',{objectName:"sap.ino.xs.object.idea.MergeConfig",readSource:R.getDefaultAOFSource()});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Notification')){jQuery.sap.declare('sap.ino.commons.models.object.Notification');sap.ui.define("sap/ino/commons/models/object/Notification",["sap/ino/commons/models/aof/ApplicationObject"],function(A){return A.extend("sap.ino.commons.models.object.Notification",{objectName:"sap.ino.xs.object.notification.Notification"});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.PersonalizeSetting')){jQuery.sap.declare('sap.ino.commons.models.object.PersonalizeSetting');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');sap.ui.define("sap/ino/commons/models/object/PersonalizeSetting",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource","sap/ui/core/message/Message","sap/ui/core/MessageType"],function(A,R,M,a){"use strict";var P=A.extend("sap.ino.commons.models.object.PersonalizeSetting",{objectName:"sap.ino.xs.object.iam.PersonalizeSetting",readSource:R.getDefaultAOFSource(),checkQuickLinkNameValid:c});P.defaultPesonalize={IDEA_VIEW:true,CAMPAIGN_VIEW:true,SCREEN_SIZE:true,FILTER:true,SIMILAR_IDEA:true,FILTER_ACTIVE_IDEA:false,REPORT_VIEW:false};function c(d,n,s){var v=true;for(var i=0;i<d.length;i++){if(d[i].LINK_TEXT===n||s.indexOf(n)>=0){v=false;}}return v;}return P;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Registration')){jQuery.sap.declare('sap.ino.commons.models.object.Registration');sap.ui.define("sap/ino/commons/models/object/Registration",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend('sap.ino.commons.models.object.Registration',{objectName:"sap.ino.xs.object.campaign.Registration",readSource:R.getDefaultAOFSource(),actionImpacts:{"create":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["REGISTER_ID","REGISTER_STATUS","IS_OPEN_FOR_REGISTRATION"]}],"update":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["REGISTER_ID","REGISTER_STATUS"]}],"del":[{"objectName":"sap.ino.commons.models.object.Campaign","objectKey":"CAMPAIGN_ID","impactedAttributes":["REGISTER_ID","REGISTER_STATUS","IS_OPEN_FOR_REGISTRATION"]}]},Register:function(i,c){return this.modify(i||-1,{CAMPAIGN_ID:c,STATUS:'sap.ino.config.REGISTER_NEW'});},Approved:function(i){return this.update(i,{STATUS:'sap.ino.config.REGISTER_APPROVED',REGISTER_ID:i});},Rejected:function(i,r){return this.update(i,{STATUS:'sap.ino.config.REGISTER_REJECTED',REGISTER_ID:i,REASON:r});},Leave:function(i,c){return this.del(i,{CAMPAIGN_ID:c});}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.RewardList')){jQuery.sap.declare('sap.ino.commons.models.object.RewardList');jQuery.sap.require('sap.ui.model.type.Float');jQuery.sap.require('sap.ui.model.type.Integer');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.model.ParseException');sap.ui.define("sap/ino/commons/models/object/RewardList",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/CodeModel","sap/ino/commons/application/Configuration","sap/ui/model/type/Float","sap/ui/model/type/Integer","sap/ui/core/message/Message","sap/ui/core/MessageType","sap/ui/model/ParseException","sap/ino/commons/models/core/ReadSource"],function(A,C,a,F,I,M,b,P,R){"use strict";var c=A.extend("sap.ino.commons.models.object.RewardList",{objectName:"sap.ino.xs.object.reward.RewardList",readSource:R.getDefaultODataSource("IdeaRewardList",{}),invalidation:{entitySets:["IdeaRewardList","RewardSearch","IdeaMediumBackofficeSearch","IdeaReward"]},actionImpacts:{"create":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["CONTRIBUTION_READ_ONLY","IDEA_PHASE_NEED_REWARD","IDEA_HAS_REWARDS"]}],"del":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["CONTRIBUTION_READ_ONLY","IDEA_PHASE_NEED_REWARD","IDEA_HAS_REWARDS"]}]},determinations:{onCreate:_}});function _(d,m){var o=a.getCurrentUser();return{"CREATED_AT":new Date(),"CREATED_BY_NAME":o.NAME,"OBJECT_TYPE_CODE":"IDEA","STATUS_CODE":"sap.ino.config.REWARD_DRAFT","OBJECT_ID":d.OBJECT_ID||0};}return c;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Tag')){jQuery.sap.declare('sap.ino.commons.models.object.Tag');sap.ui.define("sap/ino/commons/models/object/Tag",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend('sap.ino.commons.models.object.Tag',{objectName:"sap.ino.xs.object.tag.Tag",readSource:R.getDefaultODataSource("Tags"),invalidation:{entitySets:["Tags","SearchTags","SearchTagsAllFull","MyTagFollow","SearchTagsAll"]}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.TagFollow')){jQuery.sap.declare('sap.ino.commons.models.object.TagFollow');sap.ui.define("sap/ino/commons/models/object/TagFollow",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";return A.extend('sap.ino.commons.models.object.TagFollow',{objectName:"sap.ino.xs.object.follow.Follow",readSource:R.getDefaultAOFSource(),actionImpacts:{"create":[{"objectName":"sap.ino.commons.models.object.Tag","objectKey":"OBJECT_ID","impactedAttributes":["FOLLOW"]}],"del":[{"objectName":"sap.ino.commons.models.object.Tag","objectKey":"OBJECT_ID","impactedAttributes":["FOLLOW"]}]},follow:function(o,t,v){return!v?this.modify(v,{OBJECT_ID:o,OBJECT_TYPE_CODE:t}):this.del(v,{OBJECT_ID:o,OBJECT_TYPE_CODE:t});}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.User')){jQuery.sap.declare('sap.ino.commons.models.object.User');sap.ui.define("sap/ino/commons/models/object/User",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";var S={CommunityUser:"COMMUNITY_USER",InnovationOfficeUser:"INNOVATION_OFFICE_USER",InnovationManager:"INNOVATION_MANAGER",SystemManager:"INNOVATION_SYSTEM_MANAGER"};var U=A.extend("sap.ino.commons.models.object.User",{objectName:"sap.ino.xs.object.iam.User",readSource:R.getDefaultODataSource("Identity",{excludeNodes:["MemberOf"]}),invalidation:{entitySets:["Identity","SearchIdentity"]}});U.StaticRoles=S;return U;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.UserSettings')){jQuery.sap.declare('sap.ino.commons.models.object.UserSettings');sap.ui.define("sap/ino/commons/models/object/UserSettings",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";var a={UserImage:"IDENTITY_IMAGE"};var T={HCB:"sap_hcb"};var M={Active:"active",Inactive:"inactive"};var U=A.extend("sap.ino.commons.models.object.UserSettings",{objectName:"sap.ino.xs.object.iam.UserSettings",readSource:R.getDefaultODataSource("Identity",{includeNodes:[{name:"Settings",parentNode:"Root"},{name:"Attachments",parentNode:"Root"}]}),actions:{create:{enabledCheck:function(){return false;}}},setUserImage:s,clearUserImage:c});U.Mail=M;U.Theme=T;function s(i){var b=this.getProperty("/Attachments");var u;if(b===undefined||b===null||b.length===0){u={};u.ID=this.getNextHandle();}else{u=b[0];}u.ATTACHMENT_ID=i.ATTACHMENT_ID;u.FILE_NAME=i.FILE_NAME;u.MEDIA_TYPE=i.MEDIA_TYPE;u.ROLE_TYPE_CODE=a.UserImage;this.setProperty("/Settings/TITLE_IMAGE_ASSIGN_ID",u.ID);this.setProperty("/Settings/TITLE_IMAGE_ID",u.ATTACHMENT_ID);this.setProperty("/Settings/TITLE_IMAGE_MEDIA_TYPE",u.MEDIA_TYPE);this.setProperty("/Attachments",[u]);}function c(){this.setProperty("/Attachments",[]);this.setProperty("/Settings/TITLE_IMAGE_ASSIGN_ID",null);this.setProperty("/Settings/TITLE_IMAGE_ID",null);this.setProperty("/Settings/TITLE_IMAGE_MEDIA_TYPE",null);}return U;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Vote')){jQuery.sap.declare('sap.ino.commons.models.object.Vote');sap.ui.define("sap/ino/commons/models/object/Vote",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";var V=A.extend("sap.ino.commons.models.object.Vote",{objectName:"sap.ino.xs.object.idea.Vote",readSource:R.getDefaultAOFSource(),invalidation:{entitySets:["IdeaVote"]},actionImpacts:{"del":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["NEG_VOTES","POS_VOTES","SCORE","USER_SCORE","VOTE_COUNT","VOTE_ID","FOLLOW"]}],"create":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["NEG_VOTES","POS_VOTES","SCORE","USER_SCORE","VOTE_COUNT","VOTE_ID","FOLLOW"]}],"update":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID","impactedAttributes":["NEG_VOTES","POS_VOTES","SCORE","USER_SCORE","VOTE_COUNT","VOTE_ID","FOLLOW"]}]}});V.TYPE_STAR="STAR";V.TYPE_LIKE="LIKE";V.TYPE_LIKE_DISLIKE="LIKE_DISLIKE";V.vote=function(o,s,v,r,a){if(!s){return{vote:V.del(v||-1,{IDEA_ID:o}),mode:"DEL_VOTE"};}else{return{vote:V.modify(v||-1,{IDEA_ID:o,SCORE:s,VOTE_REASON:r,VOTE_COMMENT:a}),mode:"MODIFY_VOTE"};}};return V;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Wall')){jQuery.sap.declare('sap.ino.commons.models.object.Wall');sap.ui.define("sap/ino/commons/models/object/Wall",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource","sap/ino/commons/models/util/WallMapper","sap/ino/commons/models/util/UUID","sap/ino/commons/application/Configuration","sap/ino/commons/models/aof/ApplicationObjectChange"],function(A,R,W,U,C,c){"use strict";var d={Readonly:"Readonly",Write:"Write"};var o="sap.ino.xs.object.wall.Wall";var e;e=A.extend("sap.ino.commons.models.object.Wall",{objectName:o,readSource:R.getDefaultAOFSource({cache:false}),invalidation:{entitySets:["Wall","MyWalls","WallSearch"]},actionImpacts:{"create":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"IDEA_ID"}]},determinations:{onRead:f,onNormalizeData:n},constructor:function(){A.apply(this,arguments);this._wallSessionUUID=U.generate();},process:function(a){return e.processRequest(this,a);},getSyncDate:function(){return new Date(this.getLastReadDate().getTime()-2500);},readDeltaData:function(){var p=this.readData({cache:false,headers:{"wall-last-read":this.getSyncDate().toUTCString(),"wall-session-uuid":this._wallSessionUUID}});this._lastReadDate=new Date();return p;},pollDeltaData:function(){var p=jQuery.ajax({url:this.getEndpointURL().replace("/wall.xsjs","/wall_poll.xsjs")+"/"+this.getKey(),type:"GET",dataType:"json",contentType:"application/json",cache:false,headers:{"wall-last-read":this.getSyncDate().toUTCString(),"wall-session-uuid":this._wallSessionUUID}});this._lastReadDate=new Date();return p;},save:function(S){var t=this;var p=this.modify(S);p.done(function(){var D=t.getData();n(D,t);g(D,t);t.setProperty("/WALL_EDITABLE",D.WALL_EDITABLE);t.setProperty("/WALL_ADMINISTRABLE",D.WALL_ADMINISTRABLE);t.setProperty("/CHANGED_AT",(new Date()).toJSON());});return p;},saveItems:function(I,S,b){var t=this;var J=this._stringifyItems(I,true,b);var p=this.process({type:"POST",cache:false,url:this.getEndpointURL(),data:J,async:!S,contentType:"application/json; charset=UTF-8"});p.done(function(r){t.setProperty("/CHANGED_AT",(new Date()).toJSON());var a={object:t.getApplicationObject(),key:t.getProperty("/ID"),dataUpdate:{CHANGED_AT:t.getProperty("/CHANGED_AT")},};c.fireChange(a);});return p;},deleteItems:function(I){var t=this;var a=I.join();var p=this.process({type:"DELETE",cache:false,url:this.getEndpointURL(),headers:{"wall-wallItemIds":a}});p.done(function(r){var b={object:t.getApplicationObject(),key:t.getProperty("/ID"),dataUpdate:{CHANGED_AT:t.getProperty("/CHANGED_AT")}};c.fireChange(b);});return p;},addPermission:function(N){var p=this.getProperty("/Permissions");var m=jQuery.grep(p,function(P){return P.ID===N.ID||P.IDENTITY_ID===N.IDENTITY_ID;});if(m.length===0){N.ID=this.getNextHandle();this.oData.Permissions.push(N);this.oData.Permissions.sort(e.fnSortByName);this.checkUpdate(true);return true;}return false;},notifyPermissionUpdated:function(p){var P=jQuery.grep(this.getProperty("/Permissions")||[],function(a){return a.ID===p;});return P.length>0;},removePermission:function(p){var t=this;var P=jQuery.grep(this.getProperty("/Permissions")||[],function(a){return a.ID===p;});jQuery.each(P,function(a,b){t.removeChild(b);});return P.length!==0;},setBackgroundAttachmentImage:i,clearBackgroundAttachmentImage:j,deltaUpdate:h,_stringifyItems:function(w,I,S){var t=this;var v;if(S){v=w;}else{v=this._mapWallItemsWallToIno(w);}if(I){if(jQuery.type(v)!=="array"){v=[v];}var a={ID:this.getKey(),Items:v};return JSON.stringify(a);}else{return JSON.stringify(v);}},_mapWallItemsWallToIno:function(w){var t=this;if(jQuery.type(w)=="array"){var a=[];w.forEach(function(I){a.push(t._mapWallItemsWallToIno(I));});return a;}else{return W.mapItemToIno(w);}}});function f(D,w){jQuery.each(D.Items||[],function(I,a){if(a.CHANGED_AT>D.CHANGED_AT){D.CHANGED_AT=a.CHANGED_AT;}});s(D,w);g(D,w);return D;}function s(D,w){D.Permissions=[].concat(D.Readers).concat(D.Writers).concat(D.Admins);D.Permissions.sort(e.fnSortByName);}function g(D,w){D.WALL_EDITABLE=!D.IS_LOCKED&&D.IS_EDITABLE===1;D.WALL_ADMINISTRABLE=!D.IS_LOCKED&&D.IS_ADMINISTRABLE===1;}function h(D,a){if(!D){return undefined;}if(D.ACTION_CODE!="DELETED"){var w=W.mapWallFromIno(D,true);if(D.ITEM_SCOPE){delete w.strongestAuth;}a(w);delete D.ID;delete D.ITEM_SCOPE;delete D.ACTION_CODE;D=jQuery.extend(this.getData(),D);s(D,this);g(D,this);this.setData(D);this.setAfterInitChanges();return true;}return false;}function i(a){var b=this.getProperty("/BackgroundImage")||[];if(b.length===0){b=[{ID:this.getNextHandle()}];}b[0].ATTACHMENT_ID=a;this.setProperty("/BackgroundImage",b);this.setProperty("/BACKGROUND_IMAGE_URL","");this.setProperty("/BACKGROUND_COLOR","");this.setProperty("/BACKGROUND_IMAGE_ZOOM",100);this.setProperty("/BACKGROUND_IMAGE_REPEAT",0);this.setProperty("/BACKGROUND_IMAGE_POSITION_X",0);this.setProperty("/BACKGROUND_IMAGE_POSITION_Y",0);}function j(E){this.setProperty("/BackgroundImage",[]);if(!E){this.setProperty("/BACKGROUND_IMAGE_URL","");}this.setProperty("/BACKGROUND_IMAGE_ZOOM",null);this.setProperty("/BACKGROUND_IMAGE_REPEAT",null);this.setProperty("/BACKGROUND_IMAGE_POSITION_X",null);this.setProperty("/BACKGROUND_IMAGE_POSITION_Y",null);}function n(D,w){var b=w.getBeforeData();D.Readers=[];D.Writers=[];D.Admins=[];jQuery.each(D.Permissions||[],function(a,p){var B=jQuery.grep(b.Permissions,function(k){return k.IDENTITY_ID===p.IDENTITY_ID;});var I=p.ID;if(B.length>0&&B[0].ROLE_CODE!==p.ROLE_CODE){I=w.getNextHandle();}switch(p.ROLE_CODE){case"WALL_READER":D.Readers.push({ID:I,IDENTITY_ID:p.IDENTITY_ID});break;case"WALL_WRITER":D.Writers.push({ID:I,IDENTITY_ID:p.IDENTITY_ID});break;case"WALL_ADMIN":D.Admins.push({ID:I,IDENTITY_ID:p.IDENTITY_ID});break;default:break;}});return D;}e.readItems=function(w,a){return jQuery.ajax({url:e.getBackendUrl(),headers:{"wall-action":"readItems","wall-wallIds":w.toString()},accepts:"application/json",async:a!==false,cache:false});};e.readWalls=function(w,a){return jQuery.ajax({url:e.getBackendUrl(),headers:{"wall-action":"readWalls","wall-wallIds":w.toString()},accepts:"application/json",async:a!==false,cache:false});};e.getBackendUrl=function(){return C.getBackendRootURL()+C.getApplicationObject(o);};e.fnSortByName=function(a,b){var N=a&&a.IDENTITY_NAME&&a.IDENTITY_NAME.toLowerCase();var k=b&&b.IDENTITY_NAME&&b.IDENTITY_NAME.toLowerCase();return((N<k)?-1:((N>k)?1:0));};e.processRequest=function(w,a){var p=[a];if(!a.headers||!a.headers["wall-session-uuid"]){if(!a.headers){a.headers={};}a.headers["wall-session-uuid"]=w._wallSessionUUID||U.generate();}var P;if(!w._lastProcessPromise){P=A.prototype.process.apply(w,p);}else{var D=jQuery.Deferred();w._lastProcessPromise.hasSuccessor=true;w._lastProcessPromise.always(function(){A.prototype.process.apply(w,p).always(function(r,S,b){D.resolve(r,S,b);}).fail(function(r){D.reject(r);});});P=D.promise();}w._lastProcessPromise=P;P.always(function(){if(w._lastProcessPromise&&!w._lastProcessPromise.hasSuccessor){w._lastProcessPromise=null;}});return P;};return e;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.WallItem')){jQuery.sap.declare('sap.ino.commons.models.object.WallItem');sap.ui.define("sap/ino/commons/models/object/WallItem",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource","sap/ino/commons/models/util/UUID","sap/ino/commons/models/object/Wall"],function(A,R,U,W){"use strict";var o="sap.ino.xs.object.wall.WallItem";var a=A.extend("sap.ino.commons.models.object.WallItem",{objectName:o,readSource:function(k,o,m,b){b=b||{};b.headers=b.headers||{};b.headers["wall-action"]="readItemById";b.headers["wall-wallItemId"]=k;return R.getDefaultAOFSource({cache:false})("",o,m,b);},invalidation:{entitySets:["WallItems"]},constructor:function(){A.apply(this,arguments);this._wallSessionUUID=U.generate();},process:function(b){if(b.type==="DELETE"){var s=b.url.lastIndexOf("/");b.headers["wall-wallItemIds"]=b.url.substring(s+1);b.url=b.url.substring(0,s);}else{var i=JSON.parse(b.data);i.CONTENT=JSON.parse(i.CONTENT);b.data=JSON.stringify({ID:i.WALL_ID,Items:[i]});}return W.processRequest(this,b);},getChangeRequest:function(c){var C=jQuery.extend({},this.getData());C.CONTENT=JSON.stringify(C.CONTENT);var b=this.calculateChangeRequest(this.getApplicationObject(),this._oBeforeData||{},C,c,this);b.WALL_ID=C.WALL_ID;return b;}});return a;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.communityUser')){jQuery.sap.declare('sap.ino.commons.models.object.communityUser');sap.ui.define("sap/ino/commons/models/object/communityUser",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource"],function(A,R){"use strict";var S={CommunityUser:"COMMUNITY_USER",InnovationOfficeUser:"INNOVATION_OFFICE_USER",InnovationManager:"INNOVATION_MANAGER",SystemManager:"INNOVATION_SYSTEM_MANAGER"};var U=A.extend("sap.ino.commons.models.object.communityUser",{objectName:"sap.ino.xs.object.iam.CommunityUserGroup",readSource:R.getDefaultODataSource("Identity",{excludeNodes:["MemberOf"]}),invalidation:{entitySets:["Identity","SearchIdentity"]}});U.StaticRoles=S;return U;});};if(!jQuery.sap.isDeclared('sap.ino.commons.util.ExportPPT')){jQuery.sap.declare('sap.ino.commons.util.ExportPPT');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.ui.thirdparty.jszip');sap.ui.define("sap/ino/commons/util/ExportPPT",["sap/ino/commons/application/Configuration","sap/ino/commons/models/core/CodeModel","sap/ui/core/format/DateFormat","sap/ino/controls/util/ColorSupport","sap/ino/controls/IdeaStatusType","sap/ui/thirdparty/jszip"],function(C,a,D,b,I,J){"use strict";var R={CAMPAIGN_TEXT:new RegExp("{{CAMPAIGN_TEXT}}","g"),CAMPAIGN_NAME:new RegExp("{{CAMPAIGN_NAME}}","g"),CAMPAIGN_COLOR:new RegExp("{{CAMPAIGN_COLOR}}","g"),CAMPAIGN_TEXT_COLOR:new RegExp("{{CAMPAIGN_TEXT_COLOR}}","g"),IDEA_TITLE:new RegExp("{{IDEA_TITLE}}","g"),IDEA_NAME:new RegExp("{{IDEA_NAME}}","g"),STATUS_TEXT:new RegExp("{{STATUS_TEXT}}","g"),IDEA_STATUS:new RegExp("{{IDEA_STATUS}}","g"),PHASE_TEXT:new RegExp("{{PHASE_TEXT}}","g"),IDEA_PHASE:new RegExp("{{IDEA_PHASE}}","g"),IDEA_SHORT_DESCRIPTION:new RegExp("{{IDEA_SHORT_DESCRIPTION}}","g"),AUTHOR_TEXT:new RegExp("{{AUTHOR_TEXT}}","g"),AUTHOR_NAME:new RegExp("{{AUTHOR_NAME}}","g"),COACH_TEXT:new RegExp("{{COACH_TEXT}}","g"),COACH_NAME:new RegExp("{{COACH_NAME}}","g"),COMMENT_COUNT:new RegExp("{{COMMENT_COUNT}}","g"),EVALUATION_COUNT:new RegExp("{{EVALUATION_COUNT}}","g"),VOTE_COUNT:new RegExp("{{VOTE_COUNT}}","g"),IDEA_LINK:new RegExp("%7b%7bIDEA_LINK%7d%7d","g"),IDEA_TITLE_IMAGE:new RegExp("{{IDEA_TITLE_IMAGE}}","g"),STATUS_CHANGE_REASON_TEXT:new RegExp("{{REASON_TEXT}}","g"),STATUS_CHANGE_REASON:new RegExp("{{CHANGE_REASON}}","g"),XML_TAG:new RegExp("<[^>]*>","g"),XML_FUNCTIONAL_CHAR:new RegExp("&[a-z]*;","g"),AMPERSAND:new RegExp("&","g"),BACKSPACE:new RegExp("nbsp;","g"),LOWER_THAN:new RegExp("<","g"),GREATER_THAN:new RegExp(">","g"),EMPTY_NAMESPACE:new RegExp(" xmlns=\"\"","g")};var F={STATUS_FORMATTER:a.getFormatter("sap.ino.xs.object.status.Status.Root"),PHASE_FORMATTER:a.getFormatter("sap.ino.xs.object.campaign.Phase.Root"),VALUE_OPTION:a.getFormatter("sap.ino.xs.object.basis.ValueOptionList.ValueOptions")};var S={INACTIVE:"E5E5E5",ACTIVE:"048E3E",STOPPED:"9F1313"};var _=new XMLSerializer();return{_getText:function(){if(this.i18n){return this.i18n.getResourceBundle().getText.apply(this.i18n.getResourceBundle(),arguments);}return"";},_getValidXMLString:function(s){return s.replace(R.AMPERSAND,"&amp;").replace(R.LOWER_THAN,"&lt;").replace(R.GREATER_THAN,"&gt;").replace(R.XML_FUNCTIONAL_CHAR," ").replace(R.BACKSPACE,"\r\n").replace(R.XML_TAG,"");},_getTemplate:function(){var d=new jQuery.Deferred();var p=C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_PPTX_TEMPLATE_DOWNLOAD")+"?FILE_NAME=IdeaExport";var r=new XMLHttpRequest();r.open("GET",p,true);if(r.responseType){r.responseType="arraybuffer";}if(r.overrideMimeType){r.overrideMimeType("text/plain; charset=x-user-defined");}r.onreadystatechange=function(){if(r.readyState===4){if(r.status===200){d.resolve(r.response);}else{d.reject(r.response);}}};r.send();return d;},_getProcessIndicator:function(o,p){var s="";var c=o.STEPS;var d=o.STEP;var l=Math.round(p.cy/5);var L=p.y+Math.round(p.cy/5)*2;var f=0;if(c>=2){f=Math.round((p.cx-p.cy)/(c-1));}var P=((d<0)?0:d*f);if(d>=c){P=p.cx-p.cy;}var O=100;function e(X,k,m){s+='<p:sp><p:nvSpPr><p:cNvPr id="'+(O++)+'" name="Rectangle '+(O++)+'"/><p:cNvSpPr/><p:nvPr/></p:nvSpPr>'+'<p:spPr><a:xfrm><a:off x="'+X+'" y="'+L+'"/><a:ext cx="'+k+'" cy="'+l+'"/></a:xfrm><a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:solidFill><a:srgbClr val="'+m+'"/></a:solidFill><a:ln><a:noFill/></a:ln></p:spPr>'+'<p:style><a:lnRef idx="2"><a:schemeClr val="accent1"><a:shade val="50000"/></a:schemeClr></a:lnRef><a:fillRef idx="1"><a:schemeClr val="accent1"/>'+'</a:fillRef><a:effectRef idx="0"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></p:style>'+'<p:txBody><a:bodyPr rtlCol="0" anchor="ctr"/><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:endParaRPr lang="en-US" dirty="0"/></a:p></p:txBody></p:sp>';}function g(X,k){s+='<p:sp><p:nvSpPr><p:cNvPr id="'+O++ +'" name="Oval '+O++ +'"/><p:cNvSpPr/><p:nvPr/></p:nvSpPr>'+'<p:spPr><a:xfrm><a:off x="'+X+'" y="'+p.y+'"/><a:ext cx="'+p.cy+'" cy="'+p.cy+'"/></a:xfrm><a:prstGeom prst="ellipse">'+'<a:avLst/></a:prstGeom><a:solidFill><a:srgbClr val="'+k+'"/></a:solidFill><a:ln><a:noFill/></a:ln></p:spPr>'+'<p:style><a:lnRef idx="2"><a:schemeClr val="accent1"><a:shade val="50000"/></a:schemeClr></a:lnRef><a:fillRef idx="1"><a:schemeClr val="accent1"/>'+'</a:fillRef><a:effectRef idx="0"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></p:style>'+'<p:txBody><a:bodyPr rtlCol="0" anchor="ctr"/><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:endParaRPr lang="en-US"/></a:p></p:txBody></p:sp>';}var h=S.ACTIVE;if(o.STATUS===I.Discontinued||o.STATUS===I.Merged){h=S.STOPPED;}if(c>1){if(P>0){e(Math.round(p.x+p.cy/2),P,h);}if(p.cx-p.cy-P>0){e(Math.round(p.x+p.cy/2+P),p.cx-p.cy-P,S.INACTIVE);}}for(var i=0;i<c;i++){var x=p.x+i*f;var j=h;if(i>d||o.STATUS===I.Draft){j=S.INACTIVE;}g(x,j);}return s;},_addImageTypesToContentTypes:function(c){var e;if(jQuery(c).find('[Extension="png"]').length===0){e=c.createElement("Default");jQuery(e).attr("Extension","png").attr("ContentType","image/png");c.documentElement.appendChild(e);}if(jQuery(c).find('[Extension="jpeg"]').length===0){e=c.createElement("Default");jQuery(e).attr("Extension","jpeg").attr("ContentType","image/jpeg");c.documentElement.appendChild(e);}if(jQuery(c).find('[Extension="jpg"]').length===0){e=c.createElement("Default");jQuery(e).attr("Extension","jpg").attr("ContentType","application/octet-stream");c.documentElement.appendChild(e);}return"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>"+_.serializeToString(c.documentElement).replace(R.EMPTY_NAMESPACE,"");},_stringToArrayBuffer:function(s){var A=new ArrayBuffer(s.length);var B=new Uint8Array(A);for(var i=0,c=s.length;i<c;i++){B[i]=s.charCodeAt(i);}return A;},_getImagePlaceholderDimensions:function(s,i){var o=jQuery.parseXML(s);var e=o.getElementsByTagNameNS("*","sp");var p;jQuery.each(e,function(c,f){var g=f.getElementsByTagNameNS("*","t");if(g&&g.length>0&&f.getElementsByTagNameNS("*","t")[0].firstChild.data===i){p=f;return false;}});if(p){var d=p.getElementsByTagNameNS("*","xfrm")[0];var O=d.getElementsByTagNameNS("*","off")[0];var E=d.getElementsByTagNameNS("*","ext")[0];return{name:i,x:parseInt(O.getAttribute("x"),10),y:parseInt(O.getAttribute("y"),10),cx:parseInt(E.getAttribute("cx"),10),cy:parseInt(E.getAttribute("cy"),10)};}},_addImage:function(i,p,f,s,r){var c='<p:pic>'+'<p:nvPicPr>'+'<p:cNvPr id="'+i+'" name="Picture '+i+'"/>'+'<p:cNvPicPr>'+'<a:picLocks noChangeAspect="1"/>'+'</p:cNvPicPr>'+'<p:nvPr/>'+'</p:nvPicPr>'+'<p:blipFill>'+'<a:blip r:embed="rId'+i+'" cstate="print">'+'<a:extLst>'+'<a:ext uri="{28A0092B-C50C-407E-A947-70E740481C1C}">'+'<a14:useLocalDpi xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main" val="0"/>'+'</a:ext>'+'</a:extLst>'+'</a:blip>'+'<a:stretch>'+'<a:fillRect/>'+'</a:stretch>'+'</p:blipFill>'+'<p:spPr>'+'<a:xfrm>'+'<a:off x="'+p.x+'" y="'+p.y+'"/>'+'<a:ext cx="'+p.cx+'" cy="'+p.cy+'"/>'+'</a:xfrm>'+'<a:prstGeom prst="rect">'+'<a:avLst/>'+'</a:prstGeom>'+'</p:spPr>'+'</p:pic>';s=s.replace(new RegExp("<p:sp>(?:(?!<p:sp>).)*Rectangle(?:(?!<p:sp>).)*"+p.name+".*?<\/p:sp>","g"),c);var o=jQuery.parseXML('<Relationship Id="rId'+i+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/'+'image'+i+"."+f+'"/>');var d=jQuery.parseXML(r);d.documentElement.appendChild(o.documentElement);return{SlideContent:s,RelsSlideContent:"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>"+_.serializeToString(d.documentElement).replace(R.EMPTY_NAMESPACE,"")};},_addProcessIndicator:function(i,s){var p=this._getImagePlaceholderDimensions(s,"{{PROCESS_INDICATOR}}");if(!p){return s;}var c=this._getProcessIndicator(i,p);s=s.replace(new RegExp("<p:sp>(?:(?!<p:sp>).)*Rectangle(?:(?!<p:sp>).)*"+p.name+".*?<\/p:sp>","g"),c);return s;},_addTitelImage:function(i,z,c,s,r){if(i.TITLE_IMAGE_ID){var p=this._getImagePlaceholderDimensions(s,"{{IDEA_TITLE_IMAGE}}");if(p){var f=i.TITLE_IMAGE_MEDIA_TYPE.indexOf("/")>-1?i.TITLE_IMAGE_MEDIA_TYPE.split("/")[1]:i.TITLE_IMAGE_MEDIA_TYPE;var d=new jQuery.Deferred();var o=new XMLHttpRequest();o.onreadystatechange=function(){if(o.readyState===4){if(o.status===200){var j=o.response||o.responseText;z.file("ppt/media/image"+c+"."+f,j);d.resolve();}else{d.resolve();}}};var A=C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_ATTACHMENT_TITLE_IMAGE_DOWNLOAD")+"/"+i.TITLE_IMAGE_ID;o.open("GET",A,true);o.responseType="arraybuffer";o.send(null);var e=this._addImage(c,p,f,s,r);e.ZIP=z;e.ImageDeferred=d;return e;}}var g;var B=i.NAME.indexOf(" ");if(B>-1){g=i.NAME.substring(0,Math.min(B,8));var h=i.NAME.substring(B+1);B=h.indexOf(" ");if(B>-1){g=g+"\n"+h.substring(0,Math.min(B,8));}else{g=g+"\n"+h.substring(0,8);}}else{g=i.NAME.substring(0,8);}g=this._getValidXMLString(g);return{ZIP:z,SlideContent:s.replace(R.IDEA_TITLE_IMAGE,g.toUpperCase()),RelsSlideContent:r};},_getMaxSlideId:function(r){var m=1;jQuery.each(r,function(i,s){var c=jQuery(s).attr('Id');try{var d=parseInt(c.substring(3),10);m=m<d?d:m;}catch(e){}});return m;},convertToFormatPPTX:function(E){var d=jQuery.Deferred();var t=this._getTemplate();var c=this;t.done(function(T){try{var z=J(T);var s=z.file("ppt/slides/slide1.xml").asText();var f=s.match(/{{\w*}}/g);z.remove("ppt/slides/slide1.xml");var r=z.file("ppt/slides/_rels/slide1.xml.rels").asText();z.remove("ppt/slides/_rels/slide1.xml.rels");var o=jQuery.parseXML(z.file("[Content_Types].xml").asText());var g=o.getElementsByTagName("Types")[0];var h=jQuery(o).find("[PartName='/ppt/slides/slide1.xml']")[0];g.removeChild(h);var p=z.file("ppt/presentation.xml").asText();var P=jQuery.parseXML(z.file("ppt/_rels/presentation.xml.rels").asText());var i=P.getElementsByTagName("Relationships")[0];var j=jQuery(i).find("[Target='slides/slide1.xml']")[0];i.removeChild(j);var k=c._getMaxSlideId(i.childNodes)+1;var l=c._getText("LIST_TIT_FILTER_CAMPAIGN_HEADER");var m=c._getText("LIST_TIT_FILTER_IDEA_HEADER");var n=c._getText("LIST_TIT_FILTER_PHASE_HEADER");var q=c._getText("LIST_TIT_FILTER_STATUS_HEADER");var A=c._getText("LIST_TIT_FILTER_AUTHOR_HEADER");var u=c._getText("LIST_TIT_FILTER_COACH_HEADER");var v=c._getText("IDEA_LIST_FLD_STATUS_CHANGE_REASON");var w=[];var N="";var O=400;jQuery.each(E,function(y,B){var G=s;var H=r;var K=B.SHORT_DESCRIPTION||"";if(K.length===500){K+="...";}K=c._getValidXMLString(K);var L=window.location.protocol+"//"+window.location.host+window.location.pathname+"#/idea/"+B.ID;var M=B.CAMPAIGN_COLOR||"ffffff";var Q=b.calculateMediaTextColor(M.substr(0,2),M.substr(2,2),M.substr(4,2)).slice(1);jQuery.each(f,function(Y,Z){switch(Z){case"{{IDEA_NAME}}":G=G.replace(new RegExp(Z,"g"),c._getValidXMLString(B.NAME));break;default:break;}});G=G.replace(R.CAMPAIGN_TEXT,l);G=G.replace(R.IDEA_TITLE,m);G=G.replace(R.PHASE_TEXT,n);G=G.replace(R.STATUS_TEXT,q);G=G.replace(R.COACH_TEXT,u);G=G.replace(R.AUTHOR_TEXT,A);G=G.replace(R.IDEA_SHORT_DESCRIPTION,K);G=G.replace(R.IDEA_PHASE,F.PHASE_FORMATTER(B.PHASE));G=G.replace(R.IDEA_STATUS,F.STATUS_FORMATTER(B.STATUS));G=G.replace(R.CAMPAIGN_NAME,c._getValidXMLString(B.CAMPAIGN_NAME));G=G.replace(R.COACH_NAME,B.COACH_NAME||"");G=G.replace(R.AUTHOR_NAME,B.SUBMITTER_NAME);G=G.replace(R.CAMPAIGN_COLOR,M.toUpperCase());G=G.replace(R.CAMPAIGN_TEXT_COLOR,Q.toUpperCase());G=G.replace(R.STATUS_CHANGE_REASON_TEXT,v);G=G.replace(R.STATUS_CHANGE_REASON,F.VALUE_OPTION(B.REASON_CODE));H=H.replace(R.IDEA_LINK,L);var U=c._addTitelImage(B,z,O,G,H);z=U.ZIP;G=U.SlideContent;H=U.RelsSlideContent;if(U.ImageDeferred){w.push(U.ImageDeferred);O++;}G=c._addProcessIndicator(B,G);z.file("ppt/slides/slide"+k+".xml",G);z.file("ppt/slides/_rels/slide"+k+".xml.rels",H);var V=h.cloneNode();jQuery(V).attr("PartName","/ppt/slides/slide"+k+".xml");g.appendChild(V);var W=O++;N=N+"<p:sldId id=\""+O++ +"\" r:id=\"rId"+W+"\"/>";var X=j.cloneNode();jQuery(X).attr("Id","rId"+W).attr("Target","slides/slide"+k+".xml");i.appendChild(X);k++;});z.remove("[Content_Types].xml");var x=c._addImageTypesToContentTypes(o);z.file("[Content_Types].xml",x);z.remove("ppt/presentation.xml");p=p.replace(new RegExp("<p:sldId [^>]*(r:)?id[^>]*(r:)?id[^>]*\/>","g"),N);z.file("ppt/presentation.xml",p);z.remove("ppt/_rels/presentation.xml.rels");z.file("ppt/_rels/presentation.xml.rels","<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>"+_.serializeToString(P.documentElement));jQuery.when.apply(jQuery,w).then(function(){d.resolve(z.generate({type:"blob"}));});}catch(e){d.reject(e.toString());}});return d.promise();}};});};if(!jQuery.sap.isDeclared('sap.ino.commons.util.ReportUtil')){jQuery.sap.declare('sap.ino.commons.util.ReportUtil');sap.ui.define("sap/ino/commons/util/ReportUtil",["sap/ino/commons/models/core/CodeModel","sap/ino/commons/application/Configuration"],function(C,a){"use strict";var R={};R.ReportViewType={Graphical:"GRAPHIC",Table:"TABLE"};R.getViewConfiguration=function(c){return c.Views[c.SelectedView];};R.getPropertyVisibility=function(v,p){if(v.Dimensions.indexOf(p)>-1||(v.SecondaryDimensions&&v.SecondaryDimensions.indexOf(p)>-1)||v.Measures.indexOf(p)>-1||(v.SecondaryMeasures&&v.SecondaryMeasures.indexOf(p)>-1)){return true;}return false;};R.createFilter=function(c,p,v){p=p===undefined?true:p;v=v===undefined?true:v;var V=this.getViewConfiguration(c);var f=[];if(p&&c.Parameters){var P=c.Parameters;jQuery.each(P,function(I,b){var d=[];for(var i=0;i<b.Selection.length;i++){d.push(new sap.ui.model.Filter(b.Key,"EQ",b.Selection[i]));}if(d.length>0){f.push(new sap.ui.model.Filter(d,false));}});}if(v&&V.Filter!==null&&V.Filter!==undefined){for(var F in V.Filter){var s=V.Filter[F];var o=new sap.ui.model.Filter(F,"EQ",s);f.push(o);}}return f;};R.checkMandatoryParameters=function(c){if(!c.Parameters){return true;}var m=true;jQuery.each(c.Parameters,function(i,p){if(p.Mandatory===true&&(p.Selection===undefined||p.Selection===null||p.Selection.length===0)){m=false;return;}});return m;};R.getRequestedAttributes=function(v,g){var r=[];if(g&&v.Graphic&&v.Graphic==="map"){r.push(v.Map.Longitude);r.push(v.Map.Latitude);r.push(v.Map.Granularity);}r=r.concat(v.Dimensions);if(v.SecondaryDimensions){r=r.concat(v.SecondaryDimensions);}r=r.concat(v.Measures);if(v.SecondaryMeasures){r=r.concat(v.SecondaryMeasures);}if(v.Sorters&&v.Sorters.length>=1){jQuery.each(v.Sorters,function(i,s){if(r.indexOf(s.columnKey)===-1){r.unshift(s.columnKey);}});}return r;};R.parseConfigToObject=function(r){if(r.CONFIG!==undefined&&r.CONFIG!==null){if(typeof r.CONFIG==="string"){r.CONFIG=JSON.parse(r.CONFIG);}}else{return r;}if(r.CAMPAIGN_ID){if(r.CONFIG.Parameters&&r.CONFIG.Parameters.Campaign){r.CONFIG.Parameters.Campaign.Selection=[r.CAMPAIGN_ID];r.CONFIG.Parameters.Campaign.SelectionString=r.CAMPAIGN_NAME;}}var g=sap.ino.commons.models.core.CodeModel.getFormatter("sap.ino.xs.object.analytics.ReportTemplate.Root");if(!r.CONFIG.Title){if(r.REPORT_TEMPLATE_CODE){r.CONFIG.Title=g(r.REPORT_TEMPLATE_CODE);}else if(r.CODE){r.CONFIG.Title=g(r.CODE);}else if(r.DEFAULT_TEXT){r.CONFIG.Title=r.DEFAULT_TEXT;}}if(!r.CONFIG.Description){if(r.REPORT_TEMPLATE_CODE){r.CONFIG.Description=g(r.REPORT_TEMPLATE_CODE);}else if(r.CODE){r.CONFIG.Description=g(r.CODE);}else if(r.DEFAULT_LONG_TEXT){r.CONFIG.Description=r.DEFAULT_LONG_TEXT;}}if(r.CONFIG.Views){R.deleteSorterInConfig(r.CONFIG);}return r;};R.deleteSorterInConfig=function(c){if(c&&c.Views){jQuery.each(c.Views,function(i,v){if(v.Sorter){v.Sorters=[{columnKey:v.Sorter.Path,operation:v.Sorter.Descending?"Descending":"Ascending"}];delete v.Sorter;}});}};R.parseConfigToString=function(r){if(r.CONFIG!==undefined&&r.CONFIG!==null){r.CAMPAIGN_ID=null;if(r.CONFIG.Parameters){var c=r.CONFIG.Parameters.Campaign.Selection;if(c!==undefined&&c!==null&&c.length===1){r.CAMPAIGN_ID=parseInt(c[0],10);}}if(typeof r.CONFIG==="object"){r.CONFIG=JSON.stringify(r.CONFIG);}}return r;};R.getAnnotationXML=function(c){var o=c.ODataPath||a.getApplicationPath("sap.ino.config.URL_PATH_OD_ANALYTICS");var v=c.Views[c.SelectedView];var s;try{s=v.Chart.Type.split("/")[1];s=s.charAt(0).toUpperCase()+s.slice(1);}catch(e){s="Column";}var x="<?xml version=\"1.0\" encoding=\"utf-8\"?>"+"<edmx:Edmx xmlns:edmx=\"http://docs.oasis-open.org/odata/ns/edmx\" Version=\"4.0\">"+"<edmx:Reference Uri=\"/"+o+"/$metadata\">"+"<edmx:Include Alias=\"ANALYTICSODATA\" Namespace=\"sap.ino.rest\" />"+"</edmx:Reference>"+"<edmx:DataServices>"+"<Schema xmlns=\"http://docs.oasis-open.org/odata/ns/edm\" Namespace=\"sap.ino.rest\">"+"<Annotations Target=\"sap.ino.rest."+c.DataSource+"Type\">"+"<Annotation Term=\"com.sap.vocabularies.UI.v1.Chart\">"+"<Record>"+"<PropertyValue Property=\"Title\" String=\""+v.DisplayName+"\" />"+"<PropertyValue Property=\"ChartType\" EnumMember=\"com.sap.vocabularies.UI.v1.ChartType/"+s+"\" />"+"<PropertyValue Property=\"Dimensions\">"+"<Collection>";jQuery.each(v.Dimensions,function(i,d){x+="<PropertyPath>"+d+"</PropertyPath>";});if(v.SecondaryDimensions){jQuery.each(v.SecondaryDimensions,function(i,d){x+="<PropertyPath>"+d+"</PropertyPath>";});}x+="</Collection>"+"</PropertyValue>"+"<PropertyValue Property=\"Measures\">"+"<Collection>";jQuery.each(v.Measures,function(i,m){x+="<PropertyPath>"+m+"</PropertyPath>";});if(v.SecondaryMeasures){jQuery.each(v.SecondaryMeasures,function(i,m){x+="<PropertyPath>"+m+"</PropertyPath>";});}x+="</Collection>"+"</PropertyValue>"+"</Record>"+"</Annotation>"+"</Annotations>"+"</Schema>"+"</edmx:DataServices>"+"</edmx:Edmx>";return x;};return R;});};if(!jQuery.sap.isDeclared('sap.ino.commons.util.SmartControl')){jQuery.sap.declare('sap.ino.commons.util.SmartControl');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.m.Label');sap.ui.define("sap/ino/commons/util/SmartControl",["sap/ui/base/ManagedObject","sap/ino/commons/models/aof/MetaModel","sap/ino/commons/models/core/CodeModel","sap/ino/commons/util/UIObjectConfig","sap/ui/core/ListItem","sap/m/Label"],function(M,b,C,U,L,c){"use strict";var S=function(){throw"May not be instantiated directly";};function g(n,a){if(!n||n==="Root"){return"/"+a;}else{return"/"+n+"/0/"+a;}}function d(m,n,a){if(m==="data"||!n||n==="Root"){return m+">"+a;}else{return m+">"+n+"/0/"+a;}}function e(o,n,a,A){if(A){return b.getProperty("/"+o+"/nodes/"+n+"/attributes/"+a+"/"+A.replace(/\./,"/"));}else{return b.getProperty("/"+o+"/nodes/"+n+"/attributes/"+a);}}function f(m,n,a,A){return m+">/meta/nodes/"+n+"/attributes/"+a+"/"+A.replace(/\./,"/");}function h(m,n,a,A){return m+">/property/nodes/"+n+"/attributes/"+a+"/"+A.replace(/\./,"/");}S.getCodeFormatter=function(o,n,a){var s=e(o,n,a,"foreignKeyTo");return C.getFormatter(s);};S.getCodeLongTextFormatter=function(o,n,a){var s=e(o,n,a,"foreignKeyTo");return C.getLongTextFormatter(s);};S.getValueOptionListFormatter=function(o,n,a){var v=e(o,n,a,"customProperties.valueOptionList");var s="sap.ino.xs.object.basis.ValueOptionList.Root_"+v;return C.getFormatter(s);};S.getValueOptionListLongTextFormatter=function(o,n,a){var v=e(o,n,a,"customProperties.valueOptionList");var s="sap.ino.xs.object.basis.ValueOptionList.Root_"+v;return C.getLongTextFormatter(s);};S.getOpenObjectFormatter=function(o,O,n,a){var F=e(O,n,a,"foreignKeyTo");var u=U.getDefinition(F);return function(k){if(k&&u.navigation&&u.navigation.path&&u.navigation.key&&o.getOwnerComponent()){var p={};p[u.navigation.key]=k;return o.getOwnerComponent().getNavigationLink(u.navigation.path,p);}else{return"javascript:void(0);";}};};S.getQuickViewPressedHandler=function(o,m,O,n,a){var F=e(O,n,a,"foreignKeyTo");var u=U.getDefinition(F);var q;return function(E){if(!u.quickView){return;}var s=E.getSource();if(s){var v=s.getBindingContext(m)&&s.getBindingContext(m).getProperty(a);if(v!==undefined&&!q){q=sap.ui.xmlview({viewName:u.quickView});o.getView().addDependent(q);}if(q&&q.getController()){q.getController().open(s,v);}}};};S.bindToCode=function(o,a,m,O,n,A){var r=e(O,n,A,"required");var s=e(O,n,A,"foreignKeyTo");var N=e(O,n,A,"customProperties.noEmptyCode");_(o,a,m,O,n,A,s,!r&&!N);};S.bindToValueOptionList=function(o,a,m,O,n,A){var r=e(O,n,A,"required");var v=e(O,n,A,"customProperties.valueOptionList");var N=e(O,n,A,"customProperties.noEmptyCode");var s="sap.ino.xs.object.basis.ValueOptionList.Root_"+v;_(o,a,m,O,n,A,s,!r&&!N);};function _(o,a,m,O,n,A,s,i){if(a.getMetadata().getAllProperties().selectedKey){if(!a.getBindingInfo("selectedKey")){var I=new L({key:{path:"code>CODE"},text:{path:"code>CODE",formatter:C.getFormatter(s)},tooltip:{path:"code>CODE",formatter:C.getLongTextFormatter(s)}});a.bindProperty("selectedKey",{path:d(m,n,A)});a.bindAggregation("items",{path:"code>/"+s,template:I,sorter:{path:'CODE'},parameters:i?{includeEmptyCode:true}:undefined});}}else if(a.getMetadata().getAllProperties().text){if(!a.getBindingInfo("text")){a.bindProperty("text",{path:d(m,n,A),formatter:C.getFormatter(s)});}}};S.bindToForeignKey=function(o,a,m,O,n,A){var D=o.getModel("data")||(o.getOwnerComponent()&&o.getOwnerComponent().getModel("data"))||a.getModel("data");var F=e(O,n,A,"foreignKeyTo");var u=U.getDefinition(F);if(a.getMetadata().getAllProperties().value){if(!a.getBindingInfo("value")){var s=g(n,A);a.bindProperty("value",{path:d(m,n,A),formatter:function(v){var r="";if(v){jQuery.ajax({url:D.sServiceUrl+"/"+u.instancePath+"("+v+")"+"/"+u.selectionField+"/$value",async:false,success:function(i){r=i;}});}return r;}});a.setShowSuggestion(true);a.bindProperty("placeholder","i18n>GENERIC_CONTROL_TYPE_TO_SELECT");a.setFilterFunction(function(v,i){return true;});a.attachSuggest(function(E){var v=E.getParameter("suggestValue");var t=new L({text:"{data>"+u.selectionField+"}",additionalText:"{data>"+u.secondarySelectionField+"}",key:"{data>"+u.selectionKey+"}"});E.getSource().bindAggregation("suggestionItems",{path:"data>"+U.getSearchPath(F,v),template:t,parameters:u.parameters});});a.attachLiveChange(function(E){a.getModel(m).setProperty(s,null);});a.attachSuggestionItemSelected(function(E){var i=E.getParameters().selectedItem;if(!i){var r=jQuery.grep(a.getSuggestionItems(),function(j){return j.getText()===a.getValue();});if(r.length>0){i=r[0];}}if(i){var k=i&&parseInt(i.getKey(),10);a.getModel(m).setProperty(s,k);var N=i.getText();a.setValue(N);}else{a.setValue("");}a.focus();});a.attachSubmit(function(E){var i;var r=jQuery.grep(a.getSuggestionItems(),function(j){return j.getText()===E.getParameter("value");});if(r.length>0){i=r[0];}if(i){var k=i&&parseInt(i.getKey(),10);a.getModel(m).setProperty(s,k);}else{a.getModel(m).setProperty(s,null);a.setValue("");}a.focus();});a.addEventDelegate({onfocusout:function(E){if(a.getModel(m).getProperty(s)===null){var i;var r=jQuery.grep(a.getSuggestionItems(),function(j){return j.getText()===a.getValue();});if(r.length>0){i=r[0];}if(i){var k=i&&parseInt(i.getKey(),10);a.getModel(m).setProperty(s,k);}else{a.setValue("");}}}});}}else if(a.getMetadata().getAllProperties().text){if(!a.getBindingInfo("text")){a.bindProperty("text",{path:d(m,n,A),formatter:function(v){var r="";if(v){jQuery.ajax({url:D.sServiceUrl+"/"+u.instancePath+"("+v+")"+"/"+u.selectionField+"/$value",async:false,success:function(i){r=i;}});}return r;}});}if(typeof a.attachPress==="function"&&u.quickView){a.attachPress(S.getQuickViewPressedHandler(o,m,O,n,A));}else if(a.getMetadata().getAllProperties().href&&!a.getBindingInfo("href")){if(u.navigation&&u.navigation.path&&u.navigation.key){a.bindProperty("href",{path:d(m,n,A),formatter:S.getOpenObjectFormatter(o,O,n,A)});}}}};S.bindAll=function(o,j,m,O,N){function F(k,m,O,N){for(var n in k.mAggregations){var a=k.mAggregations[n];if(jQuery.isArray(a)){for(var i=0;i<a.length;i++){v(a[i],m,O,N);}}else if(a instanceof M){v(a,m,O,N);}}}function v(j,m,O,N){if(j.data("aofModel")){m=j.data("aofModel");}if(j.data("aofObject")){O=j.data("aofObject");}if(j.data("aofNode")){N=j.data("aofNode");}S.bind(o,j,m,O,N);F(j,m,O,N);}v(j,m,O,N);};S.bind=function(o,a,m,O,n){if(!a.data("aofAttribute")){return;}var i=o.getModel("i18n")||(o.getOwnerComponent()&&o.getOwnerComponent().getModel("i18n"))||a.getModel("i18n");var j;if(i){j=i.getResourceBundle();}if(a.data("aofModel")){m=a.data("aofModel");}m=m||"data";if(a.data("aofObject")){O=a.data("aofObject");}if(a.data("aofNode")){n=a.data("aofNode");}n=n||"Root";var A=a.data("aofAttribute");var u=a.data("aofUseValue");var l=a.data("aofColon");if(a.getMetadata().getAllProperties().required&&m!=="data"){a.bindProperty("required",{path:f(m,n,A,"required")});}if(j&&typeof a.setTooltip==="function"){a.setTooltip(j.getText(O+"."+n+"."+A));}var F=e(O,n,A,"foreignKeyTo");if(F&&(a.getMetadata().getAllProperties().value||a.getMetadata().getAllProperties().selectedKey||(a.getMetadata().getAllProperties().text&&!(a instanceof c&&!u)))){if(!!U.getDefinition(F)){S.bindToForeignKey(o,a,m,O,n,A);}else{S.bindToCode(o,a,m,O,n,A);}}else{var v=e(O,n,A,"customProperties.valueOptionList");if(v&&(a.getMetadata().getAllProperties().selectedKey||(a.getMetadata().getAllProperties().text&&!(a instanceof c&&!u)))){S.bindToValueOptionList(o,a,m,O,n,A);}else{if(a.getMetadata().getAllProperties().selected&&!a.getBindingInfo("selected")){a.bindProperty("selected",{path:d(m,n,A)});}else if(a.getMetadata().getAllProperties().text&&!a.getBindingInfo("text")){if(a instanceof c&&!u){a.bindProperty("text",{path:"i18n>"+O+"."+n+"."+A,formatter:function(t){return t+(l?": ":"");}});a.addStyleClass("sapInoLabelSpace");}else{a.bindProperty("text",{path:d(m,n,A),});}}else if(a.getMetadata().getAllProperties().value&&!a.getBindingInfo("value")){a.bindProperty("value",{path:d(m,n,A)});}if(m!=="data"){if(a.getMetadata().getAllProperties().maxLength&&!a.getBindingInfo("maxLength")){a.bindProperty("maxLength",{path:f(m,n,A,"maxLength")});}if(a.getMetadata().getAllProperties().min&&!a.getBindingInfo("min")){a.bindProperty("min",{path:f(m,n,A,"minValue")});}if(a.getMetadata().getAllProperties().max&&!a.getBindingInfo("max")){a.bindProperty("max",{path:f(m,n,A,"maxValue")});}}}}if(m!=="data"){if(a.getMetadata().getAllProperties().enabled){if(!a.getBindingInfo("enabled")){a.bindProperty("enabled",{path:h(m,n,A,"changeable")});}}else if(a.getMetadata().getAllProperties().editable){if(!a.getBindingInfo("editable")){a.bindProperty("editable",{path:h(m,n,A,"changeable")});}}}};return S;});};if(!jQuery.sap.isDeclared('sap.ino.controls.CommentRichTxtEditor')){jQuery.sap.declare('sap.ino.controls.CommentRichTxtEditor');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.richtexteditor.RichTextEditor');sap.ui.define("sap/ino/controls/CommentRichTxtEditor",["jquery.sap.global","sap/ui/richtexteditor/RichTextEditor","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/Attachment"],function(q,R,C,A){"use strict";var a=R.extend("sap.ino.controls.CommentRichTxtEditor",{metadata:{properties:{saveText:{type:"string",group:"Data",defaultValue:''},saveIcon:{type:"string",group:"Data",defaultValue:'save'},saveTooltip:{type:"string",group:"Data",defaultValue:''},failureMsg:{type:"string",group:"Data",defaultValue:''}}},constructor:function(s){var t=this;var S=q.extend(true,{width:"100%",editable:true,editorType:sap.ui.richtexteditor.EditorType.TinyMCE4,showGroupInsert:true,showGroupLink:true,showGroupFont:true,showGroupClipboard:false,showGroupStructure:false,useLegacyTheme:false,beforeEditorInit:function(c){c.mParameters.configuration.powerpaste_word_import="clean";c.mParameters.configuration.powerpaste_html_import="clean";c.mParameters.configuration.image_advtab=false;c.mParameters.configuration.paste_data_images=true;c.mParameters.configuration.automatic_uploads=true;c.mParameters.configuration.images_reuse_filename=false;c.mParameters.configuration.image_title=true;c.mParameters.configuration.file_picker_types='image';c.mParameters.configuration.default_link_target="_blank";c.mParameters.configuration.toolbar="fontsizeselect | "+c.mParameters.configuration.toolbar.join(" | ").replace("image","image emoticons ").replace("| alignleft aligncenter alignright alignjustify","");c.mParameters.configuration.images_upload_handler=function(f,b,d){var F=f.blob();if(F){A.uploadFile(F).done(function(r){b("/"+C.getSystemSetting("sap.ino.config.URL_PATH_XS_ATTACHMENT_DOWNLOAD")+"/"+r.attachmentId);}).fail(function(){d(t.getFailureMsg());});}};c.mParameters.configuration.file_picker_callback=function(b,v,m){var i=document.createElement('input');i.setAttribute('type','file');i.setAttribute('accept','image/*');i.onchange=function(){var f=this.files[0];var r=new FileReader();r.onload=function(){var d='blobid'+(new Date()).getTime();var e=window.tinymce.activeEditor.editorUpload.blobCache;var g=r.result.split(',')[1];var h=e.create(d,f,g);e.add(h);b(h.blobUri(),{title:f.name});};r.readAsDataURL(f);};i.click();};}},s);R.apply(t,[S]);},renderer:"sap.ui.richtexteditor.RichTextEditorRenderer"});a.prototype.init=function(){R.prototype.init.call(this);this.setButtonGroups([{name:"font-style",visible:true,row:0,priority:10,buttons:["bold","italic","underline","strikethrough"]},{name:"undo",visible:true,row:0,priority:40,buttons:["undo","redo"]},{name:"insert",visible:false,row:0,priority:50,buttons:["image"]},{name:"link",visible:false,row:0,priority:60,buttons:["link","unlink"]}]);this.removePlugin("paste");this.removePlugin("lists");this.removePlugin("text-align");this.removePlugin("directionality");this.removePlugin("textpattern");};return a;});};if(!jQuery.sap.isDeclared('sap.ino.vc.attachment.AttachmentMixin')){jQuery.sap.declare('sap.ino.vc.attachment.AttachmentMixin');jQuery.sap.require('sap.m.UploadCollectionParameter');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/attachment/AttachmentMixin",["sap/ino/commons/application/Configuration","sap/m/UploadCollectionParameter","sap/ino/commons/models/object/Attachment","sap/m/MessageToast"],function(C,U,A,M){"use strict";var a=function(){throw"Mixin may not be instantiated directly";};a._attachmentMixinInit=function(s){this._attachmentMixinSetting=s;var o=this.byId(this._attachmentMixinSetting.attachmentId);var b=this.getView().byId(this._attachmentMixinSetting.attachmentId);if(!o.getUploadEnabled()){o.addStyleClass("sapInoAttachmentUploadInvisible");}b.addEventDelegate({onAfterRendering:jQuery.proxy(function(){this.setAccessibility();},this)});};a.attachmentMixinOnChange=function(e){var u=e.getSource();var c=new U({name:"x-csrf-token",value:C.getXSRFToken()});u.addHeaderParameter(c);};a.attachmentMixinonFileDeleted=function(e){var i=e.getParameter("item");var o=this.getModel("object");o.removeAttachment(parseInt(i.getDocumentId(),10));this._attachmentMixinSetting.updateObject(o);};a.attachmentMixinonBeforeUploadStarts=function(e){var c=new U({name:"unicode_filename",value:A.stringToUnicode(e.getParameter("fileName"))});e.getParameters().addHeaderParameter(c);};a.attachmentMixinonUploadComplete=function(e){var t=this;var o=this.getModel("object");var f=e.getParameter("files");if(f.length>0){var E=false;f.forEach(function(F){var r=A.parseUploadResponse(F.responseRaw);o.getMessageParser().parse(r);if(r){if(r.success){E=t._attachmentMixinSetting.uploadSuccess(o,r);}else{M.show(t.getText("OBJECT_MSG_ATTACHMENT_FAILED"));E=true;}}else{M.show(t.getText("OBJECT_MSG_ATTACHMENT_ERROR"));E=true;}});if(E){var u=this.getView().byId(this._attachmentMixinSetting.attachmentId);u.aItems=[];u.rerender();}}};a.setAccessibility=function(){var v=this.getView();var e=v.byId(this._attachmentMixinSetting.attachmentId).$();var i=e.find('.sapMListNoData');var l=e.find('.sapMListModeNone ');if(i.length){l.hide();l.siblings().attr('tabindex','-1');}};return a;});};if(!jQuery.sap.isDeclared('sap.ino.vc.comment.RichCommentAttachmentMixin')){jQuery.sap.declare('sap.ino.vc.comment.RichCommentAttachmentMixin');jQuery.sap.require('sap.ui.unified.FileUploaderParameter');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.UploadCollection');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/ino/vc/comment/RichCommentAttachmentMixin",["sap/ino/commons/application/Configuration","sap/ui/unified/FileUploaderParameter","sap/ino/commons/models/object/Attachment","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/m/UploadCollection","sap/ui/Device"],function(C,F,A,M,J,U,D){"use strict";var R=function(){throw"Mixin may not be instantiated directly";};R.richAttachmentMixinInit=function(){this._attachmentCtlSetting={listId:"commentAttachmentList",uploaderId:"commentAttachmentUploader"};if(!this.getBlockView().getModel("local")){this.setModel(new J({ATTACHMENT_UPLOAD_URL:A.getEndpointURL()}),"local");}var a=this.byId(this._attachmentCtlSetting.listId);var b=this.getBlockView().byId(this._attachmentCtlSetting.listId);if(!a.getUploadEnabled()){a.addStyleClass("sapInoAttachmentUploadInvisible");}b.addEventDelegate({onAfterRendering:jQuery.proxy(function(){this.setRichAttachmentAccessibility();},this)});};R.onRichCommentFileUploaderChange=function(e){var f=e.getSource();var a=e.getParameter("files");f.setBusy(true);A.prepareFileUploader(f,a);};R.onRichCommentFileUploaderComplete=function(e){var r=A.parseUploadResponse(e.getParameter("responseRaw"));var f=e.getSource();if(r){var o=this.getObjectModel();o.getMessageParser().parse(r);if(r.success){o.setTitleImage({"ATTACHMENT_ID":r.attachmentId,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType});}else{M.show(this.getText("MSG_COMMENT_ATTACHMENT_IMAGE_FAILED"));}}else{M.show(this.getText("MSG_COMMENT_ATTACHEMENT_IMAGE_ERROR"));}f.setBusy(false);f.clear();};R.richAttachmentMixinOnChange=function(e){var u=e.getSource();var c=new F({name:"x-csrf-token",value:C.getXSRFToken()});u.removeAllAggregation("headerParameters",true);u.addHeaderParameter(c);this._onRichCommentChange(e);};R._onRichCommentChange=function(e){if(!e){return;}var t=this;var r,c,i,f,I,s;if(D.browser.msie&&D.browser.version<=9){var n=e.getParameter("newValue");if(!n){return;}f=n.split(/\" "/)[0];if(f.length===0){return;}}else{c=e.getParameter("files").length;if(c===0){return;}}var a=t.byId(this._attachmentCtlSetting.listId),u=t.byId(this._attachmentCtlSetting.uploaderId);var p=a.getAggregation("parameters");if(p){jQuery.each(p,function(b,d){var P=new sap.ui.unified.FileUploaderParameter({name:d.getProperty("name"),value:d.getProperty("value")});u.addParameter(P);});}s=U._uploadingStatus;if(D.browser.msie&&D.browser.version<=9){I=new sap.m.UploadCollectionItem({fileName:f});I._status=s;I._internalFileIndexWithinFileUploader=1;I._percentUploaded=0;a.aItems.unshift(I);}else{a._requestIdValue=a._requestIdValue+1;r=a._requestIdValue.toString();var h=a.getAggregation("headerParameters");for(i=0;i<c;i++){I=new sap.m.UploadCollectionItem({fileName:e.getParameter("files")[i].name});I._status=s;I._internalFileIndexWithinFileUploader=i+1;I._requestIdName=r;I._percentUploaded=0;a.aItems.unshift(I);}if(h){jQuery.each(h,function(b,d){u.addHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:d.getProperty("name"),value:d.getProperty("value")}));});}u.addHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:a._headerParamConst.requestIdName,value:r}));}a.invalidate();};R.richAttachmentMixinonFileDeleted=function(e){var i=e.getParameter("item");var o=this.getBlockView().getModel("comment");o.removeAttachment(parseInt(i.getDocumentId(),10));};R.richAttachmentMixinonBeforeUploadStarts=function(e){var c=new F({name:"unicode_filename",value:A.stringToUnicode(e.getParameter("fileName"))});e.getParameter("requestHeaders").push(c);};R.richAttachmentMixinonUploadProgress=function(e){if(!e){return;}var a=this.byId(this._attachmentCtlSetting.listId);var i,p,P,r,c,o,I,$;r=a._getRequestId(e);P=Math.round(e.getParameter("loaded")/e.getParameter("total")*100);if(P===100){p=a._oRb.getText("UPLOADCOLLECTION_UPLOAD_COMPLETED");}else{p=a._oRb.getText("UPLOADCOLLECTION_UPLOADING",[P]);}c=a.aItems.length;for(i=0;i<c;i++){if(a.aItems[i]._requestIdName===r&&a.aItems[i]._status===U._uploadingStatus){o=sap.ui.getCore().byId(a.aItems[i].getId()+"-ta_progress");if(!o){continue;}o.setText(p);a.aItems[i]._percentUploaded=P;I=a.aItems[i].getId();$=jQuery.sap.byId(I+"-ia_indicator");if(P===100){$.attr("aria-label",p);}else{$.attr("aria-valuenow",P);}break;}}};R._onRichCommentUploadComplete=function(e){var t=this;var o=this.getBlockView().getModel("comment");var f=[{fileName:e.getParameter("fileName"),responseRaw:e.getParameter("responseRaw"),reponse:e.getParameter("response"),status:e.getParameter("status"),headers:e.getParameter("headers")}];if(f.length>0){var E=false;f.forEach(function(a){var r=A.parseUploadResponse(a.responseRaw);o.getMessageParser().parse(r);if(r){if(r.success){E=t.uploadRichAttachmentSuccess(o,r);}else{M.show(t.getText("OBJECT_MSG_ATTACHMENT_FAILED"));E=true;}}else{M.show(t.getText("OBJECT_MSG_ATTACHMENT_ERROR"));E=true;}});if(E){var u=this.byId(this._attachmentCtlSetting.listId);u.aItems=[];u.rerender();}}};R.richAttachmentMixinonUploadComplete=function(e){if(!e){return;}var u=this.byId(this._attachmentCtlSetting.listId);var i,r,s,c,b=d();r=u._getRequestId(e);s=e.getParameter("fileName");if(!s){var a=(e.getSource().getProperty("value")).split(/\" "/);s=a[0];}c=u.aItems.length;for(i=0;i<c;i++){if(!r){if(u.aItems[i]._status===U._uploadingStatus&&b){u.aItems[i]._percentUploaded=100;u.aItems[i]._status=U._displayStatus;u._oItemToUpdate=null;break;}else if(u.aItems[i]._status===U._uploadingStatus){u.aItems.splice(i,1);u._oItemToUpdate=null;break;}}else if(u.aItems[i]._requestIdName===r&&u.aItems[i]._status===U._uploadingStatus&&b){u.aItems[i]._percentUploaded=100;u.aItems[i]._status=U._displayStatus;u._oItemToUpdate=null;break;}else if(u.aItems[i]._requestIdName===r&&u.aItems[i]._status===U._uploadingStatus||u.aItems[i]._status===U._pendingUploadStatus){u.aItems.splice(i,1);u._oItemToUpdate=null;break;}}this._onRichCommentUploadComplete(e);u.invalidate();function d(){var f=e.getParameter("status").toString()||"200";if(f[0]==="2"||f[0]==="3"){return true;}else{return false;}}};R.setRichAttachmentAccessibility=function(){var v=this.getBlockView();var e=v.byId(this._attachmentCtlSetting.listId).$();var i=e.find('.sapMListNoData');var l=e.find('.sapMListModeNone ');if(i.length){l.hide();l.siblings().attr('tabindex','-1');}};R.uploadRichAttachmentSuccess=function(o,r){o.addAttachment({"CREATED_BY_NAME":C.getCurrentUser().NAME,"ATTACHMENT_ID":r.attachmentId,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType,"CREATED_AT":new Date()});};R.onRichCmtImgPressed=function(e){sap.m.URLHelper.redirect(e.oSource.getProperty("src"),true);};R.onRichCmtIconPressed=function(e){var i=e.oSource.oParent.getItems();if(i&&i.length>=2){sap.m.URLHelper.redirect(i[2].getProperty("href"),true);}};R.addSomeMethodIntoModel=function(m){m.addAttachment=function(n){n.ROLE_TYPE_CODE="ATTACHMENT";this.addChild(n,"Attachments");};m.removeAttachment=function(i){var a=jQuery.grep(this.getProperty("/Attachments")||[],function(o){return o.ID===i;});var f=a&&a[0];if(f){this.removeChild(f);}};};return R;});};if(!jQuery.sap.isDeclared('sap.ino.vc.comment.RichCommentCntrlMixin')){jQuery.sap.declare('sap.ino.vc.comment.RichCommentCntrlMixin');jQuery.sap.require('sap.m.Text');sap.ui.define("sap/ino/vc/comment/RichCommentCntrlMixin",["sap/ino/controls/CommentRichTxtEditor","sap/m/Text","sap/ino/commons/application/Configuration"],function(C,T,a){"use strict";var R=function(){throw"Mixin may not be instantiated directly";};R._DIC_NEW_TITLE_LIST_={"sap.ino.commons.models.object.IdeaComment":{"title":"COMMENT_OBJECT_NEW_COMMENT_TIT"}};R._destroyRTECtrl=function(c){var r=this.byId(c);if(r){r.destroy();}};R._initRTE=function(s){var c=this;var r=c._getRTEContainer();var o;if(c._commentMixinSettings.type==="comment"){if(r&&r.getItems().length>1){r.removeItem(r.getItems()[1]);}this._destroyRTECtrl(this._commentControlId);this._commentControlId="commentControl"+new Date().getTime();o=new C({id:c.createId(this._commentControlId),editable:{parts:[{path:'data>COMMENT_HAS_PRIVILEGE'},{path:'data>PARTICIPANT_CAN_COMMENT'},{path:'data>OPEN_STATUS_SETTING'}],formatter:function(i,b,O){return c.formatter.commentEnabled(i,b,O);}},height:"200px"});}else if(c._commentMixinSettings.type==="comment_reply"){if(r&&r.getItems().length>0){r.removeItem(r.getItems()[0]);}this._destroyRTECtrl(this._commentReplyControlId);this._commentReplyControlId="commentReplyControl"+new Date().getTime();o=new C({id:c.createId(this._commentReplyControlId),editable:{parts:[{path:'data>COMMENT_HAS_PRIVILEGE'},{path:'data>PARTICIPANT_CAN_COMMENT'},{path:'data>OPEN_STATUS_SETTING'}],formatter:function(i,b,O){return c.formatter.commentEnabled(i,b,O);}},height:"200px"});}else{if(r&&r.getItems().length>0){r.removeItem(r.getItems()[0]);}this._destroyRTECtrl(this._internalControlId);this._internalControlId="internalControl"+new Date().getTime();o=new C({id:c.createId(this._internalControlId),height:"200px"});}o.attachReady(function onRTEReady(){c.commentMixinForceInitCommentModel();this.bindProperty("value",{model:"comment",path:"/COMMENT"});c._changePosHandleForTinyMce();});if(!c._TITLE_TXT&&c.getBlockView().data("modelObjectType")&&c._DIC_NEW_TITLE_LIST_[c.getBlockView().data("modelObjectType")]){r.insertItem(new T({text:c.getText(c._DIC_NEW_TITLE_LIST_[c.getBlockView().data("modelObjectType")].title)}),0);c._TITLE_TXT=true;}r.addItem(o);};R._getRTEContainer=function(){return this.byId(this._commentMixinSettings.commentContainerId);};R._getImgIds=function(c){if(!c){return[];}var u=this._getAttachmentDownloadUrl();if(!u){return[];}var r=new RegExp(u.substr(u.lastIndexOf("/")+1)+"/(\\d+)","ig");var b=[];var m=r.exec(c);while(m){b.push({ATTACHMENT_ID:Number(m[1])});m=r.exec(c);}return b;};R._getAttachmentDownloadUrl=function(){var u=a.getSystemSetting("sap.ino.config.URL_PATH_XS_ATTACHMENT_DOWNLOAD");if(u){return u.substr(u.lastIndexOf("/")+1);}return"";};R._changePosHandleForTinyMce=function(){var c=this;if(window.tinyMCE&&window.tinyMCE.dom&&window.tinyMCE.dom.DOMUtils&&window.tinyMCE.dom.DOMUtils.prototype.getPos){window.tinyMCE.dom.DOMUtils.prototype.getPos=function(e,r){return c._getPosForTinyMce.call(window.tinyMCE.dom.DOMUtils.DOM,e,r);};}};R._getPosForTinyMce=function(e,r){var s=this,x=0,y=0,o,d=s.doc,b=d.body,p,t="none";e=s.get(e);r=r||b;if(e){if(r===b&&e.getBoundingClientRect&&$(b).css('position')==='static'){p=e.getBoundingClientRect();r=s.boxModel?d.documentElement:b;x=p.left+(d.documentElement.scrollLeft||b.scrollLeft)-r.clientLeft;y=p.top+(d.documentElement.scrollTop||b.scrollTop)-r.clientTop;return{x:x,y:y};}o=e;while(o&&o!==r&&o.nodeType){x+=o.offsetLeft||0;y+=o.offsetTop||0;if(o.translate&&getComputedStyle(o).transform!=="none"){t=getComputedStyle(o).transform.split("(")[1].split(")")[0].split(",");x+=Number(t[4])||0;y+=Number(t[5])||0;}o=o.offsetParent;}o=e.parentNode;while(o&&o!==r&&o.nodeType){x-=o.scrollLeft||0;y-=o.scrollTop||0;o=o.parentNode;}}return{x:x,y:y};};return R;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.BaseController')){jQuery.sap.declare('sap.ino.vc.commons.BaseController');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.ui.core.message.ControlMessageProcessor');jQuery.sap.require('sap.m.InputBase');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.resource.ResourceModel');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.m.MultiInput');jQuery.sap.require('sap.m.Select');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.m.ComboBox');sap.ui.define("sap/ino/vc/commons/BaseController",["sap/ino/commons/formatters/BaseFormatter","sap/ui/core/mvc/Controller","sap/ui/core/message/ControlMessageProcessor","sap/m/InputBase","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/core/UIComponent","sap/ui/Device","sap/ino/commons/application/Configuration","sap/ui/core/ListItem","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/MessageType","sap/m/MultiInput","sap/ino/commons/util/UIObjectConfig","sap/m/Select","sap/ino/commons/util/SmartControl","sap/ui/core/ResizeHandler","sap/m/ComboBox","sap/ino/commons/models/aof/MetaModel"],function(B,C,a,I,J,R,U,D,b,L,M,c,d,e,f,S,g,h,j,k){k.getBackendAllMetadata();return C.extend("sap.ino.vc.commons.BaseController",{formatter:B,aBusyControls:[],onInit:function(){sap.ui.getCore().getMessageManager().registerObject(this.getView(),true);this._previousClientMessages=[];this._controlMessageProcessor=new a();if(C.prototype.onInit){C.prototype.onInit.apply(this,arguments);}if(this._onInit){this._onInit();}if(!this.getModel("view")){this.setModel(new J({Layouts:{SimpleFormLayout:{labelSpanL:12,labelSpanM:12,emptySpanL:1,emptySpanM:1,breakpointL:1024,breakpointM:600,layout:"ResponsiveGridLayout"}}}),"view");}this.setObjectExists(true);if(this.getOwnerComponent()){this.setModel(this.getOwnerComponent().getModel("component"),"component");}var o=this.getView().data();if(!o.aofSmartControl&&this.getView().getContent()){o=this.getView().getContent()[0].data();}if(o.aofSmartControl){g.bindAll(this,this.getView());}},onAfterRendering:function(){var p=b.getPersonalize();if(p&&p.SCREEN_SIZE){this.setFullScreen(p.SCREEN_SIZE);}},onExit:function(){if(this._onExit){this._onExit();}var v=this.getModel("view");if(v){v.destroy();}if(C.prototype.onExit){C.prototype.onExit.apply(this,arguments);}},destroy:function(){C.prototype.destroy.apply(this.arguments);},getCurrentRoute:function(){return this.getOwnerComponent().getCurrentRoute();},getBusyControls:function(){return this.aBusyControls;},getDensityClass:function(){if(jQuery("body").hasClass("sapUiSizeCozy")){return"sapUiSizeCozy";}else{return"sapUiSizeCompact";}},createView:function(v){var V;this.getOwnerComponent().runAsOwner(function(){V=sap.ui.view(v);});return V;},getLocalElementId:function(E){var i=E.getId();var l=i.split("--");return l[l.length-1];},createFragment:function(F,s){var o=this;var i;this.getOwnerComponent().runAsOwner(function(){if(!s){i=sap.ui.xmlfragment(o.getView().getId(),F,o);}else{i=sap.ui.xmlfragment(s,F,o);}o.onFragmentCreated(F,i);});return i;},getFragment:function(F,s){if(!this._mFragmentCache){this._mFragmentCache={};}if(!this._mFragmentCache[F]){this._mFragmentCache[F]=this.createFragment(F,s);}return this._mFragmentCache[F];},onFragmentCreated:function(F,o){if(jQuery.type(o)==="object"&&o.data("aofSmartControl")){g.bindAll(this,o);}},setViewData:function(v,m){this.getModel("view").setData(v,m);},setViewProperty:function(p,v){return this.getModel("view").setProperty(p,v);},getViewProperty:function(p){return this.getModel("view").getProperty(p);},setObjectExists:function(o){this.setViewProperty("/objectExists",o);},getObjectExists:function(){return this.getViewProperty("/objectExists");},onNavBack:function(){this.getOwnerComponent().getRouter().onNavBack();},onDeleteNavBack:function(o,r){this.getOwnerComponent().getRouter().onDeleteNavBack(o,r);},navigateBack:function(){this.onNavBack();},navigateTo:function(t,o,r,n){this.getOwnerComponent().navigateTo(t,o,r,n);},navigateToWall:function(t,o,r,n){t=(t==="wall"&&D.system.phone)?"wallremote":t;this.getOwnerComponent().navigateTo(t,o,r,n);},navigateToExternal:function(t,o){this.getOwnerComponent().navigateToExternal(t,o);},navigateToByURL:function(u){this.getOwnerComponent().navigateToByURL(u);},navigateToInNewWindow:function(t,o){this.getOwnerComponent().navigateToInNewWindow(t,o);},navigateToByURLInNewWindow:function(u){this.getOwnerComponent().navigateToByURLInNewWindow(u);},getRouter:function(){return U.getRouterFor(this);},getOwnerComponent:function(){if(this._oComponent){return this._oComponent;}this._oComponent=C.prototype.getOwnerComponent.apply(this,arguments);if(this._oComponent){return this._oComponent;}var v=this.getView();while(v.getParent()){v=v.getParent();this._oComponent=v.getController&&v.getController().getOwnerComponent();if(this._oComponent){break;}}return this._oComponent;},setBusy:function(i){this.getView().setBusy(i);},getBusy:function(){this.getView().getBusy();},_getTextModel:function(){if(!this._i18n){this._i18n=this.getOwnerComponent()&&this.getOwnerComponent().getModel("i18n");}return this._i18n;},getText:function(t,p){if(this._getTextModel()){return this._getTextModel().getResourceBundle().getText(t,p);}},hasOwnModel:function(m){return!!this.getView().oModels[m];},getDefaultODataModel:function(){return this.getOwnerComponent().getModel("data");},getModel:function(n){return this.getView().getModel(n);},setModel:function(m,n){return this.getView().setModel(m,n);},_onBindingChange:function(){var E=this.getView().getElementBinding();if(E&&!E.getBoundContext()){this.getOwnerComponent().getRouter().getTargets().display("notFound");}},setViewFocus:function(){var t=this;setTimeout(function(){if(!sap.ui.getCore().getCurrentFocusedControlId()){var o;if(jQuery.type(t.initialFocus)==="string"){o=t.byId(t.initialFocus);if(o&&o.$()&&o.$().is(":visible")&&jQuery.type(o.focus)==="function"){o.focus();}}else if(jQuery.type(t.initialFocus)==="array"){for(var i=0;i<t.initialFocus.length;i++){o=t.byId(t.initialFocus[i]);if(o&&o.$()&&o.$().is(":visible")&&jQuery.type(o.focus)==="function"){o.focus();break;}}}}},100);},toggleFullScreen:function(){var m=this.getOwnerComponent().getShell();m.setAppWidthLimited(!m.getAppWidthLimited());this.getModel("component").setProperty("/FULLSCREEN",!m.getAppWidthLimited());var i=this.byId('ideaLink');if(i&&m.getAppWidthLimited()){i.addStyleClass("sapInoIdeaListIdeaNameTitle");}else if(i&&!m.getAppWidthLimited()&&i.hasStyleClass("sapInoIdeaListIdeaNameTitle")){i.removeStyleClass("sapInoIdeaListIdeaNameTitle");}},setFullScreen:function(s){var m=this.getOwnerComponent().getShell();var i=this.getModel("component");m.setAppWidthLimited(!s);if(i){i.setProperty("/FULLSCREEN",!m.getAppWidthLimited());}},getFullScreen:function(){return!this.getOwnerComponent().getShell().getAppWidthLimited();},_createSuggestHandler:function(s){if(D.system.desktop){return function(E){var o=E.getSource();if(o.getMaxTokens()&&o.getMaxTokens()<=o.getTokens().length){o.removeAllSuggestionItems();return;}var t=E.getParameter("suggestValue");var l=new L({key:"{data>"+s.key+"}",text:"{data>"+s.text+"}",additionalText:s.additionalText&&"{data>"+s.additionalText+"}"});var i=s.path.replace("$suggestValue",jQuery.sap.encodeURL(t));var m=s.key+","+s.text;if(s.additionalText){m=m+","+s.additionalText;}E.getSource().bindAggregation("suggestionItems",{path:i,template:l,filters:s.filters,sorter:s.sorter,parameters:{select:m}});};}else{return function(E){var o=E.getSource();if(o.getMaxTokens()&&o.getMaxTokens()<=o.getTokens().length){o.removeAllSuggestionItems();return;}var t=E.getParameter("suggestValue");var i=s.path.replace("$suggestValue",jQuery.sap.encodeURL(t));i=i.replace("data>","");i=i.replace("object>","");var l=s.key+","+s.text;if(s.additionalText){l=l+","+s.additionalText;}o._bBindingUpdated=true;o.getModel("data").read(i,{filters:s.filters,sorter:s.sorter,success:function(m){o.removeAllSuggestionItems();for(var n=0;n<m.results.length-1;n++){o.addAggregation("suggestionItems",new L({key:m.results[n][s.key],text:m.results[n][s.text],additionalText:s.additionalText&&m.results[n][s.additionalText]}),true);}if(m.results.length>0){o.addSuggestionItem(new L({key:m.results[m.results.length-1][s.key],text:m.results[m.results.length-1][s.text],additionalText:s.additionalText&&m.results[m.results.length-1][s.additionalText]}));}}});};}},executeObjectAction:function(o,A,O){var t=this;var m=O&&O.messages||{};var p=O&&O.parameters||{};var s=O&&O.staticparameters||null;var E;function i(v,r,u){if(!v){return t.getText(r);}if(typeof v==="function"){return v(u);}else{return t.getText(v);}}function l(){if(!t._oConcurrentEditDialog){var r=t._getTextModel();t._oConcurrencyModel=o;t._sActionName=A;t._oConcurrentEditDialog=t.createFragment("sap.ino.vc.commons.fragments.ConcurrentEditDialog");t._oConcurrentEditDialog.setModel(r,'i18n');t.getView().addDependent(t._oConcurrentEditDialog);}t._oConcurrentEditDialog.open();}var n=function(){t.getView().setBusy(true);var r;if(s){r=o[A].apply(o,[s,p]);}else{r=o[A].apply(o,[p]);}r.always(function(){t.getView().setBusy(false);});r.done(function(u){var v=i(m.success,"MSG_SAVE_SUCCESS",u);if(v){M.show(v,{autoClose:false});}});r.fail(function(u){if(u){if(u.concurrencyConflict){l();}else{var v=i(m.error,"MSG_SAVE_USER_ERROR",u);if(v){M.show(v,{autoClose:false});}}}});return r;};if(m.confirm){var q=new jQuery.Deferred();c.confirm(i(m.confirm),{onClose:function(r){if(r!==c.Action.OK){q.resolve({confirmationCancelled:true});return;}else{var u=n();u.done(q.resolve);u.fail(q.reject);}}});E=q.promise();}else{E=n();}return E;},onIngoreConflict:function(){if(this._oConcurrentEditDialog){var o={};o.parameters={};o.parameters.bIgnoreConcurrencyConflict=true;this.executeObjectAction(this._sActionName,o);this._oConcurrentEditDialog.close();}this._cleanConcurrencyState();},onMergeConflict:function(){if(this._oConcurrentEditDialog){this._oConcurrencyModel.mergeConcurrentChanges();this._oConcurrentEditDialog.close();}this._cleanConcurrencyState();},showLatestVestion:function(){var o,p,K,l;o=this._oConcurrencyModel.getObjectName();var u=f.getDefinition(o);p=u.navigation.path;K=u.navigation.key;var P={};P[K]=this._oConcurrencyModel.getKey();l=this.getNavigationLink(p,P);var w=window.open(l,"_blank");w.opener=null;},onCancelConflict:function(){if(this._oConcurrentEditDialog){this._oConcurrentEditDialog.close();}this._cleanConcurrencyState();},_cleanConcurrencyState:function(){this._oConcurrentEditDialog.destroy();delete this._oConcurrencyModel;delete this._sActionName;delete this._oConcurrentEditDialog;},getNavigationLink:function(r,p){return this.getOwnerComponent().getNavigationLink(r,p);},setHelp:function(){if(!arguments||!arguments.length){return false;}var t='';for(var i=0;i<arguments.length;i++){t+=this.getText("HELP_EXP_"+arguments[i]);}var o=this.getOwnerComponent();o.setHelpContent(t);},scrollDockElement:function(p,E,i,o){var t=this;var l=0;var m=0;function s($,n){var q=parseInt($.parent().find(".sapUxAPObjectPageWrapperTransform").css("padding-top"),10);if(l===0){l=q;}q=q===0?l:q;var r=parseInt($.find(".sapUxAPObjectPageHeaderDetails").height(),10);if(m===0){m=r;}r=r===0?m:r;var O=o!==undefined?o:q;var u=i!==undefined?i:r;if($.scrollTop()>=u){n.css("position","absolute");n.css("top",($.scrollTop()+O)+"px");}else{n.css("position","relative");n.css("top",0);}}this.byId(p).addEventDelegate({onAfterRendering:function(n){var $=jQuery(n.srcControl.getDomRef()).find(".sapUxAPObjectPageWrapper");$.scroll(function(){s(jQuery(this),jQuery(t.byId(E).getDomRef()));});}});this.byId(E).addEventDelegate({onAfterRendering:function(n){var $=jQuery(t.byId(p).getDomRef()).find(".sapUxAPObjectPageWrapper");s($,jQuery(n.srcControl.getDomRef()));}});},attachListControlResized:function(l){if(l){return h.register(l,this.onListControlResize);}},detachListControlResized:function(r){if(r){h.deregister(r);}},onListControlResize:function(E){var t=E.control;var w=E.size.width;var o=E.oldSize?E.oldSize.width:-1;var T=[400,500,600,700,800,900,1000,1100,1200,1300,Infinity];var s=["sapInoListWidthXXXXS","sapInoListWidthXXXS","sapInoListWidthXXS","sapInoListWidthXS","sapInoListWidthS","sapInoListWidthM","sapInoListWidthL","sapInoListWidthXL","sapInoListWidthXXL","sapInoListWidthXXXL","sapInoListWidthXXXXL"];var O=T.reduce(function(p,m,n){if(o>=m){return n;}else{return p;}},0);var l=T.reduce(function(p,m,n){if(w>=m){return n;}else{return p;}},0);if(O!==l||o===-1||o===0){for(var i=0;i<s.length;i+=1){t.removeStyleClass(s[i]);}t.addStyleClass(s[l]);}},setClientMessage:function(m,t){this.resetClientMessages();var T=t&&t.getId()+"/value";m.setTarget(T);m.setMessage(this.getText(m.getCode()));m.processor=this._controlMessageProcessor;var i=[m];sap.ui.getCore().getMessageManager().addMessages(i);this._previousClientMessages=i;},resetClientMessages:function(t){var m=sap.ui.getCore().getMessageManager();var i=m.getMessageModel().getData();if(i.length>0){var l=jQuery.grep(this._previousClientMessages,function(o){return jQuery.grep(i,function(n){return n.id===o.id&&(!t||(t&&n.target&&n.target.indexOf(t)>-1));}).length>0;});if(l.length>0){m.removeMessages(this._previousClientMessages);this._previousClientMessages=[];}}},hasClientMessages:function(){return this._previousClientMessages&&this._previousClientMessages.length>0;},hasAnyClientErrorMessages:function(){this.enforceInputTypeValidations();var m=this.getOwnerComponent().getModel("message");var i=m.getData();if(this.hasClientMessages()){return true;}return i.reduce(function(p,o){var P=o.processor.getMetadata().getName();return p||(P==="sap.ui.core.message.ControlMessageProcessor"&&o.type===d.Error);},false);},getInputReadyControls:function(v){var V=v;if(!V){V=this.getView();}var i=V.findAggregatedObjects(true,function(o){return(!o.getVisible||o.getVisible())&&(!o.getEnabled||o.getEnabled())&&(!o.getEditable||o.getEditable())&&(o instanceof I||o instanceof S||o.getMetadata().getName()==="sap.ino.controls.MobileTextEditor"||o.getMetadata().getName()==="sap.ui.richtexteditor.RichTextEditor"||o.getMetadata().getName()==="sap.ino.controls.RichTextEditor");});return i;},resetInputTypeValidations:function(v){sap.ui.getCore().getMessageManager().removeMessages(this.getViewMessages(v));},hasMessages:function(v){var V=this.getViewMessages(v);if(V&&V.length>0){return true;}return false;},getViewMessages:function(v){var i=this.getInputReadyControls(v);var V=[];jQuery.each(i,function(l,o){if(o.fireValidationSuccess){o.fireValidationSuccess({element:o},false,true);}if(o.setValueState){o.setValueState(sap.ui.core.ValueState.None);}var m;if(o.getValue){m=o.getBinding("value");}else if(o.getSelectedKey){m=o.getBinding("selectedKey");}var n=m&&m.getDataState()&&m.getDataState().getMessages();if(n&&n.length>0){V=V.concat(n);}});return V;},enforceInputTypeValidations:function(){var t=this;var i=this.getInputReadyControls();jQuery.each(i,function(l,o){if(o.getDateValue&&o.isBound("dateValue")){o.updateModelProperty("dateValue",o.getDateValue(),o.getDateValue());}else if(o.getSelectedKey&&o.mProperties&&o.mProperties.hasOwnProperty("selectedKey")){o.updateModelProperty("selectedKey",o.getSelectedKey(),o.getSelectedKey());}else if(o._oEditor&&o._oEditor.getContent){if(o._oEditor.getBody()){o.updateModelProperty("value",o._oEditor.getContent(),o._oEditor.getContent());}}else if(o.getValue){o.updateModelProperty("value",o.getValue(),o.getValue());if(o instanceof e){if(o.getValue()){o.fireValidationError({element:o,property:"value",message:t.getText("MSG_MULTI_INPUT_INVALID_VALUE")},false,true);}else{o.fireValidationSuccess({element:o,property:"value"},false,true);}}}else{console.assert(false,"no property found to enforceInputTypeValidations of sap.ino.vc.commons.BaseObjectController");}});},getModuelModel:function(){var m=new R({bundleUrl:b.getResourceBundleURL("moduletexts")+'?t='+Date.now()});return m;},onTermsConditionsClose:function(){var t=this;var T={"TERM_CODE":this.getModel('module').getProperty("sap.ino.config.TERM_CODE"),"TERM_CHANGED_AT":this.getModel('module').getProperty('sap.ino.config.TERM_CHANGED_AT')};var i=b.getUserModel().getProperty("/data/TERMACCEPTCALLBACK");var A=function(){t.getTermsDialog().close();b.getUserModel().setProperty("/data/TERM_ACCEPTED",1);if(i){i();}};var l=function(){M.show(t.getText("USER_TERM_AND_CONDITIONS_FAILD"));};var s=b.getSystemSetting("sap.ino.config.TERMS_AND_CONDITIONS_ACTIVE");var m=b.getSystemSetting("sap.ino.config.TERMS_AND_CONDITIONS_TEXT");if(s==='1'&&m){this.setUserTermCondition(T,A,l);}else{this.getTermsDialog().close();if(i){i();}}},onTermConditionSelected:function(E){var s=E.getParameter("selected");b.getUserModel().setProperty("/data/USER_ACCEPTED",s?1:0);},getTermsDialog:function(o){if(!this._oTermsDialog){this._oTermsDialog=sap.ui.xmlfragment("sap.ino.vc.shell.fragments.TermsDialog",o);this._oTermsDialog.setModel(this._oComponent.getModel("i18n"),'i18n');this._oTermsDialog.setModel(b.getSystemSettingsModel(),'config');o.getView().addDependent(this._oTermsDialog);}return this._oTermsDialog;},setUserTermCondition:function(o,s,F){var t;if(!s){return;}if(!F){return;}t="/"+b.getSystemSetting("sap.ino.config.URL_PATH_XS_TERM_ACCEPT");jQuery.ajax({url:b.getBackendRootURL()+t,headers:{"X-CSRF-Token":b.getXSRFToken()},method:"POST",cache:false,data:JSON.stringify(o),success:s,error:F});},checkObjectExists:function(o,n){var t=this;t.setBusy(true);jQuery.ajax({url:b.getBackendRootURL()+"/sap/ino/xs/rest/community/objectCheck.xsjs",headers:{"X-CSRF-Token":b.getXSRFToken()},method:"POST",cache:false,data:JSON.stringify({"ObjectName":o,"ID":n}),success:function(r){t.setBusy(false);if(!r){t.setViewProperty("/insufficientObjectExists",{EXISTS:false});return;}t.setViewProperty("/insufficientObjectExists",{EXISTS:true,ID:r.ID,REF_ID:r.REF_ID,REF_NAME:r.REF_NAME,OBJECT_NAME:o});},error:function(){t.setBusy(false);t.setViewProperty("/insufficientObjectExists",{EXISTS:false});}});}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.BaseHomepageController')){jQuery.sap.declare('sap.ino.vc.commons.BaseHomepageController');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/commons/BaseHomepageController",["./BaseController","sap/ui/core/ResizeHandler","sap/ui/core/mvc/ViewType","sap/ui/model/json/JSONModel","sap/ino/vc/commons/mixins/GlobalSearchMixin","sap/ino/commons/application/Configuration"],function(B,R,V,J,G,C){return B.extend("sap.ino.vc.commons.BaseHomepageController",jQuery.extend({},G,{onInit:function(){B.prototype.onInit.apply(this,arguments);this._sResizeRegId=R.register(this.getView(),this._onResize);},onExit:function(){if(this._sResizeRegId){R.deregister(this._sResizeRegId);}},onRouteMatched:function(e){var t=this;var a=e.getParameter("arguments");var i=parseInt(a.id,10);this.openDisplayViewonRouteMatched(i);},onBeforeHide:function(){if(this.getCurrentRoute()!=="wall"){this._bFullscreenReset=true;this.setFullScreen(this._bPreviouslyFullscreen);}},onAfterShow:function(){this.initFullScreen();var c=this.getCurrentView();if(c&&c.getController()){var o=c.getController();if(typeof o.onAfterShow==="function"){o.onAfterShow();}}},getDisplayView:function(){},_initDisplayView:function(e){this._onResize({control:this.getView(),size:{width:this.getView().$().width()}});},openDisplayView:function(i){var d=this.getDisplayView(i);this.setCurrentView(d);},openDisplayViewonRouteMatched:function(i){var d;var t=this;var I=function(){if(typeof t.onBeforeDisplayViewShow==="function"){t.onBeforeDisplayViewShow();}var v=t.getCurrentView();if(typeof v.getController().show==="function"){v.getController().show(t.getView());}};if(i){var p="/CampaignPrivilege("+i+")";this.getModel("data").read(p,{async:true,success:function(D){t.getModel("component").setProperty("/REGISTRABLE",D.REGISTRATION_PRIVILEGE?true:false);t.getModel("component").setProperty("/COMMUNITY",D.COMMUNITY_PRIVILEGE?true:false);d=t.getDisplayView(i);t.setCurrentView(d);t.bindDefaultODataModel(i,I);},error:function(){t.getModel("component").setProperty("/REGISTRABLE",false);t.getModel("component").setProperty("/COMMUNITY",true);d=t.getDisplayView(i);t.setCurrentView(d);t.bindDefaultODataModel(i,I);}});}else{d=this.getDisplayView(i);this.setCurrentView(d);this.bindDefaultODataModel(i,I);}},initFullScreen:function(){if(this._bFullscreenReset===undefined||this._bFullscreenReset===true){this._bPreviouslyFullscreen=this.getFullScreen();}this.setFullScreen(true);this._bFullscreenReset=false;},getCurrentView:function(){var c=this.getView().getContent();var p=(c&&c.length>0)?c[0]:undefined;if(p){if(p.getContent().length>0){return p.getContent()[0];}}return undefined;},getCurrentController:function(){var v=this.getCurrentView();return v?v.getController():undefined;},setCurrentView:function(v){var c=this.getView().getContent();var p=(c&&c.length>0)?c[0]:undefined;if(p){var o=this.getCurrentView();var a=this._mViews?this._mViews[v]:undefined;if(a){p.removeContent(o);p.addContent(a);}else{if(!o){a=this.createView({type:V.XML,viewName:v});a.attachAfterRendering(this._initDisplayView,this);p.addContent(a);}else if(o&&o.getViewName()!==v){a=this.createView({type:V.XML,viewName:v});a.attachAfterRendering(this._initDisplayView,this);p.removeContent(o);p.addContent(a);}this._mViews=this._mViews?this._mViews:{};this._mViews[v]=a;}}},switchView:function(){var s=this.getModel("component").getProperty("/SHOW_BACKOFFICE");var i=this.iCampaignId?this.iCampaignId:null;s=!s;this.getModel("component").setProperty("/SHOW_BACKOFFICE",s);var a=this.getModel('search').getProperty('/selectedCategory');if(!s){this._removeCategory('campaign-idealistbycompany');this._removeCategory('idealistbycompany');this.getModel('search').setProperty('/selectedCategory',a);}else{this._addCategory({key:'idealistbycompany',value:C.getGroupConfiguration().DISPLAY_LABEL});this.getModel('search').setProperty('/selectedCategory',a);}this.openDisplayView(i);var c=this.getCurrentView();var o=c.getController();if(typeof o.show==="function"){o.show(this.getView());}o.setViewFocus();},setViewFocus:function(){if(this.getCurrentController()){this.getCurrentController().setViewFocus();}},updateLayout:function(l){var u=false;if(this.getCurrentController()){var L=this.getCurrentController().getLayout(l);for(var c in L){if(L.hasOwnProperty(c)){var s=L[c];var o=this.getCurrentView().byId(c);if(o){var a=this.getCurrentView().byId(s);if(a){a.removeStyleClass("sapInoInvisible");if(o.indexOfItem(a)===-1){o.addItem(a);}}else{var i=o.getItems();var I=i.length>0?i[0]:undefined;if(I){I.addStyleClass("sapInoInvisible");}}u=true;}}}}return u;},_onResize:function(e){var v=e.control;var t=v.getController();var c=t.getCurrentController();var l=(typeof t.getLayoutPrefix==="function"&&t.getLayoutPrefix())?t.getLayoutPrefix():undefined;var w=e.size.width;var n;var o=e.oldsize?e.oldsize.width:-1;if(w!==o){if(w<800){n="XS";}else if(w<1100){n="S";}else if(w<1350){n="M";}else if(w<1700){n="L";}else{n="XL";}if(c&&(!c._sCurrentLayout||c._sCurrentLayout!==n)){if(l){v.removeStyleClass(l+"XS");v.removeStyleClass(l+"S");v.removeStyleClass(l+"M");v.removeStyleClass(l+"L");v.removeStyleClass(l+"XL");v.addStyleClass(l+n);}v.removeStyleClass("sapInoBaseHomepageXS");v.removeStyleClass("sapInoBaseHomepageS");v.removeStyleClass("sapInoBaseHomepageM");v.removeStyleClass("sapInoBaseHomepageL");v.removeStyleClass("sapInoBaseHomepageXL");v.addStyleClass("sapInoBaseHomepage"+n);if(t.updateLayout(n)){var O=c._sCurrentLayout;c._sCurrentLayout=n;if(typeof c.onResizeLayoutChange==="function"){c.onResizeLayoutChange(O,n);}}}}},setObjectExists:function(o){var c=this.getCurrentController();if(c){c.setViewProperty("/objectExists",o);}},getObjectExists:function(o){var c=this.getCurrentController();if(c){return c.getViewProperty("/objectExists");}else{return undefined;}},bindDefaultODataModel:function(i,c){var t=this;var e=(typeof this.getODataEntitySet==="function")?this.getODataEntitySet():undefined;if(e&&i>0){this.getView().bindElement({path:"data>/"+e+"("+i+")",events:{dataRequested:function(){jQuery.each(t.getBusyControls(),function(I,a){if(jQuery.type(a.setBusy)==="function"){a.setBusy(true);}});},dataReceived:function(E){jQuery.each(t.getBusyControls(),function(I,a){if(jQuery.type(a.setBusy)==="function"){a.setBusy(false);}});if(E.getParameter("data")===undefined){t.setObjectExists(false);}else{t.setObjectExists(true);}if(typeof c==="function"){c.apply(t);}},change:function(){var O=this.getModel().getProperty(this.getPath())!==undefined;t.setObjectExists(O);}}});if(typeof c==="function"){var o=this.getView().getBindingContext("data");if(o&&o.getPath()===("/"+e+"("+i+")")){c.apply(t);}}return true;}if(typeof c==="function"){c.apply(t);}return false;}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.BootStrapError.controller')){jQuery.sap.declare('sap.ino.vc.commons.BootStrapError.controller');jQuery.sap.require('sap.ui.model.resource.ResourceModel');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/commons/BootStrapError.controller",["sap/ino/vc/commons/BaseController","sap/ui/model/resource/ResourceModel","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration"],function(C,R,J,a){"use strict";return C.extend("sap.ino.vc.commons.BootStrapError",{onInit:function(){C.prototype.onInit.apply(this,arguments);var b=a.getResourceBundleURL("nguii18n");if(b){var B=new R({bundleUrl:b});}var d;if(a.userErrorMessage){d={message:a.userErrorMessage};}else{var M=B&&B.getResourceBundle().getText("GENERAL_APPLICATION_TIT_ERROR_SETUP_INCOMPLETE");d={message:M};}var m=new J(d);this.getView().setModel(m,"error");},onLogout:function(){jQuery.ajax({url:a.getBackendRootURL()+"/sap/hana/xs/formLogin/token.xsjs",headers:{"X-CSRF-Token":"Fetch"},success:function(r,s,x){var t=x.getResponseHeader("X-CSRF-Token");jQuery.ajax({url:a.getBackendRootURL()+"/sap/hana/xs/formLogin/logout.xscfunc",headers:{"X-CSRF-Token":t},type:"post",contentType:"application/xml",success:function(){window.location=a.getBackendRootURL()+"/sap/hana/xs/formLogin/login.html?x-sap-origin-location="+encodeURIComponent(window.location.pathname)+encodeURIComponent(window.location.hash);}});}});}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.ClipboardMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.ClipboardMixin');sap.ui.define("sap/ino/vc/commons/mixins/ClipboardMixin",["sap/ino/commons/models/core/ClipboardModel","sap/ino/commons/models/object/User","sap/ino/commons/models/object/Idea"],function(C,U,I){"use strict";var a=function(){throw"Mixin may not be instantiated directly";};a._getClipboardModel=function(){if(!this._oClipboardModel){this._oClipboardModel=this.getModel("clipboard");}return this._oClipboardModel;};a.formatIsIdeaInClipboard=function(i){var c=this._getClipboardModel();if(c){return c.getProperty("/enabled")&&c.isInClipboard(I,i);}else{return false;}};a.formatHasIdeasInClipboard=function(){var c=this._getClipboardModel();return c?c.getProperty("/enabled")&&!c.isClipboardEmpty(I):false;};a.formatHasOtherIdeasInClipboard=function(i){var c=this._getClipboardModel();var h=c.getObjectKeys(I).filter(function(t){return t!==i;}).length>0;return c?c.getProperty("/enabled")&&h:false;};a.formatIdeasInClipboardAndParam=function(){for(var i=0;i<arguments.length;i+=1){if(!arguments[i]){return false;}}return this.formatHasIdeasInClipboard();};a.formatIdeaPinTooltip=function(i){var c=this._getClipboardModel();if(c){return c.isInClipboard(I,i)?this.getText("CLIPBOARD_BTN_TOOLTIP_IDEA_REMOVE"):this.getText("CLIPBOARD_BTN_TOOLTIP_IDEA_ADD");}else{return"";}};a.formatIsUserInClipboard=function(i){var c=this._getClipboardModel();if(c){return c.getProperty("/enabled")&&c.isInClipboard(U,i);}else{return false;}};a.formatHasUsersInClipboard=function(){var c=this._getClipboardModel();return c?c.getProperty("/enabled")&&!c.isClipboardEmpty(U):false;};a.onIdeaPinPressed=function(e){var c=this._getClipboardModel();var s=e.getSource();var m=s.data("model")||"data";var i=s.getBindingContext(m).getProperty("ID");var n=s.getBindingContext(m).getProperty("NAME");var p=s.getPressed();if(c&&i){var A=c.isInClipboard(I,i);if(p&&!A){c.add(I,i,n);}else if(!p&&A){c.remove(I,i);}}};a.onUserPinPressed=function(e){var c=this._getClipboardModel();var i=e.getParameter("identityId");var u=e.getParameter("userName");var p=e.getParameter("pinned");if(c&&i){var A=c.isInClipboard(U,i);if(p&&!A){c.add(U,i,u);}else if(!p&&A){c.remove(U,i);}}};return a;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.ExtensibilityMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.ExtensibilityMixin');jQuery.sap.require('sap.ui.core.ValueState');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.Select');jQuery.sap.require('sap.m.DatePicker');jQuery.sap.require('sap.ui.core.ListItem');sap.ui.define("sap/ino/vc/commons/mixins/ExtensibilityMixin",["sap/ino/commons/models/aof/MetaModel","sap/ino/commons/models/core/CodeModel","sap/ino/commons/util/SmartControl","sap/ino/commons/util/UIObjectConfig","sap/ui/core/ValueState","sap/ui/core/format/DateFormat","sap/m/Label","sap/m/Input","sap/m/CheckBox","sap/m/Select","sap/m/DatePicker","sap/ui/core/ListItem"],function(M,C,S,U,V,D,L,I,a,b,c,d){"use strict";var E=function(){throw"Mixin may not be instantiated directly";};var e=D.getInstance({pattern:"YYYY-MM-dd"});E.sortExtensionFields=[];E.filterExtensionFields=[];E._extensibilityExtensionFieldSorter=function(){var t=this;var f=[];var o=this.getView().data();if(!o["aofObject"]&&this.getView().getContent().length>0){o=this.getView().getContent()[0].data();}if(o["aofObject"]){var m=M.getApplicationObjectMetadata(o["aofObject"]);if(m.nodes.Extension){jQuery.each(t.sortExtensionFields,function(i,s){if(s==="_ID"||s==="_OBJECT_TYPE_CODE"){return;}if(m.nodes.Extension.attributes[s]){var A=m.nodes.Extension.attributes[s];f.push({TEXT:m.name+".Extension."+A.name,ACTION:A.name,DEFAULT_ORDER:"ASC"});}});}}return f;};E._extensibilityExtensionFilterItems=function(f){var t=this;var o=this.getView().data();if(!o["aofObject"]&&this.getView().getContent().length>0){o=this.getView().getContent()[0].data();}if(o["aofObject"]){var m=M.getApplicationObjectMetadata(o["aofObject"]);if(m.nodes.Extension){jQuery.each(t.filterExtensionFields,function(i,s){if(s==="_ID"||s==="_OBJECT_TYPE_CODE"){return;}if(m.nodes.Extension.attributes[s]){var A=m.nodes.Extension.attributes[s];var g="{= ${user>/privileges/sap.ino.ui::backoffice.access} && ${view>/List/MANAGE} === true }";var h;switch(A.dataType){case"TIMESTAMP":h=null;break;case"DATE":h=new c({visible:g,width:"100%",value:"{view>/List/EXTENSION/"+A.name+"}",change:function(k){if(k.getParameter("valid")){k.getSource().setValueState(V.None);var v=k.getSource().getDateValue();v=e.format(v);t.setViewProperty("/List/EXTENSION/"+A.name,v);t.navigateIntern(t.getQuery(),true,true);}else{k.getSource().setValueState(V.Error);}}});break;case"TINYINT":h=new a({visible:g,width:"100%",selected:{path:"view>/List/EXTENSION/"+A.name,formatter:function(v){return v===1||v==="1";}},select:function(k){var n=k.getParameter("selected");t.setViewProperty("/List/EXTENSION/"+A.name,n?1:null);t.navigateIntern(t.getQuery(),true,true);}});break;default:h=new I({visible:g,value:"{view>/List/EXTENSION/"+A.name+"}",change:function(k){t.navigateIntern(t.getQuery(),true,true);},width:"100%"});break;}if(A.foreignKeyTo&&!!U.getDefinition(A.foreignKeyTo)){h=null;}if((A.customProperties&&A.customProperties.valueOptionList)||(A.foreignKeyTo&&!U.getDefinition(A.foreignKeyTo))){var j=A.foreignKeyTo;if(A.customProperties&&A.customProperties.valueOptionList){j="sap.ino.xs.object.basis.ValueOptionList.Root_"+A.customProperties.valueOptionList;}h=new b({visible:g,selectedKey:"{view>/List/EXTENSION/"+A.name+"}",change:function(k){t.navigateIntern(t.getQuery(),true,true);},items:{path:"code>/"+j,template:new d({key:{path:"code>CODE"},text:{path:"code>CODE",formatter:C.getFormatter(j)},tooltip:{path:"code>CODE",formatter:C.getLongTextFormatter(j)}}),sorter:{path:'CODE'},parameters:{includeEmptyCode:true}},width:"100%"});}if(h){h.addStyleClass("sapUiSmallMarginBottom");var l=new L({text:"{i18n>"+m.name+".Extension."+A.name+"}",visible:g});if(h.addAriaLabelledBy){h.addAriaLabelledBy(l);}f.addContent(l);f.addContent(h);}}});}}};return E;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.FollowMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.FollowMixin');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/commons/mixins/FollowMixin",["sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast","sap/ino/commons/models/object/IdeaFollow","sap/ino/commons/models/object/CampaignFollow","sap/ino/commons/models/object/TagFollow","sap/ui/model/json/JSONModel"],function(P,M,I,C,T,J){"use strict";var F=function(){throw"Mixin may not be instantiated directly";};F.onFollow=function(E){var s=this;var v=E.getParameter('value');var t=E.getParameter('type');var o=E.getParameter('objectId');var f;var a=v?'FOLLOW_REMOVE_FOLLOW_SUCCESS':'FOLLOW_MSG_FOLLOW_SUCCESS';var b=E.getSource();if(!v){this.oIdeaFollowModel=new J();}switch(t){case'IDEA':f=I.follow(o,t,v);break;case'CAMPAIGN':f=C.follow(o,t,v);break;case'TAG':f=T.follow(o,t,v);break;default:return false;}if(b&&b.setEnabled){b.setEnabled(false);}f.done(function(c){M.show(s.getText(a));if(s.oIdeaFollowModel){var r={ID:c.GENERATED_IDS?c.GENERATED_IDS[-1]:undefined};s.oIdeaFollowModel.setProperty("/"+t+"("+o+")",r);}b.setEnabled(true);b.rerender();if(s.isGlobalSearch){s.getSearchResult(s.getViewProperty("/SEARCH_QUERY"));}});f.fail(function(){if(b.setEnabled){b.setEnabled(true);}});};return F;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.IdentityCardSendMailMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.IdentityCardSendMailMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/commons/mixins/IdentityCardSendMailMixin",["sap/ino/vc/commons/mixins/MailMixin","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox"],function(M,C,J,a,b){"use strict";var I=function(){throw"Mixin may not be instantiated directly";};var _=new J();var c=new J();I.getEmailDialog=function(){if(!this._oEmailDialog){this._oEmailDialog=this.createFragment("sap.ino.vc.iam.fragments.SendEmail",this.getView().createId());this.getView().addDependent(this._oEmailDialog);this._oEmailDialog.setModel(c,"mail");}return this._oEmailDialog;};I.getMailSignatureBody=function(B,w){var A=C.getSystemSetting('sap.ino.config.APPLICATION_TITLE');if(!A||A===""){A="SAP Innovation Management";}var u=this.getModel('user').getProperty("/data/NAME");var s=this.getText("MAIL_SIGNATURE_TEMPLATE",[A,u]);B=B+"\n\n\n\n\n\n\n\n\n\n\n"+s;if(w){B=B+'\n'+this.getModel('user').getProperty("/data/EMAIL");}return B;};I.onMailPressed=function(e){var i=e.getParameter("identityId");var u=e.getParameter("userName");var o=M.createMailContent.apply(this);var t=this;_.loadData(C.getUserProfileByTextURL(i),{"USER_ID":i},false,"GET");if(_.getProperty("/CONTACT_DETAIL")&&_.getProperty("/CONTACT_DETAIL/EMAIL")){sap.m.URLHelper.triggerEmail(_.getProperty("/CONTACT_DETAIL/EMAIL"),o.subject,o.body);}else{var O=function(w){o.body=t.getMailSignatureBody(o.body,w);c.setData(o);c.setProperty("/username",u);c.setProperty("/to_identity",i);var m=t.getEmailDialog();m.open();};b.confirm(this.getText("MAIL_MSG_SEND_CONFIRMATION"),{title:this.getText("MAIL_CONFIRMATION_LABEL"),icon:b.Icon.NONE,actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(A){if(A==="YES"){O(true);}else{O(false);}}});}};I.onIdeaContactMail=function(p){var t=this;var i=p.map(function(P){return P.IDENTITY_ID;});var u=p.map(function(P){return P.NAME;}).join(";");var o=M.createMailContent.apply(this);var O=function(w){o.body=t.getMailSignatureBody(o.body,w);c.setData(o);c.setProperty("/username",u);c.setProperty("/to_identity",i);var m=t.getEmailDialog();m.open();};b.confirm(this.getText("MAIL_MSG_SEND_CONFIRMATION"),{title:this.getText("MAIL_CONFIRMATION_LABEL"),icon:b.Icon.NONE,actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(A){if(A==="YES"){O(true);}else{O(false);}}});};I.onEmailDialogSend=function(){var t=this;var d={TO_IDENTITY:c.getProperty("/to_identity"),SUBJECT:c.getProperty("/subject"),CONTENT:c.getProperty("/body")};var s="/sap/ino/xs/rest/common/send_identity_email.xsjs";jQuery.ajax({url:C.getBackendRootURL()+s,headers:{"X-CSRF-Token":C.getXSRFToken()},method:"POST",cache:false,data:JSON.stringify(d),success:function(){a.show(t.getText("MAIL_MSG_SEND_SUCCESS"));t._oEmailDialog.close();},error:function(){a.show(t.getText("MAIL_MSG_SEND_ERROR"));}});};I.onEmailDialogCancel=function(){this._oEmailDialog.close();};return I;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.RichTextInitMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.RichTextInitMixin');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/commons/mixins/RichTextInitMixin",["sap/ino/commons/models/object/Attachment","sap/ino/commons/application/Configuration","sap/m/MessageToast"],function(A,C,M){"use strict";var R=function(){throw"Mixin may not be instantiated directly";};R.beforeIformEditorInit=function(c){var t=this;c.mParameters.configuration.plugins=c.mParameters.configuration.plugins.replace("image,","");c.mParameters.configuration.link_context_toolbar=true;c.mParameters.configuration.plugins=c.mParameters.configuration.plugins.replace("powerpaste","powerpaste,imagetools");c.mParameters.configuration.paste_data_images=true;c.mParameters.configuration.automatic_uploads=true;c.mParameters.configuration.powerpaste_word_import="clean";c.mParameters.configuration.powerpaste_html_import="clean";c.mParameters.configuration.default_link_target="_blank";c.mParameters.configuration.images_upload_handler=function(f,s,a){var F=f.blob();if(F){A.uploadFileIncludeFileLabel(F,"IDEA_FORM_DESC").done(function(r){s(C.getAttachmentDownloadURL(r.attachmentId));}).fail(function(){a();M.show(t.getText("IDEA_OBJECT_MSG_IDEA_FROM_IMAGE_UPLOAD_FAILED"));});}};c.mParameters.configuration.paste_postprocess=function(){window.tinymce.activeEditor.uploadImages();};};return R;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.TagCardMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.TagCardMixin');sap.ui.define("sap/ino/vc/commons/mixins/TagCardMixin",["sap/ino/vc/commons/mixins/FollowMixin"],function(F){"use strict";var T=function(){throw"Mixin may not be instantiated directly";};T.navigateToIdea=function(e){var q={"tags":[{"ID":e.getParameter("tagId"),"NAME":window.encodeURIComponent(e.getParameter("tagName")),"GROUP_ID":e.getParameter("tagGroupId")}]};q.tags=JSON.stringify(q.tags);this.navigateTo("idealist",{"query":q},false,true);};T.navigateToCampaign=function(e){var q={"tags":[{"ID":e.getParameter("tagId"),"NAME":window.encodeURIComponent(e.getParameter("tagName")),"GROUP_ID":e.getParameter("tagGroupId")}]};q.tags=JSON.stringify(q.tags);this.navigateTo("campaignlist",{query:q},false,true);};T.doFollow=function(e){F.onFollow.call(this,e);if(this._oPopover&&this._oPopover.isOpen()){this._oPopover.close();}};return T;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.mixins.UserGroupMixin')){jQuery.sap.declare('sap.ino.vc.commons.mixins.UserGroupMixin');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/ino/vc/commons/mixins/UserGroupMixin",["sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast","sap/ino/commons/models/object/Group","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/communityUser"],function(P,M,G,J,F,a,C,c){"use strict";var U=function(){throw"Mixin may not be instantiated directly";};U._memberRequestQueue=[];U._bindUserGroupModel=function(V){var b=V||this.getView();var p=C.getBackendRootURL()+"/sap/ino/xs/rest/common/public_user_group.xsjs";var g=new J(p);b.setModel(g,"USER_GROUPS");return g;};U.onSearchUserGroup=function(e){var i=e.getSource();var t=i&&i.getParent();var b=t&&t.getParent();var s=e.getParameter('query');var d=new F([new F('GROUP_NAME',a.Contains,s),new F('DESCRIPTION',a.Contains,s)]);b.getBinding('rows').filter(d,"searchGroup");this.reBindSelectedData(b);};U.selectedNoneGroup=function(e){var s=e.getParameters().selected;var t=s?'RowOnly':'Row';var b=e.getSource();var d=b&&b.getParent();d.setSelectionBehavior(t);d.setEditable(!s);};U.putGroupSelected=function(t,v){if(!t){return false;}var b=t;var d=v||false;var e=b.getModel('USER_GROUPS').getData();var s=e.SELECTED_NONE||false;var n=e.noneGroupID[0].GROUP_ID;var f=b.getSelectedIndices();var u=C.getCurrentUser().USER_ID;var g={keys:[],parameters:[]};if(!s){for(var i=0;i<f.length;i++){g.keys.push(b.getContextByIndex(f[i]).getObject().GROUP_ID);}}else{g.keys.push(n);}if(!g.keys.length&&d){M.show(this.getText('USER_GROUP_SELECT_ERROR'));return false;}return this.createUserModel(u).assignGroups(g);};U.reBindSelectedData=function(t){var b=t;var d=b.getModel('USER_GROUPS').getData();var r=d.total;var n=d.noneGroupID&&d.noneGroupID.length&&d.noneGroupID[0];var e=b.getBinding('rows').getContexts(0,r);var s=this.getModel('identityData>/groups').getData();b.setSelectionBehavior('Row');b.setEditable(true);if(s&&s.length&&n&&s[0].GROUP_ID===n.GROUP_ID){b.getExtension()[0].setSelected(true);b.setSelectionBehavior('RowOnly');b.setEditable(false);b.setSelectedIndex(-1);}if(s&&e){for(var i=0;i<s.length;i++){for(var x=0;x<e.length;x++){if(s[i].GROUP_ID===e[x].getObject().GROUP_ID){b.addSelectionInterval(x,x);}}}}};U.createUserModel=function(u){var s={readSource:{model:this.getDefaultODataModel()}};return new c(u,s);};U.transGroupVisible=function(v){return!!v;};U.getMemberGroups=function(){var p=C.getBackendRootURL()+"/sap/ino/xs/rest/common/group.xsjs";var u=C.getCurrentUser().USER_ID;return $.ajax({url:p,type:'GET',data:{id:u}});};U.cantClose=function(){return false;};return U;});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.RequestsClarificationList.controller')){jQuery.sap.declare('sap.ino.vc.evaluation.RequestsClarificationList.controller');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/evaluation/RequestsClarificationList.controller",["sap/ino/vc/commons/BaseController","sap/ino/commons/formatters/BaseFormatter","sap/ino/vc/commons/TopLevelPageFacet","sap/m/MessageToast"],function(C,B,T,M){"use strict";return C.extend("sap.ino.vc.evaluation.RequestsClarificationList",jQuery.extend({},T,{formatter:B,onBeforeRendering:function(){this.setViewProperty("/USER_IMAGE_ID",this.getOwnerComponent().getCurrentUserImageId());},onClarificationSubmit:function(e){var c=this;var E=c.getModel("object");if(!E){return;}var n=e.getSource().getCustomData()[0].getValue();var a=e.getSource().getCustomData()[1].getValue();var s=e.getSource().getProperty("value");var A=E.sendClarification({EVAL_REQ_ITEM_ID:n,TO_IDENTITY:a,CONTENT:s});if(A){A.done(function(){M.show(c.getText("EVAL_REQ_MSG_CLARIFICATION_SUCCESS"));});A.fail(function(o){if(o.MESSAGES&&o.MESSAGES.length>0){M.show(c.getText(o.MESSAGES[0].MESSAGE_TEXT));}});}},onOpenCreatorInFirstClarification:function(e){this._onOpenCreator(e,"CREATED_BY_ID");},onOpenCreatorInClarification:function(e){this._onOpenCreator(e,"CREATED_BY_ID");},_onOpenCreator:function(e,p){var s=e.getSource();var d=e.getParameter("domRef");var c=s.getBindingContext("object");var i=c.getProperty(p);if(d){var r=sap.ui.getCore().byId(d.id);}if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}if(r){this.oIdentityCardView.getController().open(r,i);}else{this.oIdentityCardView.getController().open(s,i);}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.RequestsForwardList.controller')){jQuery.sap.declare('sap.ino.vc.evaluation.RequestsForwardList.controller');sap.ui.define("sap/ino/vc/evaluation/RequestsForwardList.controller",["sap/ino/vc/commons/BaseController","sap/ino/commons/formatters/BaseFormatter","sap/ino/vc/commons/TopLevelPageFacet"],function(C,B,T){"use strict";return C.extend("sap.ino.vc.evaluation.RequestsForwardList",jQuery.extend({},T,{formatter:B,onOpenCreatorInToForward:function(e){this._onOpenCreator(e,"TO_IDENTITY");},onOpenCreatorInForward:function(e){this._onOpenCreator(e,"FROM_IDENTITY");},_onOpenCreator:function(e,p){var s=e.getSource();var d=e.getParameter("domRef");var c=s.getBindingContext("object");var i=c.getProperty(p);if(d){var r=sap.ui.getCore().byId(d.id);}if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}if(r){this.oIdentityCardView.getController().open(r,i);}else{this.oIdentityCardView.getController().open(s,i);}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.mixins.MassActionMixin')){jQuery.sap.declare('sap.ino.vc.evaluation.mixins.MassActionMixin');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/evaluation/mixins/MassActionMixin",["sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/ui/core/MessageType","sap/ui/core/message/Message","sap/m/MessageToast","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/EvaluationRequestItem","sap/ino/vc/commons/BaseController"],function(F,a,S,M,b,c,C,E,B){"use strict";var d=function(){throw"Mixin may not be instantiated directly";};d._addForwardExpertInputHandling=function(o,s){if(!o){return;}var t=this;var f=t._createSuggestHandler(s.suggestion);o.attachSuggest(f,t);};d._createForwardDialog=function(){if(!this._oRequestForwardDialog){this._oRequestForwardDialog=this.createFragment("sap.ino.vc.evaluation.fragments.RequestForward",this.getView().getId());this.getView().addDependent(this._oRequestForwardDialog);}return this._oRequestForwardDialog;};d._createObjectModel=function(){var t=this.getList();var o=t.getContextByIndex(t.getSelectedIndex()).getProperty("ID");return new E(o,{actions:["update","del","executeStatusTransition","sendClarification","forward"],continuousUse:true,readSource:{model:this.getDefaultODataModel()}});};d._executeStatusTransition=function(s){var t=this;this._oModel=this._createObjectModel();var A=this._oModel.executeStatusTransition({STATUS_ACTION_CODE:s});if(A){A.done(function(){c.show(t.getText("OBJECT_MSG_STATUS_CHANGE_SUCCESS"));});A.fail(function(o){if(o.MESSAGES&&o.MESSAGES.length>0){c.show(t.getText(o.MESSAGES[0].MESSAGE_TEXT));}});}};d.onAccept=function(){this._executeStatusTransition("sap.ino.config.EVAL_REQ_ACCEPT");};d.onReject=function(){this._executeStatusTransition("sap.ino.config.EVAL_REQ_REJECT");};d.onForward=function(){var r=this._createForwardDialog();r.open();if(!this._oModel){this._oModel=this._createObjectModel();}this._addForwardExpertInputHandling(this.byId("inputForwardExpert"),{suggestion:{key:"ID",text:"NAME",additionalText:"USER_NAME",path:"data>/SearchIdentity(searchToken='$suggestValue')/Results",filters:[new F({path:"ID",operator:a.NE,value1:C.getCurrentUser().USER_ID})],sorter:new S("NAME")},token:{key:"IDENTITY_ID",text:"NAME"}});};d.onForwardClose=function(){if(!this._oModel){this._oModel=this._createObjectModel();}this._oModel.oData.Forwards=[];this._oRequestForwardDialog.close();this.byId("inputForwardExpert").removeAllTokens();this.byId("txtAreaForwardReasonDes").setValue("");};d.onSubmitForward=function(){var t=this;if(!this._oModel){this._oModel=this._createObjectModel();}var f=t.byId("inputForwardExpert").getTokens();var T=t.byId("inputForwardExpert").getValue();if(f.length>0&&!T){t._createForwardDialog();var i=parseInt(f[0].mProperties.key,10);var o=t.executeObjectAction(this._oModel,"forward",{parameters:{EXPERT_ID:i,COMMENT_FORWARD:t.byId("txtAreaForwardReasonDes").getValue().trim()},messages:{success:"EVALUATIONREQUESTS_MSG_FORWARD_SUCCESS",error:"EVALUATIONREQUESTS_MSG_FORWARD_FAILURE"}});o.done(function(){t._oRequestForwardDialog.close();t.byId("inputForwardExpert").removeAllTokens();t.byId("txtAreaForwardReasonDes").setValue("");});o.always(function(){t._oRequestForwardDialog.setBusy(false);});}else{t.setClientMessage(new b({code:"EVALUATIONREQUESTS_MSG_FORWARD_NO_EXPERT",type:M.Error}),t.byId("inputForwardExpert"));t.byId("inputForwardExpert").setValue("");}};d.onCreateEvaluation=function(){var t=this.getList();var i=t.getContextByIndex(t.getSelectedIndex()).getProperty("IDEA_ID");this.navigateTo("evaluation-create",{query:{ideaId:i}});};d.onMassDelete=function(e){var s=e.getSource();var t=this.getList();var f=t.getSelectedIndices();var g=[];if(f.length){for(var i=0;i<f.length;i++){g.push(t.getContextByIndex(f[i]).getProperty("ID"));}}var h=this;var D=B.prototype.executeObjectAction.call(h,E,"bulkDeleteItems",{staticparameters:{"EVAL_REQ_ITEM_ID":g},messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});D.done(function(r){if(r&&r.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(h.bindList&&typeof(h.bindList)==="function"){h.bindList();}});};d.resetActionState=function(){var t=this;var e=["sapInoAcceptBtn","sapInoRejectBtn","sapInoFowardBtn","sapInoCreateBtn","sapInoMassDeleteBtn"];jQuery.each(e,function(i,s){var o=t.byId(s);if(o){o.setEnabled(false);}});};return d;});};if(!jQuery.sap.isDeclared('sap.ino.vc.expertfinder.ExpertFinder.controller')){jQuery.sap.declare('sap.ino.vc.expertfinder.ExpertFinder.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/ino/vc/expertfinder/ExpertFinder.controller",["sap/ino/vc/commons/BaseController","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/Device","sap/ui/core/ListItem","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/vc/commons/mixins/ClipboardMixin","sap/ino/vc/commons/mixins/IdentityQuickviewMixin"],function(B,C,J,T,D,L,F,a,b,I){"use strict";return B.extend("sap.ino.vc.expertfinder.ExpertFinder",jQuery.extend({},T,b,I,{routes:["expertfinder"],view:{INPUT:"",IDEACARD_SECTION_VISIBLE:'TAG',Tags:[]},onRouteMatched:function(e){var v=this.getView();this.view.Tags=[];v.setModel(new J(this.view),"view");var E=new J({});var c=this.getModel("user").getProperty("/privileges")["sap.ino.ui::backoffice.access"];if(!c){this.navigateTo("home");return;}v.setModel(E,"proposedExperts");this.displayExpertDetail(false);this.setHelp("EXPERT_FINDER");var A=this.getModel("config").oData["sap.ino.config.EXPERT_FINDER_ACTIVE"];this.setObjectExists(c&&(A==="1"));},displayExpertDetail:function(d){var e=this.getView().byId("expertDetailContainer");e.toggleStyleClass("sapInoInvisible",!d);var E=this.getView().byId("expertGraphContainer");E.toggleStyleClass("sapInoExpertGraphContainerDetail",d);E.toggleStyleClass("sapInoExpertGraphContainer",!d);},onSuggestTag:function(e){var c=e.getSource();var t=this;var v=e.getParameter("suggestValue");var o=new L({key:"{data>ID}",text:"{data>NAME}"});var s="/SearchIdeaTagsParams(searchToken='"+jQuery.sap.encodeURL(v)+"')/Results";var f=this._getSuggestionItemsFilter(this.view.Tags);c.bindAggregation("suggestionItems",{path:"data>"+s,filters:f,template:o});},_getSuggestionItemsFilter:function(e){var f=[];jQuery.each(e,function(i,t){var o=new F({path:"NAME",operator:a.NE,value1:t.NAME});f.push(o);});return(f.length===0)?[]:[new F(f,true)];},onAddTag:function(e){var v=this.getView();var V=v.getModel("view");var i=this.byId("suggestTag");var s;var r=jQuery.grep(i.getSuggestionItems(),function(S){return S.getText().toLowerCase()===i.getValue().toLowerCase();});if(r.length>0){s=r[0];this.view.INPUT=s.getText();}var n={TAG_ID:s&&s.getKey(),NAME:s&&s.getText()};if(n.NAME&&n.NAME.length!==0){var t=V.getProperty("/Tags");var d=jQuery.grep(t,function(o){return o.NAME.toLowerCase()===n.NAME.toLowerCase();});if(d.length===0){t.push(n);V.setProperty("/Tags",[]);V.setProperty("/Tags",t);var u=this._getExpertUrl(this.view.Tags);v.getModel("proposedExperts").loadData(u);v.getModel("proposedExperts").refresh();}i.setValue("");i.setValueState("None");i.focus();}else if(i.getValue().length!==0){i.setValueState("Error");}},onChangeTag:function(e){var v=this.getView();var V=v.getModel("view");if(e.getParameter("type")==="removed"){var t=e.getParameter("token");var r={TAG_ID:t&&t.getKey(),NAME:t&&t.getText()};if(r.NAME){var c=jQuery.grep(V.getProperty("/Tags"),function(o){return o.NAME!==r.NAME;});V.setProperty("/Tags",[]);V.setProperty("/Tags",c);if(this.view.Tags.length>0){var u=this._getExpertUrl(this.view.Tags);v.getModel("proposedExperts").loadData(u);}else{v.getModel("proposedExperts").setData({});this.bindExpert(null);this.displayExpertDetail(false);}}}},_getExpertUrl:function(o){var s=o.map(function(t){return t.NAME;});var u=C.getIdeaExpertsByTagsURL(s);return u;},bindExpert:function(e){var v=this.getView();var p=this.getView().byId("expertDetails");var s=jQuery.map(v.getModel("proposedExperts").getData(),function(o,i){if(o.ID===e.PERSON_ID){return i;}});if(s.length>0){p.bindElement("proposedExperts>/"+s[0]);}else{p.unbindElement("proposedExperts");}},onClickNode:function(e){if(e.getParameters().group&&e.getParameters().group!=="0"){var E=e.getParameters();this.bindExpert(E);this.displayExpertDetail(true);}},onOpenIdea:function(e){if(D.system.phone){this.getView().getParent().close();}var c=e.getSource().getBindingContext("proposedExperts");var i=c.getProperty("IDEA/ID");if(i){this.navigateTo("idea-display",{id:i});}},onExpertExpand:function(e){var c=e.getSource().getParent();c.toggleStyleClass("sapInoIdeaExpertItemSelected");},isExpertActionable:function(){return false;},isExpertAddedForDialog:function(){return false;},}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.home.Homepage.controller')){jQuery.sap.declare('sap.ino.vc.home.Homepage.controller');sap.ui.define("sap/ino/vc/home/Homepage.controller",["sap/ino/vc/commons/BaseHomepageController","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/application/Configuration"],function(B,T,C){"use strict";return B.extend("sap.ino.vc.home.Homepage",jQuery.extend({},T,{routes:["home"],onRouteMatched:function(e){B.prototype.onRouteMatched.apply(this,arguments);},onBeforeDisplayViewShow:function(){},getDisplayView:function(){var d;var s=this.getModel("component").getProperty("/SHOW_BACKOFFICE");if(s){d="sap.ino.vc.home.BackOfficeHome";this.setHelp("HOME_BACK");}else{d="sap.ino.vc.home.CommunityHome";this.setHelp("HOME_COMM","HOME_COMM_ADDITIONAL");}return d;},getLayoutPrefix:function(){return"sapInoHomeHomepage";},getODataEntitySet:function(){return undefined;},onBeforeHide:function(){if(B.prototype.onBeforeHide){B.prototype.onBeforeHide.apply(this,arguments);}},onBackofficeSettings:function(){this.navigateToByURLInNewWindow(C.getBackendRootURL()+"/"+C.getSystemSetting("sap.ino.config.URL_PATH_UI_BACKOFFICE"));},openCampaignSettings:function(c){this.navigateToByURLInNewWindow(C.getCampaignSettingsURL(c));}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.home.Search.controller')){jQuery.sap.declare('sap.ino.vc.home.Search.controller');sap.ui.define("sap/ino/vc/home/Search.controller",["sap/ino/vc/commons/BaseController"],function(C){"use strict";return C.extend("sap.ino.vc.home.Search",{onInit:function(){C.prototype.onInit.apply(this,arguments);}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.iam.IdentityCard.controller')){jQuery.sap.declare('sap.ino.vc.iam.IdentityCard.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/ino/vc/iam/IdentityCard.controller",["sap/ino/vc/commons/BaseController","sap/ino/vc/commons/mixins/MailMixin","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration","sap/m/MessageToast","sap/ui/Device","sap/ino/controls/QuickViewGroupDimension"],function(B,M,J,C,a,D,Q){"use strict";var f={};jQuery.extend(f,B.prototype.formatter);f.generateMailURL=function(m){var c=this.oView.getController().createMailContent();if(c){return sap.m.URLHelper.normalizeEmail(m,c.subject,c.body);}else{return sap.m.URLHelper.normalizeEmail(m);}};return B.extend("sap.ino.vc.iam.IdentityCard",jQuery.extend({},M,{formatter:f,open:function(c,i){var t=this;var v=t.getView();var I;if(D&&D.system&&D.system.phone){I=v.byId("identityCardPhone");}else{I=v.byId("identityCard");}t._iUserId=i;t._oIdentityModel=new J();if(C.getUserProfileByTextURL(i)){t._oIdentityModel.loadData(C.getUserProfileByTextURL(i),{"USER_ID":i},true,"GET");t._oIdentityModel.attachRequestCompleted(null,function(){var b=t._oIdentityModel.getData();b.ENABLE_GAMIFICATION=t.getView().getModel("config").getProperty("/ENABLE_GAMIFICATION")===1?true:false;b.ENABLE_LEADERBOARD=t.getView().getModel("config").getProperty("/ENABLE_LEADERBOARD")===1?true:false;b.CURRENT_USER_ID=C.getCurrentUser().USER_ID;b.QUERY_USER_ID=t._iUserId;t._oIdentityModel.setData(b);v.setModel(t._oIdentityModel,"identityData");if(b.ENABLE_GAMIFICATION){t.constructGamificationDimension(t._oIdentityModel,v);}jQuery.sap.delayedCall(0,t,function(){if(D.system.phone){I.open();}else{I.openBy(c);}});});}},onClose:function(){if(D.system.phone){var i=this.getView().byId("identityCardPhone");i.close();}},onPressNavigateToLeaderBoard:function(e){var c=this.getView().getController();c.navigateTo("leaderboard");},constructGamificationDimension:function(m,v){var c,q,I,s,e,d,p,b;if(D.system.phone){c=v.getContent()[1];q=c.getContent()[0];}else{c=v.getContent()[0];q=c.getPages()[0];}var g=m.getData().GAMIFICATION_INFO;q.removeAllDimensionGroups();if(!Array.isArray(g)){return;}var S=true;if(m.getData().CURRENT_USER_ID!==m.getData().QUERY_USER_ID){S=false;}for(var i=0;i<g.length;i++){s="";e="";d=0;p=0;I="";b=0;if(JSON.stringify(g[i].BADGE)!=="{}"){s=g[i].BADGE.currentBadge.NAME;e=!g[i].BADGE.nextBadge.NAME?"":g[i].BADGE.nextBadge.NAME;if(g[i].BADGE.nextBadge.NAME&&g[i].BADGE.currentBadge.NAME){d=g[i].BADGE.nextBadge.BADGE_VALUE-g[i].BADGE.currentBadge.BADGE_VALUE;}if(g[i].BADGE.nextBadge.NAME&&!g[i].BADGE.currentBadge.NAME){d=g[i].BADGE.nextBadge.BADGE_VALUE;}if(!g[i].BADGE.nextBadge.NAME&&g[i].BADGE.currentBadge.NAME){d=g[i].BADGE.currentBadge.BADGE_VALUE;}p=g[i].BADGE.nextBadge.NAME?g[i].BADGE.nextBadge.BADGE_VALUE-parseInt(g[i].TOTAL,10):0;if(JSON.stringify(g[i].BADGE.currentBadge)!=="{}"&&g[i].BADGE.currentBadge.Attachment.length>0){I=C.getAttachmentTitleImageDownloadURL(g[i].BADGE.currentBadge.Attachment[0].ATTACHMENT_ID);}if(JSON.stringify(g[i].BADGE.currentBadge)!=="{}"){var h=parseInt(g[i].TOTAL,10)-g[i].BADGE.currentBadge.BADGE_VALUE;b=h>0?h:parseInt(g[i].TOTAL,10);}else{b=parseInt(g[i].TOTAL,10);}}if(I){q.addDimensionGroup(new Q({heading:g[i].NAME,headingIcon:I,totalPoints:parseInt(g[i].TOTAL,10),pointsToNextLevel:p,startLevel:s,nextLevel:e,currentPointsBWBadge:b,diffPointsToNextLevel:d,dimensionUnit:g[i].UNIT,redeemPoints:g[i].TOTAL_FOR_REDEEM,redeemEnabled:!!g[i].REDEEM,showOnlyDimension:!S}));}else if(S){q.addDimensionGroup(new Q({heading:g[i].NAME,headingIcon:I,totalPoints:parseInt(g[i].TOTAL,10),pointsToNextLevel:p,startLevel:s,nextLevel:e,currentPointsBWBadge:b,diffPointsToNextLevel:d,dimensionUnit:g[i].UNIT,redeemPoints:g[i].TOTAL_FOR_REDEEM,redeemEnabled:!!g[i].REDEEM,showOnlyDimension:!S}));}}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.iam.mixins.FeedsSettingMixin')){jQuery.sap.declare('sap.ino.vc.iam.mixins.FeedsSettingMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/iam/mixins/FeedsSettingMixin",["sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ino/commons/models/object/PersonalizeSetting"],function(J,M,P){"use strict";var F=function(){throw"Mixin may not be instantiated directly";};F.feedsSave=function(){var s=this;var m=s.getView().getModel('FEED');var d=m.getData();P.updateFeedsSettings({feeds:jQuery.extend(true,{},d.setting)}).done(function(){M.show(s.getText("FEEDS_SETTING_SAVE_SUCCESS"));if(m.getProperty("/setting/CAMPAIGN_SETTING_VALUE")||m.getProperty("/setting/IDEA_SETTING_VALUE")||m.getProperty("/setting/TAG_SETTING_VALUE")){s.updateUserSettingEmail(true);}s.getView().setModel(new J(d),'FEED');});};F.convertFeeds2ClientObject=function(o){if(!o.hasOwnProperty("CAMPAIGN_SETTING_VALUE")){o.CAMPAIGN_SETTING_VALUE=1;}if(!o.hasOwnProperty("IDEA_SETTING_VALUE")){o.IDEA_SETTING_VALUE=1;}if(!o.hasOwnProperty("TAG_SETTING_VALUE")){o.TAG_SETTING_VALUE=1;}return o;};F.newFeedsSave=function(){var s=this;var m=s.getView().getModel('NEWFEED');var d=m.getData();P.updateNewFeedsSettings({newfeeds:_(jQuery.extend(true,{},d.setting))}).done(function(){M.show(s.getText("FEEDS_SETTING_SAVE_SUCCESS"));if((m.getProperty("/setting/CAMPAIGN_SETTING_VALUE")||m.getProperty("/setting/IDEA_SETTING_VALUE")||m.getProperty("/setting/TAG_SETTING_VALUE"))&&m.getProperty("/setting/FEEDS_KEY")!==1){s.updateUserSettingEmail(true);}s.getView().setModel(new J(d),'NEWFEED');});};F.convertNewFeeds2ClientObject=function(o){if(!o){return o;}if(o.FEEDS_KEY){if(o.FEEDS_KEY===1){o.FEEDS_KEY=0;}else if(o.FEEDS_KEY===-1){o.FEEDS_KEY=1;}}else{o.FEEDS_KEY=0;}if(!o.hasOwnProperty("CAMPAIGN_SETTING_VALUE")){o.CAMPAIGN_SETTING_VALUE=1;}if(!o.hasOwnProperty("IDEA_SETTING_VALUE")){o.IDEA_SETTING_VALUE=1;}if(!o.hasOwnProperty("TAG_SETTING_VALUE")){o.TAG_SETTING_VALUE=1;}return o;};F.formatEnableMappingSettingFeedsKeyValue=function(v){return v!==1;};F.formatFeedEnableSettingValue=function(v){return v===1;};function _(o){if(!o){return o;}if(o.FEEDS_KEY||o.FEEDS_KEY===0){if(o.FEEDS_KEY===0){o.FEEDS_KEY=1;}else if(o.FEEDS_KEY===1){o.FEEDS_KEY=-1;}}if(o.CAMPAIGN_SETTING_VALUE){o.CAMPAIGN_SETTING_VALUE=1;}else{o.CAMPAIGN_SETTING_VALUE=0;}if(o.IDEA_SETTING_VALUE){o.IDEA_SETTING_VALUE=1;}else{o.IDEA_SETTING_VALUE=0;}if(o.TAG_SETTING_VALUE){o.TAG_SETTING_VALUE=1;}else{o.TAG_SETTING_VALUE=0;}return o;}return F;});};if(!jQuery.sap.isDeclared('sap.ino.vc.iam.mixins.NotificationSettingMixin')){jQuery.sap.declare('sap.ino.vc.iam.mixins.NotificationSettingMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.GroupHeaderListItem');sap.ui.define("sap/ino/vc/iam/mixins/NotificationSettingMixin",["sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ino/commons/models/object/PersonalizeSetting",'sap/m/GroupHeaderListItem'],function(J,M,P,G,U){"use strict";var N=function(){throw"Mixin may not be instantiated directly";};N.notificationSave=function(){var s=this;var m=s.getView().getModel('NOTIFICATION');var d=m.getData();P.updateNotificationSettings({notification:_(jQuery.extend(true,{},d.setting))}).done(function(){M.show(s.getText("NOTIFICATION_SETTING_SAVE_SUCCESS"));if(m.getProperty("/setting/KEY/0/SETTING_VALUE")!==3){s.updateUserSettingEmail(true);}s.getView().setModel(new J(d),'NOTIFICATION');});};N.NewNotificationSave=function(){var s=this;var m=s.getView().getModel('NEWNOTIFICATION');var d=m.getData();P.updateNewNotificationSettings({notification:a(jQuery.extend(true,{},d.setting))}).done(function(){M.show(s.getText("NOTIFICATION_SETTING_SAVE_SUCCESS"));if(m.getProperty("/setting/NEWKEY/0/SETTING_VALUE")!==3){s.updateUserSettingEmail(true);}s.getView().setModel(new J(d),'NEWNOTIFICATION');});};N.formatEnableMappingSettingValue=function(v){return v!==3;};N.formatEnableSettingValue=function(v){return v===1;};N.formatMappingSettingCode=function(m){return this.getText("NOTIFICATION_SETTING_"+m);};N.formatNewMappingSettingCode=function(m){return this.getText("NEWNOTIFICATION_SETTING_"+m);};N.getGroupHeader=function(g){var t=this;return new G({title:t.getText("NOTIFICATION_SETTING_SUBCATEGORYCODE_"+g.key),upperCase:false});};N.getNewGroupHeader=function(g){var t=this;return new G({title:t.getText("NEWNOTIFICATION_SETTING_ACTIONTYPECODE_"+g.key),upperCase:false});};N.convertNotification2ClientObject=function(o){if(!o){return o;}if(o.KEY&&o.KEY[0]){if(o.KEY[0].SETTING_VALUE===-1){o.KEY[0].SETTING_VALUE=3;}else if(o.KEY[0].SETTING_VALUE===7){o.KEY[0].SETTING_VALUE=2;}}else{o.KEY=[{}];o.KEY[0].SETTING_VALUE=0;}if(o.IDEA){for(var i=0;i<o.IDEA.length;i++){o.IDEA[i].order=parseInt(o.IDEA[i].CODE.substr(15),10);}o.IDEA=o.IDEA.sort(function(p,n){return p.order-n.order;});}if(o.CAMPAIGN){for(var c=0;c<o.CAMPAIGN.length;c++){o.CAMPAIGN[c].order=parseInt(o.CAMPAIGN[c].CODE.substr(15),10);}o.CAMPAIGN=o.CAMPAIGN.sort(function(p,n){return p.order-n.order;});}return o;};N.convertNewNotification2ClientObject=function(o){if(!o){return o;}if(o.NEWKEY&&o.NEWKEY[0]){if(o.NEWKEY[0].SETTING_VALUE===-1){o.NEWKEY[0].SETTING_VALUE=3;}else if(o.NEWKEY[0].SETTING_VALUE===7){o.NEWKEY[0].SETTING_VALUE=2;}}else{o.NEWKEY=[{}];o.NEWKEY[0].SETTING_VALUE=0;}return o;};function _(o){if(!o){return o;}if(o.KEY&&o.KEY[0]){if(o.KEY[0].SETTING_VALUE===3){o.KEY[0].SETTING_VALUE=-1;}else if(o.KEY[0].SETTING_VALUE===2){o.KEY[0].SETTING_VALUE=7;}}if(o.CAMPAIGN){for(var i=0;i<=o.CAMPAIGN.length-1;i++){if(o.CAMPAIGN[i].SETTING_VALUE){o.CAMPAIGN[i].SETTING_VALUE=1;}}}if(o.IDEA){for(var j=0;j<=o.IDEA.length-1;j++){if(o.IDEA[j].SETTING_VALUE){o.IDEA[j].SETTING_VALUE=1;}}}return o;}function a(o){if(!o){return o;}if(o.NEWKEY&&o.NEWKEY[0]){if(o.NEWKEY[0].SETTING_VALUE===3){o.NEWKEY[0].SETTING_VALUE=-1;}else if(o.NEWKEY[0].SETTING_VALUE===2){o.NEWKEY[0].SETTING_VALUE=7;}}if(o.CAMPAIGN){for(var i=0;i<=o.CAMPAIGN.length-1;i++){if(o.CAMPAIGN[i].SETTING_VALUE){o.CAMPAIGN[i].SETTING_VALUE=1;}}}if(o.IDEA){for(var j=0;j<=o.IDEA.length-1;j++){if(o.IDEA[j].SETTING_VALUE){o.IDEA[j].SETTING_VALUE=1;}}}if(o.FOLLOW){for(var n=0;n<=o.FOLLOW.length-1;n++){if(o.FOLLOW[n].SETTING_VALUE){o.FOLLOW[n].SETTING_VALUE=1;}}}if(o.STATUS){for(var m=0;m<=o.STATUS.length-1;m++){if(o.STATUS[m].SETTING_VALUE){o.STATUS[m].SETTING_VALUE=1;}}}return o;}return N;});};if(!jQuery.sap.isDeclared('sap.ino.vc.iam.mixins.ProfileDataMixin')){jQuery.sap.declare('sap.ino.vc.iam.mixins.ProfileDataMixin');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/iam/mixins/ProfileDataMixin",["sap/ino/commons/application/Configuration","sap/ino/commons/models/object/UserSettings","sap/ino/commons/models/object/Attachment","sap/m/MessageToast","sap/ino/commons/models/core/ModelSynchronizer","sap/ino/commons/models/object/PersonalizeSetting"],function(C,U,A,M,a,P){"use strict";var b=function(){throw"Mixin may not be instantiated directly";};b.getProfileDataSetting=function(){var u=C.getCurrentUser().USER_ID;var o=new U(u,{continuousUse:true,actions:["updateUserLocale"],readSource:{model:this.getDefaultODataModel()}});this.setObjectModel(o);this.bindDefaultODataModel(u);if(this._oUserDataModel){a.addAOInstanceDependency(o,this._oUserDataModel,function(c,d){if(c&&c.getProperty("/Settings")&&d){d.setProperty("/IMAGE_ID",c.getProperty("/Settings").TITLE_IMAGE_ID);}});}};b.formattermailLanguageText=function(d,c){return d;};b.setUserDataModel=function(u){this._oUserDataModel=u;};b.getODataEntitySet=function(){return"Identity";};b.onFileUploaderChange=function(e){var f=e.getSource();var F=e.getParameter("files");f.setBusy(true);A.prepareFileUploader(f,F);};b.onFileUploaderComplete=function(e){var r=A.parseUploadResponse(e.getParameter("responseRaw"));var f=e.getSource();if(r){var o=this.getObjectModel();if(r.success){o.setUserImage({"ATTACHMENT_ID":r.attachmentId,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType});}else{M.show(this.getText("SETTINGS_MSG_USER_IMAGE_FAILED"));}}else{M.show(this.getText("SETTINGS_MSG_USER_IMAGE_ERROR"));}f.setBusy(false);f.clear();};b.onImageSettingClear=function(e){var o=this.getObjectModel();o.clearUserImage();var f=this.byId("imageSettingUploader");f.setValue(null);};b.onImageSettingCrop=function(){var i=this.byId("imageSettingCropping");this._cropImage(i);};b.formatConsentTermsCondiftions=function(v){return C.getSystemSetting("sap.ino.config.TERMS_AND_CONDITIONS_ACTIVE")==='1';};b._cropImage=function(i){var t=this;var d=jQuery.Deferred();var f=i.crop();if(f){jQuery.sap.require("sap.ino.commons.models.object.Attachment");var A=sap.ino.commons.models.object.Attachment;var o=t.getObjectModel();var s=o.getProperty('/Settings/TITLE_IMAGE_ID');A.uploadFile(f,null,s,true).done(function(r){o.setUserImage({"ATTACHMENT_ID":r.attachmentId||s,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType});d.resolve({messages:[{"TYPE":"I","MESSAGE":"SETTINGS_MSG_USER_IMAGE_CROP","MESSAGE_TEXT":t.getText("SETTINGS_MSG_USER_IMAGE_CROP"),"REF_FIELD":""}]});}).fail(function(){M.show(t.getText("SETTINGS_MSG_USER_IMAGE_CROP_FAILED"));d.reject();});}else{d.resolve();}return d.promise();};b.onSettingsOk=function(){var t=this;var n=t.byId("settingMAIL");var _=function(){var o=t.getObjectModel();var l=t.byId("settingLOCALE");var h=t.byId("settingHCB");var H=h.getSelected()?U.Theme.HCB:"";t._sHCBPropOLD=o._oBeforeData.Settings.THEME;t._sHCBPropOLD=(t._sHCBPropOLD===null)?"":t._sHCBPropOLD;t._sLocalePropOLD=o._oBeforeData.Settings.LOCALE;t._sLocalePropOLD=(t._sLocalePropOLD===null)?"":t._sLocalePropOLD;t._sConsentTermsConditionPropOLD=o._oBeforeData.Settings.CONSENT_TERMS_CONDITIONS;t._sConsentTermsConditionPropOLD=(t._sConsentTermsConditionPropOLD===null)?"":t._sConsentTermsConditionPropOLD;var g=[{SECTION:"locale",KEY:"locale",VALUE:l.getSelectedKey()},{SECTION:"notification",KEY:"mail",VALUE:n&&n.getSelected()?U.Mail.Inactive:U.Mail.Active},{SECTION:"ui",KEY:"theme",VALUE:H}];if(C.getSystemSetting("sap.ino.config.TERMS_AND_CONDITIONS_ACTIVE")==='1'){var j=t.byId("settingTermsConditions");g.push({SECTION:"system",KEY:"consent_terms_condition",VALUE:j&&j.getSelected()?0:1});}var r=o.updateUserSettings(g);o.modify();r.done(function(){C.refreshBackendConfiguration();if(t.isEnableNewNotification){t.getNewNotificationSetting();t.getNewFeedsSetting();}else{t.getNotificationSetting();t.getFeedsSetting();}t.getOwnerComponent().getModel("user").setProperty("/data/IDENTITY_IMAGE_ID",o.getProperty("/IDENTITY_IMAGE_ID"));M.show(t.getText("FEEDS_SETTING_SAVE_SUCCESS"));});r.always(function(){var s=o.getProperty("/Settings/THEME");s=(s===null)?"":s;var L=o.getProperty("/Settings/LOCALE");L=(L===null)?"":L;if(C.getSystemSetting("sap.ino.config.TERMS_AND_CONDITIONS_ACTIVE")==='1'&&o.getProperty("/Settings/CONSENT_TERMS_CONDITIONS")!==t._sConsentTermsConditionPropOLD){location.reload();return;}var R=(L!==t._sLocalePropOLD)||(s!==t._sHCBPropOLD);if(R){t._openRestartDialog();}});};var c=function(){var D=jQuery.Deferred();var N={KEY:[{CODE:null,MAPPING_SETTING_CODE:"KEY",OBJECT_TYPE_CODE:"NOTIFICATION_KEY",SETTING_VALUE:-1,SUBCATEGORY_CODE:null}]};if(n&&!n.getSelected()){N={KEY:[{CODE:null,MAPPING_SETTING_CODE:"KEY",OBJECT_TYPE_CODE:"NOTIFICATION_KEY",SETTING_VALUE:0,SUBCATEGORY_CODE:null}]};}P.updateNotificationSettings({notification:N}).done(function(){D.resolve();}).fail(function(){D.reject();});return D.promise();};var d=function(){var D=jQuery.Deferred();var N={NEWKEY:[{ACTION_CODE:"NEWKEY",ACTION_TYPE_CODE:"NEWKEY",SETTING_VALUE:-1}]};if(n&&!n.getSelected()){N={NEWKEY:[{ACTION_CODE:"NEWKEY",ACTION_TYPE_CODE:"NEWKEY",SETTING_VALUE:0}]};}P.updateNewNotificationSettings({notification:N}).done(function(){D.resolve();}).fail(function(){D.reject();});return D.promise();};var e=function(){var D=jQuery.Deferred();var F={"feeds":{"CAMPAIGN_SETTING_VALUE":false,"IDEA_SETTING_VALUE":false,"TAG_SETTING_VALUE":false}};if(n&&!n.getSelected()){F={"feeds":{"CAMPAIGN_SETTING_VALUE":true,"IDEA_SETTING_VALUE":true,"TAG_SETTING_VALUE":true}};}P.updateFeedsSettings(F).done(function(){D.resolve();}).fail(function(){D.reject();});return D.promise();};var f=function(){var D=jQuery.Deferred();var N={"newfeeds":{"FEEDS_KEY":-1,"CAMPAIGN_SETTING_VALUE":0,"IDEA_SETTING_VALUE":0,"TAG_SETTING_VALUE":0}};if(n&&!n.getSelected()){N={"newfeeds":{"FEEDS_KEY":1,"CAMPAIGN_SETTING_VALUE":1,"IDEA_SETTING_VALUE":1,"TAG_SETTING_VALUE":1}};}P.updateNewFeedsSettings(N).done(function(){D.resolve();}).fail(function(){D.reject();});return D.promise();};var i=this.byId("imageSettingCropping");if(t.isEnableNewNotification){jQuery.when(this._cropImage(i),d(),f()).done(_);}else{jQuery.when(this._cropImage(i),c(),e()).done(_);}};return b;});};if(!jQuery.sap.isDeclared('sap.ino.vc.iam.mixins.UserCommonMixin')){jQuery.sap.declare('sap.ino.vc.iam.mixins.UserCommonMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/iam/mixins/UserCommonMixin",["sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/UserSettings","sap/ino/commons/models/object/PersonalizeSetting"],function(C,J,U,P){"use strict";var a=function(){throw"Mixin may not be instantiated directly";};a.updateUserSettingEmail=function(e){var o=this.getObjectModel();o.updateUserSettings([{SECTION:"notification",KEY:"mail",VALUE:!e?U.Mail.Inactive:U.Mail.Active}]).done(function(){C.refreshBackendConfiguration();});};a.getNotificationSetting=function(){var s=this;P.getNotificationSettings().done(function(d){var b={setting:s.convertNotification2ClientObject(jQuery.extend(true,{},d.RESULT))};s.getView().setModel(new J(b),'NOTIFICATION');});};a.getNewNotificationSetting=function(){var s=this;P.getNewNotificationSettings().done(function(d){var b={setting:s.convertNewNotification2ClientObject(jQuery.extend(true,{},d.RESULT))};s.getView().setModel(new J(b),'NEWNOTIFICATION');});};a.getFeedsSetting=function(){var s=this;P.getFeedsSettings().done(function(d){var b={setting:s.convertFeeds2ClientObject(jQuery.extend(true,{},d.RESULT))};s.getView().setModel(new J(b),'FEED');});};a.getNewFeedsSetting=function(){var s=this;P.getNewFeedsSettings().done(function(d){var b={setting:s.convertNewFeeds2ClientObject(jQuery.extend(true,{},d.RESULT))};s.getView().setModel(new J(b),'NEWFEED');});};return a;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.DeleteActionMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.DeleteActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/idea/mixins/DeleteActionMixin",["sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Idea","sap/ino/commons/models/object/RewardList","sap/ino/commons/models/object/EvaluationRequestItem","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/application/Configuration","sap/m/MessageToast"],function(B,J,I,R,E,P,C,M){"use strict";var D=function(){throw"Mixin may not be instantiated directly";};D.onDeleteIdea=function(e){var s=e.getSource();var i=s.getBindingContext("data").getProperty("ID");var S={nodes:[],actions:["del"]};var t=this;var p=C.getSystemSettingsModel().getProperty("/sap.ino.config.PPM_INTEGRATION_ACTIVE");var d=function(a){var b=a.getSource();var c=b.getProperty("/actions/del/enabled");var h=b.getProperty("/actions/del/customProperties/hasReward");var f=b.getProperty("/actions/del/customProperties/isMergeedWithVote");var g=b.getProperty("/actions/del/customProperties/isMerged");if(h){M.show(t.getText("MSG_IDEA_HAVE_REWARD_CANNOT_DELETE"));}else if(!c){if(g){M.show(t.getText("MSG_IDEA_MERGED_CANNOT_DELETE"));}else{M.show(t.getText("OBJECT_MSG_DELETE_FAILED"));}}else{var H=s.getBindingContext("data").getProperty("EVALUATION_COUNT");var j=b.getProperty("/actions/del/customProperties/isManager");if(!H||(H&&j)){var m=p==="1"?"MSG_IDEA_CAMP_MANAGER_DEL_CONFIRM_HAVE_PPM":"MSG_DEL_CONFIRM";var k=B.prototype.executeObjectAction.call(t,I,"del",{staticparameters:i,messages:{confirm:m,success:"MSG_DEL_SUCCESS"}});k.done(function(r){if(r&&r.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(t.bindList&&typeof(t.bindList)==="function"){t.bindList();}else if(t._bindIdeas&&typeof(t._bindIdeas)==="function"&&t._sIdeaViewKey){t._bindIdeas(t._sIdeaViewKey);}});k.fail(function(r){if(r.MESSAGES&&r.MESSAGES.length>0){M.show(r.MESSAGES[0].MESSAGE_TEXT);}});}else{M.show(this.getText("MSG_IDEA_DEL_FAILED_SUBMITTER_HAVE_EVALUATION"));}}};var o=new P("sap.ino.xs.object.idea.Idea",i,S,false,d);};D.onMassDeleteReward=function(e){var s=e.getSource();var t=this.getTable();var r=[];var a=[];var S=t.getSelectedIndices();if(S.length){for(var i=0;i<S.length;i++){r.push(t.getContextByIndex(S[i]).getProperty("ID"));if(a.indexOf(t.getContextByIndex(S[i]).getProperty("REWARD_LIST_ID"))===-1){a.push(t.getContextByIndex(S[i]).getProperty("REWARD_LIST_ID"));}}}var b=this;var d=B.prototype.executeObjectAction.call(b,R,"bulkDeleteRewards",{staticparameters:{"REWARD_ID":r,"REWARD_LIST_ID":a},messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});d.done(function(o){if(o&&o.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(b.bindList&&typeof(b.bindList)==="function"){b.bindList();}});};D.onMassDeleteEvalReq=function(e){var s=e.getSource();var t=this.getTable();var S=t.getSelectedIndices();var a=[];if(S.length){for(var i=0;i<S.length;i++){a.push(t.getContextByIndex(S[i]).getProperty("ID"));}}var b=this;var d=B.prototype.executeObjectAction.call(b,E,"bulkDeleteItems",{staticparameters:{"EVAL_REQ_ITEM_ID":a},messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});d.done(function(r){if(r&&r.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(b.bindList&&typeof(b.bindList)==="function"){b.bindList();}});};return D;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.DuplicateActionMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.DuplicateActionMixin');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.CheckBox');sap.ui.define("sap/ino/vc/idea/mixins/DuplicateActionMixin",["sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/commons/models/object/Idea","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ino/commons/models/aof/PropertyModel","sap/m/CheckBox"],function(F,a,I,J,M,P,C){"use strict";var D=function(){throw"Mixin may not be instantiated directly";};D._getMarkDuplicateFromClipboardDialog=function(){if(!this._oAddMarkDuplicateFromClipboardDialog){this._oAddMarkDuplicateFromClipboardDialog=this.createFragment("sap.ino.vc.idea.fragments.AddDuplicateIdeaFromClipboard");this.getView().addDependent(this._oAddMarkDuplicateFromClipboardDialog);this._sResizeDuplicateDialog=this.attachListControlResized(this.byId("AddDuplicateIdeaList"));}return this._oAddMarkDuplicateFromClipboardDialog;};D.onAfterClose=function(){var d=this._getMarkDuplicateFromClipboardDialog();this.detachListControlResized(this._sResizeDuplicateDialog);this.getView().removeDependent(d);d.destroy();this._oAddMarkDuplicateFromClipboardDialog=undefined;this.getModel("duplicate").destroy();};D.getDuplicateItemTemplate=function(){if(!this._oIdeaDupClipboardListItemTemplate){this._oIdeaDupClipboardListItemTemplate=this.createFragment("sap.ino.vc.idea.fragments.FlatListItem",this.getView().getId()+"--duplicate");var A=sap.ui.core.Fragment.byId(this.getView().getId()+"--duplicate","flatListIdeaActions");var c=new C({selected:{parts:[{path:"data>ID"},{path:"duplicate>/selectedDupIdeas"}],formatter:this.isClipboardIdeaSelected},select:this.onAddFromClipboardIdeaSelected.bind(this)});A.addItem(c);}return this._oIdeaDupClipboardListItemTemplate;};D.onMarkDuplicateFromClipboard=function(){var d=this._getMarkDuplicateFromClipboardDialog();var o=new J();o.setProperty("/selectedDupIdeas",[]);this.getView().setModel(o,"duplicate");this._bindFromClipboard();d.open();};D.onAddFromClipboardDialogCancel=function(e){this._getMarkDuplicateFromClipboardDialog().close();};D.onAddFromClipboardDialogOK=function(e){var s=this.getModel("duplicate").getProperty("/selectedDupIdeas");if(s&&s.length>0){var t=this;var v=this.getView();v.setBusy(true);var i=t.getObjectModel().getProperty("/ID");var m=s.map(function(o){return I.markAsDuplicate(o.id,[i]);});jQuery.when.apply(jQuery,m).always(function(){v.setBusy(false);t._getMarkDuplicateFromClipboardDialog().close();}).done(function(){t.rebindRelatedItemsList();}).fail(function(){M.show(t.getText("IDEA_RELATED_TIT_MARK_AS_DUPLICATE_FAILED"));});}};D.onAddFromClipboardDialogSelectAll=function(e){var s=[];var l=this.byId("AddDuplicateIdeaList");var L=l.getAggregation("items")||[];jQuery.each(L,function(i,o){s.push({id:o.getBindingContext("data").getProperty("ID")});});this.getModel("duplicate").setProperty("/selectedDupIdeas",s);};D._bindFromClipboard=function(){var l=this.byId("AddDuplicateIdeaList");var c=this._getClipboardModel().getObjectKeys(I);var i=this.getObjectModel().getProperty("/ID");c=c.filter(function(b){return b!==i;});var t=this;if(c.length>0){var m=c.map(function(b){var p=new P("sap.ino.xs.object.idea.Idea",b,{actions:[{"markAsDuplicate":[i]},{"unmarkAsDuplicate":[i]}]},false);return p.getDataInitializedPromise();});var u=[];jQuery.when.apply(jQuery,m).done(function(){jQuery.each(arguments,function(b,d){if(d&&d.actions&&d.actions.markAsDuplicate.enabled){u.push(c[b]);}});c=jQuery.grep(c,function(b){return u.indexOf(b)>-1;});var f=t._getClipboardItemsFilter(c);if(f.length>0){l.bindAggregation("items",{path:"data>/IdeaMedium",template:t.getDuplicateItemTemplate(),filters:f});}else{l.unbindAggregation("items");}});}else{l.unbindAggregation("items");}};D._getClipboardItemsFilter=function(c){var f=[];jQuery.each(c,function(i,b){f.push(new F({path:"ID",operator:a.EQ,value1:b}));});return(f.length===0)?[]:[new F(f,false)];};D.isClipboardIdeaSelected=function(i){var s=this.getModel("duplicate").getProperty("/selectedDupIdeas");if(!s){return false;}var m=jQuery.grep(s,function(o){return o.id===i;});return m.length>0;};D.onAddFromClipboardIdeaSelected=function(e){var s=e.getSource();var S=e.getParameter("selected");var i=s.getBindingContext("data").getProperty("ID");var b=this.getModel("duplicate").getProperty("/selectedDupIdeas").slice(0);var m=jQuery.grep(b,function(o){return o.id===i;});if(S&&m.length===0){b.push({id:i});}else if(!S&&m.length!==0){b=jQuery.grep(b,function(o){return o.id!==i;});}this.getModel("duplicate").setProperty("/selectedDupIdeas",b);};D.onDuplicate=function(e){var t=this;var s=e.getSource();var d=e.getSource()&&e.getSource().getBindingContext("data")&&e.getSource().getBindingContext("data").getProperty("ID");var i=this.getObjectModel().getProperty("/ID");var p=new P("sap.ino.xs.object.idea.Idea",d,{actions:[{"markAsDuplicate":[i]},{"unmarkAsDuplicate":[i]}]},false);p.getDataInitializedPromise().done(function(o){if(o&&o.actions&&o.actions.markAsDuplicate&&o.actions.unmarkAsDuplicate){t.setModel(new J(o),"duplicate");t.getModel("duplicate").setProperty("/duplicateIdeaId",d);t._openDuplicateActionSheet(s);}});};D._openDuplicateActionSheet=function(s){if(!this._oDuplicateActionSheet){this._oDuplicateActionSheet=this.createFragment("sap.ino.vc.idea.fragments.DuplicateActionSheet",this.getView().getId());this.getView().addDependent(this._oDuplicateActionSheet);}jQuery.sap.delayedCall(0,this,function(){this._oDuplicateActionSheet.openBy(s);});};D.onUnmarkAsDuplicate=function(){this.onMark(I.unmarkAsDuplicate,this.getText("IDEA_RELATED_TIT_UNMARK_AS_DUPLICATE_FAILED"));};D.onMarkAsDuplicate=function(){this.onMark(I.markAsDuplicate,this.getText("IDEA_RELATED_TIT_MARK_AS_DUPLICATE_FAILED"));};D.onMark=function(m,t){var i=this.getObjectModel().getProperty("/ID");var d=this.getModel("duplicate")&&this.getModel("duplicate").getProperty("/duplicateIdeaId");var b=this;if(d){m(d,[i]).done(function(){b.rebindRelatedItemsList();}).fail(function(){M.show(t);});}};D.rebindRelatedItemsList=function(){var l=this.byId("idealist-related");l.bindItems(l.getBindingInfo("items"));};return D;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.IdeaReadMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.IdeaReadMixin');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/idea/mixins/IdeaReadMixin",["sap/ino/commons/models/object/IdeaRead","sap/m/MessageToast","sap/ino/commons/models/core/CodeModel","sap/ui/model/json/JSONModel"],function(I,M,C,J){"use strict";var i=function(){throw"Mixin may not be instantiated directly";};i.checkIdeaRead=function(a){return!!a;};i.isRead=function(a){return!a;};i.onMarkRead=function(e){var s=e.getSource();var c=s.getCustomData()&&s.getCustomData();var r=c[0]&&c[0].getValue();var a=c[1]&&c[1].getValue();I.markRead(r,{IDEA_ID:a}).done(function(d){if(d){s.setEnabled(false);s.setProperty('enabled',false);}});};return i;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.VolunteerMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.VolunteerMixin');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/idea/mixins/VolunteerMixin",["sap/ino/commons/models/object/IdeaVolunteer","sap/m/MessageToast","sap/ui/model/json/JSONModel"],function(I,M,J){"use strict";var V=function(){throw"Mixin may not be instantiated directly";};V.toggleVolunteer=function(e){var k=e.getParameter("Key");var v=e.getParameter("Value");var i=e.getParameter("IdeaId");var s=this;var o=e.getSource();if(!k){this.oIdeaVolunteerModel=new J();}var a=v?"VOLUNTEERS_LEAVE_SUCCESS":"VOLUNTEERS_ADD_SUCCESS";var r=I.toggleVolunteer(k,i);if(o.setEnabled){o.setEnabled(false);}r.done(function(e){var b=sap.ui.getCore().byId("volunteerView--volunteerlist");if(b){var B=b.getBindingInfo("items");b.bindItems(B);}M.show(s.getText(a));if(s.oIdeaVolunteerModel){var R={ID:e.GENERATED_IDS?e.GENERATED_IDS[-1]:null};s.oIdeaVolunteerModel.setProperty("/"+i,R);}if(o.setEnabled){o.setEnabled(true);}if(s.isGlobalSearch){s.getSearchResult(s.getViewProperty("/SEARCH_QUERY"));}});r.fail(function(){if(o.setEnabled){o.setEnabled(true);}});};return V;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.VoteMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.VoteMixin');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/idea/mixins/VoteMixin",["sap/ino/commons/models/object/Vote","sap/ino/commons/models/object/IdeaFollow","sap/m/MessageToast","sap/ino/commons/models/core/CodeModel","sap/ui/model/json/JSONModel"],function(V,I,M,C,J){"use strict";var v={COM:"Company",COST:"Cost Center",ORG:"Organization",OFF:"Office"};var o={TYPE_STAR:"STAR",TYPE_LIKE:"LIKE",TYPE_LIKE_DISLIKE:"LIKE_DISLIKE"};var a=function(){throw"Mixin may not be instantiated directly";};a.onUserVote=function(e){var d=this.getVoteMixinDialog();var i=e.getParameter('objectId');var p=this.getPropertyUrl(i);var s=this.getModel('data').getProperty(p+'/VOTE_COMMENT_TYPE');var b=this.getModel('data').getProperty(p+'/VOTE_REASON_CODE');var P=this.getModel('data').getProperty(p+'/PUBLIC_VOTE');var c;this.dialogParameters=e.getParameters();this.dialogSource=e.getSource();this.resetClientMessages();var m=new sap.ui.getCore().getMessageManager();m.removeAllMessages();var f=e.getParameter('voteId');if(!f){this.oIdeaVoteModel=new J();}if(!s||s===null||s===''){return this.onSubmit();}if(!this.dialogSource.getProperty('value')){return this.onSubmit();}if(s==='LIST'&&b){var g="sap.ino.xs.object.basis.ValueOptionList.ValueOptions";c=C.getCodes(g,function(j){return j.LIST_CODE===b&&j.ACTIVE===1;});}var h={VOTE_COMMENT_TYPE:s,VOTE_REASON_CODE:b,VOTE_COMMENT_LIST:c,PUBLIC_VOTE:P,VOTE_COMMENT:"",VOTE_REASON:c&&c[0].CODE||""};this.oVoteModel=new J();this.oVoteModel.setData(h);d.setModel(this.oVoteModel,"vote");d.open();};a.getPropertyUrl=function(i){var p=['IdeaMediumCommunity','MyIdeaMediumCommunity','IdeaMediumBackofficeSearch','IdeaFull'];return this.CheckProperty(p,i);};a.CheckProperty=function(l,b){var k=l,p;if(!k||!b){return false;}for(var i=0;i<k.length;i++){p=this.getEntityKey(k[i],b);if(p){return'/'+p;}}};a.getEntityKey=function(e,k){var c=new RegExp("^"+e+"\\(.*"+k+"\\)$");var b=new RegExp("^"+e+"\\(.*(')("+k+")\\1\\)$");var d=new RegExp("^"+e+"\\(.*="+k+"\\)$");var f=new RegExp("^"+e+"\\(.*(=')("+k+")\\1\\)$");var D=this.getModel('data').getProperty("/");var E;var g=[];jQuery.each(D,function(K){if(c.test(K)||b.test(K)){g.push(K);}});if(g.length>1){g.forEach(function(K){if(d.test(K)||f.test(K)){E=K;}});}else{E=g&&g[0];}return E;};a.onSubmit=function(e){var s=this;var b;var c=this.dialogSource;var d=this._oVoteMixinDialog.getModel('vote')?this._oVoteMixinDialog.getModel('vote').getProperty('/VOTE_REASON'):'';var f=this._oVoteMixinDialog.getModel('vote')?this._oVoteMixinDialog.getModel('vote').getProperty('/VOTE_COMMENT'):'';var i=this.dialogParameters.objectId;var S=this.dialogParameters.value;var g=this.dialogParameters.voteId;var r=this.routes&&this.routes.length?this.routes[0]:undefined;if(!this.hasAnyClientErrorMessages()){b=V.vote(i,S,g,d,f);if(c.setEnabled){c.setEnabled(false);}}var p=this.getPropertyUrl(this.dialogParameters.objectId);var h=this.getModel('data').getProperty(p+'/VOTED_BY_GROUP');var F=this.getModel('data').getProperty(p+'/FOLLOW');var A=this.getModel('data').getProperty(p+'/AUTO_FOLLOW');var j=this.getModel('data').getProperty(p+'/VOTE_TYPE_TYPE_CODE');var k=true;var l=b.mode;if(b){if(l==="DEL_VOTE"){b.vote.done(function(){var L="voteView--voteList";var m=sap.ui.getCore().byId(L);if(m){var B=m.getBindingInfo("items");m.bindItems(B);}if(!h){M.show(s.getText("VOTE_MSG_REMOVE_VOTE_SUCCESS"));}else{M.show(s.getText("VOTE_MSG_REMOVE_VOTE_BY_GROUP_SUCCESS",[v[h]]));var G=sap.ui.getCore().byId("voteView--groupVoteList");if(G){var n=G.getBindingInfo("items");G.bindItems(n);}}var q={ID:null,SCORE:0};if(s.oIdeaVoteModel){s.oIdeaVoteModel.setProperty("/"+i,q);}if(c.setEnabled){c.setEnabled(true);}if(s.isGlobalSearch){s.getSearchResult(s.getViewProperty("/SEARCH_QUERY"));}});}else if(l==="MODIFY_VOTE"){b.vote.done(function(e){var L="voteView--voteList";var m=sap.ui.getCore().byId(L);if(m){var B=m.getBindingInfo("items");m.bindItems(B);}if(!h){M.show(s.getText("VOTE_MSG_VOTE_SUCCESS"));}else{M.show(s.getText("VOTE_MSG_VOTE_BY_GROUP_SUCCESS",[v[h]]));var G=sap.ui.getCore().byId("voteView--groupVoteList");if(G){var n=G.getBindingInfo("items");G.bindItems(n);}}var q={ID:e.GENERATED_IDS[-1]||g,SCORE:S};if(s.oIdeaVoteModel){s.oIdeaVoteModel.setProperty("/"+i,q);}if(c.setEnabled){c.setEnabled(true);}if(j==="STAR"){var t=s.getModel('data').getProperty(p+'/MAX_STAR_NO');k=S&&t&&S>=(t-1)?true:false;}else if(j==="LIKE_DISLIKE"){k=S>0?true:false;}if(!F&&A&&k){s.onVotedFollow();}if(s.isGlobalSearch){s.getSearchResult(s.getViewProperty("/SEARCH_QUERY"));}});}b.vote.fail(function(m){if(c.setEnabled){c.setEnabled(true);}M.show(m.MESSAGES.length===1?m.MESSAGES[0].MESSAGE_TEXT:s.getText("VOTE_MSG_VOTING_NOT_POSSIBLE"));});this.getVoteMixinDialog().setModel("","vote");return this.getVoteMixinDialog().close();}};a.onVotedFollow=function(){var t=this;var i=this.dialogParameters.objectId;var f=I.follow(i,"IDEA",0);f.done();};a.globalSearchAllVoteCount=function(b,c){var d=this.getModel("data");var e=this.dialogParameters;var s=d.oData.Ideas.data;var i=e.objectId;var f,g;jQuery.each(s,function(j,k){if(k.ID===i){f=k;g=j;return false;}});if(f){switch(f.VOTE_TYPE_TYPE_CODE){case o.TYPE_LIKE:if(b==="MODIFY_VOTE"){f.VOTE_COUNT+=1;}else{f.VOTE_COUNT-=1;}f.USER_SCORE=e.value;f.SCORE=f.VOTE_COUNT;f.VOTE_ID=c.ID;break;case o.TYPE_LIKE_DISLIKE:if(b==="MODIFY_VOTE"){f.NEG_VOTES=e.value===-1?f.NEG_VOTES+1:f.NEG_VOTES;f.POS_VOTES=e.value===1?f.POS_VOTES+1:f.POS_VOTES;f.POS_VOTES=e.value===-1&&e.oldValue===1?f.POS_VOTES-1:f.POS_VOTES;f.NEG_VOTES=e.value===1&&e.oldValue===-1?f.NEG_VOTES-1:f.NEG_VOTES;}else{f.POS_VOTES=e.oldValue===1?f.POS_VOTES-1:f.POS_VOTES;f.NEG_VOTES=e.oldValue===-1?f.NEG_VOTES-1:f.NEG_VOTES;}f.USER_SCORE=e.value;f.VOTE_ID=c.ID;break;case o.TYPE_STAR:var S=f.SCORE*f.VOTE_COUNT;var h=f.USER_SCORE;if(b==="MODIFY_VOTE"){f.VOTE_COUNT=f.USER_SCORE?f.VOTE_COUNT:f.VOTE_COUNT+1;}else{f.VOTE_COUNT=f.VOTE_COUNT-1;}f.USER_SCORE=e.value;f.SCORE=f.VOTE_COUNT?(S+f.USER_SCORE-h)/f.VOTE_COUNT:0;f.VOTE_ID=c.ID;break;default:break;}d.setProperty("/Ideas/data/"+g,f);}};a.onCloseDialog=function(e){this.dialogSource.setValue(this.dialogParameters.oldValue);this.getVoteMixinDialog().setModel("","vote");return this.getVoteMixinDialog().close();};a.getVoteMixinDialog=function(){if(!this._oVoteMixinDialog){this._oVoteMixinDialog=this.createFragment('sap.ino.vc.idea.fragments.VoteMixin');this.getView().addDependent(this._oVoteMixinDialog);}return this._oVoteMixinDialog;};a.transitionTitle=function(b){var t,c;var p=this.dialogParameters;if(b){t=C.getText("sap.ino.xs.object.basis.ValueOptionList.Root",b);}else{t=this.getText('IDEA_VOTE_DEFAULT_TITLE');}switch(p.type){case'LIKE':c='IDEA_VOTE_LIKE';break;case'LIKE_DISLIKE':c=p.value===1?'IDEA_VOTE_LIKE':'IDEA_VOTE_DISLIKE';break;case'STAR':c='IDEA_VOTE_STAR';break;default:c='IDEA_VOTE_LIKE';break;}return this.getText(c,[t]);};a.onIdeaCommentPress=function(E){var i;if(E.getParameter("ideaId")){i=E.getParameter("ideaId");}else{try{if(E.getSource().getProperty("objectId")){i=E.getSource().getProperty("objectId");}}catch(e){i=E.getSource().getBindingContext("data").getProperty("ID");}}if(i){this.navigateTo("idea-display",{id:i,query:{section:"sectionComments"}});}};return a;});};if(!jQuery.sap.isDeclared('sap.ino.vc.reward.mixins.MassActionMixin')){jQuery.sap.declare('sap.ino.vc.reward.mixins.MassActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/reward/mixins/MassActionMixin",["sap/ui/model/json/JSONModel","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/models/object/RewardList","sap/ino/vc/commons/BaseController"],function(J,P,R,B){"use strict";var M=function(){throw"Mixin may not be instantiated directly";};M.onMassDelete=function(e){var s=e.getSource();var t=this.getList();var r=[];var a=[];var S=t.getSelectedIndices();if(S.length){for(var i=0;i<S.length;i++){r.push(t.getContextByIndex(S[i]).getProperty("ID"));if(a.indexOf(t.getContextByIndex(S[i]).getProperty("REWARD_LIST_ID"))===-1){a.push(t.getContextByIndex(S[i]).getProperty("REWARD_LIST_ID"));}}}var b=this;var d=B.prototype.executeObjectAction.call(b,R,"bulkDeleteRewards",{staticparameters:{"REWARD_ID":r,"REWARD_LIST_ID":a},messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});d.done(function(o){if(o&&o.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(b.bindList&&typeof(b.bindList)==="function"){b.bindList();}});};M.resetActionState=function(){var t=this;var b=["sapInoMassExportBtn","sapInoMassDeleteBtn"];jQuery.each(b,function(i,e){var o=t.byId(e);if(o){o.setEnabled(false);}});};return M;});};if(!jQuery.sap.isDeclared('sap.ino.commons.application.BaseComponent')){jQuery.sap.declare('sap.ino.commons.application.BaseComponent');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.model.resource.ResourceModel');jQuery.sap.require('sap.ui.model.odata.v2.ODataModel');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/commons/application/BaseComponent",["sap/ui/core/UIComponent","sap/ui/model/json/JSONModel","sap/ui/Device","sap/ui/core/MessageType","sap/ino/commons/application/Configuration","sap/ino/commons/application/WebAnalytics","sap/ui/model/resource/ResourceModel","sap/ino/commons/models/core/CodeModel","sap/ino/commons/models/core/ClipboardModel","sap/ino/commons/models/core/ModelSynchronizer","sap/ui/model/odata/v2/ODataModel","sap/ui/core/IconPool","sap/ino/commons/models/misc/Notifications","sap/m/MessageBox"],function(U,J,D,M,C,W,R,a,b,c,O,I,N,d){"use strict";var v="2024-09-24 08:05:15";var f=[{"TEXT":"BREAD_HOME_TITLE_TEXT","name":"home","target":"home","available":"all","path":"home"},{"name":"home-explicit","target":"home"},{"variant":true,"TEXT":"PAGE_TIT_IDEAS","MANAGETEXT":"PAGE_TIT_IDEAS","name":"idealist","target":"idealist","available":"idea-display","path":"home/idealist"},{"variant":true,"name":"idealistvariant","target":"idealist","available":"idea-display","path":"home/idealistvariant"},{"variant":true,"TEXT":"PAGE_TIT_WALLS","name":"walllist","target":"walllist","available":"wall","path":"home/walllist"},{"variant":true,"name":"walllistvariant","target":"walllist","path":"home/walllist"},{"oData":"Wall","pattern":"id","title":"BREAD_WALL_TITLE_TEXT","name":"wall","available":"wall","target":"wall","path":"home/walllist/wall"},{"oData":"Wall","pattern":"id","name":"wallremote","target":"wallremote","path":"home/walllist/wallremote","available":"wall"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-headline","target":"wallremoteitem-headline","path":"home/walllist/wallremote/wallremoteitem-headline"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-sticker","target":"wallremoteitem-sticker","path":"home/walllist/wallremote/wallremoteitem-sticker"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-link","target":"wallremoteitem-link","path":"home/walllist/wallremote/wallremoteitem-link"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-image","target":"wallremoteitem-image","path":"home/walllist/wallremote/wallremoteitem-image"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-text","target":"wallremoteitem-text","path":"home/walllist/wallremote/wallremoteitem-text"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-sprite","target":"wallremoteitem-sprite","path":"home/walllist/wallremote/wallremoteitem-sprite"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-person","target":"wallremoteitem-person","path":"home/walllist/wallremote/wallremoteitem-person"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-video","target":"wallremoteitem-video","path":"home/walllist/wallremote/wallremoteitem-video"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-attachment","target":"wallremoteitem-attachment","path":"home/walllist/wallremote/wallremoteitem-attachment"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-group","target":"wallremoteitem-group","path":"home/walllist/wallremote/wallremoteitem-group"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-line","target":"wallremoteitem-line","path":"home/walllist/wallremote/wallremoteitem-line"},{"oData":"Wall","pattern":"id","name":"wallremoteitem-arrow","target":"wallremoteitem-arrow","path":"home/walllist/wallremote/wallremoteitem-arrow"},{"variant":true,"TEXT":"PAGE_TIT_CAMPAIGNS","name":"campaignlist","target":"campaignlist","available":"campaign","path":"home/campaignlist"},{"variant":true,"name":"campaignlistvariant","target":"campaignlist","available":"campaign","path":"home/campaignlistvariant"},{"TEXT":"PAGE_TIT_PEOPLE","name":"peoplelist","target":"peoplelist","path":"home/peoplelist"},{"name":"peoplelistvariant","target":"peoplelist","path":"home/peoplelistvariant"},{"TEXT":"PAGE_TIT_EXPERTFINDER","name":"expertfinder","target":"expertfinder","path":"home/expertfinder"},{"oData":"IdeaSmall","pattern":"id","title":"BREAD_IDEA_TITLE_TEXT","name":"idea-display","target":"idea-display","available":"evaluation-display/evaluation-create/evaluationrequest-create/evaluationrequest-display/evaluationrequest-edit/idea-display","path":"home/campaignlist/campaign/campaign-idealist/idea-display"},{"TEXT":"PAGE_TIT_IDEA_EDIT","oData":"IdeaSmall","name":"idea-edit","target":"idea-modify","path":"home/idealist/idea-display/idea-edit"},{"TEXT":"PAGE_TIT_IDEA_CREATE","name":"idea-create","target":"idea-modify","path":"home/idea-create"},{"oData":"CampaignFull","pattern":"id","title":"BREAD_CAMPAIGN_TITLE_TEXT","name":"campaign","target":"campaign","available":"campaign-idealist/campaign-idealistvariant/campaign-bloglist/campaign-comment/campaign-feeds/campaign-managerlist/blog-create/idea-display/blog-display/idea-create/campaign-bloglistvariant","path":"home/campaignlist/campaign"},{"TEXT":"PAGE_TIT_CAMPAIGN_COMMENT","name":"campaign-comment","target":"campaign-comment","path":"home/campaignlist/campaign/campaign-comment"},{"TEXT":"PAGE_TIT_CAMPAIGN_FEEDS","name":"campaign-feeds","target":"campaign-feeds","path":"home/campaignlist/campaign/campaign-feeds"},{"variant":true,"TEXT":"PAGE_TIT_CAMPAIGN_IDEAS","name":"campaign-idealist","target":"campaign-idealist","available":"idea-display","path":"home/campaignlist/campaign/campaign-idealist"},{"variant":true,"name":"campaign-idealistvariant","target":"campaign-idealist","available":"idea-display","path":"home/campaignlist/campaign/campaign-idealistvariant"},{"TEXT":"PAGE_TIT_CAMPAIGN_MANAGERS","variant":true,"name":"campaign-managerlist","target":"campaign-managerlist","path":"home/campaignlist/campaign/campaign-managerlist"},{"TEXT":"PAGE_TIT_SEARCHCATEGORY","name":"search","target":"search","path":"home/search"},{"name":"searchcategory","target":"searchcategory"},{"name":"message","target":"message"},{"name":"vote","target":"vote"},{"name":"identitycard","target":"identitycard"},{"name":"processindicator","target":"processindicator"},{"name":"ideacard","target":"ideacard"},{"name":"campaigncard","target":"campaigncard"},{"name":"votedisplay","target":"votedisplay","path":"home/votedisplay"},{"variant":true,"TEXT":"PAGE_TIT_REPORTS","name":"reportlist","target":"reportlist","path":"home/reportlist"},{"variant":true,"name":"reportlistvariant","target":"reportlist","path":"home/reportlistvariant"},{"oData":"ReportTemplates","title":"BREAD_REPORT_TITLE_TEXT","pattern":"code","TEXT":"PAGE_TIT_REPORTS","name":"report","target":"report","path":"home/reportlist/report"},{"TEXT":"PAGE_TIT_EVALUATION","name":"evaluation-display","target":"evaluation-display","available":"evaluation-edit","path":"home/evaluation-display"},{"TEXT":"PAGE_TIT_EVALUATION_EDIT","name":"evaluation-edit","target":"evaluation-modify","path":"home/evaluation-display/evaluation-edit"},{"name":"welcomepage","target":"welcomepage"},{"TEXT":"PAGE_TIT_EVALUATION_CREATE","name":"evaluation-create","target":"evaluation-modify"},{"TEXT":"PAGE_TIT_FEEDS","name":"feedlist","target":"feedlist","path":"home/feedlist"},{"variant":true,"TEXT":"PAGE_TIT_TAGS","name":"taglist","target":"taglist","path":"home/taglist"},{"TEXT":"PAGE_TIT_TAGS","name":"taglistvariant","target":"taglist","path":"home/taglistvariant"},{"variant":true,"name":"followlist","target":"followlist","path":"home/followlist"},{"variant":true,"name":"followlistvariant","target":"followlist","path":"home/followlistvariant"},{"variant":true,"TEXT":"REGISTER_APPR_LIST_TIT","name":"registerapprovallist","target":"registerapprovallist","path":"home/registerapprovallist"},{"variant":true,"TEXT":"REGISTER_APPR_LIST_TIT","name":"registerapprovallistvariant","target":"registerapprovallist","path":"home/registerapprovallistvariant"},{"variant":true,"TEXT":"REGISTER_APPR_LIST_TIT","name":"campaign-registerapprovallistvariant","target":"campaign-registerapprovallist","path":"campaign/campaign-registerapprovallistvariant"},{"TEXT":"PAGE_TIT_BLOGS","name":"bloglist","target":"bloglist","available":"blog-display","path":"home/bloglist"},{"variant":true,"name":"bloglistvariant","target":"bloglist","available":"blog-display","path":"home/bloglistvariant"},{"variant":true,"TEXT":"PAGE_TIT_CAMPAIGN_BLOGS","name":"campaign-bloglist","target":"campaign-bloglist","available":"blog-display","path":"home/campaignlist/campaign/campaign-bloglist"},{"variant":true,"name":"campaign-bloglistvariant","target":"campaign-bloglist","available":"blog-display","path":"home/campaignlist/campaign/campaign-bloglistvariant"},{"TEXT":"PAGE_TIT_BLOG_EDIT","name":"blog-edit","target":"blog-modify","path":"home/bloglist/blog-display/blog-edit"},{"TEXT":"PAGE_TIT_BLOG_CREATE","name":"blog-create","target":"blog-modify","path":"home/blog-create"},{"oData":"CampaignBlogsSmall","title":"BREAD_BLOG_TITLE_TEXT","pattern":"id","name":"blog-display","available":"blog-display/blog-edit","target":"blog-display","path":"home/bloglist/blog-display"},{"TEXT":"PAGE_TIT_EVALUATIONREQUEST_CREATE","name":"evaluationrequest-create","target":"evaluationrequestmodify","path":"home/evaluationrequest-create"},{"TEXT":"PAGE_TIT_EVALUATIONREQUEST_EDIT","name":"evaluationrequest-edit","target":"evaluationrequestmodify","path":"home/evalreqlist/evaluationrequest-display/evaluationrequest-edit"},{"TEXT":"PAGE_TIT_EVALUATIONREQUEST_DISPLAY","name":"evaluationrequest-display","target":"evaluationrequestdisplay","available":"evaluationrequest-edit/evaluationrequest-item","path":"home/evalreqlist/evaluationrequest-display"},{"TEXT":"PAGE_TIT_EVALUATIONREQUEST_ITEM","name":"evaluationrequest-item","target":"evaluationrequestitem","path":"home/evalreqlist/evaluationrequest-display/evaluationrequest-item"},{"variant":true,"TEXT":"PAGE_TIT_REWARDS","name":"rewardlist","target":"rewardlist","path":"home/rewardlist"},{"variant":true,"name":"rewardlistvariant","target":"rewardlist","path":"home/rewardlistvariant"},{"variant":true,"TEXT":"PAGE_TIT_EVALUATION_REQUESTS","name":"evalreqlist","target":"evalreqlist","path":"home/evalreqlist"},{"variant":true,"name":"evalreqlistvariant","target":"evalreqlist","path":"home/evalreqlistvariant"},{"TEXT":"PAGE_TIT_MY_SETTING","name":"mySetting","target":"mySetting","path":"home/mySetting"},{"TEXT":"PAGE_TIT_LEADERBOARD","name":"leaderboard","target":"leaderboard","path":"home/leaderboard"}];return U.extend("sap.ino.commons.application.BaseComponent",{init:function(){U.prototype.init.apply(this,arguments);this.initLanguage();this.initModels();this.initRouting();this.initURLWhitelist();this.initSessionTimeoutHandler();this.initTabHandler();this.start();},initLanguage:function(){var u=this._getCurrentUser();if(u){sap.ui.getCore().getConfiguration().setLanguage(u.LOCALE);}},initModels:function(){var m=sap.ui.getCore().getMessageManager();var o=new J(D);o.setDefaultBindingMode("OneWay");this.setModel(o,"device");var n=new J();this.setModel(n,"navigation");this._i18n=this.getModel("i18n");if(!this._i18n){this._i18n=new R({bundleUrl:C.getResourceBundleURL("nguii18n")});this.setModel(this._i18n,"i18n");}m.unregisterMessageProcessor(this._i18n);this.setModel(C.getSystemSettingsModel(),"config");m.unregisterMessageProcessor(C.getSystemSettingsModel());this.setModel(C.getUserModel(),"user");m.unregisterMessageProcessor(C.getUserModel());this.setModel(C.getSearchModel(),"search");m.unregisterMessageProcessor(C.getSearchModel());var e=m.getMessageModel();this.setModel(e,"message");var s=C.getFullApplicationPath("sap.ino.config.URL_PATH_OD_APPLICATION");if(C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")){s=C.getFullApplicationPath("sap.ino.config.URL_PATH_OD_BACKOFFICE");}var g=new O(s,false);g.bDisableHeadRequestForToken=true;g.setDefaultCountMode(sap.ui.model.odata.CountMode.None);this.setModel(g,"data");c.setODataModel(g);m.unregisterMessageProcessor(g);if(window.less&&window.less.env==="development"){g.setUseBatch(false);}this.setModel(a,"code");var p=D.system.desktop;var h=new N(p);this.setModel(h,"notifications");h.updateNotificationCount();var i=this.getModel("module");if(!i){i=new R({bundleUrl:C.getResourceBundleURL("moduletexts")+'?t='+Date.now()});this.setModel(i,"module");}var H=new J({});H.setDefaultBindingMode("OneWay");this.setModel(H,"help");var S=new J({});S.setDefaultBindingMode("OneWay");this.setModel(S,"search");var j=new J({"FULLSCREEN":!this.getShell().getAppWidthLimited(),"SHOW_BACKOFFICE":this.getModel("user").getProperty("/privileges/sap.ino.ui::backoffice.access"),"SHOW_BACKOFFICE_BLOG":this.getModel("user").getProperty("/privileges/sap.ino.ui::campaign_manager")});j.setDefaultBindingMode("OneWay");this.setModel(j,"component");var k=b.sharedInstance();k.setODataModel(g);k.setEnabled(!this.getModel("device").getProperty("/system/phone")&&this.getModel("user").getProperty("/privileges/sap.ino.ui::backoffice.access"));this.setModel(k,"clipboard");var l=new J({HashList:[],CurrentHash:null,Count:0});var q=new J({HashList:[]});this.setModel(q,"historyDetail");this.setModel(l,"history");var B=new J({CurrentRoute:"",CurrentAvailable:"all",CurrentHash:"none"});this.setModel(B,"breadCrumbs");},initRouting:function(){var t=this;var r=this.getRouter();var g=function(n,s,e){var i=s;var j=function(){var o=t.getRouter().getRoute(i);var p=o?o.getPattern():"";if(p){p=p.split(":")[0];}if(e!==p){t.getRootController().onBeforeNavigate(i);}setTimeout(function(){n();jQuery.sap.delayedCall(100,t.getRootController(),'onAfterNavigate');},0);};t._navigateIfAllowed(j);};var h=function(){return t.getRootController().isCloseAllowed();};var T=function(){var H=sap.ui.core.routing.History.getInstance();var e=H.aHistory;var i=e[H.iHistoryPosition].split("/");var s="";if(i.length>2&&i[2].split("?")[0]){s=i[0]+"_"+i[2].replace(/-/g,"_").split("?")[0];}else{s=i[0].replace(/-/g,"_").split("?")[0];}if(s.indexOf("tags")===0){s="tags";}var j=e[H.iHistoryPosition];var k=H._sCurrentDirection;var o=t.getRootView().getModel("history");var B=t.getRootView().getModel("breadCrumbs");var l=B.getProperty("/CurrentHash");B.setProperty("/CurrentHash",j);var m=o.getProperty("/HashList");var L=o.getProperty("/CurrentHash");var n={title:s,hash:j};if(L&&L.title===n.title&&(n.hash.indexOf("?section")>0||L.hash.indexOf("?section")>0)){return;}else if((k==="NewEntry"||k==="Unknown"||k==="Forwards")&&L!==null&&L.hash!==n.hash&&L.title!==n.title&&e.indexOf(L.hash)>=0){m.unshift(L);}else if(k==="Backwards"&&L.hash!==n.hash&&L.title!==n.title){m.shift();}o.setProperty("/CurrentHash",n);o.setProperty("/HashList",m);o.setProperty("/Count",m.length);var p=t.getCurrentView().getController().getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW");if(p){if(s==="ideas_commented"||s==="ideas_voted"){s=s==="ideas_commented"?"ideas_my_commented":"ideas_my_voted";}}var q=t._i18n.getResourceBundle();var P=q.getText("PAGE_TIT_"+(!s?"HOME":s.toUpperCase()));if(s==="ideas_mygroup"||s==="ideas_mygroupcommented"||s==="ideas_mygroupvoted"){var u=C.getGroupConfiguration().DISPLAY_LABEL;P=q.getText("PAGE_TIT_"+s.toUpperCase(),[u]);}if(s==="reports_customReports"){P=C.getCustomReportsTile();}document.title=P+" - "+t._i18n.getResourceBundle().getText("PAGE_TIT_SUFFIX");var w=C.getSystemSetting("sap.ino.config.OPEN_FOR_INM_BREADCRUMBS")==="0"?false:true;var x=t.getRootView().byId("inmBreadCrumbs");x.setVisible(w);if(w&&(n.hash!==l)){var y=t.getCurrentRoute();if(j==='my-setting'){y="mySetting";}var z=t.getBreadObjectByName(y);var A=t.getRootView().byId("innerShell");A.addStyleClass("sapInoInnoMgmtMShellBreadCrumbs");var E=x.getLinks().length;x.addStyleClass("inmBreadCrumbs");if(y===B.getProperty("/CurrentRoute")){x.removeLink(E-1);t.maintainBreadCrumbs(x,z,B,j,s);}else if(k!=="Backwards"){t.maintainBreadCrumbs(x,z,B,j,s);}else if(E===1){t.maintainBreadCrumbs(x,z,B,j,s);}else{x.removeLink(E-1);var F=x.getLinks()[x.getLinks().length-1];F.setEnabled(false);if(B.getProperty("/CurrentRoute")!==y){t.maintainBreadCrumbs(x,z,B,j,s);}}}};var _=function(e){t.getRootView().fireEvent('routeMatchedEvent',e.getParameters());};r.setRoutingCallback(g);r.setCloseCallback(h);r.attachRoutePatternMatched(null,T);r.attachBypassed(null,g);r.attachRouteMatched(null,_);},initURLWhitelist:function(){var w=C.getURLWhitelist();if(w&&w.length>0){jQuery.sap.addUrlWhitelist(window.location.protocol.split(':')[0],window.location.hostname,window.location.port,null);jQuery.each(w,function(i,o){jQuery.sap.addUrlWhitelist(o.PROTOCOL,o.HOST,o.PORT,o.PATH);});}else{jQuery.sap.addUrlWhitelist(window.location.protocol.split(':')[0],window.location.hostname,window.location.port,null);}},initSessionTimeoutHandler:function(){var e=4;var o=XMLHttpRequest.prototype.open;var t=function(E){if(E.type==="error"){jQuery.ajax({url:C.getBackendRootURL()+"/sap/hana/xs/formLogin/checkSession.xsjs",success:function(h,s,x){if(h.login===false){window.location.reload(false);}}});}var r=new RegExp(C.getBackendRootURL(),"igm");if(this.readyState===e&&(!this.responseURL||(this.responseURL&&C.isAbsoluteURL(this.responseURL)&&r.test(this.responseURL)))){var g=this.getResponseHeader("x-sap-origin-location");var l=this.getResponseHeader('x-sap-login-page');if(l&&g){window.location.reload(false);}}};XMLHttpRequest.prototype.open=function(){this.addEventListener('readystatechange',t,false);this.addEventListener('error',t,false);o.apply(this,arguments);};},initTabHandler:function(){$(document).ready(function(){document.onkeydown=function(){var e=window.event;if(document.activeElement.id==="sap-ino-main--openMenu"){if(e.which===jQuery.sap.KeyCodes.TAB&&e.shiftKey){$("div[id$='list-after']").focus();}}};});},start:function(){W.start(C);this.getRouter().initialize();},getVersionTimestamp:function(){return jQuery.sap.startsWith(v,"@UI_VERSION_TIME")?"development":v;},getVersion:function(){var m=this.getMetadata();while(m&&m.getName()!=="sap.ino.apps.ino.Component"){m=m.getParent();}return!m?undefined:m.getVersion();},getCurrentUserId:function(){return this._getCurrentUser().USER_ID;},getCurrentUserImageId:function(){return this._getCurrentUser().IDENTITY_IMAGE_ID;},getCurrentUserName:function(){return this._getCurrentUser().NAME;},getCurrentTechnicalUserName:function(){return this._getCurrentUser().USER_NAME;},getCurrentView:function(){return this.getRootController().getCurrentPage();},setCurrentRoute:function(n){this.getModel("navigation").setProperty("/Route",n);},getCurrentRoute:function(){return this.getModel("navigation").getProperty("/Route");},navigateTo:function(t,o,n,e){this.getRouter().navTo(t,o,n,e);},navigateToExternal:function(t,o){var e=this;var n=function(){var u=e.getRouter().getURL(t,o);var w=window.open(u,"InnovationManagement");w.opener=null;};this._navigateIfAllowed(n);},navigateToByURL:function(u){var n=function(){window.location.href=u;};this._navigateIfAllowed(n);},navigateToInNewWindow:function(t,o){var u=this.getRouter().getURL(t,o);var w=window.open(u,"_blank");w.opener=null;},navigateToByURLInNewWindow:function(u){var w=window.open(u,"_blank");w.opener=null;},getNavigationLink:function(r,p){return"#/"+this.getRouter().getURL(r,p);},getRootView:function(){return this.getAggregation("rootControl");},getRootController:function(){return this.getRootView().getController();},getShell:function(){return this.getRootView()?this.getRootView().byId("innerShell"):undefined;},logout:function(){var t=this;jQuery.ajax({url:C.getBackendRootURL()+"/sap/hana/xs/formLogin/token.xsjs",headers:{"X-CSRF-Token":"Fetch"},success:function(r,s,x){var T=x.getResponseHeader("X-CSRF-Token");jQuery.ajax({url:C.getBackendRootURL()+"/sap/hana/xs/formLogin/logout.xscfunc",headers:{"X-CSRF-Token":T},type:"post",contentType:"application/xml",success:function(r,s,x){window.location=C.getBackendRootURL()+"/sap/hana/xs/formLogin/login.html?x-sap-origin-location="+encodeURIComponent(window.location.pathname)+encodeURIComponent(window.location.hash);},error:function(o){t.showMessage(M.Error,t._i18n.getResourceBundle().getText("LOGOUT_ERROR_MSG"));}});}});},setHelpContent:function(h){var H=this.getModel("help");H.setProperty("/CONTENT",h);},_getCurrentUser:function(){if(!this._oCurrentUser){this._oCurrentUser=C.getCurrentUser();}return this._oCurrentUser;},_navigateIfAllowed:function(n){var t=this;var e=function(){var A=t.getRootController().isNavigationAllowed();C.getUserModel().setProperty("/data/TERMACCEPTCALLBACK",null);if(!A){var r=t.getRootController();r.showDataLossPopup(n);}else{n();}};var T=C.getUserModel().getProperty("/data/TERM_ACCEPTED");var s=C.getSystemSetting("sap.ino.config.TERMS_AND_CONDITIONS_TEXT");var g=C.getSystemSetting("sap.ino.config.TERMS_AND_CONDITIONS_ACTIVE");var o=this.getRootController().getTermsDialog(this.getRootController());C.getUserModel().setProperty("/data/TERMACCEPTCALLBACK",null);if(T===0&&s&&g==="1"&&!o.isOpen()){C.getUserModel().setProperty("/data/USER_ACCEPTED",0);C.getUserModel().setProperty("/data/TERMACCEPTCALLBACK",e);C.getUserModel().setProperty("/data/TERMACTION",true);o.setStretch(true);o.open();}else{if(!o.isOpen()){e();}}},attachNavigate:function(e,h){if(this.getRootView()){this.getRootController().byId("app").attachNavigate(e,h);return true;}return false;},detachNavigate:function(e,h){if(this.getRootView()){this.getRootController().byId("app").detachNavigate(e,h);return true;}return false;},attachAfterNavigate:function(e,h){if(this.getRootView()){this.getRootController().byId("app").attachAfterNavigate(e,h);return true;}return false;},detachAfterNavigate:function(e,h){if(this.getRootView()){this.getRootController().byId("app").detachAfterNavigate(e,h);return true;}return false;},maintainBreadCrumbs:function(B,o,e,s,g){var G;var l;var p;var P=s.split("/").length>1?s.split("/")[1]:"";var V=o.variant?g.split("_").pop():"";if(e.getProperty("/CurrentAvailable")==="all"){G=false;}else if(e.getProperty("/CurrentAvailable")!=="none"){var A=e.getProperty("/CurrentAvailable").split("/");A.forEach(function(n,j){if(!G){G=n===o.name?true:false;return;}});}else{G=false;}if(G){l=true;p=null;this.addBreadCrumbs(B,o,P,e,l,p,V,o);}else{B.destroyLinks();var h=o.path.split("/");var i=h.length;h.forEach(jQuery.proxy(function(n,j){var k=this.getBreadObjectByName(n);if(k.pattern){p={};p[k.pattern]=P;}l=i===j+1;this.addBreadCrumbs(B,k,P,e,l,p,V,o);},this));}},addBreadCrumbs:function(B,o,p,e,l,P,V,g){var s=C.getBackendRootURL()+"/sap/ino/"+window.location.search;var h=C.getFullApplicationPath("sap.ino.config.URL_PATH_OD_APPLICATION");if(C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")){h=C.getFullApplicationPath("sap.ino.config.URL_PATH_OD_BACKOFFICE");}h+="/";if((o.name==="campaign"||o.name==="campaign-idealist")&&g.name==="idea-display"){var i=jQuery.ajax({url:h+"IdeaSmall("+p+")",type:"GET",dataType:"json",async:false});i.done(function(K){p=K.d.CAMPAIGN_ID;P.id=p;});}var n,t,j,k,T;var m="";var q;if(o.name==='report'){var r=p.indexOf("MyReports")>=0?true:false;if(r){q=p;}else{var u=p.split("'")[1];q=o.oData+"(CODE='"+u+"')";}}else{q=o.oData+"("+p+")";}var w=this;if(o.pattern){var x=jQuery.ajax({url:h+q,type:"GET",dataType:"json",async:false});x.done(function(K){n=K.d.SHORT_NAME?K.d.SHORT_NAME:K.d.NAME;t=K.d.TITLE?K.d.TITLE:n;k=K.d.DEFAULT_TEXT?K.d.DEFAULT_TEXT:t;if(o.name==='report'&&!r){k=w.getModel("code").getText("sap.ino.xs.object.analytics.ReportTemplate.Root",K.d.CODE);}if(r){var Q=JSON.parse(K.d.CONFIG);k=Q.Title;r=false;}if(o.name==='idea-display'&&g.name==="idea-display"&&g.path.indexOf('campaign-idealist/idea-display')>-1){T=K.d.CAMPAIGN_ID;}});if(o.title){m=this._i18n.getResourceBundle().getText(o.title)+" ";}}if(o.variant&&this.getCurrentRoute()===o.name){var L=this.getCurrentView().getController().getViewProperty("/List/VARIANT");var y=this.getCurrentView().getController().list?this.getCurrentView().getController().list.CURRENTSELECTLINK:"";this.getCurrentView().getController().getModel("list").setProperty("/CURRENTSELECTLINK",undefined);var A=this.getCurrentView().getController().list?this.getCurrentView().getController().list.Variants:"";if(A!==""&&y&&y.TYPE_CODE==="QUICK_LINK_CUSTOM_IDEA"){j=y.LINK_TEXT;}else if(A!==""&&this.getObjectListVariantText(A,L)){j=this.getObjectListVariantText(A,L);}}else if(o.TEXT){j=this._i18n.getResourceBundle().getText(o.TEXT);}else{j="";}if(o.name==='idea-display'&&g.name==="idea-display"&&g.path.indexOf('campaign-idealist/idea-display')>-1){var z=B.getLinks();var E=z[z.length-1];var F;if(T&&E&&E.getProperty("href").indexOf('campaign/')>-1&&E.getProperty("href").indexOf('campaign/'+T)===-1){var G=jQuery.ajax({url:h+'CampaignSmall('+T+')',type:"GET",dataType:"json",async:false});G.done(function(K){F=K.d.SHORT_NAME?K.d.SHORT_NAME:K.d.NAME;});E.setProperty("href",s+this.getNavigationLink('campaign',{id:T}));E.setProperty("text",this._i18n.getResourceBundle().getText("BREAD_CAMPAIGN_TITLE_TEXT")+F);}}B.addLink(new sap.m.Link({text:o.pattern?m+k:j,target:"_top",enabled:l?false:true,href:l?window.location.href+window.location.search:s+this.getNavigationLink(o.name,P)}));if(l&&B.getLinks().length>1){var H=B.getLinks().length>1?B.getLinks().length-2:B.getLinks().length-1;B.getLinks()[H].setEnabled(true);this.setHistoricalTitle(o.pattern?m+k:j);}e.setProperty("/CurrentAvailable",o.available?o.available:"none");e.setProperty("/CurrentRoute",o.name);},setBreadCrumbsText:function(B,t){B.setCurrentLocationText(t);},getBreadObjectByName:function(t){var e;jQuery.each(f,function(i,g){if(g.name===t){e=g;}});return e;},getObjectListVariantText:function(A,t){var V=A.Values;var s;jQuery.each(V,function(i,e){if(e.ACTION===t&&e.TEXT){s=e.TEXT;}});if(t&&t.indexOf('mygroup')>-1&&s){return this._i18n.getResourceBundle().getText(s,[C.getGroupConfiguration().DISPLAY_LABEL]);}if(s){return this._i18n.getResourceBundle().getText(s);}return"";},setHistoricalTitle:function(V){var s=this.getModel("history").getProperty("/CurrentHash")?this.getModel("history").getProperty("/CurrentHash").hash:'';var h={detailTitle:V,hash:s};var H=this.getModel("historyDetail").getProperty("/HashList");H.unshift(h);this.getModel("historyDetail").setProperty("/HashList",H);}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.formatters.ObjectFormatter')){jQuery.sap.declare('sap.ino.commons.formatters.ObjectFormatter');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.type.Date');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.ui.core.format.NumberFormat');jQuery.sap.require('sap.ui.core.format.DateFormat');sap.ui.define("sap/ino/commons/formatters/ObjectFormatter",["sap/ino/commons/formatters/BaseFormatter","sap/ino/commons/models/core/CodeModel","sap/ino/commons/application/Configuration","sap/ino/controls/IdeaStatusType","sap/ino/controls/VoteType","sap/ui/base/Object","sap/ui/model/type/Date","sap/ui/core/IconPool","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat"],function(B,C,b,I,V,O,D,c,N,d){"use strict";var f=N.getFloatInstance({maxFractionDigits:1});var o=O.extend("sap.ino.commons.formatters.ObjectFormatter",{});jQuery.extend(o,B);o.alternativeBy=function(v,i,a,e,A){if(i){e=B.toRelativeDate(e);if(!e&&A){e=B.toRelativeDate(A);}return B.parameterizedText(v,i,e);}else if(a){A=B.toRelativeDate(A);return B.parameterizedText(v,a,A);}else return"";};o.ideaDisplaySubtitle=function(i,s,r,R,v,a,A,e,g,w){if(w){if(R){return i+": "+s+", "+r+": "+R;}return i+": "+s;}return o.alternativeBy(v,a,A,e,g);};o.aContributorsTostring=function(a){if(!a||a.length<=0){return"";}var r=a[0].NAME;for(var i=1;i<=a.length-1;i++){r+=", "+a[i].NAME;}return r;};o.alternativeDate=function(v,a){v=B.toRelativeDate(v);if(!v&&a){v=B.toRelativeDate(a);}return v||"";};o.daysLeft=function(s){if(s){var a=new Date(s);var n=new Date();var e=new Date("9999-12-30T00:00:00.000Z");var i=n.getTime()-a.getTime();var l;if(i<=0){if(s>=e){l=this.getText("CAMPAIGN_LIST_FLD_DEADLINE_NO_END_DATE");}else{l=this.getText("CAMPAIGN_FLD_DATE_DEADLINE",[B.toDateTime(a)]);}}else{l=this.getText("CAMPAIGN_FLD_DATE_DEADLINE_PASSED",[B.toDateTime(a)]);}return l;}return undefined;};o.campaignStartsInDays=function(s){if(s){var a=new Date(s);var n=new Date();var i=a.getTime()-n.getTime();var l;if(i<0){l=this.getText("CAMPAIGN_FLD_DATE_STARTED",[B.toDate(a)]);}else{l=this.getText("CAMPAIGN_FLD_DATE_WILL_START",[B.toDate(a)]);}return l;}return undefined;};o.submissionDaysLeft=function(s){if(s){var a=new Date(s);var n=new Date();var e=new Date("9999-12-30T00:00:00.000Z");var i=n.getTime()-a.getTime();var l;if(i<=0){if(a>=e){l=this.getText("CAMPAIGN_LIST_FLD_SUBMISSION_DEADLINE_NO_END_DATE");}else{l=this.getText("CAMPAIGN_FLD_SUBMISSION_DEADLINE",[B.toDateTime(a)]);}}else{l=this.getText("CAMPAIGN_FLD_SUBMISSION_DEADLINE_PASSED",[B.toDateTime(a)]);}return l;}return undefined;};o.submissionStartsInDays=function(s){if(s){var a=new Date(s);var n=new Date();var i=a.getTime()-n.getTime();var l;if(i<0){l=this.getText("CAMPAIGN_FLD_SUBMISSION_STARTED",[B.toDate(a)]);}else{l=this.getText("CAMPAIGN_FLD_SUBMISSION_WILL_START",[B.toDate(a)]);}return l;}return undefined;};o.registrationDaysLeft=function(s){if(s){var a=new Date(s);var n=new Date();var e=new Date("9999-12-30T00:00:00.000Z");var i=n.getTime()-a.getTime();var l;if(i<0){if(a>=e){l=this.getText("CAMPAIGN_LIST_FLD_REGISTRATION_DEADLINE_NO_END_DATE");}else{l=this.getText("CAMPAIGN_FLD_REGISTRATION_DEADLINE",[B.toDateTime(a)]);}}else{l=this.getText("CAMPAIGN_FLD_REGISTRATION_DEADLINE_PASSED",[B.toDateTime(a)]);}return l;}return undefined;};o.registrationStartsInDays=function(s){if(s){var a=new Date(s);var n=new Date();var i=a.getTime()-n.getTime();var l;if(i<0){l=this.getText("CAMPAIGN_FLD_REGISTRATION_STARTED",[B.toDate(a)]);}else{l=this.getText("CAMPAIGN_FLD_REGISTRATION_WILL_START",[B.toDate(a)]);}return l;}return undefined;};o.formatInfinityWithTimeFormat=function(a){if(!a){return"";}else if(typeof(a)==="number"||typeof(a)==="string"){a=new Date(a);}a=new Date(a.getTime()+a.getTimezoneOffset()*60*1000);return sap.ui.core.format.DateFormat.getDateTimeInstance({"pattern":"yyyy-MM-dd HH:mm:ss UTC"}).format(a,false);};o.ideaImageUrl=function(t,m){if(m&&m.indexOf("image/")===0){return b.getAttachmentTitleImageDownloadURL(t);}return null;};o.ideaTitleImageUrl=function(t,u,a){if(t&&u){if(a instanceof Date){return'/'+u+'/'+t+'?type=large&t='+a.getTime();}else{return'/'+u+'/'+t+'?type=large';}}return null;};o.ideaProcessStopped=function(s){if(s){return s===I.Discontinued||s===I.Merged;}return false;};o.isIdeaProcessStoped=function(s,t){if(t){return t==="DISCONTINUED";}else if(s){return s===I.Discontinued||s===I.Merged;}return false;};o.baseCampaignHomePageButtons=function(p,a){return p&&a;};o.ideaStatus=C.getFormatter("sap.ino.xs.object.status.Status.Root");o.ideaStatusAction=C.getFormatter("sap.ino.xs.object.status.Action.Root");o.ideaPhase=C.getFormatter("sap.ino.xs.object.campaign.Phase.Root");o.criterionCode=C.getFormatter("sap.ino.xs.object.evaluation.Model.Criterion");o.changeStatusActionCode=C.getFormatter("sap.ino.xs.object.status.Action.Root");o.criterionCodeLongText=C.getLongTextFormatter("sap.ino.xs.object.evaluation.Model.Criterion");o.criterionCodeLongTextVisible=function(t){return!!t&&t.length>0;};o.modelCode=C.getFormatter("sap.ino.xs.object.evaluation.Model.Root");o.modelCodeLongText=C.getLongTextFormatter("sap.ino.xs.object.evaluation.Model.Root");o.valueOption=C.getFormatter("sap.ino.xs.object.basis.ValueOptionList.ValueOptions");o.uomCode=C.getFormatter("sap.ino.xs.object.basis.Unit.Root");o.ideaNavigationLink=function(i,s){if(!isNaN(parseInt(i,10))){var p={id:i};if(s){p.query={section:s};}return B.navigationLink.apply(this,["idea-display",p]);}return undefined;};o.campaignNavigationLink=function(i){if(!isNaN(parseInt(i,10))){return B.navigationLink.apply(this,["campaign",{id:i}]);}return undefined;};o.rewardEmployeeName=function(e,i){if(i>0){return e;}else if(i===0){e=this.getText("IDEA_OBJECT_TIT_IDEA_Anonymity");return e;}};o.rewardEmployeeNameLinkEnabled=function(i){if(i>0){return true;}else{return false;}};o.wallNavigationLink=function(i){if(!isNaN(parseInt(i,10))){return B.navigationLink.apply(this,["wall",{id:i}]);}return undefined;};o.evaluationNavigationLink=function(i){if(!isNaN(parseInt(i,10))){return B.navigationLink.apply(this,["evaluation-display",{id:i}]);}return undefined;};o.roleCode=C.getFormatter("sap.ino.xs.object.iam.RoleCode.Root");o.multipleRoleCodes=function(r){var R="";if(r){R=r.split(",").map(o.roleCode).join(", ");}return R;};o.ideaAccessibilityLabel=function(i,p,a,s,S,v,e,g,h,m,j,k){if(S===I.Draft){return this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_DRAFT",[i]);}g=g||0;h=h||0;m=m||0;j=j||0;k=k||0;a=a||0;s=s||0;var l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_NO");if(v===V.TYPE_STAR){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_STAR",[h,m]);}else if(v===V.TYPE_LIKE){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE",[h]);}else if(v===V.TYPE_LIKE_DISLIKE){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_DISLIKE",[j,k]);}var n=b.isUsageReportingActive()?this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VIEW_COUNT",[g]):"";return this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL",[i,o.ideaPhase(p),a+1,s,o.ideaStatus(S),l,e,n]);};o.ideaAccessibilityLabelBackOfficeHome=function(i,s,S,a,p,e,g,h,v,E,j,k,l,m,F,n,M,q,r){if(h===I.Draft){return this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_DRAFT",[i]);}e=e+1||1;g=g||0;E=E||0;j=j||0;k=k||0;var t=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_NO");if(v===V.TYPE_STAR){t=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_STAR",[n,M]);}else if(v===V.TYPE_LIKE){t=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE",[n]);}else if(v===V.TYPE_LIKE_DISLIKE){t=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_DISLIKE",[q,r]);}a=a?this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_COACH",[a]):"";F=F?this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_DUE_DATE",[B.toDate(F)]):"";return this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_BACKOFFICEHOME",[i,s,S,a,o.ideaPhase(p),e,g,o.ideaStatus(h),t,E,j,k,B.toDate(l),B.toDate(m),F]);};o.ideaAccessibilityLabelListItem=function(i,p,a,s,S,v,e,g,h,m,j,k){if(S===I.Draft){return this.getText("IDEA_LIST_ITEM_ALT_ACCESSIBILITY_LABEL_DRAFT",[i]);}g=g||0;h=h||0;m=m||0;j=j||0;k=k||0;a=a||0;s=s||0;var l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_NO");if(v===V.TYPE_STAR){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_STAR",[h,m]);}else if(v===V.TYPE_LIKE){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE",[h]);}else if(v===V.TYPE_LIKE_DISLIKE){l=this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VOTING_EXT_LIKE_DISLIKE",[j,k]);}var n=b.isUsageReportingActive()?this.getText("IDEA_LIST_ALT_ACCESSIBILITY_LABEL_VIEW_COUNT",[g]):"";return this.getText("IDEA_LIST_ITEM_ALT_ACCESSIBILITY_LABEL",[i,o.ideaPhase(p),a+1,s,o.ideaStatus(S),l,e,n]);};o.campaignAccessibilityLabel=function(n,v,t,T,i,a,s,e){var g=o.daysLeft.apply(this,[v]);var h=(a+s===2);t=t||0;T=T||0;i=i||0;var j=b.isUsageReportingActive()?this.getText("CAMPAIGN_LIST_ALT_ACCESSIBILITY_LABEL_VIEW_COUNT",[i]):"";if(!e){return this.getText("CAMPAIGN_LIST_ALT_ACCESSIBILITY_LABEL"+(h?"_NEW_SUBMITTABLE":""),[n,g,t,T,j]);}else{return this.getText("CAMPAIGN_LIST_ITEM_ALT_ACCESSIBILITY_LABEL_REGISTER",[n]);}};o.campaignAccessibilityLabelBackOfficeHome=function(n,v,u,t,T,i,a,s,e){var g=o.daysLeft.apply(this,[v]);var h=(a+s===2);u=u||0;t=t||0;T=T||0;i=i||0;var j=b.isUsageReportingActive()?this.getText("CAMPAIGN_LIST_ALT_ACCESSIBILITY_LABEL_VIEW_COUNT",[i]):"";if(e){return this.getText("CAMPAIGN_LIST_ITEM_ALT_ACCESSIBILITY_LABEL_REGISTER",[n]);}return this.getText("CAMPAIGN_LIST_ALT_ACCESSIBILITY_BACKOFFICEHOME",[n,g,u,t,T,j]);};o.campaignAccessibilityLabelListItem=function(n,v,t,T,i,a,s){var e=o.daysLeft.apply(this,[v]);var g=(a+s===2);t=t||0;T=T||0;i=i||0;var h=b.isUsageReportingActive()?this.getText("CAMPAIGN_LIST_ALT_ACCESSIBILITY_LABEL_VIEW_COUNT",[i]):"";return this.getText("CAMPAIGN_LIST_ITEM_ALT_ACCESSIBILITY_LABEL",[n,e,t,T,h]);};o.comAccessibilityLabelListItem=function(){if(!arguments||!arguments.length){return false;}return Array.prototype.join.call(arguments,' ');};o.blogAccessibilityLabelListItem=function(s,a,A,i){return this.getText("BLOG_LIST_ITEM_ALT_ACCESSIBILITY_LABEL",[s,a,A,i]);};o.registerAccessibilityApprovalListItem=function(n,v,s,r,a,S){var e=o.daysLeft.apply(this,[v]);var g=o.submissionDaysLeft.apply(this,[s]);return this.getText("REGISTER_APPROVAL_LIST_ITEM_ALT_ACCESSIBILITY_LABEL",[n,e,g,r,a,S]);};o.blogNavigationLink=function(i,s){if(!isNaN(parseInt(i,10))){var p={id:i};if(s){p.query={section:s};}return B.navigationLink.apply(this,["blog-display",p]);}return undefined;};o.controlTooltip=function(s,t){var r=sap.ui.getCore().getLibraryResourceBundle("sap.ino.controls");return!t?r.getText(s):r.getText(s,t);};o.formatMsg=function(t){if(arguments){return jQuery.sap.formatMessage(t,Array.prototype.splice.call(arguments,1));}};o.viewCount=function(n){if(n){var a=N.getIntegerInstance({style:"short"});return a.format(n);}return"1";};o.toInt=function(n){var i=parseInt(n,10);if(isNaN(i)){i=0;}return i;};o.toFloat=function(n){var i=parseFloat(n);if(isNaN(i)){i=0;}return i;};o.votingActive=function(s,v,i,a,e){var S=(a>0&&e>0)||!a;return v>0&&I.Draft!==s&&I.Discontinued!==s&&I.Merged!==s&&S&&i>0;};o.commentTooltip=function(i,a,e){var s=e>0&&i>0||!e;if(a>0&&s){return this.getText("CTRL_IDEACARD_BUT_COMMENT_BUTTON");}return this.getText("VOTE_MSG_COMMENT_NO_PRIVILEGE");};o.voteTooltip=function(s,v,i,p,a,e,S,u,g,h,j){var P=s!==I.Draft&&s!==I.Discontinued&&s!==I.Merged;if(!P){return this.getText("VOTE_MSG_VOTING_NOT_POSSIBLE");}var k=(j>0&&v>0)||!j;if(!k||!h){return this.getText("VOTE_MSG_VOTING_NO_PRIVILEGE");}var l=i>0;if(!l){return this.getText("VOTE_MSG_VOTING_INACTIVE",[C.getText("sap.ino.xs.object.campaign.Phase.Root",p)]);}switch(a){case V.TYPE_STAR:var m=f.format(this.formatter.toFloat(S));if(u){return this.getText("VOTE_FLD_STAR_RATING_TOOLTIP_USER_VOTED",[u,e,m]);}else if(!g){return this.getText("VOTE_FLD_STAR_RATING_TOOLTIP");}break;case V.TYPE_LIKE:if(u){return this.getText("VOTE_FLD_LIKE_TOOLTIP_USER_VOTED",[u,e,m]);}else if(!g){return this.getText("VOTE_FLD_LIKE_TOOLTIP");}break;case V.TYPE_LIKE_DISLIKE:if(u){if(u===1){return this.getText("VOTE_FLD_LIKE_DISLIKE_LIKE_TOOLTIP_USER_VOTED",[u,e,m]);}if(u===-1){return this.getText("VOTE_FLD_LIKE_DISLIKE_DISLIKE_TOOLTIP_USER_VOTED",[u,e,m]);}}else if(!g){return this.getText("VOTE_FLD_LIKE_DISLIKE_TOOLTIP");}break;}return this.getText("IDEA_LIST_ALT_IDEA_VOTE_TOOLTIP_VOTE");};o.isDraft=function(s){return s===I.Draft;};o.isFinal=function(s){var S;jQuery.each(b.getBackendConfiguration().ideaStatus,function(i,a){if(a.CODE===s){S=a.STATUS_TYPE;return;}});return s===I.Completed||s===I.Discontinued||s===I.Merged||S===I.TypeCompleted||S===I.TypeDiscontinued;};o.isMerged=function(s){return s===I.Merged;};o.linkLabel=function(l,u){return l||u;};o.imageIcon=function(i){return!i?"sap-icon://person-placeholder":"";};o.isNewObject=function(){var a=this.getObjectModel();return a&&a.isNew();};o.isExistingObject=function(){var a=this.getObjectModel();return a&&!a.isNew();};o.getLikeIconUrl=function(){return c.getIconURI("heart","InoIcons");};o.widthCampaignBanner=function(s){if(s.phone){return"300px";}else{return"350px";}};o.heightCampaignBanner=function(s){if(s.phone){return"160px";}else{return"213px";}};o.blogStatus=function(s){return s==="sap.ino.config.DRAFT"?this.getText("BLOG_LIST_MIT_DRAFT_STATUS"):"";};o.isBlogStatusDraft=function(s){return s==="sap.ino.config.DRAFT";};o.urlVisible=function(u){return jQuery.sap.validateUrl(u);};o.ideaShortDescription=function(e){function p(s){if(jQuery.parseHTML){var a=jQuery.parseHTML(s);if(a){var g=0,h=a.length;while(g<h&&a[g].nodeType!==1){g++;}while(g<h&&a[h-1].nodeType!==1){h--;}if(g>0||h<a.length){a=a.slice(g,h);}return jQuery(a);}}return jQuery(s);}if(e){e="<span>"+e+"</span>";var P=p(e);var t=P&&P[0]&&P[0].innerText;return t;}return e;};o.enableRejectOKButton=function(r){if(r.length>0){return true;}return false;};return o;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.FollowUp')){jQuery.sap.declare('sap.ino.commons.models.object.FollowUp');sap.ui.define("sap/ino/commons/models/object/FollowUp",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/commons/models/object/Idea","sap/ino/commons/models/core/ReadSource"],function(A,a,I,R){"use strict";var F=A.extend("sap.ino.commons.models.object.FollowUp",{objectName:"sap.ino.xs.object.followup.FollowUp",readSource:R.getDefaultAOFSource(),actionImpacts:{"del":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["FOLLOW_UP_ID","FOLLOW_UP_DATE"]}],"create":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["FOLLOW_UP_ID","FOLLOW_UP_DATE"]}],"update":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"OBJECT_ID","impactedAttributes":["FOLLOW_UP_ID","FOLLOW_UP_DATE"]}],"massModify":[{"objectName":"sap.ino.commons.models.object.Idea","objectKey":"ideaIds","impactedAttributes":["FOLLOW_UP_ID","FOLLOW_UP_DATE"]}]},determinations:{onCreate:function(){return{OBJECT_TYPE_CODE:"IDEA"};}},relativeDates:[{"key":"NONE"},{"key":"TODAY"},{"key":"TOMORROW"},{"key":"THIS_WEEK"},{"key":"NEXT_WEEK"},{"key":"IN_A_WEEK"},{"key":"IN_TWO_WEEKS"},{"key":"THIS_MONTH"},{"key":"NEXT_MONTH"},{"key":"IN_A_MONTH"},{"key":"IN_TWO_MONTHS"}]});return F;});};if(!jQuery.sap.isDeclared('sap.ino.commons.models.object.Report')){jQuery.sap.declare('sap.ino.commons.models.object.Report');sap.ui.define("sap/ino/commons/models/object/Report",["sap/ino/commons/models/aof/ApplicationObject","sap/ino/commons/models/core/ReadSource","sap/ino/commons/util/ReportUtil"],function(A,R,a){"use strict";var b=A.extend("sap.ino.commons.models.object.Report",{objectName:"sap.ino.xs.object.analytics.Report",readSource:R.getDefaultODataSource("MyReports",{async:false}),invalidation:{entitySets:["MyReports"]},determinations:{onCreate:f,onRead:h,onNormalizeData:i,onUpdateHandles:u},setConfiguration:s,getConfiguration:g,setCampaignContext:e,setDataFromTemplate:d,setReportOrderSequence:c});function s(C){if(typeof(C)==="string"){C=JSON.parse(C);}this.setProperty("/CONFIG",C);}function g(){return this.getProperty("/CONFIG");}function c(o){this.setProperty("/ORDER_SEQUENCE",o);}function d(r,D){var o=D;var j=this;var k=new jQuery.Deferred();var l=function(m){m=a.parseConfigToObject(m);j.setConfiguration(m.CONFIG);k.resolve(m);};o.read("/ReportTemplates(CODE='"+r+"')",{context:null,urlParameters:null,success:l});return k.promise();}function e(C,j){this.setProperty("/CAMPAIGN_ID",C);this.setProperty("/CAMPAIGN_NAME",j);if(C!==undefined&&C!==null){var o=this.getProperty("/CONFIG");if(o.Parameters&&o.Parameters.Campaign){o.Parameters.Campaign.Selection=[C];o.Parameters.Campaign.SelectionString=j;this.setProperty("/CONFIG",o);}}}function f(){return{"ID":-1,"CAMPAIGN_ID":null,"CONFIG":null,"ORDER_SEQUENCE":null};}function h(D){D=a.parseConfigToObject(D);return D;}function i(D){D=a.parseConfigToString(D);return D;}function u(o,G){if(o.ID){if(G[o.ID]){o.ID=G[o.ID];}}return o;}return b;});};if(!jQuery.sap.isDeclared('sap.ino.commons.util.Export')){jQuery.sap.declare('sap.ino.commons.util.Export');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.ui.model.odata.ODataModel');jQuery.sap.require('sap.ui.model.odata.v2.ODataModel');jQuery.sap.require('sap.ui.model.PropertyBinding');jQuery.sap.require('sap.ui.model.CompositeBinding');jQuery.sap.require('sap.ui.model.type.Date');jQuery.sap.require('sap.ui.model.type.DateTime');jQuery.sap.require('sap.ui.model.type.Time');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.List');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.ui.table.Table');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.ui.core.BusyIndicator');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.HBox');sap.ui.define("sap/ino/commons/util/Export",["sap/ui/core/format/DateFormat","sap/ui/model/odata/ODataModel","sap/ui/model/odata/v2/ODataModel","sap/ui/model/PropertyBinding","sap/ui/model/CompositeBinding","sap/ui/model/type/Date","sap/ui/model/type/DateTime","sap/ui/model/type/Time","sap/m/MessageBox","sap/m/MessageToast","sap/m/Link","sap/m/Text","sap/m/Label","sap/m/List","sap/m/Table","sap/ui/table/Table","sap/ui/core/Icon","sap/ui/core/BusyIndicator","sap/ino/commons/application/Configuration","sap/ino/commons/util/ExportPPT","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/HBox"],function(D,O,a,P,C,b,c,T,M,d,L,e,f,g,h,U,I,B,k,E,F,l,H){"use strict";var m="csv";var n="xls";var o="txt";var p="xml";var q="pptx";var r="utf-8";var s="text/csv";var t="application/vnd.ms-excel";var u="application/vnd.openxmlformats-officedocument.presentationml.presentation";var R=9999;var v=2500;var w=1000;var x=50;var y="Export";var z=";";function A(j,K){var N=j.getAggregation("customData");if(N){for(var i=0;i<N.length;i++){if(N[i].getKey()===K){return true;}}}return false;}function G(i){return!A(i,"exportIgnore");}function J(i){return A(i,"is_export");}return{_oBrowser:sap.ui.Device.browser,_getBinding:function(i){if(i instanceof g){return i.getBinding("items");}else if(i instanceof h||i instanceof U){return i.getBinding("rows");}return null;},_getModel:function(i){if(i instanceof g){return i.getModel("data");}else if(i instanceof h){return i.getModel("data");}else if(i instanceof U){return i.getModel()||i.getModel("data");}return null;},_getSelect:function(i){var j=this._getBinding(i);if(i instanceof g){return undefined;}else if(i instanceof h){return undefined;}else if(i instanceof U){if(!j.aAnalyticalInfo){return i.getSelectedIndices();}return j.aAnalyticalInfo&&j.aAnalyticalInfo.filter(function(K){return K.visible;}).map(function(K){return K.name;});}return undefined;},_getControls:function(i){var j={};function K(S,i,V){if(i&&(i instanceof L||i instanceof e||i instanceof H)){if(S){S=S.trim();if(S.indexOf(":",S.length-1)!==-1){S=S.substring(0,S.length-1);}V=V||S;if(!j[V]){j[V]={"label":S,"ctrl":i};return true;}}}return false;}if(i instanceof g){if(i.getItems().length>0){var N=i.getItems()[0];var Q=N.findAggregatedObjects(true);var S="",V="";jQuery.each(Q,function(X,Y){if(!G(Y)){return;}if(Y instanceof f&&Y.getText()){S=Y.getText();V=Y.sId;if(Y.getLabelFor()){var Z=sap.ui.getCore().byId(Y.getLabelFor());K(S,Z,V);}}if(!S&&Y.getTooltip()){S=Y.getTooltip();}if(Y.data("exportLabel")){S=Y.data("exportLabel");}if(K(S,Y)){S="";}V="";});}}else if(i instanceof h||i instanceof U){var W=i.getColumns();jQuery.each(W,function(X,Y){if(G(Y)&&(Y.getVisible()||J(Y)||i.data("bExportAllColumns"))){var S="",V;var Z=Y.getLabel();if(Z){S=Z.getText();V=Z.sId;}var $=Y.getTemplate();if(K(S,$,V)){S="";V="";}}});}return j;},_readContent:function(S,K,N){var Q=this;var V={headers:[],rows:[]};var W=this._getControls(S);jQuery.each(W,function(i,j){V.headers.push(j.label);});if(V.headers.length===0){d.show(Q._getText("GENERAL_EXPORT_TIT_EXPORT_NO_DATA"));return jQuery.Deferred().reject();}var X={"$inlinecount":"allpages","$format":"json"};if(S&&S.getModel()&&S.getModel().getHeaders()&&S.getModel().getHeaders().Accept&&S.getModel().getHeaders().Accept.indexOf("xml")>-1){X["$format"]="xml";}var Y;if(N>0){X.$top=N;}var Z=this._getSelect(S);if(Z){var $=function(i){var j=true;jQuery.each(i,function(h1,i1){if(isNaN(i1)){j=false;return false;}});return j;};if($(Z)){var _=[];var a1=[];var b1=S.getId().indexOf('gamificationReportTable')>-1?true:false;var c1=S.getId().indexOf('gamificationReportTableDetail')>-1?true:false;jQuery.each(Z,function(i,j){var h1=S.getContextByIndex(j).getProperty("REWARD_LIST_ID");if(!b1){if(a1.indexOf(h1)===-1){a1.push(h1);_.push(new F("REWARD_LIST_ID",l.EQ,parseInt(h1,10)));}}else{if(c1){var i1=S.getContextByIndex(j).getProperty("ACTIVITY_ID");_.push(new F("ACTIVITY_ID",l.EQ,i1));}else{var j1=S.getContextByIndex(j).getProperty("DIMENSION_ID");var k1=S.getContextByIndex(j).getProperty("IDENTITY_ID");_.push(new F([new F("DIMENSION_ID",l.EQ,j1),new F("IDENTITY_ID",l.EQ,k1)],true));}}});Y=new F(_,false);}else{X.$select=Z.join(",");}}var d1=this._getBinding(S);if(d1&&d1.aSorter){for(var e1=0;e1<d1.aSorter.length;e1++){if(Z.indexOf(d1.aSorter[e1].sPath)<0){if(X.$select&&X.$select.length>0){X.$select+=","+d1.aSorter[e1].sPath;}else{X.$select=d1.aSorter[e1].sPath;}}}}var f1=d1.getPath();var g1=jQuery.Deferred();this._getModel(S).read(f1,{filters:d1.aFilters.concat(d1.aApplicationFilters,d1.aFilter||[],d1.aApplicationFilter||[],Y||[]),sorters:d1.aSorters.concat(d1.aSorter||[]),urlParameters:X,success:function(h1){var i1=h1.results;if(K===q){g1.resolve(i1);}else{for(var i=0;i<i1.length;i++){var j1={cells:[]};if(i1[i].hasOwnProperty("DOWNLOAD_COUNT")){i1[i].DOWNLOAD_COUNT+=1;}jQuery.each(W,function(k1,l1){var m1={header:l1.label};var n1=i1[i];var o1=l1.ctrl;var p1="String";var q1="";var r1,s1,t1;if(o1 instanceof H&&o1.getItems().length>0){var u1=o1.getItems();var v1={content:"",contentRaw:""};for(var j=0;j<u1.length;j++){v1=Q.getHBoxContent(u1[j],p1,n1,v1);}q1=v1.content;r1=v1.contentRaw;}else{var w1=o1.getBindingInfo("href");if(w1){p1="Href";var x1=o1.getBindingInfo("href");w1=null;}if(!w1){w1=o1.getBindingInfo("text");}if(!w1){w1=o1.getBindingInfo("value");}if(!w1){w1=o1.getBindingInfo("checked");if(w1){p1="Boolean";}}if(!w1){w1=o1.getBindingInfo("tooltip");}if(w1){if(w1.binding){s1=Q._getDataForBinding(o1,n1,w1.binding);if(s1.type){p1=s1.type;}q1=s1.content;r1=s1.contentRaw;}else if(w1.parts){s1=Q._getDataForParts(o1,n1,w1);if(s1.type){p1=s1.type;}q1=s1.content;r1=s1.contentRaw;}}if(x1){if(x1.binding){s1=Q._getDataForBinding(o1,n1,x1.binding);}else if(x1.parts){s1=Q._getDataForParts(o1,n1,x1);}p1="Href";t1=k.getFullApplicationPath("sap.ino.config.URL_PATH_UI_FRONTOFFICE")+"/"+s1.content;}}if(q1===null||q1===undefined){q1="";}if(typeof q1==="boolean"){p1="Boolean";}else if(typeof q1==="number"){if(parseInt(q1,10)===q1){p1="Integer";}else{p1="Number";}}else if(jQuery.type(q1)==="date"){p1="String";q1=q1.toLocaleString();}if(q1&&typeof q1==="string"){q1=q1.replace(/(\r\n|\n|\r)/gm," ");q1=q1.replace('"','\"');}m1.content=q1;m1.contentRaw=r1;if(t1){m1.href=t1;}m1.type=p1;j1.cells.push(m1);});V.rows.push(j1);}g1.resolve(V);}},error:function(){g1.resolve(V);}});return g1.promise();},getHBoxContent:function(i,j,K,N){var Q=this;var S;var V;if(!V){V=i.getBindingInfo("text");}if(!V){V=i.getBindingInfo("value");}if(!V){V=i.getBindingInfo("tooltip");}if(V){if(V.binding){S=Q._getDataForBinding(i,K,V.binding);N.content=S.content?N.content+S.content:N.content;N.contentRaw=S.contentRaw?N.contentRaw+S.contentRaw:N.contentRaw;}else if(V.parts){S=Q._getDataForParts(i,K,V);N.content=S.content?N.content+S.content:N.content;N.contentRaw=S.contentRaw?N.contentRaw+S.contentRaw:N.contentRaw;}}return N;},_getDataForBinding:function(i,j,K){var N=this;var Q,S;var V=[];if(K instanceof C){jQuery.each(K.aBindings,function(Y,Z){S=N._getDataForPropertyBinding(i,j,Z);if(S.type){Q=S.type;}V.push(S.value);});}else if(K instanceof P){S=N._getDataForPropertyBinding(i,j,K);if(S.type){Q=S.type;}V.push(S.value);}if(K.getType()instanceof b){Q="Date";}else if(K.getType()instanceof T){Q="Time";}else if(K.getType()instanceof c){Q="DateTime";}var W="";var X;if(!i.data("exportRaw")){if(K instanceof C){if(K&&K.getFormatter()){W=K.getFormatter().apply(K,V);}else if(K&&K.getType()){W=K.getType().formatValue(V,K.sInternalType||"any");}else if(V.length>1){W=V.join(" ");}else if(V.length>0){W=V[0];}}else if(V.length>0){W=V[0];}}if(V.length>0){X=V[0];}return{type:Q,content:W,contentRaw:X};},_getDataForPropertyBinding:function(i,j,K){var N;var V=this._getDataForPath(i,j,K);if(K.getType()instanceof b){N="Date";}else if(K.getType()instanceof T){N="Time";}else if(K.getType()instanceof c){N="DateTime";}if(V instanceof Date){N="Date";}return{type:N,value:V};},_getDataForPath:function(i,j,K){var V;if(K.getModel()){if(K.getModel()===this.i18n){V=this._getText(K.getPath());}else{V=j[K.getPath()];}}if(!i.data("exportRaw")){if(K.getType()){V=K.getType().formatValue(V,K.sInternalType||"any");}if(K.getFormatter()){V=K.getFormatter().apply(K,[V]);}}return V;},_getDataForParts:function(i,j,K){var N=this;var Q;var V=[];if(K.type){if(K.type instanceof b){Q="Date";}else if(K.type instanceof T){Q="Time";}else if(K.type instanceof c){Q="DateTime";}}jQuery.each(K.parts,function(X,Y){V.push(N._getDataForPart(i,j,Y));});var S="";var W;if(!i.data("exportRaw")){if(K.formatter){S=K.formatter.apply(this,V);}else if(V.length>1){S=V.join(" ");}else if(V.length>0){S=V[0];}}if(V.length>0){W=V[0];}return{type:Q,content:S,contentRaw:W};},_getDataForPart:function(i,j,K){var V=j[K.path];if(!i.data("exportRaw")){if(K.type){V=K.type.formatValue(V,"any");}if(K.formatter){V=K.formatter.apply(K,[V]);}}return V;},_convertToFormat:function(i,j,K,N,Q){if(j===q){E.i18n=this.i18n;return E.convertToFormatPPTX(i);}else{var S=jQuery.Deferred();if(j==m){S.resolve(this._convertToFormatCSV(i,K,N,Q));}else if(j==n){S.resolve(this._convertToFormatXLS(i,K,N,Q));}else{S.resolve("");}return S.promise();}},_convertToFormatCSV:function(K,N,Q,S){var V=["\uFEFF"];for(var i=0;i<K.headers.length;i++){var W=K.headers[i];V.push('"'+W+'"');V.push(",");}V.push("\n");for(i=0;i<K.rows.length;i++){var X=K.rows[i];for(var j=0;j<X.cells.length;j++){var Y=X.cells[j];if(Y.type==="Date"&&Y.contentRaw){V.push('"'+Y.contentRaw.toLocaleDateString()+'"');}else{V.push('"'+Y.content+'"');}V.push(",");}V.push("\n");}return V.join("");},_convertToFormatXLS:function(K,N,Q,S){var V="<?xml version=\"1.0\"?>"+"<Workbook xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\" "+"xmlns:o=\"urn:schemas-microsoft-com:office:office\" "+"xmlns:x=\"urn:schemas-microsoft-com:office:excel\" "+"xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\" "+"xmlns:html=\"http://www.w3.org/TR/REC-html40\">"+"<DocumentProperties xmlns=\"urn:schemas-microsoft-com:office:office\">"+"<LastAuthor>"+jQuery.sap.encodeXML(Q?Q:"Microsoft Office User")+"</LastAuthor>"+"<Created>"+new Date().toISOString()+"</Created>"+"<Version>14.0</Version>"+"</DocumentProperties>"+"<OfficeDocumentSettings xmlns=\"urn:schemas-microsoft-com:office:office\">"+"<AllowPNG/>"+"</OfficeDocumentSettings>"+"<ExcelWorkbook xmlns=\"urn:schemas-microsoft-com:office:excel\">"+"<WindowHeight>10300</WindowHeight>"+"<WindowWidth>25720</WindowWidth>"+"<WindowTopX>900</WindowTopX>"+"<WindowTopY>100</WindowTopY>"+"<ProtectStructure>False</ProtectStructure>"+"<ProtectWindows>False</ProtectWindows>"+"</ExcelWorkbook>"+"<Styles>"+"<Style ss:ID=\"Default\" ss:Name=\"Normal\">"+"<Alignment ss:Vertical=\"Bottom\"/>"+"<Borders/>"+"<Font ss:FontName=\"Calibri\" ss:Size=\"12\" ss:Color=\"#000000\"/>"+"<Interior/>"+"<NumberFormat/>"+"<Protection/>"+"</Style>"+"<Style ss:ID=\"s62\">"+"<Font ss:FontName=\"Calibri\" ss:Size=\"12\" ss:Color=\"#000000\" ss:Bold=\"1\"/>"+"</Style>"+"<Style ss:ID=\"s63\">"+"<NumberFormat ss:Format=\"Short Date\"/>"+"</Style>"+"<Style ss:ID=\"s64\">"+"<NumberFormat ss:Format=\"Fixed\"/>"+"</Style>"+"<Style ss:ID=\"s65\">"+"<NumberFormat ss:Format=\"0\"/>"+"</Style>"+"<Style ss:ID=\"s66\" ss:Name=\"Hyperlink\">"+"<Font ss:Color=\"#0563C1\" ss:Underline=\"Single\"/>"+"</Style>"+"</Styles>";V+="<Worksheet ss:Name=\""+jQuery.sap.encodeXML(S?S:y)+"\">"+"<Names>"+"<NamedRange ss:Name=\"_FilterDatabase\" ss:RefersTo=\"=Export!R1C1:R1C"+K.headers.length+"\" ss:Hidden=\"1\"/>"+"</Names>"+"<Table ss:ExpandedColumnCount=\""+K.headers.length+"\" ss:ExpandedRowCount=\""+(K.rows.length+1)+"\" "+"x:FullColumns=\"1\" x:FullRows=\"1\" ss:DefaultColumnWidth=\"150\" ss:DefaultRowHeight=\"15\">";V+="<Row ss:AutoFitHeight=\"0\">";for(var i=0;i<K.headers.length;i++){var W=K.headers[i];V+="<Cell ss:StyleID=\"s62\"><Data ss:Type=\"String\">"+jQuery.sap.encodeXML(W)+"</Data><NamedCell ss:Name=\"_FilterDatabase\"/></Cell>";}V+="</Row>";for(i=0;i<K.rows.length;i++){var X=K.rows[i];V+="<Row ss:AutoFitHeight=\"0\">";for(var j=0;j<X.cells.length;j++){var Y=X.cells[j];var Z="String";var $=Y.content;var _="";if(Y.type=="Date"&&Y.contentRaw){Z="DateTime";var a1=new Date(Y.contentRaw);$=a1.toISOString();if($[$.length-1]=="Z"){$=$.substring(0,$.length-1);}_=" ss:StyleID=\"s63\"";}else if(Y.type=="Number"){Z="Number";_=" ss:StyleID=\"s64\"";}else if(Y.type=="Integer"){Z="Number";_=" ss:StyleID=\"s65\"";}else if(Y.type=="Boolean"){Z="Boolean";$=$?1:0;}else if(Y.type=="Href"){_=" ss:StyleID=\"s66\" ss:HRef=\""+Y.href+"\"";}if(Z==="String"){if($.indexOf("=")===0){$=$.replace(/=/," =");}$=jQuery.sap.encodeXML($);}V+="<Cell"+_+"><Data ss:Type=\""+Z+"\">"+$+"</Data></Cell>";}V+="</Row>";}V+="</Table>"+"<WorksheetOptions xmlns=\"urn:schemas-microsoft-com:office:excel\">"+"<PageSetup>"+"<Header x:Margin=\"0.3\"/>"+"<Footer x:Margin=\"0.3\"/>"+"<PageMargins x:Bottom=\"0.75\" x:Left=\"0.7\" x:Right=\"0.7\" x:Top=\"0.75\"/>"+"</PageSetup>"+"<Unsynced/>"+"<PageLayoutZoom>0</PageLayoutZoom>"+"<Selected/>"+"<FreezePanes/>"+"<FrozenNoSplit/>"+"<SplitHorizontal>1</SplitHorizontal>"+"<TopRowBottomPane>1</TopRowBottomPane>"+"<ActivePane>2</ActivePane>"+"<Panes>"+"<Pane><Number>3</Number></Pane>"+"<Pane><Number>2</Number><ActiveRow>1</ActiveRow></Pane>"+"</Panes>"+"<ProtectObjects>False</ProtectObjects>"+"<ProtectScenarios>False</ProtectScenarios>"+"</WorksheetOptions>"+"<AutoFilter xmlns=\"urn:schemas-microsoft-com:office:excel\" x:Range=\"R1C1:R1C"+K.headers.length+"\"/>"+"</Worksheet>";V+="</Workbook>";return V;},_downloadContent:function(i,j,K,N){var Q=jQuery("<a/>",{download:j,style:{display:"none"}});jQuery("body").append(Q);var S;if(this._oBrowser.name===this._oBrowser.BROWSER.SAFARI){if(K===u){S=window.URL.createObjectURL(i);}else{S="data:"+K+";"+N+","+encodeURIComponent(i);}var W=window.open(S,"_blank");setTimeout(function(){W.close();},250);}else if(this._oBrowser.name===this._oBrowser.BROWSER.INTERNET_EXPLORER){jQuery(Q).click(function(){window.navigator.msSaveOrOpenBlob(i,j);});Q[0].click();}else{if(K===u){S=window.URL.createObjectURL(i);}else{S="data:"+K;if(N){S+=";charset="+N;}S+=","+encodeURIComponent(i);}jQuery(Q).attr("href",S);Q[0].click();}},_saveContent:function(i,j,K,N){if(K===s){j+="."+o;}else if(K===t){if(this._oBrowser.version<11){j+="."+p;}}var Q=document.createElement("iframe");Q.id="if1";Q.location="about.blank";Q.style.display="none";document.getElementsByTagName("body")[0].appendChild(Q);var S=document.getElementById("if1").contentWindow.document;S.open(K,"replace");if(N){S.charset=N;}S.write(i);S.close();if(N){document.charset=N;}S.execCommand("SaveAs",false,j);document.getElementsByTagName("body")[0].removeChild(Q);},_showConfirmationPopup:function(i,j,K){M.confirm(this._getText("GENERAL_EXPORT_INS_EXPORT_CONFIRMATION",[K]),{title:this._getText("GENERAL_EXPORT_TIT_EXPORT_CONFIRMATION"),icon:M.Icon.NONE,onClose:function(N){if(N=="OK"){i();}else{j();}}});},_showConfirmationPopupMax:function(i,j,K,N){M.confirm(this._getText("GENERAL_EXPORT_INS_EXPORT_CONFIRMATION_MAX",[K,N]),{title:this._getText("GENERAL_EXPORT_TIT_EXPORT_CONFIRMATION"),icon:M.Icon.NONE,onClose:function(Q){if(Q=="OK"){i();}else{j();}}});},_showIEInstructionPopup:function(i,j,K){if(K===n&&this._oBrowser.version>=11){i();return;}var S=jQuery.sap.storage(jQuery.sap.storage.Type.local);var N="sap.ino.commons.util.Export-IEInstructionPopupNotShowAgain-"+K.toUpperCase();if(!S.get(N)){M.confirm(this._getText("GENERAL_EXPORT_INS_EXPORT_IE_INSTRUCTION_DESCR_"+K.toUpperCase()),{title:this._getText("GENERAL_EXPORT_INS_EXPORT_IE_INSTRUCTION_TITLE"),icon:M.Icon.NONE,onClose:function(Q){if(Q=="OK"){S.put(N,true);i();}else{j();}}});}else{i();}},_getText:function(){if(this.i18n){return this.i18n.getResourceBundle().getText.apply(this.i18n.getResourceBundle(),arguments);}return"";},exportEnabled:function(i){if(this._getModel(i)instanceof O||this._getModel(i)instanceof a){return true;}return false;},exportContent:function(i,j,K,N,Q,S,V){if(!this.exportEnabled(i)){return false;}if(j!=m&&j!=n&&j!=q){return false;}var W=this;function X(V){K=K||y+"."+j;var _,a1="";switch(j){case m:_=s;a1=r;break;case n:_=t;break;case q:_=u;break;default:break;}W._readContent(i,j,V).done(function(b1){var c1=W._convertToFormat(b1,j,K,Q,S);c1.done(function(d1){if(W._oBrowser.name!==W._oBrowser.BROWSER.INTERNET_EXPLORER||_===u){W._downloadContent(d1,K,_,a1);N();}else{W._showIEInstructionPopup(function(){W._saveContent(d1,K,_,a1);N();},function(){N();},j);}});c1.fail(function(){N();});}).fail(function(){N();});}var Y=this._getBinding(i);if(j===q&&Y.sPath.indexOf("/Idea")!==0){return false;}var Z=0;switch(j){case m:Z=v;break;case n:Z=w;break;case q:Z=x;break;default:break;}var $;if(Y.bLengthFinal||Y.iTotalSize){$=Y.iLength||Y.iTotalSize||Z;}else{$=Z;}if(V>0){$=V<$?V:$;}if($>Z){this._showConfirmationPopupMax(function(){X(Z);},N,$,Z);}else if($>=R){this._showConfirmationPopup(function(){X(V);},N,$,j);}else{X(V);}return true;},exportAdvanced:function(i,j,K,N,Q,S,V){var W=this;B.show(0);if(N){N.setEnabled(false);}K=K?this._getText(K):y;K=K.replace(new RegExp("[^a-zA-Z0-9 .-]"),"_");var X=K;var Y=D.getDateTimeInstance({pattern:"dd-MM-yyyy_HH-mm"});X+="_"+Y.format(new Date());X+="."+j;setTimeout(function(){if(!W.exportContent(i,j,X,function(){if(N){N.setEnabled(true);}B.hide();if(V){V();}},Q,K,S)){if(N){N.setEnabled(true);}B.hide();if(V){V();}}},0);},exportChartAdvanced:function(i,j,K,N){var Q=this;B.show(0);if(K){K.setEnabled(false);}var S=D.getDateTimeInstance({pattern:"dd-MM-yyyy_HH-mm"});var V=j;V+="_"+S.format(new Date());V+=".svg";setTimeout(function(){var W=i.exportToSVGString();if(Q._oBrowser.name!=Q._oBrowser.BROWSER.INTERNET_EXPLORER){Q._downloadContent(W,V,"image/svg+xml","");}else{Q._saveContent(W,V,"image/svg+xml","");}if(K){K.setEnabled(true);}B.hide();if(N){N();}},0);},exportAdvancedIdea:function(i,j,K,N){this._generateContent(i,j,K,this._autoDownloadContent,N);},_generateContent:function(i,j,K,N,Q){var S=this;B.show(0);if(K){K.setEnabled(false);}jQuery.ajax({url:k.getBackendRootURL()+"/sap/ino/xs/rest/common/export_idea.xsjs",data:j}).always(function(){if(K){K.setEnabled(true);}B.hide();}).done(function(V){d.show(Q(V.messageKey));N.call(S,V.downloadUrl);}).fail(function(V){d.show(Q(V.responseJSON.messageKey));});},_autoDownloadContent:function(i){if(!i){return;}if(!/^http(s)?/.test(i)){i=window.location.protocol+"//"+i;}var j=jQuery("<a/>",{style:{display:"none"}});jQuery("body").append(j);if(this._oBrowser.name===this._oBrowser.BROWSER.SAFARI){var W=window.open(i,"_blank");setTimeout(function(){W.close();},250);}else{jQuery(j).attr("href",i);j[0].click();}}};});};if(!jQuery.sap.isDeclared('sap.ino.vc.app.App.controller')){jQuery.sap.declare('sap.ino.vc.app.App.controller');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/ino/vc/app/App.controller",["sap/ino/vc/commons/BaseController","sap/m/MessageBox","sap/ui/core/MessageType","sap/ui/Device","sap/ino/commons/application/Configuration"],function(B,M,a,D,C){"use strict";return B.extend("sap.ino.vc.app.App",{_iBusyDelay:1000,_mVisitedRoutes:{},onInit:function(){B.prototype.onInit.apply(this,arguments);var s=this.byId("systemMessage");s.attachClose(function(){s.data("msgClosed",true);this.getParent().getController()._oComponent.getRootController().byId("innerShell").removeStyleClass("sapInoInnoMgmtMShellMsg");});if(C.systemMessage()){s.setText(C.systemMessage());}else{s.data("msgClosed",true);s.setVisible(false);}},getPages:function(){var i=this.byId("innerShell");var I=i.getApp();return I.getPages();},getCurrentPage:function(){var i=this.byId("innerShell");var I=i.getApp();return I.getCurrentPage();},onBypassed:function(e){this.showMessage(a.ERROR,this.getModel("i18n").getResourceBundle().getText("NAVIGATION_EXP_UNKNOWN_TARGET"));},showMessage:function(e,m,t,o){var s=this._getSeverity(e,t);M.show(m,{icon:s.icon,title:s.title,actions:[M.Action.OK],onClose:o?o:undefined,styleClass:this.getDensityClass()});},showConfirmation:function(e,m,t,o){var s=this._getSeverity(e,t);M.confirm(m,{icon:s.icon,title:s.title,actions:[M.Action.OK,M.Action.CANCEL],onClose:o?o:undefined,styleClass:this.getDensityClass()});},showDataLossPopup:function(n){var t=this;var c=function(A){if(A===M.Action.OK){t.resetPendingChanges();n();}else{var v=t.getCurrentPage();if(v){var o=v.getController();if(o.cancelOperationAction){o.cancelOperationAction();}}}};this.showConfirmation(a.QUESTION,this.getText("COMMON_INS_DATALOSS"),this.getText("COMMON_TIT_DATALOSS"),c);},isNavigationAllowed:function(){var v=this.getCurrentPage();if(v){var c=v.getController();if(c.hasPendingChanges&&c.hasPendingChanges()){return false;}}return true;},isCloseAllowed:function(){if(!this.isNavigationAllowed()){return this.getText("COMMON_INS_DATALOSS");}},resetPendingChanges:function(){var v=this.getCurrentPage();if(v){var c=v.getController();if(c.resetPendingChanges){c.resetPendingChanges();}}},onBypassedNavigate:function(){var b=this._oBusyElement||this.getView();b.setBusy(false);b.setBusyIndicatorDelay(this._iBusyDelay);},onAfterNavigate:function(){var b=this._oBusyElement||this.getView();var t=this;setTimeout(function(){b.setBusy(false);b.setBusyIndicatorDelay(t._iBusyDelay);},500);},onBeforeNavigate:function(r){if(!this._oBusyElement){if(this.getView().getDomRef()){var m=jQuery(".sapInoInnoMgmtShell");if(m&&m.length>0){this._oBusyElement=sap.ui.getCore().getElementById(m.attr("id")+"-container");}this._oBusyElement=this._oBusyElement||this.getView();}}var b=this._oBusyElement||this.getView();if(!this._mVisitedRoutes[r]&&r){b.setBusyIndicatorDelay(0);this._mVisitedRoutes[r]=true;}b.setBusy(true);var c=this.getCurrentPage();if(c&&c.getController().onBeforeNavigateFrom){c.getController().onBeforeNavigateFrom();}},onNavigate:function(e){var f=e.getParameter("from");var F=f.getController();if(F.onNavigateFrom){F.onNavigateFrom(e);}var t=e.getParameter("to");var T=t.getController();if(T.onNavigateTo){T.onNavigateTo(e);}},_getSeverity:function(e,t){var s={title:"",icon:undefined};switch(e){case a.ERROR:s.title=t?t:this.getText("MESSAGE_TIT_ERROR");s.icon=M.Icon.ERROR;break;case a.INFORMATION:s.title=t?t:this.getText("MESSAGE_TIT_INFORMATION");s.icon=M.Icon.INFORMATION;break;case a.SUCCESS:s.title=t?t:this.getText("MESSAGE_TIT_SUCCESS");s.icon=M.Icon.SUCCESS;break;case a.QUESTION:s.title=t?t:this.getText("MESSAGE_TIT_QUESTION");s.icon=M.Icon.QUESTION;break;case a.WARNING:s.title=t?t:this.getText("MESSAGE_TIT_WARNING");s.icon=M.Icon.WARNING;break;default:s.title=t?t:this.getText("MESSAGE_TIT_NONE");s.icon=M.Icon.NONE;break;}return s;},openHelpScreen:function(t){var c=this.getOwnerComponent();if(!this._oHelp){this._oHelp=new sap.ui.core.mvc.XMLView({viewName:"sap.ino.vc.app.Help"});this._oHelp.setModel(c.getModel("i18n"),"i18n");this._oHelp.setModel(c.getModel("device"),"device");}this._oHelp.setModel(c.getModel("help"),"help");this._oHelp.getController().show(t?this.getModel("i18n").getResourceBundle().getText(t):undefined);}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.app.Help.controller')){jQuery.sap.declare('sap.ino.vc.app.Help.controller');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.ResponsivePopover');jQuery.sap.require('sap.ui.core.HTML');sap.ui.define("sap/ino/vc/app/Help.controller",["sap/ino/vc/commons/BaseController","sap/m/Text","sap/m/ResponsivePopover","sap/ui/core/HTML"],function(C,T,R,H){"use strict";return C.extend("sap.ino.vc.app.Help",{onInit:function(){C.prototype.onInit.apply(this,arguments);this._oDialog=this.byId("helpDialog");this._oDraggableDialog=this.byId("helpDraggableDialog");this._oDialog.setInitialFocus(this.getView().sId+"--helpClose");this._oDraggableDialog.setInitialFocus(this.getView().sId+"--helpDraggableClose");this._oDraggableDialog.oPopup.setModal(false);this._oDraggableDialog.oPopup.setShadow(false);this._oDraggableDialog.onfocusin=function(){};},show:function(h){var t=this;jQuery("#content").addClass("sapInoBlur");this._$BeforeFocus=jQuery(":focus");this._oDialog.open();this._sContent=h||t.getModel("help").getProperty("/CONTENT");setTimeout(function(){var c=t._oDialog.$().find(".sapInoHelpContentContainer");jQuery.each(c,function(i,$){var o=sap.ui.getCore().getElementById($.id);o.removeAllContent();o.addContent(new H({content:"<p>"+t._sContent+"</p>"}));o.rerender();});},0);},onClose:function(){jQuery("#content").removeClass("sapInoBlur");this._oDialog.close();},onAfterClose:function(){jQuery("#content").removeClass("sapInoBlur");if(!this._bNoFocusAfterClose&&this._$BeforeFocus){this._$BeforeFocus.focus();}this._bNoFocusAfterClose=false;},onDraggableAfterClose:function(){if(this._$BeforeFocus){this._$BeforeFocus.focus();}},onDraggableDialogOpen:function(){var t=this;jQuery("#content").removeClass("sapInoBlur");this._bNoFocusAfterClose=true;this._oDialog.close();this._oDraggableDialog.open();setTimeout(function(){var c=t._oDraggableDialog.$().find(".sapInoHelpContentContainer");jQuery.each(c,function(i,$){var o=sap.ui.getCore().getElementById($.id);o.removeAllContent();o.addContent(new H({content:"<p>"+t._sContent+"</p>"}));o.rerender();});},0);},onDraggableClose:function(){this._oDraggableDialog.close();}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.blog.mixins.DeleteActionMixin')){jQuery.sap.declare('sap.ino.vc.blog.mixins.DeleteActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/blog/mixins/DeleteActionMixin",["sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Blog","sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast"],function(B,J,a,P,M){"use strict";var D=function(){throw"Mixin may not be instantiated directly";};D.onDeleteBlog=function(e){var s=e.getSource();var b=s.getBindingContext("data").getProperty("ID");var S={nodes:[],actions:["del"]};var t=this;var d=function(o){var c=o.getSource();var f=c.getProperty("/actions/del/enabled");if(!f){M.show(t.getText("OBJECT_MSG_DELETE_FAILED"));}else{var g=B.prototype.executeObjectAction.call(t,a,"del",{staticparameters:b,messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});g.done(function(r){if(r&&r.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(t.bindList&&typeof(t.bindList)==="function"){t.bindList();}else if(t._bindBlogs&&typeof(t._bindBlogs)==="function"&&t._sBlogViewKey){t._bindBlogs(t._sBlogViewKey);}});}};var p=new P("sap.ino.xs.object.blog.Blog",b,S,false,d);};return D;});};if(!jQuery.sap.isDeclared('sap.ino.vc.blog.mixins.PublishActionMixin')){jQuery.sap.declare('sap.ino.vc.blog.mixins.PublishActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/blog/mixins/PublishActionMixin",["sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Blog","sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast"],function(B,J,a,P,M){"use strict";var b=function(){throw"Mixin may not be instantiated directly";};b.onPublishBlog=function(e){var s=e.getSource();var i=s.getBindingContext("data").getProperty("ID");var S={nodes:[],actions:["publishSubmit"]};var t=this;var p=function(c){var d=c.getSource();var f=d.getProperty("/actions/publish/enabled");if(!f){M.show(t.getText("OBJECT_MSG_PUBLISH_FAILED"));}else{var g=B.prototype.executeObjectAction.call(t,a,"publish",{staticparameters:i,messages:{confirm:"MSG_PUBLISH_CONFIRM",success:"MSG_PUBLISH_SUCCESS"}});g.done(function(r){if(r&&r.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(t.bindList&&typeof(t.bindList)==="function"){t.bindList();}else if(t._bindBlogs&&typeof(t._bindBlogs)==="function"&&t._sBlogViewKey){t._bindBlogs(t._sBlogViewKey);}});}};var o=new P("sap.ino.xs.object.blog.Blog",i,S,false,p);};return b;});};if(!jQuery.sap.isDeclared('sap.ino.vc.blog.mixins.UnPublishActionMixin')){jQuery.sap.declare('sap.ino.vc.blog.mixins.UnPublishActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/blog/mixins/UnPublishActionMixin",["sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Blog","sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast"],function(B,J,a,P,M){"use strict";var U=function(){throw"Mixin may not be instantiated directly";};U.onUnPublishBlog=function(e){var s=e.getSource();var b=s.getBindingContext("data").getProperty("ID");var S={nodes:[],actions:["unpublish"]};var t=this;var u=function(o){var c=o.getSource();var d=c.getProperty("/actions/unpublish/enabled");if(!d){M.show(t.getText("OBJECT_MSG_UnPublish_FAILED"));}else{var f=B.prototype.executeObjectAction.call(t,a,"unpublish",{staticparameters:b,messages:{confirm:"MSG_UNPUBLISH_CONFIRM",success:"MSG_UNPUBLISH_SUCCESS"}});f.done(function(r){if(r&&r.confirmationCancelled===true){if(s&&jQuery.type(s.focus)==="function"){s.focus();}return;}if(t.bindList&&typeof(t.bindList)==="function"){t.bindList();}else if(t._bindBlogs&&typeof(t._bindBlogs)==="function"&&t._sBlogViewKey){t._bindBlogs(t._sBlogViewKey);}});}};var p=new P("sap.ino.xs.object.blog.Blog",b,S,false,u);};return U;});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.Homepage.controller')){jQuery.sap.declare('sap.ino.vc.campaign.Homepage.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/campaign/Homepage.controller",["sap/ino/vc/commons/BaseHomepageController","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/application/Configuration","sap/ino/commons/application/WebAnalytics","sap/ino/commons/models/aof/PropertyModel","sap/ui/model/json/JSONModel","sap/ino/vc/campaign/mixins/CampaignInstanceRolesMixin"],function(B,T,C,W,P,J,a){"use strict";return B.extend("sap.ino.vc.campaign.Homepage",jQuery.extend({},a,T,{routes:["campaign"],onRouteMatched:function(e){var A=e.getParameter("arguments");this.iCampaignId=parseInt(A.id,0);if(this.iCampaignId>0){W.logCampaignView(this.iCampaignId);var u=C.getBackendRootURL()+"/sap/ino/xs/rest/common/update_object_view_count.xsjs";var b={OBJECT_TYPE:"CAMPAIGN",OBJECT_ID:this.iCampaignId,USER_NAME:C.getCurrentUser().USER_NAME};var o=jQuery.ajax({url:u,headers:{"X-CSRF-Token":C.getXSRFToken()},data:JSON.stringify(b),dataType:"json",type:"POST",contentType:"application/json; charset=UTF-8",async:true});o.done();}B.prototype.onRouteMatched.apply(this,arguments);this.setHelp("CAMPAIGN_DISPLAY","CAMPAIGN_DISPLAY_ADDITIONAL");},onBeforeDisplayViewShow:function(){var v=this.getView();if(v.getBindingContext("data")){var i=v.getBindingContext("data").getProperty("CAMPAIGN_BACKGROUND_IMAGE_ID");var s=v.getBindingContext("data").getProperty("CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID");this.updateBackgroundColor(v.getBindingContext("data").getProperty("COLOR_CODE"));this.setBackgroundImages(i,s);}},getDisplayView:function(i){var d;var s=this.getModel("component").getProperty("/SHOW_BACKOFFICE");var h=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");var r=this.getModel("component").getProperty("/REGISTRABLE");var c=this.getModel("component").getProperty("/COMMUNITY");if(!h){s=false;this.setModel(new J({}),"property");}else{if(i){var o=new P("sap.ino.xs.object.campaign.Campaign",i,{nodes:["Root"]},true);this.setModel(o,"property");var b=o.getProperty("/nodes/Root/customProperties/backofficeCampaignPrivilege");s=s&&b;}}this.getCampaignInstanceRolesData(i);if(s){d="sap.ino.vc.campaign.BackOfficeHome";}else if(c){d="sap.ino.vc.campaign.CommunityHome";}else if(r){d="sap.ino.vc.campaign.RegistrationHome";}else{d="sap.ino.vc.campaign.CommunityHome";}return d;},hasBackgroundImage:function(){return true;},getLayoutPrefix:function(){return"sapInoCampaignHomepage";},getODataEntitySet:function(){return"CampaignFull";},onBeforeHide:function(){B.prototype.onBeforeHide.apply(this,arguments);},openCampaignSettings:function(c){this.navigateToByURLInNewWindow(C.getCampaignSettingsURL(c));}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.mixins.MilestoneMixin')){jQuery.sap.declare('sap.ino.vc.campaign.mixins.MilestoneMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.ResizeHandler');sap.ui.define("sap/ino/vc/campaign/mixins/MilestoneMixin",["sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/application/Configuration","sap/ino/controls/Milestone","sap/ui/core/ResizeHandler"],function(B,J,P,C,M,R){"use strict";var m=function(){throw"Mixin may not be instantiated directly";};m.bindResize=function(){var s=this;this._sResizeRegId=R.register(this.getView(),function(){return s._onResize(s);});};m._onResize=function(){this.buildMilestone();};m.bindMilestone=function(c){var s=this;var p=C.getBackendRootURL()+"/sap/ino/xs/rest/common/campaign_task_milestone.xsjs";var a=[];if(c){a.push("CAMPAIGN_ID="+c);}if(a.length>0){p=p+"?"+a.join("&");}this.destroyMilestone();var b=new J(p);this.getView().setModel(b,"milestoneTask");b.attachRequestCompleted(null,function(){var d=b.getData();s.renderData(d);s.buildMilestone();},b);};m.renderData=function(d){if(!d){return false;}if(!d.Tasks||!d.Tasks.results||!d.Tasks.results.length){return false;}var s=this;var t=d.Tasks.results;var a=s.getText("MILESTONE_ATTACHMENT_DOWNLOAD");for(var i=0;i<t.length;i++){t[i].Milestones=t[i].Milestones.results;t[i].END_DATE=new Date(t[i].END_DATE);t[i].START_DATE=new Date(t[i].START_DATE);if(!t[i].Milestones||!t[i].Milestones.length){continue;}for(var x=0;x<t[i].Milestones.length;x++){t[i].Milestones[x].MILESTONE_DATE=new Date(t[i].Milestones[x].MILESTONE_DATE);t[i].Milestones[x].Attachment=t[i].Milestones[x].Attachment.results;if(!t[i].Milestones[x].Attachment||!t[i].Milestones[x].Attachment.length){continue;}for(var j=0;j<t[i].Milestones[x].Attachment.length;j++){t[i].Milestones[x].Attachment[j].LABEL=a;t[i].Milestones[x].Attachment[j].ATTACHMENT_URL=C.getAttachmentDownloadURL(t[i].Milestones[x].Attachment[j].ATTACHMENT_ID);}}}this.tasks=t;};m.buildMilestone=function(){if(!this.tasks||!this.tasks.length){return false;}var t=this.tasks;for(var i=0;i<t.length;i++){var s=t[i].START_DATE.getTime()+t[i].START_DATE.getTimezoneOffset()*60*1000;t[i].START_DATE=new Date(s);var e=t[i].END_DATE.getTime()+t[i].END_DATE.getTimezoneOffset()*60*1000;t[i].END_DATE=new Date(e);}var v=this.getView();var a=v.byId('milestoneContainer');a.destroyItems();a.addItem(new sap.ino.controls.Milestone({tasks:this.tasks,visible:true}));if(!this._sResizeRegId){this.bindResize();}};m.destroyMilestone=function(){var v=this.getView();var a=v.byId('milestoneContainer');a.destroyItems();this.tasks=[];};return m;});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.BaseBlockController')){jQuery.sap.declare('sap.ino.vc.commons.BaseBlockController');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/ino/vc/commons/BaseBlockController",["./BaseController","sap/uxap/BlockBase"],function(B,a){return B.extend("sap.ino.vc.commons.BaseBlockController",{getBlockView:function(){var v=B.prototype.getView.apply(this,arguments);if(v.getParent()&&v.getParent().getMetadata().getParent()&&v.getParent().getMetadata().getParent().getName()==="sap.uxap.BlockBase"){v.data=function(){var p=v.getParent();return p.data.apply(p,arguments);};}return v;}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.BaseObjectController')){jQuery.sap.declare('sap.ino.vc.commons.BaseObjectController');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.core.MessageType');sap.ui.define("sap/ino/vc/commons/BaseObjectController",["./BaseBlockController","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ino/commons/formatters/ObjectFormatter","./mixins/IdentityQuickviewMixin","./mixins/ClipboardMixin","./mixins/IdentityCardSendMailMixin","sap/ui/core/MessageType"],function(B,J,M,O,I,C,a,b){return B.extend("sap.ino.vc.commons.BaseObjectController",jQuery.extend({},I,C,a,{formatter:O,onInit:function(){B.prototype.onInit.apply(this,arguments);},onExit:function(){if(B.prototype.onExit){B.prototype.onExit.apply(this,arguments);}this.releaseObjectModel();},setObjectModel:function(m){if(m!==this.getView().getModel("object")&&this.hasOwnModel("object")){this.releaseObjectModel();}else{this.getView().setModel(null,"object");}this.getView().setModel(m,"object");this.getView().bindElement({path:"object>/"});},releaseObjectModel:function(){var o=this.getView().getModel("object");if(o){o.releaseFromSyncMode();o.destroy();}},createObjectModel:function(o,r,R){},getObjectModel:function(){var o=this.getView().getModel("object");if(o&&o.isDeleted()){this.setObjectExists(false);this.setObjectModel(undefined);return undefined;}return o;},hasPendingChanges:function(){return false;},resetPendingChanges:function(){var m=this.getObjectModel();if(m&&m.hasPendingChanges()){m.revertChanges();}},doModelsMatch:function(m){if(!m){return false;}var o=this.getObjectModel();if(!o){return false;}if(m.getObjectName()===o.getObjectName()&&m.getKey()===o.getKey()){return true;}return false;},getODataEntitySet:function(){return null;},bindDefaultODataModel:function(i,c){var t=this;var e=this.getODataEntitySet();if(e&&i>0){this.getView().bindElement({path:"data>/"+e+"("+i+")",events:{dataRequested:function(){jQuery.each(t.getBusyControls(),function(d,f){if(jQuery.type(f.setBusy)==="function"){f.setBusy(true);}});},dataReceived:function(E){jQuery.each(t.getBusyControls(),function(d,f){if(jQuery.type(f.setBusy)==="function"){f.setBusy(false);}});if(E.getParameter("data")===undefined){t.setObjectExists(false);}else{t.setObjectExists(true);}if(typeof c==="function"){c.apply(t);}},change:function(){var d=this.getModel().getProperty(this.getPath())!==undefined;t.setObjectExists(d);}}});if(typeof c==="function"){var o=this.getView().getBindingContext("data");if(o&&o.getPath()===("/"+e+"("+i+")")){c.apply(t);}}}},getDefaultODataModelEntity:function(i){return this.getModel("data").getProperty("/"+this.getODataEntitySet()+"("+i+")");},onRouteMatched:function(e){var t=this;var r=e.getParameter("name");var R=e.getParameter("arguments");var o;try{o=parseInt(R.id,10);}catch(E){return;}var c=this.getObjectModel();if(!c||c.getKey()!==o){c=this.createObjectModel(o,r,R);this.setObjectModel(c);c.getDataInitializedPromise().fail(function(){t.setObjectExists(false);if(t.preCheck){t.checkObjectExists(c.getObjectName(),c.getKey()||c.getInitKey());}});c.getDataInitializedPromise().done(function(){t.setObjectExists(true);});}this.bindDefaultODataModel(o);var q=R["?query"];var s=(q&&q.section)||"sectionDetails";this.showSection(s);},onTabSelect:function(e){var s=e.getParameter("section");this.navigateTo(this.getCurrentRoute(),{id:this.getObjectModel().getKey(),query:{section:this.getLocalElementId(s)}},true);},showSection:function(l,o){var t=this;var L=this.byId(o?o:"objectpage");if(!L){return;}var s=this.byId(l);if(!s){return;}var S=s.getId();L.addEventDelegate({onAfterRendering:jQuery.proxy(function(){jQuery.sap.delayedCall(500,L,L.scrollToSection,[S]);},t)});var f=function(){L.scrollToSection(S);var e=L.getAggregation("_anchorBar");jQuery.sap.delayedCall(500,this,function(){e.scrollToSection(S);});t.setViewProperty("/objectPageSection",l);};var c=jQuery.Deferred();c.done(f);if(L._bDomReady===true){c.resolve();}else{var d=function(){if(L._bDomReady===true){c.resolve();}else{jQuery.sap.delayedCall(500,this,d);}};jQuery.sap.delayedCall(500,this,d);}},onShowMessages:function(e){this.byId("messagePopover").openBy(e.getSource());},executeObjectAction:function(A,o){var c=(o&&o.objectModelExt)||this.getObjectModel();if(c instanceof sap.ino.commons.models.object.Idea&&c.getProperty("/STATUS_CODE")==="sap.ino.config.DRAFT"&&((A==="modify"&&c.getProperty("/NAME"))||A==="del")){this.enforceInputTypeValidations();this.resetInputTypeValidations(this.getView());}else if(this.hasAnyClientErrorMessages()){var d=new jQuery.Deferred();if(c instanceof sap.ino.commons.models.object.Idea){var e=this.getErrorClientMessages(this.getOwnerComponent().getModel("message").getData());var E=this.getText("MSG_SAVE_USER_ERROR");if(e.length>0){E=e[0].message;}M.show(E);}else{M.show(this.getText("MSG_SAVE_USER_ERROR"));}d.reject();return d.promise();}return B.prototype.executeObjectAction.call(this,c,A,o);},executeObjectActionPrototypeDirectly:function(A,o){var c=(o&&o.objectModelExt)||this.getObjectModel();return B.prototype.executeObjectAction.call(this,c,A,o);},getErrorClientMessages:function(m){if(this._previousClientMessages&&this._previousClientMessages.length>0){return this._previousClientMessages;}var e=m.filter(function(o){return o.processor.getMetadata().getName()==="sap.ui.core.message.ControlMessageProcessor"&&o.type===b.Error;});return e;}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.BaseObjectModifyController')){jQuery.sap.declare('sap.ino.vc.commons.BaseObjectModifyController');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.m.Token');jQuery.sap.require('sap.m.Tokenizer');jQuery.sap.require('sap.ui.core.MessageType');sap.ui.define("sap/ino/vc/commons/BaseObjectModifyController",["./BaseObjectController","sap/ui/Device","sap/ui/core/ListItem","sap/m/Token","sap/m/Tokenizer","sap/ui/core/MessageType"],function(B,D,L,T,a,M){"use strict";return B.extend("sap.ino.vc.commons.BaseObjectModifyController",{onInit:function(){B.prototype.onInit.apply(this,arguments);},onRouteMatched:function(e){var t=this;var r=e.getParameter("name");var R=e.getParameter("arguments");var v=this.getView();this.setObjectExists(true);v.setBusy(true);this.resetInputTypeValidations();var o;if(R.id){try{o=parseInt(R.id,10);}catch(E){jQuery.sap.log.error("Failed parsing key argument",E,"sap.ino.vc.commons.BaseObjectModify.controller");return;}}var O=this.getObjectModel();if(!O||!o||O.getKey()!==o){O=this.createObjectModel(o,r,R);}this.setObjectModel(O);O.getDataInitializedPromise().always(function(){v.setBusy(false);});O.getDataInitializedPromise().fail(function(){t.setObjectExists(false);if(t.preCheck){t.checkObjectExists(O.getObjectName(),O.getKey()||O.getInitKey());}});},onCancel:function(){this.navigateBack();},onDelete:function(e){var c=this;var d=e.getSource();var o=this.executeObjectAction("del",{messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});o.done(function(r){if(r&&r.confirmationCancelled===true){if(d&&jQuery.type(d.focus)==="function"){d.focus();}return;}c.navigateTo("home");});},hasPendingChanges:function(){var m=this.getObjectModel();if(m){return m.hasPendingChanges();}return false;},addMultiInputHandling:function(c,s){if(!c){return;}var t=this;var o=new T({key:"{object>"+s.token.key+"}",text:"{object>"+s.token.text+"}",editable:t._getEditable(s.token)});c.bindAggregation("tokens",{path:"object>"+s.childNodeName,template:o});var S=t._createSuggestHandler(s.suggestion);c.attachSuggest(S,t);var f=t._createTokenChangedHandler(s);c.attachTokenChange(f,t);},_getEditable:function(t){if(!t.hasOwnProperty("editable")){return true;}var s=typeof t.editable;if(s==="string"||(s==="object"&&t.editable.hasOwnProperty("path"))){return t.editable;}return!!t.editable;},_createTokenChangedHandler:function(s){return function(E){var t=E.getParameter("type");if(t===a.TokenChangeType.Removed||t===a.TokenChangeType.RemovedAll||(t===a.TokenChangeType.Added&&!E.getParameter("token").bApplicationCreated)){return;}var A=E.getParameter("addedTokens")||[E.getParameter("token")]||[];var r=E.getParameter("removedTokens")||[];var o=this.getObjectModel();A.forEach(function(b){var n={};var k=b.getKey();try{k=parseInt(b.getKey(),10);}catch(e){}n[s.token.key]=k;n[s.token.text]=b.getText();var c="add"+s.childNodeNameSingular;var m;if(o[c]){m=o[c].apply(o,[n]);}else{m=o.addChild(n,s.childNodeName);}if(m&&m.type===M.Error){b.destroy();}});r.forEach(function(b){if(!b.getBindingContext){return;}var c=b.getBindingContext("object");if(!c){return;}var C=c.getObject();o.removeChild(C);});};}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.CriterionValueHelp.controller')){jQuery.sap.declare('sap.ino.vc.evaluation.CriterionValueHelp.controller');sap.ui.define("sap/ino/vc/evaluation/CriterionValueHelp.controller",["sap/ino/vc/commons/BaseController","sap/ino/commons/formatters/ObjectFormatter"],function(C,O){"use strict";O.criterionCodeWrapper=function(c,a){if(c){return O.criterionCode(c);}else if(a){return O.criterionCode(a);}return undefined;};O.criterionCodeLongTextWrapper=function(c,a){if(c){return O.criterionCodeLongText(c);}else if(a){return O.criterionCodeLongText(a);}return undefined;};return C.extend("sap.ino.vc.evaluation.CriterionValueHelp",{formatter:O,onInit:function(){C.prototype.onInit.apply(this,arguments);},open:function(c,p){var v=this.getView();var o=v.byId("criterionValueHelp");v.bindElement({path:"object>"+p,events:{change:function(){o.openBy(c);}}});}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.EvaluationFormatter')){jQuery.sap.declare('sap.ino.vc.evaluation.EvaluationFormatter');jQuery.sap.require('sap.ui.core.format.NumberFormat');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/ino/vc/evaluation/EvaluationFormatter",["sap/ino/commons/models/core/CodeModel","sap/ui/core/format/NumberFormat","sap/ui/base/Object","sap/ino/commons/formatters/ObjectFormatter","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/models/aof/PropertyModelCache"],function(C,N,O,a,P,b){"use strict";var f=N.getFloatInstance({maxFractionDigits:2});var e=O.extend("sap.ino.vc.evaluation.EvaluationFormatter",{});jQuery.extend(e,a);var E=P.getStaticActionEnabledStaticFormatter("sap.ino.xs.object.evaluation.Evaluation","create",function(i){return{IDEA_ID:i};});var c=P.getStaticActionEnabledDynamicFormatter("sap.ino.xs.object.evaluation.Evaluation","create",function(i){return{IDEA_ID:i};});var d=P.getStaticActionEnabledDynamicFormatter("sap.ino.xs.object.evaluation.EvaluationRequest","create",function(i){return{IDEA_ID:i};});e.getFormattedValue=function(D,n,B,t,v,u,V,o){var g=e.getValue(D,n,B,t);var F="";if(v){var s="sap.ino.xs.object.basis.ValueOptionList.Root_"+v;var r=e.getRawValue(D,n,B,t);F=C.getText(s,r);}else{switch(D){case"INTEGER":F=Math.round(g).toString();break;case"NUMERIC":F=f.format(e.toFloat(g));break;case"BOOLEAN":F=e.booleanValueToString(g,o?o:this);break;case"TEXT":F=g;break;default:F=g.toString();break;}}if(!F){F="";}if(u){F=F+" "+C.getText("sap.ino.xs.object.basis.Unit.Root",u);}return F;};e.getFormattedValueEvaluations=function(D,n,B,t,v,u,V,o){var g=e.getValueEvaluations(D,n,B,t);var F="";if(v){var s="sap.ino.xs.object.basis.ValueOptionList.Root_"+v;var r=e.getRawValue(D,n,B,t);F=C.getText(s,r);}else{switch(D){case"INTEGER":F=Math.round(g).toString();break;case"NUMERIC":F=f.format(e.toFloat(g));break;case"BOOLEAN":F=e.booleanValueToString(g,o?o:this);break;case"TEXT":F=g;break;default:F=g.toString();break;}}if(!F){F="";}if(u){F=F+" "+C.getText("sap.ino.xs.object.basis.Unit.Root",u);}return F;};e.isFormattedValueVisible=function(D,n,B,t,v,u,V,o){if(!o){o=this;}var F=e.getFormattedValue(D,n,B,t,v,u,V,o);return F?F.trim().length>0:false;};e.getValue=function(D,n,B,t){var v=null;switch(D){case"INTEGER":v=Math.round(n);break;case"NUMERIC":v=typeof n==="string"?f.parse(n):n;break;case"BOOLEAN":v=B===1;break;case"TEXT":v=t;break;default:break;}switch(D){case"INTEGER":case"NUMERIC":if(isNaN(v)||v===undefined||v===null){v=0;}break;case"BOOLEAN":if(v===undefined||v===null){v=false;}break;case"TEXT":if(v===undefined||v===null){v="";}break;default:if(v===undefined||v===null){v="";}break;}return v;};e.getValueEvaluations=function(D,n,B,t){var v=null;switch(D){case"INTEGER":v=Math.round(n);break;case"NUMERIC":n=parseFloat(n);v=typeof n==="string"?f.parse(n):n;break;case"BOOLEAN":v=B===1;break;case"TEXT":v=t;break;default:break;}switch(D){case"INTEGER":case"NUMERIC":if(isNaN(v)||v===undefined||v===null){v=0;}break;case"BOOLEAN":if(v===undefined||v===null){v=false;}break;case"TEXT":if(v===undefined||v===null){v="";}break;default:if(v===undefined||v===null){v="";}break;}return v;};e.getRawValue=function(D,n,B,t){var v=null;switch(D){case"INTEGER":v=n;if(jQuery.type(n)){v=parseInt(n,10);}break;case"NUMERIC":v=n;if(jQuery.type(n)==='string'){var r=N.getFloatInstance({});v=r.parse(n);}else{v=parseFloat(n,10);}break;case"BOOLEAN":v=B;break;case"TEXT":v=t;break;default:break;}if(D!=="TEXT"&&(isNaN(v)||v===undefined||v===null)){switch(D){case"INTEGER":case"NUMERIC":case"BOOLEAN":v=0;break;default:v="";break;}}return v;};e.getWeight=function(w){var W=null;if(w===undefined||w===null){W="";}else{W="\("+w+"\%"+"\)";}return W;};e.getWeightMultiply=function(w){var W=null;if(w===undefined||w===null){W="";}else{W="\*"+w+"\%";}return W;};e.booleanValueToString=function(v,o){if(v===undefined||v===null){return o.getText("EVALUATION_FLD_UNKNOWN");}else if(v===1||v===true){return o.getText("EVALUATION_FLD_YES");}else if(v===0||v===false){return o.getText("EVALUATION_FLD_NO");}else{return o.getText("EVALUATION_FLD_UNKNOWN");}};e.hasSubcriteria=function(g){if(g&&g.length>0){return true;}return false;};e.isComboBoxControl=function(v){if(v){return true;}return false;};function m(D,v,t){if(D===t&&e.isComboBoxControl(v)){return true;}return false;}e.isTextVoL=function(D,v){return m(D,v,"TEXT");};e.isIntegerVoL=function(D,v){return m(D,v,"INTEGER");};e.isNumericVoL=function(D,v){return m(D,v,"NUMERIC");};e.isBooleanVoL=function(D,v){return m(D,v,"BOOLEAN");};e.isTextControl=function(D,v){if(e.isComboBoxControl(v)){return false;}return D==="TEXT";};e.isBooleanControl=function(D,v){if(e.isComboBoxControl(v)){return false;}return D==="BOOLEAN";};e.isInputControl=function(D,v){if(e.isComboBoxControl(v)){return false;}return D==="NUMERIC"||D==="INTEGER";};e.isProgressIndicatorControl=function(n,s,v,D){if(e.isComboBoxControl(v)){return false;}if(D!=="INTEGER"&&D!=="NUMERIC"){return false;}if(n===undefined||n===null||s===undefined||s===null){return false;}if(n===s){return false;}return true;};e.isProgressIndicator=function(n,s,v,D){if(e.isProgressIndicatorControl(n,s,v,D)){return"true";}return"false";};e.formatSliderStep=function(n,s,g,D){if(jQuery.isNumeric(n)&&jQuery.isNumeric(s)&&jQuery.isNumeric(g)){var h=parseFloat(s);var i=parseFloat(n);var j=parseFloat(g);var k=h-i;if(D==="INTEGER"){if(j===0){if(k<1&&k>0){return k;}else{return 1;}}return j;}if(D==="NUMERIC"){if(j===0){if(k<1&&k>0){return k;}else{return 0.01;}}return j;}}return 1;};e.showInputControl=function(D,n,s,v,g){if(e.isComboBoxControl(v)){return false;}if(g&&g.length>0){return false;}if((D==="INTEGER"||D==="NUMERIC")&&!e.isProgressIndicatorControl(n,s,v,D)){return true;}return false;};e.showAggregatingProgressIndicatorControl=function(n,s,g,v,D){if(e.isComboBoxControl(v)){return false;}if(g&&g.length>0){return false;}return e.isProgressIndicatorControl(n,s,v,D)&&(D==="INTEGER"||D==="NUMERIC");};e.showAggregatingCheckBoxControl=function(D,g,v){if(e.isComboBoxControl(v)){return false;}if(g&&g.length>0){return false;}return e.isBooleanControl(D,v);};e.showValue=function(D,n,s,v){if(D==="INTEGER"){return e.isProgressIndicatorControl(n,s,v,D);}return false;};e.showTextValue=function(D,v,n,s){return(e.isTextControl(D,v)||e.isBooleanControl(D)||e.showInputControl(D,n,s,v));};e.showAggregatingValue=function(D,n,s,v,g){if(e.isComboBoxControl(v)){return false;}if(g&&g.length>0){return false;}if(e.showInputControl(D,n,s,v,g)){return false;}return e.showAggregatingValueDisplay(D,n,s);};e.showAggregatingBooleanValue=function(D,g){return D!=="TEXT"&&(g&&g.length>0);};e.showAggregatingValueDisplay=function(D,n,s){return(D==="INTEGER"&&!e.showInputControl(D,n,s));};e.showComment=function(D,s){if(s){return true;}return!e.isTextControl(D);};e.showWarningMsg=function(M){if(M){return true;}return false;};e.showCommentDisplay=function(D,s){if(s&&!e.isTextControl(D)){return true;}return false;};e.showEvaluationCommentDisplay=function(s){if(s){return true;}return false;};e.progressIndicatorValue=function(D,n,B,t,v,u,M,s){var V=e.getFormattedValue(D,n,B,t,v,u,undefined,this);var i=parseInt(V,10);var g=parseInt(M,10);var h=parseInt(s,10);if(jQuery.type(i)==="number"&&jQuery.type(g)==="number"&&jQuery.type(h)==="number"){return Math.round(100*(i-g)/(h-g));}return 0;};e.hasMyEvaluations=function(M){var h=false;var i=this.getView()&&this.getView().getModel&&this.getView().getModel("object")&&this.getView().getModel("object").getProperty("/ID");if(i!==undefined){if(M){jQuery.each(M,function(I,o){if(I&&I.indexOf("IdeaMyEvaluation")===0&&o&&o.IDEA_ID===i){h=true;}});}}else{h=true;}return h;};e.statusActionCode=function(A){return C.getText("sap.ino.xs.object.status.Action.Root",A);};e.submitButtonVisible=function(s,g,i){if(g){return true;}if(s==='sap.ino.config.EVAL_DRAFT'&&i<0){return true;}return false;};e.createEvaluationEnabled=function(i){if(i){return E(i);}return false;};e.createEvaluationDynamicFormatter=function(i){if(i){return c(i);}return false;};e.selfEvaluationButtonLabel=function(i){var o=this.getView().getController();if(i){if(c(i)&&P.getCacheModel().getProperty("/sap.ino.xs.object.evaluation.Evaluation/actions/create/customProperties/SELF_EVALUATION_ACTIVE")){return o.getText("IDEA_OBJECT_BTN_CREATE_SELF_EVALUATION");}}return o.getText("IDEA_OBJECT_BTN_CREATE_EVALUATION");};e.createEvaluationRequestEnabled=function(i){if(i){return d(i);}return false;};return e;});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.RequestsDisplay.controller')){jQuery.sap.declare('sap.ino.vc.evaluation.RequestsDisplay.controller');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/evaluation/RequestsDisplay.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/commons/models/object/EvaluationRequest","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/vc/evaluation/EvaluationFormatter"],function(B,E,M,J,T,a){"use strict";return B.extend("sap.ino.vc.evaluation.RequestsDisplay",jQuery.extend({},T,{formatter:a,routes:["evaluationrequest-display"],onInit:function(){B.prototype.onInit.apply(this,arguments);},onRouteMatched:function(e){var c=this;B.prototype.onRouteMatched.apply(c,arguments);c.setHelp("EVALUATIONREQUESTS_DISPLAY");c.setViewProperty("/USER_IMAGE_ID",c.getOwnerComponent().getCurrentUserImageId());var r=e.getParameter("arguments");var q=r["?query"];var s=(q&&q.section)||"sectionExperts";this.showSection(s);},createObjectModel:function(o){return new E(o,{nodes:["Root"],actions:["update","del","executeStatusTransition","submit"],continuousUse:true,readSource:{model:this.getDefaultODataModel()}});},getODataEntitySet:function(){return"EvaluationRequest";},onTabSelect:function(e){var s=e.getParameter("section");this.navigateTo(this.getCurrentRoute(),{id:this.getObjectModel().getKey(),query:{section:this.getLocalElementId(s)}});},onRequestItemPress:function(e){var n=e.getSource().getBindingContext("object").getProperty("EVALUATION_ID");if(n){this.navigateTo("evaluation-display",{id:n});}},onEdit:function(){this.navigateTo("evaluationrequest-edit",{id:this.getObjectModel().getKey()},true);},onIdeaPressed:function(){var i=this.getObjectModel().getProperty("/IDEA_ID");this.navigateTo("idea-display",{id:i},true);},onOpenCreator:function(e){var s=e.getSource();var i=s.getCustomData()[0].getProperty("value");if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(s,i);},onBeforeHide:function(){this.setObjectModel(null);}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.RequestsItem.controller')){jQuery.sap.declare('sap.ino.vc.evaluation.RequestsItem.controller');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.m.Token');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/evaluation/RequestsItem.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ino/commons/models/object/EvaluationRequestItem","sap/ino/commons/models/object/EvaluationRequestComment","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/models/aof/PropertyModel","sap/ui/model/Filter","sap/m/Token","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/ui/core/MessageType","sap/ui/core/message/Message","sap/m/MessageBox","sap/ino/commons/application/Configuration","sap/ino/vc/evaluation/EvaluationFormatter"],function(B,E,a,M,J,T,P,F,b,c,S,d,e,f,C,g){"use strict";return B.extend("sap.ino.vc.evaluation.RequestsItem",jQuery.extend({},T,{routes:["evaluationrequest-item"],onInit:function(){B.prototype.onInit.apply(this,arguments);},onRouteMatched:function(){B.prototype.onRouteMatched.apply(this,arguments);var o=this;o.setHelp("EVALUATIONREQUESTS_ITEM");var r=this.getObjectModel();r.getDataInitializedPromise().done(function(D){if(r.oData.Clarifications.length>0){o.setViewProperty("/CLARIFICATION_DISPLAY",false);}o.bindDefaultODataModel.call(o,D.ID);r.setProperty("/InitRefObjectId",D.EVAL_REQ_ID);o._commentMixinInitCommentModel();});o.setViewProperty("/USER_IMAGE_ID",o.getOwnerComponent().getCurrentUserImageId());},createObjectModel:function(o){return new E(o,{actions:["update","del","executeStatusTransition","sendClarification","forward"],continuousUse:true,readSource:{model:this.getDefaultODataModel()}});},_commentMixinInitCommentModel:function(){this.byId("commentViewList").getController().commentMixinInit({commentInputId:"commentInputField",commentListId:"commentList",successMessageKey:"MSG_CREATE_SUCCESS_COMMENT",editDialogViewName:"sap.ino.vc.comment.EditCommentDialog"});},getODataEntitySet:function(){return"EvaluationRequestItem";},onOpenCreator:function(o){var s=o.getSource();var i=s.getBindingContext("object").getProperty("FROM_IDENTITY_ID");if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(s,i);},onRequestItemPress:function(){this.navigateTo("evaluationrequest-item",{id:this.getObjectModel().getKey()});},onIdeaPressed:function(){var i=this.getObjectModel().getProperty("/IDEA_ID");this.navigateTo("idea-display",{id:i},true);},onAccept:function(){this.onExecuteStatusTransition("sap.ino.config.EVAL_REQ_ACCEPT");},onReject:function(){this.onExecuteStatusTransition("sap.ino.config.EVAL_REQ_REJECT");},onForward:function(){var r=this.createRequestForwardDialog();var t=this;r.open();t.addForwardExpertInputHandling(this.byId("inputForwardExpert"),{suggestion:{key:"ID",text:"NAME",additionalText:"USER_NAME",path:"data>/SearchIdentity(searchToken='$suggestValue')/Results",filters:[new F({path:"ID",operator:c.NE,value1:C.getCurrentUser().USER_ID})],sorter:new S("NAME")},token:{key:"IDENTITY_ID",text:"NAME"}});},addForwardExpertInputHandling:function(o,s){if(!o){return;}var t=this;var h=t._createSuggestHandler(s.suggestion);o.attachSuggest(h,t);},onForwardClose:function(){this._oRequestForwardDialog.close();this.byId("inputForwardExpert").removeAllTokens();this.byId("txtAreaForwardReasonDes").setValue("");},onSubmitForward:function(){var t=this;var o=t.byId("inputForwardExpert").getTokens();var s=t.byId("inputForwardExpert").getValue();if(o.length>0&&!s){t.resetClientMessages();var i=parseInt(o[0].mProperties.key,10);var h=t.executeObjectAction("forward",{parameters:{EXPERT_ID:i,COMMENT_FORWARD:t.byId("txtAreaForwardReasonDes").getValue().trim()},messages:{success:"EVALUATIONREQUESTS_MSG_FORWARD_SUCCESS",error:"EVALUATIONREQUESTS_MSG_FORWARD_FAILURE"}});h.fail(function(r){if(r.MESSAGES.length>0){f.error(r.MESSAGES[0].MESSAGE_TEXT,{actions:[f.Action.OK],onClose:function(D){}});}});h.done(function(){t._oRequestForwardDialog.close();t.byId("inputForwardExpert").removeAllTokens();t.byId("txtAreaForwardReasonDes").setValue("");t.navigateTo("idea-display",{id:t.getObjectModel().oData.IDEA_ID},true);});h.always(function(){t._oRequestForwardDialog.setBusy(false);});}else{t.setClientMessage(new e({code:"EVALUATIONREQUESTS_MSG_FORWARD_NO_EXPERT",type:d.Error}),t.byId("inputForwardExpert"));}},onSubmitClarification:function(){var t=this;var s=t.byId("txtAreaClarificationReasonDes").getValue().trim();if(s){t.resetClientMessages();var o=t.executeObjectAction("sendClarification",{parameters:{TO_IDENTITY:t.getObjectModel().getProperty("/OWNER_ID"),CONTENT:s},messages:{success:"EVALUATIONREQUESTS_MSG_CLARIFICATION_SUCCESS",error:"EVALUATIONREQUESTS_MSG_CLARIFICATION_FAILURE"}});o.done(function(){t.byId("txtAreaClarificationReasonDes").setValue("");t._oRequestClarificationDialog.close();t.setViewProperty("/CLARIFICATION_DISPLAY",false);});o.always(function(){t._oRequestClarificationDialog.setBusy(false);});}else{t.setClientMessage(new e({code:"EVALUATIONREQUESTS_MSG_CLARIFICATION_NO_RESON",type:d.Error}),this.byId("txtAreaClarificationReasonDes"));t.byId("txtAreaClarificationReasonDes").setValue("");}},onCreateClarification:function(){var o=this.createClarificationDialog();o.open();},onClarificationClose:function(){this.byId("txtAreaClarificationReasonDes").setValue("");this._oRequestClarificationDialog.close();},onCreateEvaluation:function(){this.navigateTo("evaluation-create",{query:{ideaId:this.getObjectModel().getProperty("/IDEA_ID"),EvalReqItemId:this.getObjectModel().getKey()}});},onExecuteStatusTransition:function(s){var h=this;var m=h.getObjectModel();var A=m.executeStatusTransition({STATUS_ACTION_CODE:s});if(A){A.done(function(){M.show(h.getText("OBJECT_MSG_STATUS_CHANGE_SUCCESS"));});A.fail(function(o){if(o.MESSAGES&&o.MESSAGES.length>0){M.show(h.getText(o.MESSAGES[0].MESSAGE_TEXT));}});}},createRequestForwardDialog:function(){if(!this._oRequestForwardDialog){this._oRequestForwardDialog=this.createFragment("sap.ino.vc.evaluation.fragments.RequestForward",this.getView().getId());this.getView().addDependent(this._oRequestForwardDialog);}return this._oRequestForwardDialog;},createClarificationDialog:function(){if(!this._oRequestClarificationDialog){this._oRequestClarificationDialog=this.createFragment("sap.ino.vc.evaluation.fragments.RequestCreateClarification",this.getView().getId());this.getView().addDependent(this._oRequestClarificationDialog);}return this._oRequestClarificationDialog;},onEvaluationRequestOwnerPressed:function(o){o.preventDefault();var s=o.getSource();if(s){var i=s.getBindingContext("object")&&s.getBindingContext("object").getProperty("OWNER_ID");if(i!==undefined&&!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}if(this.oIdentityCardView&&this.oIdentityCardView.getController()){this.oIdentityCardView.getController().open(s,i);}}},createEvaluationFormatter:function(i,s){if(s==='sap.ino.config.EVAL_REQ_EXPIRED'||s==='sap.ino.config.EVAL_REQ_REJECTED'||s==='sap.ino.config.EVAL_REQ_COMPLETED'){return false;}return g.createEvaluationDynamicFormatter(i);}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.iam.mySetting.controller')){jQuery.sap.declare('sap.ino.vc.iam.mySetting.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.core.format.NumberFormat');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.ui.export.library');jQuery.sap.require('sap.ui.export.Spreadsheet');sap.ui.define("sap/ino/vc/iam/mySetting.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/vc/commons/mixins/MailMixin","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration","sap/ui/Device","sap/ino/commons/models/object/PersonalizeSetting","sap/m/MessageBox","sap/m/MessageToast","sap/ino/commons/models/object/Attachment","sap/ino/commons/models/core/CodeModel","sap/ino/vc/commons/mixins/UserGroupMixin","sap/ino/commons/formatters/BaseFormatter","sap/ui/core/format/NumberFormat","sap/ino/vc/iam/mixins/NotificationSettingMixin","sap/ino/vc/iam/mixins/FeedsSettingMixin","sap/ino/vc/iam/mixins/ProfileDataMixin","sap/ino/vc/iam/mixins/UserCommonMixin","sap/ino/controls/QuickViewGroupDimension","sap/ui/core/format/DateFormat",'sap/ui/export/library','sap/ui/export/Spreadsheet'],function(B,M,J,C,D,P,a,b,A,c,U,d,N,e,F,f,g,Q,h,j,S){"use strict";return B.extend("sap.ino.vc.iam.mySetting",jQuery.extend({},U,e,f,F,g,{formatter:jQuery.extend({helpMenuButton:function(s){return s.phone;},fullScreenToggle:function(s){return!s.desktop&&window.location.protocol==="https:";},displayTermsConditions:function(){return C.isComponentActive("sap.ino.config.DISPLAY_TERMS_CONDITIONS");},termsConditions:function(s){if(s===null||s===undefined){return undefined;}var m=this.getView().getModel("module");return m.getProperty(s);},version:function(){return this._i18n.getResourceBundle().getText("ABOUT_VERSION_FLD",[this._oComponent.getVersion(),this._oComponent.getVersionTimestamp()]);},text:function(t){return this._i18n.getResourceBundle().getText(t);},icon:function(i){if(jQuery.isNumeric(i)){i=C.getAttachmentTitleImageDownloadURL(i);}else if(i){i="/"+i;}else{i="sap-icon://error";}return i;},visibleWithSearch:function(s,p,l){return(p!==undefined&&!p)||!s||(l!==undefined&&!l);},visibleAppTitle:function(p,t){if(t.length===0||t.match(/^\s+$/g)){var i=true;}return(p!==undefined&&!p)&&(i===undefined||!i);},generateMailURL:function(m){return sap.m.URLHelper.normalizeEmail(m);},notificationTooltip:function(n){if(n){var o=N.getIntegerInstance({style:"short"});var i=o.format(n);if(i===0){return this._i18n.getResourceBundle().getText("SHELL_EXP_NOTIFICATION_EMPTY");}else if(i===1){return this._i18n.getResourceBundle().getText("SHELL_EXP_NOTIFICATION_SINGLE");}else{return this._i18n.getResourceBundle().getText("SHELL_EXP_NOTIFICATION_COUNT",[o.format(n)]);}}return this._i18n.getResourceBundle().getText("SHELL_EXP_NOTIFICATION_EMPTY");},notificationText:function(t){return t.split("{").join("").split("}").join("");},clipboardObjectName:function(s){return s?this._i18n.getResourceBundle().getText("CLIPBOARD_OBJECT_NAME_"+s):"";},navigationItemSelected:function(r,n){if(!r||!n){return false;}if(r===n||r===n+"variant"||r+"list"===n){return true;}var i=jQuery.grep(this.menu.Navigation,function(t){return r===t.TO||r===t.TO+"variant"||r+"list"===t.TO;});if(i.length===0&&r.indexOf("-")>-1){var R=r.split("-");if(R[1]===n||R[1]===n+"variant"){return true;}var s=jQuery.grep(this.menu.Navigation,function(t){return R[1]===t.TO||R[1]===t.TO+"variant";});if(s.length===0&&r.split("-")[0]+'list'===n){return true;}}return false;},navigationItemVisible:function(i,k,m,p,n){var v=(!p||(p&&m))&&(k||(!k&&i));if(n==="evalreqlist"){return v&&C.getSystemSetting("sap.ino.config.EVAL_REQ_ACTIVE")==="1";}if(n==="rewardlist"){return v&&(this.getModel("user").getProperty("/privileges/sap.ino.ui::campaign_manager")||this.getModel("user").getProperty("/privileges/sap.ino.xs.rest.admin.application::execute"))&&C.getSystemSetting("sap.ino.config.REWARD_ACTIVE")==="1";}if(n!=="expertfinder"){return v;}else{return v&&(this.getView().getModel("config").oData["sap.ino.config.EXPERT_FINDER_ACTIVE"]==="1");}},historyEnable:function(i){return Number(i)>=1;},historyTooltip:function(H,i){if(H.length){return this.getText("PAGE_TIT_"+(!H[0].title?"HOME":H[0].title.toUpperCase()));}else{return"";}},historyMenu:function(t){return this.getText("PAGE_TIT_"+(!t?"HOME":t.toUpperCase()));},formatChangeLogValue:function(s,i,k){if(k){return d.toDate(k);}else if(i){return i;}else if(s){return s;}else{return"";}},formatIdentityCode:function(s){return c.getFormatter("sap.ino.xs.object.iam.IdentityLogSetting.Root")(s);}},B.prototype.formatter),requestQueue:[],onInit:function(){B.prototype.onInit.apply(this,arguments);this.setViewProperty("/EDIT",true);this.setViewProperty("/ATTACHMENT_UPLOAD_URL",A.getEndpointURL());this.aBusyControls=[this.byId("userSettings")];var s=C.getSystemSettingsModel();this.isEnableNewNotification=s.getProperty("/sap.ino.config.ENABLE_NEW_NOTIFICATION")==="0"?false:true;this.setViewProperty("/ENABLE_NEW_NOTIFICATION",this.isEnableNewNotification);this.enableFeedEmail=s.getProperty("/sap.ino.config.SWITCH_OFF_FEED_EMAIL")==="0"?true:false;this.setViewProperty("/ENABLE_FEED_EMAIL",this.enableFeedEmail);},onBeforeRendering:function(){this.getProfileData();this.getPersonalizeSetting();if(this.isEnableNewNotification){this.getNewNotificationSetting();}else{this.getNotificationSetting();}this.getNewFeedsSetting();this.bindIdentityLog();this.getMemberGroup();this.bindUserGroup();this.getProfileDataSetting();},onAfterRendering:function(){},getPersonalizeSetting:function(){var s=this;var i=P.defaultPesonalize;P.getSettings().done(function(k){var l=$.extend(i,k.RESULT||{});s.getView().setModel(new J(l),'PERSONALIZE');C.setPersonalize(l);});},personalizeSave:function(){var s=this;var p=s.getView().getModel('PERSONALIZE');var i=p.getData();P.updateSettings({personalize:i}).done(function(){b.show(s.getText("PERSONALIZE_CHANGE_SUCCESS"));s.getView().setModel(new J(i),'PERSONALIZE');});},onSettingTabSelect:function(E){var s=E.getSource();var o=s.getSelectedKey();if(o.indexOf('mySettingIdentityCardPage')>-1){this.getProfileData();}},getProfileData:function(){var s=this;var i=C.getCurrentUser().USER_ID;s._oIdentityModel=new J();if(C.getUserProfileByTextURL(i)){s._oIdentityModel.loadData(C.getUserProfileByTextURL(i),{"USER_ID":i},true,"GET");s._oIdentityModel.attachRequestCompleted(null,function(){var k=s._oIdentityModel.getData();var l=s.byId("identityLogList");k.open_group=C.getSystemSetting('sap.ino.config.OPEN_GROUP_FOR_COMMUNITY_USER')*1;k.ENABLE_GAMIFICATION=s.getView().getModel("config").getProperty("/ENABLE_GAMIFICATION")===1?true:false;s._oIdentityModel.setData(k);s.getView().setModel(s._oIdentityModel,"identityData");if(k.ENABLE_GAMIFICATION){s.constructGamificationDimension(s._oIdentityModel,s.byId('mySettingIdentityCardPage'));}if(l){l.bindItems({path:"data>/"+this.getIdentityEntityName()+"("+i+")/IdentityLog",sorter:new sap.ui.model.Sorter("CHANGED_AT",true),template:this.getFragment("sap.ino.vc.iam.fragments.IdentityLogTemplate")});}},s);}},exportProfileData:function(){var E=j.EdmType;var i=[];var r,s,o,k;var l=this;var I=C.getCurrentUser().USER_ID;l._oIdentityModel=new J();if(C.getUserProfileByTextURL(I)){l._oIdentityModel.loadData(C.getUserProfileByTextURL(I),{"USER_ID":I},true,"GET");l._oIdentityModel.attachRequestCompleted(null,function(){var m=l._oIdentityModel.getData();i=[{label:l.getText("USER_DETAILS_FIRST_NAME"),property:'Firstname',type:E.String},{label:l.getText("SORT_MIT_LAST_NAME"),property:'Lastname',type:E.String},{label:l.getText("IDEA_LIST_REWARD_LIST_GAMIFICATION_FLD_FULL_NAME"),property:'Fullname',type:E.String},{label:l.getText("IDEA_LIST_REWARD_LIST_GAMIFICATION_FLD_USER_NAME"),property:'Username',type:E.String},{label:l.getText("SORT_MIT_VALID_TO"),property:'Validationto',type:E.String},{label:l.getText("USER_DETAILS_PHONE"),property:'Phone',type:E.String},{label:l.getText("USER_DETAILS_EMAIL"),property:'Email',type:E.String},{label:l.getText("USER_DETAILS_MOBILE"),property:'Mobile',type:E.String},{label:l.getText("USER_DETAILS_COST_CENTER"),property:'Costcenter',type:E.String},{label:l.getText("USER_DETAILS_COMPANY"),property:'Company',type:E.String},{label:l.getText("USER_DETAILS_OFFICE"),property:'Office',type:E.String},{label:l.getText("USER_DETAILS_ORGANIZATION"),property:'Organization',type:E.String},{label:l.getText("USER_DETAILS_COUNTRY"),property:'Country',type:E.String},{label:l.getText("USER_DETAILS_ZIP_CODE"),property:'Zipcode',type:E.String},{label:l.getText("USER_DETAILS_CITY"),property:'City',type:E.String},{label:l.getText("USER_DETAILS_STREET"),property:'Street',type:E.String}];r=[{Lastname:m.LAST_NAME,Firstname:m.FIRST_NAME,Username:m.USER_NAME,Fullname:m.NAME,Costcenter:m.CORP_INFO.COST_CENTER,Mobile:m.CONTACT_DETAIL.MOBILE,Email:m.CONTACT_DETAIL.EMAIL,Validationto:m.VALIDATION_TO,Phone:m.CONTACT_DETAIL.PHONE,Office:m.CORP_INFO.OFFICE,Company:m.CORP_INFO.COMPANY,Organization:m.ORGANIZATION,Street:m.ADDR_INFO.STREET,City:m.ADDR_INFO.CITY,Country:m.ADDR_INFO.COUNTRY,Zipcode:m.ADDR_INFO.ZIP_CODE}];var n=h.getDateTimeInstance({pattern:"dd-MM-yyyy_HH-mm"});k=l.getText('USER_DETAILS_MY_PERSONAL_DATA')+n.format(new Date())+".xlsx";s={workbook:{columns:i},dataSource:r,fileName:k};o=new S(s);o.build().finally(function(){o.destroy();});},l);}},bindIdentityLog:function(){var i=C.getCurrentUser().USER_ID;if(this.byId("changeHistoryLog")){this.byId("changeHistoryLog").bindItems({path:"data>/"+this.getIdentityEntityName()+"("+i+")/IdentityLog/Results"});}},getMemberGroup:function(){var s=this;var o=C.getSystemSetting('sap.ino.config.OPEN_GROUP_FOR_COMMUNITY_USER')*1;s.setModel(new J(o),'identityData>/open_group');if(o){if(!this.requestQueue.length){this.requestQueue.push(this.getMemberGroups());this.requestQueue[0].done(function(i){s.setModel(new J(i),'identityData>/groups');});}}this.getMemberGroups().done(function(i){s.setModel(new J(i),'identityData>/groups');});},bindUserGroup:function(){var s=this;var v=this.getView();var i=v.byId('mySettingUserGroup--userGroupTable');var k=this._bindUserGroupModel();i.getBinding('rows').filter([]);k.attachRequestCompleted(function(){s.reBindSelectedData(i);});},saveUserGroup:function(){var s=this;var v=this.getView();var i=v.byId('mySettingUserGroup--userGroupTable');this.putGroupSelected(i).done(function(){var t=s.getView().byId('mySettingUserGroup--userGroupTable');var k=t.getModel('USER_GROUPS').getData();var l=k.SELECTED_NONE||false;if(t.getSelectedIndices().length===0&&!l){b.show(s.getText('USER_GROUP_UNSELECT_SUCCESS'));}else{b.show(s.getText('USER_GROUP_SELECT_SUCCESS'));}});},getIdentityEntityName:function(){return"Identity";},constructGamificationDimension:function(m,I){var q,s,k,E,l,p,n;if(!I){return;}q=I.getContent()[0];var o=m.getData().GAMIFICATION_INFO;q.removeAllDimensionGroups();if(!Array.isArray(o)){return;}for(var i=0;i<o.length;i++){k="";E="";l=0;p=0;s="";n=0;if(JSON.stringify(o[i].BADGE)!=="{}"){k=o[i].BADGE.currentBadge.NAME;E=!o[i].BADGE.nextBadge.NAME?"":o[i].BADGE.nextBadge.NAME;if(o[i].BADGE.nextBadge.NAME&&o[i].BADGE.currentBadge.NAME){l=o[i].BADGE.nextBadge.BADGE_VALUE-o[i].BADGE.currentBadge.BADGE_VALUE;}if(o[i].BADGE.nextBadge.NAME&&!o[i].BADGE.currentBadge.NAME){l=o[i].BADGE.nextBadge.BADGE_VALUE;}if(!o[i].BADGE.nextBadge.NAME&&o[i].BADGE.currentBadge.NAME){l=o[i].BADGE.currentBadge.BADGE_VALUE;}p=o[i].BADGE.nextBadge.NAME?o[i].BADGE.nextBadge.BADGE_VALUE-parseInt(o[i].TOTAL,10):0;if(JSON.stringify(o[i].BADGE.currentBadge)!=="{}"&&o[i].BADGE.currentBadge.Attachment.length>0){s=C.getAttachmentTitleImageDownloadURL(o[i].BADGE.currentBadge.Attachment[0].ATTACHMENT_ID);}if(JSON.stringify(o[i].BADGE.currentBadge)!=="{}"){var r=parseInt(o[i].TOTAL,10)-o[i].BADGE.currentBadge.BADGE_VALUE;n=r>0?r:parseInt(o[i].TOTAL,10);}else{n=parseInt(o[i].TOTAL,10);}}q.addDimensionGroup(new Q({heading:o[i].NAME,headingIcon:s,totalPoints:parseInt(o[i].TOTAL,10),pointsToNextLevel:p,startLevel:k,nextLevel:E,currentPointsBWBadge:n,diffPointsToNextLevel:l,dimensionUnit:o[i].UNIT,redeemPoints:o[i].TOTAL_FOR_REDEEM,redeemEnabled:!!o[i].REDEEM}));}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.DecisionQuickView.controller')){jQuery.sap.declare('sap.ino.vc.idea.DecisionQuickView.controller');sap.ui.define("sap/ino/vc/idea/DecisionQuickView.controller",["sap/ino/vc/commons/BaseObjectController"],function(B){"use strict";return B.extend("sap.ino.vc.idea.DecisionQuickView",jQuery.extend({},{open:function(c,i){var t=this;var v=this.getView();var d=v.byId("decisionCard");v.bindElement({path:"data>/IdeaDecision("+i+")",events:{change:function(e){jQuery.sap.delayedCall(0,t,function(){d.openBy(c);});}}});}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.Integration.controller')){jQuery.sap.declare('sap.ino.vc.idea.Integration.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.DialogType');jQuery.sap.require('sap.ui.core.ValueState');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.FlexBox');jQuery.sap.require('sap.m.Link');sap.ui.define("sap/ino/vc/idea/Integration.controller",["sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/vc/commons/BaseObjectController","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/Dialog","sap/m/DialogType","sap/ui/core/ValueState","sap/m/Button","sap/m/ButtonType","sap/m/Text","sap/ino/commons/models/object/IdeaObjectIntegration","sap/m/MessageBox","sap/m/FlexBox","sap/m/Link","sap/ino/commons/application/Configuration"],function(A,B,J,M,D,a,V,b,c,T,I,d,F,L,C){"use strict";return B.extend("sap.ino.vc.idea.Integration",{onInit:function(){B.prototype.onInit.apply(this,arguments);var i=new J();this._initHandleIdeaObjectIntegrationAOChange();this.getView().setModel(i,"integration");this._oRouter=this.getOwnerComponent().getRouter();this._oRouter.attachRouteMatched(this._getIntegrationObjectList,this);},visibleLink:function(f){if(f&&f.indexOf('URL')>-1){return true;}else{return false;}},visibleText:function(f){if(f&&f.indexOf('URL')>-1){return false;}else{return true;}},visibleField:function(f){if(f){return true;}else{return false;}},onAfterRendering:function(){var i=this.getModel("integration");var t=this;var o=this.getObjectModel();var r=this.getOwnerComponent().getRouter().getContext();if(o&&o.getProperty("/ID")&&r.indexOf("sectionIntegration")>-1){this.getView().setBusy(true);I.getIdeaIntegrationList({IDEA_ID:o.getProperty("/ID"),CAMPAIGN_ID:o.getProperty("/CAMPAIGN_ID")}).done(function(e){i.setData(e.RESULT);t.getView().setBusy(false);});}},_getIntegrationObjectList:function(){var i=this.getModel("integration");var t=this;var r=this.getOwnerComponent().getRouter().getContext();if(this.getCurrentRoute()==="idea-display"&&r.indexOf("sectionIntegration")>-1){var o=this.getObjectModel();if(o&&o.getProperty("/ID")){this.getView().setBusy(true);I.getIdeaIntegrationList({IDEA_ID:o.getProperty("/ID"),CAMPAIGN_ID:o.getProperty("/CAMPAIGN_ID")}).done(function(e){i.setData(e.RESULT);t.getView().setBusy(false);});}}},visibleRefresh:function(v){return v;},enableRemove:function(e){return true;},formatDate:function(v,f){if(f&&(f.indexOf('CREATED_AT')>-1||f.indexOf('LAST_REFRESHED_AT')>-1||f.indexOf('DATE')>-1)){var u=new Date(v);var m=u.getTimezoneOffset();var o=u.getTime()+(-m*60*1000);var e=new Date(o);if(!e.getTime()){return v;}else{var g=sap.ui.core.format.DateFormat.getDateInstance({pattern:"MMM d, yyyy HH:mm:ss"});return g.format(e);}}else{return v;}},enableLink:function(l){if(!l){return false;}l=l.trim();if(!l||l===""){return false;}if(l&&l.indexOf("http://")!==0&&l.indexOf("https://")!==0&&l.indexOf("mailto:")!==0){l="http://"+l;}return jQuery.sap.validateUrl(l);},onPressRefresh:function(e){var s=e.getSource();s.setBusy(true);var t=this;var o=s.getBinding("enabled");var p=o.getContext().sPath;var i=this.getModel("integration");var f=this.getObjectModel();var r={IDEA_ID:f.getProperty("/ID"),CAMPAIGN_ID:f.getProperty("/CAMPAIGN_ID"),API_TECH_NAME:i.getProperty(p+"/API_TECHNICAL_NAME"),INTEGRATION_OBJECT_UUID:i.getProperty(p+"/INTEGRATION_OBJECT_UUID")};var P=I.queryObject(r);P.done(function(g){s.setBusy(false);var h=g.RESULT.status.toString().includes('20')?'Your request to refresh the integration object has been sent successfully.':'Your request to refresh the integration object has been failed.';var S=h+'The request ID is '+(g.RESULT.generatedId?g.RESULT.generatedId[-1]:'')+' and message status is: '+(g.RESULT.status?g.RESULT.status:'')+'.';var j=new T({text:S});var l=new L({href:C.getBackendRootURL()+'/sap/ino/config#integrationMonitorList',text:'For more detail, please navigate to Innovation Office->Monitor->Integration',target:'_blank'});if(!this.oSuccessMessageDialog){this.oSuccessMessageDialog=new D({type:a.Message,title:g.RESULT.status.toString().includes('20')?V.Success:V.Error,state:g.RESULT.status.toString().includes('20')?V.Success:V.Error,content:new F({items:[j,l],alignItems:"Start",justifyContent:"Start",alignContent:"Start"}),beginButton:new b({type:c.Emphasized,text:"OK",press:function(){this.oSuccessMessageDialog.close();}.bind(this)})});}this.oSuccessMessageDialog.open();});P.fail(function(m){s.setBusy(false);if(m.MESSAGES.length>0){M.show(m.MESSAGES[0].MESSAGE_TEXT);}else{M.show(t.getText("IDEA_OBJECT_INTEGRATION_REFRESH_FAIL"));}});},onPressRemove:function(e){var s=e.getSource();var t=this;var o=s.getBinding("enabled");var p=o.getContext().sPath;var i=this.getModel("integration");var O=i.getProperty(p+"/INTEGRATION_OBJECT_UUID");d.confirm(t.getText("IDEA_OBJECT_INTEGRATION_MSG_CONFIRM_REMOVE"),{title:t.getText("IDEA_OBJECT_INTEGRATION_REMOVE_POP_TITLE"),icon:d.Icon.WARNING,actions:[d.Action.OK,d.Action.CANCEL],onClose:function(f){if(f===d.Action.OK){I.removeObject({INTEGRATION_OBJECT_UUID:O}).done(function(){M.show(t.getText("IDEA_OBJECT_INTEGRATION_REMOVE_SUCCESS"));}).fail(function(){M.show(t.getText("IDEA_OBJECT_INTEGRATION_REMOVE_FAIL"));});}}});},_initHandleIdeaObjectIntegrationAOChange:function(){var t=this;var f=function(e){var s=e&&e.getParameter("actionName");var o=e.getParameter("changeRequest");if(e.getParameter("object").getMetadata().getName()==="sap.ino.commons.models.object.IdeaObjectIntegration"){if(s&&["createObject","queryObject","removeObject","linkExistedObject"].indexOf(s)>-1){var i=t.getObjectModel();var g=t.getModel("integration");I.getIdeaIntegrationList({IDEA_ID:i.getProperty("/ID"),CAMPAIGN_ID:i.getProperty("/CAMPAIGN_ID")}).done(function(r){g.setData(r.RESULT);});}}};A.attachChange(A.Action.Action,f);},rebindList:function(l){if(l){var o=l.getBindingInfo("items");l.bindItems(o);}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.Modify.controller')){jQuery.sap.declare('sap.ino.vc.idea.Modify.controller');jQuery.sap.require('sap.m.Token');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.ui.core.HTML');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.ComboBox');jQuery.sap.require('sap.ui.model.type.String');jQuery.sap.require('sap.ui.model.odata.type.Date');sap.ui.define("sap/ino/vc/idea/Modify.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ino/commons/models/object/Idea","sap/ino/commons/models/object/Attachment","sap/ino/commons/application/WebAnalytics","sap/m/Token","sap/m/MessageToast","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/ui/core/ListItem","sap/ui/core/HTML","sap/ino/commons/application/Configuration","sap/ino/controls/MobileTextEditor","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/model/json/JSONModel","sap/ui/core/MessageType","sap/ui/core/message/Message","sap/ui/core/ResizeHandler","sap/ui/Device","sap/m/MessageBox","sap/m/Label","sap/m/CheckBox","sap/m/Input","sap/m/ComboBox","sap/ino/commons/models/core/CodeModel","sap/ui/model/type/String","sap/ino/commons/models/types/IntegerType","sap/ino/commons/models/types/FloatType","sap/ui/model/odata/type/Date","sap/ino/commons/models/types/IntegerNullableType","sap/ino/commons/models/types/FloatNullableType","sap/ino/commons/models/types/IntNullableBooleanType","sap/ino/vc/commons/mixins/SimilarIdeasMixin","sap/ino/vc/commons/mixins/RichTextInitMixin"],function(B,I,A,W,T,M,F,a,S,L,H,C,b,d,J,f,g,R,D,h,k,l,m,n,o,p,q,r,s,t,u,v,w,x){"use strict";var y={BOOLEAN:"BOOL_VALUE",TEXT:"TEXT_VALUE",INTEGER:"NUM_VALUE",NUMERIC:"NUM_VALUE",RICHTEXT:"RICH_TEXT_VALUE",DATE:"DATE_VALUE"};return B.extend("sap.ino.vc.idea.Modify",jQuery.extend({},d,w,x,{routes:["idea-edit","idea-create"],preCheck:true,onInit:function(){B.prototype.onInit.apply(this,arguments);this._dViewShown=jQuery.Deferred();this.setViewProperty("/EDIT",true);this.setViewProperty("/ATTACHMENT_UPLOAD_URL",A.getEndpointURL());this.addMultiInputHandling(this.byId("Contributors"),{childNodeName:"Contributors",childNodeNameSingular:"Contributor",suggestion:{key:"ID",text:"NAME",additionalText:"USER_NAME",path:"data>/SearchIdentity(searchToken='$suggestValue')/Results",filters:[new F({path:"TYPE_CODE",operator:a.EQ,value1:"USER"})],sorter:new S("NAME")},token:{key:"IDENTITY_ID",text:"NAME",editable:"{=!${object>/CONTRIBUTION_READ_ONLY}}"}});this.addMultiInputHandling(this.byId("Tags"),{childNodeName:"Tags",childNodeNameSingular:"Tag",suggestion:{key:"NAME",text:"NAME",path:"data>/SearchTagsParams(searchToken='$suggestValue')/Results",filter:[],sorter:[]},token:{key:"NAME",text:"NAME"}});},onRouteMatched:function(e){var c=this.byId("campaignComboBox");c.setValue(undefined);var i=e.getParameters().name;var j=this;B.prototype.onRouteMatched.apply(this,arguments);var z=this.getObjectModel();z.getDataInitializedPromise().done(function(K){j.bindCampaignList(K,z.isNew());j.bindAnonymousList(K,z.isNew());z.setProperty("/OLD_RESP_NAME",z.getProperty("/RESP_VALUE_NAME"));j._oldCampaignId=z.getProperty("/CAMPAIGN_ID");j._oldCampaignForm=z.getProperty("/CAMPAIGN_FORM_CODE");var N=j.byId("ideaFormAddFields");if(i==="idea-edit"){j.setRespListProperty.call(j,z,z.oData.RESP_NAME);if(N.getItems()[0]){N.removeAllItems();}if(z.oData.CAMPAIGN_ID){j.getModel("data").read("/CampaignSmall("+z.oData.CAMPAIGN_ID+")/FormFields",{urlParameters:{"$orderby":"SEQUENCE_NO"},success:function(O){var P=O.results;var Q=z.oData.FieldsValue;if(P&&Q&&Q.length>0&&P.length>0&&P[0].FORM_CODE===Q[0].FORM_CODE){var U=j.cacluateNewFieldsAdded(P,Q);z.setProperty("/NEW_ADDED_FIELDS",U);}j.addFormFields.call(j,z.oData.FieldsValue,N,z);},error:function(O){M.show(O.message);}});}j.syncAuthorToContributionShare();}else{j.setRespListProperty.call(j,z,z.oData.RESP_VALUE_CODE);if(N.getItems()[0]){N.removeAllItems();}if(z.oData.CAMPAIGN_ID){j.getModel("data").read("/CampaignSmall("+z.oData.CAMPAIGN_ID+")/FormFields",{urlParameters:{"$orderby":"SEQUENCE_NO"},success:function(O){var P=O.results;j.addFormFields.call(j,P,N,z);},error:function(O){M.show(O.message);}});}}});jQuery.when(z.getPropertyModelInitializedPromise(),this._dViewShown).done(function(P){j.initRTE(P);j.initIdeaDetails();if(j.getObjectModel().isNew()&&!j.getObjectExists()){j.setObjectExists(true);}if(!j.getObjectModel().getPropertyModel().getProperty("/actions/modify/enabled")&&!j.getObjectModel().getPropertyModel().getProperty("/actions/del/enabled")){j.setObjectExists(false);}});var E=C.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE");var G=C.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE_HIDE_PHASE_BAR");this.setViewProperty('/ENABLE_IDEA_IMAGE',!(E*1)&&!(G*1));this.setHelp("IDEA_MODIFY");this.showSection("sectionDetails");this.byId("RespList").onAfterRendering=function(){sap.m.Input.prototype.onAfterRendering.apply(this);j.byId("NAME").focus();};},cacluateNewFieldsAdded:function(c,e){var N=[];var j=function(E,G){return E.filter(function(V){return V.CODE===G;});};for(var i=0;i<c.length;i++){var z=j(e,c[i].CODE);if(z.length===0&&c[i].IS_ACTIVE){N.push(c[i]);}}return N;},onDelete:function(e){var c=this;var i=e.getSource();var O=c.getObjectModel();var j=C.getSystemSettingsModel().getProperty("/sap.ino.config.PPM_INTEGRATION_ACTIVE");var z=O.getProperty("/INTEGRATION_OBJECT_EXIST");var E=O.getPropertyModel().getProperty("/actions/del/customProperties/hasReward");var G=O.getPropertyModel().getProperty("/actions/del/enabled");var K=O.getPropertyModel().getProperty("/actions/del/customProperties/isMergeedWithVote");if(E){M.show(this.getText("MSG_IDEA_HAVE_REWARD_CANNOT_DELETE"));}else if(!G){M.show(this.getText("OBJECT_MSG_DELETE_FAILED"));}else if(K){M.show(this.getText("MSG_IDEA_MERGED_WITH_VOTE_CANNOT_DELETE"));}else{var N=O.getProperty("/EVALUATION_COUNT");var P=O.getPropertyModel().getProperty("/actions/del/customProperties/isManager");if(!N||(N&&P)){var Q="MSG_DEL_CONFIRM";if(j==="1"||z){Q="MSG_IDEA_CAMP_MANAGER_DEL_CONFIRM_HAVE_PPM_INTEGRATION";}var U=c.executeObjectAction("del",{messages:{confirm:Q,success:"MSG_DEL_SUCCESS"}});U.done(function(V){if(V&&V.confirmationCancelled===true){if(i&&jQuery.type(i.focus)==="function"){i.focus();}return;}c.navigateTo("idealist");});}else{M.show(this.getText("MSG_IDEA_DEL_FAILED_SUBMITTER_HAVE_EVALUATION"));}}},onCampaignSelectionChange:function(){var c=this;var i=this.getObjectModel();var e=this.byId("ideaFormAddFields");this.resetClientMessages();if(e.getItems()[0]){e.removeAllItems();if(i._isNew){i.oData.FieldsValue=[];}}i.setProperty("/RESP_VALUE_CODE","");i.setProperty("/RESP_VALUE_NAME","");i.setProperty("/RESP_VALUE_DESCRIPTION","");var j=this.byId("campaignComboBox");var z=j.getSelectedKey();if(z>0&&j){var E=j.getItemByKey(z).getProperty("text");j.setValue(E);}if(!i._isNew){this.onFormChanged.call(this,i,z,e,j);}else{if(z){this.getModel("data").read("/CampaignSmall("+z+")/FormFields",{urlParameters:{"$orderby":"SEQUENCE_NO"},success:function(K){var N=K.results;c.addFormFields.call(c,N,e,i);},error:function(K){M.show(K.message);}});}}var G=this.getModel("data");G.attachRequestCompleted(G,c.syncAuthorToContributionShareBinding,c);this.bindSimilarIdeas();this.bindAnonymousList(G,i.isNew(),z);},addFormFields:function(c,e,i,j){var z=this;if(z.aCheckBoxes){z.aCheckBoxes=[];}if(z.aComboBoxes){z.aComboBoxes=[];}var G=function(Q){var U;switch(Q.DATATYPE_CODE){case"BOOLEAN":U=!Q.VALUE_OPTION_LIST_CODE?new v(null):new sap.ino.commons.models.types.IntegerType();break;case"INTEGER":if(Q.MANDATORY){U=new q(null,{minimum:(Q.NUM_VALUE_MIN||undefined),maximum:(Q.NUM_VALUE_MAX||undefined)});}else{U=new t(null,{minimum:(Q.NUM_VALUE_MIN||undefined),maximum:(Q.NUM_VALUE_MAX||undefined)});}break;case"NUMERIC":if(Q.MANDATORY){U=new r({groupingEnabled:false},{minimum:(Q.NUM_VALUE_MIN||undefined),maximum:(Q.NUM_VALUE_MAX||undefined)});}else{U=new u({groupingEnabled:false},{minimum:(Q.NUM_VALUE_MIN||undefined),maximum:(Q.NUM_VALUE_MAX||undefined)});}break;case"TEXT":U=new p(null,{minLength:(Q.MANDATORY?1:undefined)});break;case"RICHTEXT":U=new p(null,{minLength:(Q.MANDATORY?1:undefined)});break;case"DATE":U=new s(null,{nullable:(Q.MANDATORY?false:true)});break;default:break;}return U;};var E=function(Q){var V=Q.getParameters().value;var U=Q.getSource();var X=U.getItemByText(V);if(X===null){var Y=new g({code:"IDEA_FORM_MSG_DROPDOWN_LIST",type:f.Error});this.oIdeaFormMessage=Y;z.setClientMessage(Y,this);}else{z.resetClientMessages();}};var K=function(Q){var U=Q.getSource();var V=U.getValue();var X=U.getItemByText(V);if(V&&!X){z.setClientMessage(new g({code:"IDEA_FORM_MSG_DROPDOWN_LIST",type:f.Error}),this);}else{z.resetClientMessages();}};var N=function(Q){if(!this.getSelected()){this.setValueState('Error');z.setClientMessage(new g({code:"IDEA_OBJECT_MSG_CHECK_BOX_UNTICK",type:f.Error}),this);}else{z.resetClientMessages(Q.getParameter('id'));this.setValueState('None');}};var O=i.getPropertyModel().getProperty("/nodes/Root/attributes/CAMPAIGN_ID/changeable");var P=i.getProperty("/NEW_ADDED_FIELDS");if(P&&P.length>0){c=c.concat(P);c.sort(function(Q,U){if(Q.SEQUENCE_NO<U.SEQUENCE_NO){return-1;}else{return 1;}});i.setProperty("/FieldsValue/",c);}jQuery.each(c,function(Q,U){if(!U.IS_ACTIVE){return true;}if(i._isNew||j===h.Action.OK||!U.ID){var V=jQuery.extend({ID:i.getNextHandle(),FIELD_CODE:U.CODE},U);i.setProperty("/FieldsValue/"+Q,V);}if(U.IS_DISPLAY_ONLY){var X=new H({sanitizeContent:true,preferDOM:false,content:{model:"object",path:"/FieldsValue/"+Q+"/DISPLAY_TEXT",formatter:z.formatter.wrapHTML}});e.addItem(X);return true;}var Y;if(U.UOM_CODE){Y=U.DEFAULT_TEXT+"("+o.getText("sap.ino.xs.object.basis.Unit.Root",U.UOM_CODE)+")";}else{Y=U.DEFAULT_TEXT;}var Z=false;if(U.MANDATORY===1){Z=true;}var _;_=y[U.DATATYPE_CODE];if(U.VALUE_OPTION_LIST_CODE){var a1=new k({text:Y,tooltip:U.DEFAULT_LONG_TEXT,required:Z});if(U.IS_HIDDEN_SETTING&&U.IS_HIDDEN_SETTING===1){a1.setTooltip(z.getText("IDEA_EDIT_FORM_HIDDEN_TOOLTIP"));}else if(U.IS_HIDDEN_SETTING===undefined&&U.IS_HIDDEN===1){a1.setTooltip(z.getText("IDEA_EDIT_FORM_HIDDEN_TOOLTIP"));}a1.addStyleClass("sapInoIdeaFormLabelStyle");e.addItem(a1);var b1="sap.ino.xs.object.basis.ValueOptionList.Root_"+U.VALUE_OPTION_LIST_CODE;if(V){V.valueOptionList=o.getCodes(b1,function(n1){return n1.ACTIVE===1;});}else{U.valueOptionList=o.getCodes(b1,function(n1){return n1.ACTIVE===1;});}var c1="object>/FieldsValue/"+Q+"/"+_;var d1={path:c1,type:G(U)};var e1=new n({enabled:O,tooltip:U.DEFAULT_LONG_TEXT,selectedKey:d1,width:"100%",change:U.MANDATORY?E:K});e1.addItem();var f1="{object>"+_+"}";var g1=new L({key:f1,text:"{object>DEFAULT_TEXT}"});var h1="object>/FieldsValue/"+Q+"/valueOptionList";e1.bindItems({path:h1,template:g1,sorter:new S("SEQUENCE_NO")});if(!z.aComboBoxes){z.aComboBoxes=[];}z.aComboBoxes.push(e1);e.addItem(e1);}else{if(U.DATATYPE_CODE==="BOOLEAN"){if(!z.aCheckBoxes){z.aCheckBoxes=[];}var i1=new l({text:U.DEFAULT_TEXT,enabled:O,tooltip:U.DEFAULT_LONG_TEXT,selected:"{object>/FieldsValue/"+Q+"/BOOL_VALUE}",select:Z?N:function(){}});if(U.IS_HIDDEN_SETTING&&U.IS_HIDDEN_SETTING===1){i1.setTooltip(z.getText("IDEA_EDIT_FORM_HIDDEN_TOOLTIP"));}else if(U.IS_HIDDEN_SETTING===undefined&&U.IS_HIDDEN===1){i1.setTooltip(z.getText("IDEA_EDIT_FORM_HIDDEN_TOOLTIP"));}var j1=i1._getLabel();if(Z){j1.addStyleClass("sapMLabelRequired");z.aCheckBoxes.push(i1);}j1.addStyleClass("sapInoIdeaFormLabelStyle");e.addItem(i1);}else{var k1;var l1=new k({text:Y,tooltip:U.DEFAULT_LONG_TEXT,required:Z});if(U.IS_HIDDEN_SETTING&&U.IS_HIDDEN_SETTING===1){l1.setTooltip(z.getText("IDEA_EDIT_FORM_HIDDEN_TOOLTIP"));}else if(U.IS_HIDDEN_SETTING===undefined&&U.IS_HIDDEN===1){l1.setTooltip(z.getText("IDEA_EDIT_FORM_HIDDEN_TOOLTIP"));}l1.addStyleClass("sapInoIdeaFormLabelStyle");e.addItem(l1);var m1={path:"object>/FieldsValue/"+Q+"/"+_,type:G(U)};if(U.DATATYPE_CODE==="RICHTEXT"){k1=sap.ui.xmlfragment({id:z.getView().getId(),fragmentName:"sap.ino.vc.idea.fragments.IdeaRichTxt"},z);k1.attachReady(function(){this.bindProperty("value",{path:m1.path,type:G(U)});});}else if(U.DATATYPE_CODE==="DATE"){k1=new sap.m.DatePicker({enabled:O,tooltip:U.DEFAULT_LONG_TEXT,value:{path:m1.path,type:G(U)},width:"100%"});}else{k1=new m({enabled:O,tooltip:U.DEFAULT_LONG_TEXT,value:m1,width:"100%"});}if(k1.addAriaLabelledBy){k1.addAriaLabelledBy(l1);}k1.addStyleClass("sapUiSmallMarginBottom");e.addItem(k1);}}});},setRespListProperty:function(i,c){var e=this.byId("RespList");if(c){e.setVisible(true);}else{e.setVisible(false);}if(i.oData.RESP_CODE){this.getModel("data").read("/ResponsibilityValueSearchParams(searchToken='',respCode='"+i.oData.RESP_CODE+"')/Results",{urlParameters:{"$orderby":"NAME"},success:function(j){i.setProperty("/Resp_Value",j.results);}});}},onSuggestionList:function(e){var c=this;var i=this.getObjectModel();var E=jQuery.extend({},e,true);var j=jQuery.sap.encodeURL(E.getParameter("suggestValue"));this.resetClientMessages();this.getModel("data").read("/ResponsibilityValueSearchParams(searchToken='"+j+"',respCode='"+i.oData.RESP_CODE+"')/Results",{urlParameters:{"$orderby":"NAME"},success:function(z){i.setProperty("/Resp_Value",z.results);c.byId("RespList").setFilterSuggests(false);}});},onSuggestionSelected:function(e){},onHandleValueHelp:function(e){var c=this;var i=c.createRespListDialog();i.open();i.setBusy(true);var j=c.byId('respValueTreeTable');var z=this.getObjectModel();this.getModel("data").read("/ResponsibilityValueSearchParams(searchToken='',respCode='"+z.oData.RESP_CODE+"')/Results",{urlParameters:{"$orderby":"SEQUENCE_NO"},success:function(E){i.setBusy(false);z.setProperty("/Resp_Value",E.results);var G=c.convertToHierarchy(E.results,"ID","PARENT_VALUE_ID");z.setProperty("/Resp_Value_Tree",G);c.setViewProperty("/ENABLE_OK_BTN",false);c.resetClientMessages();c.byId('RespList')._closeSuggestionPopup();j.attachBrowserEvent("dblclick",function(){if(j.isIndexSelected(c._treeTableIndex)){j.removeSelectionInterval(c._treeTableIndex,c._treeTableIndex);}else{j.addSelectionInterval(c._treeTableIndex,c._treeTableIndex);}if(c._treeTableIndex>-1){var K=j.getContextByIndex(c._treeTableIndex).getPath();c.onRespValueChangedMessageBox.call(c,z,K);if(c._oRespListDialog){c._oRespListDialog.close();c._oRespListDialog.destroy();c._oRespListDialog=undefined;}}c._treeTableIndex=-1;});},error:function(E){z.setProperty("/Resp_Value_Tree",[]);i.setBusy(false);M.show(E.message);}});},convertToHierarchy:function(O,K,P){var N=this.createStructure(O,P);var c=N.root;this.arrToHierarchy(c,N,K);return c;},createStructure:function(N,P){var O={root:[]};for(var i=0;i<N.length;i++){var c="Sub_"+N[i][P];if(!N[i].children||!jQuery.isArray(N[i].children)){N[i].children=[];}if(isNaN(parseInt(N[i][P],10))){O.root.push(N[i]);}else{if(!O.hasOwnProperty(c)){O[c]=[];}O[c].push(N[i]);}}return O;},arrToHierarchy:function(c,N,K){if(!c||c.length===0){return;}for(var i=0;i<c.length;i++){var P="Sub_"+c[i][K];if(N.hasOwnProperty(P)){c[i].children=N[P];this.arrToHierarchy(c[i].children,N,K);}}},onRespValueDialogClose:function(){if(this._oRespListDialog){this._oRespListDialog.close();this._oRespListDialog.destroy();this._oRespListDialog=undefined;}},onRespRowSelectionChange:function(e){var c=this;var i=c.byId("respValueTreeTable");var j=i.getSelectedIndex();if(j>-1){this.setViewProperty("/ENABLE_OK_BTN",true);this._treeTableIndex=j;}else{this.setViewProperty("/ENABLE_OK_BTN",false);}},createRespListDialog:function(){if(!this._oRespListDialog){this._oRespListDialog=this.createFragment("sap.ino.vc.idea.fragments.ResponsibilityListValue",this.getView().getId());this.getView().addDependent(this._oRespListDialog);}return this._oRespListDialog;},onSearchRespValue:function(e){var V=jQuery.sap.encodeURL(e.getParameter("value"));var i=this.getObjectModel();this.getModel("data").read("/ResponsibilityValueSearchParams(searchToken='"+V+"',respCode='"+i.oData.RESP_CODE+"')/Results",{urlParameters:{"$orderby":"NAME"},success:function(c){i.setProperty("/Resp_Value",c.results);}});},onSelectedItem:function(e){var c=this;var i=this.getObjectModel();var j=c.byId("respValueTreeTable");var z=j.getSelectedIndex();if(z>-1){var E=j.getContextByIndex(z).getPath();c.onRespValueChangedMessageBox.call(c,i,E);}if(this._oRespListDialog){this._oRespListDialog.close();this._oRespListDialog.destroy();this._oRespListDialog=undefined;}},setIdeaModelRespValueProperty:function(i,c){i.setProperty("/RESP_VALUE_CODE",i.getProperty(c).CODE);i.setProperty("/RESP_VALUE_NAME",i.getProperty(c).NAME);i.setProperty("/RESP_VALUE_BINDING_CODE",i.getProperty(c).CODE);i.setProperty("/OLD_RESP_NAME",i.getProperty("/RESP_VALUE_NAME"));},onRespValueChangedMessageBox:function(i,c){var e=this;if(!i._isNew){var j=C.getCurrentUser();var z=i.oData.SubmitterContributors;var E=z.filter(function(N){return N.IDENTITY_ID===j.USER_ID;});var G=i.getProperty("/RESP_VALUE_CODE");var K=i.getProperty(c).CODE;if(!E.length&&G!==K){h.show(this.getText("IDEA_OBJECT_MSG_RESP_LIST_VALUE_CHG",i.getProperty("/RESP_NAME")),{title:this.getText("IDEA_OBJECT_RESP_LIST_POP_TITLE",i.getProperty("/RESP_NAME")),icon:h.Icon.WARNING,actions:[h.Action.YES,h.Action.NO],onClose:function(N){if(N===h.Action.YES){e.setIdeaModelRespValueProperty(i,c);}else{i.setProperty("/RESP_VALUE_NAME",i.getProperty("/OLD_RESP_NAME"));}}});}else{e.setIdeaModelRespValueProperty(i,c);}}else{e.setIdeaModelRespValueProperty(i,c);}},onRespListValueChange:function(){var c=this.byId("RespList");var i=this.getObjectModel();var V=c.getValue().trim();var e=i.getProperty("/Resp_Value");var j;var z=this;jQuery.each(e,function(E,G){if(V===G.NAME.trim()){j="/Resp_Value/"+E;return false;}});if(j){z.onRespValueChangedMessageBox.call(z,i,j);}else{i.setProperty("/RESP_VALUE_BINDING_CODE","");z.resetClientMessages();z.setClientMessage(new g({code:"IDEA_OBJECT_MSG_RESP_LIST_VALUE_WRONG_INPUT",type:f.Error}),z.byId("RespList"));}},onFormChanged:function(i,c,e,j){var z;var E=this;var G=E._oldCampaignForm;var K=i.getPropertyModel().getProperty("/nodes/Root/attributes/NAME/changeable");this.getModel("data").read("/CampaignSmall("+c+")/FormFields",{urlParameters:{"$orderby":"SEQUENCE_NO"},success:function(N){z=N.results;if(K){if(!z.length&&G){h.confirm(E.getText("IDEA_OBJECT_MSG_CONFIRM_CAMPAIGN_CHG"),{title:E.getText("IDEA_OBJECT_EDIT_POP_TITLE"),icon:h.Icon.WARNING,actions:[h.Action.OK,h.Action.CANCEL],onClose:function(O){if(O===h.Action.OK){i.oData.FieldsValue=z;i.setProperty("/NEW_ADDED_FIELDS",[]);E.addFormFields.call(E,z,e,i,O);E._oldCampaignId=j.getSelectedKey();E._oldCampaignForm=null;}else{E.addFormFields.call(E,i.oData.FieldsValue,e,i);j.setSelectedKey(E._oldCampaignId);}}});}else if(z.length&&G!==z[0].FORM_CODE){h.show(E.getText("IDEA_OBJECT_MSG_EDIT_CAMPAIGN_CHG"),{title:E.getText("IDEA_OBJECT_EDIT_POP_TITLE"),icon:h.Icon.WARNING,actions:[h.Action.OK,h.Action.CANCEL],onClose:function(O){if(O===h.Action.OK){i.oData.FieldsValue=z;i.setProperty("/NEW_ADDED_FIELDS",[]);E.addFormFields.call(E,z,e,i,O);E._oldCampaignId=j.getSelectedKey();E._oldCampaignForm=z[0].FORM_CODE;}else{E.addFormFields.call(E,i.oData.FieldsValue,e,i);j.setSelectedKey(E._oldCampaignId);}}});}else{E.addFormFields.call(E,i.oData.FieldsValue,e,i);}}else{E.addFormFields.call(E,i.oData.FieldsValue,e,i);}},error:function(N){M.show(N.message);}});},onContributorsTokenChanged:function(c){if(this._checkContributionReadOnly()||!this._checkContributionEnable()||!c||c.getParameters().type!=="tokensChanged"){return;}var i=this.getObjectModel();var e=c.getParameters().removedTokens;var j=C.getCurrentUser();var z=c.getParameters().addedTokens;var E=i.getProperty("/ContributionShare");var G=i.isNew()?j.USER_ID:i.getProperty("/CREATED_BY_ID");var K=i.isNew()?j.NAME:i.getProperty("/CREATED_BY_NAME");if(!!e&&e.length>0){var N=parseInt(e[0].getKey(),10);if(G===N){return;}for(var O=E.length-1;O>=0;--O){if(E[O].AUTHOR_ID===N){E.splice(O,1);}}if(!!E&&E.length===1&&E[0].AUTHOR_ID===G){E=[];}i.setProperty("/ContributionShare",E);}else if(!!z&&z.length>0){var P=parseInt(z[0].getKey(),10);if(!E||E.length===0){i.addChild({AUTHOR_ID:G,AUTHOR_NAME:K},"ContributionShare");}if(G===P){return;}i.addChild({AUTHOR_ID:P,AUTHOR_NAME:z[0].getText()},"ContributionShare");}},setRespValueChangeMsg:function(){var c=this.byId("RespList");var i=this.getObjectModel();var e=i.getProperty("/RESP_VALUE_BINDING_CODE");var j=i.getProperty("/Resp_Value");var z=this;if(!j&&!e){e=i.getProperty("/RESP_VALUE_CODE");}if(!e){var V=c.getValue().trim();jQuery.each(j,function(E,G){if(V===G.NAME.trim()){e=G.CODE;return false;}});if(!e){z.setClientMessage(new g({code:"IDEA_OBJECT_MSG_RESP_LIST_VALUE_WRONG_INPUT",type:f.Error}),z.byId("RespList"));}}},createObjectModel:function(O,c,e){var i={nodes:["Root","Extension"],actions:["modify","modifyAndSubmit","del"],continuousUse:true,concurrencyEnabled:true,readSource:{model:this.getDefaultODataModel(),includeNodes:[{name:"ReassignCampaigns",parentNode:"Root",primaryKey:"KEY"},{name:"RespExperts",parentNode:"Root",primaryKey:"ID"}]}};var j;if(!O){var Q=e["?query"]||{};var z;try{z={CAMPAIGN_ID:Q.campaign?parseInt(Q.campaign,10):0,NAME:Q.title,RESP_VALUE_CODE:Q.RespList,RESP_VALUE_NAME:Q.RespList&&o.getText("sap.ino.xs.object.subresponsibility.ResponsibilityStage.RespValues",Q.RespList),DESCRIPTION:Q.description,Tags:Q.tags&&Q.tags.split(","),Walls:Q.wall?[{WALL_ID:parseInt(Q.wall,10)}]:undefined};}catch(E){jQuery.sap.log.error("Failed parsing creation arguments",E,"sap.ino.vc.idea.Modify.controller");}j=new I(z,i);}else{W.logIdeaView(O);j=new I(O,i);}return j;},initIdeaDetails:function(){this._sTitleText=undefined;this._sDescriptionText=undefined;this._aTags=undefined;this._oSimilarModel=undefined;this.expandSimilarIdeasOnInit();},onAnonymousSelectionChange:function(e){var c=this.byId("anonymousComboBox");var i=this.getObjectModel();var j=c.getSelectedKey();i.setProperty("/AnonymousFor/0/",{"ANONYMOUS_FOR":j});},bindAnonymousList:function(c,i,e){var j=this.byId("anonymousComboBox");var z=this.byId("anonymousOptionLabel");var E=c.CAMPAIGN_ID;if(e){E=e;}if(j){var G=this.getModel("user").getProperty("/data").USER_ID;var K,N;var O=this;if(c.AnonymousFor&&c.AnonymousFor.length>0){j.setSelectedKey(c.AnonymousFor[0].ANONYMOUS_FOR);}else{j.setSelectedKey("");}K=new L({key:"{data>ANONYMOUS_FOR}",text:{path:"data>ANONYMOUS_FOR",formatter:function(U){switch(U){case"NONE":return O.getText("IDEA_NOT_ANONYMOUS");case"ALL":return O.getText("IDEA_ANONYMOUS_FOR_ALL");case"PARTLY":return O.getText("IDEA_NOT_ANONYMOUS_CAMPAIGN_MANAGER");case"COACH":return O.getText("IDEA_NOT_ANONYMOUS_COACH");case"EXPERT":return O.getText("IDEA_NOT_ANONYMOUS_EXPERT");case"PARTICIPANT":return O.getText("IDEA_NOT_ANONYMOUS_PARTICIPANT");case"COACH_AND_EXPERT":return O.getText("IDEA_NOT_ANONYMOUS_COACH_AND_EXPERT");case"COACH_POOL":return O.getText("IDEA_NOT_ANONYMOUS_COACH_POOL");case"EXPERT_POOL":return O.getText("IDEA_NOT_ANONYMOUS_EXPERT_POOL");case"COACH_POOL_AND_EXPERT_POOL":return O.getText("IDEA_NOT_ANONYMOUS_COACH_POOL_AND_EXPERT_POOL");}}}});N="data>/IdeaAnonymous";if(E){j.bindItems({path:N,template:K,filters:[new F({path:"CAMPAIGN_ID",operator:a.EQ,value1:Number(E)})]});}else{j.bindItems({path:N,template:K});}var P=this.getObjectModel();var Q=j.getBinding("items");if(Q){Q.attachDataReceived(function(U){if(U.getParameters().data.results.length<=1){if(U.getParameters().data.results.length>0){j.setSelectedKey(U.getParameters().data.results[0].ANONYMOUS_FOR);var V=j.getSelectedKey();P.setProperty("/AnonymousFor/0/",{"ANONYMOUS_FOR":V});}else{z.setVisible(false);j.setVisible(false);}j.setEditable(false);}else{j.setEditable(true);}if(c.CREATED_BY_ID===G||i){j.setEditable(true);}else{j.setEditable(false);}},this);}}},bindCampaignList:function(c,i){var e=this.byId("campaignComboBox");var j,z;var E=this;if(c.CAMPAIGN_ID&&!i){j=new L({key:"{object>ID}",text:"{object>SHORT_NAME}"});z="object>/ReassignCampaigns";}else{j=new L({key:"{data>ID}",text:"{data>SHORT_NAME}"});z="data>/CampaignSmallIdeaAssign";}e.bindItems({path:z,template:j,sorter:new S("SHORT_NAME"),length:500});var G=e.getBinding("items");if(G){G.attachDataReceived(function(){E.checkCampaignAllowtoAssign(c.CAMPAIGN_ID);},this);}},initRTE:function(P){var e=this;if(!D.system.desktop){return;}this.destroyRTE();var E=(P&&P.nodes.Root.attributes)?P.nodes.Root.attributes.DESCRIPTION.changeable:true;var i=this.byId("rteContainer");var j;e._TextControlID="richtextControl_"+new Date().getTime();if(E){jQuery.sap.require("sap.ino.controls.RichTextEditor");j=new sap.ino.controls.RichTextEditor({id:this.createId(e._TextControlID),width:"100%",editable:true,editorType:"TinyMCE4",height:"300px",showGroupInsert:true,showGroupLink:true,showGroupFont:true,beforeEditorInit:function(c){c.mParameters.configuration.plugins=c.mParameters.configuration.plugins.replace("image,","");c.mParameters.configuration.link_context_toolbar=true;c.mParameters.configuration.plugins=c.mParameters.configuration.plugins.replace("powerpaste","powerpaste,imagetools");c.mParameters.configuration.paste_data_images=true;c.mParameters.configuration.automatic_uploads=true;c.mParameters.configuration.powerpaste_word_import="clean";c.mParameters.configuration.powerpaste_html_import="clean";c.mParameters.configuration.default_link_target="_blank";c.mParameters.configuration.images_upload_handler=function(z,G,K){var N=z.blob();if(N){A.uploadFile(N).done(function(O){var Q=e.getObjectModel();G(C.getAttachmentDownloadURL(O.attachmentId));Q.setProperty("/DESCRIPTION",jQuery.sap._sanitizeHTML(window.tinymce.activeEditor.getContent()));}).fail(function(){K();M.show(e.getText("IDEA_OBJECT_MSG_TITLE_IMAGE_CROP_FAILED"));});}};c.mParameters.configuration.paste_postprocess=function(z,G){window.tinymce.activeEditor.uploadImages();};}});j.attachReady(function onRTEReady(){this.bindProperty("value",{model:"object",path:"DESCRIPTION"});e._onResize();if(!this._sResizeRegId){this._sResizeRegId=R.register(e.getView(),e._onResize);}});j.onAfterRendering=function(){sap.ino.controls.RichTextEditor.prototype.onAfterRendering.apply(this);e.byId("NAME").focus();jQuery("#"+e.byId('objectpage').getId()+"-opwrapper").animate({scrollTop:0},100);};}else{j=new H({id:this.createId(e._TextControlID),sanitizeContent:true,preferDOM:false,content:{model:"object",path:"DESCRIPTION",formatter:this.formatter.wrapHTML}});}setTimeout(function(){i.destroyItems();i.addItem(j);},500);},destroyRTE:function(){if(this._sResizeRegId){R.deregister(this._sResizeRegId);}var c=this.getRTE();if(c){c.destroy();}},getRTE:function(){return this.byId(this._TextControlID);},_onResize:function(e){var V;var i;var O;if(e){V=e.control;i=e.size.height;O=e.oldSize.height;}else{V=this.getView();i=V.$().height();O=0;}var c=V.getController().getRTE();if(!c||c.getMetadata().getName()!=="sap.ino.controls.RichTextEditor"){return;}if(Math.abs(i-O)>0){var j=V.$().find(".sapInoIdeaModify");var z=parseInt(j.css("min-height"),10)||400;var E=parseInt(j.css("max-height"),10)||1000;i=i-600;i=i<z?z:i;i=i>E?E:i;c.setHeight(i+"px");setTimeout(function(){var G=V.$().find(".mce-tinymce.mce-container");var K=G.css("height");var N=parseFloat(G.css("border-width"),10);if(N){K=(parseFloat(K,10)+(2*N))+"px";}var P=V.getController().byId("similarIdeas");P.setHeight(K);},0);}},onCampaignPressed:function(e){var i=this.getObjectModel().getProperty("/CAMPAIGN_ID");this.navigateTo("campaign",{id:i},true);},onTagChanged:function(e){var c=e.getSource();var V=e.getParameter("value");if(!V){return;}if(!e.getSource().getAggregation("tokenizer")){return;}var i=e.getSource().getAggregation("tokenizer").getAggregation("tokens");var j=V.split(",");j.forEach(function(z){z=z.trim();if(z===""){return;}var E=new T({text:z});var G;i.forEach(function(E){if(E.getProperty("text")===z){G=true;return;}});if(!G){E.bApplicationCreated=true;c.addToken(E);}});c.setValue("");},onTagTokenChanged:function(e){var c=e.getSource();if(!e.getSource().getAggregation("tokenizer")){return;}c.setValue("");},getLinkDialog:function(){if(!this._oLinkDialog){this._oLinkDialog=this.createFragment("sap.ino.vc.idea.fragments.Link",this.getView().getId());this.getView().addDependent(this._oLinkDialog);this._oLinkDialog.setInitialFocus(this.createId("URLInput"));}return this._oLinkDialog;},onAddLinkDialogCancel:function(e){this.resetClientMessages();this._oLinkDialog.close();},onAddLink:function(e){var c=this.getLinkDialog();c.setModel(new J({URL:"",LABEL:""}),"link");c.bindElement({path:"link>/"});this.resetClientMessages();c.open();},onAddLinkDialogOK:function(e){var c=this.getLinkDialog();var i=c.getModel("link");var j=i.getProperty("/ID");var U=i.getProperty("/URL");var z=i.getProperty("/LABEL");this.resetClientMessages();var E=this.getObjectModel().modifyLink(j,U,z);if(E){this.setClientMessage(E,this.byId("URLInput"));}else{c.close();}},onEditLink:function(e){var c=this.getLinkDialog();var i=e.getSource().getBindingContext("object");var j=this.getObjectModel().getProperty(i.sPath+"/ID");var U=this.getObjectModel().getProperty(i.sPath+"/URL");var z=this.getObjectModel().getProperty(i.sPath+"/LABEL");this.resetClientMessages();c.setModel(new J({ID:j,URL:U,LABEL:z}),"link");c.bindElement({path:"link>/"});c.open();},onDeleteLink:function(e){var O=this.getObjectModel();var c=e.getSource().getBindingContext("object").getObject();O.removeChild(c);},crop:function(){var c=this;var e=jQuery.Deferred();var i=this.byId("imageCropping");var j=i.crop();if(j){var z=this.getObjectModel().getData().TITLE_IMAGE_ID;A.uploadFile(j,null,z,true).done(function(E){if(E.attachmentId){var O=c.getObjectModel();O.setTitleImage({"ATTACHMENT_ID":E.attachmentId,"FILE_NAME":E.fileName,"MEDIA_TYPE":E.mediaType});}e.resolve({messages:[{"TYPE":"I","MESSAGE":"IDEA_OBJECT_MSG_TITLE_IMAGE_CROP","MESSAGE_TEXT":c.getText("IDEA_OBJECT_MSG_TITLE_IMAGE_CROP"),"REF_FIELD":""}]});}).fail(function(){M.show(c.getText("IDEA_OBJECT_MSG_TITLE_IMAGE_CROP_FAILED"));e.reject();});}else{e.resolve();}return e.promise();},checkContributionShare:function(){if(!this._checkContributionEnable()){return true;}var c=this.getObjectModel().getProperty("/ContributionShare");if(!c||c.length===0){return true;}var e=0;jQuery.each(c,function(i,j){e+=j.PERCENTAGE;});return e===100;},addAuthorToContributionShare:function(){if(!this._checkContributionEnable()){return;}var i=this.getObjectModel();var c=C.getCurrentUser();var e=i.getProperty("/ContributionShare");var j=i.isNew()?c.USER_ID:i.getProperty("/CREATED_BY_ID");var z=i.isNew()?c.NAME:i.getProperty("/CREATED_BY_NAME");if(!e||e.length===0){i.addChild({AUTHOR_ID:j,AUTHOR_NAME:z,PERCENTAGE:100.00},"ContributionShare");}},formatterContributionShare:function(){var i=this.getObjectModel();var c=i.getProperty("/ContributionShare");jQuery.each(c,function(e,j){if(j.PERCENTAGE>0){i.setProperty("/ContributionShare/"+e+"/PERCENTAGE",parseInt(j.PERCENTAGE,10));}else{i.setProperty("/ContributionShare/"+e+"/PERCENTAGE",0);}});},checkCampaignAllowtoAssign:function(c){var e=String(c);var i=this.byId("campaignComboBox");var j=this;if(c&&!i.getItemByKey(e)){j.setClientMessage(new g({code:"IDEA_OBJECT_MSG_CAMPAIGN_NOT_ALLOWED",type:f.Error}),j.byId("campaignComboBox"));i.setSelectedItemId();}},syncAuthorToContributionShareBinding:function(){if(!!arguments&&arguments.length>0&&!!arguments[0].getParameters()&&arguments[0].getParameters().hasOwnProperty("url")&&/xsodata\/CampaignSmall\(\d+\)$/i.test(arguments[0].getParameters().url)){this.syncAuthorToContributionShare();var i=this.getModel("data");i.detachRequestCompleted(this.syncAuthorToContributionShareBinding,this);}},syncAuthorToContributionShare:function(){var i=this.getObjectModel();var c=C.getCurrentUser();var e=i.getProperty("/ContributionShare");var j=i.getProperty("/Contributors");if(this._checkContributionEnable()){jQuery.each(j,function(G,K){if(jQuery.grep(e,function(N){return N.AUTHOR_ID===K.IDENTITY_ID;}).length===0){i.addChild({AUTHOR_ID:K.IDENTITY_ID,AUTHOR_NAME:K.NAME},"ContributionShare");}});e=i.getProperty("/ContributionShare");var z=i.isNew()?c.USER_ID:i.getProperty("/CREATED_BY_ID");var E=i.isNew()?c.NAME:i.getProperty("/CREATED_BY_NAME");for(var G=e.length-1;G>=0;--G){if(e[G].AUTHOR_ID!==z&&jQuery.grep(j,function(K){return K.IDENTITY_ID===e[G].AUTHOR_ID;}).length===0){if(e[G].ID<0){e.splice(G,1);}}}e=i.getProperty("/ContributionShare");if(jQuery.grep(e,function(K){return z===K.AUTHOR_ID;}).length===0){i.addChild({AUTHOR_ID:z,AUTHOR_NAME:E,PERCENTAGE:e.length>1?0.00:100.00},"ContributionShare");}}},clearIdeaFormDisplayOnlyFields:function(){var i=this.getObjectModel();var c=i.getProperty("/FieldsValue");var e=[];jQuery.each(c,function(j,z){if(!z.IS_DISPLAY_ONLY){e.push(z);}});if(e.length>0){i.setProperty("/FieldsValue",e);}},onSave:function(){var c=this;c.resetClientMessages();c.addAuthorToContributionShare();c.formatterContributionShare();if(!c.checkContributionShare()){M.show(c.getText("MSG_REWARD_CONTRIBUTION_SHARE_SUM_ERROR"));return;}var i;var e=function(){c.crop().done(function(G){c._CheckContentAttachments(c.getObjectModel());if(c.byId("RespList").getVisible()&&c.getObjectModel().getProperty("/SUBMITTED_AT")){if(!c.getObjectModel().getProperty("/RESP_VALUE_NAME")){c.setClientMessage(new g({code:"IDEA_OBJECT_MSG_RESP_LIST_VALUE_EMPTY_SAVE",type:f.Error}),c.byId("RespList"));}else{c.setRespValueChangeMsg.call(c);}}if(c.getObjectModel().getProperty("/SUBMITTED_AT")){jQuery.each(c.aComboBoxes,function(P,Q){if(Q instanceof sap.m.ComboBox&&!Q.getItemByText(Q.getValue())){Q.fireChange();}});jQuery.each(c.aCheckBoxes,function(P,Q){Q.fireSelect();});}var K=c.getObjectModel().isNew();var N,O;O=c.getObjectModel();if(!O.getUserChanges().RESP_VALUE_CODE){i=null;}if(i){N=c.executeObjectAction("modifyAndAutoAssignCoach",{parameters:{DEFAULT_COACH:i}});}else{N=c.executeObjectAction("modify");}N.done(function(P){var z=c.getObjectModel();if(!c.getObjectModel().oData.CAMPAIGN_ID){z.setProperty("/RESP_LIST_VISIBLE",false);}c._refreshWallList();c.navigateTo("idea-display",{id:z.getKey()},true);if(G){z.getMessageParser().parse(G);}});});};var j=function(){if(c.getObjectModel().delVotesSimulate()){h.confirm(c.getText("OBJECT_MSG_VOTES_DELETE_CONFIRMATION"),{onClose:function(G){if(G===h.Action.OK){e();}}});}else{e();}};var z=c.getObjectModel();var E=z.getProperty("/Coach");i=c.defaultAutoAssignCoach(c,z);if(z.getProperty("/SUBMITTED_AT")&&E&&E.length>0&&i&&z.getUserChanges().RESP_VALUE_CODE){h.confirm(c.getText("IDEA_OBJECT_MSG_CONFIRM_COACH_CHG"),{icon:h.Icon.WARNING,actions:[h.Action.YES,h.Action.NO],onClose:function(G){if(G===h.Action.NO){i=null;}j();}});}else{if(!z.getProperty("/SUBMITTED_AT")){i=null;}j();}},defaultAutoAssignCoach:function(c,i){var e=i.getProperty("/Resp_Value");var j=i.getProperty("/RESP_VALUE_CODE");var z=i.getProperty("/AUTO_ASSIGN_RL_COACH");var E;if(!e&&i.getProperty("/STATUS")==="sap.ino.config.DRAFT"){E=i.getProperty("/DEFAULT_COACH");}else{if(z&&j&&e){jQuery.each(e,function(G,K){if(K.CODE===j){E=K.DEFAULT_COACH;return false;}});}}return E;},matchTemplate:function(){var i=this.getObjectModel();var c=i.getProperty("/DESCRIPTION");var e=i.getProperty("/IDEA_DESCRIPTION_TEMPLATE")||"";var j="<p>"+e+"</p>";return e!==""&&(c===e||c===j);},onSubmit:function(){var c=this;c.resetClientMessages();c.addAuthorToContributionShare();c.formatterContributionShare();jQuery.each(c.aComboBoxes,function(j,z){if(z instanceof sap.m.ComboBox&&!z.getItemByText(z.getValue())){z.fireChange();}});jQuery.each(c.aCheckBoxes,function(j,z){z.fireSelect();});if(!c.checkContributionShare()){M.show(c.getText("MSG_REWARD_CONTRIBUTION_SHARE_SUM_ERROR"));return;}var i=c.getObjectModel();var e=c.defaultAutoAssignCoach(c,i);this.crop().done(function(j){c._CheckContentAttachments(i);if(!c.getObjectModel().getProperty("/CAMPAIGN_ID")){c.setClientMessage(new g({code:"IDEA_OBJECT_MSG_CAMPAIGN_EMPTY_SUBMIT",type:f.Error}),c.byId("campaignComboBox"));}if(c.byId("RespList").getVisible()){if(!c.getObjectModel().getProperty("/RESP_VALUE_NAME")){c.setClientMessage(new g({code:"IDEA_OBJECT_MSG_RESP_LIST_VALUE_EMPTY_SUBMIT",type:f.Error}),c.byId("RespList"));}else{c.setRespValueChangeMsg.call(c);}}if(c.matchTemplate()){c.setClientMessage(new g({code:"IDEA_OBJECT_MSG_TEMPLATE_NOT_CHANGE",type:f.Error}),c.getRTE());}var z=c.executeObjectAction("modifyAndSubmit",{messages:{confirm:"IDEA_OBJECT_MSG_SUBMIT_CONFIRM",success:function(){return c.getText("IDEA_OBJECT_MSG_SUBMIT_OK",i.getProperty("/NAME"));}},parameters:{CAMPAIGN_ID:i.getProperty("/CAMPAIGN_ID")}});z.done(function(E){if(E&&E.confirmationCancelled===true){c.byId("ideaSubmitBtn").focus();return;}if(e){var G=c.executeObjectActionPrototypeDirectly("autoAssignCoach",{parameters:{DEFAULT_COACH:e}});G.always(function(){c.navigateTo("idea-display",{id:i.getKey()},true);if(j){i.getMessageParser().parse(j);}});}else{c.navigateTo("idea-display",{id:i.getKey()},true);if(j){i.getMessageParser().parse(j);}}});});},onFileUploaderChange:function(e){var c=e.getSource();var i=e.getParameter("files");c.setBusy(true);A.prepareFileUploader(c,i);},onFileUploaderComplete:function(e){var c=A.parseUploadResponse(e.getParameter("responseRaw"));var i=e.getSource();if(c){var O=this.getObjectModel();O.getMessageParser().parse(c);if(c.success){O.setTitleImage({"ATTACHMENT_ID":c.attachmentId,"FILE_NAME":c.fileName,"MEDIA_TYPE":c.mediaType});}else{M.show(this.getText("IDEA_OBJECT_MSG_TITLE_IMAGE_FAILED"));}}else{M.show(this.getText("IDEA_OBJECT_MSG_TITLE_IMAGE_ERROR"));}i.setBusy(false);i.clear();},onFileTypeMissMatch:function(e){M.show(this.getText("IDEA_OBJECT_MSG_TITLE_IMAGE_TYPE_MISS_MATCH"));},onTitleImageClear:function(e){var O=this.getObjectModel();O.clearTitleImage();},onTitleImageCrop:function(e){this.crop();},_refreshWallList:function(){this.getView().byId("wallsection").invalidate();},onTitleChange:function(e){this.bindSimilarIdeas();},getIdeaDisplayLink:function(i){return this.getNavigationLink("idea-display",{id:i});},formatSimilarIdeaName:function(c,e){if(e==="sap.ino.config.DRAFT"){return"["+this.getText("IDEA_OBJECT_FIELD_SIMILAR_IDEAS_DRAFT")+"]"+c;}else{return c;}},getEditorContentLive:function(){var c=this.getRTE();if(!c){return"";}if(c.getContent){return c.getContent();}try{if(c&&c.getNativeApi()&&(c.getNativeApi().getDoc()||c.getNativeApi().bodyElement)){return c&&c.getNativeApi()&&c.getNativeApi().getContent();}else{return"";}}catch(e){jQuery.sap.log.error("Editor content could not be retrieved: "+e.toString(),"","sap.ino.vc.idea.Modify.controller.js");}},onAfterShow:function(){this._dViewShown.resolve();},onBeforeHide:function(){jQuery.sap.clearIntervalCall(this._sRefreshSimilarIdeasTimer);this._sRefreshSimilarIdeasTimer=null;},onAfterHide:function(){this._dViewShown=jQuery.Deferred();this.destroyRTE();},expandSimilarIdeasOnInit:function(){if(!D.system.desktop){return;}var c=this.byId("similarIdeas");var i=this.getObjectModel();var e=i&&i.getProperty("/STATUS_CODE");var P=i&&i.getProperty("/STEP");var j=C.getPersonalize().SIMILAR_IDEA;if(i.isNew()){this.getView().setModel(new J({}),"similarIdeas");this._setInterval4SimilarIdeas();if(j){this.onShowSimilarIdeas();}}else if(c&&((e==='sap.ino.config.NEW_IN_PHASE'&&P===0)||e==='sap.ino.config.DRAFT')){this.bindSimilarIdeas();this._setInterval4SimilarIdeas();if(j){this.onShowSimilarIdeas();}}else{this.onToggleSimilarIdeas(undefined,true);}},getAvaliableWidth:function(){return this.getView().$().find(".sapInfoIdeaName").width();},onShowSimilarIdeas:function(){var c=this.getView().byId("similarIdeas");var e=c.hasStyleClass('sapInoIdeaSimilarIdeasExpanded');if(!e){c.addStyleClass("sapInoIdeaSimilarIdeasExpanded");}},bindSimilarIdeas:function(){var c=this;var i=this.getObjectModel();this._oSimilarModel=new J();var e=i.getProperty("/ID");var P={name:i.getProperty("/NAME"),description:this.getEditorContentLive(),campId:i.getProperty("/CAMPAIGN_ID"),filterDraft:true,limit:12};if(i&&i.getProperty("/Tags")&&i.getProperty("/Tags").length>0){var j=[];i.getProperty("/Tags").forEach(function(z){j.push(z.NAME);});P.tags=JSON.stringify(j);}if(C.getRelatedIdeasByTextURL(e)){this._oSimilarModel.loadData(C.getRelatedIdeasByTextURL(e),P,true,"POST");this._oSimilarModel.attachRequestCompleted(null,function(){var z=c.groupByCampaignId(c._oSimilarModel.getData(),i.oData.CAMPAIGN_ID,i.oData.CAMPAIGN_NAME);c._oSimilarModel.setData({"similarIdeasData":z},false);this.getView().setModel(this._oSimilarModel,"similarIdeas");},this);}},isDescriptionChanged:function(N){if(N===null||N===undefined){return false;}return(this._sDescriptionText===undefined&&N.length>0)||(this._sDescriptionText!==undefined&&this._sDescriptionText!==N);},isTitleChanged:function(N){if(N===null||N===undefined){return false;}return(this._sTitleText===undefined&&N.length>0)||(this._sTitleText!==undefined&&this._sTitleText!==N);},isTagsChanged:function(N){return $(this._aTags).not(N).length!==0||$(N).not(this._aTags).length!==0;},refreshSimilarIdeas:function(){var N=this.getObjectModel().getProperty("/NAME");var c=this.getEditorContentLive();var e=this.getObjectModel().getProperty("/Tags");if(this.isDescriptionChanged(c)||this.isTitleChanged(N)||this.isTagsChanged(e)){this.bindSimilarIdeas();this._sTitleText=N;this._sDescriptionText=c;this._aTags=e;}},onToggleSimilarIdeas:function(e,c){var i=this.getView().byId("similarIdeas");if(c||i.hasStyleClass('sapInoIdeaSimilarIdeasExpanded')){i.removeStyleClass("sapInoIdeaSimilarIdeasExpanded");if(this._sRefreshSimilarIdeasTimer){jQuery.sap.clearIntervalCall(this._sRefreshSimilarIdeasTimer);this._sRefreshSimilarIdeasTimer=null;}}else{i.addStyleClass("sapInoIdeaSimilarIdeasExpanded");this.bindSimilarIdeas();this._setInterval4SimilarIdeas();}},onRespListHint:function(e){var c=this._getRespListHintDialog();var i=this.getObjectModel();var j=i.getProperty("/RESP_VALUE_CODE");c.bindElement({path:"data>/RespValues('"+j+"')/"});c.open();},onRespListHintDialogClose:function(){var c=this._getRespListHintDialog();c.close();},_getRespListHintDialog:function(){var c=this._oRespListHintDialog;if(!c){c=this.createFragment("sap.ino.vc.idea.fragments.ResponsibilityDetail",this.getView().getId());this.getView().addDependent(c);this._oRespListHintDialog=c;this._oRespListHintDialog.setInitialFocus(this.createId("TagToken"));}return c;},_setInterval4SimilarIdeas:function(){if(!this._sRefreshSimilarIdeasTimer){this._sRefreshSimilarIdeasTimer=jQuery.sap.intervalCall(5000,this,this.refreshSimilarIdeas);}},contributionShareFormatter:function(c,e){if(!e||!c||c.length<=1){return false;}return true;},_checkContributionReadOnly:function(){return this.getObjectModel().getProperty("/CONTRIBUTION_READ_ONLY");},_checkContributionEnable:function(){return this.getObjectModel().getProperty("/REWARD_ACTIVE");},_CheckContentAttachments:function(c){var e=c.getProperty("/DESCRIPTION"),z=[],N=[],O=c.getProperty("/ContentAttachments");if(!e){return;}var E=new RegExp("<img.*attachment_download\.xsjs/(\\d+)\"","g"),G;do{G=E.exec(e);if(G&&G.length===2){z.push(G[1]);}}while(G!==null);var K=false,P=void 0;for(var i=0;i<=z.length-1;i++){K=false;P=undefined;for(var j=0;j<=O.length-1;j++){if(Number(z[i])===O[j].ATTACHMENT_ID){K=true;P=O[j];break;}}if(K){N.push(P);}else{N.push({ID:c.getNextHandle(),ATTACHMENT_ID:Number(z[i])});}}c.setProperty("/ContentAttachments",N);},resetPendingChanges:function(){B.prototype.resetPendingChanges.apply(this,arguments);}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.RewardFormatter')){jQuery.sap.declare('sap.ino.vc.idea.RewardFormatter');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/ino/vc/idea/RewardFormatter",["sap/ino/commons/formatters/BaseFormatter","sap/ino/commons/models/core/CodeModel","sap/ui/base/Object","sap/ino/commons/formatters/ObjectFormatter","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/models/aof/PropertyModelCache"],function(B,C,O,a,P,b){"use strict";var r=O.extend("sap.ino.vc.idea.RewardFormatter",{});jQuery.extend(r,a);var R=P.getStaticActionEnabledDynamicFormatter("sap.ino.xs.object.reward.RewardList","create",function(i){return{IDEA_ID:i};});r.createRewardEnabled=function(i,S){if(S===0){return false;}if(i){return R(i);}return false;};r.rewardAmountUnit=function(A,u){u=u===null?"":" "+u;return A+u;};r.addPercentage=function(n){n=Math.round(Number(n));return String(n)+"%";};r.addPercentageDetail=function(n){if(n===undefined||!n){return'';}else{n=Math.round(Number(n));return String(n)+"%";}};r.maxFractionFormatter=function(n,c){var d=parseFloat(n);if(isNaN(d)){return n;}var p=parseInt(c,10);if(isNaN(p)){p=2;}var e=Math.pow(10,p);return Math.round(d*e)/e;};r.ideaNavigationLink=function(i,s){if(!isNaN(parseInt(i,10))){var p={id:i};if(s){p.query={section:s};}return B.navigationLink.apply(this,["idea-display",p]);}return"";};return r;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.Votes.controller')){jQuery.sap.declare('sap.ino.vc.idea.Votes.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/idea/Votes.controller",["sap/ino/vc/commons/BaseObjectController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/User"],function(B,J,I,C,U){"use strict";var f={voteComment:function(v,V){if(v){return B.prototype.formatter.valueOption(v);}else{return V;}},voterName:function(p,n,a){if(p){return n;}else{return a;}},groupVoteTitle:function(v,g){var V;switch(v){case"ORG":V="Organization";break;case"COM":V="Company";break;case"COST":V="Cost Center";break;case"OFF":V="Office";break;default:V="";}return g.replace(/{\d+}/g,V);}};jQuery.extend(f,B.prototype.formatter);return B.extend("sap.ino.vc.idea.Votes",{formatter:f,onAfterRendering:function(){var s=this;var g=s.byId('groupVoteList');if(g){var a=g.getItems();if(a.length>0){for(var i=0;i<a.length;i++){var c=a[i].getContent()[0];if(c.getExpanded()){c.setExpanded(false);}}}}},OnUserPressed:function(e){var s=e.getSource();var c=s.getBindingContext("data");var i=c.getProperty("USER_ID");if(s&&i){if(!this._oIdentityCardView||!this._oIdentityCardView.getController()){this._oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});s.addDependent(this._oIdentityCardView);}this._oIdentityCardView.getController().open(s,i);}},onExpand:function(e){var s=e.getSource();var c=s.getBindingContext("data");var o;if(e.getParameter("expand")&&c){s.toggleStyleClass("sapInoActivityExpanded");var d=c.getObject();o=this.getFragment("sap.ino.vc.idea.fragments.VoteGeneralList").clone();o.addStyleClass("sapMListBGSolid");o.bindItems({path:"data>/IdeaFull("+d.IDEA_ID+")/Votes",template:this.getFragment("sap.ino.vc.idea.fragments.VoteGeneralListItem"),filters:new sap.ui.model.Filter("GROUP_VOTE_NAME",sap.ui.model.FilterOperator.EQ,d.GROUP_VOTE_NAME)});}else{s.toggleStyleClass("sapInoActivityExpanded");s.removeAllContent();}s.addContent(o);}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.BaseActionMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.BaseActionMixin');sap.ui.define("sap/ino/vc/idea/mixins/BaseActionMixin",["sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/formatters/ObjectFormatter","sap/ino/controls/OrientationType","sap/ino/commons/models/object/Idea"],function(P,O,a,I){"use strict";var B=function(){throw"Mixin may not be instantiated directly";};B.isActionContextSingleIdeaDisplay=function(){return!!(this.getObjectModel&&this.getObjectModel()&&this.getObjectModel().getMetadata&&this.getObjectModel().getMetadata().getName()==="sap.ino.commons.models.object.Idea");};B.saveCurrentFocusBeforeActionDialogOpen=function(){this._sActionCurrentFocusId=sap.ui.getCore().getCurrentFocusedControlId();};B.restoreFocusAfterActionDialogClose=function(){if(this._sActionCurrentFocusId){var c=sap.ui.getCore().getElementById(this._sActionCurrentFocusId);if(c&&c.focus){c.focus();}this._sActionCurrentFocusId=undefined;}};B.resetActionState=function(i){if(this.isActionContextSingleIdeaDisplay()&&typeof(this.resetClientMessages)==="function"){this.resetClientMessages();}if(i){this._refreshMassActionState();}else{this._resetMassActionState();}};B.onAfterActionDialogClose=function(e){var d=e.getSource();this.resetActionState(d.data("context")==="mass");};B._computeActionAggregations=function(){return jQuery.map(this._oSelectionMap,function(v){return v;}).reduce(function(l,i){var b=O.isFinal(i.STATUS);if(l){l.ideas.push(i.ID);l.authors.push(i.SUBMITTER_ID);if(l.campaigns.indexOf(i.CAMPAIGN_ID)===-1){l.campaigns.push(i.CAMPAIGN_ID);}if(l.phases.indexOf(i.PHASE)===-1){l.phases.push(i.PHASE);}if(l.status.indexOf(i.STATUS)===-1){l.status.push(i.STATUS);}if(l.respValueCode.indexOf(i.RESP_VALUE_CODE)===-1){l.respValueCode.push(i.RESP_VALUE_CODE);}l.addExpert.push(i.property.actions.addExpert.enabled);l.assignTag.push(i.property.actions.assignTag.enabled);l.assignCoach.push(i.property.actions.assignCoach.enabled);l.assignToMe.push(i.property.actions.assignToMe.enabled);l.unassignCoach.push(i.property.actions.unassignCoach.enabled);l.executeStatusTransition.push(i.property.actions.executeStatusTransition.enabled);l.followUp.push(!b);l.reassignCampaign.push(i.property.actions.reassignCampaign.enabled);var s=i.property.actions.executeStatusTransition.customProperties.statusTransitions.map(function(t){return t.STATUS_ACTION_CODE;});l.transitions=l.transitions.filter(function(c){return s.indexOf(c)!==-1;});l.changeAuthor=l.changeAuthor&&l.authors[l.authors.length-1]===l.authors[0];l.merge.push(i.property.actions.mergeIdeas.enabled);return l;}else{return{ideas:[i.ID],campaigns:[i.CAMPAIGN_ID],phases:[i.PHASE],status:[i.STATUS],respValueCode:[i.RESP_VALUE_CODE],addExpert:[i.property.actions.addExpert.enabled],assignTag:[i.property.actions.assignTag.enabled],assignCoach:[i.property.actions.assignCoach.enabled],assignToMe:[i.property.actions.assignToMe.enabled],unassignCoach:[i.property.actions.unassignCoach.enabled],reassignCampaign:[i.property.actions.reassignCampaign.enabled],executeStatusTransition:[i.property.actions.executeStatusTransition.enabled],followUp:[!b],transitions:i.property.actions.executeStatusTransition.customProperties.statusTransitions.map(function(t){return t.STATUS_ACTION_CODE;}),authors:[i.SUBMITTER_ID],changeAuthor:i.SUBMITTER_ID!==0,merge:[i.property.actions.mergeIdeas.enabled]};}},null);};B._resetMassActionState=function(){var t=this;if(this._oSelectionMap){jQuery.each(this._oSelectionMap,function(i,o){if(o.oSource&&o.oSource.setSelected){o.oSource.setSelected(false);}});}this._oSelectionMap={};this._oDeselectionMap={};this.setViewProperty("/List/SELECT_ALL",false);var b=["sapInoMassAddExpertBtn","sapInoMassAssignBtn","sapInoMassStatusBtn","sapInoMassFollowUpBtn","sapInoMassDeleteRewardBtn","sapInoMassDeleteEvalReqBtn","sapInoMassAcceptBtn","sapInoMassRejectBtn","sapInoMassFowardBtn","sapInoMassCreateEvalBtn","sapInoMassExportBtn","sapInoMassChangeAuthorBtn","sapInoMassMergeBtn"];jQuery.each(b,function(i,e){var o=t.byId(e);if(o){o.setEnabled(false);}if(e==="sapInoMassExportBtn"&&t.getViewProperty("/List/EXPORT_ALL")){o.setEnabled(true);}});};B._refreshMassActionState=function(){jQuery.each(this._oSelectionMap,function(i,o){if(o.oSource){}});if(this._resetMassActionState){this._resetMassActionState();}};B._deriveMassActionButtonEnabledStatus=function(){var A=this._computeActionAggregations();var _=function(v){return!!v;};var b=this.byId("sapInoMassAddExpertBtn");if(b){b.setEnabled(!!A&&(A.addExpert.every(_)&&A.campaigns.length===1));}var o=this.byId("sapInoMassAssignBtn");if(o){o.setEnabled(!!A&&(A.assignToMe.every(_)||A.unassignCoach.every(_)||A.assignTag.every(_)||(A.assignCoach.every(_)&&A.campaigns.length===1)||(A.addExpert.every(_)&&A.campaigns.length===1)||(A.reassignCampaign.every(_)&&A.campaigns.length===1)));}var c=this.byId("sapInoMassStatusBtn");if(c){c.setEnabled(!!A&&A.campaigns.length===1&&A.phases.length===1&&A.status.length===1&&A.executeStatusTransition.every(_));}var d=this.byId("sapInoMassFollowUpBtn");if(d){d.setEnabled(!!A&&A.ideas.length>0&&A.followUp.every(_));}var e=this.byId("sapInoMassExportBtn");if(e){e.setEnabled(!!A&&A.ideas.length>0);if(!this.getModel("component").getProperty("/SHOW_BACKOFFICE")){e.setEnabled(true);}}var f=this.byId("sapInoMassChangeAuthorBtn");if(f){f.setEnabled(!!A&&A.changeAuthor);}var g=this.byId("sapInoMassMergeBtn");if(g){var C=this._oClipboardModel?this._oClipboardModel.getObjectKeys(I):[];var t=0;if(A){t=A.ideas.length+C.length;g.setEnabled(!!A&&t>1&&t<=10&&A.merge.every(_));}else{g.setEnabled(C.length>1&&C.length<=10);}}};B.onManagedListSelectionChange=function(e){var t=this;var s=e.getParameter("selected");var S=e.getSource();var d=S.getBindingContext("data").getObject();function b(c){var f=c.getSource().getData();d.property=f;t._oSelectionMap[d.ID]=d;t._oSelectionMap[d.ID].oSource=S;t._deriveMassActionButtonEnabledStatus.call(t);}if(s){var o={actions:["addExpert","assignTag","assignCoach","assignToMe","unassignCoach","executeStatusTransition","reassignCampaign","mergeIdeas"]};var p=new P("sap.ino.xs.object.idea.Idea",d.ID,o,false,b);if(this.getViewProperty("/List/SELECT_ALL")){delete this._oDeselectionMap[d.ID];}}else{delete this._oSelectionMap[d.ID];if(this.getViewProperty("/List/SELECT_ALL")){this._oDeselectionMap[d.ID]=d.ID;}this._deriveMassActionButtonEnabledStatus();}S.setTooltip(s?this.getText('IDEA_LIST_CHECKBOX_DESELECT_TOOLTIP'):this.getText('IDEA_LIST_CHECKBOX_SELECT_TOOLTIP'));};B.onFlatListSelectionChange=function(e){var s=e.getParameter("selected");var S=e.getSource();var d=S.getBindingContext("data").getObject();if(s){this._oSelectionMap[d.ID]=d;this._oSelectionMap[d.ID].oSource=S;if(this.getViewProperty("/List/SELECT_ALL")){delete this._oDeselectionMap[d.ID];}}else{delete this._oSelectionMap[d.ID];if(this.getViewProperty("/List/SELECT_ALL")){this._oDeselectionMap[d.ID]=d.ID;}}var b=this.byId("sapInoMassExportBtn");if(b){b.setEnabled(!jQuery.isEmptyObject(this._oSelectionMap));}S.setTooltip(s?this.getText('IDEA_LIST_CHECKBOX_DESELECT_TOOLTIP'):this.getText('IDEA_LIST_CHECKBOX_SELECT_TOOLTIP'));};B.onMassIdeaSelect=function(i,s,g){var b=this.getList().getItems();if(Object.prototype.toString.call(i)==="[object Array]"){b=i;this.setViewProperty("/List/SELECT_ALL",s);}else{this.setViewProperty("/List/SELECT_ALL",!this.getViewProperty("/List/SELECT_ALL"));}var t=this;var o=this.byId("sapInoMassExportBtn");if(this.getViewProperty("/List/SELECT_ALL")){o.setEnabled(true);jQuery.each(b,function(c,d){var A=d.findAggregatedObjects(false,function(h){return(h instanceof sap.ui.layout.VerticalLayout);});var e=A[0].getContent()[0];var f=e.getItems()[e.getItems().length-1];var C=f.getItems()[f.getItems().length-1].getItems()[0];var D=d.getBindingContext("data").getObject();if(t.getViewProperty("/List/MANAGE")){D.property=t._createPropertyData(d);}t._oSelectionMap[D.ID]=D;t._oSelectionMap[D.ID].oSource=C;});}else if(!g){t._oSelectionMap={};}if(this.getViewProperty("/List/MANAGE")){this._deriveMassActionButtonEnabledStatus();}};B._createPropertyData=function(i){var p={actions:{addExpert:{},assignCoach:{},assignTag:{},assignToMe:{},executeStatusTransition:{customProperties:{statusTransitions:[]}},reassignCampaign:{},unassignCoach:{},mergeIdeas:{}}};var s;if(i.getBindingContext){s=i.getBindingContext("data").getProperty("STATUS");}else{s=i.STATUS;}p.actions.addExpert.enabled=!O.isFinal(s);p.actions.assignCoach.enabled=!O.isFinal(s);p.actions.assignTag.enabled=!O.isFinal(s);p.actions.assignToMe.enabled=!O.isFinal(s);p.actions.unassignCoach.enabled=!O.isFinal(s);p.actions.executeStatusTransition.enabled=!O.isFinal(s);p.actions.mergeIdeas.enabled=!O.isMerged(s)&&!O.isFinal(s);return p;};B.formatMergeBtnEnable=function(c){c=c||[];var i=c.filter(function(C){return C.name==="sap.ino.commons.models.object.Idea";});var t=0;if(i.length>0){t=i[0].entry.length+Object.keys(this._oSelectionMap||{}).length;}else{t=Object.keys(this._oSelectionMap||{}).length;}return t>1&&t<=10;};B.formatIdeaCheckBoxTooltip=function(s){return s?this.getText('IDEA_LIST_CHECKBOX_DESELECT_TOOLTIP'):this.getText('IDEA_LIST_CHECKBOX_SELECT_TOOLTIP');};return B;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.ChangeAuthorActionMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.ChangeAuthorActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/idea/mixins/ChangeAuthorActionMixin",["sap/ino/vc/idea/mixins/BaseActionMixin","sap/ino/vc/commons/BaseObjectController","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/Idea"],function(B,a,J,M,F,b,c,C){"use strict";var d=jQuery.extend({},B);var f=function(r){if(this._oChangeAuthorConfirmDialog&&this._oChangeAuthorConfirmDialog.isOpen()){this._oChangeAuthorConfirmDialog.close();}var t=this;a.prototype.executeObjectAction.call(this,"changeAuthorStatic",{messages:{success:function(){if(typeof t.getObjectModel==="function"){t.setBusy(true);t.getObjectModel().sync();t.getObjectModel().getDataInitializedPromise().always(function(){t.setBusy(false);});}else if(typeof t.bindList==="function"){t.bindList();}M.show(t.getText("OBJECT_MSG_AUTHOR_CHANGE_SUCCESS"),{autoClose:false});},error:function(R){if(R.MESSAGES&&R.MESSAGES.length>0){M.show(t.getText(R.MESSAGES[0].MESSAGE_TEXT,R.MESSAGES[0].PARAMETERS),{autoClose:false});}}},staticparameters:r,objectModelExt:jQuery.sap.getObject("sap.ino.commons.models.object.Idea",0)});};var g=function(){if(typeof this.getObjectModel==="function"){return[this.getObjectModel().getProperty("/ID")];}else{return Object.keys(this._oSelectionMap);}};var G=function(){var i;if(typeof this.getObjectModel==="function"){i=this.getObjectModel().getData();return{"ID":i.CREATED_BY_ID,"NAME":i.CREATED_BY_NAME};}else{i=this._oSelectionMap[Object.keys(this._oSelectionMap)[0]];return{"ID":i.SUBMITTER_ID,"NAME":i.SUBMITTER_NAME};}};var e=function(){if(typeof this.getObjectModel==="function"){return[this.getObjectModel().getProperty("/CAMPAIGN_ID")];}else{var h=[];Object.keys(this._oSelectionMap).forEach(function(k){if(h.indexOf(this._oSelectionMap[k].CAMPAIGN_ID)>-1){return;}h.push(this._oSelectionMap[k].CAMPAIGN_ID);}.bind(this));return h;}};d.onChangeAuthorSearch=function(E){this.bindAuthors(E.getSource(),E.getParameter("value"));};d.onChangeAuthor=function(){var D=this.getChangeAuthorDialog();this.bindAuthors(D);D.open();};d.onMassChangeAuthor=function(E){if(this.getViewProperty("/List/SELECT_ALL")){var o=this.getBindingParameter();var i=this._check4ManagingList();var s=this.getList().getBinding('items').sFilterParams;var t=this.getViewProperty("/List/TAGS");var h={};var j=[];t.forEach(function(l,m){if(!h[l.ROOTGROUPID]){h[l.ROOTGROUPID]=[];h[l.ROOTGROUPID].push(l.ID);j.push(l.ROOTGROUPID);}else{h[l.ROOTGROUPID].push(l.ID);}});var p={searchToken:o.SearchTerm||"",tagsToken:h[j[0]]?h[j[0]].join(","):"",tagsToken1:h[j[1]]?h[j[1]].join(","):"",tagsToken2:h[j[2]]?h[j[2]].join(","):"",tagsToken3:h[j[3]]?h[j[3]].join(","):"",tagsToken4:h[j[4]]?h[j[4]].join(","):"",filterName:o.VariantFilter||"",filterBackoffice:i?"1":"0",filterString:s||""};if(this.setQueryObjectIdeaformFilters){this.setQueryObjectIdeaformFilters(p);}if(this.getCampaignFormQuery){p.ideaFormId=this.getCampaignFormQuery()||"";}if(this.getSearchType){p.searchType=this.getSearchType();}if(this.setQueryObjectCompanyViewFilters){this.setQueryObjectCompanyViewFilters(p);}var k=this;var S=E.getSource();S.setEnabled(false);jQuery.ajax({url:C.getBackendRootURL()+"/sap/ino/xs/rest/common/select_all_ideas.xsjs",data:p,success:function(r){S.setEnabled(true);if(r.Ideas.length===0){c.show(k.getText("NO_IDEAS_AND_RELOAD_PAGE"),{icon:c.Icon.INFORMATION,actions:[sap.m.MessageBox.Action.OK],onClose:function(){k.bindList();}});return;}k._oSelectionMap={};jQuery.each(r.Ideas,function(I,D){if(!k._oDeselectionMap[D.ID]){D.property=k._createPropertyData(D);k._oSelectionMap[D.ID]=D;}});k._massChangeAuthor();},error:function(r){M.show(k.getText(r.responseJSON.messageKey));}});}else{this._massChangeAuthor();}};d._massChangeAuthor=function(){var D=this.getMassChangeAuthorDialog();this.bindAuthors(D);D.open();};d.onChangeAuthorConfirm=function(){var o=this._oChangeAuthorConfirmDialog.getModel("confirm").getData();var O=G.call(this);var i=g.call(this);var r={"ORIGIN_AUTHOR_ID":O.ID,"AUTHOR_ID":o.newAuthorID,"Reward":o.changeReward||false,"Selfevaluation":o.changeEval||false,"keys":i};f.call(this,r);};d.onChangeRewardAndEvluYes=function(){var o=this._oChangeAuthorConfirmDialog.getModel("confirm").getData();var O=G.call(this);var i=g.call(this);var r={"ORIGIN_AUTHOR_ID":O.ID,"AUTHOR_ID":o.newAuthorID,"Reward":o.REWARDCOUNT>0,"Selfevaluation":o.SELFEVALUATIONCOUNT>0,"keys":i};f.call(this,r);};d.onChangeRewardAndEvaluNO=function(){var o=this._oChangeAuthorConfirmDialog.getModel("confirm").getData();var O=G.call(this);var i=g.call(this);var r={"ORIGIN_AUTHOR_ID":O.ID,"AUTHOR_ID":o.newAuthorID,"Reward":false,"Selfevaluation":false,"keys":i};f.call(this,r);};d.getChangeAuthorDialog=function(){if(!this._oChangeAuthorDialog){var _=function(s){s._oList.setMode("SingleSelectLeft");s._oList.mEventRegistry.selectionChange=[];s._oDialog.setEndButton(s._getCancelButton());};this._oChangeAuthorDialog=this.createFragment("sap.ino.vc.idea.fragments.ChangeAuthor");this._oChangeAuthorDialog.attachConfirm(this.onChangeAuthorDialogOK,this);this.getView().addDependent(this._oChangeAuthorDialog);_(this._oChangeAuthorDialog);}return this._oChangeAuthorDialog;};d.getMassChangeAuthorDialog=function(){if(!this._oChangeAuthorDialog){var _=function(s){s._oList.setMode("SingleSelectLeft");s._oList.mEventRegistry.selectionChange=[];s._oDialog.setEndButton(s._getCancelButton());};this._oChangeAuthorDialog=this.createFragment("sap.ino.vc.idea.fragments.ChangeAuthor");this._oChangeAuthorDialog.attachConfirm(this.onMassChangeAuthorDialogOK,this);this._oChangeAuthorDialog.data("context","mass");this.getView().addDependent(this._oChangeAuthorDialog);_(this._oChangeAuthorDialog);}return this._oChangeAuthorDialog;};d.getChangeAuthorConfirmDialog=function(){if(!this._oChangeAuthorConfirmDialog){this._oChangeAuthorConfirmDialog=this.createFragment("sap.ino.vc.idea.fragments.ChangeAuthorConfirm");this.getView().addDependent(this._oChangeAuthorConfirmDialog);}return this._oChangeAuthorConfirmDialog;};d.onChangeAuthorDialogOK=function(E){var i=this.getObjectModel().getProperty("/ID");var s=E.getParameter("selectedItem");if(!s){return;}var o=s.getBindingContext("data").getObject();var t=this;this.getView().setBusy(true);this.getModel("data").read('/IdeaFull('+i+')/RewardSelfevaluationCount',{async:true,success:function(D){D.SELFEVALUATIONCOUNT=parseInt(D.SELFEVALUATIONCOUNT,10);D.REWARDCOUNT=parseInt(D.REWARDCOUNT,10);if(D.SELFEVALUATIONCOUNT>0||D.REWARDCOUNT>0){t.getView().setBusy(false);var h=t.getChangeAuthorConfirmDialog();h.setModel(new J({REWARDCOUNT:D.REWARDCOUNT,SELFEVALUATIONCOUNT:D.SELFEVALUATIONCOUNT,oldAuthor:t.getObjectModel().getProperty("/CREATED_BY_NAME"),newAuthor:o.NAME,newAuthorID:o.ID}),"confirm");h.open();}else{var I=t.getObjectModel();var r={"ORIGIN_AUTHOR_ID":I.getProperty("/CREATED_BY_ID"),"AUTHOR_ID":o.ID,"Reward":false,"Selfevaluation":false,"keys":[I.getProperty("/ID")]};f.call(t,r);}}});};d.onMassChangeAuthorDialogOK=function(E){var s=E.getParameter("selectedItem");if(!s){return;}var o=s.getBindingContext("data").getObject();var O=G.call(this);var t=this;var h=Object.keys(this._oSelectionMap).map(function(i){return new F({path:"ID",operator:b.EQ,value1:i});});var _=function(D){var r=0,S=0;D.some(function(i){if(i.REWARDCOUNT>0){r=1;}if(i.SELFEVALUATIONCOUNT>0){S=1;}if(r===1&&S===1){return true;}else{return false;}});return{"REWARDCOUNT":r,"SELFEVALUATIONCOUNT":S};};this.getView().setBusy(true);this.getModel("data").read('/IdeaRewardSelfevaluationCount',{async:true,filters:h,success:function(D){var p=_(D.results);if(p.SELFEVALUATIONCOUNT>0||p.REWARDCOUNT>0){t.getView().setBusy(false);var i=t.getChangeAuthorConfirmDialog();i.data("context","mass");i.setModel(new J({REWARDCOUNT:p.REWARDCOUNT,SELFEVALUATIONCOUNT:p.SELFEVALUATIONCOUNT,oldAuthor:O.NAME,newAuthor:o.NAME,newAuthorID:o.ID}),"confirm");i.open();}else{var r={"ORIGIN_AUTHOR_ID":O.ID,"AUTHOR_ID":o.ID,"Reward":false,"Selfevaluation":false,"keys":Object.keys(t._oSelectionMap)};f.call(t,r);}}});};d.bindAuthors=function(D,s){var h=e.call(this).join(",");s=s?jQuery.sap.encodeURL(s):"*";if(!/.*[\u4e00-\u9fa5]+.*$/.test(s)&&s.length<3){D.removeAllItems();return;}var o={path:"data>/SearchCampaignParticipantsParams(searchToken='"+s+"',campaignIdsToken='"+h+"')/Results",template:D.getBindingInfo("items").template};var O;if(D.data("context")==="mass"){O=G.call(this).ID;}else{O=this.getObjectModel().getProperty("/CREATED_BY_ID");}o.filters=[new F({path:"ID",operator:b.NE,value1:O})];D.bindAggregation("items",o);};d.handleAuthorSelect=function(E){var o=this.getChangeAuthorDialog().getModel("changedAuthor");var s=E.getParameter("selectedItem");o.setProperty("/ID",s.getKey());o.setProperty("/NAME",s.getText());};return d;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.ChangeDecisionMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.ChangeDecisionMixin');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.ListItem');sap.ui.define("sap/ino/vc/idea/mixins/ChangeDecisionMixin",["sap/ino/commons/models/object/Idea","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ino/commons/models/core/CodeModel","sap/ino/commons/formatters/ObjectFormatter","sap/ui/core/message/Message","sap/ui/core/MessageType","sap/ino/controls/IFrame","sap/ino/commons/application/Configuration","sap/ui/core/ListItem"],function(I,M,J,C,O,a,b,c,d,L){"use strict";var e=function(){throw"Mixin may not be instantiated directly";};e.onOpenChangeDecision=function(E){var D=this._getChangeDecisionDialog();var o=this.getObjectModel();this.resetClientMessages();var f=o.getProperty("/Decisions");var s=E.getSource();var g=s.getCustomData()[0].getValue();var S,h;for(var i=0;i<f.length;i++){if(g===f[i].ID){S=f[i];h=i;}}if(S){var j=jQuery.extend({},S);var k=new J(j);D.setModel(k,"decision");if(S.DECISION_REASON_LIST_CODE){var l="sap.ino.xs.object.basis.ValueOptionList.ValueOptions";var r=C.getCodes(l,function(m){return m.LIST_CODE===S.DECISION_REASON_LIST_CODE&&m.ACTIVE===1;});}}k.setProperty("/reasonList",r);k.setProperty("/INDEX",h);k.setProperty("/SEND_RESPONSE",1);k.setProperty("/IS_DECISION_RELEVANT",true);D.open();};e._getChangeDecisionDialog=function(){var D=this._oChangeDecisionDialog;if(!D){D=this.createFragment("sap.ino.vc.idea.fragments.ChangeDecision",this.getView().getId());this.getView().addDependent(D);this._oChangeDecisionDialog=D;}return D;};e.onChangeDecisionDialogCancel=function(){var D=this._getChangeDecisionDialog();D.close();this.resetClientMessages();var o=D.getModel("decision");o.setData(null);this._oChangeDecisionDialog.destroy();this._oChangeDecisionDialog=undefined;};e.onChangeDecisionSuggestionUserSelected=function(E){var D=this._getChangeDecisionDialog();var o=D.getModel("decision");this.resetClientMessages();var i=E.getParameters().selectedItem;if(i){var f=parseInt(i.getProperty("key"),10);o.setProperty("/DECIDER_ID",f);}else{var u=d.getCurrentUser();o.setProperty("/DECIDER_ID",u.USER_ID);}};e.onChangeDecisionSuggestUser=function(E){var v=E.getParameter("suggestValue");var t=new L({text:"{data>NAME}",additionalText:"{data>USER_NAME}",key:"{data>ID}"});E.getSource().bindAggregation("suggestionItems",{path:"data>/SearchIdentity(searchToken='"+jQuery.sap.encodeURL(v)+"')/Results",template:t,parameters:{select:"searchToken,ID,NAME,USER_NAME"}});};e.onChangeDecisionDialogOK=function(){var D=this._getChangeDecisionDialog();var f=D.getModel("decision");var i=this.getObjectModel();var A;var t=this;if(f.getProperty("/SEND_RESPONSE")===0){f.setProperty("/RESPONSE","");}D.setBusy(true);if(!t.hasAnyClientErrorMessages()){A=I.changeDecision(i.getProperty("/ID"),f.getData());}if(A){A.fail(function(o){if(o.MESSAGES&&o.MESSAGES.length>0){M.show(t.getText(o.MESSAGES[0].MESSAGE_TEXT));}D.setBusy(false);});A.done(function(){var o=t.getModel("data");o.read("/IdeaDecision("+f.getProperty("/ID")+")",{success:function(r){D.setBusy(false);D.close();M.show(t.getText("OBJECT_MSG_DECISION_CHANGE_SUCCESS"));delete r.__metadata;i.setProperty("/Decisions/"+f.getProperty("/INDEX"),r);i.setProperty("/Decisions/"+f.getProperty("/INDEX")+"/DECISION_DATE",f.getProperty("/DECISION_DATE"));t._oChangeDecisionDialog.destroy();t._oChangeDecisionDialog=undefined;}});});}else{D.setBusy(false);}};e.onAddLinkChangeDecisionDialogCancel=function(){this.resetClientMessages();this._oLinkDialog.close();this._oLinkDialog.destroy();this._oLinkDialog=undefined;};e.onAddLinkChangeDecision=function(){var D=this.getLinkChangeDecisionDialog();D.setModel(new J({URL:"",LABEL:""}),"link");D.bindElement({path:"link>/"});this.resetClientMessages();D.open();};e.onAddLinkChangeDecisionDialogOK=function(){var D=this.getLinkChangeDecisionDialog();var m=D.getModel("link");var u=m.getProperty("/URL");var l=m.getProperty("/LABEL");this.resetClientMessages();var o=this.addLinkChangeDecision(u,l);if(o){this.setClientMessage(o,this.byId("URLChangeDecisionInput"));}else{this._oLinkDialog.close();this._oLinkDialog.destroy();this._oLinkDialog=undefined;}};e.addLinkChangeDecision=function(u,l){var m;var D=this._getChangeDecisionDialog().getModel("decision");u=u.trim();if(!u||u===""){m=new a({code:"IDEA_OBJECT_MSG_LINK_URL_NOT_ALLOWED",type:b.Error});return m;}if(u&&u.indexOf("http://")!==0&&u.indexOf("https://")!==0&&u.indexOf("mailto:")!==0){u="http://"+u;}if(!u||u===""||!jQuery.sap.validateUrl(u)){m=new a({code:"IDEA_OBJECT_MSG_LINK_URL_NOT_ALLOWED",type:b.Error});return m;}if(!l||l===""){l=null;}D.setProperty("/LINK_LABEL",l);D.setProperty("/LINK_URL",u);this.getLinkButtonChangeDecision().setVisible(false);};e.getLinkChangeDecisionDialog=function(){if(!this._oLinkDialog){this._oLinkDialog=this.createFragment("sap.ino.vc.idea.fragments.ChangeDecisionLink",this.getView().getId());this.getView().addDependent(this._oLinkDialog);this._oLinkDialog.setInitialFocus(this.createId("URLChangeDecisionInput"));}return this._oLinkDialog;};e.onEditLinkChangeDecision=function(){var D=this.getLinkChangeDecisionDialog();var o=this._getChangeDecisionDialog().getModel("decision");var u=o.getProperty("/LINK_URL");var l=o.getProperty("/LINK_LABEL");D.setModel(new J({URL:u,LABEL:l}),"link");D.bindElement({path:"link>/"});D.open();};e.onDeleteLinkChangeDecision=function(){var D=this._getChangeDecisionDialog().getModel("decision");D.setProperty("/LINK_LABEL","");D.setProperty("/LINK_URL","");this.getLinkButtonChangeDecision().setVisible(true);};e.getLinkButtonChangeDecision=function(){return this.byId("addLinkChangeDecision");};e.initLinkButtonChangeDecision=function(){this.byId("addLinkChangeDecision").setVisible(true);};e.onShowChangeDecisionMailPreview=function(E){var D=this._getChangeDecisionDialog();var o=D.getModel("decision");var t=o.getProperty("/RESPONSE");var u=navigator.language||navigator.userLanguage;var p={CONTENT:jQuery.sap.encodeHTML(t||""),IDEA:o.getProperty("/IDEA_ID"),ACTOR:o.getProperty("/DECIDER_ID"),LOCALE:u.split("-")[0],ACTION:o.getProperty("/STATUS_ACTION_CODE"),PHASE:o.getProperty("/PHASE_CODE"),STATUS:o.getProperty("/STATUS_CODE"),TEXT_CODE:o.getProperty("/TEXT_MODULE_CODE"),REASON:jQuery.sap.encodeHTML(o.getProperty("/REASON")||""),REASON_CODE:o.getProperty("/REASON_CODE"),LINK_LABEL:o.getProperty("/LINK_LABEL"),LINK_URL:o.getProperty("/LINK_URL")};var m=new J(d.getMailPreviewURL(p));if(!this._oChangeDecisionMailPreviewDialog){this._oChangeDecisionMailPreviewDialog=this.createFragment("sap.ino.vc.idea.fragments.ChangeDecisionMailPreviewDialog");this.getView().addDependent(this._oChangeDecisionMailPreviewDialog);}m.attachRequestCompleted(this.onMailTextLoad,this);};e.onMailTextLoad=function(E){var h=new c({content:E.getSource().getData().TEXT});this._oChangeDecisionMailPreviewDialog.addContent(h);this._oChangeDecisionMailPreviewDialog.open();};e.onChangeDecisionMailViewClose=function(){if(this._oChangeDecisionMailPreviewDialog){this._oChangeDecisionMailPreviewDialog.close();this._oChangeDecisionMailPreviewDialog.removeAllContent();}};e.onChangeDecisionMakerChange=function(E){var s=E.getSource();var v=s.getValue();var t=this,f;var S=typeof this.getChangeStatusDialog==="function"?this.getChangeStatusDialog().getModel("status"):undefined;var D=this._getChangeDecisionDialog().getModel("decision");var g=s.getAggregation("suggestionItems");if(g){for(var i=0;i<g.length;i++){if(v===g[i].getText()){f=parseInt(g[i].getProperty("key"),10);}else if(v===g[i].getAdditionalText()){f=parseInt(g[i].getProperty("key"),10);}if(f){if(S){S.setProperty("/DECIDER_ID",f);}if(D){D.setProperty("/DECIDER_ID",f);}break;}}}if(!f){t.resetClientMessages();t.setClientMessage(new a({code:"IDEA_OBJECT_MSG_DECISION_MAKER_VALUE_WRONG_INPUT",type:b.Error}),s);}else{t.resetClientMessages();}};return e;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.ChangeStatusActionMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.ChangeStatusActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/idea/mixins/ChangeStatusActionMixin",["sap/ino/vc/idea/mixins/BaseActionMixin","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Idea","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/models/types/IntBooleanType","sap/ui/core/message/Message","sap/ui/core/MessageType","sap/m/MessageToast","sap/ino/controls/IFrame","sap/ino/commons/application/Configuration","sap/ui/core/ListItem","sap/ino/commons/formatters/ObjectFormatter","sap/m/MessageBox"],function(B,J,I,P,a,M,b,c,d,C,L,O,e){"use strict";var f=jQuery.extend({},B);f.ChangeStatusMixinData={aIdeaIds:[],iIdeaId:null,oPropertyModel:undefined};f.reasonCodeExist=function(r){return(r&&r!==''?true:false);};f.formatter=O;f.onChangeStatus=function(E){var D=this.getChangeStatusDialog();D.data("context","single");var i=this.getObjectModel();this.ChangeStatusMixinData.iIdeaId=i.getProperty("/ID");this.ChangeStatusMixinData.bIdeaPhaseNeedReward=i.getProperty("/IDEA_PHASE_NEED_REWARD");this.ChangeStatusMixinData.bHasIncompletedEvalReq=i.getProperty("/IDEA_HAS_INCOMPLETED_EVAL_REQ");this.ChangeStatusMixinData.bRewardDismissed=i.getProperty("/REWARD_DISMISSED");this.ChangeStatusMixinData.oPropertyModel=i.getPropertyModel();var s=this.ChangeStatusMixinData.oPropertyModel.getProperty("/actions/executeStatusTransition/customProperties/statusTransitions/0/STATUS_ACTION_CODE");this.bindStatusModel(s);this.initLinkButton();D.open();};f.onChangeStatusInList=function(E){this.saveCurrentFocusBeforeActionDialogOpen();var s=E.getSource();var D=this.getChangeStatusDialog();D.data("context","single");this.ChangeStatusMixinData.iIdeaId=s.getBindingContext("data").getProperty("ID");this.ChangeStatusMixinData.iCampaignId=s.getBindingContext("data").getProperty("CAMPAIGN_ID");this.ChangeStatusMixinData.sPhase=s.getBindingContext("data").getProperty("PHASE");this.ChangeStatusMixinData.bIdeaPhaseNeedReward=s.getBindingContext("data").getProperty("IDEA_PHASE_NEED_REWARD");this.ChangeStatusMixinData.bHasIncompletedEvalReq=s.getBindingContext("data").getProperty("IDEA_HAS_INCOMPLETED_EVAL_REQ");this.ChangeStatusMixinData.bRewardDismissed=s.getBindingContext("data").getProperty("REWARD_DISMISSED");var S={actions:["executeStatusTransition"]};this.ChangeStatusMixinData.oPropertyModel=new P("sap.ino.xs.object.idea.Idea",this.ChangeStatusMixinData.iIdeaId,S,false,function(){var i=this.ChangeStatusMixinData.oPropertyModel.getProperty("/actions/executeStatusTransition/customProperties/statusTransitions/0/STATUS_ACTION_CODE");this.bindStatusModel(i);D.open();}.bind(this,arguments));};f.onMassChangeStatus=function(E){if(this.getViewProperty("/List/SELECT_ALL")){var o=this.getBindingParameter();var i=this._check4ManagingList();var F=this.getList().getBinding('items').sFilterParams;var t=this.getViewProperty("/List/TAGS");var g={};var h=[];t.forEach(function(l,m){if(!g[l.ROOTGROUPID]){g[l.ROOTGROUPID]=[];g[l.ROOTGROUPID].push(l.ID);h.push(l.ROOTGROUPID);}else{g[l.ROOTGROUPID].push(l.ID);}});var p={searchToken:o.SearchTerm||"",tagsToken:g[h[0]]?g[h[0]].join(","):"",tagsToken1:g[h[1]]?g[h[1]].join(","):"",tagsToken2:g[h[2]]?g[h[2]].join(","):"",tagsToken3:g[h[3]]?g[h[3]].join(","):"",tagsToken4:g[h[4]]?g[h[4]].join(","):"",filterName:o.VariantFilter||"",filterBackoffice:i?"1":"0",filterString:F||""};if(this.setQueryObjectIdeaformFilters){this.setQueryObjectIdeaformFilters(p);}if(this.getCampaignFormQuery){p.ideaFormId=this.getCampaignFormQuery()||"";}if(this.getSearchType){p.searchType=this.getSearchType();}if(this.setQueryObjectCompanyViewFilters){this.setQueryObjectCompanyViewFilters(p);}var j=this;var k=jQuery.extend({},E);var s=E.getSource();s.setEnabled(false);jQuery.ajax({url:C.getBackendRootURL()+"/sap/ino/xs/rest/common/select_all_ideas.xsjs",data:p,success:function(r){s.setEnabled(true);if(r.Ideas.length===0){e.show(j.getText("NO_IDEAS_AND_RELOAD_PAGE"),{icon:e.Icon.INFORMATION,actions:[sap.m.MessageBox.Action.OK],onClose:function(){j.bindList();}});return;}j._oSelectionMap={};jQuery.each(r.Ideas,function(l,D){if(!j._oDeselectionMap[D.ID]){D.property=j._createPropertyData(D);j._oSelectionMap[D.ID]=D;}});j._onMassChangeStatus(k);},error:function(r){c.show(j.getText(r.responseJSON.messageKey));}});}else{this._onMassChangeStatus(E);}};f._onMassChangeStatus=function(E){var D=this.getChangeStatusDialog();D.data("context","mass");this.ChangeStatusMixinData.aIdeaIds=jQuery.map(this._oSelectionMap,function(i){return i.ID;});this.ChangeStatusMixinData.iIdeaId=this.ChangeStatusMixinData.aIdeaIds[0];var s={actions:["executeStatusTransition"]};this.ChangeStatusMixinData.oPropertyModel=new P("sap.ino.xs.object.idea.Idea",this.ChangeStatusMixinData.iIdeaId,s,false,function(){var i=this.ChangeStatusMixinData.oPropertyModel.getProperty("/actions/executeStatusTransition/customProperties/statusTransitions/0/STATUS_ACTION_CODE");this.bindStatusModel(i);D.open();}.bind(this,arguments));};f.bindStatusModel=function(s){var S=I.executeStatusTransitionModel(this.ChangeStatusMixinData.oPropertyModel,s);var D=this.getChangeStatusDialog();D.setModel(this.ChangeStatusMixinData.oPropertyModel,"property");D.setModel(S,"status");return S;};f.isIdeaPhaseNeedReward=function(){var D=this.getChangeStatusDialog();var s=D.getModel("status");if(this.ChangeStatusMixinData.bIdeaPhaseNeedReward&&s.getProperty("/REWARD_ACTIVE")&&!this.ChangeStatusMixinData.bRewardDismissed){return true;}return false;};f.isIdeaHasEvalReq=function(){if(this.ChangeStatusMixinData.bHasIncompletedEvalReq&&C.getSystemSetting("sap.ino.config.EVAL_REQ_ACTIVE")){return true;}return false;};f.getChangeStatusDialog=function(){if(!this._oChangeStatusDialog){this._oChangeStatusDialog=this.createFragment("sap.ino.vc.idea.fragments.ChangeStatus");this.getView().addDependent(this._oChangeStatusDialog);}return this._oChangeStatusDialog;};f.onChangeStatusSuggestUser=function(E){var v=E.getParameter("suggestValue");var t=new L({text:"{data>NAME}",additionalText:"{data>USER_NAME}",key:"{data>ID}"});E.getSource().bindAggregation("suggestionItems",{path:"data>/SearchIdentity(searchToken='"+jQuery.sap.encodeURL(v)+"')/Results",template:t,parameters:{select:"searchToken,ID,NAME,USER_NAME"}});};f.onStatusActionChanged=function(E){var s=E.getSource().getSelectedKey();this.resetClientMessages();this.clearClientMessages();this.initLinkButton();this.bindStatusModel(s);};f.onChangeStatusDialogOK=function(E){var D=this.getChangeStatusDialog();var s=D.getModel("status");var g=s.getData('data');var t=this;var A;function h(){D.setBusy(true);if(D.data("context")==="mass"){if(!t.hasAnyClientErrorMessages()){A=I.massExecuteStatusTransition(jQuery.extend({},s.getData(),{keys:t.ChangeStatusMixinData.aIdeaIds}));}}else{if(t.isActionContextSingleIdeaDisplay()){var l=t.getObjectModel();if(!t.hasAnyClientErrorMessages()){A=l.executeStatusTransition(s.getData(),true);}}else{if(!t.hasAnyClientErrorMessages()){A=I.executeStatusTransition(t.ChangeStatusMixinData.iIdeaId,s.getData());}}}if(A){A.fail(function(o){if(o.MESSAGES&&o.MESSAGES.length>0){c.show(t.getText(o.MESSAGES[0].MESSAGE_TEXT));}});A.done(function(){t.restoreFocusAfterActionDialogClose();if(typeof t.bindList==="function"){t.bindList();}D.close();c.show(t.getText("OBJECT_MSG_STATUS_CHANGE_SUCCESS"));t._oChangeStatusDialog.destroy();t._oChangeStatusDialog=undefined;});A.always(function(){D.setBusy(false);});}else{D.setBusy(false);}}var i=this.isIdeaPhaseNeedReward();var j=this.isIdeaHasEvalReq();var k;if(i&&j){k=this.getText("OBJECT_MSG_STATUS_CHANGE_DOUBLE_CONFIRMATION");}else if(i){k=this.getText("OBJECT_MSG_STATUS_CHANGE_CONFIRMATION");}else if(j){k=this.getText("OBJECT_MSG_STATUS_CHANGE_EVAL_CONFIRMATION");}if((i||j)&&g.STATUS_ACTION_CODE==="sap.ino.config.START_NEXT_PHASE"){e.confirm(k,{title:this.getText("IDEA_OBJECT_TIT_STATUS_CHANGE_CONFIRMATION"),icon:e.Icon.NONE,onClose:function(r){if(r==="OK"){h();}else{t.onChangeStatusDialogCancel();}}});}else{h();}};f.onChangeStatusDialogCancel=function(E){var D=this.getChangeStatusDialog();if(this.resetInputTypeValidations){this.resetInputTypeValidations(D);}this.restoreFocusAfterActionDialogClose();this._oChangeStatusDialog.close();this._oChangeStatusDialog.destroy();this._oChangeStatusDialog=undefined;};f.onAfterChangeStatusDialogClose=function(E){};f.onShowMailPreview=function(E){var D=this.getChangeStatusDialog();var s=D.getModel("status");var t={CAMPAIGN_ID:this.ChangeStatusMixinData.iCampaignId,PHASE:this.ChangeStatusMixinData.sPhase,STATUS_ACTION_CODE:s.getProperty("/STATUS_ACTION_CODE"),NEXT_STATUS_CODE:s.getProperty("/NEXT_STATUS_CODE")};var o=this.getObjectModel&&this.getObjectModel();if(o){t.CAMPAIGN_ID=o.getProperty("/CAMPAIGN_ID");t.PHASE=o.getProperty("/PHASE");t.STATUS_CODE=o.getProperty("/STATUS_CODE");}var T=new J(C.getTextMoudleURL(t));T.attachRequestCompleted(null,function(){var g=s.getProperty("/RESPONSE");var u=this.getModel("user").getData().data.LOCALE;var p={CONTENT:jQuery.sap.encodeHTML(g||""),IDEA:this.ChangeStatusMixinData.iIdeaId,DECIDER:s.getProperty("/DECIDER_ID"),ACTOR:C.getCurrentUser().USER_ID,LOCALE:u,ACTION:s.getProperty("/STATUS_ACTION_CODE"),PHASE:s.getProperty("/NEXT_PHASE_CODE"),STATUS:s.getProperty("/NEXT_STATUS_CODE"),TEXT_CODE:!T.getData()[0]?"null":T.getData()[0].TEXT_MODULE_CODE,REASON:jQuery.sap.encodeHTML(s.getProperty("/REASON")||""),REASON_CODE:s.getProperty("/REASON_CODE"),LINK_LABEL:s.getProperty("/LINK_LABEL"),LINK_URL:s.getProperty("/LINK_URL")};var m=new J(C.getMailPreviewURL(p));if(!this._oMailPreviewDialog){this._oMailPreviewDialog=this.createFragment("sap.ino.vc.idea.fragments.MailPreviewDialog");this.getView().addDependent(this._oMailPreviewDialog);}m.attachRequestCompleted(this.onMailTextLoaded,this);},this);};f.onMailTextLoaded=function(E){var h=new d({content:E.getSource().getData().TEXT});this._oMailPreviewDialog.addContent(h);this._oMailPreviewDialog.open();};f.onMailViewClose=function(){if(this._oMailPreviewDialog){this._oMailPreviewDialog.close();this._oMailPreviewDialog.removeAllContent();}};f.onChangeStatusSuggestionUserSelected=function(E){var D=this.getChangeStatusDialog();var s=D.getModel("status");this.resetClientMessages();var i=E.getParameters().selectedItem;if(i){var g=parseInt(i.getProperty("key"),10);s.setProperty("/DECIDER_ID",g);}else{var u=C.getCurrentUser();s.setProperty("/DECIDER_ID",u.USER_ID);}};f.onAddLinkDialogCancel=function(){this.resetClientMessages();this._oLinkDialog.close();this._oLinkDialog.destroy();this._oLinkDialog=undefined;};f.onAddLink=function(){var D=this.getLinkDialog();D.setModel(new J({URL:"",LABEL:""}),"link");D.bindElement({path:"link>/"});this.resetClientMessages();D.open();};f.onAddLinkDialogOK=function(){var D=this.getLinkDialog();var m=D.getModel("link");var u=m.getProperty("/URL");var l=m.getProperty("/LABEL");this.resetClientMessages();var o=this.addLink(u,l);if(o){this.setClientMessage(o,this.byId("URLInput"));}else{this._oLinkDialog.close();this._oLinkDialog.destroy();this._oLinkDialog=undefined;}};f.addLink=function(u,l){var m;var s=this.getChangeStatusDialog().getModel("status");u=u.trim();if(!u||u===""){m=new M({code:"IDEA_OBJECT_MSG_LINK_URL_NOT_ALLOWED",type:b.Error});return m;}if(u&&u.indexOf("http://")!==0&&u.indexOf("https://")!==0&&u.indexOf("mailto:")!==0){u="http://"+u;}if(!u||u===""||!jQuery.sap.validateUrl(u)){m=new M({code:"IDEA_OBJECT_MSG_LINK_URL_NOT_ALLOWED",type:b.Error});return m;}if(!l||l===""){l=null;}s.setProperty("/LINK_LABEL",l);s.setProperty("/LINK_URL",u);this.getLinkButton().setVisible(false);};f.getLinkDialog=function(){if(!this._oLinkDialog){this._oLinkDialog=this.createFragment("sap.ino.vc.idea.fragments.Link",this.getView().getId());this.getView().addDependent(this._oLinkDialog);this._oLinkDialog.setInitialFocus(this.createId("URLInput"));}return this._oLinkDialog;};f.onEditLink=function(){var D=this.getLinkDialog();var s=this.getChangeStatusDialog().getModel("status");var u=s.getProperty("/LINK_URL");var l=s.getProperty("/LINK_LABEL");D.setModel(new J({URL:u,LABEL:l}),"link");D.bindElement({path:"link>/"});D.open();};f.onDeleteLink=function(){var s=this.getChangeStatusDialog().getModel("status");s.setProperty("/LINK_LABEL","");s.setProperty("/LINK_URL","");this.getLinkButton().setVisible(true);};f.getLinkButton=function(){return this.byId("addLink");};f.initLinkButton=function(){this.byId("addLink").setVisible(true);};f.clearClientMessages=function(){var m=new sap.ui.getCore().getMessageManager();var g=m.getMessageModel().getData();var t=[];jQuery.each(g,function(i,o){if(o.target.indexOf("responseRequireTextArea")>-1||o.target.indexOf("responseRequireTextAreaDecision")>-1){t.push(o);}});m.removeMessages(t);};f.onChangeStatusMakerChange=function(E){var s=E.getSource();var v=s.getValue();var t=this,g;var S=this.getChangeStatusDialog().getModel("status");var D=typeof this._getChangeDecisionDialog==="function"?this._getChangeDecisionDialog().getModel("decision"):undefined;var h=s.getAggregation("suggestionItems");if(h){for(var i=0;i<h.length;i++){if(v===h[i].getText()){g=parseInt(h[i].getProperty("key"),10);}else if(v===h[i].getAdditionalText()){g=parseInt(h[i].getProperty("key"),10);}if(g){if(S){S.setProperty("/DECIDER_ID",g);}if(D){D.setProperty("/DECIDER_ID",g);}break;}}}if(!g){t.resetClientMessages();t.setClientMessage(new M({code:"IDEA_OBJECT_MSG_DECISION_MAKER_VALUE_WRONG_INPUT",type:b.Error}),s);}else{t.resetClientMessages();}};return f;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.CreateRewardActionMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.CreateRewardActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/idea/mixins/CreateRewardActionMixin",["sap/ino/vc/idea/mixins/BaseActionMixin","sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Idea","sap/ino/commons/models/object/RewardList","sap/ino/commons/models/aof/PropertyModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/m/MessageToast"],function(B,a,J,I,R,P,F,b,S,M){"use strict";var C=jQuery.extend({},B);C.onCreateReward=function(e){var c=e.getSource().getCustomData();if(!c||c.length===0){return;}var p=this._parseCustomDatas(e);var d=this._createRewardDialog();this._getChildController(d).setDialog(d);var s={actions:["create","del","executeStatusTransition"],nodes:["Root"],invalidation:{entitySets:["IdeaFull"]},continuousUse:true,concurrencyEnabled:true,readSource:{model:this.getDefaultODataModel()}};var r=new R(p.oKey,s);this._getChildController(d).getView().setBusy(true);if(!p.oKey.hasOwnProperty("IDEA_ID")){var t=this;r.getDataInitializedPromise().done(function(){t._getChildController(d).getView().setBusy(false);});}else{this._handleIdeaInfo(d,r,p.oKey.IDEA_ID);}this._setDefaultValue(r,p);d.setModel(r,"object");d.open();};C.onDismissReward=function(e){var c=e.getSource().getCustomData();if(!c||c.length===0){return;}var p=this._parseCustomDatas(e);if(p.oKey.IDEA_ID){var o=this;var r=I.dismissReward(p.oKey.IDEA_ID);r.done(function(){var d=o.getList().getBindingInfo("items");o.getList().bindItems(d);});}};C._createRewardDialog=function(){var r=this.createFragment("sap.ino.vc.idea.fragments.CreateRewardDialog",this.getView().getId());this.getView().addDependent(r);return r;};C._parseCustomDatas=function(e){var p={oKey:null,IdeaPhaseCode:null,IdeaName:null,UnitCode:null,UnitText:null};var c=e.getSource().getCustomData();jQuery.each(c,function(i,d){var k=d.getKey();var v=d.getValue();if(k==="IdeaId"){p.oKey={IDEA_ID:d.getValue(),OBJECT_TYPE_CODE:"IDEA",OBJECT_ID:d.getValue()};}else if(k==="RewardListId"){p.oKey=v;}else if(p.hasOwnProperty(k)){p[k]=v;}});return p;};C._setDefaultValue=function(r,p){if(typeof p.oKey!=="object"){return;}r.setProperty("/IDEA_NAME",p.IdeaName);r.setProperty("/IDEA_PHASE_CODE",p.IdeaPhaseCode);r.setProperty("/REWARD_UNIT_CODE",p.UnitCode);r.setProperty("/REWARD_UNIT_TEXT",p.UnitText);};C._getChildController=function(d){return d.getContent()[0].getController();};C._handleIdeaInfo=function(d,r,n){var t=this;r.getReadSourceModel().read("/IdeaFull("+n+")/ContributionShare",{success:function(o){var c=[];jQuery.each(o.results||[],function(i,e){c.push({ID:r.getNextHandle(),AUTHOR_ID:e.AUTHOR_ID,REWARD_AMOUNT:e.REWARD_AMOUNT,REWARD_SHARE:e.REWARD_SHARE,CONTRIBUTION_SHARE:e.PERCENTAGE,IDEA_ID:e.IDEA_ID,EMPLOYEE_NAME:e.AUTHOR_NAME});});t._setIdeaDetails(r,n,c);t._getChildController(d).getView().setBusy(false);},error:function(){t._getChildController(d).getView().setBusy(false);}});};C._setIdeaDetails=function(r,n,o){r.setProperty("/IDEA_ID",n);r.setProperty("/Rewards",o);r.setProperty("/REWARD_AMOUNT_TOTAL",0);};return C;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.FollowUpFormatter')){jQuery.sap.declare('sap.ino.vc.idea.mixins.FollowUpFormatter');sap.ui.define("sap/ino/vc/idea/mixins/FollowUpFormatter",["sap/ino/commons/formatters/ObjectFormatter"],function(O){"use strict";var f=function(){};f.followUpRelativeDateText=function(k){if(k){return O.text.apply(this,["IDEA_OBJECT_FLD_FOLLOW_UP_ROW_"+k]);}};f.minDate=function(){var c=new Date();return new Date(c.getFullYear(),c.getMonth(),c.getDate());};f.followUpDateHeader=function(d){if(d){return O.toDate(d);}return O.text.apply(this,["IDEA_OBJECT_TIT_NO_FOLLOW_UP_DATE"]);};f.followUpDateHeaderColor=function(d){if(!d){return"false";}var c=new Date();var n=new Date(c.getFullYear(),c.getMonth(),c.getDate());if(n>d){return"true";}return"false";};f.followUpOkButtonEnabled=function(){var F=this.getView()&&this.getView()._oFollowUpDialog||this._oFollowUpMixinFollowUpDialog;if(F&&this.hasMessages){return!this.hasMessages(F);}return true;};return f;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.FollowUpMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.FollowUpMixin');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.core.Locale');sap.ui.define("sap/ino/vc/idea/mixins/FollowUpMixin",["sap/ino/vc/idea/mixins/BaseActionMixin","sap/ino/vc/commons/BaseController","sap/ui/core/format/DateFormat","sap/ino/commons/models/object/FollowUp","sap/ino/vc/idea/mixins/FollowUpFormatter","sap/ino/commons/formatters/BaseFormatter","sap/ino/commons/models/types/FollowUpRelativeDateType","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ino/commons/application/Configuration","sap/m/MessageBox","sap/ui/core/Locale"],function(B,a,D,F,b,c,d,J,M,C,e,L){"use strict";var _;var g=function(t){if(!_){if(t.getOwnerComponent){_=D.getDateInstance({pattern:"YYYY-MM-dd"},new L(t.getOwnerComponent().getModel("user").getProperty("/data/LOCALE")));}else{return D.getDateInstance({pattern:"YYYY-MM-dd"});}}return _;};var f=jQuery.extend({},B);f.followUpRelativeDateType=new d();f.followUpMixinFormatter=b;f.getFollowUpMixinFollowUpDialog=function(){if(!this._oFollowUpMixinFollowUpDialog){this._oFollowUpMixinFollowUpDialog=this.createFragment("sap.ino.vc.idea.fragments.FollowUp",this.getView().getId());this.getView().addDependent(this._oFollowUpMixinFollowUpDialog);this._oFollowUpMixinFollowUpDialog.setInitialFocus(this.createId("relativeDate"));}return this._oFollowUpMixinFollowUpDialog;};f.onFollowUpMixinFollowUp=function(E){var i,I,h,j;if(this.isActionContextSingleIdeaDisplay()){this.resetClientMessages();i=this.getObjectModel();I=i.getProperty("/ID");h=i.getProperty("/FOLLOW_UP_ID");j=i.getProperty("/FOLLOW_UP_DATE");}else{i=E.getSource().getBindingContext("data");I=i.getProperty("ID");h=i.getProperty("FOLLOW_UP_ID");j=i.getProperty("FOLLOW_UP_DATE");}var o=this.getFollowUpMixinFollowUpDialog();o.data("context","single");o.setModel(new J({"ID":I,"FOLLOW_UP_ID":h,"FOLLOW_UP_DATE":j,"FOLLOW_UP_RELATIVE_DATES":F.relativeDates}),"followUp");o.open();};f.onMassFollowUp=function(E){if(this.getViewProperty("/List/SELECT_ALL")){var o=this.getBindingParameter();var i=this._check4ManagingList();var s=this.getList().getBinding('items').sFilterParams;var t=this.getViewProperty("/List/TAGS");var h={};var j=[];t.forEach(function(l,m){if(!h[l.ROOTGROUPID]){h[l.ROOTGROUPID]=[];h[l.ROOTGROUPID].push(l.ID);j.push(l.ROOTGROUPID);}else{h[l.ROOTGROUPID].push(l.ID);}});var p={searchToken:o.SearchTerm||"",tagsToken:h[j[0]]?h[j[0]].join(","):"",tagsToken1:h[j[1]]?h[j[1]].join(","):"",tagsToken2:h[j[2]]?h[j[2]].join(","):"",tagsToken3:h[j[3]]?h[j[3]].join(","):"",tagsToken4:h[j[4]]?h[j[4]].join(","):"",filterName:o.VariantFilter||"",filterBackoffice:i?"1":"0",filterString:s||""};if(this.setQueryObjectIdeaformFilters){this.setQueryObjectIdeaformFilters(p);}if(this.getCampaignFormQuery){p.ideaFormId=this.getCampaignFormQuery()||"";}if(this.getSearchType){p.searchType=this.getSearchType();}if(this.setQueryObjectCompanyViewFilters){this.setQueryObjectCompanyViewFilters(p);}var k=this;var S=E.getSource();S.setEnabled(false);jQuery.ajax({url:C.getBackendRootURL()+"/sap/ino/xs/rest/common/select_all_ideas.xsjs",data:p,success:function(r){S.setEnabled(true);if(r.Ideas.length===0){e.show(k.getText("NO_IDEAS_AND_RELOAD_PAGE"),{icon:e.Icon.INFORMATION,actions:[sap.m.MessageBox.Action.OK],onClose:function(){k.bindList();}});return;}k._oSelectionMap={};jQuery.each(r.Ideas,function(I,l){if(!k._oDeselectionMap[l.ID]){l.property=k._createPropertyData(l);if(l.FOLLOW_UP_DATE){l.FOLLOW_UP_DATE=new Date(l.FOLLOW_UP_DATE);}k._oSelectionMap[l.ID]=l;}});k.onFollowUpMixinMassFollowUp();},error:function(r){M.show(k.getText(r.responseJSON.messageKey));}});}else{this.onFollowUpMixinMassFollowUp();}};f.onFollowUpMixinMassFollowUp=function(){var i=jQuery.map(this._oSelectionMap,function(I){return I.ID;});var h=jQuery.map(this._oSelectionMap,function(I){return I.FOLLOW_UP_DATE;}).reduce(function(p,v){if(p){return p;}else{return v;}},null);var o=this.getFollowUpMixinFollowUpDialog();o.data("context","mass");o.setModel(new J({"IDS":i,"ID":null,"FOLLOW_UP_ID":-1,"FOLLOW_UP_DATE":h,"FOLLOW_UP_RELATIVE_DATES":F.relativeDates}),"followUp");o.open();};f.onFollowUpMixinFollowUpDialogOK=function(E){var t=this;var o=this.getFollowUpMixinFollowUpDialog();o.setBusy(true);var h=o.getModel("followUp");var s=h.getProperty("/FOLLOW_UP_DATE")&&g(this).format(h.getProperty("/FOLLOW_UP_DATE"));if(o.data("context")==="mass"){var O={parameters:{ideaIds:h.getProperty("/IDS"),date:s},messages:{success:function(){o.close();return t.getText("OBJECT_MSG_FOLLOW_UP_SAVE_SUCCESS");},error:function(){return t.getText("OBJECT_MSG_FOLLOW_UP_SAVE_FAILED");}}};var m=a.prototype.executeObjectAction.call(this,F,"massModify",O);m.always(function(){o.setBusy(false);});}else{if(s){var i=F.modify(h.getProperty("/FOLLOW_UP_ID")||-1,{DATE:s,OBJECT_ID:h.getProperty("/ID"),OBJECT_TYPE_CODE:"IDEA"});i.done(function(){o.close();M.show(t.getText("OBJECT_MSG_FOLLOW_UP_SAVE_SUCCESS"));});i.fail(function(){M.show(t.getText("OBJECT_MSG_FOLLOW_UP_SAVE_FAILED"));});i.always(function(){o.setBusy(false);});}else{if(h.getProperty("/FOLLOW_UP_ID")){var j=F.del(h.getProperty("/FOLLOW_UP_ID"),{OBJECT_ID:h.getProperty("/ID")});j.done(function(){o.setModel(undefined,"followUp");o.close();M.show(t.getText("OBJECT_MSG_FOLLOW_UP_DEL_SUCCESS"));});j.fail(function(){M.show(t.getText("OBJECT_MSG_FOLLOW_UP_DEL_FAILED"));});j.always(function(){o.setBusy(false);});}else{o.setBusy(false);}}}};f.onFollowUpMixinFollowUpDialogDelete=function(E){var t=this;var o=this.getFollowUpMixinFollowUpDialog();o.setBusy(true);var h=o.getModel("followUp");var s=h&&h.getProperty("/FOLLOW_UP_ID");if(o.data("context")==="mass"){var O={parameters:{ideaIds:h.getProperty("/IDS"),date:null},messages:{success:function(){o.close();return t.getText("OBJECT_MSG_FOLLOW_UP_SAVE_SUCCESS");},error:function(){return t.getText("OBJECT_MSG_FOLLOW_UP_SAVE_FAILED");}}};var m=a.prototype.executeObjectAction.call(this,F,"massModify",O);m.always(function(){o.setBusy(false);});}else{if(s){var i=F.del(s,{OBJECT_ID:h.getProperty("/ID")});i.done(function(){o.close();M.show(t.getText("OBJECT_MSG_FOLLOW_UP_DEL_SUCCESS"));});i.fail(function(){M.show(t.getText("OBJECT_MSG_FOLLOW_UP_DEL_FAILED"));});i.always(function(){o.setBusy(false);});}else{o.setBusy(false);o.close();}}};f.onFollowUpMixinFollowUpDialogCancel=function(){var o=this.getFollowUpMixinFollowUpDialog();if(this.isActionContextSingleIdeaDisplay()){this.resetInputTypeValidations(o);}o.close();};f.onFollowUpMixinFollowUpAfterClose=function(E){var o=E.getSource();o.destroy();this._oFollowUpMixinFollowUpDialog=undefined;};return f;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.MarkAsReadActionMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.MarkAsReadActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.m.Token');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.core.BusyIndicator');sap.ui.define("sap/ino/vc/idea/mixins/MarkAsReadActionMixin",["sap/ino/vc/idea/mixins/BaseActionMixin","sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Idea","sap/ino/commons/models/aof/PropertyModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/m/MessageToast","sap/ui/Device","sap/ui/core/ListItem","sap/m/Token","sap/ino/commons/models/object/User","sap/ui/core/MessageType","sap/ui/core/message/Message","sap/m/MessageBox","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/IdeaLatest","sap/ui/core/BusyIndicator"],function(B,a,J,I,P,F,b,S,M,D,L,T,U,c,d,e,C,f,g){"use strict";var h=jQuery.extend({},B);var l={NEW_IDEAS:"SHOW_CREATED_VIEWER",NEW_UPDATES:"SHOW_UPDATED_VIEWER",NEW_STATUSES:"SHOW_STATUSCHANGE_VIEWER",NEW_COMMENTS:"SHOW_COMMENT_VIEWER"};h.onMassMarkAsRead=function(E){var s=E.getSource();if(this.getModel("markAsRead")){this.getModel("markAsRead").destroy();}var i=this.getViewProperty("/List/LATEST_UPDATE");var j=this.getList().getItems();var o={markAllRead:true,"NEW_UPDATES":true,"NEW_STATUSES":true,"NEW_COMMENTS":true};if(i&&i.length>0){jQuery.each(l,function(k,v){o[k]=i.indexOf(v)>-1?true:false;});o.markAllRead=false;}if(j.length===0){o={markAllRead:false,"NEW_UPDATES":false,"NEW_STATUSES":false,"NEW_COMMENTS":false};}var m=new J(o);this.setModel(m,"markAsRead");this._openMarkAsReadActionSheet(s);};h._openMarkAsReadActionSheet=function(s){if(!this._oMarkReadActionSheet){this._oMarkReadActionSheet=this.createFragment("sap.ino.vc.idea.fragments.MarkAsReadActionSheet",this.getView().getId());this.getView().addDependent(this._oMarkReadActionSheet);}jQuery.sap.delayedCall(0,this,function(){this._oMarkReadActionSheet.openBy(s);});};h.onMarkAllRead=function(E){this.onMarkAsReadCommon(E,'all');};h.onMarkCreatedRead=function(E){this.onMarkAsReadCommon(E,'created');};h.onMarkStatusRead=function(E){this.onMarkAsReadCommon(E,'status');};h.onMarkUpdatedRead=function(E){this.onMarkAsReadCommon(E,'updated');};h.onMarkCommentRead=function(E){this.onMarkAsReadCommon(E,'comment');};h.onMarkAsReadCommon=function(E,t){var i=[];switch(t){case'status':i.push("StatusChangeViewer");break;case'updated':i.push("UpdatedViewer");break;case'comment':i.push("CommentViewer");break;case'all':i=["CreatedViewer","UpdatedViewer","StatusChangeViewer","CommentViewer"];break;}var p=this._getFilterParameters();p.TYPE_CODE=i;var r=f.deleteViewerByObjectIdAndTypeCode(p);var j=this;g.show(0);r.done(function(R){M.show(j.getText("IDEA_OBJECT_MSG_MARK_AS_READ_SUCCESS"));g.hide();j.getIdeaFilterCount(j.getQuery());j.bindList();}).fail(function(R){M.show(j.getText("IDEA_OBJECT_MSG_MARK_AS_READ_FAIL"));});};h._getFilterParameters=function(){var o=this.getBindingParameter();var i=this._check4ManagingList();var s=this.getList().getBinding('items').sFilterParams;var j=this.getIdeaformFilters().replace(/\'/g,"").replace(/\"/g,"").split(",");var k=this.getCompanyViewFilters().replace(/\'/g,"").replace(/\"/g,"").split(",");var t=this.getViewProperty("/List/TAGS");var m={};var n=[];t.forEach(function(r,u){if(!m[r.ROOTGROUPID]){m[r.ROOTGROUPID]=[];m[r.ROOTGROUPID].push(r.ID);n.push(r.ROOTGROUPID);}else{m[r.ROOTGROUPID].push(r.ID);}});var p={searchToken:o.SearchTerm||"",tagsToken:m[n[0]]?m[n[0]].join(","):"",tagsToken1:m[n[1]]?m[n[1]].join(","):"",tagsToken2:m[n[2]]?m[n[2]].join(","):"",tagsToken3:m[n[3]]?m[n[3]].join(","):"",tagsToken4:m[n[4]]?m[n[4]].join(","):"",filterName:o.VariantFilter||"",filterBackoffice:i?"1":"0",c1:j[1].slice(3)||"",o1:j[2].slice(3)||-1,v1:unescape(j[3].slice(3))||"",c2:j[4].slice(3)||"",o2:j[5].slice(3)||-1,v2:unescape(j[6].slice(3))||"",c3:j[7].slice(3)||"",o3:j[8].slice(3)||-1,v3:unescape(j[9].slice(3))||"",cvy:k[3].slice(4)||0,cvr:k[2].slice(4)||0,cvt:decodeURIComponent(k[1].slice(4))||"",filterString:s||""};p.ideasId="";if(!i){var G=this.getGroupViewParameters(o);p.cvy=G.groupType;p.cvr=G.groupRole;p.cvt=G.groupToken;}else{p.searchType=this.getSearchType();}var q=p.filterString?(/\$filter=(.*)/gm.exec(s)[1]):"";p.filterString="$filter=("+q+")";return p;};h.onIdeaReadPress=function(E){var i=E.getSource();var o=i.getBindingContext("data");var p={},t=[];t=["CreatedViewer","UpdatedViewer","StatusChangeViewer","CommentViewer"];p.TYPE_CODE=t;p.IDEA_ID=o.getProperty("ID");var r=f.deleteViewerByObjectIdAndTypeCode(p);var j=this;r.done(function(R){M.show(j.getText("IDEA_OBJECT_MSG_MARK_AS_READ_SUCCESS"));j.getIdeaFilterCount(j.getQuery());j.bindList();}).fail(function(R){M.show(j.getText("IDEA_OBJECT_MSG_MARK_AS_READ_FAIL"));});};return h;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.MergeActionMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.MergeActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/idea/mixins/MergeActionMixin",["sap/ino/vc/idea/mixins/BaseActionMixin","sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/core/ClipboardModel","sap/ino/commons/models/core/ModelSynchronizer","sap/ino/commons/models/aof/PropertyModel",'sap/ino/commons/models/object/Idea',"sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/m/CheckBox","sap/m/MessageToast","sap/ino/commons/application/Configuration","sap/m/MessageBox","sap/ino/commons/models/object/MergeConfig","sap/ino/controls/IdeaStatusType"],function(B,a,J,C,M,P,I,F,b,S,c,d,e,f,g,h){"use strict";var j=jQuery.extend({},B);j.onIdeaMerge=function(E){var D,i,n,k,o,m;var s=E.getSource();if(this.isActionContextSingleIdeaDisplay()){i=this.getObjectModel().getProperty("/ID");n=this.getObjectModel().getProperty("/NAME");}else{i=s.getBindingContext("data").getProperty("ID");n=s.getBindingContext("data").getProperty("NAME");}m=new J({pageview:"merge01",sourceId:i,sourceName:n,leadingIdeaId:i,allIdeas:[],selectedIdeas:[],selectedIdeaObjects:[]});o=this._getClipboardModel();if(o){var l=o.getObjectKeys(I).filter(function(T){return T!==i;});k=l.map(function(T){return new F("ID",b.EQ,T);});m.setProperty("/selectedIdeas",l);m.setProperty("/allIdeas",l.slice(0));}var p=l;p.push(i);var q={idea_id:p.join(",")};var t=this;var r;var u=jQuery.ajax({url:e.getBackendRootURL()+"/sap/ino/xs/rest/common/check_merge_anonymous_idea.xsjs",data:q,success:function(w){r=w;},type:"GET",contentType:"application/json; charset=UTF-8",async:false});if(r===0){d.show(t.getText("IDEA_MERGE_MSG_ANONYMOUS_IDEA_CANNOT_BE_MERGED"));return;}if(k.length===0){d.show(t.getText("MSG_IDEA_MERGE_NO_IDEA_IN_CLIPBOARD"));return;}var v=new P("sap.ino.xs.object.idea.Idea",i,{actions:["mergeIdeas"]},false,function(w){var x=w.getSource().getData();if(x&&x.actions&&x.actions.mergeIdeas){var y=x.actions.mergeIdeas;if(y.enabled){t.setModel(m,"merge");D=t._getIdeaMergeDialog();t._prepareListItemForIdeaMerge(k);D.open();}else{d.show(y.messages&&y.messages.length>0&&y.messages[0].MESSAGE_TEXT||this.getText("IDEA_MERGE_MSG_IDEA_CANNOT_BE_MERGED"));}}});};j._getIdeaMergeDialog=function(){if(!this._oMergeDialog){this._oMergeDialog=this.createFragment("sap.ino.vc.idea.fragments.IdeaMergeDialog",this.getView().getId());this.getView().addDependent(this._oMergeDialog);this._sResizeMergeDialog=this.attachListControlResized(this.byId("ideaSelection"));}return this._oMergeDialog;};j._prepareListItemForIdeaMerge=function(i){var A,o,s;if(!this._oIdeaMergeListItemTemplate){this._oIdeaMergeListItemTemplate=this.getFragment("sap.ino.vc.idea.fragments.FlatListItemForMerge");A=sap.ui.core.Fragment.byId(this.getView().getId(),"flatListIdeaActions");A.removeItem(A.getItems()[0]);o=new c({selected:{parts:[{path:"data>ID"},{path:"merge>/selectedIdeas"}],formatter:this.formatIsInSelectedIdeas},select:this.onIdeaMergeIdeaSelect});A.addItem(o);}s=this.byId("ideaSelection");s.bindItems({path:"data>/IdeaMedium",filters:i,sorter:new S("NAME"),template:this._oIdeaMergeListItemTemplate});};j.onIdeaMergeIdeaSelect=function(E){var s,i,k,l;s=E.getSource();i=E.getParameter("selected");k=s.getBindingContext("data").getProperty("ID");l=this.getModel("merge").getProperty("/selectedIdeas").slice(0);if(i){if(l.indexOf(k)===-1){l.push(k);}}else{if(l.indexOf(k)>-1){l.splice(l.indexOf(k),1);}}this.getModel("merge").setProperty("/selectedIdeas",l);};j.onSelectAllMergeIdeas=function(E){var A=this.getModel("merge").getProperty("/allIdeas").slice(0);this.getModel("merge").setProperty("/selectedIdeas",A);};j.onChangeLeadingMergeIdea=function(E){var l=E.getParameter("selectedItem");var L=l.getKey();var m=this.getModel("merge");var i=m.getProperty("/selectedIdeaObjects").map(function(o){return{ID:o.ID,NAME:o.NAME};});m.setProperty("/leadingIdeaId",L);this._simulateMergeTransition(L,i);};j._disposeIdeaMergeDialog=function(){var D=this._getIdeaMergeDialog();this.detachListControlResized(this._sResizeMergeDialog);D.close();D.destroy();this._oMergeDialog=null;};j.onIdeaMergeCancel=function(E){this._disposeIdeaMergeDialog();};j.onIdeaMergeNextStep=function(E){var m=this.getModel("merge");var s=m.getProperty("/selectedIdeas");var o=this.byId("ideaSelection");var i=m.getProperty("/sourceId");var l=m.getProperty("/leadingIdeaId");var k=[];jQuery.each(o.getItems(),function(n,p){var q=p.getBindingContext("data").getProperty("ID");var r=p.getBindingContext("data").getProperty("NAME");if(s.indexOf(q)>-1){k.push({ID:q,NAME:r});}});k.push({ID:i,NAME:m.getProperty("/sourceName")});this._simulateMergeTransition(l,k);};j._simulateMergeTransition=function(l,k){var t=this;var m=this.getModel("merge");var n=function(q,K,v){for(var i=0;i<q.length;i+=1){var r=q[i];if(r[K]===v){return r;}}return null;};var o=function(i){var N;var D=i.getSource().getData();if(D&&D.actions&&D.actions.mergeIdeas){var T=D.actions.mergeIdeas;jQuery.each(T.customProperties.outcome,function(q,r){var s=n(k,"ID",r.ID)||{};s.outcome=r;});if(T.messages&&T.messages.length!==0){jQuery.each(T.messages,function(q,r){var s=n(k,"ID",r.REF_ID)||{};s.messages=r;});}}m.setProperty("/selectedIdeaObjects",k);m.setProperty("/pageview","merge02");N=t.byId("ideaMergeNavCon");N.to(t.byId("merge02"));};var p=new P("sap.ino.xs.object.idea.Idea",l,{actions:[{"mergeIdeas":k.map(function(i){return i.ID;}).filter(function(i){return i!==l;})}]},false,o);};j.onIdeaMergePrevStep=function(E){var n=this.byId("ideaMergeNavCon");this.getModel("merge").setProperty("/pageview","merge01");n.backToPage(this.byId("merge01"));};j.onMergeIdeasExecute=function(E){var l=this.getModel("merge").getProperty("/leadingIdeaId");var m=this.getModel("merge").getProperty("/selectedIdeaObjects");var i=m.filter(function(o){return o.ID!==l&&o.outcome&&o.outcome.OUTCOME!=="IDEA_MERGE_NOT_MERGABLE";}).map(function(o){return o.ID;});var A;this.isActionContextSingleIdeaDisplay();A=I.mergeIdeas(l,i);var t=this;A.done(function(){i.map(function(k){M.update(null,"mergeIdeas",I,k);});t._disposeIdeaMergeDialog();d.show(t.getText("MSG_IDEA_MERGE_SUCCESS"));});A.fail(function(r){var k=r.MESSAGES;jQuery.each(k,function(n,o){var T;if(o.MESSAGE_TEXT){T=o.MESSAGE_TEXT;}else{T=t.getText(o.MESSAGE,o.REF_ID);}d.show(T);});});};j.formatIdeaMergeActionEnabled=function(s){return!this.formatter.isFinal(s)&&this._getClipboardModel().getProperty("/enabled");};j.formatIdeaMergeResult=function(o,m){return m&&m.MESSAGE_TEXT||this.getText(o);};j.formatIdeaMergeResultErroneous=function(m){return!!m;};j.formatIsInSelectedIdeas=function(i,s){return s.indexOf(i)!==-1;};j.formatIdeaMergeNextStepEnabled=function(s){return s&&s.length>0||false;};j.formatMergeActionEnabled=function(i){var v=0;if(i){jQuery.each(i,function(k,o){if(o.outcome&&o.outcome.OUTCOME!=="IDEA_MERGE_NOT_MERGABLE"){v+=1;}});}return v>=2;};j.handleMassMerge=function(E){if(this.getViewProperty("/List/SELECT_ALL")){var o=this.getBindingParameter();var i=this._check4ManagingList();var s=this.getList().getBinding('items').sFilterParams;var t=this.getViewProperty("/List/TAGS");var k={};var l=[];t.forEach(function(q){if(!k[q.ROOTGROUPID]){k[q.ROOTGROUPID]=[];k[q.ROOTGROUPID].push(q.ID);l.push(q.ROOTGROUPID);}else{k[q.ROOTGROUPID].push(q.ID);}});var p={searchToken:o.SearchTerm||"",tagsToken:k[l[0]]?k[l[0]].join(","):"",tagsToken1:k[l[1]]?k[l[1]].join(","):"",tagsToken2:k[l[2]]?k[l[2]].join(","):"",tagsToken3:k[l[3]]?k[l[3]].join(","):"",tagsToken4:k[l[4]]?k[l[4]].join(","):"",filterName:o.VariantFilter||"",filterBackoffice:i?"1":"0",filterString:s||""};if(this.setQueryObjectIdeaformFilters){this.setQueryObjectIdeaformFilters(p);}if(this.getCampaignFormQuery){p.ideaFormId=this.getCampaignFormQuery()||"";}if(this.getSearchType){p.searchType=this.getSearchType();}if(this.setQueryObjectCompanyViewFilters){this.setQueryObjectCompanyViewFilters(p);}var m=this;var n=E.getSource();n.setEnabled(false);jQuery.ajax({url:e.getBackendRootURL()+"/sap/ino/xs/rest/common/select_all_ideas.xsjs",data:p,success:function(r){n.setEnabled(true);if(r.Ideas.length===0){f.show(m.getText("NO_IDEAS_AND_RELOAD_PAGE"),{icon:f.Icon.INFORMATION,actions:[sap.m.MessageBox.Action.OK],onClose:function(){m.bindList();}});return;}m._oSelectionMap={};jQuery.each(r.Ideas,function(q,D){if(!m._oDeselectionMap[D.ID]){D.property=m._createPropertyData(D);m._oSelectionMap[D.ID]=D;}});m._onMassMerge();},error:function(r){d.show(m.getText(r.responseJSON.messageKey));}});}else{this._onMassMerge();}};j._onMassMerge=function(){var D,i,m,k,s,l,n;var o=this._getClipboardModel();if(o){k=o.getObjectKeys(I).filter(function(t){return t!==i;});}if(this.isActionContextSingleIdeaDisplay()){s=[this.getObjectModel().getProperty("/ID")];}else{s=Object.keys(this._oSelectionMap).map(function(p){return parseInt(p,10);});}k=k||[];n=s.concat(k);l=n.map(function(t){return new F("ID",b.EQ,t);});m=new J({pageview:"massMerge01",leadingIdeaId:-1,selectedIdeas:n,leadingIdeaList:[],mergeResultList:[],mergeable:false,mergeRuleEnable:!!(e.getSystemSetting("sap.ino.config.ENABLE_IDEA_MERGE_RULE")*1),voteMergeEnable:true});D=this._getIdeaMassMergeDialog();D.setModel(m,"merge");this._prepareListItemForMassIdeaMerge(l);var N=this.byId("massIdeaMergeNavCon");N.to(this.byId("massMerge01"));D.open();};j._getIdeaMassMergeDialog=function(){if(!this._oMassMergeDialog){this._oMassMergeDialog=this.createFragment("sap.ino.vc.idea.fragments.IdeaMassMergeDialog",this.getView().getId());this._oMassMergeDialog.setEscapeHandler(this.handleEscapePress,this);this.getView().addDependent(this._oMassMergeDialog);}return this._oMassMergeDialog;};j._prepareListItemForMassIdeaMerge=function(i){var A,s,o,l=[{ID:-1,NAME:""}];var m=this._getIdeaMassMergeDialog().getModel("merge");if(!this._oIdeaMassMergeListItemTemplate){this._oIdeaMassMergeListItemTemplate=this.getFragment("sap.ino.vc.idea.fragments.FlatListItemForMerge");A=sap.ui.core.Fragment.byId(this.getView().getId(),"mergeListIdeaActions");A.removeItem(A.getItems()[0]);var _=this.formatCheckboxTooltip.bind(this);o=new c({selected:{parts:["data>ID","merge>/leadingIdeaId","merge>/selectedIdeas"],formatter:this.formatSelectedState},tooltip:{parts:["data>ID","merge>/leadingIdeaId","merge>/selectedIdeas"],formatter:_},enabled:{parts:["data>ID","merge>/leadingIdeaId","data>STATUS"],formatter:this.formatIsLeadingIdea},select:this.onIdeaMergeIdeaSelect});A.addItem(o);}var k=new F({filters:i,and:false});var n=new F("STATUS",b.NE,h.Merged);s=this.byId("ideaToMerge");s.bindItems({path:"data>/IdeaMedium",sorter:new S("NAME"),filters:new F({filters:[k,n],and:true}),template:this._oIdeaMassMergeListItemTemplate});s.getBinding("items").attachDataReceived(function(){jQuery.each(s.getItems(),function(p,q){var r=q.getBindingContext("data").getProperty("ID");var t=q.getBindingContext("data").getProperty("NAME");var v=q.getBindingContext("data").getProperty("VOTE_TYPE_TYPE_CODE");l.push({ID:r,NAME:t,VOTE_TYPE_TYPE_CODE:v});});m.setProperty("/leadingIdeaList",l);},this);};j.handleChangeLeadingMergeIdea=function(){var m=this._getIdeaMassMergeDialog().getModel("merge");var l=parseInt(m.getData().leadingIdeaId,10);var A=m.getProperty("/leadingIdeaList");m.setProperty("/selectedIdeas",A.filter(function(i){return i.ID!==l&&i.ID!==-1;}).map(function(i){return i.ID;}));};j.handleMassIdeaMergePrevStep=function(){var D=this._getIdeaMassMergeDialog();var m=D.getModel("merge");var i=parseInt(/massMerge0(\d)/.exec(m.getProperty("/pageview"))[1],10);var n;if(i===3&&!m.getProperty("/mergeRuleEnable")){n="massMerge01";}else{n="massMerge0"+(i-1);}m.setProperty("/pageview",n);var N=this.byId("massIdeaMergeNavCon");N.to(this.byId(n));};j.handleMassIdeaMergeNextStep=function(){var D=this._getIdeaMassMergeDialog();var m=D.getModel("merge");if(m.getProperty("/mergeRuleEnable")){this.handleMassIdeaMergeToRuleStep();}else{this.handleMassIdeaMergeToConfirmStep();}};j.handleMassIdeaMergeToRuleStep=function(){var t=this;var n=this.byId("massIdeaMergeNavCon");n.to(this.byId("massMerge02"));var D=this._getIdeaMassMergeDialog();var m=D.getModel("merge");m.setProperty("/pageview","massMerge02");m.setProperty("/mergeable",false);D.setBusy(true);var o=g.getMergeConfig();o.done(function(i){if(i.RESULT.length===0){i.RESULT=[{MERGE_TYPE:t.getText('IDEA_MASS_MERGE_RULE_TABLE_LABEL_AUTHOR'),ADD:false,IGNORE:false,PROMPT:true,OBJECT_TYPE_CODE:'AUTHOR'},{MERGE_TYPE:t.getText('IDEA_MASS_MERGE_RULE_TABLE_LABEL_EXPERTS'),ADD:false,IGNORE:false,PROMPT:true,OBJECT_TYPE_CODE:'EXPERT'},{MERGE_TYPE:t.getText('IDEA_MASS_MERGE_RULE_TABLE_LABEL_VOTES'),ADD:false,IGNORE:false,PROMPT:true,OBJECT_TYPE_CODE:'VOTE'},{MERGE_TYPE:t.getText('IDEA_MASS_MERGE_RULE_TABLE_LABEL_COMMENTS'),ADD:false,IGNORE:false,PROMPT:true,OBJECT_TYPE_CODE:'COMMENT'}];}else{i.RESULT.forEach(function(R){switch(R.OBJECT_TYPE_CODE){case"AUTHOR":R.MERGE_TYPE=t.getText('IDEA_MASS_MERGE_RULE_TABLE_LABEL_AUTHOR');break;case"EXPERT":R.MERGE_TYPE=t.getText('IDEA_MASS_MERGE_RULE_TABLE_LABEL_EXPERTS');break;case"VOTE":R.MERGE_TYPE=t.getText('IDEA_MASS_MERGE_RULE_TABLE_LABEL_VOTES');break;case"COMMENT":R.MERGE_TYPE=t.getText('IDEA_MASS_MERGE_RULE_TABLE_LABEL_COMMENTS');break;}R.ADD=!!R.ADD;R.IGNORE=!!R.IGNORE;R.PROMPT=!!R.PROMPT;});}var r=new J(i.RESULT);D.setModel(r,"rule");r.attachPropertyChange(t._handleRuleChange,t);r.firePropertyChange();D.setBusy(false);});};j.handleMassIdeaMergeToConfirmStep=function(){var D=this._getIdeaMassMergeDialog();var m=D.getModel("merge");var l=parseInt(m.getProperty("/leadingIdeaId"),10);var t=[l].concat(m.getProperty("/selectedIdeas"));var L=m.getProperty("/leadingIdeaList");var i=this;m.setProperty("/mergeResultList",t.map(function(k){var o=L.filter(function(p){return p.ID===k;})[0];return{ideaType:o.ID===l?i.getText("IDEA_MASS_MERGE_CONFIRM_TABLE_COL_LEADING_TYPE"):i.getText("IDEA_MASS_MERGE_CONFIRM_TABLE_COL_SOURCE_TYPE"),ideaName:o.NAME,ideaID:o.ID,result:o.ID===l?i.getText("IDEA_MASS_MERGE_CONFIRM_TABLE_COL_RESULT_CONTINUE"):i.getText("IDEA_MASS_MERGE_CONFIRM_TABLE_COL_RESULT_STOP"),isLeading:o.ID===l};}));var n=this.byId("massIdeaMergeNavCon");n.to(this.byId("massMerge03"));m.setProperty("/pageview","massMerge03");};j.handleMassIdeaMergeCancel=function(){this._getIdeaMassMergeDialog().close();};j.handleEscapePress=function(p){p.reject();};j.formatIsLeadingIdea=function(i,l){return i!==parseInt(l,10);};j.formatSelectedState=function(i,l,s){return i!==parseInt(l,10)&&s.indexOf(i)!==-1;};j.formatCheckboxTooltip=function(i,l,s){if(!j.formatIsLeadingIdea(i,l)){return"";}var k=j.formatSelectedState(i,l,s);return k?this.getText("IDEA_MASS_MERGE_SOURCE_IDEA_DESELECTED"):this.getText("IDEA_MASS_MERGE_SOURCE_IDEA_SELECTED");};j.formatMergeEnable=function(m,i,l,s){if(!m){return parseInt(l,10)!==-1&&s.length>0;}else{return i;}};j.formatVoteMergeAbleMsgDisplay=function(p,s,l,A){if(p!=='massMerge03'){return false;}if(s.length>1){return true;}var m=[s[0],parseInt(l,10)];var i=A.filter(function(o){if(m.indexOf(o.ID)>-1){return true;}return false;});return i[0].VOTE_TYPE_TYPE_CODE!==i[1].VOTE_TYPE_TYPE_CODE;};j._computeVoteRule=function(s,m){var n=m.selectedIdeas.filter(function(i){return i.VOTE_TYPE_TYPE_CODE!=="LIKE";});var v;if(n.length>0){v=s.filter(function(r){return r.OBJECT_TYPE_CODE==="VOTE";})[0];v.ADD=false;v.IGNORE=true;v.PROMPT=false;}};j._handleRuleChange=function(E){var r=E.getSource().getData();var n=r.filter(function(R){if(!R.ADD&&!R.IGNORE){return true;}else{return false;}});if(n.length===0){this._getIdeaMassMergeDialog().getModel('merge').setProperty('/mergeable',true);}};j.handleMassMergeExecute=function(){var D=this._getIdeaMassMergeDialog();D.setBusy(true);var m=D.getModel("merge");var l=parseInt(m.getProperty("/leadingIdeaId"),10);var i=m.getProperty("/selectedIdeas");var k=m.getProperty("/mergeRuleEnable")?D.getModel("rule").getData():[];var A=I.mergeIdeas(l,{SOURCE_IDEAS:i,MERGE_RULE:k});var t=this;A.done(function(){D.setBusy(false);D.close();i.forEach(function(n){M.update(null,"mergeIdeas",I,n);});if(typeof t.bindList==="function"){t.bindList();}d.show(t.getText("MSG_IDEA_MERGE_SUCCESS"));});A.fail(function(r){var n=r.MESSAGES;jQuery.each(n,function(o,p){var T;if(p.MESSAGE_TEXT){T=p.MESSAGE_TEXT;}else{T=t.getText(p.MESSAGE,p.REF_ID);}d.show(T);});});};return j;});};if(!jQuery.sap.isDeclared('sap.ino.vc.internal.EditInternalNoteDialog.controller')){jQuery.sap.declare('sap.ino.vc.internal.EditInternalNoteDialog.controller');sap.ui.define("sap/ino/vc/internal/EditInternalNoteDialog.controller",["sap/ino/vc/commons/BaseObjectModifyController"],function(C){"use strict";return C.extend("sap.ino.vc.internal.EditInternalNoteDialog",{open:function(i,m){var t=this;var s={actions:["modify","del"],continuousUse:true,readSource:{model:this.getDefaultODataModel()}};jQuery.sap.require(m);var N=jQuery.sap.getObject(m,0);var n=new N(i,s);t.setObjectModel(n);var v=t.getView();v.byId("editInternalNoteDialog").open();},onDeletePressed:function(e){var d=this.executeObjectAction("del",{messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS_NOTE"}});var v=this.getView();d.done(function(r){v.getParent().getController()._commentMixinRefresh();v.byId("editInternalNoteDialog").close();});d.fail(function(r){});d.always(function(){});},onUpdatePressed:function(e){var m=this.executeObjectAction("modify",{messages:{success:"MSG_UPDATE_SUCCESS_NOTE"}});var v=this.getView();m.done(function(r){v.byId("editInternalNoteDialog").close();});m.fail(function(r){});m.always(function(){});},onCancelPressed:function(e){var v=this.getView();v.byId("editInternalNoteDialog").close();}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.internal.InternalAttachment.controller')){jQuery.sap.declare('sap.ino.vc.internal.InternalAttachment.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/internal/InternalAttachment.controller",["sap/ino/vc/commons/BaseBlockController","sap/ino/vc/attachment/AttachmentMixin","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Attachment","sap/ino/commons/application/Configuration","sap/m/MessageToast"],function(B,A,J,a,C,M){"use strict";var b=a.getEndpointURL();return B.extend("sap.ino.vc.internal.InternalAttachment",jQuery.extend({},A,{onInit:function(){B.prototype.onInit.apply(this,arguments);if(!this.getModel("local")){this.setModel(new J({ATTACHMENT_UPLOAD_URL:b}),"local");}},onAfterRendering:function(){this._attachmentMixinInit({attachmentId:"InternalAttachments",updateObject:function(o){o.update();},uploadSuccess:function(o,r){o.addInternalAttachment({"CREATED_BY_NAME":C.getCurrentUser().NAME,"ATTACHMENT_ID":r.attachmentId,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType,"CREATED_AT":new Date()});o.update().fail(function(){o.getMessageParser().parse(r);M.show(this.getText("OBJECT_MSG_ATTACHMENT_FAILED"));return true;});}});}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.reward.RewardFormatter')){jQuery.sap.declare('sap.ino.vc.reward.RewardFormatter');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/ino/vc/reward/RewardFormatter",["sap/ino/commons/models/core/CodeModel","sap/ui/base/Object","sap/ino/commons/formatters/ObjectFormatter","sap/ino/commons/models/aof/PropertyModel","sap/ino/commons/models/aof/PropertyModelCache"],function(C,O,a,P,b){"use strict";var r=O.extend("sap.ino.vc.idea.RewardFormatter",{});jQuery.extend(r,a);var R=P.getStaticActionEnabledDynamicFormatter("sap.ino.xs.object.reward.RewardList","create",function(i){return{IDEA_ID:i};});r.createRewardEnabled=function(i){if(i){return R(i);}return false;};r.rewardAmountUnit=function(A,u){u=u===null?"":" "+u;return A+u;};r.addPercentage=function(n){n=Math.round(Number(n));return String(n)+"%";};r.addPercentageDetail=function(n){if(n===undefined||!n){return'';}else{n=Math.round(Number(n));return String(n)+"%";}};r.maxFractionFormatter=function(n,c){var d=parseFloat(n);if(isNaN(d)){return n;}var p=parseInt(c,10);if(isNaN(p)){p=2;}var e=Math.pow(10,p);return Math.round(d*e)/e;};return r;});};if(!jQuery.sap.isDeclared('sap.ino.vc.reward.mixins.CreateActionMixin')){jQuery.sap.declare('sap.ino.vc.reward.mixins.CreateActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/reward/mixins/CreateActionMixin",["sap/ino/vc/idea/mixins/BaseActionMixin","sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Idea","sap/ino/commons/models/object/RewardList","sap/ino/commons/models/aof/PropertyModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/m/MessageToast"],function(B,a,J,I,R,P,F,b,S,M){"use strict";var C=jQuery.extend({},B);C.onCreateReward=function(e){var c=e.getSource().getCustomData();if(!c||c.length===0){return;}var p=this._parseCustomDatas(e);var d=this._createRewardDialog();this._getChildController(d).setDialog(d);var s={actions:["create","del","executeStatusTransition"],nodes:["Root"],invalidation:{entitySets:["IdeaFull"]},continuousUse:true,concurrencyEnabled:true,readSource:{model:this.getDefaultODataModel()}};var r=new R(p.oKey,s);this._getChildController(d).getView().setBusy(true);if(!p.oKey.hasOwnProperty("IDEA_ID")){var t=this;r.getDataInitializedPromise().done(function(){t._getChildController(d).getView().setBusy(false);});}else{this._handleIdeaInfo(d,r,p.oKey.IDEA_ID);}this._setDefaultValue(r,p);d.setModel(r,"object");d.open();};C.onDismissReward=function(e){var c=e.getSource().getCustomData();if(!c||c.length===0){return;}var p=this._parseCustomDatas(e);if(p.oKey.IDEA_ID){var o=this;var r=I.dismissReward(p.oKey.IDEA_ID);r.done(function(){var d=o.getList().getBindingInfo("items");o.getList().bindItems(d);});}};C._createRewardDialog=function(){var r=this.createFragment("sap.ino.vc.idea.fragments.CreateRewardDialog",this.getView().getId());this.getView().addDependent(r);return r;};C._parseCustomDatas=function(e){var p={oKey:null,IdeaPhaseCode:null,IdeaName:null,UnitCode:null,UnitText:null};var c=e.getSource().getCustomData();jQuery.each(c,function(i,d){var k=d.getKey();var v=d.getValue();if(k==="IdeaId"){p.oKey={IDEA_ID:d.getValue(),OBJECT_TYPE_CODE:"IDEA",OBJECT_ID:d.getValue()};}else if(k==="RewardListId"){p.oKey=v;}else if(p.hasOwnProperty(k)){p[k]=v;}});return p;};C._setDefaultValue=function(r,p){if(typeof p.oKey!=="object"){return;}r.setProperty("/IDEA_NAME",p.IdeaName);r.setProperty("/IDEA_PHASE_CODE",p.IdeaPhaseCode);r.setProperty("/REWARD_UNIT_CODE",p.UnitCode);r.setProperty("/REWARD_UNIT_TEXT",p.UnitText);};C._getChildController=function(d){return d.getContent()[0].getController();};C._handleIdeaInfo=function(d,r,n){var t=this;r.getReadSourceModel().read("/IdeaFull("+n+")/ContributionShare",{success:function(o){var c=[];jQuery.each(o.results||[],function(i,e){c.push({ID:r.getNextHandle(),AUTHOR_ID:e.AUTHOR_ID,REWARD_AMOUNT:e.REWARD_AMOUNT,REWARD_SHARE:e.REWARD_SHARE,CONTRIBUTION_SHARE:e.PERCENTAGE,IDEA_ID:e.IDEA_ID,EMPLOYEE_NAME:e.AUTHOR_NAME});});t._setIdeaDetails(r,n,c);t._getChildController(d).getView().setBusy(false);},error:function(){t._getChildController(d).getView().setBusy(false);}});};C._setIdeaDetails=function(r,n,o){r.setProperty("/IDEA_ID",n);r.setProperty("/Rewards",o);r.setProperty("/REWARD_AMOUNT_TOTAL",0);};return C;});};if(!jQuery.sap.isDeclared('sap.ino.vc.reward.mixins.ExportActionMixin')){jQuery.sap.declare('sap.ino.vc.reward.mixins.ExportActionMixin');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/reward/mixins/ExportActionMixin",["sap/ino/commons/util/Export","sap/ino/commons/application/Configuration","sap/ui/core/format/DateFormat","sap/m/MessageToast"],function(E,C,D,M){"use strict";var a=function(){throw"Mixin may not be instantiated directly";};a.onListExport=function(e){if(!this._oExportActionSheet){this._oExportActionSheet=this.createFragment("sap.ino.vc.commons.fragments.ExportActionSheet",this.getView().getId());this.getView().addDependent(this._oExportActionSheet);}if(e.getSource().data("placement")){this._oExportActionSheet.setPlacement(e.getSource().data("placement"));}this._oExportActionSheet.triggerButton=e.getSource();this._oExportActionSheet.openBy(e.getSource());};a.onListExportXLS=function(e){E.i18n=this.getModel("i18n");var o=typeof this.getExportControl==="function"?this.getExportControl():this.getList();var c=typeof this.fnCompleted==="function"?this.fnCompleted:null;if(c){E.exportAdvanced(o,"xls",this.getExportPrefix&&this.getExportPrefix(),this._oExportActionSheet.triggerButton,C.getCurrentUser().NAME,null,c(this));}else{E.exportAdvanced(o,"xls",this.getExportPrefix&&this.getExportPrefix(),this._oExportActionSheet.triggerButton,C.getCurrentUser().NAME);}};a.onListExportCSV=function(e){E.i18n=this.getModel("i18n");var o=typeof this.getExportControl==="function"?this.getExportControl():this.getList();var c=typeof this.fnCompleted==="function"?this.fnCompleted:null;if(c){E.exportAdvanced(o,"csv",this.getExportPrefix&&this.getExportPrefix(),this._oExportActionSheet.triggerButton,C.getCurrentUser().NAME,null,c(this));}else{E.exportAdvanced(o,"csv",this.getExportPrefix&&this.getExportPrefix(),this._oExportActionSheet.triggerButton,C.getCurrentUser().NAME);}};a.onListExportPPT=function(e){E.i18n=this.getModel("i18n");var o=typeof this.getExportControl==="function"?this.getExportControl():this.getList();var c=typeof this.fnCompleted==="function"?this.fnCompleted:null;if(c){E.exportAdvanced(o,"pptx",this.getExportPrefix&&this.getExportPrefix(),this._oExportActionSheet.triggerButton,C.getCurrentUser().NAME,null,c(this));}else{E.exportAdvanced(o,"pptx",this.getExportPrefix&&this.getExportPrefix(),this._oExportActionSheet.triggerButton,C.getCurrentUser().NAME,50);}};a.onChartExportSVG=function(e){E.i18n=this.getModel("i18n");var o=typeof this.getExportChartControl==="function"?this.getExportChartControl():this.getChart();E.exportChartAdvanced(o,this.getChartTitle&&this.getChartTitle(),e.getSource());};return a;});};if(!jQuery.sap.isDeclared('sap.ino.vc.shell.Settings.controller')){jQuery.sap.declare('sap.ino.vc.shell.Settings.controller');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/shell/Settings.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/UserSettings","sap/ino/commons/models/object/Attachment","sap/m/MessageToast","sap/ino/commons/models/core/ModelSynchronizer"],function(B,C,U,A,M,a){"use strict";return B.extend("sap.ino.vc.shell.Settings",{formatter:jQuery.extend({mailLanguageText:function(d,c){return d;}},B.prototype.formatter),onInit:function(){B.prototype.onInit.apply(this,arguments);this.setViewProperty("/EDIT",true);this.setViewProperty("/ATTACHMENT_UPLOAD_URL",A.getEndpointURL());this.aBusyControls=[this.byId("userSettings")];},setUserDataModel:function(u){this._oUserDataModel=u;},onBeforeRendering:function(){var u=C.getCurrentUser().USER_ID;var o=new U(u,{continuousUse:true,actions:["updateUserLocale"],readSource:{model:this.getDefaultODataModel()}});this.setObjectModel(o);this.bindDefaultODataModel(u);if(this._oUserDataModel){a.addAOInstanceDependency(o,this._oUserDataModel,function(b,d){if(b&&b.getProperty("/Settings")&&d){d.setProperty("/IMAGE_ID",b.getProperty("/Settings").TITLE_IMAGE_ID);}});}},getODataEntitySet:function(){return"Identity";},onFileUploaderChange:function(e){var f=e.getSource();var F=e.getParameter("files");f.setBusy(true);A.prepareFileUploader(f,F);},onFileUploaderComplete:function(e){var r=A.parseUploadResponse(e.getParameter("responseRaw"));var f=e.getSource();if(r){var o=this.getObjectModel();if(r.success){o.setUserImage({"ATTACHMENT_ID":r.attachmentId,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType});}else{M.show(this.getText("SETTINGS_MSG_USER_IMAGE_FAILED"));}}else{M.show(this.getText("SETTINGS_MSG_USER_IMAGE_ERROR"));}f.setBusy(false);f.clear();},onImageSettingClear:function(e){var o=this.getObjectModel();o.clearUserImage();var f=this.byId("imageSettingUploader");f.setValue(null);}});});};if(!jQuery.sap.isDeclared('sap.ino.commons.formatters.BaseListFormatter')){jQuery.sap.declare('sap.ino.commons.formatters.BaseListFormatter');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/ino/commons/formatters/BaseListFormatter",["sap/ino/commons/formatters/ObjectFormatter","sap/ino/commons/models/core/CodeModel","sap/ui/base/Object"],function(O,C,a){"use strict";var b=a.extend("sap.ino.commons.formatters.BaseListFormatter",{});jQuery.extend(b,O);b.showActiveFilterInBar=function(s,p,S){var P=S&&S.phone;var c=this.getListProperty("/Filter/PhaseBinding/TABLE_PATH");var f=C.getFormatter(c);if(!!s){s=this.getText(this.getStatus(s).TEXT);}if(!!p){p=f(p);}if(P){if(s&&p){return this.getText("LIST_FILTER_FLD_COUNTS",[2]);}else if(s||p){return this.getText("LIST_FILTER_FLD_COUNT");}}else{if(s&&p){return this.getText("LIST_FILTERS_FLD",[s,p]);}else if(s){return this.getText("LIST_FILTER_FLD",[s]);}else if(p){return this.getText("LIST_FILTER_FLD",[p]);}}return"";};b.variantTitle=function(v,o,c){if(c&&c.TYPE_CODE==="QUICK_LINK_CUSTOM_IDEA"&&!o){return c.LINK_TEXT;}if(v===undefined){return this.getText("EMPTY_FLD_TEXT");}var V=this.getVariant(v);if(!V){return this.getText("EMPTY_FLD_TEXT");}var d=V.DISPLAY_LABEL;if(!o){if(d){return this.getText(V.TEXT,[d]);}return this.getText(V.TEXT);}else if(c&&c.TYPE_CODE==="QUICK_LINK_CUSTOM_IDEA"){return this.getText("LIST_TIT_COMBINED_TEXT",[o,c.LINK_TEXT]);}else{var t;if(d){t=this.getText(V.TEXT,[d]);}else{t=this.getText(V.TEXT);}return this.getText("LIST_TIT_COMBINED_TEXT",[o,t]);}};b.listSortText=function(s,S){if(S===undefined){return this.getText("EMPTY_FLD_TEXT");}var p=s&&s.phone;var t=p?"LIST_SORT_BY_SHORT":"LIST_SORT_BY";var P=this.getSort(S).TEXT;return this.getText(t,[this.getText(P)]);};return b;});};if(!jQuery.sap.isDeclared('sap.ino.commons.formatters.ListFormatter')){jQuery.sap.declare('sap.ino.commons.formatters.ListFormatter');jQuery.sap.require('sap.m.GroupHeaderListItem');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/ino/commons/formatters/ListFormatter",["sap/ino/commons/formatters/BaseListFormatter","sap/m/GroupHeaderListItem","sap/ui/base/Object"],function(B,G,O){"use strict";var l=O.extend("sap.ino.commons.formatters.ListFormatter",{});jQuery.extend(l,B);l.listThreshold=function(s){if(s.desktop){return 20;}else if(s.tablet){return 20;}else{return 10;}};l.showFilter=function(s,p){return!!(s||p);};return l;});};if(!jQuery.sap.isDeclared('sap.ino.commons.formatters.ObjectListFormatter')){jQuery.sap.declare('sap.ino.commons.formatters.ObjectListFormatter');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/ino/commons/formatters/ObjectListFormatter",["sap/ino/commons/formatters/BaseFormatter","sap/ino/commons/formatters/ListFormatter","sap/ino/commons/formatters/ObjectFormatter","sap/ino/commons/models/core/CodeModel","sap/ui/base/Object"],function(B,L,O,C,a){"use strict";var o=a.extend("sap.ino.commons.formatters.ObjectListFormatter",{});jQuery.extend(o,L,O);o.ideaListCampaignBackground=function(c){if(c&&c.length===6){c="#"+c;}else{c="#FFFFFF";}return"<div class='sapInoIdeaListColor' style='background-color : "+c+";' />";};o.widthCampaignCard=function(s){if(s.phone){return"300px";}else{return"400px";}};o.feedObjectTypeFormatter=function(s){if(!s){return;}return this.getText("FEEDS_FLD_OBJECT_TYPE_"+s);};o.feedFieldNameFormatter=function(f){if(!f){return;}return this.getText("FEEDS_FLD_NAME_"+f);};o.feedFieldValueFormatter=function(v,V){if(!v||!V){return;}if(v==="BOOLEAN"){return Number(V)?this.getText("FEEDS_FLD_VALUE_TRUE"):this.getText("FEEDS_FLD_VALUE_FALSE");}if(v==="DATE"){V=V.split(".");V=V[0].replace(/-/g,"/");return B.toDate(V);}return;};o.feedObjectLinkFormatter=function(s,b,c){if(!s||!b||!c){return;}var r;switch(c){case"IDEA":r="<a href='"+this.ideaNavigationLink(s)+"' class='sapMLnk sapMLnkMaxWidth' tabindex='0' role='link'>"+b+"</a>";break;case"WALL":r="<a href='"+this.wallNavigationLink(s)+"' class='sapMLnk sapMLnkMaxWidth' tabindex='0' role='link'>"+b+"</a>";break;case"CAMPAIGN":r="<a href='"+this.campaignNavigationLink(s)+"' class='sapMLnk sapMLnkMaxWidth' tabindex='0' role='link'>"+b+"</a>";break;case"EVALUATION":r="<a href='"+this.evaluationNavigationLink(s)+"' class='sapMLnk sapMLnkMaxWidth' tabindex='0' role='link' rel='"+b+"'>"+b+"</a>";break;case"BLOG":r="<a href='"+this.blogNavigationLink(s)+"' class='sapMLnk sapMLnkMaxWidth' tabindex='0' role='link' rel='"+b+"'>"+b+"</a>";break;case"LINK":r="<a href='"+s+"' class='sapMLnk sapMLnkMaxWidth' tabindex='0' role='link' rel='"+b+"'>"+b+"</a>";break;default:r=b;break;}return r;};o.feedMsgFormatter=function(v){var r,m;if(!v||!v.FEED_CODE){return;}var A=v.FEED_CODE,s=jQuery.sap.encodeHTML(v.OBJECT_TEXT||""),b=v.OBJECT_ID,c=v.OBJECT_TYPE_CODE,i=jQuery.sap.encodeHTML(v.INVOLVED_OBJ_TEXT||""),I=v.INVOLVED_ID,d=v.INVOLVED_OBJ_TYPE_CODE,f=v.FIELD1_VALUE_OPTION==='DATE'?v.FIELD1_VALUE:jQuery.sap.encodeHTML(v.FIELD1_VALUE||""),F=jQuery.sap.encodeHTML(v.FIELD1_NAME||""),e=jQuery.sap.encodeHTML(v.FIELD1_TEXT||""),g=jQuery.sap.encodeHTML(v.FIELD1_VALUE_OPTION||""),h=v.FIELD2_VALUE_OPTION==='DATE'?v.FIELD2_VALUE:jQuery.sap.encodeHTML(v.FIELD2_VALUE||""),j=jQuery.sap.encodeHTML(v.FIELD2_NAME||""),k=jQuery.sap.encodeHTML(v.FIELD2_TEXT||""),l=jQuery.sap.encodeHTML(v.FIELD2_VALUE_OPTION||""),n=jQuery.sap.encodeHTML(v.CONTENT||""),p,q;p=this.feedObjectLinkFormatter(b,s,c);i=d==="EVALUATION"?this.feedObjectTypeFormatter(d):i;I=d==="LINK"?n:I;q=this.feedObjectLinkFormatter(I,i,d);if(A.indexOf("STATUS_ACTION")===0){if(A.indexOf("SUBMIT")>0){A="STATUS_ACTION_SUBMIT";}else if(A.indexOf("EVAL")>0){A="STATUS_ACTION"+"_EVAL";}else{A="STATUS_ACTION";}}if(A.indexOf("CAMP_MAJOR_PUBLISH")===0){A="ACTION_FLD_COMPAIGN_MAJOR_CHANGE";}if(A.indexOf("IDEA_RELATION")===0){A=A.substr(A.lastIndexOf(".")+1);}if(e==="IDEA_FORM"){A="ACTION_IDEA_FORM";if(["BOOLEAN","DATE"].indexOf(g)>=0){f=this.feedFieldValueFormatter(g,f);}else if(g){f=g?C.getText(g,Number(f)):f;}if(["BOOLEAN","DATE"].indexOf(l)>=0){h=this.feedFieldValueFormatter(l,h);}else if(l){h=l?C.getText(l,Number(h)):h;}}else{if(["BOOLEAN","DATE"].indexOf(g)>=0){f=this.feedFieldValueFormatter(g,f);}else if(g){f=C.getText(g,f);}if(["BOOLEAN","DATE"].indexOf(l)>=0){h=this.feedFieldValueFormatter(l,h);}else if(l){h=C.getText(l,h);}F=e?this.feedFieldNameFormatter(e):F;j=k?this.feedFieldNameFormatter(k):j;}c=this.feedObjectTypeFormatter(c);d=this.feedObjectTypeFormatter(d);m="FEEDS_MSG_"+A;r=this.getText(m,[this.spanWrapperFormatter(c),p,this.spanWrapperFormatter(d),q,this.spanWrapperFormatter(F),this.spanWrapperFormatter(f),this.spanWrapperFormatter(j),this.spanWrapperFormatter(h),""]);return this.spanWrapperFormatter(r);};o.spanWrapperFormatter=function(t){return t?"<span>"+t+"</span>":"";};o.heightCampaignCard=function(s){if(s.phone){return"160px";}else{return"213px";}};o.respListFilterEnable=function(i){if((i===null)||(i&&i.length>1)){return true;}else{return false;}};o.setIdeaHeaderTitleLength=function(f){if(!f){return"IDEA_HEADER_TITLE_LENGTH_SMALL";}else{return"IDEA_HEADER_TITLE_LENGTH_BIG";}};o.quickLinkFilterInfo=function(f,A,s,b){var t=this;var c=0,p=[],S=A?this.getText('QUICK_LINK_FLD_ACTIVE'):this.getText('QUICK_LINK_FLD_INACTIVE'),v='',V='',d='',r=[],i;if(f&&s&&b){for(var k in f){switch(k){case'CAMPAIGN':p.push(t.getText('LIST_TIT_FILTER_CAMPAIGN_HEADER')+': '+f[k]);break;case'IDEAFORMID':p.push(t.getText('LIST_TIT_FILTER_CAMPAIGN_FORM_HEADER')+': '+C.getText('sap.ino.xs.object.ideaform.IdeaForm.Root',f[k]));break;case'PHASE':d=f[k].split(',');r=[];for(i=0;i<d.length;i++){r.push(C.getText('sap.ino.xs.object.campaign.Phase.Root',d[i]));}p.push(t.getText('LIST_TIT_FILTER_PHASE_HEADER')+': '+r.join(','));break;case'STATUS':d=f[k].split(',');r=[];for(i=0;i<s.length;i++){if(d.indexOf(s[i].KEY)>=0){r.push(t.getText(s[i].TEXT));}}if(r.length){p.push(t.getText('LIST_TIT_FILTER_STATUS_HEADER')+': '+r.join(','));}break;case'SUBSTATUS':d=f[k].split(',');r=[];for(i=0;i<d.length;i++){r.push(C.getText('sap.ino.xs.object.idea.Status.Root',d[i]));}p.push(t.getText('LIST_TIT_FILTER_SUB_STATUS')+': '+r.join(','));break;case'RESPCODE':d=f[k]?JSON.parse(f[k]):[];r=[];for(i=0;i<d.length;i++){r.push(C.getText('sap.ino.xs.object.subresponsibility.ResponsibilityStage.RespValues',d[i].code));}p.push(t.getText('LIST_TIT_FILTER_RESPONSIBILITY_LIST_HEADER')+': '+r.join(','));break;case'AUTHORS':p.push(t.getText('LIST_TIT_FILTER_AUTHOR_HEADER')+': '+f[k]);break;case'COACHES':p.push(t.getText('LIST_TIT_FILTER_COACH_HEADER')+': '+f[k]);break;case'DUEFROM':p.push(t.getText('QUICK_LINK_FLD_DUE_FROM')+': '+f[k]);break;case'DUETO':p.push(t.getText('QUICK_LINK_FLD_DUE_TO')+': '+f[k]);break;case'VOTENUM':v=f[k];break;case'VOTEOPERATOR':V=f[k];break;default:break;}}if(v&&V){for(i=0;i<b.length;i++){if(b[i].ACTION===V){V=t.getText(b[i].TEXT);}}p.push(t.getText('LIST_TIT_FILTER_VOTE_NUMBER')+': '+V+' '+v);}c=p.length;return this.getText('QUICK_LINK_FILTER_INFO_TEXT',[c,S])+'\n'+p.join('\n');}return'';};return o;});};if(!jQuery.sap.isDeclared('sap.ino.vc.analytics.Display.controller')){jQuery.sap.declare('sap.ino.vc.analytics.Display.controller');jQuery.sap.require('sap.ui.model.odata.ODataModel');jQuery.sap.require('sap.ui.comp.smartfilterbar.ControlConfiguration');jQuery.sap.require('sap.ui.comp.smartfilterbar.SelectOption');jQuery.sap.require('sap.m.FlexItemData');jQuery.sap.require('sap.m.SegmentedButtonItem');jQuery.sap.require('sap.ui.comp.smartfilterbar.SmartFilterBar');jQuery.sap.require('sap.ui.comp.smarttable.SmartTable');jQuery.sap.require('sap.ui.comp.smartchart.SmartChart');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.LabelDesign');jQuery.sap.require('sap.ui.layout.VerticalLayout');jQuery.sap.require('sap.ui.layout.HorizontalLayout');jQuery.sap.require('sap.m.FlexBox');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/analytics/Display.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/application/Configuration","sap/ui/model/odata/ODataModel","sap/ui/comp/smartfilterbar/ControlConfiguration","sap/ui/comp/smartfilterbar/SelectOption","sap/m/FlexItemData","sap/m/SegmentedButtonItem","sap/ui/comp/smartfilterbar/SmartFilterBar","sap/ui/comp/smarttable/SmartTable","sap/ui/comp/smartchart/SmartChart","sap/ino/commons/models/object/Report","sap/ino/commons/util/ReportUtil","sap/ui/core/MessageType","sap/ui/core/message/Message","sap/m/Label","sap/m/LabelDesign","sap/ino/vc/commons/mixins/ExportMixin","sap/ui/layout/VerticalLayout","sap/ui/layout/HorizontalLayout","sap/m/FlexBox","sap/ui/model/json/JSONModel","sap/m/MessageBox"],function(B,T,C,O,a,S,F,b,c,d,e,R,f,M,g,L,h,E,V,H,k,J,l){"use strict";return B.extend("sap.ino.vc.analytics.Display",jQuery.extend({},T,E,{routes:["report"],onInit:function(){B.prototype.onInit.apply(this,arguments);this.oFlexItemData=new F({growFactor:0});this.oFlexItemLayoutData=new F({growFactor:1});this.oVBox=this.byId("oVBox");this.oSegmentedButton=this.byId("segmentedButton");},onRouteMatched:function(o){var i=this.getModel("user").getProperty("/privileges")["sap.ino.ui::backoffice.access"];if(!i){this.navigateTo("home");return;}this.initFullScreen();this.setHelp("REPORT_DISPLAY");var j=this;var p=o.getParameter("arguments").code;this.sCampaignId=null;if(o.getParameter("arguments")["?query"]){this.sCampaignId=o.getParameter("arguments")["?query"].campaign;}this.oObjectContext={chartVisible:!C.getPersonalize().REPORT_VIEW,tableVisible:!!C.getPersonalize().REPORT_VIEW,saveButtonEnabled:true,otbFooterVisible:true,listBoxVisible:false,VBoxVisible:false,datePickerVisible:false};this.setModel(new J(this.oObjectContext),"objectContext");if(this.oSegmentedButton.getItems()&&this.oSegmentedButton.getItems().length>0){this.oSegmentedButton.destroyItems();this.oSegmentedButton.destroyButtons();}this.initModel(p);if(this.oConfiguration.Views.length>1){jQuery.each(this.oConfiguration.Views,function(m,v){var n=new b({text:"{i18n>"+v.DisplayName+"}",key:m,width:"200px"});j.oSegmentedButton.addItem(n);});}var I=this.oVBox.getItems();if(I.length>0){this.oVBox.removeAllItems();}j.aTempParameter=[];j.iParameterIndex=0;if(f.checkMandatoryParameters(this.oConfiguration)){this.freshViews(this.oConfiguration.SelectedView);}},initModel:function(p){var o=this;p="/"+p;if(this.getOwnerComponent().getModel("data").getProperty(p)){this.oConfig=this.getOwnerComponent().getModel("data").getProperty(p);this.oConfiguration=JSON.parse(this.oConfig.CONFIG);f.deleteSorterInConfig(this.oConfiguration);o.onAfterShow();}else{var s=C.getApplicationPath("sap.ino.config.URL_PATH_OD_BACKOFFICE");var D=new sap.ui.model.odata.ODataModel(C.getBackendRootURL()+"/"+s);D.read(p,{async:false,success:function(i){o.oConfig=i;o.oConfiguration=JSON.parse(i.CONFIG);f.deleteSorterInConfig(o.oConfiguration);o.onAfterShow();}});}this.iSelectedView=this.oConfiguration.SelectedView;this.oSegmentedButton.setSelectedKey(this.iSelectedView.toString());this.oChartPage=this.byId("chartPage");this.oSaveButton=this.byId("saveButton");if(parseInt(this.oConfig.ID,0)<0){this.getModel("objectContext").setProperty("/saveButtonEnabled",false);}else{this.getModel("objectContext").setProperty("/saveButtonEnabled",true);}this.oModel=this.createModel(parseInt(this.oConfig.ID,0),this.oConfig.CODE);this.setObjectModel(this.oModel);if(this.sCampaignId){this.oConfiguration.Parameters.Campaign.Selection.push(this.sCampaignId);this.oTemplateDataRequest.done(function(){o.getObjectModel().getProperty("/CONFIG").Parameters.Campaign.Selection.push(o.sCampaignId);});}this._oSeletedTableView=0;},onSaveAs:function(){this.getDialog().open();this.byId('reportTitle').setValue(this.oChartPage.getText());},onSave:function(){var o=this;this.storeConfiguration();this.getObjectModel().setConfiguration(this.oConfiguration);var r=this.executeObjectAction("modify");r.always(function(){o.setBusy(false);});},getDialog:function(){if(!this._oDialog){this._oDialog=this.createFragment("sap.ino.vc.analytics.fragments.Dialog");this.getView().addDependent(this._oDialog);}return this._oDialog;},onSubmit:function(){var o=this;this.storeConfiguration();this.oConfiguration.Title=this.byId('reportTitle').getValue();var s={continuousUse:true,actions:["modify"],readSource:{model:this.getDefaultODataModel()}};o.oModel=new R(-1,s);o.oModel.setProperty("/ID",-1);o.oModel.setConfiguration(this.oConfiguration);o.setObjectModel(o.oModel);var D=this.getDialog();D.setBusy(true);o.resetClientMessages();var r=o.executeObjectAction("create");r.done(function(){D.close();o.oChartPage.setText(o.oConfiguration.Title);o.oSaveButton.setEnabled(true);o.getModel("objectContext").setProperty("/saveButtonEnabled",true);});r.fail(function(){});r.always(function(){D.setBusy(false);});},onCancel:function(){this._oDialog.close();},createModel:function(i,s){var o={continuousUse:true,actions:["modify"],readSource:{model:this.getDefaultODataModel()}};this.oModel=new R(i,o);if(s!==undefined&&s!==null){if(!i||i<0){this.oTemplateDataRequest=this.oModel.setDataFromTemplate(s,this.getDefaultODataModel());}}if(!i||i<0){this._bSaveAllowed=false;}else{this._bSaveAllowed=true;}this.oModel.setAfterInitChanges();return this.oModel;},onNavigateToChart:function(){var t=this;var r=this.checkSelectedClumns();if(r.errors.length>0){l.error(sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("P13NDIALOG_VALIDATION_CHARTTYPE"),{icon:l.Icon.ERROR,actions:[l.Action.CLOSE],onClose:function(D){t.byId("typeSegmentedButton").setSelectedButton(t.byId("navigateToTable"));t.getModel("objectContext").setProperty("/chartVisible",false);t.getModel("objectContext").setProperty("/tableVisible",true);}});}else{this.getModel("objectContext").setProperty("/chartVisible",true);this.getModel("objectContext").setProperty("/tableVisible",false);this.oSmartChart.applyVariant(this._convertTableSetingToChart());}this._oSeletedTableView=0;},checkSelectedClumns:function(){var s=this.oSmartChart.getChart().getChartType();var D=[];var m=[];var i=this.oSmartChart.getChart().mAggregations.dimensions;var j=this.oSmartChart.getChart().mAggregations.measures;var n=this.oSmartTable.getTable().mAggregations.columns;jQuery.each(n,function(o,p){if(p.getProperty("visible")){jQuery.each(i,function(q,t){if(t.getProperty("name")===p.getProperty("leadingProperty")){D.push({"name":t.getProperty("name")});}});jQuery.each(j,function(q,t){if(t.getProperty("name")===p.getProperty("leadingProperty")){m.push({"name":t.getProperty("name")});}});}});sap.ui.getCore().loadLibrary("sap.chart");var r=sap.chart.api.getChartTypeLayout(s,D,m);return r;},onNavigateToTable:function(){var o=this.getModel("objectContext");o.setProperty("/chartVisible",false);o.setProperty("/tableVisible",true);this._convertChartSetingToTable();this._oSeletedTableView=1;},_formatChartType:function(s){var i="";if(s&&s.indexOf("_")>=0){var j=s.split("_").reverse();jQuery.each(j,function(I,m){var n=m.replace(/^(\w)(\w+)/,function(v,o,p){return o.toUpperCase()+p.toLowerCase();});i+=n;});if(i.indexOf("Horizontal")>=0){i=i.replace("Horizontal","");}if(i.indexOf("Vertical")>=0){i=i.replace("Vertical","");}}else{if(s!=="heatmap"){i=s;}else{i="HeatMap";}}return i;},onSelect:function(o){this.storeConfiguration();this.iSelectedView=parseInt(o.getParameters().key,0);this.oConfiguration.SelectedView=this.iSelectedView;this.freshViews(this.iSelectedView);},freshViews:function(s){var i=this.getModel("objectContext").getProperty("/chartVisible")?0:1;var t=this.byId("typeSegmentedButton");t.setSelectedButton(t.getButtons()[i]);this.getModel("objectContext").setProperty("/otbFooterVisible",true);this.sChartType=this.oConfiguration.Views[s].Chart.Type;this.aDimensions=this.oConfiguration.Views[s].Dimensions;this.aMeasures=this.oConfiguration.Views[s].Measures;var I=this.oVBox.getItems();if(I.length>0){this.oVBox.removeAllItems();}var o=new c({showClearButton:true,layoutData:this.oFlexItemData,visible:false});var A=this.oConfiguration.DataSource+"Type";o.setEntityType(A);var G={};jQuery.each(this.oConfiguration.Parameters,function(w,P){if(P.hasOwnProperty("groupKey")&&P.groupKey){G[P.groupKey]=G[P.groupKey]||[];G[P.groupKey].push(P);return true;}var x=new a({key:P.Key,label:"{i18n>"+P.DisplayName+"}",visibleInAdvancedArea:true});jQuery.each(P.Selection,function(y,z){if(z){var D=new S({low:z});x.addDefaultFilterValue(D);}else{return true;}});o.addControlConfiguration(x);});jQuery.each(G,function(K,w){var x=new a({key:K,label:"{i18n>"+w[0].groupName+"}",visibleInAdvancedArea:true});var y=new S({low:w[0].Selection,high:w[1].Selection+"T23:59:59",operator:"BT"});x.addDefaultFilterValue(y);o.addControlConfiguration(x);});this.oSmartChart=new e({useChartPersonalisation:true,enableAutoBinding:true,layoutData:this.oFlexItemLayoutData,useVariantManagement:true,visible:"{objectContext>/chartVisible}"});if(this.aMeasures&&this.aMeasures.length===0){this.getModel("objectContext").setProperty("/chartVisible",false);this.getModel("objectContext").setProperty("/tableVisible",true);this.byId("typeSegmentedButton").setSelectedButton(this.byId("navigateToTable"));this._oSeletedTableView=1;}var j=o.getId();this._sSmartFilterBarId=j;this.oSmartChart.setSmartFilterId(j);this.oSmartChart.setEntitySet(this.oConfiguration.DataSource);this.oConfiguration.SelectedView=this.iSelectedView;var m=this.oConfiguration.ODataPath||C.getApplicationPath("sap.ino.config.URL_PATH_OD_ANALYTICS");var p={json:false,loadAnnotationsJoined:true};var n=new O(C.getBackendRootURL()+"/"+m,p);n.addAnnotationXML(f.getAnnotationXML(this.oConfiguration));var v=this.getView();v.setModel(n);var q={sort:{sortItems:[]},filter:{filterItems:[]}};if(this.oConfiguration.Views[s].hasOwnProperty("Sorter")&&this.oConfiguration.Views[s].Sorter){this.oConfiguration.Views[s].Sorters=[{columnKey:this.oConfiguration.Views[s].Sorter.Path,operation:this.oConfiguration.Views[s].Sorter.Descending?"Descending":"Ascending"}];delete this.oConfiguration.Views[s].Sorter;}if(this.oConfiguration.Views[s].Sorters){q.sort.sortItems=this.oConfiguration.Views[s].Sorters;}if(this.oConfiguration.Views[s].Filters){q.filter.filterItems=this.oConfiguration.Views[s].Filters;}this.oSmartChart.attachInitialise(null,function(){this.oSmartChart.applyVariant(q);},this);this.oVBox.addItem(o);this.oVBox.addItem(this.oSmartChart);var r=this;setTimeout(function(){var w=r.oSmartChart.getChart();if(w){w.setUiConfig({applicationSet:"fiori"});}},0);var u="";jQuery.each(this.oConfiguration.Views[s].Dimensions,function(w,D){u+=(D+",");});if(this.oConfiguration.Views[s].SecondaryDimensions){jQuery.each(this.oConfiguration.Views[s].SecondaryDimensions,function(w,D){u+=(D+",");});}jQuery.each(this.oConfiguration.Views[s].Measures,function(w,x){u+=(x+",");});if(this.oConfiguration.Views[s].SecondaryMeasures){jQuery.each(this.oConfiguration.Views[s].SecondaryMeasures,function(w,x){u+=(x+",");});}u=u.substring(0,u.length-1);this._createSmartTable(u);},_createSmartTable:function(v){if(this.oSmartTable){this.oVBox.removeItem(this.oSmartTable);this.oSmartTable=undefined;}this.oSmartTable=new d({entitySet:this.oConfiguration.DataSource,smartFilterId:this._sSmartFilterBarId,tableType:"AnalyticalTable",useExportToExcel:true,useVariantManagement:false,useTablePersonalisation:true,header:"Views",showRowCount:true,enableAutoBinding:true,initiallyVisibleFields:v,ignoredFields:"ID",ignoreFromPersonalisation:"ID",layoutData:this.oFlexItemLayoutData,visible:"{objectContext>/tableVisible}"});this.oSmartTable.attachInitialise(function(){console.log(this.oSmartTable.getTable().getColumns());},this);this.oSmartTable.attachBeforeRebindTable(function(){console.log(this.oSmartTable.getTable().getColumns());},this);this.oVBox.addItem(this.oSmartTable);},fnGetFilter:function(p){var o=this,m=[];for(var i=0;i<o.aTempParameter.length;i++){var P=o.aTempParameter[i];if(p.Key==="CAMPAIGN_ID"||P.Key.indexOf("SUBMISSION_DATE_")>-1){continue;}var n=[];for(var j=0;j<P.Selection.length;j++){n.push(new sap.ui.model.Filter(P.Key,"EQ",P.Selection[j]));}if(n.length>0){m.push(new sap.ui.model.Filter(n,false));}}var r;if(m.length>0){r=new sap.ui.model.Filter(m,true);}return r;},fnBindData:function(p,D){var o=this,v=o.getView(),i=o.byId("listBox");i.setAllowMultiSelect(p.Multiselect);var j=new sap.ui.core.ListItem({key:"{"+p.Key+"}",text:"{"+p.Text+"}"});var m=o.fnGetFilter(p);i.bindAggregation("items",{path:"/"+(D||o.oConfiguration.DataSource),filters:m,parameters:{select:p.Key+","+p.Text},template:j,sorter:new sap.ui.model.Sorter(p.Text,false)});if(p.Selection!==undefined&&p.Selection!==null&&p.Selection.length>0){i.getBinding("items").attachDataReceived(function(){i.setBusy(false);i.setSelectedKeys(p.Selection);});}var n=jQuery("#"+v.createId("listBox-list"));n.attr("aria-require",p.Mandatory||false);},_setListBox:function(o){var i=this,D,p,j=i.byId("listBox"),m=this.getParameterDialog(),P=o.Parameters,n=jQuery.map(P,function(v){return[v];});var s=o.ODataPath||C.getApplicationPath("sap.ino.config.URL_PATH_OD_ANALYTICS");if(n&&n[i.iParameterIndex]&&n[i.iParameterIndex].Key&&n[i.iParameterIndex].Key==="CAMPAIGN_ID"){D="AuthCampaignReports";p=new sap.ui.model.odata.v2.ODataModel(C.getBackendRootURL()+"/"+C.getApplicationPath("sap.ino.config.URL_PATH_OD_BACKOFFICE"),{disableHeadRequestForToken:true});p.setSizeLimit(10*1000);}else{D=undefined;p=new sap.ui.model.odata.v2.ODataModel(C.getBackendRootURL()+"/"+s,{disableHeadRequestForToken:true});}j.setModel(p);if(m&&m.getParent()){m.getParent().setBusy(true);}p.attachBatchRequestCompleted(function(){if(m.getParent()){m.getParent().setBusy(false);}j.setBusy(false);m.open();i.getModel("objectContext").setProperty("/listBoxVisible",true);i.getModel("objectContext").setProperty("/VBoxVisible",false);});i.fnBindData(n[i.iParameterIndex],D);},_bindCancelBtn:function(){var o=this,i=this.byId("parametercancelbutton");var j=function(){var _=o.byId("parameterDialog");o.iParameterIndex=0;_.close();if(o.oVBox.getItems().length===0){o.navigateBack();}};i.attachPress(j);},_nextPress:function(){var o=this;return function(){var i=o.oConfiguration,p=i.Parameters,P=jQuery.map(p,function(v){return[v];}),D=o.byId("datePicker"),j=o.byId("dialogLabel");var m=P[o.iParameterIndex];if(m.ControlType&&m.ControlType==="DatePicker"){if(m.Mandatory&&!D.getValue()){if(D.setValueState){D.setValueState(sap.ui.core.ValueState.Error);}return;}o.aTempParameter[o.iParameterIndex]={};o.aTempParameter[o.iParameterIndex].Selection=D.getValue();o.aTempParameter[o.iParameterIndex].SelectionString=D.getValue();o.aTempParameter[o.iParameterIndex].Key=m.Key;}else{var n=o.byId("listBox");var s=function(m){var t=true;var u=n.getSelectedItems();if(m.Mandatory&&u.length===0){n.addStyleClass("sapUiInoListBoxErr");t=false;}else{var v=[];var w=[];jQuery.each(u,function(I,y){v.push(y.getKey());w.push(y.getText().trim());});var x=w.join(", ");o.aTempParameter[o.iParameterIndex]={};o.aTempParameter[o.iParameterIndex].Selection=v;o.aTempParameter[o.iParameterIndex].SelectionString=x;o.aTempParameter[o.iParameterIndex].Key=m.Key;}return t;};if(!s(P[o.iParameterIndex])){return;}if((P&&P.length>1&&n.getModel().sServiceUrl.indexOf("analytics.xsodata")<0)||(P&&P.length===1&&P[0].Key!=="CAMPAIGN_ID")){var q=new sap.ui.model.odata.v2.ODataModel(C.getBackendRootURL()+"/"+(i.ODataPath||C.getApplicationPath("sap.ino.config.URL_PATH_OD_ANALYTICS")),{disableHeadRequestForToken:true});q.attachBatchRequestCompleted(function(){n.setBusy(false);});if(n.getBindingInfo("items").path.indexOf("AuthCampaignReports")>-1){n.removeAllItems();n.setModel(null);n.mBindingInfos.items.path="";}n.setModel(q);}n.setBusy(true);}o.iParameterIndex+=1;m=P[o.iParameterIndex];if(!m){o._goNext(null,P[o.iParameterIndex]);return;}j.setText(o.getText(m.DisplayName));j.setRequired(m.Mandatory||false);o.getModel("objectContext").setProperty("/listBoxVisible",false);o.getModel("objectContext").setProperty("/VBoxVisible",false);o.getModel("objectContext").setProperty("/datePickerVisible",false);if(m.ControlType&&m.ControlType==="DatePicker"){o.getModel("objectContext").setProperty("/datePickerVisible",true);o._goNext(null,P[o.iParameterIndex]);if(D){var r="";if(o.aTempParameter&&o.aTempParameter[o.iParameterIndex]){r=o.aTempParameter[o.iParameterIndex].Selection;}D.setValue(r);if(D.setValueState){D.setValueState(sap.ui.core.ValueState.None);}}}else{o.getModel("objectContext").setProperty("/listBoxVisible",true);o._goNext(o.fnBindData,P[o.iParameterIndex]);}};},_goNext:function(j,p){var o=this,D=o.getParameterDialog(),m=o.oConfiguration;var P=m.Parameters;var n=jQuery.map(P,function(v){return[v];});if(o.iParameterIndex===n.length){for(var i=0;i<n.length;i++){n[i].Selection=o.aTempParameter[i].Selection;n[i].SelectionString=o.aTempParameter[i].SelectionString;}o.iParameterIndex=0;D.close();o.freshViews(m.SelectedView);}else{if(o.iParameterIndex===n.length-1){o.byId("parameterbutton").setText(o.getText("BO_ANA_BUT_OK"));}if(j){j.call(o,p);}}},getReportParameter:function(){var o=this.oConfiguration,i=this;if(!o.Parameters){return;}var D=i.getParameterDialog();if(D&&D.isOpen()){if(f.checkMandatoryParameters(o)){D.close();}}i.getModel("objectContext").setProperty("/listBoxVisible",false);i.getModel("objectContext").setProperty("/datePickerVisible",false);i.getModel("objectContext").setProperty("/VBoxVisible",true);var j=i.byId("parameterbutton");i.iParameterIndex=i.iParameterIndex||0;i.aTempParameter=i.aTempParameter||[];var p=o.Parameters;var P=jQuery.map(p,function(v){return[v];});var m=P[i.iParameterIndex];if(m.ControlType&&m.ControlType==="DatePicker"){i.getModel("objectContext").setProperty("/datePickerVisible",true);D.open();}else{var n=i.byId("dialogLabel");n.setText(i.getText(m.DisplayName));n.setRequired(m.Mandatory||false);i._setListBox(o);}j.setText(P.length>1?i.getText("BO_ANA_BUT_NEXT"):i.getText("BO_ANA_BUT_OK"));if(!i.hasNextBtnEvent){i.hasNextBtnEvent=true;j.attachPress(i._nextPress());i._bindCancelBtn();}},getParameterDialog:function(){if(!this._oParameterDialog){this.hasNextBtnEvent=false;this._oParameterDialog=this.createFragment("sap.ino.vc.analytics.fragments.ParameterDialog");this.getView().addDependent(this._oParameterDialog);}return this._oParameterDialog;},onFilter:function(){this.getReportParameter();},onShowFilter:function(o){if(!this._oPopover){this._oPopover=this.createFragment("sap.ino.vc.analytics.fragments.Popover");this.getView().addDependent(this._oPopover);}if(this._oPopover.isOpen()){this._oPopover.close();}else{this._oPopover.destroyContent();var j=this;var m=new V({width:"500px"});var p=this.oConfiguration.Parameters;if(p){var n=true;jQuery.each(p,function(I,P){if(P.SelectionString){var s=P.SelectionString.split(",");var r=s.length;for(var i=0;i<r;i++){if(n){m.addContent(j.createFilterRow("{i18n>BO_ANA_FLD_SELECT_PARAMETER}"));n=false;}if(!i){m.addContent(j.createFilterRow("{i18n>"+P.DisplayName+"}",s[i]));}else{m.addContent(j.createFilterRow(undefined,s[i]));}}}});}var v=f.getViewConfiguration(this.oConfiguration).FilterText;if(v){m.addContent(j.createFilterRow("{i18n>BO_ANA_FLD_LOCAL_VIEW_FILTER}"));jQuery.each(v,function(K,s){m.addContent(j.createFilterRow(K,s));});}if(m.getContent().length===0){m.addContent(j.createFilterRow("{i18n>BO_ANA_FLD_NO_FILTER_SET}"));}this._oPopover.addContent(m);var q=o.getSource();jQuery.sap.delayedCall(0,this,function(){this._oPopover.openBy(q);});}},onAfterShow:function(){if(this.oConfiguration&&!f.checkMandatoryParameters(this.oConfiguration)){this.getReportParameter();}},onAfterHide:function(){var i=this.byId("listBox");if(i){i.setModel(null);}this.oConfiguration=null;if(this._oParameterDialog){this.getView().removeDependent(this._oParameterDialog);this._oParameterDialog.destroy();this._oParameterDialog=null;}},createFilterRow:function(D,v){var o;if(D){o=new L({text:D,width:"150px"});}var i;if(v){i=new L({text:v,width:"250px"});}else{o.setDesign(h.Bold);return new H({content:[new k({alignItems:"Center",height:"40px",width:"150px",items:[o]})]});}return new H({content:[new k({alignItems:"Center",height:"40px",width:"150px",items:[o]}),new k({alignItems:"Center",height:"40px",width:"250px",items:[i]})]});},resetPendingChanges:function(){var m=this.getObjectModel();if(m&&m.hasPendingChanges()){m.revertChanges();}m.revertChanges();this._oReset=true;},hasPendingChanges:function(){if(this._oReset===true){this._oReset=false;return false;}if(!this.oSmartChart||!this.oSmartTable){return false;}if(!this.getObjectModel().getConfiguration()){return false;}if(this.getObjectModel().getKey()<0){if(this.oConfiguration.Parameters&&this.oConfiguration.Parameters.Campaign.Mandatory){var i=!!this.oConfiguration.Parameters.Campaign.Selection[0];return i;}else{if(this.getObjectModel().getConfiguration().Description){delete this.getObjectModel().getConfiguration().Description;}if(this.getObjectModel().getConfiguration().Title){delete this.getObjectModel().getConfiguration().Title;}}}var v=this.getObjectModel().getConfiguration();if(v.Parameters&&typeof(v.Parameters.Campaign.Selection[0])==="number"){v.Parameters.Campaign.Selection[0]=v.Parameters.Campaign.Selection[0].toString();}if(JSON.stringify(v)!==JSON.stringify(this.oConfiguration)){return true;}var j,m,n;var o=this.oSmartChart.fetchVariant();if(!this._oSeletedTableView){if(!o||!o.dimeasure){j=this.sChartType;m=this.aDimensions;n=this.aMeasures;}else{j="viz/"+this._formatChartType(o.dimeasure.chartTypeKey);m=[];n=[];jQuery.each(o.dimeasure.dimeasureItems,function(I,w){if(!w.visible){return true;}else{if(w.role.indexOf("axis")>=0){n.push(w.columnKey);}else{if(w.role==="category"||w.role==="series"){m.push(w.columnKey);}}}});}}else{var p=this.oSmartTable.fetchVariant();if(!p||!p.columns){j=this.sChartType;m=this.aDimensions;n=this.aMeasures;}else{j=this.sChartType;m=[];n=[];var q=this.oSmartTable.getTable();var t=q.getColumns();var r=this.oSmartChart.getChart();var D=r.getDimensions();var s=r.getMeasures();jQuery.each(t,function(w,x){if(!x.getVisible()){return true;}else{jQuery.each(D,function(I,y){if(y.getName()===x.getLeadingProperty()){m.push(y.getName());}});jQuery.each(s,function(I,y){if(y.getName()===x.getLeadingProperty()){n.push(y.getName());}});}});}}var u=this.getObjectModel().getConfiguration().Views[this.iSelectedView];if(u.Chart.Type!==j||JSON.stringify(u.Dimensions)!==JSON.stringify(m)||JSON.stringify(u.Measures)!==JSON.stringify(n)){return true;}return false;},storeConfiguration:function(){var i,j,m;var o=this.oSmartChart.fetchVariant();if(!this._oSeletedTableView){if(!o||!o.dimeasure){i=this.sChartType;j=this.aDimensions;m=this.aMeasures;}else{i="viz/"+this._formatChartType(o.dimeasure.chartTypeKey);j=[];m=[];jQuery.each(o.dimeasure.dimeasureItems,function(I,u){if(!u.visible){return true;}else{if(u.role.indexOf("axis")>=0){m.push(u.columnKey);}else{if(u.role==="category"||u.role==="series"){j.push(u.columnKey);}}}});}}else{var n=this.oSmartTable.fetchVariant();if(!n||!n.columns){i=this.sChartType;j=this.aDimensions;m=this.aMeasures;}else{i=this.sChartType;j=[];m=[];var p=this.oSmartTable.getTable();var t=p.getColumns();var q=this.oSmartChart.getChart();var D=q.getDimensions();var r=q.getMeasures();jQuery.each(t,function(u,v){if(!v.getVisible()){return true;}else{jQuery.each(D,function(I,w){if(w.getName()===v.getLeadingProperty()){j.push(w.getName());}});jQuery.each(r,function(I,w){if(w.getName()===v.getLeadingProperty()){m.push(w.getName());}});}});}if(!o||!o.dimeasure){this.aDimensions=j;this.aMeasures=m;}}var s=this.oConfiguration;s.SelectedView=this.iSelectedView;s.Views[this.iSelectedView].Chart.Type=i;s.Views[this.iSelectedView].Measures=m;s.Views[this.iSelectedView].Dimensions=j;if(o){if(o.filter){s.Views[this.iSelectedView].Filters=o.filter.filterItems;}if(o.sort){s.Views[this.iSelectedView].Sorters=o.sort.sortItems;}}},onExport:function(o){if(this.oSmartTable.getVisible()){var v=this.getModel("view");if(v){var i=v.getProperty("/List");if(!i){v.setProperty("/List",{});}v.setProperty("/List/HIDE_PPT_EXPORT",true);}this.onListExport(o);}else{this.onChartExportSVG(o);}},getExportControl:function(){return this.oSmartTable.getTable();},getExportChartControl:function(){return this.oSmartChart._getVizFrame();},getChartTitle:function(){return this.oChartPage.getText();},initFullScreen:function(){if(this._bFullscreenReset===undefined||this._bFullscreenReset===true){this._bPreviouslyFullscreen=this.getFullScreen();}this.setFullScreen(true);this._bFullscreenReset=false;},_convertChartSetingToTable:function(){var r=jQuery.extend(true,{},this.oSmartChart.fetchVariant()),t=this;var i=[],o,s;r.columns={columnsItems:[]};var j=[].concat(this.oSmartChart.getChart().getVisibleDimensions()).concat(this.oSmartChart.getChart().getVisibleMeasures());var m=this.oSmartTable._aColumnKeys;jQuery.each(j,function(n,p){o=t.oSmartChart.getChart().getDimensionByName(p);if(o){s=o.getTextProperty();}jQuery.each(m,function(q,u){if(p===u||(s&&s===u)){r.columns.columnsItems.push({"columnKey":u,"visible":true});i.push(u);}});});delete r.dimeasure;this._createSmartTable(i.join(","));this.oSmartTable.applyVariant(r);},_convertTableSetingToChart:function(){var r=jQuery.extend(true,{},this.oSmartTable.fetchVariant());r.dimeasure={chartTypeKey:this.oSmartChart.getChart().getProperty("chartType"),dimeasureItems:[]};var i=[].concat(this.oSmartChart.getChart().mAggregations.dimensions).concat(this.oSmartChart.getChart().mAggregations.measures);jQuery.each(this.oSmartTable.getTable().mAggregations.columns,function(j,m){if(m.getProperty("visible")){jQuery.each(i,function(n,o){if(o.getProperty("name")===m.getProperty("leadingProperty")){r.dimeasure.dimeasureItems.push({"columnKey":m.getProperty("leadingProperty"),"visible":true,"role":o.getRole()});}});}});delete r.columns;return r;}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.attachment.Attachment.controller')){jQuery.sap.declare('sap.ino.vc.attachment.Attachment.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/attachment/Attachment.controller",["sap/ino/vc/commons/BaseBlockController","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ino/commons/models/object/Attachment","sap/ino/commons/application/Configuration","sap/ino/vc/attachment/AttachmentMixin"],function(B,J,M,A,C,a){"use strict";var b=A.getEndpointURL();return B.extend("sap.ino.vc.attachment.Attachment",jQuery.extend({},a,{onInit:function(){B.prototype.onInit.apply(this,arguments);if(!this.getModel("local")){this.setModel(new J({ATTACHMENT_UPLOAD_URL:b}),"local");}},onFileRenamed:function(e){var t=this;t.getView().setBusy(true);var o=A.rename({id:e.getParameter("documentId"),fileName:e.getParameter("fileName")});o.always(function(){t.getView().setBusy(false);});o.fail(function(r){if(r&&r.MESSAGES&&r.MESSAGES.length>0){M.show(r.MESSAGES[0].MESSAGE_TEXT,{autoClose:false});}});},onAfterRendering:function(){this._attachmentMixinInit({attachmentId:"Attachments",updateObject:function(o){},uploadSuccess:function(o,r){o.addAttachment({"CREATED_BY_NAME":C.getCurrentUser().NAME,"ATTACHMENT_ID":r.attachmentId,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType,"CREATED_AT":new Date()});}});}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.blog.Display.controller')){jQuery.sap.declare('sap.ino.vc.blog.Display.controller');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/blog/Display.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/commons/models/object/Blog","sap/m/MessageToast","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration","sap/ino/commons/formatters/BaseFormatter","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/vc/commons/mixins/FollowMixin"],function(B,a,M,T,J,C,b,c,F){"use strict";return B.extend("sap.ino.vc.blog.Display",jQuery.extend({},T,c,F,{routes:["blog-display"],onInit:function(){B.prototype.onInit.apply(this,arguments);this.setViewProperty("/EDIT",false);},onRouteMatched:function(){B.prototype.onRouteMatched.apply(this,arguments);this.setHelp("CAMPAIGN_BLOG_MODIFY");},createObjectModel:function(o){var s={nodes:["Root"],actions:["modify","del","unPublish"],continuousUse:true,readSource:{model:this.getDefaultODataModel()}};var m=new a(o,s);m.setProperty("/InitRefObjectId",o);return m;},getODataEntitySet:function(){return"CampaignBlogsFull";},onEdit:function(){var o=this.getObjectModel();this.navigateTo("blog-edit",{id:o.getKey()});},onOpenCreator:function(e){var s=e.getSource();var i=s.getBindingContext("data").getProperty("CREATED_BY_ID");if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(s,i);},onCancel:function(){this.navigateBack();},onPublish:function(){this._executeAction("majorPublishSubmit");},onPublishAction:function(e){var i=e.getParameter("item");if(!i){return;}this._executeAction(i.getProperty("key")||"publishSubmit");},onUnPublish:function(){this._executeAction("unPublishSubmit");},onCampaignPressed:function(e){e.preventDefault();var i=this.getObjectModel().getProperty("/CAMPAIGN_ID");this.navigateTo("campaign",{id:i});},onImgPressed:function(e){sap.m.URLHelper.redirect(e.oSource.getProperty("src"),true);},onIconPressed:function(e){var i=e.oSource.oParent.getItems();if(i&&i.length>=2){sap.m.URLHelper.redirect(i[2].getProperty("href"),true);}},showPopupTagCard:function(e){this._bIsTokenPressed=true;if(!this._oPopover){this._oPopover=sap.ui.xmlfragment("sap.ino.vc.tag.fragments.TagCardPopover",this);this.getView().addDependent(this._oPopover);}var t=e.getSource();var p="/SearchTagsAll(searchToken='',ID="+t.getKey()+")";var d=this.getModel("data");var f=this;d.read(p,{async:true,success:function(D){var m=new J();m.setData(D);f._oPopover.setModel(m,"Tag");jQuery.sap.delayedCall(0,f,function(){f._oPopover.openBy(t);});}});},_executeAction:function(A){var o=this;o.resetClientMessages();o.executeObjectAction(A);},iconUrl:function(f){var e=this._splitFilename(f).extension;if(jQuery.type(e)==='string'){e=e.toLowerCase();}switch(e){case'.bmp':case'.jpg':case'.jpeg':case'.png':return"sap-icon://camera";case'.csv':case'.xls':case'.xlsx':return'sap-icon://excel-attachment';case'.doc':case'.docx':case'.odt':return'sap-icon://doc-attachment';case'.pdf':return'sap-icon://pdf-attachment';case'.ppt':case'.pptx':return'sap-icon://ppt-attachment';case'.txt':return'sap-icon://document-text';default:return'sap-icon://document';}},_splitFilename:function(s){var r={};var n=s.split('.');if(n.length===1){r.extension='';r.name=n.pop();return r;}r.extension='.'+n.pop();r.name=n.join('.');return r;}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.blog.Modify.controller')){jQuery.sap.declare('sap.ino.vc.blog.Modify.controller');jQuery.sap.require('sap.m.Token');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.HTML');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/blog/Modify.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/m/Token","sap/ino/commons/models/object/Blog","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/core/ResizeHandler","sap/ui/Device","sap/ui/core/HTML","sap/ino/commons/models/object/Attachment","sap/m/MessageToast","sap/ino/commons/application/Configuration"],function(B,T,a,b,R,D,H,A,M,C){"use strict";return B.extend("sap.ino.vc.blog.Modify",jQuery.extend({},b,{routes:["blog-edit","blog-create"],onInit:function(){B.prototype.onInit.apply(this,arguments);this._dViewShown=jQuery.Deferred();this.setViewProperty("/EDIT",true);this.setViewProperty("/ATTACHMENT_UPLOAD_URL",A.getEndpointURL());this._bindingTags();},onRouteMatched:function(){var c=this;B.prototype.onRouteMatched.apply(c,arguments);c._destroyRTE();jQuery.when(this._dViewShown).done(function(){c._initRTE();});c.setHelp("CAMPAIGN_BLOG_MODIFY");},createObjectModel:function(o,r,c){var k=o;var s={nodes:["Root"],actions:["submit","publish","majorPublishSubmit","publishSubmit","del"],continuousUse:true,concurrencyEnabled:true,readSource:{model:this.getDefaultODataModel()}};if(!k){var q=c["?query"]||{};try{k={OBJECT_TYPE_CODE:"CAMPAIGN",OBJECT_ID:q.campaign?parseInt(q.campaign,10):0,CAMPAIGN_ID:q.campaign?parseInt(q.campaign,10):0,NAME:q.title,DESCRIPTION:q.description,Tags:q.tags&&q.tags.split(",")};}catch(e){jQuery.sap.log.error("Failed parsing creation arguments",e,"sap.ino.vc.blog.Modify.controller");}}return new a(k,s);},onAfterHide:function(){this._dViewShown=jQuery.Deferred();this._destroyRTE();},onCampaignPressed:function(){var i=this.getObjectModel().getProperty("/CAMPAIGN_ID");this.navigateTo("campaign",{id:i},true);},onFileUploaderChange:function(e){var f=e.getSource();var F=e.getParameter("files");f.setBusy(true);A.prepareFileUploader(f,F);},onFileUploaderComplete:function(e){var r=A.parseUploadResponse(e.getParameter("responseRaw"));var f=e.getSource();if(r){var o=this.getObjectModel();o.getMessageParser().parse(r);if(r.success){o.setTitleImage({"ATTACHMENT_ID":r.attachmentId,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType});}else{M.show(this.getText("BLOG_OBJECT_MSG_TITLE_IMAGE_FAILED"));}}else{M.show(this.getText("BLOG_OBJECT_MSG_TITLE_IMAGE_ERROR"));}f.setBusy(false);f.clear();},onTagChanged:function(e){var m=e.getSource();var v=e.getParameter("value");if(!v){return;}if(!e.getSource().getAggregation("tokenizer")){return;}var t=e.getSource().getAggregation("tokenizer").getAggregation("tokens");var c=v.split(",");c.forEach(function(s){s=s.trim();if(s===""){return;}var o=new T({text:s});var d;t.forEach(function(o){if(o.getProperty("text")===s){d=true;return;}});if(!d){o.bApplicationCreated=true;m.addToken(o);}});m.setValue("");},onTagTokenChanged:function(e){var m=e.getSource();if(!e.getSource().getAggregation("tokenizer")){return;}m.setValue("");},onSave:function(){this._executeAction("submit");},onPublish:function(){this._executeAction("majorPublishSubmit");},onPublishAction:function(e){var i=e.getParameter("item");if(!i){return;}this._executeAction(i.getProperty("key")||"publishSubmit");},onUnPublish:function(){this._executeAction("unPublishSubmit");},onAfterShow:function(){this._dViewShown.resolve();},_executeAction:function(s){var c=this;c.resetClientMessages();var o=c.getObjectModel();var i=o.isNew();this._CheckContentAttachments(o);var m=c.executeObjectAction(s);m.done(function(){if(i&&s==="submit"){c.navigateTo("blog-edit",{id:o.getKey()},true);}else{c.navigateTo("blog-display",{id:o.getKey()},true);}});},_initDetails:function(){this._sTitleText=undefined;this._sDescriptionText=undefined;this._aTags=undefined;},_bindingTags:function(){this.addMultiInputHandling(this.byId("Tags"),{childNodeName:"Tags",childNodeNameSingular:"Tag",suggestion:{key:"NAME",text:"NAME",path:"data>/SearchTagsParams(searchToken='$suggestValue')/Results",filter:[],sorter:[]},token:{key:"NAME",text:"NAME"}});},_onResize:function(e){var v;var h;var o;if(e){v=e.control;h=e.size.height;o=e.oldSize.height;}else{v=this.getView();h=v.$().height();o=0;}var r=v.getController()._getRTE();if(!r||r.getMetadata().getName()!=="sap.ino.controls.RichTextEditor"){return;}if(Math.abs(h-o)>0){var c=v.$().find(".sapInoBlogModify");var m=parseInt(c.css("min-height"),10)||400;var i=parseInt(c.css("max-height"),10)||600;h=h-600;h=h<m?m:h;h=h>i?i:h;r.setHeight(h+"px");}},_initRTE:function(){var t=this;if(!D.system.desktop){return;}this._destroyRTE();var r=this.byId("rteContainer");var o;t._TextControlID="richtextBlogControl_"+new Date().getTime();jQuery.sap.require("sap.ino.controls.RichTextEditor");o=new sap.ino.controls.RichTextEditor({id:this.createId(t._TextControlID),width:"100%",editable:true,editorType:"TinyMCE4",height:"300px",showGroupInsert:true,showGroupLink:true,showGroupFont:true,beforeEditorInit:function(c){c.mParameters.configuration.plugins=c.mParameters.configuration.plugins.replace("image,","");c.mParameters.configuration.plugins=c.mParameters.configuration.plugins.replace("powerpaste","paste,imagetools");c.mParameters.configuration.paste_data_images=true;c.mParameters.configuration.automatic_uploads=true;c.mParameters.configuration.images_upload_handler=function(f,s,d){var F=f.blob();if(F){A.uploadFile(F).done(function(e){var g=t.getObjectModel();s(C.getAttachmentDownloadURL(e.attachmentId));g.setProperty("/DESCRIPTION",jQuery.sap._sanitizeHTML(tinymce.activeEditor.getContent()));}).fail(function(){d();M.show(t.getText("IDEA_OBJECT_MSG_TITLE_IMAGE_CROP_FAILED"));});}};c.mParameters.configuration.paste_postprocess=function(e,f){tinymce.activeEditor.uploadImages();};}});o.attachReady(function onRTEReady(){this.bindProperty("value",{model:"object",path:"DESCRIPTION"});t._onResize();if(!this._sResizeRegId){this._sResizeRegId=R.register(t.getView(),t._onResize);}});setTimeout(function(){r.destroyItems();r.addItem(o);},500);},_getRTE:function(){return this.byId(this._TextControlID);},_destroyRTE:function(){if(this._sResizeRegId){R.deregister(this._sResizeRegId);}var r=this._getRTE();if(r){r.destroy();}},alternativeBlogBy:function(v,i,c,d,e,s){if(s!=="sap.ino.config.BLOG_PUBLISHED"){return this.formatter.alternativeBy(v,i,c,d,e);}else{return this.formatter.alternativeBy(v,i,c,e,d);}},_CheckContentAttachments:function(m){var c=m.getProperty("/DESCRIPTION"),d=[],n=[],o=m.getProperty("/ContentAttachments");if(!c){return;}var r=new RegExp("<img.*attachment_download\.xsjs/(\\d+)\"","g"),e;do{e=r.exec(c);if(e&&e.length===2){d.push(e[1]);}}while(e!==null);var t=false,f=void 0;for(var i=0;i<=d.length-1;i++){t=false;f=undefined;for(var j=0;j<=o.length-1;j++){if(Number(d[i])===o[j].ATTACHMENT_ID){t=true;f=o[j];break;}}if(t){n.push(f);}else{n.push({ID:m.getNextHandle(),ATTACHMENT_ID:Number(d[i])});}}m.setProperty("/ContentAttachments",n);}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.CampaignCommentList.controller')){jQuery.sap.declare('sap.ino.vc.campaign.CampaignCommentList.controller');jQuery.sap.require('sap.ui.core.mvc.ViewType');sap.ui.define("sap/ino/vc/campaign/CampaignCommentList.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ino/commons/models/object/Campaign","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/application/WebAnalytics","sap/ui/core/mvc/ViewType"],function(C,a,T,W,V){"use strict";return C.extend("sap.ino.vc.campaign.CampaignCommentList",jQuery.extend({},T,{routes:["campaign-comment"],onInit:function(){C.prototype.onInit.apply(this,arguments);},onRouteMatched:function(e){var t=this;var A=e.getParameter("arguments");var c=parseInt(A.id,10);this.bindDefaultODataModel(c,function(){var b=t.getDefaultODataModelEntity(c);if(b){t.updateBackgroundColor(b.COLOR_CODE);t.setBackgroundImages(b.CAMPAIGN_BACKGROUND_IMAGE_ID,b.CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID);}});var o=this.byId("campaignCommentListComment");o.data("object_id",c);o.getController()._commentMixinResetCommentModel();},hasBackgroundImage:function(){return true;},getODataEntitySet:function(){return"CampaignFull";}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.CampaignFeedList.controller')){jQuery.sap.declare('sap.ino.vc.campaign.CampaignFeedList.controller');jQuery.sap.require('sap.ui.core.mvc.ViewType');sap.ui.define("sap/ino/vc/campaign/CampaignFeedList.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ino/commons/models/object/Campaign","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/application/WebAnalytics","sap/ui/core/mvc/ViewType","sap/ino/vc/follow/mixins/FeedsMixin"],function(C,a,T,W,V,F){"use strict";return C.extend("sap.ino.vc.campaign.CampaignFeedList",jQuery.extend({},T,F,{routes:["campaign-feeds"],onInit:function(){C.prototype.onInit.apply(this,arguments);},getCurrentView:function(){var c=this.getView().getContent();var p=(c&&c.length>0)?c[1]:undefined;if(p){if(p.getContent().length>0){return p.getContent()[0];}}return undefined;},onRouteMatched:function(e){var t=this;var A=e.getParameter("arguments");var c=parseInt(A.id,10);this.bindDefaultODataModel(c,function(){var d=t.getDefaultODataModelEntity(c);if(d){t.updateBackgroundColor(d.COLOR_CODE);t.setBackgroundImages(d.CAMPAIGN_BACKGROUND_IMAGE_ID,d.CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID);}});var o=this.getCurrentView();if(o&&o.getController){var b=o.getController();if(typeof b.onRouteMatched==="function"){b.onRouteMatched(e);}}this.setHelp("CAMPAIGN_FEED");},onRefresh:function(){var c=this.getCurrentView();if(c&&c.getController()){var o=c.getController();if(typeof o.onRefresh==="function"){o.onRefresh();}}},hasBackgroundImage:function(){return true;},getODataEntitySet:function(){return"CampaignFull";}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.CampaignManagerList.controller')){jQuery.sap.declare('sap.ino.vc.campaign.CampaignManagerList.controller');sap.ui.define("sap/ino/vc/campaign/CampaignManagerList.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ino/vc/commons/TopLevelPageFacet"],function(C,T){"use strict";return C.extend("sap.ino.vc.campaign.CampaignManagerList",jQuery.extend({},T,{routes:["campaign-managerlist"],onInit:function(){C.prototype.onInit.apply(this,arguments);},onRouteMatched:function(e){var a=e.getParameter("arguments");var c=parseInt(a.id,10);this.bindDefaultODataModel(c);},getODataEntitySet:function(){return"CampaignFull";}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.mixins.RegistrationMixin')){jQuery.sap.declare('sap.ino.vc.campaign.mixins.RegistrationMixin');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/campaign/mixins/RegistrationMixin",["sap/ino/vc/idea/mixins/BaseActionMixin","sap/ino/vc/commons/BaseController","sap/ino/commons/models/aof/PropertyModel","sap/m/MessageToast","sap/ino/commons/models/object/Registration","sap/ui/core/IconPool","sap/ui/model/json/JSONModel"],function(B,a,P,M,R,I,J){"use strict";var b=function(){throw"Mixin may not be instantiated directly";};b.Register=function(e){var s=this;var c=e.getSource();var i=c.getBindingContext("data").getProperty("ID");var v=c.getBindingContext("data").getProperty("REGISTER_ID");var d=c.getBindingContext('data').getProperty('REGISTER_STATUS');var f=c.getBindingContext('data').getProperty('IS_REGISTER_AUTO_APPROVE');var g,t;if(c.setEnabled){c.setEnabled(false);}if(!v){g=R.Register(v,i);t='REGISTER_MSG_REGISTER';}else if(d===3){g=R.Register(null,i);t='REGISTER_MSG_REGISTER';}else{g=R.Leave(v,i);t='REGISTER_MSG_LEAVE';}if(f&&f===1&&t!=='REGISTER_MSG_LEAVE'){t='REGISTER_MSG_SUCCESS';}g.done(function(){c.setEnabled(true);M.show(s.getText(t));if(f&&f===1&&t!=='REGISTER_MSG_LEAVE'){s.navigateTo('campaignlist');s.navigateTo("campaign",{id:i});}if(d===2){P.invalidateCachedProperties('sap.ino.xs.object.campaign.Campaign',i);return s.navigateTo('campaignlist');}if(s.isGlobalSearch){s.getSearchResult(s.getViewProperty("/SEARCH_QUERY"));}}).fail(function(){c.setEnabled(true);M.show(s.getText('MSG_CAMPAIGN_REGISTER_ERROR'));});};b.Approved=function(e){var s=this;var c=e.getSource();var v=c.getBindingContext("data").getProperty("REGISTER_ID");var d=R.Approved(v);var t='REGISTER_MSG_APPROVED';if(c.setEnabled){c.setEnabled(false);}d.done(function(){M.show(s.getText(t));c.setEnabled(true);s.bindList();}).fail(function(){M.show(s.getText('REGISTER_ERROR_MASSAGE'));});};b.Rejected=function(e){var s=this;var c=e.getSource();var v=c.getBindingContext("data").getProperty("REGISTER_ID");var t='REGISTER_MSG_REJECTED';var r=this.getRejectReasonDialog();var m=new J({REJECT_REASON:"",VALUE:v});r.setModel(m,"register");r.open();};b.Leave=function(e){var s=this;var c=e.getSource();var v=c.getBindingContext("data").getProperty("REGISTER_ID");var d=R.Leave(v);var t='REGISTER_MSG_LEAVE';if(c.setEnabled){c.setEnabled(false);}d.done(function(){M.show(s.getText(t));c.setEnabled(true);}).fail(function(){M.show(s.getText('REGISTER_ERROR_MASSAGE'));});};b.isVisabled=function(i,c,s){return(!!i&&!!c)||(!!i&&!c&&s===2);};b.isVisabledForApprove=function(s){return s===1;};b.isVisabledForList=function(i,c,s){return!!i&&!!c&&s!==2;};b.isEnabled=function(s,d,c){if(s!==1){if(c===1){if(d===0){return true;}else{return false;}}else{return true;}}else{return false;}};b.onApprovalListSelectionChange=function(e){var t=this;var s=e.getParameter("selected");var S=e.getSource();var d=S.getBindingContext("data").getObject();if(!this._oSelectionMap){this._oSelectionMap=[];}if(!this._oSelectedCheckBox){this._oSelectedCheckBox=[];}function c(_){var o=t.byId("sapInoMassRegisterAcceptBtn");var f=t.byId("sapInoMassRegisterRejectBtn");if(o&&f){o.setEnabled(_.length>0);f.setEnabled(_.length>0);}}this.actionButtonEnabledStatus=c;if(s){this._oSelectionMap.push(d.REGISTER_ID);this._oSelectedCheckBox.push(S);}else{var i=this._oSelectionMap.indexOf(d.REGISTER_ID);this._oSelectionMap.splice(i,1);}c(this._oSelectionMap);};b.onApprovalMassAction=function(e){var r=this._oSelectionMap;var s=this._oSelectedCheckBox;var c=this;var d=e.getSource().getCustomData();var S=d[0].getValue()*1?"sap.ino.config.REGISTER_APPROVED":"sap.ino.config.REGISTER_REJECTED";var t=d[0].getValue()*1?"OBJECT_MSG_REG_ACCEPT_SUCCESS":"OBJECT_MSG_REG_REJECT_SUCCESS";var E=d[0].getValue()*1?"REGISTER_APPROVE_MSG_ERROR":"REGISTER_REJECT_MSG_ERROR";var o={parameters:{ids:r,status:S}};if(d[0].getValue()*1){var m=a.prototype.executeObjectAction.call(this,R,"massUpdate",o);m.done(function(){M.show(c.getText(t));c.bindList();c._oSelectionMap=[];}).fail(function(){M.show(c.getText(E));for(var i=0;i<s.length;i++){s[i].setSelected(false);}});r=[];this.actionButtonEnabledStatus.call(this,r);}else{var f=this.getRejectReasonDialog();var g=new J({REJECT_REASON:"",MASS_ACTION_REJECT:true});f.setModel(g,"register");f.open();}};b.transText=function(s){var t;switch(s){case 0:t='REGISTER_TEXT_REGISTER';break;case 1:t='REGISTER_TEXT_PENDING';break;case 2:t='REGISTER_TEXT_LEAVE';break;case 3:t='REGISTER_TEXT_REGISTER';break;default:t='REGISTER_TEXT_REGISTER';break;}return this.getText(t);};b.transTooltip=function(s,d,c){var t;if(c===1&&d===1){t='REGISTER_TOOLTIP_REGISTER_DISABLED';return this.getText(t);}switch(s){case 0:t='REGISTER_TOOLTIP_REGISTER';break;case 1:t='REGISTER_TOOLTIP_PENDING';break;case 2:t='REGISTER_TOOLTIP_LEAVE';break;case 3:t='REGISTER_TOOLTIP_REGISTER';break;default:t='REGISTER_TOOLTIP_REGISTER';break;}return this.getText(t);};b.transIcon=function(s){var i;switch(s){case 0:i=I.getIconURI('register','InoIcons');break;case 1:i=I.getIconURI('pending','InoIcons');break;case 2:i=I.getIconURI('journey-depart');break;case 3:i=I.getIconURI('register','InoIcons');break;default:i=I.getIconURI('register','InoIcons');break;}return i;};b.getRejectReasonDialog=function(){if(!this._rejectReasonDialog){this._rejectReasonDialog=this.createFragment("sap.ino.vc.campaign.fragments.RejectReasonDialog",this.getView().getId());this.getView().addDependent(this._rejectReasonDialog);}return this._rejectReasonDialog;};b.onHandleRejectCancel=function(e){var d=this.getRejectReasonDialog();var m=d.getModel("register");d.close();};b.onHandleRejectOK=function(e){var s=this;var t='REGISTER_MSG_REJECTED';var r=this.getRejectReasonDialog();var m=r.getModel("register");var v=m.getProperty("/VALUE");var c=m.getProperty("/REJECT_REASON");r.setBusy(true);if(!m.getProperty("/MASS_ACTION_REJECT")){var d=R.Rejected(v,c);d.done(function(){M.show(s.getText(t));r.setBusy(false);r.close();s.bindList();}).fail(function(){r.setBusy(false);M.show(s.getText('REGISTER_ERROR_MASSAGE'));});}else{var f=this._oSelectionMap;var g=this._oSelectedCheckBox;var S="sap.ino.config.REGISTER_REJECTED";var h="OBJECT_MSG_REG_REJECT_SUCCESS";var E="REGISTER_REJECT_MSG_ERROR";var o={parameters:{ids:f,status:S,REASON:c}};var j=a.prototype.executeObjectAction.call(this,R,"massUpdate",o);j.done(function(){M.show(s.getText(h));r.setBusy(false);s.bindList();s._oSelectionMap=[];r.close();}).fail(function(){r.setBusy(false);M.show(s.getText(E));for(var i=0;i<g.length;i++){g[i].setSelected(false);}});f=[];this.actionButtonEnabledStatus.call(this,f);}};b.onRejectReasonLiveChange=function(e){var s=e.getSource();var r=this.byId("rejectReasonBtn");if(s.getValue().length>0){r.setEnabled(true);}else{r.setEnabled(false);}};return b;});};if(!jQuery.sap.isDeclared('sap.ino.vc.comment.CommentMixin')){jQuery.sap.declare('sap.ino.vc.comment.CommentMixin');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/comment/CommentMixin",["sap/ui/core/mvc/ViewType","sap/ino/vc/commons/BaseObjectController","sap/ino/commons/models/object/IdeaFollow","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel"],function(V,B,I,C,J){"use strict";var a=function(){throw"Mixin may not be instantiated directly";};a.commentMixinInit=function(s){this._commentMixinSettings=s;this.setViewProperty("/USER_IMAGE_ID",this.getOwnerComponent().getCurrentUserImageId());this._commentMixinResetCommentModel();};a._commentMixinResetCommentModel=function(){this._commentMixinSetCommentModel(null);this._commentMixinGetCommentModel();};a._commentMixinInitCommentModel=function(o){var s={continuousUse:true,readSource:{model:this.getDefaultODataModel()}};var m=this.getView().data("modelObjectType");jQuery.sap.require(m);var b=jQuery.sap.getObject(m,0);var M=new b({OBJECT_ID:o},s);this._commentMixinSetCommentModel(M);};a._commentMixinSetCommentModel=function(m){this.getView().setModel(m,"comment");};a._commentMixinGetCommentModel=function(){if(!this.getView().getModel("comment")){var o=this.getView().data("object_id")||(this.getModel("object")&&this.getModel("object").getProperty("/ID"));if(o>0){this._commentMixinInitCommentModel(o);}}return this.getView().getModel("comment");};a.commentMixinSubmit=function(e){var b=e.getSource();b.setEnabled(false);var v=this.getView();var m=this._commentMixinGetCommentModel();var t=v.data("modelObjectType");var s=this._commentMixinSettings.successMessageKey;v.setBusy(true);var c=B.prototype.executeObjectAction.call(this,"create",{messages:{success:s},objectModelExt:m});var d=this;c.done(function(){d._commentMixinResetCommentModel();d._commentMixinRefresh();d.onVotedFollow(t);});c.always(function(){v.setBusy(false);b.setEnabled(true);});};a.onVotedFollow=function(t){var b=this;var i=this.getModel("object");if(i&&i.getProperty("/AUTO_FOLLOW")){var A=i.getProperty("/AUTO_FOLLOW");var f=i.getProperty("/FOLLOW");var c=i.getProperty("/SubmitterContributorsCoach");var p=c.filter(function(s){return s.IDENTITY_ID===C.getCurrentUser().USER_ID;});if(t==="sap.ino.commons.models.object.IdeaComment"&&A&&!f&&!p.length){var d=i.getProperty("/ID");var F=I.follow(d,"IDEA",0);F.done();}}};a.commentMixinOnUserPressed=function(e){var s=e.getSource();var d=e.getParameter("domRef");var c=s.getBindingContext("data");var i=c.getProperty("CHANGED_BY_ID");if(d){var r=sap.ui.getCore().byId(d.id);}if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}if(r){this.oIdentityCardView.getController().open(r,i);}else{this.oIdentityCardView.getController().open(s,i);}};a.commentMixinOnDetailPress=function(e){this._commentMixinResetCommentModel();var m=this.getView().data("modelObjectType");if(!this.oEditDialog){var v=this._commentMixinSettings.editDialogViewName;this.oEditDialog=this.createView({type:V.XML,viewName:v});this.getView().addDependent(this.oEditDialog);}var b=e.getSource().getBindingContext("data");var i=b.getProperty(b.sPath).ID;this.oEditDialog.getController().open(i,m);};a._commentMixinRefresh=function(){var l=this._commentMixinSettings.commentListId;var b=this.getView().byId(l).getBindingInfo("items");this.getView().byId(l).bindItems(b);};return a;});};if(!jQuery.sap.isDeclared('sap.ino.vc.comment.EditCommentDialog.controller')){jQuery.sap.declare('sap.ino.vc.comment.EditCommentDialog.controller');sap.ui.define("sap/ino/vc/comment/EditCommentDialog.controller",["sap/ino/vc/commons/BaseObjectModifyController"],function(C){"use strict";return C.extend("sap.ino.vc.comment.EditCommentDialog",{open:function(i,m){var t=this;var s={actions:["modify","del"],continuousUse:true,readSource:{model:this.getDefaultODataModel()}};jQuery.sap.require(m);var a=jQuery.sap.getObject(m,0);var c=new a(i,s);t.setObjectModel(c);var v=t.getView();v.byId("editCommentDialog").open();},onDeletePressed:function(e){var d=this.executeObjectAction("del",{messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS_COMMENT"}});var v=this.getView();d.done(function(r){v.getParent().getController()._commentMixinRefresh();v.byId("editCommentDialog").close();});d.fail(function(r){});d.always(function(){});},onUpdatePressed:function(e){var m=this.executeObjectAction("modify",{messages:{success:"MSG_UPDATE_SUCCESS_COMMENT"}});var v=this.getView();m.done(function(r){v.byId("editCommentDialog").close();});m.fail(function(r){});m.always(function(){});},onCancelPressed:function(e){var v=this.getView();this.resetInputTypeValidations();v.byId("editCommentDialog").close();}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.comment.RichCommentMixin')){jQuery.sap.declare('sap.ino.vc.comment.RichCommentMixin');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.Button');sap.ui.define("sap/ino/vc/comment/RichCommentMixin",["sap/ui/core/mvc/ViewType","sap/ino/vc/commons/BaseObjectController","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/IdeaFollow","sap/m/MessageToast","sap/m/MessageBox","sap/m/Button"],function(V,B,C,I,M,a,b){"use strict";var o={idea:"IDEA",campaign:"CAMPAIGN",blog:"BLOG"};var R=function(){throw"Mixin may not be instantiated directly";};R.defaultRichCommentSetting={commentContainerId:"rteContainer",commentInputId:"rteCtrlInput",commentListId:"commentList",type:"comment",successMessageKey:"MSG_CREATE_SUCCESS_COMMENT",validateMsgKey:"MSG_CREATE_EMPTY_COMMENT",updateMsgKey:"MSG_UPDATE_SUCCESS_COMMENT",createReplyMsgKey:"MSG_CREATE_REPLY_SUCCESS_COMMENT",editDialogViewName:"sap.ino.vc.comment.RichEditCommentDialog",delDialogViewName:"sap.ino.vc.comment.RichDelDialog",editAttachmentDialogViewName:"sap.ino.vc.comment.RichAttachmentDialog",delReplyConfirmMsgKey:"MSG_COMMENT_REPLY_DEL_CONFIRM",delAllDataComfirmMsgKey:"MSG_COMMENT_DELETE_ALL_DATA_CONFIRM",delSuccessfulMsgKey:"MSG_COMMENT_DEL_SUCCESS",delBtnKey:"COMMENT_OBJECT_BTN_DELETE_COMMENT",delBtnAllDataKey:"COMMENT_OBJECT_BTN_DELETE_ALL_DATA"};R.richCommentMixinInitRouterEvent=function(s){if(s){this.defaultRichCommentSetting=s;}this._oRouter=this.getOwnerComponent().getRouter();this._oRouter.getRoute(this.routes).attachMatched(this._onCommentMixinRouteMatched,this);};R.onExit=function(){this._oRouter.getRoute(this.routes).detachMatched(this._onCommentMixinRouteMatched,this);};R.richCommentMixinInit=function(s){var c=this;c._commentMixinSettings=s||this.defaultRichCommentSetting;c._initRTE();c._commentMixinResetCommentModel();};R.richCommentMixinSubmit=function(){var v=this.getBlockView();var m=this.getModel("comment")?this.getModel("comment"):this._commentMixinGetCommentModel();var t=v.data("modelObjectType");var s=this._commentMixinSettings.successMessageKey;if(!m.getProperty("/COMMENT")){M.show(this.getText(this._commentMixinSettings.validateMsgKey));return;}v.setBusy(true);m.setProperty("/Imgs",this._getImgIds(m.getProperty("/COMMENT")));var c=B.prototype.executeObjectAction.call(this,"create",{messages:{success:s,error:function(S){if(S&&S.MESSAGES&&S.MESSAGES.length>0){M.show(S.MESSAGES[0].MESSAGE_TEXT);}}},objectModelExt:m});var r=this.getRouter();var d=this;c.done(function(){if(d.getCurrentRoute()==="idea-display"&&(r.getContext().indexOf("sectionComment")>-1||r.getContext().indexOf("sectionInternal")>-1)){d._commentMixinSetCommentModel(null);}d._commentMixinResetCommentModel();d._commentMixinRefresh();d.onVotedFollow(t);});c.always(function(){v.setBusy(false);});};R.richCommentMixinOnUserPressed=function(e){var s=e.getSource();var d=e.getParameter("domRef");var c=s.getBindingContext("data");var i=c.getProperty("CHANGED_BY_ID");if(d){var r=sap.ui.getCore().byId(d.id);}if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getBlockView().addDependent(this.oIdentityCardView);}if(r){this.oIdentityCardView.getController().open(r,i);}else{this.oIdentityCardView.getController().open(s,i);}};R.richCommentMixinOnDetailPress=function(e){this._commentMixinResetCommentModel();var m=this.getBlockView().data("modelObjectType");if(!this.oEditDialog){var v=this._commentMixinSettings.editDialogViewName;this.oEditDialog=this.createView({type:V.XML,viewName:v});this.getBlockView().addDependent(this.oEditDialog);}var c=e.getSource().getBindingContext("data");var i=c.getProperty(c.sPath).ID;this.oEditDialog.getController().open(i,m);};R.onVotedFollow=function(t){var i=this.getModel("object");if(i&&i.getProperty("/AUTO_FOLLOW")){var A=i.getProperty("/AUTO_FOLLOW");var f=i.getProperty("/FOLLOW");var c=i.getProperty("/SubmitterContributorsCoach");var p=c.filter(function(s){return s.IDENTITY_ID===C.getCurrentUser().USER_ID;});if(t==="sap.ino.commons.models.object.IdeaComment"&&A&&!f&&!p.length){var d=i.getProperty("/ID");var F=I.follow(d,"IDEA",0);F.done();}}};R.richCommentMixinOnReply=function(e){var c=e.getSource().getCustomData()[0];this._commentMixinOnEdit(-1,c.getValue());};R.richCommentMixinOnEdit=function(e){var c=e.getSource().getCustomData();this._commentMixinOnEdit(c[0].getValue(),c[1].getValue());};R._commentMixinOnEdit=function(i,p){var m=this.getBlockView().data("modelObjectType");if(!this.oEditDialog){var v=this._commentMixinSettings.editDialogViewName;this.oEditDialog=this.createView({type:V.XML,viewName:v});this.getBlockView().addDependent(this.oEditDialog);}this.oEditDialog.getController().open(i,p,m,this._commentMixinSettings);};R.richCommentMixinOnAttach=function(i){var m=this.getBlockView().data("modelObjectType");if(!this.oAttachmentDialog){var v=this._commentMixinSettings.editAttachmentDialogViewName;this.oAttachmentDialog=this.createView({type:V.XML,viewName:v});this.getBlockView().addDependent(this.oAttachmentDialog);}this.oAttachmentDialog.getController().open(i,m);};R.onRichAttachmentFileDeleted=function(e){var c=this;var d;if(e.getParameter("item")&&e.getParameter("item").getCustomData()&&e.getParameter("item").getCustomData().length>0){d=e.getParameter("item").getCustomData()[0].getValue();}var r=c._commentMixinGetStaticCommentModel().removeAttachments({ATTACHMENT_ID:e.getParameter("documentId"),ID:d});this.getBlockView().setBusy(true);r.done(function(){c._commentMixinRefresh();});r.fail(function(f){M.show(f.MESSAGES[0].MESSAGE_TEXT);});r.always(function(){c.getBlockView().setBusy(false);});};R.richCommentMixinOnDel=function(i,p,m){var c=this;var O;if(m.indexOf("IdeaComment")>-1){O=o.idea;}else if(m.indexOf("CampaignComment")>-1){O=o.campaign;}else if(m.indexOf("BlogComment")>-1){O=o.blog;}if(!c.getModel("comment")){this._commentMixinGetCommentModel();}var s=p?c._commentMixinSettings.delReplyConfirmMsgKey:c._commentMixinSettings.delAllDataComfirmMsgKey;jQuery.sap.require(m);var d=jQuery.sap.getObject(m,0);var D=new jQuery.Deferred();var A=p?[a.Action.OK,a.Action.CANCEL]:[c.getText(c._commentMixinSettings.delBtnKey),c.getText(c._commentMixinSettings.delBtnAllDataKey),a.Action.CANCEL];a.confirm(c.getText(s),{actions:A,onClose:function(e){var f=Math.pow(A.length,A.indexOf(e)+1);if(f===4||f===27||f===1){D.resolve({confirmationCancelled:true});return;}else{var g=B.prototype.executeObjectAction.call(c,"delComment",{staticparameters:{COMMENT_ID:i,ALL_DATA:f===9?1:0,OBJECT_TYPE:O,OBJECT_ID:c.getModel("comment").getProperty("/OBJECT_ID")},messages:{success:c._commentMixinSettings.delSuccessfulMsgKey},objectModelExt:d});g.done(D.resolve);g.fail(D.reject);}}});return D.promise();};R.richCommentMixinOnRemoveComments=function(e){var c=e.getSource().getCustomData();var i=c[0].getValue();var p=c[1].getValue();var m=this.getBlockView().data("modelObjectType");var d=this;var D=this.richCommentMixinOnDel(i,p,m);D.done(function(r){if(r&&r.confirmationCancelled===true){return;}else{d._commentMixinRefresh();}});};R.setAccessibilityProperty=function(){if(this.byId(this._commentMixinSettings.commentListId)){this.byId(this._commentMixinSettings.commentListId).addEventDelegate({onAfterRendering:function(e){var l=e.srcControl;var i=l.$().find("li");jQuery.each(i,function(c,d){var $=jQuery(d);$.attr("aria-label",$.getEncodedText());});}});}};R._commentMixinResetCommentModel=function(){this._commentMixinGetCommentModel();};R.commentMixinForceInitCommentModel=function(){if(!this.getBlockView().getModel("comment")){var O=this.getBlockView().data("object_id")||(this.getModel("object")&&this.getModel("object").getProperty("/ID"));if(O>0){this._commentMixinInitCommentModel(O);}}};R._commentMixinInitCommentModel=function(O){var s={continuousUse:true,readSource:{model:this.getDefaultODataModel()}};var m=this.getBlockView().data("modelObjectType");jQuery.sap.require(m);var c=jQuery.sap.getObject(m,0);var d=new c({OBJECT_ID:O},s);this.addSomeMethodIntoModel(d);this._commentMixinSetCommentModel(d);};R._commentMixinSetCommentModel=function(m){this.getBlockView().setModel(m,"comment");};R._commentMixinGetCommentModel=function(){if(this.getCurrentRoute()!=="idea-display"){this._commentMixinSetCommentModel(null);}if(this.getCurrentRoute()==="idea-display"){var i=this.getModel("object");if(this.getBlockView().getViewName()==="sap.ino.vc.comment.RichComment"){i.setProperty("/IDEA_COMMENT_VIEW",this.getBlockView());}if(this.getBlockView().getViewName()==="sap.ino.vc.internal.InternalSection"){i.setProperty("/IDEA_INTERNAL_COMMENT_VIEW",this.getBlockView());}if(this.getBlockView().getModel("comment")&&this.getModel("object")&&this.getBlockView().getModel("comment").getProperty("/OBJECT_ID")!==this.getModel("object").getProperty("/ID")){this._commentMixinSetCommentModel(null);}}this.commentMixinForceInitCommentModel();return this.getBlockView().getModel("comment");};R._commentMixinGetStaticCommentModel=function(){var m=this.getBlockView().data("modelObjectType");jQuery.sap.require(m);return jQuery.sap.getObject(m,0);};R._commentMixinGetSingleCommentModel=function(O){var m=this.getBlockView().data("modelObjectType");jQuery.sap.require(m);var c=jQuery.sap.getObject(m,0);var s={continuousUse:true,readSource:{model:this.getDefaultODataModel()}};return new c(O,s);};R._commentMixinRefresh=function(c){var d=this;jQuery.sap.delayedCall(0,d,function(){var l=d._commentMixinSettings.commentListId;var e=c||jQuery.extend(true,{},d.getBlockView().byId(l).getBindingInfo("items"));d.getBlockView().byId(l).destroyItems();d.getBlockView().byId(l).bindItems(e);});};R._onCommentMixinRouteMatched=function(e){var r=e.getParameter("arguments");var q=r["?query"];var s=(q&&q.section)||"sectionDetails";if(s==="sectionComments"){this.getModel("view").setProperty("/IDEA_COMMENT",true);}else{this.getModel("view").setProperty("/IDEA_COMMENT",false);}this._commentMixinGetCommentModel();};return R;});};if(!jQuery.sap.isDeclared('sap.ino.vc.comment.RichEditCommentDialog.controller')){jQuery.sap.declare('sap.ino.vc.comment.RichEditCommentDialog.controller');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/comment/RichEditCommentDialog.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ino/vc/comment/RichCommentCntrlMixin","sap/ino/vc/comment/RichCommentAttachmentMixin","sap/ui/core/mvc/ViewType","sap/m/MessageToast","sap/ino/vc/comment/RichCommentMixin"],function(C,R,a,V,M,b){"use strict";return C.extend("sap.ino.vc.comment.RichEditCommentDialog",jQuery.extend({},R,a,b,{_cId:"richEditCommentDialog",_dicODataPaths:{"sap.ino.commons.models.object.IdeaComment":{"Parent":"IdeaComment","Child":"IdeaChildrenComment","Prefix":"COMMENT"},"sap.ino.commons.models.object.InternalNote":{"Parent":"IdeaInternalNote","Child":"IdeaInternalNoteChildrenComment","Prefix":"INTERNALNOTE"}},open:function(i,p,m,v){this._open(i,p,m,v);},_open:function(i,p,m,v){this.setViewProperty("/parentId",p);this.setViewProperty("/id",i);this.setViewProperty("/type",m);this._iId=i;this._modelObjectType=m;this._commentMixinSettings=jQuery.extend(true,{},v);this._commentMixinSettings.commentContainerId="rteCommentReplyContainer";this._commentMixinSettings.type="comment_reply";var t=this;var s={actions:["update","del"],continuousUse:true,readSource:{model:this.getDefaultODataModel()}};var c={height:"300px"};jQuery.sap.require(m);var d=jQuery.sap.getObject(m,0);var o=new d(i,s);this.addSomeMethodIntoModel(o);t.setModel(o,"comment");var D=o.getReadSourceModel();D.read("/"+this._dicODataPaths[m][!p?"Parent":"Child"]+"("+i+")/CommentAttachments",{success:function(f){o.setProperty("/Attachments",f.results);}});var e=t.getView();this._initRTE(c);this.richAttachmentMixinInit();o.getDataInitializedPromise().done(function(f){e.byId(t._cId).open();});},onDeletePressed:function(e){var c=e.getSource().getCustomData();var i=c[0].getValue();var p=c[1].getValue();var m=this.getViewProperty("/type");var v=this.getView();var o=this;var d=this.richCommentMixinOnDel(i,p,m);d.done(function(r){if(r&&r.confirmationCancelled===true){return;}else{o._clearData();v.getParent().getController()._commentMixinRefresh();v.byId(o._cId).close();}});},onCloseDialog:function(){var c=this;var v=this.getView();c._clearData();v.byId(c._cId).close();},onUpdatePressed:function(){var c=this;var d=c.getModel("comment");if(!d.getProperty("/COMMENT")){M.show(this.getText(this._commentMixinSettings.validateMsgKey));return;}d.setProperty("/Imgs",this._getImgIds(d.getProperty("/COMMENT")));var m=this.executeObjectAction("update",{objectModelExt:d,messages:{success:c._commentMixinSettings.updateMsgKey}});var v=this.getView();m.done(function(){c._clearData();v.getParent().getController()._commentMixinRefresh();v.byId(c._cId).close();});},onReplyPressed:function(){var c=this;var d=c.getModel("comment");if(!d.getProperty("/COMMENT")){M.show(this.getText(this._commentMixinSettings.validateMsgKey));return;}d.setProperty("/Imgs",this._getImgIds(d.getProperty("/COMMENT")));d.setProperty("/PARENT_ID",c.getViewProperty("/parentId"));d.setProperty("/OBJECT_ID",this.getModel("object").getProperty("/ID"));var m=this.executeObjectAction("create",{objectModelExt:d,messages:{success:c._commentMixinSettings.createReplyMsgKey,error:function(s){if(s&&s.MESSAGES&&s.MESSAGES.length>0){M.show(s.MESSAGES[0].MESSAGE_TEXT);}}}});var v=this.getView();m.done(function(){c._clearData();v.byId(c._cId).close();v.byId(c._commentReplyControlId).destroy();v.getParent().getController()._commentMixinRefresh();});},onCancelPressed:function(){var v=this.getView();this.resetInputTypeValidations();this._clearData();v.byId(this._cId).close();},_clearData:function(){this.getViewProperty("/parentId",null);this.getViewProperty("/id",null);this._iId=null;this._modelObjectType=null;},formatTitle:function(i,p,t){if(!t){return"";}var T=this._dicODataPaths[t].Prefix;if(i>0){if(!p){T+="_EDIT_OBJECT_TIT";}else{T+="_EDIT_REPLY_OBJECT_TIT";}}else{T+="_CREATE_REPLY_OBJECT_TIT";}return this.getText(T);}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.BaseListController')){jQuery.sap.declare('sap.ino.vc.commons.BaseListController');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.ResizeHandler');sap.ui.define("sap/ino/vc/commons/BaseListController",["./BaseBlockController","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ino/commons/formatters/BaseListFormatter","sap/ino/controls/OrientationType","sap/ui/core/ResizeHandler","./mixins/IdentityQuickviewMixin","./mixins/ClipboardMixin","./mixins/IdentityCardSendMailMixin","sap/ino/commons/application/Configuration"],function(B,D,J,b,O,R,I,C,c,d){"use strict";return B.extend("sap.ino.vc.commons.BaseListController",jQuery.extend({},I,C,c,{formatter:b,onInit:function(){B.prototype.onInit.apply(this,arguments);this._oListConfigModel=new J(this.list||{});this.getView().setModel(this._oListConfigModel,"list");this._oFilterBar=this.byId("filterBar");if(D.system.desktop){var p=this.byId("pullToRefresh");if(p){var P=p.getParent();P.removeContent(p);}}this._sResizeRegId=this.attachListControlResized(this.getList());this.setFullScreen(d.getPersonalize().SCREEN_SIZE);},onExit:function(){this.detachListControlResized(this._sResizeRegId);},_onBaseOrientationChange:function(e){this._onOrientationHandler();},_onOrientationHandler:function(e){this.bindList();},onOrientationChange:function(e){if(e===O.LANDSCAPE){if(this.getPortraitStyle){this.getList().removeStyleClass(this.getPortraitStyle());}if(this.getLandscapeStyle){this.getList().addStyleClass(this.getLandscapeStyle());}}else{if(this.getPortraitStyle){this.getList().addStyleClass(this.getPortraitStyle());}if(this.getLandscapeStyle){this.getList().removeStyleClass(this.getLandscapeStyle());}}this.getList().setWrapping(e!==O.LANDSCAPE);},_onManualOrientationChange:function(){var o=this.getViewProperty("/ORIENTATION");o=(o===O.PORTRAIT?O.LANDSCAPE:O.PORTRAIT);this.setViewProperty("/ORIENTATION",o);this._onOrientationHandler(o);this.onOrientationChange(o);},onObjectListUpdateStarted:function(E){var i=sap.ui.getCore().getCurrentFocusedControlId();if(i&&i.indexOf("__clone")>-1){var l=E.getSource(),a;if(l&&l.getItems){a=l.getItems().map(function(e){return e.getId().substring(e.getId().lastIndexOf("__clone"));}).indexOf(i.substring(i.lastIndexOf("__clone")));this._iBeforeUpdateControlIdx=a;this._iBeforeUpdateControlId=i.substring(0,i.lastIndexOf("__clone"));}}},onObjectListUpdateFinished:function(e){if(!sap.ui.getCore().getCurrentFocusedControlId()&&this._iBeforeUpdateControlIdx>-1){var i=this.getList().getItems();if(i&&i.length>this._iBeforeUpdateControlIdx){var o=i[this._iBeforeUpdateControlIdx];var s=o.getId().substring(o.getId().lastIndexOf("__clone"));var a=this._iBeforeUpdateControlId+s;var f=sap.ui.getCore().getElementById(a);if(f){f.focus();}}}this._iBeforeUpdateControlId=undefined;this._iBeforeUpdateControlIdx=undefined;},onObjectListGrowFinished:function(e){if(e.getParameter("actual")>30){var n=this.getList().getItems().slice(e.getParameter("actual")-30);this.onMassIdeaSelect(n,this.getViewProperty("/List/SELECT_ALL"),true);}},_onResize:function(e){var t=e.control;var w=e.size.width;var o=e.oldsize?e.oldsize.width:-1;if(w!==o){t.removeStyleClass("sapInoListWidthXXXS");t.removeStyleClass("sapInoListWidthXXS");t.removeStyleClass("sapInoListWidthXS");t.removeStyleClass("sapInoListWidthS");t.removeStyleClass("sapInoListWidthM");t.removeStyleClass("sapInoListWidthL");t.removeStyleClass("sapInoListWidthXL");t.removeStyleClass("sapInoListWidthXXL");t.removeStyleClass("sapInoListWidthXXXL");t.removeStyleClass("sapInoListWidthXXXXL");if(w<500){t.addStyleClass("sapInoListWidthXXXS");}else if(w<600){t.addStyleClass("sapInoListWidthXXS");}else if(w<700){t.addStyleClass("sapInoListWidthXS");}else if(w<800){t.addStyleClass("sapInoListWidthS");}else if(w<900){t.addStyleClass("sapInoListWidthM");}else if(w<1000){t.addStyleClass("sapInoListWidthL");}else if(w<1100){t.addStyleClass("sapInoListWidthXL");}else if(w<1200){t.addStyleClass("sapInoListWidthXXL");}else if(w<1300){t.addStyleClass("sapInoListWidthXXXL");}else{t.addStyleClass("sapInoListWidthXXXXL");}}},_updateListAccessibility:function(){var l=this.getList();l.$().find(".sapMListUl").attr("role","list");var i=l.$().find("li");jQuery.each(i,function(a,o){var $=jQuery(o);$.attr("role","group");var L=$.find(".sapInoItemAriaLabel");if(L&&L.length>0){$.attr("aria-labelledby",L[0].id);}var e=$.find(".sapMLIBContent");if(e&&e.length>0){e.attr("role","listitem");}});},getScrollContainer:function(){return this._oScrollContainer;},getFilterBar:function(){return this._oFilterBar;},getListLayout:function(){return this.byId("objectListLayout");},getFilterButton:function(){return this.byId("filterButton");},getFilterPanel:function(){return this.byId("filterPanel");},getFilterDialog:function(){return this.byId("filterDialog");},getSortPanel:function(){return this.byId('sortPanel');},isFilterVisible:function(){var f=this.getFilterPanel();if(f){return f.hasStyleClass("sapInoFilterSidePanelVisible");}else{return false;}},onShowFilterBar:function(e){this.showFilterBar(true);if(this.getModel("filterItemModel")){this.getModel("filterItemModel").setProperty("/isShowFilterSideFilterButtonGroup",e.getSource().getPressed&&e.getSource().getPressed());}},showFilterBar:function(s){if(!D.system.desktop){var f=this.getFilterDialog();if(f.isOpen()&&!s){f.close();}else if(!f.isOpen()&&s){f.open();if(this.onSetFilterBarVisible){this.onSetFilterBarVisible();}}}else{var o=this.getListLayout();var F=this.getFilterPanel();var S=this.getSortPanel();if(!o||!F){return;}if(this.isFilterVisible()||s===false){o.removeStyleClass("sapInoObjectListLayoutFit");F.removeStyleClass("sapInoFilterSidePanelVisible");if(S){o.removeStyleClass('sapInoObjectListLayoutTop');S.removeStyleClass("sapInoSortPanelLayoutFit");}}else{o.addStyleClass("sapInoObjectListLayoutFit");F.addStyleClass("sapInoFilterSidePanelVisible");if(S){o.addStyleClass('sapInoObjectListLayoutTop');S.addStyleClass("sapInoSortPanelLayoutFit");}if(this.onSetFilterBarVisible){this.onSetFilterBarVisible();}}}},onApplyFilter:function(){var f=this.getFilterDialog();if(JSON.stringify(this.getViewModelBackup())===JSON.stringify(this.getViewProperty("/"))&&JSON.stringify(this.getFilterItemModelBackup())===JSON.stringify(this.getModel("filterItemModel"))){f.close();return;}var q=this.getQuery();this.navigateIntern(q,true);f.close();},onCancelFilter:function(){var f=this.getFilterDialog();this.setViewProperty("/List/SORT",this.ViewModelBackup.List.SORT);this.setViewProperty("/List/ORDER",this.ViewModelBackup.List.ORDER);this.setViewProperty("/List/SEARCH",this.ViewModelBackup.List.SEARCH);this.setViewProperty("/List/TAGS",this.ViewModelBackup.List.TAGS);this.setViewProperty("/List/VARIANT",this.ViewModelBackup.List.VARIANT);this.setViewProperty("/List/STATUS","");this.setViewProperty("/List/PHASE","");this.setViewProperty("/List/CAMPAIGN",undefined);this.setViewProperty("/List/DUE",undefined);this.setViewProperty("/List/AUTHORS",[]);this.setViewProperty("/List/COACHES",[]);this.setViewProperty("/List/EXTENSION",{});this.setViewProperty("/List/RESP_VALUE_CODE","");f.close();},getFilterElementById:function(i){return this.byId(i);},createIdForFilterElement:function(i){if(i){return this.createId(i);}else{return this.getView().getId();}},setFilterModel:function(m,n){this.setModel(m,n);},getFilterNavContainer:function(){if(!this._oNavContainer){if(!D.system.desktop){this._oNavContainer=this.byId("dialogFilterFragment--navContainer");}else{this._oNavContainer=this.byId("panelFilterFragment--navContainer");}}return this._oNavContainer;},onFilterPageChange:function(){var n=this.getFilterNavContainer();var o=n.getCurrentPage();var P=n.getPages();var N=jQuery.grep(P,function(p){return p.sId!==o.sId;});if(N&&N.length>0){var a=N[0];if(a!==P[0]){n.to(a.sId,"slide");}else{n.backToPage(a.sId,"slide");}}},onMoreFilterChange:function(e){var n=this.getFilterNavContainer();var p=n.getPages();var f=p[0].getContent()[0];if(f.getItems().length>3){this.setViewProperty("/List/IS_SHOW_MORE_FILTER",true);e.getSource().setVisible(false);f.$().find('*[tabindex="0"]')[f.getItems().length-1].focus();}},addSubFilterPageContent:function(v){this.setViewProperty("/List/IS_FILTER_SUBPAGE",true);var n=this.getFilterNavContainer();var p=n.getPages();var s=p[1];s.addContent(v);},removeSubFilterPage:function(){this.setViewProperty("/List/IS_FILTER_SUBPAGE",false);var n=this.getFilterNavContainer();var p=n.getPages();var s=p[1];s.removeAllContent();},createViewModelBackup:function(){this.ViewModelBackup=jQuery.extend(true,{},this.getViewProperty("/"));this.FilterItemModelBackup=jQuery.extend(true,{},this.getModel("filterItemModel"));},getViewModelBackup:function(){return this.ViewModelBackup;},getFilterItemModelBackup:function(){return this.FilterItemModelBackup;},restoreViewModelBackup:function(){if(this.oViewModelBackup!==undefined){this.setViewProperty("/",this.ViewModelBackup);this.ViewModelBackup=undefined;}if(this.FilterItemModelBackup!==undefined){this.setModel("filterItemModel",this.FilterItemModelBackup);this.FilterItemModelBackup=undefined;}},resetViewModelBackup:function(){this.ViewModelBackup=undefined;this.FilterItemModelBackup=undefined;},getModel:function(n){return this.getView().getModel(n);},setListProperty:function(p,v){return this.getModel("list").setProperty(p,v);},getListProperty:function(p){return this.getModel("list").getProperty(p);},getList:function(){},getItemTemplate:function(){},addListToolbarContent:function(o){var l=this.getList();var t=l?(l.getHeaderToolbar&&l.getHeaderToolbar()):undefined;var a=t?(t.getContent&&t.insertContent&&t.getContent()):undefined;if(jQuery.isArray(a)){var i=a.length-1;for(var e=a.length-1;e>=0;e--){var m=a[e].getMetadata&&a[e].getMetadata();var n=m?(m.getName&&m.getName()):undefined;if(n==="sap.m.ToolbarSpacer"){i=e+1;break;}}t.insertContent(o,i);}else{}},getPath:function(){return this._sPath;},setPath:function(p){this._sPath=p;},addSorterConfig:function(s,E){var p="/Sorter/Values";var v=this.getListProperty(p);if(!v){return;}var a=function(S){if(jQuery.grep(v,function(e){return e.ACTION===S.ACTION;}).length===0){if(E){v.push(S);}else{v.unshift(S);}}};if(jQuery.isArray(s)){s.forEach(function(S){a(S);});}else{a(s);}this.setListProperty(p,v);},removeSorterConfig:function(s){var p="/Sorter/Values";var v=this.getListProperty(p);if(!v||v.length===0){return;}var r=function(S){v=jQuery.grep(v,function(l){return l.ACTION!==S.ACTION;});};if(jQuery.isArray(s)){s.forEach(function(S){r(S);});}else{r(s);}this.setListProperty(p,v);},getSorter:function(){return this._oSorter;},setSorter:function(s){this._oSorter=s;},getFilter:function(){var g=this.getGlobalFilter();var f=this._aFilter||[];return f.concat(g);},setFilter:function(f){if(jQuery.type(f)==="array"){this._aFilter=f;}else{this._aFilter=f?[f]:[];}},addFilter:function(f){if(!this._aFilter){this._aFilter=[];}this._aFilter.push(f);},getGlobalFilter:function(){return this._aGlobalFilter||[];},setGlobalFilter:function(f){if(jQuery.type(f)==="array"){this._aGlobalFilter=f;}else{this._aGlobalFilter=f?[f]:[];}},addGlobalFilter:function(f){if(!this._aGlobalFilter){this._aGlobalFilter=[];}this._aGlobalFilter.push(f);},getGroupHeaderFactory:function(){return this._oGroupHeaderFactory;},setGroupHeaderFactory:function(g){this._oGroupHeaderFactory=g;},bindList:function(f){var t=this;var l=this.getList().bindItems({path:this.getPath(),template:this.getItemTemplate(),sorter:this.getSorter(),filters:this.getFilter(),groupHeaderFactory:this.getGroupHeaderFactory(),events:{dataRequested:function(){jQuery.each(t.getBusyControls(),function(i,o){if(jQuery.type(o.setBusy)==="function"){o.setBusy(true);}});},dataReceived:function(){jQuery.each(t.getBusyControls(),function(i,o){if(jQuery.type(o.setBusy)==="function"){o.setBusy(false);}});if(jQuery.type(f)==="function"){f.apply(this);}}}});},onListExport:function(){},onRefresh:function(){this.bindList();},onUpdateFinished:function(){var r=this.byId("pullToRefresh");if(r&&typeof r.hide==="function"){r.hide();}this._updateListAccessibility();},navigateIntern:function(q,r,o){if(o){if(!D.system.desktop){return;}}var v=this.getViewProperty("/List/VARIANT");this.navigateTo(this.getCurrentRoute(),{"variant":v,"query":q},r,true);},_getListDefinitionEntry:function(v,k,l){var V=this.getListProperty(l);if(!V){return undefined;}var a=jQuery.grep(V,function(o){return o[k]===v;});if(a&&a.length>0){return a[0];}return undefined;},getSort:function(a){return this._getListDefinitionEntry(a,"ACTION","/Sorter/Values");},getStatus:function(k){return this._getListDefinitionEntry(k,"KEY","/Filter/Status");},onTagItemSelected:function(e){e.oSource=e.getSource().getContent()[0];this.onTagSelected(e);},onTagSelected:function(e){var s=e.getSource();if(!s.getEnabled()){return;}var t={ID:s.data("id"),NAME:encodeURIComponent(s.getText()),GROUP_ID:s.data("groupid")};var T=this.getViewProperty("/List/TAGS");T.push(t);this.setViewProperty("/List/TAGS",T);this.setViewProperty("/List/IS_TAGS_SELECTION",T.length>0);if(!D.system.desktop){this.bindTagCloud();return;}this.navigateIntern(this.getQuery(),true);},onTagTreeSelectedDone:function(e){var s=e.getSource();var t=[];var u=[];var f={"bFind":false};t=this.setSelectedTagGroup(t,this._oPopover.getModel().oData);this.updateTagHierarchy(t,this._oPopover.getModel().oData,f);u=this.setUnSelectedTagGroup(u,this._oPopover.getModel().oData);var r=this._oPopover.getModel().oData.tagGroupID?this._oPopover.getModel().oData.tagGroupID:'other';var T=this.getViewProperty("/List/TAGS")||[];T=T.concat(t);T=this.uniqTagGroup(T)||[];T=this.excludeUnSelectedTags(T,u)||[];T.forEach(function(i){i.NAME=decodeURIComponent(i.NAME);i.NAME=encodeURIComponent(i.NAME);if(!i.ROOTGROUPID){i.ROOTGROUPID=r;}});this.setViewProperty("/List/TAGS",T);this.setViewProperty("/List/IS_TAGS_SELECTION",T.length>0);if(!D.system.desktop){this.bindTagCloud();return;}this._oPopover.close();this.navigateIntern(this.getQuery(),true);},excludeUnSelectedTags:function(a,e){if(a.length>0){e.forEach(function(A){var E=false;var n;a.forEach(function(o,i){if(!E){E=o.ID===A.ID?true:false;if(E){n=i;}}});if(E){a.splice(n);E=false;}});}return a;},onTagSelectionChange:function(e){var a=e.getSource().getBindingContext();var p=a.getPath();this.validateChild(this._oPopover.getModel(),p);p=p.substring(0,p.lastIndexOf('/'));this.validateParent(this._oPopover.getModel(),p);},setVibilityTagIcon:function(a){if(a==="TAG_GROUP"){return true;}else{return false;}},setVibilityTag:function(a){if(a){return true;}else{return false;}},uniqTagGroup:function(e){var t=[];for(var i=0;i<e.length;i++){var n=true;for(var a=0;a<t.length;a++){if(n){n=t[a].ID===e[i].ID?false:true;}}if(n){t.push(e[i]);}}return t;},setSelectedTagGroup:function(t,a){var T;var e=this;if(a.children){a.children.forEach(function(o){if(o.children){e.setSelectedTagGroup(t,o);}else if(o.checked==="Checked"){T={ID:o.TAG_ID,NAME:o.NAME,GROUP_ID:o.TAG_GROUP_ID};t.push(T);}});}else if(a instanceof Array){a.forEach(function(o){if(o.checked==="Checked"){T={ID:o.ID,NAME:o.NAME,GROUP_ID:o.TAG_GROUP_ID};t.push(T);}});}else{if(a.checked==="Checked"){T={ID:a.TAG_ID,NAME:a.NAME,GROUP_ID:a.TAG_GROUP_ID};t.push(T);}}return this.uniqTagGroup(t);},setUnSelectedTagGroup:function(t,a){var T;var e=this;if(a.children){a.children.forEach(function(o){if(o.children){e.setUnSelectedTagGroup(t,o);}else if(o.checked==="Unchecked"){T={ID:o.TAG_ID,NAME:o.NAME,GROUP_ID:o.TAG_GROUP_ID};t.push(T);}});}else if(a instanceof Array){a.forEach(function(o){if(o.checked==="Unchecked"){T={ID:o.ID,NAME:o.NAME,GROUP_ID:o.TAG_GROUP_ID};t.push(T);}});}else{if(a.checked==="Unchecked"){T={ID:a.TAG_ID,NAME:a.NAME,GROUP_ID:a.TAG_GROUP_ID};t.push(T);}}return this.uniqTagGroup(t);},setChildState:function(o,s){var t=this;this.getChildren(o).forEach(function(x){x.checked=s;t.setChildState(x,s);});},validateChild:function(m,p){var a=m.getProperty(p);this.setChildState(a,a.checked);},getChildren:function(o){if(o.children){return o.children;}else{return[];}},validateParent:function(m,p){if(p==='/children'||p===''){return;}var o=m.getProperty(p);var s='Unchecked';var a=this.getChildren(o);var e=a.filter(function(x){return x.checked==='Checked';}).length;if(e===a.length){o.checked='Checked';}else{var u=a.filter(function(x){return x.checked==='Unchecked';}).length;if(u===a.length){o.checked='Unchecked';}else{o.checked='Mixed';}}m.setProperty(p,o);p=p.substring(0,p.lastIndexOf('/'));if(p!=='/children'){this.validateParent(m,p);}},updateTagHierarchy:function(t,a,f){var e=this;if(a.children){a.children.forEach(function(o){if(o.children){e.updateTagHierarchy(t,o,f);if(o.checked==="Checked"&&f.bFind){o.checked="Unchecked";}}else{var n=false;t.forEach(function(T){if(!n){n=o.TAG_ID!==T.ID?false:true;}});if(!n){o.checked="Unchecked";f.bFind=true;n=false;}else{o.checked="Checked";n=false;}}});}else if(a instanceof Array){a.forEach(function(o){var n=false;t.forEach(function(T){if(!n){n=o.ID!==T.ID?false:true;}});if(!n){o.checked="Unchecked";}else{o.checked="Checked";n=false;}});}else{var n=false;t.forEach(function(T){if(!n){n=a.TAG_ID!==T.ID?false:true;}});if(!n){a.checked="Unchecked";f.bFind=true;n=false;}else{a.checked="Checked";n=false;}}return a;},updateTagHierarchyForFisrt:function(t,a){var e=this;if(a.children){a.children.forEach(function(o){if(o.children){e.updateTagHierarchyForFisrt(t,o);}else{var n=false;t.forEach(function(T){if(!n){n=o.TAG_ID!==T.ID?false:true;}});if(n){o.checked="Checked";n=false;}}});}else{var n=false;t.forEach(function(T){if(!n){n=a.TAG_ID!==T.ID?false:true;}});if(n){a.checked="Checked";n=false;}}return a;},onTagGroupSelected:function(e){var s=e.getSource();var m="TagGroup-"+e.getSource().getCustomData()[0].getValue();var G=e.getSource().getCustomData()[1].getValue();if(!this._oPopover){this._oPopover=sap.ui.xmlfragment("sap.ino.vc.commons.fragments.TagGroupPopover",this);this.getView().addDependent(this._oPopover);}var t=this.getViewProperty("/List/TAGS");var r={GROUP_ID:e.getSource().getCustomData()[0].getValue(),TagList:this.getView().getModel("tag").getProperty("/RANKED_TAG")};var _=this._oPopover;var T;var a=this;var o=jQuery.ajax({url:d.getBackendRootURL()+"/sap/ino/xs/rest/common/tagGroupQuery.xsjs",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(r),async:false});o.done(function(f){T=new J(f);if(a.getView().getModel(m)){var F={"bFind":false};f=a.updateTagHierarchy(t,f,F);a.getView().getModel(m).setData(f);}else{a.updateTagHierarchyForFisrt(t,T.oData);a.getView().setModel(T,m);}});this.getView().getModel(m).setProperty("/RootGroupName",G);_.setModel(this.getView().getModel(m));this._oPopover.openBy(e.getSource());},_deselectTag:function(k){var t=this.getViewProperty("/List/TAGS");t=t.filter(function(a){return a.ID!==k;});this.setViewProperty("/List/TAGS",t);this.setViewProperty("/List/IS_TAGS_SELECTION",t.length>0);var q=this.getQuery();if(t.length===0){q.tags=undefined;setTimeout(function(){},0);}if(!D.system.desktop){this.bindTagCloud();return;}this.navigateIntern(q,true);},onTagItemDeselectPress:function(e){var k=parseInt(e.getParameter("listItem").getContent()[0].getKey(),10);if(!isNaN(k)){this._deselectTag(k);}},onTagItemDelete:function(e){var k=parseInt(e.getSource().getProperty("key"),10);if(!isNaN(k)){this._deselectTag(k);}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.commons.BaseVariantListController')){jQuery.sap.declare('sap.ino.vc.commons.BaseVariantListController');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.core.InvisibleText');sap.ui.define("sap/ino/vc/commons/BaseVariantListController",["./BaseListController","sap/ui/Device","sap/ino/commons/formatters/ListFormatter","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration","sap/ui/model/Sorter","sap/m/MessageBox","sap/ui/core/InvisibleText"],function(B,D,L,J,C,S,M,I){"use strict";var o={ASC:"ASC",DESC:"DESC"};var s={SEARCH_SCORE:"SEARCH_SCORE"};return B.extend("sap.ino.vc.commons.BaseVariantListController",{formatter:L,onInit:function(){B.prototype.onInit.apply(this,arguments);this._eOrientation=null;},onExit:function(){this.getList().detachUpdateFinished(this.onUpdateFinished,this);},onAnyRouteMatched:function(e){var r=e.getParameter("name");if(this.routes&&this.routes.indexOf(r)>-1){this.openDefaultFilterBar();}if(!this._bInnerViewNavigation){return;}if(this.routes&&this.routes.indexOf(r)===-1){this._bInnerViewNavigation=false;}},openDefaultFilterBar:function(){if(this.getModel("filterItemModel")){this.getModel("filterItemModel").setProperty("/isShowFilterSideFilterButtonGroup",false);}if(!D.system.desktop){return;}var f=this.getFilterButton();var F=this.getFilterPanel();var a=this.getSortPanel();var O=this.getListLayout();var p=C.getPersonalize();if(!p.FILTER){if(F&&F.hasStyleClass("sapInoFilterSidePanelVisible")){if(this.getModel("filterItemModel")){this.getModel("filterItemModel").setProperty("/isShowFilterSideFilterButtonGroup",true);}}return;}if(F&&!F.hasStyleClass("sapInoFilterSidePanelVisible")){if(f){f.setPressed(true);}O.addStyleClass("sapInoObjectListLayoutFit");F.addStyleClass("sapInoFilterSidePanelVisible");if(this.onSetFilterBarVisible){this.onSetFilterBarVisible();if(this.getModel("filterItemModel")){this.getModel("filterItemModel").setProperty("/isShowFilterSideFilterButtonGroup",true);}}if(a){O.addStyleClass('sapInoObjectListLayoutTop');a.addStyleClass('sapInoSortPanelLayoutFit');}}if(F&&F.hasStyleClass("sapInoFilterSidePanelVisible")){if(this.onSetFilterBarVisible){this.onSetFilterBarVisible();if(this.getModel("filterItemModel")){this.getModel("filterItemModel").setProperty("/isShowFilterSideFilterButtonGroup",true);}}}},setParameters:function(q,v){q=q||{};var a=this.checkSort(q,v.DEFAULT_SORT);var t=this.checkTags(q.tags);this.setViewProperty("/List/VARIANT",v.ACTION);this.setViewProperty("/List/SORT",a);this.setViewProperty("/List/QUICKSORT",q.quickSort);this.setViewProperty("/List/SEARCH",q.search);this.setViewProperty("/List/TAGS",t);this.setViewProperty("/List/IS_TAGS_SELECTION",t.length>0);},saveState:function(v){var r=this.getCurrentRoute();v=v||this.getBindingParameter().Variant;var q=this.getQuery({bFilterChange:true,bSorterChange:true});var p=D.orientation.portrait;var c=this.getContextObjectId();this._oState=this.createState(r,v,q,p,c);},createState:function(r,v,q,p,c){q=q||{};var a={route:r,variant:v,query:{}};Object.keys(q).forEach(function(k){if(k){a.query[k]=q[k];}});if(p!==undefined){a.portrait=p;}if(c>0){a.contextObjectId=c;}return a;},hasStateChanged:function(r,v,q,p,c){return JSON.stringify(this.createState(r,v,q,p,c))!==JSON.stringify(this._oState);},getQuery:function(){var q={};var a=this.getViewProperty("/List/SORT");var b=this.getViewProperty('/List/QUICKSORT');var O=this.getViewProperty("/List/ORDER");var c=this.getViewProperty("/List/SEARCH");var t=this.getViewProperty("/List/TAGS");if(b){q.quickSort=b;}if(a){q.sort=a;if(O){q.order=O;}}if(c){q.search=c;}if(t&&t.length>0){q.tags=JSON.stringify(t);}return q;},getVariant:function(a){return this._getListDefinitionEntry(a,"ACTION","/Variants/Values");},getVariantsPopover:function(){if(!this._oVariantsPopover){if(!D.system.desktop){this._oVariantsPopover=sap.ui.xmlfragment("sap.ino.vc.commons.fragments.ListVariantsDialog",this);}else{this._oVariantsPopover=sap.ui.xmlfragment("sap.ino.vc.commons.fragments.ListVariants",this);}this.getView().addDependent(this._oVariantsPopover);}return this._oVariantsPopover;},_onListVariants:function(e){var b=e.getSource();var p=this.getVariantsPopover();p.attachAfterClose(function(){b.focus();},this);if(typeof p.openBy==="function"){p.openBy(b);}else{p.open();}},onListVariants:function(){this._onListVariants.apply(this,arguments);},onListVariatsClose:function(){this.getVariantsPopover().close();},onVariantPress:function(v){var q=this.getQuery();this.removeInvalidFilters(q);if(v){this.navigateTo(this.getRoute(true),{variant:v,query:q},false,true);}else{this.navigateTo(this.getRoute(false),{query:q},false,true);}},removeInvalidFilters:function(q){},onVariantBasePress:function(e){var i=e.getSource();if(i.getSelectedItem&&i.getSelectedItem()){i=i.getSelectedItem();}var c=i.getBindingContext("list");var a;var O;var p;if(c){O=c.getObject();a=O?O.ACTION:undefined;this.setViewProperty("/List/VARIANT",a);this.setViewProperty("/List/CURRENTVAR",O);}this.setViewProperty("/List/SORT",undefined);this.setViewProperty("/List/ORDER",undefined);this.setViewProperty("/NAVIGATETOPLINK",false);this.getModel("list").setProperty("/CURRENTQUICKLINK",undefined);this.getModel("list").setProperty("/CURRENTSELECTLINK",O);this.getModel("list").setProperty("/TITLESELECTQUICKLINK",O);this.getModel("list").setProperty("/List/SELECTQUICKLINKID",O.ID);if(!D.system.desktop){return;}if(O.ID){this.setViewProperty("/List/SELECTQUICKLINKID",O.ID);}else{this.setViewProperty("/List/SELECTQUICKLINKID",undefined);}if(O.TYPE_CODE==="QUICK_LINK_CUSTOM_IDEA"){this.getModel("list").setProperty("/CURRENTQUICKLINK",O);var b=this.campaignId?location.href.split("#")[0]+"#/campaign/"+this.campaignId+"/"+O.LINK_URL:location.href.split("#")[0]+"#/"+O.LINK_URL;this.navigateToByURL(b);}else{this.onVariantPress(a,e);}},onApplyFilter:function(){var f=this.byId("filterDialog");if(JSON.stringify(this.getViewModelBackup())!==JSON.stringify(this.getViewProperty("/"))||JSON.stringify(this.getFilterItemModelBackup())!==JSON.stringify(this.getModel("filterItemModel"))){var q=this.getQuery();var v=this.getViewProperty("/List/VARIANT");if(v===this.getListProperty("/Variants/DEFAULT_VARIANT")){this.navigateTo(this.getRoute(false),{query:q},true,true);}else{this.navigateTo(this.getRoute(true),{variant:v,query:q},true,true);}}this.resetViewModelBackup();f.close();},initialSorterItems:function(){if(!D.system.desktop){return;}var a=this;var O=["ASC","DESC"];var b=this.getViewProperty("/List/SORT");if(!b){return;}if(!this._oSorterContainer){this._oSorterContainer=this.byId(this.getSortFragmnetId()+"--SorterContainer");}var c=b.split(",");var f;var t=this;var i=0;var _=function(e,g){var h=g.split(" ");e[0].setSelectedKey(h[0]);e[1].setPressed(O.indexOf(h[1]));a.setSorterIcon(e[1]);};f=this._oSorterContainer.getItems()[0];_(f.getItems(),c.shift());if(c.length>0){jQuery.each(c,function(e,T){if(t._oSorterContainer.getItems()[e+1]){f=t._oSorterContainer.getItems()[e+1];}else{f=t.addSorter(t._oSorterContainer);}_(f.getItems(),T);i=e+1;});}var d=this._oSorterContainer.getItems();for(i=i+1;i<d.length;i++){this._oSorterContainer.removeItem(d[i]);d[i].destroy();}a.checkSorterLimit(a._oSorterContainer);},onSorterAdd:function(e){var a=this._oSorterContainer||e.getSource().getParent().getParent();this.addSorter(a);this.checkSorterLimit(a);this._oLastFocusedControl=e.getSource();},addSorter:function(a){var f=this.createFragment("sap.ino.vc.commons.fragments.SorterItems");a.addItem(f);var i=a.getItems();var F=i[i.length-1].getItems();F[0].insertItem(new sap.ui.core.Item({text:"",key:''}),0);F[0].addEventDelegate({onAfterRendering:function(){F[0].focus();}});return i[i.length-1];},onSorterChange:function(e){var a=e.getSource();if(!a.getSelectedItem().getProperty("key")){return;}if(a.getBindingPath("items").indexOf("Sorter")<0){var b=a.getParent().getItems()[0];if(!b.getSelectedItem().getProperty("key")){return;}}var c=this.getSortCombination();if(c==="-1"){M.show(this.getText("MSG_REPEAT_IDEAT_SORTER"),M.Icon.INFORMATION,"",[M.Action.OK],function(){a.setSelectedKey("");});return;}this.setViewProperty("/List/SORT",c);this.navigateIntern(this.getQuery({bSorterChange:true}),true);},onSorterRemove:function(e){var a=e.getSource().getParent().getParent();var f=e.getSource().getParent();if(a&&a.indexOfItem(f)>0){a.removeItem(f);f.destroy();}this.checkSorterLimit(a);var b=this.getViewProperty("/List/SORT");var i=b.split(",").length;var c=a.getItems().length-1;if(i>c){this.setViewProperty("/List/SORT",this.getSortCombination());this.navigateIntern(this.getQuery({bSorterChange:true}),true);}var t=this;setTimeout(function(){if(t._oLastFocusedControl){t._oLastFocusedControl.focus();}},2000);},setSorter:function(a){if(Object.prototype.toString.call(a)!=="[object Array]"){a=[a];}var t=[];jQuery.each(a,function(i,b){if(b instanceof S){t.push(b);}else{t.push(new S(b.ACTION,b.DEFAULT_ORDER===o.DESC));}});this._oSorter=t;},getSort:function(a){if(a){var b=a.split(",");var t=this;var c=[];jQuery.each(b,function(i,d){var e=B.prototype.getSort.call(t,d.split(" ")[0]);if(e){if(d.split(" ")[1]){e.DEFAULT_ORDER=d.split(" ")[1];}c.push(e);}});return c;}},getQuickSort:function(q){var Q=[],a;var b=this.getListProperty('/QuickSorter');if(!q||!b||!b.length){return Q;}a=q.split(' ');for(var i=0;i<b.length;i++){if(b[i].ACTION===a[0]){Q.push(b[i]);}}return Q;},getSortCombination:function(){var O=["ASC","DESC"];var a="";var b=[];var v=true;var c=this._oSorterContainer.getItems();jQuery.each(c,function(i,d){var e=d.getItems();var f=e[0].getSelectedItem().getProperty("key");var g=e[1].getPressed()?O[1]:O[0];if(f!==""&&jQuery.inArray(f,b)===-1){b.push(f);a+=f+" "+g+",";}else if(jQuery.inArray(f,b)>-1){v=false;}});if(v){return a.slice(0,a.length-1);}else{return"-1";}},setSortIcon:function(O,a){var i=["sap-icon://sort-ascending","sap-icon://sort-descending"];var b=["ASC","DESC"];if(b.indexOf(a)===-1){return;}if(O&&O.setIcon){O.setIcon(i[b.indexOf(a)]);}},reverseSort:function(r,e){var O=["ASC","DESC"];var a=this.getViewProperty("/List/ORDER");this.setViewProperty("/List/ORDER",O[!O.indexOf(a)?1:0]);this.setSortIcon(e.getSource(),this.getViewProperty("/List/ORDER"));if(!r&&!D.system.desktop){return;}this.navigateIntern(this.getQuery(),false);},onListSortReverse:function(){this.reverseSort(true);},onSortReverse:function(e){this.reverseSort(false,e);},resetFilter:function(){this.setViewProperty("/List/TAGS",[]);this.setViewProperty("/List/IS_TAGS_SELECTION",false);this.setViewProperty("/List/SORT","");this.setViewProperty("/List/QUICKSORT","");if(!D.system.desktop){return;}this.navigateIntern(this.getQuery({bFilterChange:true,bSorterChange:true}),true);},onFilterReset:function(e){this.resetFilter();},checkSort:function(q,d){var a={"TEXT":"SORT_MIT_SEARCH_SCORE","ACTION":s.SEARCH_SCORE,"DEFAULT_ORDER":o.DESC};if(q&&q.search!==undefined&&(!this._oState||!this._oState.query.search)){this.addSorterConfig(a);}else if(q&&q.search===undefined&&(this._oState&&!this._oState.query.search)){this.removeSorterConfig(a);}if(q&&q.search!==undefined&&!q.sort){return s.SEARCH_SCORE;}return q&&this.getSort(q.sort)?q.sort:d;},checkOrder:function(q,d){if(jQuery.type(q.order)==="string"){q.order=q.order.toUpperCase();if(q.order===o.ASC||q.order===o.DESC){return q.order;}}return d;},checkTags:function(t){try{return JSON.parse(t);}catch(e){return[];}},checkRespList:function(r){try{return JSON.parse(r);}catch(e){return[];}},getBindingParameter:function(){return{Variant:null,VariantFilter:null,SearchTerm:null,TagIds:[]};},setContextObjectId:function(c){this._iContextObjectId=c;},getContextObjectId:function(){return this._iContextObjectId;},getCurrentVariant:function(){return this.getVariant(this.getViewProperty("/List/VARIANT"));},getRoute:function(v){if(this.routes&&this.routes.length){if(v){return this.routes[1];}else{return this.routes[0];}}return undefined;},getFilterFragmentId:function(){return D.system.desktop?"panelFilterFragment":"dialogFilterFragment";},getSortFragmnetId:function(){return D.system.desktop?"panelSortFragment":"dialogFilterFragment";},setSorterIcon:function(a){var i=["sap-icon://sort-ascending","sap-icon://sort-descending"];return a.getPressed()?a.setIcon(i[1]):a.setIcon(i[0]);},onOrder:function(e){var a=this.getSortCombination();this.setSorterIcon(e.getSource());this.setViewProperty("/List/SORT",a);if((a.split(" "))[1]==="ASC"){e.getSource().setTooltip(this.getText('EXP_ASCENDING_SORT_BUTTON'));}else if((a.split(" "))[1]==="DESC"){e.getSource().setTooltip(this.getText('EXP_DESCENGDING_SORT_BUTTON'));}this.navigateIntern(this.getQuery({bSorterChange:true}),true);},onQuickSort:function(e){var p=e.getParameters();var i=p.item;var q=i.getKey();var c=this.getViewProperty('/List/QUICKSORT');if(c===q){q='';}this.setViewProperty('/List/QUICKSORT',q);this.navigateIntern(this.getQuery({bSorterChange:true}),true);},checkSorterLimit:function(a){if(!a){return false;}var i=a.getItems();var l=this.getListProperty('/Sorter/Limit');if(!l){return false;}if(i.length>=l){this.setListProperty('/Sorter/disableAddButton',true);}else{this.setListProperty('/Sorter/disableAddButton',false);}},transListValue:function(l){return l&&!!l.length||false;},isDisable:function(b){return!b;},quickSortEnable:function(a,c){if(a==="CHANGED_AT_DT"&&c){if(a===c.split(" ")[0]){return false;}else{return true;}}else{return true;}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.EvaluationFacet')){jQuery.sap.declare('sap.ino.vc.evaluation.EvaluationFacet');jQuery.sap.require('sap.ui.model.Sorter');sap.ui.define("sap/ino/vc/evaluation/EvaluationFacet",["sap/ino/vc/commons/BaseObjectController","sap/ino/commons/models/core/CodeModel","sap/ino/controls/EvaluationData","sap/ino/controls/EvaluationDataCriterionValue","sap/ino/vc/evaluation/EvaluationFormatter","sap/ui/model/Sorter","sap/ino/commons/models/types/StringNumberType"],function(B,C,E,a,b,S,c){"use strict";var d=function(){throw"Facet may not be instantiated directly";};var f={};jQuery.extend(f,b);d.formatter=f;d.onCriterionPressed=function(e){var s=e.getSource();if(s){var p=s.getBindingContext("object")&&s.getBindingContext("object").getPath();if(p){if(!this.oCriterionValueHelpView){this.oCriterionValueHelpView=sap.ui.xmlview({viewName:"sap.ino.vc.evaluation.CriterionValueHelp"});this.getView().addDependent(this.oCriterionValueHelpView);}if(this.oCriterionValueHelpView&&this.oCriterionValueHelpView.getController()){this.oCriterionValueHelpView.getController().open(s,p);}}}};d.onEvaluatorPressed=function(e){var s=e.getSource();if(s){var i=s.getBindingContext("object")&&s.getBindingContext("object").getProperty("EVALUATOR_ID");if(i!==undefined&&!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}if(this.oIdentityCardView&&this.oIdentityCardView.getController()){this.oIdentityCardView.getController().open(s,i);}}};d.initMatrixControl=function(){var o=new a({criterionId:{path:"object>ID",mode:"OneTime"},criterionCode:{path:"object>CODE",mode:"OneTime"},parentCriterionCode:{path:"object>PARENT_CRITERION_CODE",mode:"OneTime"},criterionName:{path:"object>CODE",formatter:function(s){return f.criterionCode(s);},mode:"OneTime"},criterionDescription:{path:"object>CODE",formatter:function(s){return f.criterionCodeLongText(s);},mode:"OneTime"},criterionDataType:{path:"object>DATATYPE_CODE",mode:"OneTime"},criterionValue:{parts:[{path:"object>TEXT_VALUE"},{path:"object>BOOL_VALUE"},{path:"object>NUM_VALUE"},{path:"object>DATATYPE_CODE"}],formatter:function(t,h,n,s){return f.getValue(s,n,h,t);}},criterionLabel:{parts:[{path:"object>VALUE_OPTION_LIST_CODE"},{path:"object>CODE"},{path:"object>TEXT_VALUE"},{path:"object>BOOL_VALUE"},{path:"object>NUM_VALUE"},{path:"object>DATATYPE_CODE"}],formatter:function(v,s,t,h,n,i){var l=f.criterionCode(s);var V=f.getValue(i,n,h,t);var T=l+": ";if(v){var j=C.getConfigObjectNodeForValueOptionList(v);T=T+C.getText(j,V);}else{T=T+V;}return T;}},numValueMin:{path:"object>NUM_VALUE_MIN",type:new c(),mode:"OneTime"},numValueMax:{path:"object>NUM_VALUE_MAX",type:new c(),mode:"OneTime"},numValueStepSize:{path:"object>NUM_VALUE_STEP_SIZE",type:new c(),mode:"OneTime"},comment:"{object>COMMENT}",isDone:"{object>IS_DONE}",sequenceNo:{path:"object>SEQUENCE_NO",mode:"OneTime"},isOverallResult:{path:"object>IS_OVERALL_RESULT",mode:"OneTime"},uomCode:{path:"object>UOM_CODE",mode:"OneTime"},valueOptionListLabelCodes:{path:"object>VALUE_OPTION_LIST_CODE",formatter:function(l){if(!l){return null;}var s=C.getConfigObjectNodeForValueOptionList(l);var q=C.getCodes(s);var h=q.sort(function(j,k){return j.CODE-k.CODE;});for(var i=0;i<h.length;i++){h[i].TEXT=C.getText(s,h[i].CODE);}return h;}},aggregationType:{path:"object>AGGREGATION_TYPE",mode:"OneTime"},weight:{path:"object>WEIGHT",formatter:function(w){return f.getWeight(w);},mode:"OneTime"},xAxisCriterionCode:{path:"object>X_AXIS_CRITERION_CODE",mode:"OneTime"},xAxisCriterionCodeLabel:{path:"object>X_AXIS_CRITERION_CODE",formatter:function(h){return f.uomCode(h);},mode:"OneTime"},xAxisSegmentNo:{path:"object>X_AXIS_SEGMENT_NO",mode:"OneTime"},yAxisCriterionCode:{path:"object>Y_AXIS_CRITERION_CODE",mode:"OneTime"},yAxisCriterionCodeLabel:{path:"{object>Y_AXIS_CRITERION_CODE}",formatter:function(h){return f.uomCode(h);},mode:"OneTime"},yAxisSegmentNo:{path:"object>Y_AXIS_SEGMENT_NO",mode:"OneTime"},visParam1CriterionCode:{path:"object>VIS_PARAM_1_CRITERION_CODE",mode:"OneTime"},visParam1CriterionCodeLabel:{path:"object>UOM_CODE",formatter:function(h){return f.uomCode(h);},mode:"OneTime"},visParam2CriterionCode:{path:"object>VIS_PARAM_2_CRITERION_CODE",mode:"OneTime"},visParam2CriterionCodeLabel:{path:"object>UOM_CODE",formatter:function(h){return f.uomCode(h);},mode:"OneTime"}});this._oEvalDataTemplate=new E({evaluationId:"{object>ID}",modelCode:"{object>MODEL_CODE}",modelName:{path:"object>MODEL_CODE",formatter:function(s){return f.modelCode(s);}},modelDescription:{path:"object>MODEL_CODE",formatter:function(s){return f.modelCodeLongText(s);}},ideaId:"{object>IDEA_ID}",statusCode:"{object>STATUS_CODE}",ideaPhaseCode:"{object>IDEA_PHASE_CODE}",evaluatorId:"{object>EVALUATOR_ID}",evaluatorName:"{object>EVALUATOR_NAME}",evaluationDate:{path:"object>CHANGED_AT",type:new sap.ui.model.type.Date({style:"medium"})},overallResult:function(){return{parts:[{path:"OV_RES_DATATYPE_CODE"},{path:"OV_RES_NUM_VALUE"},{path:"OV_RES_BOOL_VALUE"},{path:"OV_RES_TEXT_VALUE"},{path:"OV_RES_VALUE_OPTION_LIST_CODE"},{path:"OV_RES_UOM_CODE"}],formatter:function(){return function(D,n,h,t,v,u){return f.getFormattedValue(D,n,h,t,v,u);};}};},values:{path:"object>CriterionValues",template:o,sorter:new S("SEQUENCE_NO",false),templateShareable:true}});var e=this.byId("evaluationMatrix");var g=e.getBinding();if(g){g.attachChange(e.prepareMatrix,e);}};d.bindMatrix=function(){var m=this.getView().byId("evaluationMatrix");m.addAggregation("evalData",this._oEvalDataTemplate);m.bindElement({path:"/",model:"object"});};d.onDelete=function(e){var o=this;var D=e.getSource();var g=this.executeObjectAction("del",{messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});g.done(function(r){if(r&&r.confirmationCancelled===true){if(D&&jQuery.type(D.focus)==="function"){D.focus();}return;}o.onDeleteNavBack("idea",true);});};d.onSubmit=function(){var o=this;var e=o.getObjectModel();var i=e.isNew();var s=o.executeObjectAction("modifyAndSubmit",{messages:{confirm:"EVALUATION_OBJECT_MSG_SUBMIT_CONFIRM",success:function(){return o.getText("EVALUATION_OBJECT_MSG_SUBMIT_OK");}},parameters:{IDEA_ID:e.getProperty("/IDEA_ID"),EVAL_REQ_ITEM_ID:e.getProperty("/EVAL_REQ_ITEM_ID")}});s.done(function(r){e.getPropertyModel().getDataInitializedPromise().done(function(){if(o.setStatusChangeButtons){o.setStatusChangeButtons();}});if(r&&r.confirmationCancelled===true){o.byId("evaluationSubmitBtn").focus();return;}if(i){o.navigateTo("evaluation-display",{id:e.getKey()},true);}else{o.navigateBack();}});};return d;});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.Modify.controller')){jQuery.sap.declare('sap.ino.vc.evaluation.Modify.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/evaluation/Modify.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ino/commons/models/object/Evaluation","sap/ino/vc/evaluation/EvaluationFacet","sap/ino/commons/models/types/IntBooleanType","sap/ino/commons/models/types/IntNullableBooleanType","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Attachment","sap/ino/vc/attachment/AttachmentMixin","sap/ino/commons/application/Configuration","sap/m/MessageToast","sap/ino/vc/commons/TopLevelPageFacet"],function(B,E,a,I,b,J,A,c,C,M,T){"use strict";var r={create:"evaluation-create",edit:"evaluation-edit"};var d=A.getEndpointURL();return B.extend("sap.ino.vc.evaluation.Modify",jQuery.extend({},T,a,c,{routes:[r.create,r.edit],intBoolean:new I(),integerType:new b(),onInit:function(){B.prototype.onInit.apply(this,arguments);if(!this.getModel("local")){this.setModel(new J({ATTACHMENT_UPLOAD_URL:d}),"local");}if(!this.getModel("view")){this.setModel(new J({"IDEA_NAVIGATION_SECTION":"ideaSectionEvaluations"}),"view");}var v=this.getModel("view");if(!v.getProperty("/IDEA_NAVIGATION_SECTION")){v.setProperty("/IDEA_NAVIGATION_SECTION","ideaSectionEvaluations");}v.setProperty("/EDIT_MODE",true);this.aBusyControls=[this.byId("evaluationLayout")];this.initMatrixControl();this.scrollDockElement("evaluationModify","evaluationMatrix");this._sResizeEvalList=this.attachListControlResized(this.byId("criteriaList"));},onExit:function(){B.prototype.onExit.apply(this,arguments);this.detachListControlResized(this._sResizeEvalList);},onRouteMatched:function(e){var t=this;var o=e.getParameter("arguments");var f=this.getObjectModel();var R=e.getParameter("name");this.setObjectExists(true);var s={actions:["del","modify","modifyAndSubmit","submit"],nodes:["Root"],continuousUse:true,readSource:{model:this.getDefaultODataModel()}};function g(f){t.setObjectModel(f);f.getDataInitializedPromise().done(function(){t.setHelp("EVALUATION_MODIFY");});f.getDataInitializedPromise().fail(function(){t.setObjectExists(false);});t.bindMatrix();}if(R===r.create){var q=o["?query"]||{};if(jQuery.isNumeric(q.ideaId)){if(q.evalIds){var h=q.evalIds.split(",");var D=this.getModel("data");var i=[];jQuery.each(h,function(l,k){var m=new jQuery.Deferred();D.read("/IdeaEvaluation("+k+")/CriterionValues",{success:function(p){m.resolve({"CriterionValues":p.results});},error:function(p){m.reject(p);}});i.push(m);if(q.includeAttachs*1){var n=new jQuery.Deferred();D.read("/IdeaEvaluation("+k+")/EvalAttachments",{success:function(p){n.resolve({"EvalAttachments":p.results});},error:function(p){n.reject(p);}});i.push(n);}});jQuery.when.apply(jQuery,i).done(function(){var l=[],m=[],n={};jQuery.each(arguments,function(u,v){if(v.hasOwnProperty("CriterionValues")&&v.CriterionValues){l.push(v.CriterionValues);}else if(v.hasOwnProperty("EvalAttachments")&&v.EvalAttachments){jQuery.each(v.EvalAttachments,function(N,w){if(!n.hasOwnProperty(w.ATTACHMENT_ID)){n[w.ATTACHMENT_ID]=true;m.push(w);}});}});var p=Number(q.evalAction);if(p===1){f=E.createAverageEvaluation(parseInt(q.ideaId,10),l,s,m,t.getText("IDEA_OBJECT_DEFAULT_AVE_EVALUATION_COMMENT"));}else if(p===2){f=E.createTotalEvaluation(parseInt(q.ideaId,10),l,s,m,t.getText("IDEA_OBJECT_DEFAULT_TOTAL_EVALUATION_COMMENT"),h[0],function(u,v){return v===1?{msg:t.getText("MSG_EVALUATION_MAX_WARNING_TXT",u),msg_tooltip:t.getText("MSG_EVALUATION_MAX_WARNING_INFO",u)}:{msg:t.getText("MSG_EVALUATION_MAX_WARNING_TXT",u),msg_tooltip:t.getText("MSG_EVALUATION_MIN_WARNING_INFO",u)};});}g(f);});}else{var j={IDEA_ID:parseInt(q.ideaId,10)};if(parseInt(q.EvalReqItemId,10)>0){j.EVAL_REQ_ITEM_ID=parseInt(q.EvalReqItemId,10);}f=new E(j,s);g(f);}}}else{if(jQuery.isNumeric(o.id)){var k=parseInt(o.id,10);if(!f||(f.getKey()!==k)){f=new E(k,s);}this.bindDefaultODataModel(k);g(f);}}},onAfterRendering:function(){this._attachmentMixinInit({attachmentId:"EvalAttachments",updateObject:function(o){},uploadSuccess:function(o,R){o.addAttachment({"CREATED_BY_NAME":C.getCurrentUser().NAME,"ATTACHMENT_ID":R.attachmentId,"FILE_NAME":R.fileName,"MEDIA_TYPE":R.mediaType,"CREATED_AT":new Date()});}});},onSave:function(){var o=this;var i=o.getObjectModel().isNew();var m=o.executeObjectAction("modify");m.done(function(){var e=o.getObjectModel();if(i){o.navigateTo("evaluation-edit",{id:e.getKey()},true);}});}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.RequestsList.controller')){jQuery.sap.declare('sap.ino.vc.evaluation.RequestsList.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/evaluation/RequestsList.controller",["sap/ui/Device","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/ino/commons/application/Configuration","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/controls/OrientationType","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/vc/commons/BaseVariantListController","sap/ino/vc/evaluation/mixins/MassActionMixin"],function(D,S,F,a,M,C,O,A,b,T,B,c){"use strict";var r={EVALREQ:"evalreqlist",EVALREQ_VARIANT:"evalreqlistvariant"};var v={EVAL_REQ_ALL:"all",EVAL_REQ_FOR_ME:"forme",EVAL_REQ_FOR_ME_OVERDUE:"formeoverdue",EVAL_REQ_MY:"my",EVAL_REQ_MY_OVERDUE:"myoverdue"};var f={NONE:undefined,EVAL_REQ_FOR_ME:"forMe",EVAL_REQ_FOR_ME_OVERDUE:"forMeOverdue",EVAL_REQ_MY:"byMe",EVAL_REQ_MY_OVERDUE:"byMeOverdue"};var l={NAME:"EVAL_REQ_LIST_MIT_NAME",Variants:{DEFAULT_VARIANT:v.EVAL_REQ_ALL,TITLE:"EVAL_REQ_LIST_MIT_ALL",Values:[{TEXT:"EVAL_REQ_LIST_MIT_ALL",ACTION:v.EVAL_REQ_ALL,FILTER:f.NONE,MANAGE:false},{TEXT:"EVAL_REQ_LIST_MIT_FOR_ME",ACTION:v.EVAL_REQ_FOR_ME,HIERARCHY_LEVEL:"1",FILTER:f.EVAL_REQ_FOR_ME,MANAGE:false},{TEXT:"EVAL_REQ_LIST_MIT_FOR_ME_OVERDUE",ACTION:v.EVAL_REQ_FOR_ME_OVERDUE,HIERARCHY_LEVEL:"1",FILTER:f.EVAL_REQ_FOR_ME_OVERDUE,MANAGE:false},{TEXT:"EVAL_REQ_LIST_MIT_MY",ACTION:v.EVAL_REQ_MY,HIERARCHY_LEVEL:"1",FILTER:f.EVAL_REQ_MY,MANAGE:true},{TEXT:"EVAL_REQ_LIST_MIT_MY_OVERDUE",ACTION:v.EVAL_REQ_MY_OVERDUE,HIERARCHY_LEVEL:"1",FILTER:f.EVAL_REQ_MY_OVERDUE,MANAGE:true}]}};var L=B.extend("sap.ino.vc.evaluation.RequestsList",jQuery.extend({},T,c,{formatter:jQuery.extend({},O),list:l,routes:["evalreqlist","evalreqlistvariant"],view:{"List":{"VARIANT":v.EVAL_REQ_ALL,"MANAGE":false,"TAGS":[],"IS_TAGS_SELECTION":false,"TAGCLOUD":true,"TAGCLOUD_EXPABLE":true,"TAGCLOUD_EXP":false,"TAGCLOUD_BAR_VISIBLE":false},"ORIENTATION":b.PORTRAIT},onInit:function(){B.prototype.onInit.apply(this,arguments);this.oViewModel=this.getModel("view");this.oViewModel.setData(this.view,true);this.initApplicationObjectChangeListeners();},onRouteMatched:function(e){this.setGlobalFilter([]);this.setHelp("EVALREQ_LIST");this.show(e);this._bInnerViewNavigation=true;},onCampaignDialogItemsSelect:function(e){var s=e.getParameter("selectedItem").data("ID")+"";var o=this.byId("panelFilterFragment--campaignFilterList");o.getBinding("suggestionItems").filter([]);var d=o.getSuggestionItems();for(var i=0;i<d.length;i++){if(d[i].getProperty("key")===s){o.setSelectionItem(d[i]);break;}}if(s!==this.getViewProperty("/List/CAMPAIGN")){this.setViewProperty("/List/CAMPAIGN",s);this.setFilter(new F("CAMPAIGN_ID",a.EQ,s));this._filter();}},onCampaignDialogSearch:function(e){var o=e.getParameter("itemsBinding");var V=jQuery.sap.encodeURL(e.getParameter("value"));o.filter(new F("SHORT_NAME",a.Contains,V));o.sort(new S("SHORT_NAME"));},onCampaignSuggestion:function(e){var V=this.getModel("view");var o=e.getSource().getBinding("suggestionItems");var E=jQuery.extend({},e,true);var s=E.getParameter("suggestValue");this.resetClientMessages();this.byId("panelFilterFragment--campaignFilterList").setFilterSuggests(false);V.setProperty("/campaignSuggestion",this._aCampaignSuggestion);o.filter(new F("SHORT_NAME",a.Contains,s));o.sort(new S("SHORT_NAME"));},onFilterReset:function(){this.setViewProperty("/List/IDEA_TITLE","");this.setViewProperty("/List/CAMPAIGN_TITLE","");this.setViewProperty("/List/EXPERT_NAME","");this.setViewProperty("/List/STATUS_TEXT","");this.setViewProperty("/List/CAMPAIGN",undefined);this.setViewProperty("/List/ACCEPT_DATE",undefined);this.setViewProperty("/List/COMPLETE_DATE",undefined);var t=this.getList();var o=t.getColumns();for(var i=0;i<o.length;i++){t.filter(o[i],null);}this.byId("panelFilterFragment--campaignFilterList").setValue(undefined);this.setFilter([]);if(!D.system.desktop){return;}},onFilterCampaignChange:function(e){var s=e.getParameter("selectedItem")?Number(e.getParameter("selectedItem").getProperty("key")):undefined;if(s!==this.getViewProperty("/List/CAMPAIGN")){this.setViewProperty("/List/CAMPAIGN",s);this.setFilter(new F("CAMPAIGN_ID",a.EQ,s));this._filter();}},onClearCampaignFilter:function(e){var V=e.getParameter("value");if(V.trim()===""){this.setViewProperty("/List/CAMPAIGN",undefined);this.setFilter([]);this._filter();}},onHandleCampaignFilterHelp:function(){var V=this.getModel("view");if(!this._oCampaignlistDialog){this._oCampaignlistDialog=this.createCampaignListDialog();}V.setProperty("/campaignSuggestion",this._aCampaignSuggestion);this._oCampaignlistDialog.open();},onOrientationChange:function(){},onTableFilter:function(e){e.preventDefault();var o=e.getParameter("column");var V=e.getParameter("value");var i=o.getId().substr(o.getId().lastIndexOf("-")+1);switch(i){case"colIdeaTitle":this.setViewProperty("/List/IDEA_TITLE",V);break;case"colExpert":this.setViewProperty("/List/EXPERT_NAME",V);break;case"colCampaign":this.setViewProperty("/List/CAMPAIGN_TITLE",V);break;case"colStatus":this.setViewProperty("/List/STATUS_TEXT",V);break;case"colAcceptDate":this.setViewProperty("/List/ACCEPT_DATE",V);break;case"colCompleteDate":this.setViewProperty("/List/COMPLETE_DATE",V);break;default:break;}o.setFiltered(Boolean(V));this._filter();},onTableSelectionChange:function(e){var t=this.getList();var s=t.getSelectedIndices();var d=jQuery.grep(s,function(i){var j=t.getContextByIndex(i).getProperty("STATUS_CODE");return j==="sap.ino.config.EVAL_REQ_REQUESTED"||j==="sap.ino.config.EVAL_REQ_IN_CLARIFICATION";});var g=jQuery.grep(s,function(i){var j=t.getContextByIndex(i).getProperty("STATUS_CODE");return j!=="sap.ino.config.EVAL_REQ_REJECTED"&&j!=="sap.ino.config.EVAL_REQ_COMPLETED"&&j!=="sap.ino.config.EVAL_REQ_EXPIRED";});var h=jQuery.grep(s,function(i){var j=t.getContextByIndex(i).getProperty("STATUS_CODE");return j!=="sap.ino.config.EVAL_REQ_REJECTED"&&j!=="sap.ino.config.EVAL_REQ_COMPLETED"&&j!=="sap.ino.config.EVAL_REQ_EXPIRED"&&j!=="sap.ino.config.EVAL_REQ_ACCEPTED";});if(this.getViewProperty("/List/IS_EVAL_REQ_LIST_BY_ME")){if(this.byId("sapInoMassDeleteBtn")){this.byId("sapInoMassDeleteBtn").setEnabled(s.length>0);}}if(this.byId("sapInoAcceptBtn")&&this.byId("sapInoRejectBtn")&&this.byId("sapInoFowardBtn")&&this.byId("sapInoCreateBtn")){this.byId("sapInoAcceptBtn").setEnabled(s.length>0&&d.length===s.length);this.byId("sapInoRejectBtn").setEnabled(s.length>0&&d.length===s.length);this.byId("sapInoFowardBtn").setEnabled(s.length>0&&h.length===s.length);this.byId("sapInoCreateBtn").setEnabled(s.length>0&&g.length===s.length);}},onTableColumnMenuOpen:function(e){var m=e.getParameter("menu");var i=e.getParameters().id;i=i.substr(i.lastIndexOf("-")+1);if(i==="colAcceptDate"||i==="colCompleteDate"){m.onAfterRendering=function(){var I=$(m.getItems()[2].getDomRef());I.find("label").html(this.getText("EVAL_REQ_LIST_FLD_WITHIN_NEXT"));I.find("input").addClass("sapUiTinyMarginBeginEnd").attr("style","width:5em").attr("type","number").attr("min","1").after("<label class='sapUiMnuTfItemLbl'>"+this.getText("EVAL_REQ_LIST_FLD_DAYS")+"</label>");};}},onTableBtnPress:function(e){var s=e.getSource();var E=s.getBindingContext("data").getProperty("ID");this.navigateTo("evaluationrequest-item",{id:E});},_filter:function(){var t=this;var d=[];if(this.getViewProperty("/List/CAMPAIGN")){d.push(new F("CAMPAIGN_ID",a.EQ,this.getViewProperty("/List/CAMPAIGN")));}if(this.getViewProperty("/List/CAMPAIGN_TITLE")){d.push(new F({path:"CAMPAIGN_TITLE",test:function(V){var s=t.getViewProperty("/List/CAMPAIGN_TITLE");if(V&&V.toLowerCase().indexOf(s.trim().toLowerCase())>=0){return true;}return false;}}));}if(this.getViewProperty("/List/IDEA_TITLE")){d.push(new F({path:"IDEA_TITLE",test:function(V){var s=t.getViewProperty("/List/IDEA_TITLE");if(V&&V.toLowerCase().indexOf(s.trim().toLowerCase())>=0){return true;}return false;}}));}if(this.getViewProperty("/List/EXPERT_NAME")){d.push(new F({path:"EXPERT_NAME",test:function(V){var s=t.getViewProperty("/List/EXPERT_NAME");if(V&&V.toLowerCase().indexOf(s.trim().toLowerCase())>=0){return true;}return false;}}));}if(this.getViewProperty("/List/STATUS_TEXT")){d.push(new F({path:"STATUS_TEXT",test:function(V){var s=t.getViewProperty("/List/STATUS_TEXT");if(V&&V.toLowerCase().indexOf(s.trim().toLowerCase())>=0){return true;}return false;}}));}if(this.getViewProperty("/List/ACCEPT_DATE")){d.push(new F({path:"ACCEPT_DATE",test:function(V){var o=new Date();var s=t.getViewProperty("/List/ACCEPT_DATE");if(!V||isNaN(s)){return false;}s=parseInt(s,10);if(o.setDate(o.getDate()+s)<V){return false;}return true;}}));}if(this.getViewProperty("/List/COMPLETE_DATE")){d.push(new F({path:"COMPLETE_DATE",test:function(V){var o=new Date();var s=t.getViewProperty("/List/COMPLETE_DATE");if(!V||isNaN(s)){return false;}s=parseInt(s,10);if(o.setDate(o.getDate()+s)<V){return false;}return true;}}));}this.getList().getBinding("rows").filter(d.length?new F(d,true):null,"Application");},_check4ManagingList:function(){var d=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");if(d){var V=this.getViewProperty("/List/VARIANT");var e=this.getListProperty("/Variants/Values");var g=jQuery.grep(e,function(o){return o.ACTION===V;});g=(g&&g.length>0)?g[0]:{};return g.MANAGE||g.CAMPAIGN_MANAGE||false;}return false;},bindList:function(){var t=this;this.saveState();this.resetActionState();var p="";var i=false;var o=this.getBindingParameter();function d(){var e=arguments[0].getParameter("data").results;var n=[];var V=t.getModel("view");jQuery.each(e,function(I,g){if(jQuery.grep(n,function(N){return N.ID===g.CAMPAIGN_ID;}).length===0||n.length===0){n.push({ID:g.CAMPAIGN_ID,SHORT_NAME:g.CAMPAIGN_TITLE});}});V.setProperty("/campaignSuggestion",n);t._aCampaignSuggestion=n;t._filter();}p+="SearchEvaluationRequestParams";p+="(filterName='"+(o.VariantFilter||"")+"'"+")/Results";this.setPath("data>/"+p);if((!D.system.desktop&&D.orientation.landscape)||(D.system.desktop&&this.getViewProperty("/ORIENTATION")===b.LANDSCAPE)){i=true;}this.getList().bindRows({parameters:{operationMode:"Client"},sorter:new S("COMPLETE_DATE",false),path:this.getPath(),events:{dataRequested:function(){jQuery.each(t.getBusyControls(),function(I,e){if(jQuery.type(e.setBusy)==="function"){e.setBusy(true);}});},dataReceived:function(){jQuery.each(t.getBusyControls(),function(I,e){if(jQuery.type(e.setBusy)==="function"){e.setBusy(false);}});if(jQuery.type(d)==="function"){d.apply(this,arguments);}}}});},createCampaignListDialog:function(){if(!this._campaignDialog){this._campaignDialog=this.createFragment("sap.ino.vc.idea.fragments.CampaignSuggestionSelectList",this.getView().getId());this.getView().addDependent(this._campaignDialog);}return this._campaignDialog;},getBindingParameter:function(){var V,s;V=this.getViewProperty("/List/VARIANT");s=this.getCurrentVariant().FILTER;var d=this.getViewProperty("/List/SEARCH");var t=this.getViewProperty("/List/TAGS");var e=this.getViewProperty("/List/CAMPAIGN");var g=jQuery.map(t,function(o){return o.ID;});return{Variant:V,VariantFilter:s,SearchTerm:d,TagIds:g,CampaignId:e};},getList:function(){return this.byId("tablelist--evaluationrequestlist");},getVariantVisibility:function(V){var d,e;d=this.getModel("list").getProperty("/Variants/Values");for(var i=0;i<d.length;i+=1){var o=d[i];if(o.ACTION===V){e=o.VISIBLE;}}return e;},initApplicationObjectChangeListeners:function(){var t=this;var d=["create","del","modifyAndSubmit","executeStatusTransition","forward"];var e=function(E){var s=E.getParameter("actionName");if(s&&d.indexOf(s)>-1&&E.getParameter("object").getMetadata().getName()==="sap.ino.commons.models.object.EvaluationRequestItem"){t.bindList();}};A.attachChange(A.Action.Create,e);A.attachChange(A.Action.Del,e);A.attachChange(A.Action.Action,e);},show:function(e,o){var q;var V;if(e&&e.getParameter){var d=e.getParameter("arguments");q=d["?query"];V=d.variant;}else{V=o.variant;q=o;}var t=this;var s=this.getListProperty("/Variants/DEFAULT_VARIANT");this.setViewProperty("/isre",V||s);V=this.getViewProperty("/isre");var g=this.getVariant(V);this.setViewProperty("/List/VARIANT",g.ACTION);var h=this.getList()&&this.getList().isBound("rows");var R=this.hasStateChanged(this.getCurrentRoute(),V,q,D.orientation.portrait);R=R||this._bListChanged;this._bListChanged=false;if(!h||R){this.setVariantVisibility();this.setParameters(q,g);var i=this.getViewProperty("/ORIENTATION");this.onOrientationChange(D.system.desktop?i:D.orientation);var j=this.getVariantVisibility(V);if(j===false||typeof(j)==="undefined"){M.show(t.getText("NOT_AUTHORIZED_MESSAGE"),M.Icon.INFORMATION,t.getText("NOT_AUTHORIZED_DIALOG_TITLE"),[M.Action.OK],function(){t.navigateTo("home");});return;}this.bindList();}},setParameters:function(q,V){q=q||{};var s=V.ACTION;this.setViewProperty("/List/HAS_BACKOFFICE",C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access"));this.setViewProperty("/List/TAGCLOUD",false);this.setViewProperty("/List/MANAGE",true);this.setViewProperty("/List/IS_EVAL_REQ_LIST",true);this.setViewProperty("/List/IS_EVAL_REQ_LIST_FOR_ME",false);this.setViewProperty("/List/IS_EVAL_REQ_LIST_BY_ME",false);this.setViewProperty("/List/IS_EVAL_REQ_LIST_ALL",false);this.setViewProperty("/DISABLE_ORIENTATION",true);if([v.EVAL_REQ_FOR_ME,v.EVAL_REQ_FOR_ME_OVERDUE].indexOf(s)>=0){this.setViewProperty("/List/IS_EVAL_REQ_LIST_FOR_ME",true);this.setViewProperty("/List/IS_EVAL_REQ_LIST_BY_ME",false);this.setViewProperty("/List/IS_EVAL_REQ_LIST_ALL",false);this.setViewProperty("/List/SELECTION_MODE","Single");}else if([v.EVAL_REQ_MY,v.EVAL_REQ_MY_OVERDUE].indexOf(s)>=0){this.setViewProperty("/List/IS_EVAL_REQ_LIST_BY_ME",true);this.setViewProperty("/List/IS_EVAL_REQ_LIST_FOR_ME",false);this.setViewProperty("/List/IS_EVAL_REQ_LIST_ALL",false);this.setViewProperty("/List/SELECTION_MODE","MultiToggle");}else{this.setViewProperty("/List/IS_EVAL_REQ_LIST_BY_ME",false);this.setViewProperty("/List/IS_EVAL_REQ_LIST_FOR_ME",false);this.setViewProperty("/List/IS_EVAL_REQ_LIST_ALL",true);this.setViewProperty("/List/SELECTION_MODE","Single");}this.setViewProperty("/List/MANAGE",!this.getViewProperty("/List/IS_EVAL_REQ_LIST_ALL")&&!V.MANAGE||(V.MANAGE&&C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")));},setVariantVisibility:function(){var V=this.getModel("list").getProperty("/Variants/Values");for(var i=0;i<V.length;i+=1){var o=V[i];var I=o.MANAGE||false;var d=o.EXPERT||false;var e=o.CAMPAIGN_MANAGE||false;var g=C.getSystemSetting("sap.ino.config.EVAL_REQ_ACTIVE")==="1"&&(!I&&!d&&!e)||(d&&C.hasCurrentUserPrivilege("sap.ino.ui::expert"))||(e&&C.hasCurrentUserPrivilege("sap.ino.ui::campaign_manager"))||(I&&C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access"));this.getModel("list").setProperty("/Variants/Values/"+i+"/VISIBLE",g);}}}));L.list=l;L.routes=r;return L;});};if(!jQuery.sap.isDeclared('sap.ino.vc.follow.CampaignFeedList.controller')){sap.ui.getCore().loadLibrary("sap.ino.wall");jQuery.sap.declare('sap.ino.vc.follow.CampaignFeedList.controller');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/follow/CampaignFeedList.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/commons/TopLevelPageFacet","sap/m/Label","sap/ino/controls/IdentityActionCard","sap/ino/commons/models/core/ClipboardModel","sap/ino/commons/models/object/User","sap/m/VBox","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ino/vc/follow/mixins/FeedsMixin"],function(C,F,T,L,I,a,U,V,R,J,b,c,d,e,f,g){"use strict";return C.extend("sap.ino.vc.follow.CampaignFeedList",jQuery.extend({},F,R,c,T,g,{formatter:jQuery.extend({},this.formatter,F),onInit:function(){C.prototype.onInit.apply(this,arguments);},onRouteMatched:function(E){var A=E.getParameter("arguments");this.iCampaignId=parseInt(A.id,0);this.bindList();},getList:function(){return this.byId("campaignFeedList");},bindList:function(){var s=this;var p=b.getBackendRootURL()+"/sap/ino/xs/rest/common/feed.xsjs";var P=[];var o=this.byId("campaignFeedList");o.setBusy(true);if(this.iCampaignId){P.push("campaign="+this.iCampaignId);}if(P.length>0){p=p+"?"+P.join("&");}var h=new J(p);h.attachRequestCompleted(null,function(){o.setBusy(false);if(h.oData.results){jQuery.each(h.oData.results,function(i,j){j.EVENT_AT=new Date(j.EVENT_AT);});}s.getView().setModel(h,"feed");},h);},onRefresh:function(){this.bindList();}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.follow.FeedList.controller')){sap.ui.getCore().loadLibrary("sap.ino.wall");jQuery.sap.declare('sap.ino.vc.follow.FeedList.controller');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.ui.model.Sorter');sap.ui.define("sap/ino/vc/follow/FeedList.controller",["sap/ino/vc/commons/BaseVariantListController","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/commons/models/core/ClipboardModel","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/commons/models/object/User","sap/m/VBox","sap/m/Link","sap/ui/model/Sorter","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ino/commons/models/object/Attachment","sap/ino/vc/attachment/AttachmentMixin","sap/ino/vc/follow/mixins/FeedsMixin"],function(C,T,F,a,b,U,V,L,S,R,c,d,e,A,f,g){"use strict";return C.extend("sap.ino.vc.follow.FeedList",jQuery.extend({},F,R,b,T,c,f,g,{routes:["feedlist"],formatter:F,onInit:function(){C.prototype.onInit.apply(this,arguments);},onRouteMatched:function(){this.bindList();this.setHelp("FEED_LIST");},bindList:function(){var B=this.getList().getBindingInfo("items");this.getList().bindItems(B);},getList:function(){return this.byId("feedList");},onRefresh:function(){this.bindList();}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.follow.List.controller')){jQuery.sap.declare('sap.ino.vc.follow.List.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/follow/List.controller",["sap/ino/vc/commons/BaseVariantListController","sap/ui/Device","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/commons/application/Configuration","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/controls/OrientationType","sap/m/MessageToast","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/idea/mixins/VolunteerMixin"],function(B,D,S,J,F,a,C,O,T,b,c,d,M,R,V,f){"use strict";var o={ASC:"ASC",DESC:"DESC"};var s={NAME:"NAME",CREATED_AT:"FOLLOW_DATE"};var v={CAMPAIGN:"campaign",IDEA:"idea",TAG:"tag"};var m={NONE:undefined};var l={ADJUSTMENT_TITLE:"FOLLOWED_OBJECT_LIST_TIT_ADJUSTMENT",Filter:{},Sequence:['campaign','idea','tag'],Sorter:{Values:[{TEXT:"SORT_MIT_NAME",ACTION:s.NAME,DEFAULT_ORDER:o.ASC},{TEXT:"SORT_MIT_FOLLOW",ACTION:s.CREATED_AT,DEFAULT_ORDER:o.ASC}]},Order:{Values:[{TEXT:"ORDER_MIT_ASC",ACTION:o.ASC},{TEXT:"ORDER_MIT_DESC",ACTION:o.DESC}]},Variants:{DEFAULT_VARIANT:v.CAMPAIGN,TITLE:"FOLLOWED_OBJECT_LIST_TIT_VARIANTS",Values:[{TEXT:"FOLLOWED_OBJECT_LIST_MIT_CAMPAIGN",ACTION:v.CAMPAIGN,FILTER:m.NONE,DEFAULT_SORT:s.NAME,VISIBLE:true,OBJECT_COUNT:undefined},{TEXT:"FOLLOWED_OBJECT_LIST_MIT_IDEA",ACTION:v.IDEA,FILTER:m.NONE,DEFAULT_SORT:s.NAME,VISIBLE:true,OBJECT_COUNT:undefined},{TEXT:"FOLLOWED_OBJECT_LIST_MIT_TAG",ACTION:v.TAG,FILTER:m.NONE,DEFAULT_SORT:s.NAME,VISIBLE:true,OBJECT_COUNT:undefined}]}};var L={FOLLOW:"followlist",FOLLOW_VARIANT:"followlistvariant"};var g=B.extend("sap.ino.vc.follow.List",jQuery.extend({},T,R,b,c,V,f,{routes:["followlist","followlistvariant"],initialFocus:"mainFilterButton",list:l,formatter:O,view:{"List":{"SORT":s.NAME,"ORDER":undefined,"VARIANT":v.CAMPAIGN,"Default":{"SORT":s.NAME,"ORDER":undefined,"VARIANT":v.CAMPAIGN}},"ORIENTATION":d.LANDSCAPE},onInit:function(){B.prototype.onInit.apply(this,arguments);this.oViewModel=this.getModel("view")||new J({});this.oViewModel.setData(this.view,true);this.getList().attachUpdateFinished(this.onListUpdateFinished,this);},onRouteMatched:function(e,h){var q;var i;if(e&&e.getParameter){var A=e.getParameter("arguments");this._sRoute=e.getParameter("name");q=A["?query"];i=A.variant;}else{this._sRoute=e;q=h;i=h.variant;}var j=this.getListProperty("/Variants/DEFAULT_VARIANT");this.setViewProperty("/List/VARIANT",i||j);i=this.getViewProperty("/List/VARIANT");var k;var n=this.getVariant(i);var p=this.getList().isBound("items");if(!q||!q.sort){var r=n.DEFAULT_SORT;var t=this.getSort(r).DEFAULT_ORDER;q=q||{};q.sort=q.sort||r;q.sort=q.sort+" "+(q.order||t);}var u=this.hasStateChanged(this._sRoute,i,q,D.orientation.portrait);if(!p||u){this.setParameters(q,n);k=this.getSort(this.getViewProperty("/List/SORT"));this.setSorter(k);var w=this.getViewProperty("/ORIENTATION");this.onOrientationChange(D.system.desktop?w:D.orientation);this.setSortIcon(this.byId("panelFilterFragment--sortreverse"),this.getViewProperty("/List/ORDER"));this.bindList();this.initialSorterItems();}this._bInnerViewNavigation=true;if(D.system.desktop&&this._bAutoOpenFilter!==false){this.onShowFilterBar(true);this._bAutoOpenFilter=false;}this.setHelp("FOLLOW_LIST");},bindList:function(){var e=this.getViewProperty("/List/VARIANT");this.saveState();this.setPath("data>/"+this.getBindingPath(e));B.prototype.bindList.apply(this);},getBindingPath:function(e){if(e==="campaign"){return"MyCampaignFollow";}else if(e==="idea"){return"MyIdeaFollow";}else{return"MyTagFollow";}},getVariantNumer:function(e){var h=this.getListProperty("/Sequence");return h&&h.indexOf(e);},getList:function(){return this.byId("objectlist");},onListUpdateFinished:function(e){var h=this.getViewProperty("/List/VARIANT");this.setListProperty("/Variants/Values/"+this.getVariantNumer(h)+'/OBJECT_COUNT',e.getParameter('total'));},getItemTemplate:function(){var e=this.getViewProperty("/List/VARIANT");if(e==='tag'){return this.getFragment("sap.ino.vc.tag.fragments.CardListItem");}var r;if((!D.system.desktop&&D.orientation.landscape)||(D.system.desktop&&this.getViewProperty("/ORIENTATION")===d.LANDSCAPE)){r="Landscape";}else{r="Portrait";}var t;switch(r){case"Landscape":t=this.getFragment("sap.ino.vc."+e+".fragments.FlatListItem");break;case"Portrait":t=this.getFragment("sap.ino.vc."+e+".fragments.CardListItem");break;default:break;}return t;},onOrientationChange:function(e){if(this.getList()){var h=this.getViewProperty("/List/VARIANT");if(h==='tag'){if(this.getPortraitStyle){this.getList().addStyleClass(this.getPortraitStyle());}if(this.getLandscapeStyle){this.getList().removeStyleClass(this.getLandscapeStyle());}this.getList().setWrapping(true);return;}if(e===d.LANDSCAPE||e.landscape){if(this.getPortraitStyle){this.getList().removeStyleClass(this.getPortraitStyle());}if(this.getLandscapeStyle){this.getList().addStyleClass(this.getLandscapeStyle());}}else{if(this.getPortraitStyle){this.getList().addStyleClass(this.getPortraitStyle());}if(this.getLandscapeStyle){this.getList().removeStyleClass(this.getLandscapeStyle());}}this.getList().setWrapping(!(e===d.LANDSCAPE||e.landscape));}},setParameters:function(q,e){B.prototype.setParameters.apply(this,arguments);},getDefaultVariantValue:function(){return[{TEXT:"FOLLOWED_OBJECT_LIST_MIT_CAMPAIGN",ACTION:v.CAMPAIGN,FILTER:m.NONE,DEFAULT_SORT:s.NAME,VISIBLE:true}];},onOpenIdea:function(E){var i;if(E.getParameter("ideaId")){i=E.getParameter("ideaId");}else{try{if(E.getSource().getProperty("objectId")){i=E.getSource().getProperty("objectId");}}catch(e){i=E.getSource().getBindingContext("data").getProperty("ID");}}if(i){this.navigateTo("idea-display",{id:i});}},onOpenCampaign:function(e){this.navigateTo("campaign",{id:e.getParameter("campaignId")});},onItemPress:function(e){var i=e.getSource();var h=i.getBindingContext("data");var j=e.getSource().getBindingContext("data").getProperty("CAMPAIGN_ID");if(j){this.navigateTo("idea-display",{id:e.getSource().getBindingContext("data").getProperty("ID")});}else if(h){this.navigateTo("campaign",{id:h.getProperty("ID")});}},onCreateIdea:function(e){this.navigateTo("idea-create",{query:{campaign:e.getParameter("campaignId")}});},onIdeaCommentPress:function(E){var i;if(E.getParameter("ideaId")){i=E.getParameter("ideaId");}else{try{if(E.getSource().getProperty("objectId")){i=E.getSource().getProperty("objectId");}}catch(e){i=E.getSource().getBindingContext("data").getProperty("ID");}}if(i){this.navigateTo("idea-display",{id:i,query:{section:"sectionComments"}});}}}));g.list=l;g.listContext=L;return g;});};if(!jQuery.sap.isDeclared('sap.ino.vc.gamification.LeaderBoard.controller')){jQuery.sap.declare('sap.ino.vc.gamification.LeaderBoard.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.m.SegmentedButtonItem');sap.ui.define("sap/ino/vc/gamification/LeaderBoard.controller",["sap/ino/vc/commons/BaseController","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/Device","sap/ino/vc/commons/mixins/ClipboardMixin","sap/ino/vc/commons/mixins/IdentityQuickviewMixin","sap/ino/commons/formatters/ObjectListFormatter","sap/m/SegmentedButtonItem"],function(B,C,J,T,D,a,I,O,S){"use strict";var f={formatTitle:function(c,t){return t;},formatMyRanking:function(u){var c=C.getCurrentUser().USER_ID;if(u===c){return true;}else{return false;}},formatRankImage:function(s){var i=parseInt(s,10);if(i>3){return null;}var p=jQuery.sap.getModulePath("sap.ino.assets");if(i===1){return p+"/img/leaderBoard/gold2x.png";}else if(i===2){return p+"/img/leaderBoard/sliver2x.png";}else if(i===3){return p+"/img/leaderBoard/bronze2x.png";}},formatVisbleNumber:function(s){if(parseInt(s,10)>3){return true;}else{return false;}},formatVisbleRankImage:function(s){if(parseInt(s,10)<=3){return true;}else{return false;}},formatTooltipRank:function(s){return this.getText("LEADER_BOARD_RANK",[s]);}};jQuery.extend(f,O);return B.extend("sap.ino.vc.gamification.LeaderBoard",jQuery.extend({},T,a,I,{routes:["leaderboard"],formatter:f,view:{"showCommentDialogBtn":false},onInit:function(){B.prototype.onInit.apply(this,arguments);this.oViewModel=this.getModel("view");this.oViewModel.setData(this.view,true);},onRouteMatched:function(){this.generateDimensionSegmentBtn();},generateDimensionSegmentBtn:function(){var t=this;var s=this.byId('leaderBoardSegBtn');var u=C.getBackendRootURL()+"/sap/ino/xs/rest/common/dimension.xsjs/getAllActiveDimension";var A=jQuery.ajax({url:u,headers:{"X-CSRF-Token":C.getXSRFToken()},dataType:"json",type:"POST",contentType:"application/json; charset=UTF-8",async:true});A.done(function(r){var d=r.RESULT.ALL_ACTIVE_DIMENSION;var m=new J();m.setData(d);t.getView().setModel(m,"dimension");if(d.length===0){return;}if(s){s.removeAllItems();var o=new S({text:"{dimension>NAME}",tooltip:"{dimension>NAME}",key:"{dimension>ID}",press:function(e){t.onPressItem(e);}});s.bindItems({path:"dimension>/",template:o});}var w=d.length*10;s.setWidth("80%");s.fireSelect(s.getItems()[0]);t.setViewProperty("/SELECTED_DIMENSION_ID",d[0].ID);t.bindViewData();});},onPressItem:function(e){var s=e.getSource();var c=s.getKey();var b=this.getModel("dimension").getData();for(var i=0;i<b.length;i++){if(c===b[i].ID.toString()){this.setViewProperty("/SELECTED_DIMENSION_ID",b[i].ID);break;}}this.byId('leaderBoardSegBtn').setBusy(true);this.bindViewData();},bindViewData:function(){var t=this;var l=this.getFragment("sap.ino.vc.gamification.fragments.leaderBoardItem");var b={DIMENSION_ID:this.getViewProperty("/SELECTED_DIMENSION_ID")};var u=C.getBackendRootURL()+"/sap/ino/xs/rest/common/dimension.xsjs/getLeaderBoardByDimension";var A=jQuery.ajax({url:u,headers:{"X-CSRF-Token":C.getXSRFToken()},data:JSON.stringify(b),dataType:"json",type:"POST",contentType:"application/json; charset=UTF-8",async:true});A.done(function(r){var L=r.RESULT.LeaderBoardRanking;var s=r.RESULT.SelfRanking;var m=t.getView().getModel("dimension");var c=[],d=false,e=null,g=null;for(var i=0;i<L.length;i++){e=null;if(JSON.stringify(L[i].BADGE)!=="{}"&&L[i].BADGE.currentBadge.Attachment&&L[i].BADGE.currentBadge.Attachment.length>0){e=L[i].BADGE.currentBadge.Attachment[0].ATTACHMENT_ID;}c.push({USER_ID:L[i].IDENTITY_ID,USER_NAME:L[i].NAME,IMAGE_ID:L[i].IDENTITY_IMAGE_ID,SEQUENCE:L[i].ranking,BADGE_IMAGE_ID:e,BADGE_NAME:JSON.stringify(L[i].BADGE)!=="{}"?L[i].BADGE.currentBadge.NAME:null});if(s&&!d){d=L[i].IDENTITY_ID===s.IDENTITY_ID?true:false;}}if(s&&!d){if(JSON.stringify(s.BADGE)!=="{}"&&s.BADGE.currentBadge.Attachment&&s.BADGE.currentBadge.Attachment.length>0){g=s.BADGE.currentBadge.Attachment[0].ATTACHMENT_ID;}c.push({USER_ID:s.IDENTITY_ID,USER_NAME:s.NAME,IMAGE_ID:s.IDENTITY_IMAGE_ID,SEQUENCE:s.ranking,BADGE_IMAGE_ID:g,BADGE_NAME:JSON.stringify(s.BADGE)!=="{}"?s.BADGE.currentBadge.NAME:null});}m.setProperty("/LeaderBoardRanking",c);var o={path:"dimension>/LeaderBoardRanking",template:l};var h=t.byId("leaderBoardList");h.bindItems(o);});t.byId('leaderBoardSegBtn').setBusy(false);}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.home.CommunityHome.controller')){jQuery.sap.declare('sap.ino.vc.home.CommunityHome.controller');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/home/CommunityHome.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/vc/iam/mixins/IdentityProfileMixin","sap/ino/commons/application/Configuration","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ino/vc/idea/RewardFormatter","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ui/core/IconPool","sap/ino/vc/follow/mixins/FeedsMixin","sap/ino/commons/models/object/Homepagewidget","sap/ui/model/json/JSONModel"],function(C,I,a,S,F,V,b,O,T,R,c,d,f,g,H,J){"use strict";var m={Community:{PATH:"/EntityCount(1)",SHOW_BUTTONS:true,Binding:[{ICON:"sap-icon://InoIcons/campaign",LINK_TEXT:"PROFILE_LNK_CAMPAIGNS_OPENED",COUNT:"OPEN_CAMPAIGN_COUNT",Route:{NAME:"campaignlistvariant",QUERY:{variant:"open"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_OPEN_FOR_EVALUATION",COUNT:"EVALUATION_OPEN_COUNT",EXPERT:true,Route:{NAME:"idealistvariant",QUERY:{variant:"evalopen"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_MY",COUNT:"AUTHORED_IDEA_COUNT",Route:{NAME:"idealistvariant",QUERY:{variant:"my"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_EVAL_BY_ME",COUNT:"EVALUATED_IDEA_COUNT",EXPERT:true,Route:{NAME:"idealistvariant",QUERY:{variant:"eval"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role"]},{ICON:"sap-icon://InoIcons/wall",LINK_TEXT:"PROFILE_LNK_WALLS_MY",COUNT:"MY_WALLS_COUNT",Route:{NAME:"walllistvariant",QUERY:{variant:"my"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role"]},{ICON:"sap-icon://InoIcons/heart",LINK_TEXT:"PROFILE_LNK_MY_VOTES",COUNT:"MY_VOTES_IDEA_COUNT",Route:{NAME:"idealistvariant",QUERY:{variant:"voted"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role","sap.ino.ui::camps_part_role"]},{ICON:"sap-icon://comment",LINK_TEXT:"PROFILE_LNK_MY_COMMENTS",COUNT:"MY_COMMENTS_IDEA_COUNT",Route:{NAME:"idealistvariant",QUERY:{variant:"commented"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role","sap.ino.ui::camps_part_role"]},{ICON:f.getIconURI('following','InoIcons'),LINK_TEXT:"PROFILE_LNK_FOLLOWED_MY",COUNT:"MY_FOLLOWED_COUNT",Route:{NAME:"followlistvariant",QUERY:{variant:"campaign"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role","sap.ino.ui::camps_part_role"]}]}};var l={"my":{sPath:"data>/MyIdeaMediumCommunity",sorter:new S("CHANGED_AT",true)},"all":{sPath:"data>/IdeaMediumCommunity",filter:[new F("STATUS","NE","sap.ino.config.DRAFT")],sorter:new S("SUBMITTED_AT",true)},"completed":{sPath:"data>/IdeaMediumSearchParams(searchToken='',tagsToken='',tagsToken1='',tagsToken2='',tagsToken3='',tagsToken4='',filterName='completedIdeas',filterBackoffice=0,c1='',o1=-2,v1='',c2='',o2=-1,v2='',c3='',o3=-1,v3='',cvt='',cvr=0,cvy=0)/Results",sorter:new S("SUBMITTED_AT",true)}};var L={XS:{centerProfileContainer:"identityProfileFragment--identityProfile",centerTopContributorContainer:"topContributorFragment--topContributor",centerBlogContainer:"blogsFragment--blogCommunity",rightTopContributorContainer:undefined,leftProfileContainer:undefined},S:{leftProfileContainer:"identityProfileFragment--identityProfile",centerTopContributorContainer:"topContributorFragment--topContributor",centerBlogContainer:"blogsFragment--blogCommunity"},M:{leftProfileContainer:"identityProfileFragment--identityProfile",centerTopContributorContainer:"topContributorFragment--topContributor",centerBlogContainer:"blogsFragment--blogCommunity"},L:{leftProfileContainer:"identityProfileFragment--identityProfile",centerTopContributorContainer:"topContributorFragment--topContributor",centerBlogContainer:"blogsFragment--blogCommunity"},XL:{leftProfileContainer:"identityProfileFragment--identityProfile",rightTopContributorContainer:"topContributorFragment--topContributor",rightTopBlogContainer:"blogsFragment--blogCommunity"}};return C.extend("sap.ino.vc.home.CommunityHome",jQuery.extend({},I,V,b,T,R,d,O,g,{identityProfile:m,list:l,formatter:jQuery.extend({},O,c),initialFocus:["backofficeButton--backofficeToogle","identityProfileFragment--createIdea"],onInit:function(){C.prototype.onInit.apply(this,arguments);this.aBusyControls=[this.getView()];var D=H.getCommunityHomepageWidget();D.done(function(o){var w=o.RESULT[0]||{IS_VISIBLE:false,HTML_CONTENT:""};w.IS_VISIBLE=!!w.IS_VISIBLE;this.getView().setModel(new J(w),"widget");}.bind(this));},feedTitleLink:function(o,s){if(!isNaN(parseInt(o,10))){switch(s){case'CAMPAIGN':return O.navigationLink.apply(this,["campaign",{id:o}]);case'IDEA':return O.navigationLink.apply(this,["idea-display",{id:o}]);default:break;}}return undefined;},show:function(p){this._oParentView=p;this.setIdentityProfileBinding();this.bindViewData();},setIdentityProfileBinding:function(){this.bindIdentityProfile(this.byId("identityProfileFragment--identityProfile"),m.Community);if(this.getModel("data").getProperty(m.Community.PATH)){var o=this;this.getModel("data").read(m.Community.PATH,{success:function(){var B=o.byId("identityProfileFragment--identityProfileList").getBindingInfo("items");o.byId("identityProfileFragment--identityProfileList").bindItems(B);}});}},bindViewData:function(){this._bindCampaigns();this.setViewProperty("/IS_COMMUNITY_VIEW",true);var i;if(this.getModel("device").getProperty("/system/phone")){i=Object.keys(l)[0];}else{i=this.byId("ideasFragment--sapInoHomeIdeasButtons").getSelectedKey();}this._sIdeaViewKey=i||Object.keys(l)[0];this._bindIdeas(this._sIdeaViewKey);this._bindBlogs();},onResizeLayoutChange:function(o,n){var t=this;function s(j,N){for(var i=0;i<j.length;i+=1){if(i<N){j[i].setVisible(true);}else{j[i].setVisible(false);}}}function e(i){var j=t.byId(i);var k=j.getItems();switch(n){case"XL":if(i==="blogsFragment--blogsList"){s(k,3);}else{s(k,4);}break;case"L":s(k,4);break;case"M":s(k,3);break;case"S":s(k,2);break;case"XS":s(k,1);break;default:break;}}var h=this.getModel("device").getProperty("/system/phone");if(!h){e("ideasFragment--ideasList");e("blogsFragment--blogsList");}},_bindCampaigns:function(){var p="data>/CampaignSearchParams(searchToken='',"+"tagsToken='',"+"tagsToken1='',"+"tagsToken2='',"+"tagsToken3='',"+"tagsToken4='',"+"filterName='openCampaigns',"+"filterBackoffice=0)/Results";var o=this.byId("campaignsListFragment--campaignsCarousel");o.bindAggregation("pages",{path:p,template:this.createFragment("sap.ino.vc.home.fragments.CampaignBanner"),length:4,top:4,filters:[new F("STATUS_CODE","NE","sap.ino.config.CAMP_DRAFT")],sorter:new S("SUBMIT_TO",false)});},_bindIdeas:function(k){var i=this.getModel("device").getProperty("/system/phone");var e=a.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE")*1||a.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE_HIDE_PHASE_BAR")*1;var t=Number(e)?this.getFragment("sap.ino.vc.idea.fragments.CardListItemNoImage"):this.getFragment("sap.ino.vc.idea.fragments.CardListItem");var o={path:l[k].sPath,template:t,length:4,top:4,sorter:l[k].sorter,filters:l[k].filter};var h=this;var p="";var s="";var j="";var n="&$select(ID)";var B=a.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");var q="";if(B){q="/sap/ino/xs/rest/backoffice/odata.xsodata";}else{q="/sap/ino/xs/rest/community/odata.xsodata";}if(i){var r=this.byId("ideasFragment--ideasCarousel");r.bindAggregation("pages",o);p=a.getBackendRootURL()+q+r.mBindingInfos.pages.binding.sPath+"?$format=json";s=r.mBindingInfos.pages.binding.sFilterParams;j=r.mBindingInfos.pages.binding.sSortParams;}else{var u=this.byId("ideasFragment--ideasList");u.bindItems(o);u.attachEventOnce("updateFinished",function(E){h.onResizeLayoutChange(null,h._sCurrentLayout);});p=a.getBackendRootURL()+q+u.mBindingInfos.items.binding.sPath+"?$format=json";s=u.mBindingInfos.items.binding.sFilterParams;j=u.mBindingInfos.items.binding.sSortParams;}var v=this.byId("ideasFragment--panelTitle");v.setText(this.getText("HOMEPAGE_PANEL_IDEAS_"+k.toUpperCase()));p=p+"&"+j+"&"+s+n;var w=new J();w.setData({path:p});sap.ui.getCore().setModel(w,"ideaSearchParams");},_bindBlogs:function(){if(a.getCurrentUser().USER_ID){var i=this.getModel("device").getProperty("/system/phone");var p="data>/BlogSearchParams(searchToken='',"+"tagsToken='',"+"filterName='publishedBlogs')/Results";var B={path:p,template:this.getFragment("sap.ino.vc.blog.fragments.ListItemHome"),sorter:new S("PUBLISHED_AT",true),length:4,top:4};var t=this;if(i){var o=this.byId("blogsFragment--blogsCarousel");o.bindAggregation("pages",B);}else{var e=this.byId("blogsFragment--blogsList");if(e){e.bindItems(B);e.attachEventOnce("updateFinished",function(){t.onResizeLayoutChange(null,t._sCurrentLayout);});}}var h=this.byId("blogsFragment--panelBlogTitle");h.setText(this.getText("HOMEPAGE_PANEL_CAMPAIGN_BLOGS"));}},onIdeaListTypeSelect:function(e){this._sIdeaViewKey=e.getParameter("key")||e.getParameter("selectedItem")&&e.getParameter("selectedItem").getKey();this._bindIdeas(this._sIdeaViewKey);},onNavigateToIdeas:function(){if(!this._sIdeaViewKey){this.navigateTo("idealist");}else{this.navigateTo("idealistvariant",{variant:this._sIdeaViewKey});}},onNavigateToBlogs:function(){this.navigateTo("bloglist");},onNavigateToCampaigns:function(){this.navigateTo("campaignlistvariant",{variant:"open"});},onCampaignsListItemPress:function(e){var i=e.getSource();var o=i.getBindingContext("data");if(o){this.navigateTo("campaign",{id:o.getProperty("ID")});}},onCardItemPress:function(e){var i=e.getSource();var o=i.getAggregation("content")[0];o.getFocusDomRef().focus();},onCreateIdea:function(e){this.navigateTo("idea-create",{query:{campaign:e.getParameter("campaignId")}});},onOpenIdea:function(E){var i;if(E.getParameter("ideaId")){i=E.getParameter("ideaId");}else{try{if(E.getSource().getProperty("objectId")){i=E.getSource().getProperty("objectId");}}catch(e){i=E.getSource().getBindingContext("data").getProperty("ID");}}if(i){this.navigateTo("idea-display",{id:i});}},onIdeaCommentPress:function(E){var i;if(E.getParameter("ideaId")){i=E.getParameter("ideaId");}else{try{if(E.getSource().getProperty("objectId")){i=E.getSource().getProperty("objectId");}}catch(e){i=E.getSource().getBindingContext("data").getProperty("ID");}}if(i){this.navigateTo("idea-display",{id:i,query:{section:"sectionComments"}});}},onOpenCampaign:function(e){this.navigateTo("campaign",{id:e.getParameter("campaignId")});},getLayout:function(s){return L[s];},onBackofficeSettings:function(){if(this._oParentView){var o=this._oParentView.getController();if(o.onBackofficeSettings){o.onBackofficeSettings();}}},onNavigateToFeedList:function(){this.navigateTo("feedlist");},onOfficeToggle:function(){if(this._oParentView){var o=this._oParentView.getController();if(o.switchView){o.switchView();}}},onBlogItemPress:function(e){if(this._bIsTokenPressed){this._bIsTokenPressed=false;return;}var i=e.getSource();var o=i.getBindingContext("data");if(o){this.navigateTo("blog-display",{id:o.getProperty("ID")});}},onOpenCreator:function(e){var s=e.getSource();var i=s.getBindingContext("data").getProperty("CREATED_BY_ID");if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(s,i);},showPopupTagCard:function(e){this._bIsTokenPressed=true;if(!this._oPopover){this._oPopover=sap.ui.xmlfragment("sap.ino.vc.tag.fragments.TagCardPopover",this);this.getView().addDependent(this._oPopover);}var t=e.getSource();var p="/SearchTagsAll(searchToken='',ID="+t.getKey()+")";var D=this.getModel("data");var h=this;D.read(p,{async:true,success:function(o){var M=new sap.ui.model.json.JSONModel();M.setData(o);h._oPopover.setModel(M,"Tag");jQuery.sap.delayedCall(0,h,function(){h._oPopover.openBy(t);});}});}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.home.RegisterApprovalList.controller')){jQuery.sap.declare('sap.ino.vc.home.RegisterApprovalList.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.ui.model.Filter');sap.ui.define("sap/ino/vc/home/RegisterApprovalList.controller",["sap/ino/vc/commons/BaseVariantListController","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/commons/formatters/BaseFormatter","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/m/Label","sap/ino/controls/IdentityActionCard","sap/ino/commons/models/object/User","sap/m/VBox","sap/m/Link","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ui/model/Filter"],function(C,T,O,B,a,J,L,I,U,V,b,R,F){"use strict";return C.extend("sap.ino.vc.home.RegisterApprovalList",jQuery.extend({},O,B,T,R,{routes:["registerapprovallist","registerapprovallistvariant","campaign-registerapprovallistvariant"],formatter:jQuery.extend({},O,B),onInit:function(){C.prototype.onInit.apply(this,arguments);},getList:function(){return this.byId("registerList");},bindList:function(){var l="registerList";var o=this.getView().byId(l).getBindingInfo("items");this.getView().byId(l).bindItems(o);},onCampaignsListItemPress:function(e){var i=e.getSource();var c=i.getBindingContext("data");if(c){this.navigateTo("campaign",{id:c.getProperty("CAMPAIGN_ID")});}},onAfterRendering:function(){this._initTabs();},_getTabs:function(){return this._tabs;},_initTabs:function(){this._tabs=[];},_defaultOnKeyDown:function(e){if(Control.prototype.onkeydown){Control.prototype.onkeydown.apply(this,arguments);}},onRouteMatched:function(e){var A=e.getParameter("arguments");var c=A["id"];var l="registerList";var o=this.getView().byId(l).getBindingInfo("items");if(o.filters.length>1){o.filters.pop();}if(c){var d=new F("CAMPAIGN_ID","EQ",c);o.filters.push(d);}this.getView().byId(l).bindItems(o);this.setHelp("APPROVAL_LIST");},onkeydown:function(e){var t=this._getTabs();var u=this._incr;if(e.shiftKey||e.keyCode===jQuery.sap.KeyCodes.ARROW_UP||e.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){u=this._decr;}if(e.keyCode===jQuery.sap.KeyCodes.ESCAPE){this.getParent().focus();}else if(e.keyCode===jQuery.sap.KeyCodes.TAB||e.keyCode===jQuery.sap.KeyCodes.ARROW_DOWN||e.keyCode===jQuery.sap.KeyCodes.ARROW_RIGHT||e.keyCode===jQuery.sap.KeyCodes.ARROW_UP||e.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT){var c=jQuery(":focus");var i=-1;if(c&&c.length>0){i=t.indexOf(c[0].id);i=u(i,t.length-1);this._focus(jQuery("#"+t[i]));e.preventDefault();e.stopPropagation();}else{this.getParent().focus();}}else{this._defaultOnKeyDown(e);}},_incr:function(v,m){v++;if(v>m){return 0;}return v;},_decr:function(v,m){v--;if(v<0){return m;}return v;},_focus:function(e){if(jQuery.type(e.focus)==="function"){setTimeout(function(){e.focus();},0);}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.iam.List.controller')){jQuery.sap.declare('sap.ino.vc.iam.List.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');sap.ui.define("sap/ino/vc/iam/List.controller",["sap/ino/vc/commons/BaseVariantListController","sap/ui/Device","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/controls/OrientationType","sap/ino/commons/application/Configuration"],function(B,D,S,J,F,T,O,C){"use strict";var o={ASC:"ASC",DESC:"DESC"};var s={CHANGED_AT:"CHANGED_AT",NAME:"NAME",SEARCH_SCORE:"SEARCH_SCORE"};var v={ALL:"all"};var f={NONE:undefined,USER:"USER"};var l={PEOPLE:"peoplelist",PEOPLE_VARIANT:"peoplelistvariant"};var L={NAME:"PEOPLE_LIST_TIT_NAME",ADJUSTMENT_TITLE:"IDENTITY_LIST_TIT_ADJUSTMENT",Filter:{},Sorter:{Values:[{TEXT:"SORT_MIT_CHANGED",ACTION:s.CHANGED_AT,DEFAULT_ORDER:o.DESC},{TEXT:"SORT_MIT_NAME",ACTION:s.NAME,DEFAULT_ORDER:o.ASC}]},Order:{Values:[{TEXT:"ORDER_MIT_ASC",ACTION:o.ASC},{TEXT:"ORDER_MIT_DESC",ACTION:o.DESC}]},Variants:{DEFAULT_VARIANT:v.ALL,TITLE:"PEOPLE_LIST_TIT_VARIANTS",Values:[{TEXT:"PEOPLE_LIST_MIT_USER",ACTION:v.ALL,FILTER:f.USER,DEFAULT_SORT:s.NAME,VISIBLE:true}]}};var i=B.extend("sap.ino.vc.iam.List",jQuery.extend({},T,{routes:["peoplelist","peoplelistvariant"],initialFocus:"mainFilterButton",list:L,view:{"List":{"SORT":s.NAME,"ORDER":undefined,"VARIANT":v.ALL,"Default":{"SORT":s.NAME,"ORDER":undefined,"VARIANT":v.ALL}},"ORIENTATION":O.PORTRAIT,"DISABLE_ORIENTATION":true},onInit:function(){B.prototype.onInit.apply(this,arguments);var V=this.getModel("view")||new J({});V.setData(this.view,true);this.getList().attachUpdateFinished(this.onUpdateFinished,this);if(D.system.phone&&!D.orientation.portrait){this.getList().setWrapping(false);}else{this.getList().setWrapping(true);}},onRouteMatched:function(e,a){var q;var V;var b;var c;var d;var g=this.getListProperty("/Variants/DEFAULT_VARIANT");if(e&&e.getParameter){var A=e.getParameter("arguments");this._sRoute=e.getParameter("name");q=A["?query"];V=A.variant;}else{this._sRoute=e;q=a;V=a.variant;}var h=this.getModel("view");h.setData(this.view,true);var j=this.getList().isBound("items");if(!q||!q.sort){var k=this.getViewProperty("/List/Default/SORT");var m=this.getSort(k)[0].DEFAULT_ORDER;q=q||{};q.sort=q.sort||k;q.sort=q.sort+" "+(q.order||m);}var r=this.hasStateChanged(this._sRoute,V,q,D.orientation.portrait);if(!j||r){c=this.getVariant(V);if(!c){c=this.getVariant(g);}d=c.FILTER;this.setParameters(q,c);b=this.getSort(this.getViewProperty("/List/SORT"));this.setSorter(b);this.updateFilter();this.setSortIcon(this.byId("panelFilterFragment--sortreverse"),this.getViewProperty("/List/ORDER"));var n=this.getViewProperty("/List/SEARCH");this.bindList(n,d);this.initialSorterItems();}this._bInnerViewNavigation=true;this.setHelp("IDENTITY_LIST");},getBindingPath:function(q){if(!q||q==={}){return{Path:this.getIdentiryEntityName()};}else{var b={};if(q.search===undefined){b.Path=this.getIdentiryEntityName();}else{b.Path="SearchIdentityPeopleList(searchToken='"+(q.search||"")+"')/Results";}if(q.variant){b.Filter=[new F("TYPE_CODE","EQ",q.variant)];}return b;}},getIdentiryEntityName:function(){if(C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")){return"Identity";}return"LeanIdentity";},updateListAccessibilityUserCard:function(){this.getList().getBinding("items").attachDataReceived(function(){var a=this.getList();var I=a.$().find("li");jQuery.each(I,function(b,c){var $=jQuery(c);$.attr("aria-label",$.getEncodedText());});},this);},bindList:function(a,V){var r=this.getCurrentRoute();var b;if(r==="identitylistvariant"){b=this.getCurrentVariant().ACTION;}this.saveState(b);var c=this.getBindingPath({search:a,variant:V});this.setPath("data>/"+c.Path);B.prototype.setFilter.apply(this,c.Filter);B.prototype.bindList.apply(this,arguments);this.updateListAccessibilityUserCard();},getList:function(){return this.byId("objectlist");},getItemTemplate:function(){return this.getFragment("sap.ino.vc.iam.fragments.IdentityListItem");},onVariantPress:function(V,e){B.prototype.onVariantPress.apply(this,[V,e,"identitylistvariant","identitylist"]);},onRefresh:function(){var a=this.getList();var b=a.getBindingInfo("items");a.bindAggregation("items",b);},updateFilter:function(){},onUserPressed:function(e){var I=e.getSource();var c=I.getBindingContext("data");if(c){this.navigateTo("userdetail",{id:c.getProperty("ID")});}},formatObjectListVariantsVisible:function(){return true;}}));i.list=L;i.listContext=l;return i;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.Activities.controller')){sap.ui.getCore().loadLibrary("sap.ino.wall");jQuery.sap.declare('sap.ino.vc.idea.Activities.controller');jQuery.sap.require('sap.ino.vc.wall.util.WallFactory');jQuery.sap.require('sap.ino.wall.WallPreview');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.CustomData');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.ui.core.mvc.XMLView');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.ui.core.HTML');sap.ui.define("sap/ino/vc/idea/Activities.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/wall/util/WallFactory","sap/ino/wall/WallPreview","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/ino/controls/IFrame","sap/ui/core/CustomData","sap/m/Label","sap/m/Link","sap/ino/controls/Image","sap/m/Text","sap/ui/core/mvc/XMLView","sap/ui/core/mvc/ViewType","sap/m/HBox","sap/ui/core/HTML","sap/ino/controls/IdentityActionCard","sap/ino/commons/models/core/ClipboardModel","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ino/commons/models/object/User","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ino/commons/models/core/CodeModel"],function(B,O,W,a,C,J,I,b,L,c,d,T,X,V,H,e,f,g,R,U,h,F,j,k){"use strict";return B.extend("sap.ino.vc.idea.Activities",jQuery.extend({},R,h,F,j,{formatter:O,DISPLAY_EVENTS_IDEA:["CREATED_sap.ino.config.COPIED_SOURCE","CREATED_sap.ino.config.COPIED_TARGET","CREATED_sap.ino.config.DUPLICATE_SOURCE","CREATED_sap.ino.config.DUPLICATE_TARGET","CREATED_sap.ino.config.MERGED_SOURCE","CREATED_sap.ino.config.MERGED_TARGET","DELETED_sap.ino.config.DUPLICATE_SOURCE","DELETED_sap.ino.config.DUPLICATE_TARGET"],DISPLAY_EVENTS_CAMPAIGN:["IDEA_CAMPAIGN_REASSIGN","STATUS_ACTION_SUBMIT"],DISPLAY_EVENTS_WALL:["WALL_ASSIGNED","WALL_UNASSIGNED"],DISPLAY_EVENTS_EVAL:["STATUS_ACTION_sap.ino.config.EVAL_PUB_COMMUNITY","STATUS_ACTION_sap.ino.config.EVAL_PUB_SUBMITTER","STATUS_ACTION_sap.ino.config.EVAL_SUBMIT"],DISPLAY_EVENTS_DIFFTEXT:["IDEA_NAME_CHANGED","IDEA_NAME_DESCRIPTION_CHANGED"],DISPLAY_EVENTS_ATTACHMENT:["ATTACHMENT_ASSIGNED","ATTACHMENT_UNASSIGNED"],DISPLAY_EVENTS_TITLEIMG:["IDEA_TITLE_IMAGE_ASSIGNED","IDEA_TITLE_IMAGE_CHANGED"],DISPLAY_EVENTS_PERSON:["IDEA_COACH_CREATED","IDEA_COACH_DELETED","IDEA_CONTRIBUTOR_CREATED","IDEA_CONTRIBUTOR_DELETED","IDEA_EXPERT_CREATED","IDEA_EXPERT_DELETED"],DISPLAY_EVENTS_LINK:["LINK_CREATED"],DISPLAY_EVENTS_EVAL_REQ:["EVAL_REQ_CREATED","EVAL_REQ_UPDATED","EVAL_REQ_DELETED","EVAL_REQ_EXPIRED","EVAL_REQ_ITEM_CLARIFICATION_SENT","EVAL_REQ_EXPERT_FORWARDED","EVAL_REQ_CHECKED"],onInit:function(){B.prototype.onInit.apply(this,arguments);this.DISPLAY_EVENTS_EXPANDABLE=[].concat(this.DISPLAY_EVENTS_IDEA,this.DISPLAY_EVENTS_CAMPAIGN,this.DISPLAY_EVENTS_WALL,this.DISPLAY_EVENTS_PERSON,this.DISPLAY_EVENTS_DIFFTEXT,this.DISPLAY_EVENTS_ATTACHMENT,this.DISPLAY_EVENTS_LINK,this.DISPLAY_EVENTS_EVAL,this.DISPLAY_EVENTS_TITLEIMG,this.DISPLAY_EVENTS_EVAL_REQ);var A=this.getView().byId("ideaActivitiesList");A.addEventDelegate({onAfterRendering:this._applyGroupingHeaders.bind(this,A)});this._sResizeActivityList=this.attachListControlResized(A);},onBeforeRendering:function(){var A=this.getView().byId("ideaActivitiesList");var o=A.getBindingInfo("items");A.bindItems(o);},onAfterRendering:function(){var A=this.getView().byId("ideaActivitiesList");var o=A.getBinding("items");var t=this;if(o){o.attachDataReceived(function(){t._applyGroupingHeaders(A);},this);}},onExit:function(){B.prototype.onExit.apply(this,arguments);this.detachListControlResized(this._sResizeActivityList);},msgformatter:function(v){var r,m,p,P,s;if(v&&v.CHANGE_EVENT){m="ACTIVITIES_MSG_"+v.CHANGE_EVENT;if(v.CHANGE_CODE==="AUTO_COACH_ASSIGNED"){m+="_AUTO_COACH_ASSIGNED";}p=v.PARAM_0;P=v.PARAM_1;s=v.CAMPAIGN_NAME;if(v.CHANGE_EVENT.indexOf("STATUS_ACTION_")===0){p=this.formatter.ideaPhase(p);}if(v.CHANGE_EVENT.indexOf("CAMPAIGN_")===0){p=this.formatter.ideaPhase(p);P=this.formatter.ideaStatus(P);}if(v.CHANGE_EVENT.indexOf("IDEA_RESP_VALUE_CODE")===0){p=k.getText('sap.ino.xs.object.subresponsibility.ResponsibilityStage.RespValues',p);P=k.getText('sap.ino.xs.object.subresponsibility.ResponsibilityStage.RespValues',P);}r=this.getText(m,["",p,P,s]);if(v.CHANGE_EVENT.indexOf("IDEA_CAMPAIGN_REASSIGN")>-1){var S=this.formatter.ideaStatus(v.STATUS_CODE);var i=this.getText(m+"_STATUS",[S]);r=r+i;}if(r===m){if(v.CHANGE_EVENT.indexOf("STATUS_ACTION_")===0){var l=this.formatter.ideaStatusAction(v.PARAM_1);var n=this.formatter.ideaStatus(v.STATUS_CODE);r=this.getText("ACTIVITIES_MSG_STATUS_ACTION_GENERIC",["",l,n,s]);}else{r=this.getText("ACTIVITIES_MSG_GENERIC_CHANGE_EVENT",[v.CHANGE_EVENT]);}}}return r;},isExpandable:function(o){var E=o.CHANGE_EVENT;if(this.DISPLAY_EVENTS_EXPANDABLE.indexOf(E)!==-1){return true;}else if((E.indexOf("STATUS_ACTION_")===0)&&(o.PARAM_0_ID)&&(E.indexOf("EVAL_REWORK")===-1&&E.indexOf("EVAL_UNPUBLISH")===-1)){return true;}return false;},_createPanelIdea:function(s,i){var S=s;var o;if(i){o=this.getFragment("sap.ino.vc.idea.fragments.FlatListItem").clone();o.addStyleClass("sapMListBGSolid");o.data("source-type","idea");o.bindElement({path:"data>/IdeaMedium("+i+")/"});}else{o=new L({text:this.getText("ACTIVITIES_MSG_IDEA_NON_EXISTENT")});}S.addContent(o);},_createPanelIdentity:function(s,i,u,l,o,r){var m;if(i){m=new f({identityId:i,userImageUrl:l?this.formatter.userImage(l):null,userOrganization:o,userName:u,userRole:r?this.formatter.multipleRoleCodes(r):null,actionable:false,pinnable:this.getModel("clipboard").getProperty("/enabled"),isPinned:this.formatIsUserInClipboard(i),pinPressed:[this.onUserPinPressed,this],identityPress:[this.onOpenIdentityQuickView,this]});}s.addContent(m);},_createPanelCampaign:function(s,i){var o,w,l;if(i){w=this.formatter.widthCampaignCard(this.getModel("device"));o=this.getFragment("sap.ino.vc.campaign.fragments.CardListItem").clone();l=new sap.m.HBox({width:w}).addItem(o);o.getContent()[0].data("source-type","campaign");o.bindElement("data>/CampaignFull("+i+")/");}s.addContent(l);},_createPanelWall:function(s,w){if(w){var u=C.getBackendRootURL()+C.getApplicationObject("sap.ino.xs.object.wall.Wall")+"/"+w;var m=new J(u);m.attachRequestCompleted({controller:this,wallId:w},this._onWallLoaded,s);}},_createPanelTextDiff:function(s,o,n){var i="<div class=\"ideaActivityDiff\">"+this.getText("ACTIVITIES_MSG_TITLE_DIFF",[o&&o.trim()||"",n&&n.trim()||""])+"</div>";var l=new e({content:i,sanitizeContent:true});s.addContent(l);},_createPanelAttachment:function(s,A){var o;if(A){o=this.createView({viewName:"sap.ino.vc.attachment.Attachment",type:V.XML});o.data("editable",false);o.byId("Attachments").setNoDataText(this.getText("ACTIVITIES_MSG_ATTACHMENT_NON_EXISTENT"));o.bindElement("data>/Attachment("+A+")/");}s.addContent(o);},_createPanelTitleImg:function(s,i,l){var o;if(i){var u=C.getAttachmentDownloadURL(i);o=new d({src:u,objectId:i,objectName:l,alt:this.getText("ACTIVITIES_MSG_IMG_NON_EXISTENT")});}s.addContent(o);},_createPanelLink:function(s,u,t){var o;if(u){o=new c({text:t?t:u,target:"_blank",href:u});}s.addContent(o);},_createPanelEvalLink:function(s,E){var o;if(E){o=new c({text:this.getText("ACTIVITIES_MSG_LINK_EVALUATION"),press:[this.onOpenEvaluation,this]});}s.addContent(o);},_createPanelDecision:function(s,D){var o;if(D){o=this.createFragment("sap.ino.vc.idea.fragments.DecisionPanel");o.bindElement("data>/IdeaStatusDecision("+D+")/");}s.addContent(o);},decisionMadeByFormatter:function(D){return this.getText("ACTIVITIES_MSG_DECISION_MADE_BY",[D]);},decisionReasonFormatter:function(r){return this.getText("ACTIVITIES_MSG_DECISION_REASON_COMMENTS",[r]);},decisionReasonCodeFormatter:function(r){var s=this.formatter.valueOption(r);return this.getText('ACTIVITIES_MSG_DECISION_REASON_CODE',[s]);},onDecisionLinkPress:function(E){var o=E.getSource().getBindingContext("data");var u=C.getMailPreviewURL({DECISION:o.getProperty("ID")});var m=new J(u);m.attachRequestCompleted(this.onMailTextLoaded,this);},onMailTextLoaded:function(E){var o=new I({content:E.getSource().getData().TEXT});if(!this._oMailViewDialog){this._oMailViewDialog=this.createFragment("sap.ino.vc.idea.fragments.MailPreviewDialog");this.getView().addDependent(this._oMailViewDialog);}this._oMailViewDialog.addContent(o);this._oMailViewDialog.open();},onMailViewClose:function(E){if(this._oMailViewDialog){this._oMailViewDialog.close();this._oMailViewDialog.destroyContent();}},_createPanelEvalReqText:function(s,E,t){var o;if(E){var l=new L({text:this.getText("ACTIVITIES_MSG_EVAL_REQ_DESCRIPTION")});var i=new T({text:t,maxLines:2});o=new sap.m.HBox({}).addItem(l).addItem(i);}s.addContent(o);},onExpand:function(E){var s=E.getSource();var o=s.getBindingContext("data");if(E.getParameter("expand")&&o){s.toggleStyleClass("sapInoActivityExpanded");var D=o.getObject();var i=D.CHANGE_EVENT;if(this.DISPLAY_EVENTS_IDEA.indexOf(i)!==-1){this._createPanelIdea(s,D.PARAM_0_ID);}else if(this.DISPLAY_EVENTS_PERSON.indexOf(i)!==-1){this._createPanelIdentity(s,D.PARAM_0_ID,D.PARAM_0,D.PARAM_1_ID,D.PARAM_1);}else if(this.DISPLAY_EVENTS_CAMPAIGN.indexOf(i)!==-1){this._createPanelCampaign(s,D.CAMPAIGN_ID);}else if(this.DISPLAY_EVENTS_WALL.indexOf(i)!==-1){this._createPanelWall(s,D.PARAM_0_ID);}else if(this.DISPLAY_EVENTS_DIFFTEXT.indexOf(i)!==-1){this._createPanelTextDiff(s,D.PARAM_1,D.PARAM_0);}else if(this.DISPLAY_EVENTS_ATTACHMENT.indexOf(i)!==-1){this._createPanelAttachment(s,D.PARAM_0_ID);}else if(this.DISPLAY_EVENTS_TITLEIMG.indexOf(i)!==-1){this._createPanelTitleImg(s,D.PARAM_0_ID,D.PARAM_0);}else if(this.DISPLAY_EVENTS_LINK.indexOf(i)!==-1){this._createPanelLink(s,D.PARAM_1,D.PARAM_0);}else if(this.DISPLAY_EVENTS_EVAL.indexOf(i)!==-1){this._createPanelEvalLink(s,D.PARAM_0_ID);}else if(this.DISPLAY_EVENTS_EVAL_REQ.indexOf(i)!==-1){this._createPanelEvalReqText(s,D.PARAM_0_ID,D.PARAM_1);}else if((i.indexOf("STATUS_ACTION_")===0)&&D.PARAM_0_ID){this._createPanelDecision(s,D.PARAM_0_ID,D.PARAM_1_ID);}}else{s.toggleStyleClass("sapInoActivityExpanded");s.removeAllContent();}},_onWallLoaded:function(E,p){var s=E.getSource();var D=s.oData;if(D&&D.ID&&p.controller){var w=W.createWallFromInoJSON(D);var o=new a({owner:D.CREATED_BY_NAME,hits:D.VIEW_COUNT,press:[p,p.controller.onOpenWall,p.controller]});o.setWall(w);this.addContent(o);}else{this.addContent(new T({text:{path:"i18n>ACTIVITIES_MSG_WALL_NON_EXISTENT"}}));}},onOpenEvaluation:function(E){var i=E.getSource().getBindingContext("data").getProperty("PARAM_0_ID");if(i){this.navigateTo("evaluation-display",{id:i});}},onOpenWall:function(E,p){var w=p.wallId;if(w){this.navigateToWall("wall",{id:w});}},onOpenIdea:function(E){var i=E.getSource().getBindingContext("data").getProperty("ID");if(i){this.navigateTo("idea-display",{id:i});}},onItemPress:function(E){var s=E.getSource();var n;switch(s.data("source-type")){case"idea":n="idea-display";break;case"campaign":n="campaign";break;default:break;}var i=E.getSource().getBindingContext("data").getProperty("ID");if(n&&i){this.navigateTo(n,{id:i});}},_applyGroupingHeaders:function(E){var s=E.getSource&&E.getSource()||E;var l=s.getItems(),m,p,P,o;for(var i=0;i<l.length;++i){o=l[i];m=o.getBindingContext("data").getProperty("PHASE_CODE");if(m!==p){P=this.formatter.ideaPhase(m);if(P){o.$().attr("data-actgroup-title",this.getText("ACTIVITIES_TIT_PHASE_GROUP",P));o.$().attr("aria-label",this.getText("ACTIVITIES_TIT_PHASE_GROUP",P));}}else{o.$().removeAttr("data-actgroup-title");o.$().removeAttr("aria-label");}p=m;}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.Evaluations.controller')){jQuery.sap.declare('sap.ino.vc.idea.Evaluations.controller');jQuery.sap.require('sap.m.GroupHeaderListItem');sap.ui.define("sap/ino/vc/idea/Evaluations.controller",["sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/vc/commons/BaseController","sap/ino/vc/evaluation/EvaluationFacet","sap/ino/vc/evaluation/EvaluationFormatter","sap/m/GroupHeaderListItem","sap/ino/commons/application/Configuration"],function(A,B,E,a,G,C){"use strict";var f={};jQuery.extend(f,a);f.formatGroupHeader=function(g){return new G({title:f.ideaPhase(g.ideaPhaseCode),upperCase:false});};return B.extend("sap.ino.vc.idea.Evaluations",{formatter:f,grouper:function(c){return{key:c.getProperty("GROUP_ORDER"),ideaPhaseCode:c.getProperty("IDEA_PHASE_CODE")};},onInit:function(){var e=["evaluationList","myEvaluationList","pubEvaluationList"];var t=this;B.prototype.onInit.apply(this,arguments);this._initHandleEvaluationAOChange();this._initHandleEvaluationRequestAOChange();e.forEach(function(s){var o=t.byId(s);if(o){if(!t._aResizeEvalList){t._aResizeEvalList=[];}t._aResizeEvalList.push(t.attachListControlResized(o));}});this._oRouter=this.getOwnerComponent().getRouter();this._oRouter.attachRouteMatched(this._resetSelList,this);},onExit:function(){var t=this;B.prototype.onExit.apply(this,arguments);t._aResizeEvalList.forEach(function(r){t.detachListControlResized(r);});this._oRouter.detachRouteMatched(this._resetSelList,this);},onItemPress:function(e){var c=e.getSource()&&e.getSource().getBindingContext("data");if(c){this.navigateTo("evaluation-display",{id:c.getProperty("ID")});}},onItemRequestPressManager:function(e){var c=e.getSource()&&e.getSource().getBindingContext("data");if(c){this.navigateTo("evaluationrequest-display",{id:c.getProperty("ID")});}},onItemRequestPressExpert:function(e){var c=e.getSource()&&e.getSource().getBindingContext("data");if(c){this.navigateTo("evaluationrequest-item",{id:c.getProperty("ID")});}},onSelectionChange:function(e){if(!this._oSelectionMap){this._oSelectionMap={};}var s=e.getParameter("selected");var S=e.getSource();var d=S.getBindingContext("data").getObject();var o=this.getModel("objectContext");if(s){this._oSelectionMap[d.ID]=d.MODEL_CODE;}else{delete this._oSelectionMap[d.ID];}var O=this.getModel("object");o.setProperty("/EvaluationSelection",this._oSelectionMap);var v=true;jQuery.each(this._oSelectionMap,function(i,c){if(c!==O.getProperty("/CURR_PHASE_EVALUATION_MODEL")){v=false;}});var b=v&&Object.keys(this._oSelectionMap).length>=2;o.setProperty("/CreateAverageEvaluationEnabled",b);o.setProperty("/CreateTotalEvaluationEnabled",b);},_initHandleEvaluationAOChange:function(){var t=this;var b=function(e){var s=e&&e.getParameter("actionName");if(s&&["create","del","submit","modifyAndSubmit","executeStatusTransition"].indexOf(s)>-1){t.rebindList(t.getView().byId("myEvaluationList"));var S=e&&e.getParameter("instance")&&e.getParameter("instance").getProperty("/STATUS_CODE");if(S!=="sap.ino.config.EVAL_DRAFT"){t.rebindList(t.getView().byId("pubEvaluationList"));t.rebindList(t.getView().byId("evalationRequestExpert"));}var c=e.getParameter("changeRequest");if((s&&["create","del","submit","modifyAndSubmit"].indexOf(s)>-1)||c&&c.STATUS_ACTION_CODE==="sap.ino.config.EVAL_REWORK"){t.rebindList(t.getView().byId("evaluationList"));t.rebindList(t.getView().byId("evalationRequestExpert"));}}};A.attachChange(A.Action.Create,b);A.attachChange(A.Action.Del,b);A.attachChange(A.Action.Action,b);},_initHandleEvaluationRequestAOChange:function(e){var t=this;var b=function(e){var s=e&&e.getParameter("actionName");var c=e.getParameter("changeRequest");if(e.getParameter("object").getMetadata().getName()==="sap.ino.commons.models.object.EvaluationRequest"&&t&&t.getView().byId("evalationRequestManager")){if(s&&["create","del","submit","modifyAndSubmit","bulkDeleteEvalReqs"].indexOf(s)>-1){if((s&&["del","submit","modifyAndSubmit","create"].indexOf(s)>-1)||c){t.rebindList(t.getView().byId("evalationRequestManager"));}}}else if(e.getParameter("object").getMetadata().getName()==="sap.ino.commons.models.object.EvaluationRequestItem"&&t&&t.getView().byId("evalationRequestExpert")){if(s&&["create","del","submit","modifyAndSubmit","forward","executeStatusTransition"].indexOf(s)>-1){if((s&&["del","submit","modifyAndSubmit","create"].indexOf(s)>-1)||c){t.rebindList(t.getView().byId("evalationRequestExpert"));}}}};A.attachChange(A.Action.Create,b);A.attachChange(A.Action.Del,b);A.attachChange(A.Action.Action,b);},onEvaluatorPressed:function(e){e.preventDefault();var s=e.getSource();if(s){var i=s.getBindingContext("data")&&s.getBindingContext("data").getProperty("EVALUATOR_ID");if(i!==undefined&&!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}if(this.oIdentityCardView&&this.oIdentityCardView.getController()){this.oIdentityCardView.getController().open(s,i);}}},onEvaluationRequestOwnerPressed:function(e){e.preventDefault();var s=e.getSource();if(s){var i=s.getBindingContext("data")&&s.getBindingContext("data").getProperty("OWNER_ID");if(i!==undefined&&!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}if(this.oIdentityCardView&&this.oIdentityCardView.getController()){this.oIdentityCardView.getController().open(s,i);}}},rebindList:function(l){if(l){var b=l.getBindingInfo("items");l.bindItems(b);}},_resetSelList:function(){var o=this.getModel("objectContext");var b=Object.keys(o.getProperty("/EvaluationSelection")||{});if(b.length<=0&&this.getCurrentRoute()==="idea-display"){this._oSelectionMap={};this.rebindList(this.getView().byId("evaluationList"));this.rebindList(this.getView().byId("myEvaluationList"));this.rebindList(this.getView().byId("pubEvaluationList"));}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.ModifyRewardList.controller')){jQuery.sap.declare('sap.ino.vc.idea.ModifyRewardList.controller');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/idea/ModifyRewardList.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/m/MessageToast","sap/ino/vc/idea/RewardFormatter"],function(B,M,R){"use strict";return B.extend("sap.ino.vc.idea.ModifyRewardList",{formatter:R,setDialog:function(d){this._oDialog=d;},onExecuteStatusTransition:function(s){var c=this;var m=c.getObjectModel();var a=m.executeStatusTransition({STATUS_ACTION_CODE:s});if(a){a.done(function(){M.show(c.getText("OBJECT_MSG_STATUS_CHANGE_SUCCESS"));});a.fail(function(o){if(o.MESSAGES&&o.MESSAGES.length>0){M.show(c.getText(o.MESSAGES[0].MESSAGE_TEXT));}});}},onSave:function(){this.resetClientMessages();this._setRewardUnit();this.executeObjectAction("modify");},onDel:function(e){return this.executeObjectAction("del",{messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});},onRewardsBtnUnPublish:function(){this.onExecuteStatusTransition('sap.ino.config.REWARD_UNPUBLISH');},onRewardsBtnPublishAuthor:function(){this.onExecuteStatusTransition('sap.ino.config.REWARD_PUB_AUTHOR');},onRewardsBtnPublishCommunity:function(){this.onExecuteStatusTransition('sap.ino.config.REWARD_PUB_COMMUNITY');},onRewardDialogDel:function(e){var t=this;var d=this.onDel(e);var D=e.getSource();d.done(function(r){if(!r||!r.confirmationCancelled){t._closeDialog();return;}if(D&&jQuery.type(D.focus)==="function"){D.focus();}});},onRewardDialogCancel:function(){this._closeDialog();},onRewardAmoutChange:function(e){var n=this._getAuthorId(e);var a=this._getTotalAmount(n,e);this._setRewardShare(n,a,e);this._setLastRewardShare();this.getObjectModel().setProperty("/REWARD_AMOUNT_TOTAL",a);},_getAuthorId:function(e){var n=-1;var c=e.getSource().getCustomData();jQuery.each(c,function(i,d){if(d.getKey()==="Id"){n=d.getValue();return false;}});return n;},_getTotalAmount:function(n,e){var s=0;var r=this.getObjectModel().getProperty("/Rewards");jQuery.each(r,function(i,d){var v=d.REWARD_AMOUNT;if(d.AUTHOR_ID===n){v=e.getParameter("value");}if(v){var a=parseInt(v.toString().replace(/,/g,""),10);if(!isNaN(a)){s+=parseInt(a,10);}}});return s;},_setRewardShare:function(n,a,e){var b=a;if(!b){b=1;}var m=this.getObjectModel();var r=m.getProperty("/Rewards");jQuery.each(r,function(i,d){var v=d.REWARD_AMOUNT;if(d.AUTHOR_ID===n){v=e.getParameter("value");}if(v){var c=parseInt(v.toString().replace(/,/g,""),10);if(isNaN(c)||c===0){c=0;}else{c=Math.round(c*100/b);}m.setProperty("/Rewards/"+i+"/REWARD_SHARE",c);}});},_setLastRewardShare:function(){var n=0;var m=this.getObjectModel();var r=m.getProperty("/Rewards");jQuery.each(r,function(i,d){if(d.REWARD_SHARE){n+=d.REWARD_SHARE;}});var a=r.length-1;for(;a>=0;a--){if(r[a].REWARD_SHARE>0){m.setProperty("/Rewards/"+a+"/REWARD_SHARE",100-n+r[a].REWARD_SHARE);break;}}},_setRewardUnit:function(){var m=this.getObjectModel();var r=m.getProperty("/Rewards");var u=m.getProperty("/REWARD_UNIT_CODE");m.setProperty("/REWARD_UNIT",u);jQuery.each(r,function(i,d){m.setProperty("/Rewards/"+i+"/REWARD_UNIT",u);});},rewardShareFormatter:function(n){if(n===null||n===void 0){return"";}return Math.round(parseFloat(n*100))/100+"%";},_closeDialog:function(){if(this._oDialog){this._oDialog.close();this._oDialog.destroy();}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.PPM.controller')){sap.ui.getCore().loadLibrary("sap.ino.wall");jQuery.sap.declare('sap.ino.vc.idea.PPM.controller');jQuery.sap.require('sap.ui.model.odata.ODataModel');jQuery.sap.require('sap.ui.core.format.NumberFormat');sap.ui.define("sap/ino/vc/idea/PPM.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/commons/application/Configuration","sap/ui/model/odata/ODataModel","sap/ui/core/format/NumberFormat"],function(B,O,C,a,N){"use strict";var p={"DPO":"sap.ino.vc.idea.fragments.PPMProjectDetail","PPO":"sap.ino.vc.idea.fragments.PPMItemDetail","TPO":"sap.ino.vc.idea.fragments.PPMTaskDetail","TTO":"sap.ino.vc.idea.fragments.PPMTaskDetail"};return B.extend("sap.ino.vc.idea.PPM",{formatter:jQuery.extend({currentStep:function(c){return c-1;},successProbability:function(s){var n=N.getPercentInstance({maxFractionDigits:3});return n.format(s/1000);}},this.formatter,O),onInit:function(){B.prototype.onInit.apply(this,arguments);var s=C.getPPMURL();this.oPPMModel=new a(s,false);this.setModel(this.oPPMModel,"ppm");},onBeforeRendering:function(e){var i=this.getObjectModel().getProperty("/ID");var I=("0000000000"+i).slice(-10);var l=this.getView().byId("ideaPPMList");var o=new sap.ui.model.Filter("IdeaID","EQ",I);l.getBinding("items").filter(o);},onExpand:function(e){var s=e.getSource();var c=s.getBindingContext("ppm");if(e.getParameter("expand")&&c){s.toggleStyleClass("sapInoPPMExpanded");var d=c.getObject();var o=d.LinkedObjectType;var P=d.LinkedEntity.split("/");var b=P[P.length-2];var f;if(b){f=this.createFragment(p[o]);f.bindElement("ppm>/"+b);}s.addContent(f);}else{s.toggleStyleClass("sapInoPPMExpanded");s.removeAllContent();}}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.RelatedIdeas.controller')){jQuery.sap.declare('sap.ino.vc.idea.RelatedIdeas.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.m.GroupHeaderListItem');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/ino/vc/idea/RelatedIdeas.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/vc/commons/BaseListController","sap/ino/commons/application/Configuration","sap/ui/Device","sap/ino/vc/idea/mixins/DuplicateActionMixin","sap/m/GroupHeaderListItem","sap/ino/commons/models/object/Idea","sap/ui/model/json/JSONModel","sap/ino/commons/formatters/ObjectListFormatter","sap/ui/model/Sorter","sap/m/Button","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(B,a,C,D,b,G,I,J,O,S,c,V,F,d,e,f){"use strict";return B.extend("sap.ino.vc.idea.RelatedIdeas",jQuery.extend({},b,V,F,d,{formatter:O,onInit:function(){B.prototype.onInit.apply(this,arguments);this._sResizeSimList=this.attachListControlResized(this.byId("idealist-similar"));this._sResizeRelList=this.attachListControlResized(this.byId("idealist-related"));this._sResizeRMerList=this.attachListControlResized(this.byId("idealist-merge"));},onExit:function(){B.prototype.onExit.apply(this,arguments);this.detachListControlResized(this._sResizeSimList);this.detachListControlResized(this._sResizeRelList);this.detachListControlResized(this._sResizeRMerList);},onBeforeRendering:function(E){var t=this;var o=this.byId("otherCampaignPanel");if(o&&o.getExpanded()){o.setExpanded(false);}var g=this.byId("currentCampaignPanel");if(g&&!g.getExpanded()){g.setExpanded(true);}var i=this.getObjectModel().getKey();var h=this.getObjectModel().getProperty("/CAMPAIGN_ID");if(i!==null){var s=new J(C.getRelatedIdeasURL(i));var j=this.byId("idealist-similar");t.bindSimilarIdeaList(j,s,f.EQ,h);var r=this.byId('idealist-related');var m=this.byId('idealist-merge');t.bindRelatedCampaignIdeaList(r,f.EQ,h);t.bindMergeIdeaList(m,f.EQ,h);}},onAfterRendering:function(){},getRelatedIdeaItemTemplate:function(){if(!this._oIdeaDupListItemTemplate){this._oIdeaDupListItemTemplate=this.getFragment("sap.ino.vc.idea.fragments.FlatListItem");var A=sap.ui.core.Fragment.byId(this.getView().getId(),"flatListIdeaActions");var o=new c({type:"Transparent",visible:this.getObjectModel().getProperty("/property/actions/update/enabled")&&!this.getModel("device").getProperty("/system/phone"),icon:"sap-icon://duplicate",tooltip:this.getModel("i18n").getProperty("IDEA_OBJECT_TIT_DUPLCATE_GENERAL"),press:this.onDuplicate.bind(this)});A.addItem(o);}return this._oIdeaDupListItemTemplate;},onItemPress:function(E){var s=E.getSource();var i=s.getBindingContext("data").getProperty("ID");if(i){this.navigateTo("idea-display",{id:i});}},onExpandOther:function(E){var t=this;var i=this.getObjectModel().getKey();var g=this.getObjectModel().getProperty("/CAMPAIGN_ID");var s=E.getSource();var o=s.getBindingContext("data");if(i!==null&&E.getParameter("expand")&&o){var h=new J(C.getRelatedIdeasURL(i));var j=this.byId("idealist-similarOther");t.bindSimilarIdeaList(j,h,f.NE,g);var r=this.byId('idealist-relatedOther');t.bindRelatedOtherCampaignIdeaList(r,f.NE,g);}},bindMergeIdeaList:function(l,o){var t=this;if(!l){jQuery.sap.log.warning("List not ready","","sap.ino.vc.idea.RelatedIdeasController.js");}else{l.bindItems({path:"data>RelatedIdeas",template:this.getRelatedIdeaItemTemplate(),filters:[new e({path:"SEMANTIC",operator:o,value1:"sap.ino.config.MERGED"})],sorter:[new S("SEMANTIC_SOURCE",false,true)],groupHeaderFactory:function(g){return new G({title:t.getText("IDEA_RELATED_"+g.key),upperCase:false}).addStyleClass("sapInoIdeasRelatedHeader");}});}},bindRelatedCampaignIdeaList:function(l,o,i){var t=this;if(!l){jQuery.sap.log.warning("List not ready","","sap.ino.vc.idea.RelatedIdeasController.js");}else{l.bindItems({path:"data>RelatedIdeas",template:this.getRelatedIdeaItemTemplate(),filters:[new e({path:"CAMPAIGN_ID",operator:o,value1:i}),new e({path:"SEMANTIC",operator:o,value1:"sap.ino.config.DUPLICATE"||"sap.ino.config.COPIED"})],sorter:[new S("SEMANTIC_SOURCE",false,true)],groupHeaderFactory:function(g){return new G({title:t.getText("IDEA_RELATED_"+g.key),upperCase:false}).addStyleClass("sapInoIdeasRelatedHeader");}});}},bindRelatedOtherCampaignIdeaList:function(l,o,i){var t=this;if(!l){jQuery.sap.log.warning("List not ready","","sap.ino.vc.idea.RelatedIdeasController.js");}else{l.bindItems({path:"data>RelatedIdeas",template:this.getRelatedIdeaItemTemplate(),filters:[new e({path:"CAMPAIGN_ID",operator:o,value1:i}),new e({path:"SEMANTIC",operator:o,value1:"sap.ino.config.MERGED"})],sorter:[new S("SEMANTIC_SOURCE",false,true)],groupHeaderFactory:function(g){return new G({title:t.getText("IDEA_RELATED_"+g.key),upperCase:false}).addStyleClass("sapInoIdeasRelatedHeader");}});}},bindSimilarIdeaList:function(l,m,o,i){var t=this;if(!l){jQuery.sap.log.warning("List not ready","","sap.ino.vc.idea.RelatedIdeasController.js");}else{l.setModel(m,"data");l.bindItems({path:"data>/",filters:new e({path:"CAMPAIGN_ID",operator:o,value1:i}),template:this.getRelatedIdeaItemTemplate(),sorter:[new S("SEMANTIC",false,true)],groupHeaderFactory:function(g){return new G({title:t.getText("IDEA_RELATED_TITLE_SIMILAR_IDEAS"),upperCase:false}).addStyleClass("sapInoIdeasRelatedHeader");}});}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.Rewards.controller')){jQuery.sap.declare('sap.ino.vc.idea.Rewards.controller');jQuery.sap.require('sap.m.GroupHeaderListItem');sap.ui.define("sap/ino/vc/idea/Rewards.controller",["sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/vc/commons/BaseController","sap/ino/vc/idea/mixins/CreateRewardActionMixin","sap/ino/vc/idea/RewardFormatter","sap/m/GroupHeaderListItem"],function(A,B,C,R,G){"use strict";var f={};f=jQuery.extend(f,R);f.formatGroupHeader=function(g){return new G({title:this.getText("REWARDS_LBL_IDEA_PHASE")+f.ideaPhase(g.ideaPhaseCode),upperCase:false});};return B.extend("sap.ino.vc.idea.Rewards",jQuery.extend({},C,{formatter:f,grouper:function(c){return{key:c.getProperty("GROUP_ORDER"),ideaPhaseCode:c.getProperty("IDEA_PHASE_CODE")};},onInit:function(){B.prototype.onInit.apply(this,arguments);this._initHandleRewardsAOChange();},onItemPress:function(e){this.getView().getController().onCreateReward(e);},_initHandleRewardsAOChange:function(){var t=this;var a=function(e){if(t&&t.getView().byId("rewardsList")){var r=function(l){if(l){var b=l.getBindingInfo("items");l.bindItems(b);}};var s=e&&e.getParameter("actionName");if(s&&["create","del","submit","modifyAndSubmit","executeStatusTransition","bulkDeleteRewards","changeAuthorStatic"].indexOf(s)>-1){var c=e.getParameter("changeRequest");if((s&&["del","submit","modifyAndSubmit","create"].indexOf(s)>-1)||c){r(t.getView().byId("rewardsList"));}}}};A.attachChange(A.Action.Create,a);A.attachChange(A.Action.Del,a);A.attachChange(A.Action.Action,a);},onEmployeePressed:function(e){e.preventDefault();var s=e.getSource();if(s){var i=s.getBindingContext("data")&&s.getBindingContext("data").getProperty("EMPLOYEE_ID");if(i!==undefined&&!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}if(this.oIdentityCardView&&this.oIdentityCardView.getController()){this.oIdentityCardView.getController().open(s,i);}}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.Volunteers.controller')){jQuery.sap.declare('sap.ino.vc.idea.Volunteers.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.m.GroupHeaderListItem');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Sorter');sap.ui.define("sap/ino/vc/idea/Volunteers.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/vc/commons/BaseListController","sap/ino/commons/application/Configuration","sap/ui/Device","sap/ino/vc/idea/mixins/DuplicateActionMixin","sap/m/GroupHeaderListItem","sap/ino/commons/models/object/Idea","sap/ui/model/json/JSONModel","sap/ino/commons/formatters/ObjectListFormatter","sap/ui/model/Sorter"],function(B,a,C,D,b,G,I,J,O,S){"use strict";var f={};jQuery.extend(f,B.prototype.formatter);f.generateMailURL=function(m){var c=this.oView.getController().createMailContent();if(c){return sap.m.URLHelper.normalizeEmail(m,c.subject,c.body);}else{return sap.m.URLHelper.normalizeEmail(m);}};return B.extend("sap.ino.vc.idea.Volunteers",{formatter:f,onBeforeRendering:function(e){var i=this.getObjectModel().getKey();if(!!i){var v=this.byId("volunteerlist");v.bindItems({path:"data>Volunteers",template:this.getItemTemplate()});}},getItemTemplate:function(){return this.getFragment("sap.ino.vc.idea.fragments.VolunteerListItem");}});});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.AddExpertFromClipboardMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.AddExpertFromClipboardMixin');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/ino/vc/idea/mixins/AddExpertFromClipboardMixin",["sap/ino/vc/idea/mixins/BaseActionMixin","sap/m/MessageToast","sap/ino/vc/commons/BaseController","sap/m/MessageBox","sap/ino/commons/models/object/User","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/commons/models/object/Idea"],function(B,M,a,b,U,F,c,I){"use strict";var A=jQuery.extend({},B);A.onAddFromClipboard=function(){var d=this.getAddFromClipboardDialog();d.open();this._bindFromClipboard();};A._bindFromClipboard=function(){var l=this.byId("AddExpertList");var t=this._getClipboardListItem();var e=this._getClipboardExpertIds();if(e.length>0){var f=this._getClipboardItemsFilter(e);l.bindAggregation("items",{path:"data>/SearchIdentity(searchToken='*')/Results",template:t,filters:f,parameters:{select:"ID,NAME,ORGANIZATION,IMAGE_ID"}});}else{l.unbindAggregation("items");}this.aSelectedExperts=[];this.getModel("view").setProperty("/CLIPBOARD_ITEM_SELECT_COUNTER",this.view.CLIPBOARD_ITEM_SELECT_COUNTER+1);};A._getClipboardListItem=function(){if(!this._oClipboardListItem){this._oClipboardListItem=this.createFragment("sap.ino.vc.idea.fragments.AddExpertFromClipboardListItem");}return this._oClipboardListItem;};A._getClipboardExpertIds=function(){var C=this._getClipboardModel();return C.getObjectKeys(U);};A._getClipboardItemsFilter=function(C){var f=[];jQuery.each(C,function(i,e){var o=new F({path:"ID",operator:c.EQ,value1:e});f.push(o);});return(f.length===0)?[]:[new F(f,false)];};A.getAddFromClipboardDialog=function(){if(!this._oAddFromClipboardDialog){this._oAddFromClipboardDialog=this.createFragment("sap.ino.vc.idea.fragments.AddExpertFromClipboard");this.getView().addDependent(this._oAddFromClipboardDialog);}return this._oAddFromClipboardDialog;};A.onAddFromClipboardDialogSelectAll=function(){var t=this;this.aSelectedExperts=[];var l=this.byId("AddExpertList");var L=l.getAggregation("items")||[];jQuery.each(L,function(i,o){var e={id:o.getBindingContext("data").getProperty("ID"),name:o.getBindingContext("data").getProperty("NAME")};t.aSelectedExperts.push(e);});this.getModel("view").setProperty("/CLIPBOARD_ITEM_SELECT_COUNTER",this.getModel("view").getProperty("/CLIPBOARD_ITEM_SELECT_COUNTER")+1);};A.onAddFromClipboardItemSelected=function(e){var C=e.getSource();var s=C.getSelected();var E=C.data("id");var m=jQuery.grep(this.aSelectedExperts,function(o){return o.id===E;});if(s&&m.length===0){var o={id:E,name:C.data("name")};this.aSelectedExperts.push(o);}else if(!s&&m.length!==0){this.aSelectedExperts=jQuery.grep(this.aSelectedExperts,function(o){return o.id!==E;});}};A.isClipboardItemEnabled=function(e,C){var i=this.isActionContextSingleIdeaDisplay()||this.getViewProperty("/IS_EVALUATION_REQUEST")?this.getObjectModel().getProperty("/Experts"):[];return jQuery.grep(i,function(o){return o.IDENTITY_ID===e;}).length===0;};A.isClipboardItemSelected=function(e,C){var i=this.isActionContextSingleIdeaDisplay()||this.getViewProperty("/IS_EVALUATION_REQUEST")?this.getObjectModel().getProperty("/Experts"):[];var E=jQuery.grep(i,function(o){return o.IDENTITY_ID===e;});if(E.length>0){return false;}var m=jQuery.grep(this.aSelectedExperts,function(o){return o.id===e;});return m.length>0;};A.onAddFromClipboardDialogCancel=function(){var d=this.getAddFromClipboardDialog();d.close();};A.onAddFromClipboardDialogOK=function(){var t=this;var e=[];jQuery.each(this.aSelectedExperts,function(i,E){if(t.getViewProperty("/IS_EVALUATION_REQUEST")){e.push({IDENTITY_ID:E.id,NAME:E.name});}else{e.push({IDENTITY_ID:E.id});}});if(e.length>0){t._addExpert(e);}var d=this.getAddFromClipboardDialog();d.close();if(this._oAssignExpertDialog){d=this._oAssignExpertDialog;d._dialog.close();d.destroy();this._oAssignExpertDialog=undefined;this.resetActionState(d.data("context")==="mass");this.restoreFocusAfterActionDialogClose();}};A._addExpert=function(e,E){var t=this;var m=this.isActionContextSingleIdeaDisplay()||this.getViewProperty("/IS_EVALUATION_REQUEST")?this.getObjectModel():I;if(this.getViewProperty("/IS_EVALUATION_REQUEST")){if(Array.isArray(e)&&e.length){jQuery.each(e,function(i,g){m.addExpert(g);});}}else{var v,s;if(this.isActionContextSingleIdeaDisplay()){v=this.getObjectModel().getKey();}else{if(this.getModel("assignment")&&this.getModel("assignment").getProperty("/IDS")){v=this.getModel("assignment").getProperty("/IDS");}else if(this.getModel("assignment")&&this.getModel("assignment").getProperty("/ID")){v=this.getModel("assignment").getProperty("/ID");}}var d=Array.isArray(v);var p={};p.Experts=e;var o={success:function(){return E?t.getText("IDEA_OBJECT_MSG_EXPERT_ASSIGNED_SUCCESS",[E]):t.getText("IDEA_OBJECT_MSG_EXPERTS_ASSIGNED_SUCCESS");},error:function(){return E?t.getText("IDEA_OBJECT_MSG_EXPERT_ASSIGNED_ERROR",[E]):t.getText("IDEA_OBJECT_MSG_EXPERTS_ASSIGNED_ERROR");}};var O={parameters:p,messages:o,staticparameters:this.isActionContextSingleIdeaDisplay()||d?undefined:v};if(d){O.parameters.keys=v;s="massAddExpert";}else{s="addExpert";}var f=a.prototype.executeObjectAction.call(this,m,s,O);return f;}};A._removeExpert=function(e,E){var t=this;var m=this.getObjectModel();if(this.getViewProperty("/IS_EVALUATION_REQUEST")){m=this.getObjectModel();m.removeExpert(e[0].IDENTITY_ID);}else{b.confirm(this.getText("MSG_DEL_CONFIRM"),{onClose:function(d){if(d!==b.Action.OK){return;}else{var p={};p.Experts=e;var o={success:function(){return t.getText("IDEA_OBJECT_MSG_EXPERT_UNASSIGNED_SUCCESS",[E]);},error:function(){return t.getText("IDEA_OBJECT_MSG_EXPERT_UNASSIGNED_ERROR",[E]);}};var O={parameters:p,messages:o,staticparameters:undefined};a.prototype.executeObjectAction.call(t,m,'removeExpert',O);}}});}};A.isActionContextSingleIdeaDisplay=function(){return!!(this.getObjectModel&&this.getObjectModel()&&this.getObjectModel().getMetadata&&this.getObjectModel().getMetadata().getName()==="sap.ino.commons.models.object.Idea");};return A;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.mixins.AssignmentActionMixin')){jQuery.sap.declare('sap.ino.vc.idea.mixins.AssignmentActionMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.m.Token');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/idea/mixins/AssignmentActionMixin",["sap/ino/vc/idea/mixins/BaseActionMixin","sap/ino/vc/commons/BaseController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Idea","sap/ino/commons/models/aof/PropertyModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/m/MessageToast","sap/ui/Device","sap/ui/core/ListItem","sap/m/Token","sap/ino/commons/models/object/User","sap/ui/core/MessageType","sap/ui/core/message/Message","sap/m/MessageBox","sap/ino/commons/application/Configuration"],function(B,a,J,I,P,F,b,S,M,D,L,T,U,c,d,f,C){"use strict";var A=jQuery.extend({},B);A._openAssignmentActionSheet=function(s,e){if(!this._oAssignActionSheet){this._oAssignActionSheet=this.createFragment("sap.ino.vc.idea.fragments.AssignmentActionSheet",this.getView().getId());this.getView().addDependent(this._oAssignActionSheet);}this._oAssignActionSheet.data("context",e||"single");jQuery.sap.delayedCall(0,this,function(){this._oAssignActionSheet.openBy(s);});};A.onMassAssignGeneral=function(e){var s=e.getSource();if(this.getModel("assignment")){this.getModel("assignment").destroy();}var m=new J();this.setModel(m,"assignment");var o=this._computeActionAggregations();var _=function(v){return!!v;};var p={actions:{assignToMe:{enabled:o.assignToMe.every(_)},assignCoach:{enabled:o.assignCoach.every(_)&&o.campaigns.length===1},unassignCoach:{enabled:o.unassignCoach.every(_)},addExpert:{enabled:o.addExpert.every(_)},assignTag:{enabled:o.assignTag.every(_)},reassignCampaign:{enabled:o.reassignCampaign.every(_)&&o.campaigns.length===1}}};m.setProperty("/property",p);m.setProperty("/IDS",o.ideas);m.setProperty("/CAMPAIGN_IDS",o.campaigns);m.setProperty("/CAMPAIGN_ID",o.campaigns[0]);m.setProperty("/RESP_VALUE_CODES",o.respValueCode);m.setProperty("/UNASSIGN_IDS",jQuery.map(this._oSelectionMap,function(i){return i.property.actions.unassignCoach.enabled?i.ID:null;}).filter(function(v){return!!v;}));m.setProperty("/ASSIGNME_IDS",jQuery.map(this._oSelectionMap,function(i){return i.property.actions.assignToMe.enabled?i.ID:null;}).filter(function(v){return!!v;}));if(this.hasOwnProperty("_CampaignId")){this.setViewProperty("/IS_CAMPAIGN_IDEA_LIST",true);}else{this.setViewProperty("/IS_CAMPAIGN_IDEA_LIST",false);}this.setViewProperty("/IS_DIALOG",true);this._openAssignmentActionSheet(s,"mass");};A.onAssignGeneral=function(e){var s=e.getSource();var t=this;this.saveCurrentFocusBeforeActionDialogOpen();if(!this.isActionContextSingleIdeaDisplay()&&this._oAssignActionSheet){}if(!this.isActionContextSingleIdeaDisplay()){if(this.getModel("assignment")){this.getModel("assignment").destroy();}this.setModel(new J(),"assignment");var i=s.getBindingContext("data").getProperty("ID");var o={actions:["assignCoach","assignToMe","unassignCoach","addExpert","assignTag","reassignCampaign"]};var p=new P("sap.ino.xs.object.idea.Idea",i,o,false,function(g){var h=g.getSource().getData();t.getModel("assignment").setProperty("/property",h);t._openAssignmentActionSheet(s,"single");});this.getModel("assignment").setData(s.getBindingContext("data").getObject());}else{this.setModel(this.getObjectModel(),"assignment");this._openAssignmentActionSheet(s,"single");}};A._executeAssignAction=function(s,i,p,m,o){var e=Array.isArray(i);var g=this.isActionContextSingleIdeaDisplay()?this.getObjectModel():I;var O={parameters:p,messages:m,staticparameters:this.isActionContextSingleIdeaDisplay()||e?undefined:i};var h=o;if(e){O.parameters.keys=i;}h.setBusy(true);var t=this;var j=a.prototype.executeObjectAction.call(this,g,s,O);j.always(function(){h.setBusy(false);}).done(function(){t.resetActionState(e);t.restoreFocusAfterActionDialogClose();if(t.bindList){t.bindList();}});return j;};A._executeAssignCoachAction=function(i,e,s,g){var t=this;var p={IDENTITY_ID:e,CAMPAIGN_ID:g};var h=Array.isArray(i)?"massAssignCoach":"assignCoach";var m={success:function(){return t.getText("IDEA_OBJECT_MSG_COACH_ASSIGNED_SUCCESS",[s]);},error:function(){return t.getText("IDEA_OBJECT_MSG_COACH_ASSIGNED_ERROR",[s]);}};return this._executeAssignAction(h,i,p,m,this._getAssignCoachDialog());};A._executeAssignExpertAction=function(i,e,E){var t=this;var p={};var s=Array.isArray(i)?"massAddExpert":"addExpert";var m={success:function(){return t.getText("IDEA_OBJECT_MSG_EXPERT_ASSIGNED_SUCCESS",[E]);},error:function(){return t.getText("IDEA_OBJECT_MSG_EXPERT_ASSIGNED_ERROR",[E]);}};p.Experts=e;return this._executeAssignAction(s,i,p,m,this._getAssignExpertDialog());};A._executeUnassignCoachAction=function(i,s,e){var t=this;var p={CAMPAIGN_ID:e};var g=Array.isArray(i);var h=g?"massUnassignCoach":"unassignCoach";var m={success:function(){return t.getText(g?"IDEA_OBJECT_MSG_COACH_UNASSIGNED_MASS_SUCCESS":"IDEA_OBJECT_MSG_COACH_UNASSIGNED_SUCCESS",[s]);},error:function(){return t.getText(g?"IDEA_OBJECT_MSG_COACH_UNASSIGNED_MASS_ERROR":"IDEA_OBJECT_MSG_COACH_UNASSIGNED_ERROR",[s]);}};return this._executeAssignAction(h,i,p,m,this._getAssignCoachDialog());};A._getAssignCoachDialog=function(){var o=this._oAssignCoachDialog;if(!o){var _=function(s){s._oList.setMode("SingleSelectLeft");s._oList.mEventRegistry.selectionChange=[];s._oDialog.setEndButton(s._getCancelButton());};o=this.createFragment("sap.ino.vc.idea.fragments.AssignCoach",this.getView().getId());this.getView().addDependent(o);this._oAssignCoachDialog=o;_(this._oAssignCoachDialog);}return o;};A._getAssignExpertDialog=function(){var t=this;var o=this._oAssignExpertDialog;if(!o){o=this.createFragment("sap.ino.vc.idea.fragments.AssignExpert",this.getView().getId());this.getView().addDependent(o);this._oAssignExpertDialog=o;o._dialog.addButton(new sap.m.Button({text:"{i18n>BTN_ADD_FROM_CLIPBOARD}",press:[t.onAddFromClipboard,t],visible:"{=!${device>/system/phone}}",enabled:{parts:[{path:'clipboard>/changed',type:null}],formatter:function(){var e=t.getModel("clipboard");return e?e.getProperty("/enabled")&&!e.isClipboardEmpty(U):false;}}}));o._dialog.addButton(o._getOkButton());o._dialog.addButton(o._getCancelButton());}return o;};A._getAssignTagDialog=function(){var o=this._oAssignTagDialog;if(!o){o=this.createFragment("sap.ino.vc.idea.fragments.AssignTag",this.getView().getId());this.getView().addDependent(o);this._oAssignTagDialog=o;}return o;};A._getReassignCampaignDialog=function(){var o=this._oReassignCampaignDialog;if(!o){o=this.createFragment("sap.ino.vc.idea.fragments.ReassignCampaign",this.getView().getId());this.getView().addDependent(o);this._oReassignCampaignDialog=o;}return o;};A._bindAssignCoachList=function(s,i,e){var o=this._getAssignCoachDialog();if(e){o.data("context",e);}o.bindAggregation("items",{path:"data>/SearchCoach(searchToken='"+jQuery.sap.encodeURL(s||'*')+"')/Results",filters:[new F({path:"CAMPAIGN_ID",operator:b.EQ,value1:i})],sorter:new S("NAME"),template:o.getBindingInfo("items").template});return o;};A._bindAssignRespCoachList=function(s,r,i,e){var o=this._getAssignCoachDialog();if(e){o.data("context",e);}o.bindAggregation("items",{path:"data>/SearchCoach(searchToken='"+jQuery.sap.encodeURL(s||'*')+"')/Results",filters:new F({filters:[new F({path:"RESP_VALUE_CODE",operator:b.EQ,value1:r}),new F({path:"CAMPAIGN_ID",operator:b.EQ,value1:i})],and:false}),sorter:new S("NAME"),factory:function(){},template:o.getBindingInfo("items").template});return o;};A.formatIdentityCardShow=function(e){var g=this.byId("assignCoachDialog").getItems();for(var i=0;i<g.length-1;i++){var o=g[i].getContent()[0].getProperty("identityId");if(o===e){return false;}}return true;};A._bindAssignExpertList=function(s,i){var o=this._getAssignExpertDialog();i=Array.isArray(i)?i:[i];o.bindAggregation("items",{path:"data>/SearchProposedExpertParams(searchToken='"+jQuery.sap.encodeURL(s||'*')+"',ideasToken='"+i.join(",")+"')/Results",sorter:new S("NAME"),template:o.getBindingInfo("items").template});return o;};A.onAssignCoachSearch=function(e){var s=e.getParameter("value")||"*";var i=this.getModel("assignment").getProperty("/CAMPAIGN_ID");var r=this.getModel("assignment").getProperty("/RESP_VALUE_CODES");if(this.getModel("assignment").getProperty("/RESP_VALUE_CODE")||(r&&r.length===1&&r[0]!==null)){var R=this.getModel("assignment").getProperty("/RESP_VALUE_CODE");if(!R){R=r[0];}this._bindAssignRespCoachList(s,R,i);}else{this._bindAssignCoachList(s,i);}};A.onAssignExpertSearch=function(e){var s=e.getParameter("value")||"*";var o=this._getAssignExpertDialog();var i;if(o.data("context")==="mass"){i=this.getModel("assignment").getProperty("/IDS");}else{i=this.getModel("assignment").getProperty("/ID");}this._bindAssignExpertList(s,i);};A.onAssignCoachDialogOK=function(e){var s=e.getParameter("selectedItem");var o=e.getSource();if(s){var g=s.getBindingContext("data");if(g){var i=g.getProperty("ID");var h=g.getProperty("NAME");var j=this.getModel("assignment").getProperty("/CAMPAIGN_ID");var v;if(o.data("context")==="mass"){v=this.getModel("assignment").getProperty("/IDS");}else{v=this.getModel("assignment").getProperty("/ID");}this._executeAssignCoachAction(v,i,h,j);}}};A.onAssignExpertDialogOK=function(e){var s=e.getParameter("selectedItems");var o=e.getSource();var g=[];var E=[];if(s.length){jQuery.each(s,function(i,h){var j=h.getBindingContext("data");if(j){var k=j.getProperty("ID");var l=j.getProperty("NAME");g.push({IDENTITY_ID:k});E.push(l);}});var v;if(o.data("context")==="mass"){v=this.getModel("assignment").getProperty("/IDS");}else{v=this.getModel("assignment").getProperty("/ID");}this._executeAssignExpertAction(v,g,E.join(","));}};A.onAssignCoach=function(e){var s=e.getSource().getParent().data("context");var i=this.getModel("assignment").getProperty("/CAMPAIGN_ID");var r=this.getModel("assignment").getProperty("/RESP_VALUE_CODES");if(this.getModel("assignment").getProperty("/RESP_VALUE_CODE")||(r&&r.length===1&&r[0]!==null)){var R=this.getModel("assignment").getProperty("/RESP_VALUE_CODE");if(!R){R=r[0];}this._bindAssignRespCoachList("*",R,i,s).open();}else{this._bindAssignCoachList("*",i,s).open();}};A.onAssignExperts=function(e){var s=e.getSource().getParent().data("context");var o=this._getAssignExpertDialog();var i;if(s){o.data("context",s);}if(s==="mass"){i=this.getModel("assignment").getProperty("/IDS");}else{i=this.getModel("assignment").getProperty("/ID");}this._bindAssignExpertList("*",i).open();};A.onassignTag=function(e){var s=e.getSource().getParent().data("context");var o=this._getAssignTagDialog();if(s){o.data("context",s);}this._INPUT_TAGS_SETTING={suggestion:{key:"ID",text:"NAME",path:"data>/SearchTagsParams(searchToken='$suggestValue')/Results",filter:[],sorter:[]},token:{key:"ID",text:"NAME"}};if(this.byId("Tags")){this.addTagMultiInputHandling(this.byId("Tags"),this._INPUT_TAGS_SETTING);}o.open();};A.addTagMultiInputHandling=function(e,s){if(!e){return;}var g=this._createSuggestHandler(s.suggestion);e.attachSuggest(g,this);e.attachTokenChange(function(E){if(!this._aIgnoreTokenChanges||this._aIgnoreTokenChanges.filter(function(o){return o.id===E.oSource.id;}).length===0){if(E.getParameter("type")==="tokensChanged"&&(E.getParameter("addedTokens").length>0||E.getParameter("removedTokens").length>0)&&s.tokenChangeCallback){s.tokenChangeCallback.apply(this,[E]);}}},this);if(s.identity){this.setMultiInputContent(e,s.identity);}};A._findFilters=function(k,g){this._INPUT_TAGS_SETTING.suggestion.filters=undefined;if(!k||k.length<=0){return;}var e=[];jQuery.each(k,function(i,K){if(g(K)){e.push(new sap.ui.model.Filter({path:"ID",operator:"NE",value1:g(K)}));}});if(e.length>0){this._INPUT_TAGS_SETTING.suggestion.filters=new sap.ui.model.Filter({filters:e,and:true});}};A.onTagValueChanged=function(e){this.resetClientMessages();var m=e.getSource();var v=e.getParameter("value");if(!v){return;}if(!e.getSource().getAggregation("tokenizer")){return;}var t=e.getSource().getAggregation("tokenizer").getAggregation("tokens");var g=v.split(",");g.forEach(function(s){s=s.trim();if(s===""){return;}var o=new T({text:s});var h;t.forEach(function(o){if(o.getProperty("text")===s){h=true;return;}});if(!h){o.bApplicationCreated=true;m.addToken(o);}});m.setValue("");};A.onTagChanged=function(e){this.resetClientMessages();var m=e.getSource();if(!e.getSource().getAggregation("tokenizer")){return;}var t=e.getSource().getAggregation("tokenizer").getAggregation("tokens");this._findFilters(t,function(o){return o.getProperty("key");});m.setValue("");};A.onReassignCampaign=function(e){var s=e.getSource().getParent().data("context");var o=this._getReassignCampaignDialog();if(s){o.data("context",s);}var m=this.getModel("assignment");m.setSizeLimit(500);var g=this.byId("reassignCampaignList");var r=this.byId("reassignCampaignRespList");this.setViewProperty("/DISPLAY_RESP_LIST",false);g.setValue("");r.setValue("");o.open();};A.onReassignCampaignDialogOK=function(){var t=this;var o=this.byId("reassignCampaignList");var r=this.byId("reassignCampaignRespList");var m=this.getModel("assignment");this.resetClientMessages();var s=o.getSelectedKey();if(this.checkReassignCampaignValidValue(o,r)){var O=this.getOldCampaignFormCode(m);var e=this.getOldCampaignAdminFormCode(m);if(O===m.getProperty("/REASSIGN_CAMPAIGN_FORM_CODE")&&e===m.getProperty("/REASSIGN_CAMPAIGN_ADMIN_FORM_CODE")){this.popConfirmMessageBox([],m,true);}else if(!m.getProperty("/REASSIGN_CAMPAIGN_FORM_CODE")&&!m.getProperty("/REASSIGN_CAMPAIGN_ADMIN_FORM_CODE")){this.popConfirmMessageBox([],m,false);}else{this.getModel("data").read("/CampaignSmall("+s+")/FormFields",{success:function(g){var h=g.results;t.getModel("data").read("/CampaignSmall("+s+")/AdminFormFields",{success:function(i){i.results.forEach(function(j){j.FORM_TYPE_CODE="ADMIN_FORM";});h=h.concat(i.results);t.popConfirmMessageBox(h,m,false);}});}});}}};A.onReassignCampaignDialogSearch=function(e){var v=jQuery.sap.encodeURL(e.getParameter("value"));var s=this.getModel("assignment").getProperty("/CAMPAIGN_ID");var m=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");var V=this.getModel("assignment");m.read("/CampaignSuggestionParams(searchToken='"+v+"',filterName='allCampaignsExceptDraft')/Results",{urlParameters:{"$orderby":"SHORT_NAME","$filter":"ID ne "+s},success:function(o){V.setProperty("/campaignSuggestion",o.results);}});};A.onReassignCampaignDialogItemsSelect=function(e){var t=this;var s=e.getParameter("selectedItem").data("ID")+"";var o=this.byId("reassignCampaignList")||this.getFilterElementById("reassignCampaignList");var g=o.getSuggestionItems();for(var i=0;i<g.length;i++){if(g[i].getProperty("key")===s){o.setSelectionItem(g[i]);t.onReassignCampaignChange();break;}}};A.getOldCampaignAdminFormCode=function(m){var o=this.getModel("data").oData;var e=this._getReassignCampaignDialog();var s=e.data("context");var r=/^IdeaMediumBackofficeSearch/igm;var g=null;if(s==="mass"){if(o){for(var i in o){if(o.hasOwnProperty(i)&&r.exec(i)&&(o[i].CAMPAIGN_ID===m.getProperty("/CAMPAIGN_ID"))){g=o[i].CAMPAIGN_ADMIN_FORM_CODE;break;}}return g;}}else{return m.getProperty("/CAMPAIGN_ADMIN_FORM_CODE");}};A.getOldCampaignFormCode=function(m){var o=this.getModel("data").oData;var e=this._getReassignCampaignDialog();var s=e.data("context");var r=/^IdeaMediumBackofficeSearch/igm;var g=null;if(s==="mass"){if(o){for(var i in o){if(o.hasOwnProperty(i)&&r.exec(i)&&(o[i].CAMPAIGN_ID===m.getProperty("/CAMPAIGN_ID"))){g=o[i].CAMPAIGN_FORM_CODE;break;}}return g;}}else{return m.getProperty("/CAMPAIGN_FORM_CODE");}};A.popConfirmMessageBox=function(e,m,s){var t=this;var o=this._getReassignCampaignDialog();var g=o.data("context");var v;if(g==="mass"){v=this.getModel("assignment").getProperty("/IDS");}else{v=this.getModel("assignment").getProperty("/ID");}var E=function(n,p){switch(n){case f.Action.OK:t._executeReassignCampaignAction(v,p,m);break;case f.Action.CANCEL:break;}t.resetActionState(g==="mass");t.restoreFocusAfterActionDialogClose();t._oReassignCampaignDialog.close();if(t.getView().sViewName==="sap.ino.vc.idea.ListPage"){t.bindList();}};if(!s){var h=[];if(e.length===0){f.confirm(this.getText("IDEA_LIST_REASSIGN_CAMPAIGN_MSG_CHG_NO_FORM_FIELD"),{actions:[f.Action.OK,f.Action.CANCEL],onClose:function(n){E(n,h);}});}else{var j;var k;for(var i=0;i<e.length;i++){if(e[i].MANDATORY){j=true;k=e[i].FORM_TYPE_CODE;break;}if(e[i].FORM_TYPE_CODE==="ADMIN_FORM"){h.push({FIELD_CODE:e[i].CODE,FORM_TYPE_CODE:"ADMIN_FORM"});}else{h.push({FIELD_CODE:e[i].CODE});}}if(j){var l=k==="ADMIN_FORM"?this.getText("IDEA_LIST_REASSIGN_CAMPAIGN_MSG_NOCHG_ADMIN_FORM_FIELD"):this.getText("IDEA_LIST_REASSIGN_CAMPAIGN_MSG_NOCHG_FORM_FIELD");f.error(l,{actions:[f.Action.OK],onClose:function(n){if(n===f.Action.OK){t.resetActionState(g==="mass");t.restoreFocusAfterActionDialogClose();t._oReassignCampaignDialog.close();}}});}else{f.confirm(this.getText("IDEA_LIST_REASSIGN_CAMPAIGN_MSG_CHG_FORM_FIELD"),{actions:[f.Action.OK,f.Action.CANCEL],onClose:function(n){E(n,h);}});}}}else{t._executeReassignCampaignAction(v,undefined,m);t.resetActionState(g==="mass");t.restoreFocusAfterActionDialogClose();t._oReassignCampaignDialog.close();if(t.getView().sViewName==="sap.ino.vc.idea.ListPage"){t.bindList();}}};A.checkReassignCampaignValidValue=function(o,r){var m=this.getModel("assignment");if(!o.getSelectedItem()){var e=new d({code:"IDEA_LIST_REASSIGN_CAMPAIGN_MSG_NO_CAMPAIGN_ID",type:c.Error});this.setClientMessage(e,o);return false;}else{if(m.getProperty("/RESP_CODE")){if(!r.getSelectedItem()){var R=new d({code:"IDEA_LIST_REASSIGN_CAMPAIGN_MSG_NO_RESPLIST_VALUE",type:c.Error});this.setClientMessage(R,r);return false;}else{return true;}}else{return true;}}};A.onReassignCampaignDialogCancel=function(){this.restoreFocusAfterActionDialogClose();this._oReassignCampaignDialog.close();};A.onReassignCampaignSuggestion=function(e){var m=this.getModel("assignment");var t=this;var s=m.getProperty("/CAMPAIGN_ID");var o=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");var E=jQuery.extend({},e,true);var g=jQuery.sap.encodeURL(E.getParameter("suggestValue"));this.resetClientMessages();o.read("/CampaignSuggestionParams(searchToken='"+g+"',filterName='allCampaignsExceptDraft')/Results",{urlParameters:{"$orderby":"SHORT_NAME","$filter":"ID ne "+s},success:function(h){m.setProperty("/campaignSuggestion",h.results);var i=t.byId("reassignCampaignList")||t.getFilterElementById("reassignCampaignList");i.setFilterSuggests(false);}});};A.onHandleReassignCampaignHelp=function(){var t=this;var v=this.getModel("assignment");var s=v.getProperty("/CAMPAIGN_ID");var m=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");m.read("/CampaignSuggestionParams(searchToken='',filterName='allCampaignsExceptDraft')/Results",{urlParameters:{"$orderby":"SHORT_NAME","$filter":"ID ne "+s},success:function(o){v.setProperty("/campaignSuggestion",o.results);var e=t.byId("reassignCampaignList")||t.getFilterElementById("reassignCampaignList");e.setFilterSuggests(false);var g=t.createReassignCampaignListDialog();g.open();}});};A.createReassignCampaignListDialog=function(){if(!this._campaignDialog){this._campaignDialog=this.createFragment("sap.ino.vc.idea.fragments.ReassignCampaignSuggestionSelectList",this.getView().getId());this.getView().addDependent(this._campaignDialog);}return this._campaignDialog;};A.onReassignCampaignChange=function(){var t=this;var m=this.getModel("assignment");var r=this.byId("reassignCampaignRespList");r.setSelectedKey();var o=this.byId("reassignCampaignList");var s=o.getSelectedKey();if(o.getSelectedItem()){this.resetClientMessages();}m.setProperty("/REASSIGN_CAMPAIGN_ID",parseInt(s,10));this.getModel("data").read("/CampaignSmall("+s+")",{success:function(e){m.setProperty("/REASSIGN_CAMPAIGN_NAME",e.NAME);m.setProperty("/REASSIGN_CAMPAIGN_FORM_CODE",e.FORM_CODE);m.setProperty("/REASSIGN_CAMPAIGN_ADMIN_FORM_CODE",e.ADMIN_FORM_CODE);if(e.RESP_CODE){t.setViewProperty("/DISPLAY_RESP_LIST",true);m.setProperty("/RESP_NAME",e.RESP_NAME);m.setProperty("/RESP_CODE",e.RESP_CODE);}else{m.setProperty("/RESP_NAME","");m.setProperty("/RESP_CODE","");t.setViewProperty("/DISPLAY_RESP_LIST",false);}},error:function(e){}});};A.onRespValueChange=function(e){if(e.getSource().getSelectedItem()){this.resetClientMessages();}};A.bindingRespListValue=function(r){var o=this.byId("reassignCampaignRespList");var m=this.getModel("assignment");var t="";var e=this;this.getModel("data").read("/ResponsibilityValueSearchParams(searchToken='"+t+"',respCode='"+r+"')/Results",{urlParameters:{"$orderby":"NAME"},success:function(g){m.setProperty("/Resp_Value",g.results);o.setFilterSuggests(false);}});};A._executeReassignCampaignAction=function(i,e,m){var t=this;var r=this.byId("reassignCampaignRespList");var s=m.getProperty("/REASSIGN_CAMPAIGN_NAME");var g=[];var h=[];if(e&&e.length>0){e.forEach(function(k){if(k.FORM_TYPE_CODE&&k.FORM_TYPE_CODE==="ADMIN_FORM"){delete k.FORM_TYPE_CODE;g.push(k);}else{h.push(k);}});}var p={CAMPAIGN_ID:m.getProperty("/REASSIGN_CAMPAIGN_ID"),FieldsValue:h,AdminFieldsValue:g,RESP_VALUE_CODE:r.getSelectedKey()};var j=Array.isArray(i)?"massReassignCampaign":"reassignCampaign";var o={success:function(){return t.getText("IDEA_OBJECT_MSG_CAMPAIGN_REASSIGNED_SUCCESS",[s]);},error:function(){return t.getText("IDEA_OBJECT_MSG_CAMPAIGN_REASSIGNED_ERROR",[s]);}};return this._executeAssignAction(j,i,p,o,this._getReassignCampaignDialog());};A.onAssignCoachDialogCancel=function(e){this.restoreFocusAfterActionDialogClose();};A.onAssignExpertDialogCancel=function(e){this.restoreFocusAfterActionDialogClose();};A.onAssignTagDialogCancel=function(e){var m=this.byId("Tags");var o=this._getAssignTagDialog();if(m){m.removeAllTokens();m.setValue("");}if(this.resetInputTypeValidations){this.resetInputTypeValidations(o);}o.close();this.restoreFocusAfterActionDialogClose();};A.onAssignTagDialogOK=function(E){var m=this.byId("Tags");var s=this._getAssignTagDialog();var i;var t=this;this.resetClientMessages();if(m){var g=m.getTokens();var n=[];if(g.length===0){var o=new d({code:"IDEA_LIST_ASSIGN_TAG_MSG_NO_TAG",type:c.Error});this.setClientMessage(o,m);}if(!this.hasAnyClientErrorMessages()){g.forEach(function(h){var j={};var k=h.getKey();try{k=parseInt(h.getKey(),10);}catch(e){}j.TAG_ID=k;j.NAME=h.getText();n.push(j);});if(s.data("context")==="mass"){i=t.getModel("assignment").getProperty("/IDS");}else{i=t.getModel("assignment").getProperty("/ID");}t._executeAssignTagAction(i,n);s.close();this.resetActionState(s.data("context")==="mass");this.restoreFocusAfterActionDialogClose();this.bindList();}}};A._executeAssignTagAction=function(i,n){var t=this;var p={};var s=Array.isArray(i)?"massAssignTag":"assignTag";var m=this.byId("Tags");var o={success:function(){m.removeAllTokens();m.setValue("");return t.getText("IDEA_OBJECT_MSG_TAG_ASSIGNED_SUCCESS");},error:function(){return t.getText("IDEA_OBJECT_MSG_TAG_ASSIGNED_ERROR");}};p.Tags=n;return this._executeAssignAction(s,i,p,o,this._getAssignTagDialog());};A.onAssignMeAsCoach=function(e){var s=e.getSource().getParent().data("context");var u=this.getModel("user");var i=u.getProperty("/data/USER_ID");var m=u.getProperty("/data/NAME");var g=this.getModel("assignment").getProperty("/CAMPAIGN_ID");var v;if(s==="mass"){v=this.getModel("assignment").getProperty("/ASSIGNME_IDS");}else{v=this.getModel("assignment").getProperty("/ID");}this._executeAssignCoachAction(v,i,m,g);};A.onUnassignCoach=function(e){var s=e.getSource().getParent().data("context");var g=this.getModel("assignment").getProperty("/COACH_NAME")||undefined;var i=this.getModel("assignment").getProperty("/CAMPAIGN_ID");var v;if(s==="mass"){v=this.getModel("assignment").getProperty("/UNASSIGN_IDS");}else{v=this.getModel("assignment").getProperty("/ID");}this._executeUnassignCoachAction(v,g,i);};A.onMassAssign=function(e){if(this.getViewProperty("/List/SELECT_ALL")){var o=this.getBindingParameter();var i=this._check4ManagingList();var s=this.getList().getBinding('items').sFilterParams;var t=this.getViewProperty("/List/TAGS");var g={};var h=[];t.forEach(function(l,m){if(!g[l.ROOTGROUPID]){g[l.ROOTGROUPID]=[];g[l.ROOTGROUPID].push(l.ID);h.push(l.ROOTGROUPID);}else{g[l.ROOTGROUPID].push(l.ID);}});var p={searchToken:o.SearchTerm||"",tagsToken:g[h[0]]?g[h[0]].join(","):"",tagsToken1:g[h[1]]?g[h[1]].join(","):"",tagsToken2:g[h[2]]?g[h[2]].join(","):"",tagsToken3:g[h[3]]?g[h[3]].join(","):"",tagsToken4:g[h[4]]?g[h[4]].join(","):"",filterName:o.VariantFilter||"",filterBackoffice:i?"1":"0",filterString:s||""};if(this.setQueryObjectIdeaformFilters){this.setQueryObjectIdeaformFilters(p);}if(this.getCampaignFormQuery){p.ideaFormId=this.getCampaignFormQuery()||"";}if(this.getSearchType){p.searchType=this.getSearchType();}if(this.setQueryObjectCompanyViewFilters){this.setQueryObjectCompanyViewFilters(p);}var j=this;var O=jQuery.extend({},e);var k=e.getSource();k.setEnabled(false);jQuery.ajax({url:C.getBackendRootURL()+"/sap/ino/xs/rest/common/select_all_ideas.xsjs",data:p,success:function(r){k.setEnabled(true);if(r.Ideas.length===0){f.show(j.getText("NO_IDEAS_AND_RELOAD_PAGE"),{icon:f.Icon.INFORMATION,actions:[sap.m.MessageBox.Action.OK],onClose:function(){j.bindList();}});return;}j._oSelectionMap={};jQuery.each(r.Ideas,function(l,m){if(!j._oDeselectionMap[m.ID]){m.property=j._createPropertyData(m);j._oSelectionMap[m.ID]=m;}});j.onMassAssignGeneral(O);},error:function(r){M.show(j.getText(r.responseJSON.messageKey));}});}else{this.onMassAssignGeneral(e);}};A.convertToHierarchy=function(o,k,p){var n=this.createStructure(o,p);var t=n.root;this.arrToHierarchy(t,n,k);return t;};A.createStructure=function(n,p){var o={root:[]};for(var i=0;i<n.length;i++){var s="Sub_"+n[i][p];if(!n[i].children||!jQuery.isArray(n[i].children)){n[i].children=[];}if(isNaN(parseInt(n[i][p],10))){o.root.push(n[i]);}else{if(!o.hasOwnProperty(s)){o[s]=[];}o[s].push(n[i]);}}return o;};A.arrToHierarchy=function(t,n,k){if(!t||t.length===0){return;}for(var i=0;i<t.length;i++){var p="Sub_"+t[i][k];if(n.hasOwnProperty(p)){t[i].children=n[p];this.arrToHierarchy(t[i].children,n,k);}}};A.onRespListSuggestion=function(e){var t=this;var m=this.getModel("assignment");var E=jQuery.extend({},e,true);var s=jQuery.sap.encodeURL(E.getParameter("suggestValue"));this.resetClientMessages();this.getModel("data").read("/ResponsibilityValueSearchParams(searchToken='"+s+"',respCode='"+m.getProperty("/RESP_CODE")+"')/Results",{urlParameters:{"$orderby":"NAME"},success:function(o){m.setProperty("/Resp_Value",o.results);t.byId("reassignCampaignRespList").setFilterSuggests(false);}});};A.createRespListHierarchyDialog=function(){if(!this._oRespListTreeDialog){this._oRespListTreeDialog=this.createFragment("sap.ino.vc.idea.fragments.ReassignCampaignResponsibilityListValue",this.getView().getId());this.getView().addDependent(this._oRespListTreeDialog);}return this._oRespListTreeDialog;};A.onHandleRespListValueHelp=function(e){var t=this;var r=t.createRespListHierarchyDialog();r.open();r.setBusy(true);var o=t.byId('respValueTreeTable');var R=t.byId('reassignCampaignRespList');var m=this.getModel("assignment");this.getModel("data").read("/ResponsibilityValueSearchParams(searchToken='',respCode='"+m.getProperty("/RESP_CODE")+"')/Results",{urlParameters:{"$orderby":"NAME"},success:function(g){r.setBusy(false);m.setProperty("/Resp_Value",g.results);var h=t.convertToHierarchy(g.results,"ID","PARENT_VALUE_ID");m.setProperty("/Resp_Value_Tree",h);t.setViewProperty("/ENABLE_OK_BTN",false);t.resetClientMessages();t.byId('reassignCampaignRespList')._closeSuggestionPopup();o.attachBrowserEvent("dblclick",function(){if(o.isIndexSelected(t._treeTableIndex)){o.removeSelectionInterval(t._treeTableIndex,t._treeTableIndex);}else{o.addSelectionInterval(t._treeTableIndex,t._treeTableIndex);}if(t._treeTableIndex>-1){var s=o.getContextByIndex(t._treeTableIndex).getPath();R.setSelectedKey(m.getProperty(s+"/CODE"));R.setValue(m.getProperty(s+"/NAME"));if(t._oRespListTreeDialog){t._oRespListTreeDialog.close();t._oRespListTreeDialog.destroy();t._oRespListTreeDialog=undefined;}}t._treeTableIndex=-1;});},error:function(g){m.setProperty("/Resp_Value_Tree",[]);r.setBusy(false);M.show(g.message);}});};A.onRespValueDialogClose=function(){if(this._oRespListTreeDialog){this._oRespListTreeDialog.close();this._oRespListTreeDialog.destroy();this._oRespListTreeDialog=undefined;}};A.onSelectedItem=function(e){var t=this;var m=this.getModel("assignment");var r=t.byId("respValueTreeTable");var R=t.byId('reassignCampaignRespList');var i=r.getSelectedIndex();if(i>-1){var s=r.getContextByIndex(i).getPath();R.setSelectedKey(m.getProperty(s+"/CODE"));R.setValue(m.getProperty(s+"/NAME"));}if(this._oRespListTreeDialog){this._oRespListTreeDialog.close();this._oRespListTreeDialog.destroy();this._oRespListTreeDialog=undefined;}};A.onRespRowSelectionChange=function(e){var t=this;var r=t.byId("respValueTreeTable");var i=r.getSelectedIndex();if(i>-1){this.setViewProperty("/ENABLE_OK_BTN",true);this._treeTableIndex=i;}else{this.setViewProperty("/ENABLE_OK_BTN",false);}};return A;});};if(!jQuery.sap.isDeclared('sap.ino.vc.internal.InternalNote.controller')){jQuery.sap.declare('sap.ino.vc.internal.InternalNote.controller');jQuery.sap.require('sap.ui.core.mvc.ViewType');sap.ui.define("sap/ino/vc/internal/InternalNote.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ui/core/mvc/ViewType","sap/ino/vc/comment/CommentMixin"],function(C,V,a){"use strict";return C.extend("sap.ino.vc.internal.InternalNote",jQuery.extend({},a,{onInit:function(){C.prototype.onInit.apply(this,arguments);},onBeforeRendering:function(e){this.commentMixinInit({commentInputId:"internalNoteInputField",commentListId:"internalNoteList",successMessageKey:"MSG_CREATE_SUCCESS_NOTE",editDialogViewName:"sap.ino.vc.internal.EditInternalNoteDialog"});}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.internal.InternalSection.controller')){sap.ui.getCore().loadLibrary("sap.ino.wall");jQuery.sap.declare('sap.ino.vc.internal.InternalSection.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ino.vc.wall.WallMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.message.Message');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.ComboBox');jQuery.sap.require('sap.ui.model.type.String');jQuery.sap.require('sap.ui.model.odata.type.Date');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.core.ListItem');sap.ui.define("sap/ino/vc/internal/InternalSection.controller",["sap/ino/vc/commons/BaseVariantListController","sap/ui/Device","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/wall/WallMixin","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Attachment","sap/ino/commons/application/Configuration","sap/m/MessageToast","sap/ino/vc/attachment/AttachmentMixin","sap/ino/vc/comment/RichCommentCntrlMixin","sap/ino/vc/comment/RichCommentMixin","sap/ino/vc/comment/RichCommentAttachmentMixin","sap/ui/core/MessageType","sap/ui/core/message/Message","sap/m/Label","sap/m/CheckBox","sap/m/Input","sap/m/ComboBox","sap/ino/commons/models/core/CodeModel","sap/ui/model/type/String","sap/ino/commons/models/types/IntegerType","sap/ino/commons/models/types/FloatType","sap/ui/model/odata/type/Date","sap/ino/commons/models/types/IntegerNullableType","sap/ino/commons/models/types/FloatNullableType","sap/ino/commons/models/types/IntNullableBooleanType","sap/ino/commons/models/types/IntBooleanType","sap/ui/model/Sorter","sap/ui/core/ListItem","sap/ino/vc/commons/mixins/RichTextInitMixin"],function(B,D,O,W,J,A,C,M,a,R,b,c,d,e,L,f,I,g,h,S,j,F,k,l,m,n,o,p,q,r){"use strict";var v={MY:"my",SHARED:"shared"};var s={NONE:"myWalls",MY:"myWalls",SHARED:"sharedWalls"};var t={BOOLEAN:"BOOL_VALUE",TEXT:"TEXT_VALUE",INTEGER:"NUM_VALUE",NUMERIC:"NUM_VALUE",RICHTEXT:"RICH_TEXT_VALUE",DATE:"DATE_VALUE"};var u=A.getEndpointURL();return B.extend("sap.ino.vc.internal.InternalSection",jQuery.extend({},W,a,R,b,c,r,{routes:"idea-display",sectionName:"sectionInternal",list:{"Variants":{},"Picker":{"Variants":{"Values":[{"TEXT":"WALL_LIST_MIT_MY","ACTION":v.MY,"FILTER":s.MY},{"TEXT":"WALL_LIST_MIT_SHARED","ACTION":v.SHARED,"FILTER":s.SHARED}]}}},view:{"Picker":{"VARIANT":undefined},"EDITABLE":undefined},formatter:O,objectListFormatter:O,onInit:function(){var i=this;i._wallMixinInit({wallId:"interalwalllistinidea",wallBindPath:"object>/InternalWalls",wallAddAction:function(x,y){x.addInternalWall(y);},wallRemoveAction:function(x,y){x.removeInternalWall(y.getStorageId());x.update();},wallData:function(x){return x.getProperty("/InternalWalls");}});i.getList().addStyleClass("sapInoWallListPreviewItems");B.prototype.onInit.apply(this,arguments);if(!i.getModel("local")){i.setModel(new J({ATTACHMENT_UPLOAD_URL:u}),"local");}this.getView().setModel(null,"comment");var w=jQuery.extend(true,{},this.defaultRichCommentSetting);w.commentInputId="internalNoteInputField";w.commentListId="internalNoteList";w.commentContainerId="rteInternalContainer";w.commentInputId="rteInternalCtrlInput";w.delReplyConfirmMsgKey="MSG_INTERNALNOTE_REPLY_DEL_CONFIRM";w.delAllDataComfirmMsgKey="MSG_INTERNALNOTE_DELETE_ALL_DATA_CONFIRM";w.delSuccessfulMsgKey="MSG_INTERNALNOTE_DEL_SUCCESS";w.delBtnKey="INTERNALNOTE_OBJECT_BTN_DELETE_INTERNALNOTE";w.delBtnAllDataKey="INTERNALNOTE_OBJECT_BTN_DELETE_ALL_DATA";w.type="internal";this.richCommentMixinInitRouterEvent(w);},onRouteMatched:function(E){B.prototype.onRouteMatched.apply(this,arguments);},onBeforeRendering:function(){this.view.EDITABLE=true;var V=this.getModel("view");V.setData(this.view,true);this._bindList();var i=this.getList().getBinding("items");if(i){this._updateWallPreviewControls();}},onAfterRendering:function(){this.getAdminFormFields();this.richCommentMixinInit();this.richAttachmentMixinInit();this._attachmentMixinInit({attachmentId:"InternalAttachments",updateObject:function(i){i.update();},uploadSuccess:function(i,w){i.addInternalAttachment({"CREATED_BY_NAME":C.getCurrentUser().NAME,"ATTACHMENT_ID":w.attachmentId,"FILE_NAME":w.fileName,"MEDIA_TYPE":w.mediaType,"CREATED_AT":new Date()});i.update().fail(function(){i.getMessageParser().parse(w);M.show(this.getText("OBJECT_MSG_ATTACHMENT_FAILED"));return true;});}});this.setAccessibilityProperty();},getAdminFormFields:function(){var i=this.getModel("object");var w=this.byId("vBoxForDisplayAdminFields");if(this.getModel("editObject")&&typeof(this.getModel("editObject").getProperty("/ID"))==="number"&&(this.getModel("object").getProperty("/ID")!==this.getModel("editObject").getProperty("/ID"))){this.visibleSettingForAdminField();this.getModel("editObject").setData(null);}var x=this;this.bIsNew=true;if(!i.oData.AdminFieldsValue){i.getDataInitializedPromise().done(function(y){if(i.oData.AdminFieldsValue.length>0){x.bIsNew=false;}if(x.bIsNew){x.getModel("data").read("/CampaignSmall("+i.oData.CAMPAIGN_ID+")/AdminFormFields",{urlParameters:{"$orderby":"SEQUENCE_NO"},success:function(z){var E=z.results;if(E.length===0){x.byId("vBoxForAdminContentVisible").setVisible(false);}else{x.byId("vBoxForAdminContentVisible").setVisible(true);x.byId("nameOfAdminForm").setText(E[0].FORM_DEFAULT_TEXT);x.addDisplayFormFields(w,i);x.setModel(new sap.ui.model.json.JSONModel(),"AdminForm");x.getModel("AdminForm").setProperty("/CampaignAdminForm",E);}},error:function(z){M.show(z.message);}});}});}else{if(i.oData.AdminFieldsValue.length>0){x.bIsNew=false;x.getModel("data").read("/CampaignSmall("+i.oData.CAMPAIGN_ID+")/AdminFormFields",{urlParameters:{"$orderby":"SEQUENCE_NO"},success:function(y){var z=y.results;x.setModel(new sap.ui.model.json.JSONModel(),"AdminForm");x.getModel("AdminForm").setProperty("/CampaignAdminForm",z);},error:function(y){M.show(y.message);}});x.byId("vBoxForAdminContentVisible").setVisible(true);x.addDisplayFormFields(w,i);}else{x.getModel("data").read("/CampaignSmall("+i.oData.CAMPAIGN_ID+")/AdminFormFields",{urlParameters:{"$orderby":"SEQUENCE_NO"},success:function(y){var z=y.results;if(z.length===0){x.byId("vBoxForAdminContentVisible").setVisible(false);}else{x.byId("vBoxForAdminContentVisible").setVisible(true);x.byId("nameOfAdminForm").setText(z[0].FORM_DEFAULT_TEXT);x.addDisplayFormFields(w,i);x.setModel(new sap.ui.model.json.JSONModel(),"AdminForm");x.getModel("AdminForm").setProperty("/CampaignAdminForm",z);}},error:function(y){M.show(y.message);}});}}},getVariantsPopover:function(){if(!this._getWallPickerDialog().isActive()){return B.prototype.getVariantsPopover.apply(this,arguments);}else{if(!this._oPickerVariantPopover){this._oPickerVariantPopover=sap.ui.xmlfragment("sap.ino.vc.wall.fragments.PickerListVariants",this);this.getView().addDependent(this._oPickerVariantPopover);}return this._oPickerVariantPopover;}},getVariant:function(i){if(!this._getWallPickerDialog().isActive()){return B.prototype.getVariant.apply(this,arguments);}else{return this._getListDefinitionEntry(i,"ACTION","/Picker/Variants/Values");}},onVariantPress:function(V,E){this.setViewProperty("/Picker/VARIANT",V);var w=this._getWallPickerView();if(w){w.getController().setViewProperty("/List/VARIANT",V);w.invalidate();}},_onVariantPress:function(E){var i=E.getSource();var w=i.getBindingContext("list");var x;var y;if(w){y=w.getObject();x=y?y.ACTION:undefined;}this.onVariantPress(x,E);var P=this.getVariantsPopover();if(typeof P.close==="function"){P.close();}},onWallPicked:function(w){this._bindList();var i=this.getList().getBinding("items");var x=this.getModel("object");if(i){var y=this;x.update().done(function(){y._updateWallPreviewControls();});}},onSaveWithPub:function(E){var i=this;jQuery.each(i.aCheckBoxes,function(Q,T){T.fireSelect();});if(!this.hasAnyClientErrorMessages()){var U=[];var w={};var x={};var y;var z=this.getModel("object");var G=this.byId("vBoxForDisplayAdminFields");var H=C.getBackendRootURL()+"/sap/ino/xs/rest/common/idea.xsjs/"+this.getModel("object").getProperty("/ID");var K=jQuery.extend(true,[],this.getModel("editObject").getProperty("/AdminFieldsValue"));K.forEach(function(Q){y=t[Q.DATATYPE_CODE];x[y]=Q[y];x.ID=Q.ID;x.FIELD_CODE=Q.FIELD_CODE;x.RICH_TEXT_VALUE=Q.RICH_TEXT_VALUE;if(Q.IS_PUBLISH===1){x.STATE_OF_PUBLISH=1;Q.STATE_OF_PUBLISH=1;}else{x.STATE_OF_PUBLISH=0;Q.STATE_OF_PUBLISH=0;}U.push(x);x={};});w.AdminFieldsValue=U;w.ID=this.getModel("object").getProperty("/ID");var N=this;var P=jQuery.ajax({url:H,data:JSON.stringify(w),type:"PUT",contentType:"application/json; charset=UTF-8",async:true,success:function(Q){if(Q.GENERATED_IDS&&Q.GENERATED_IDS!==null){jQuery.each(K,function(V,X){X.ID=Q.GENERATED_IDS[X.ID]?Q.GENERATED_IDS[X.ID]:X.ID;});}M.show(N.getText("OBJECT_MSG_ADMIN_FORM_SAVE_AS_PULISH_SUCCESS"));N.getModel("object").setProperty("/AdminFieldsValue",K);N.getModel("editObject").setData(null);N.addDisplayFormFields(G,z);N.visibleSettingForAdminField();var T=N.byId("vBoxForAdminFields");T.removeAllItems();return true;},error:function(Q){var T;T=Q.responseText;M.show(T?T:N.getText("OBJECT_MSG_ADMIN_FORM_SAVE_FAILED"));return true;}});}else{M.show(this.getText("MSG_SAVE_USER_ERROR"));}},visibleSettingForAdminField:function(){var i=this.byId("vBoxForAdminFields").getVisible();this.byId("vBoxForAdminFields").setVisible(!i);this.byId("vBoxForDisplayAdminFields").setVisible(i);this.byId("overToolbarAdminButtons").setVisible(!i);this.byId("editButtonForAdminFields").setEnabled(i);},onEditButtonForAdminFields:function(E){var i=this.byId("vBoxForAdminFields");var w=this.getModel("object");var x;if(this.getModel("editObject")&&(this.getModel("object").getProperty("/ID")===this.getModel("editObject").getProperty("/ID"))){x=this.getModel("editObject");}else{if(this.getModel("editObject")){x=this.getModel("editObject");x=undefined;}var N={};N=jQuery.extend(true,[],w.getProperty("/AdminFieldsValue"));this.setModel(new sap.ui.model.json.JSONModel(),"editObject");x=this.getModel("editObject");x.setProperty("/AdminFieldsValue",N);x.setProperty("/ID",this.getModel("object").getProperty("/ID"));}var y=w.oData.AdminFieldsValue;var z=this.getModel("AdminForm").getProperty("/CampaignAdminForm");var G;if(y&&y.length>0&&z&&z.length>0&&y[0].FORM_CODE===z[0].FORM_CODE){G=w.oData.AdminFieldsValue;var H=this.cacluateNewFieldsAdded(z,y);if(H&&H.length>0){G=G.concat(H);x.setProperty("/AdminFieldsValue",G);G.sort(function(K,P){if(K.SEQUENCE_NO<P.SEQUENCE_NO){return-1;}else{return 1;}});}}else{G=w.oData.AdminFieldsValue.length>0?w.oData.AdminFieldsValue:this.getModel("AdminForm").getProperty("/CampaignAdminForm");}this.addFormFields.call(this,G,i,x);this.visibleSettingForAdminField();},cacluateNewFieldsAdded:function(w,x){var N=[];var y=function(E,G){return E.filter(function(V){return V.CODE===G;});};for(var i=0;i<w.length;i++){var z=y(x,w[i].CODE);if(z.length===0&&w[i].IS_ACTIVE){N.push(w[i]);}}return N;},onAdminFormEditCancel:function(){var i=this;if(i.aCheckBoxes){i.aCheckBoxes=[];}var w=this.byId("vBoxForAdminFields");w.removeAllItems();this.visibleSettingForAdminField();this.resetClientMessages();this.getModel("editObject").setData(null);},onSaveWithoutPub:function(E){var i=this;jQuery.each(i.aCheckBoxes,function(Q,T){T.fireSelect();});if(!this.hasAnyClientErrorMessages()){var U=[];var w={};var x={};var y;var z=this.getModel("object");var G=this.byId("vBoxForDisplayAdminFields");var H=C.getBackendRootURL()+"/sap/ino/xs/rest/common/idea.xsjs/"+this.getModel("object").getProperty("/ID")+"/updateAdminForms";var K=jQuery.extend(true,[],this.getModel("editObject").getProperty("/AdminFieldsValue"));K.forEach(function(Q){y=t[Q.DATATYPE_CODE];x[y]=Q[y];x.ID=Q.ID;x.FIELD_CODE=Q.FIELD_CODE;x.RICH_TEXT_VALUE=Q.RICH_TEXT_VALUE;x.STATE_OF_PUBLISH=0;Q.STATE_OF_PUBLISH=0;U.push(x);x={};});w.AdminFieldsValue=U;w.ID=this.getModel("object").getProperty("/ID");var N=this;var P=jQuery.ajax({url:H,data:JSON.stringify(w),type:"POST",contentType:"application/json; charset=UTF-8",async:true,success:function(Q){if(Q.GENERATED_IDS&&Q.GENERATED_IDS!==null){jQuery.each(K,function(V,X){X.ID=Q.GENERATED_IDS[X.ID]?Q.GENERATED_IDS[X.ID]:X.ID;});}M.show(N.getText("OBJECT_MSG_ADMIN_FORM_SAVE_SUCCESS"));N.getModel("object").setProperty("/AdminFieldsValue",K);N.getModel("editObject").setData(null);N.addDisplayFormFields(G,z);N.visibleSettingForAdminField();var T=N.byId("vBoxForAdminFields");T.removeAllItems();return true;},error:function(Q){M.show(N.getText("OBJECT_MSG_ADMIN_FORM_SAVE_FAILED"));return true;}});}else{M.show(this.getText("MSG_SAVE_USER_ERROR"));}},addDisplayFormFields:function(w,x){var y=this;if(w.getItems().length>0){w.removeAllItems();}jQuery.each(x.oData.AdminFieldsValue,function(i,z){var E=z.DEFAULT_TEXT+":";if(z.IS_DISPLAY_ONLY){var G=new sap.ui.core.HTML({sanitizeContent:true,preferDOM:false,content:z.DISPLAY_TEXT});w.addItem(G);return true;}if(z.IS_PUBLISH&&z.STATE_OF_PUBLISH===1){E=z.DEFAULT_TEXT+y.getText("OBJECT_MSG_ADMIN_FORM_FIELD_CAN_PUBLISH")+":";}else if(z.IS_PUBLISH){E=z.DEFAULT_TEXT+y.getText("OBJECT_MSG_ADMIN_FORM_FIELD_CANNOT_PUBLISH")+":";}if(z.UOM_CODE){E=z.DEFAULT_TEXT+"("+h.getText("sap.ino.xs.object.basis.Unit.Root",z.UOM_CODE)+"):";}var H=new L({text:E,tooltip:z.DEFAULT_LONG_TEXT});H.addStyleClass("sapInoIdeaFormLabelStyle");var K;if(z.DATATYPE_CODE==="BOOLEAN"){K="BOOL_VALUE";}else if(z.DATATYPE_CODE==="TEXT"){K="TEXT_VALUE";}else if(z.DATATYPE_CODE==="RICHTEXT"){K="RICH_TEXT_VALUE";}else if(z.DATATYPE_CODE==="DATE"){K="DATE_VALUE";}else{K="NUM_VALUE";}var T=z[K];var N=z.valueOptionList;if(!N){if(z.VALUE_OPTION_LIST_CODE){var P="sap.ino.xs.object.basis.ValueOptionList.Root_"+z.VALUE_OPTION_LIST_CODE;N=h.getCodes(P);}}if(!!N&&N.length>0&&T!==undefined&&T!==null&&T!==""){jQuery.each(N,function($,_){if(_.CODE.toString()===T.toString()){T=_.DEFAULT_TEXT;return;}});}var Q=z.DEFAULT_TEXT;if(z.IS_PUBLISH&&z.STATE_OF_PUBLISH===1){Q=z.DEFAULT_TEXT+y.getText("OBJECT_MSG_ADMIN_FORM_FIELD_CAN_PUBLISH");}else if(z.IS_PUBLISH){Q=z.DEFAULT_TEXT+y.getText("OBJECT_MSG_ADMIN_FORM_FIELD_CANNOT_PUBLISH");}if(z.DATATYPE_CODE==="BOOLEAN"&&(!N||N.length===0)){var U=false;if(z[K]){U=true;}var V=new f({text:Q,selected:U,editable:false,tooltip:z.DEFAULT_LONG_TEXT});var X=V._getLabel();X.addStyleClass("sapInoIdeaFormLabelStyle");V.addStyleClass("sapInoIdeaFormChxBoxHeight");w.addItem(V);}else{var Y;if(z.DATATYPE_CODE==="NUMERIC"&&!!T&&(!N||N.length===0)){var Z=sap.ui.core.format.NumberFormat.getFloatInstance({groupingEnabled:true,groupingSeparator:","});Y=new sap.m.Text();Y.setText(Z.format(T));}else if(z.DATATYPE_CODE==="RICHTEXT"&&!!T&&(!N||N.length===0)){Y=new sap.ui.core.HTML({sanitizeContent:true,preferDOM:false});Y.setContent(T);}else if(z.DATATYPE_CODE==="DATE"&&!!T&&(!N||N.length===0)){Y=new sap.m.Text();Y.setText(y.formatter.toDate(T));}else{Y=new sap.m.Text();Y.setText(T);}w.addItem(H);w.addItem(Y);}});},addFormFields:function(i,w,x,y){if(w.getItems().length>0){w.removeAllItems();}var z=this;if(z.aCheckBoxes){z.aCheckBoxes=[];}if(z.aComboBoxes){z.aComboBoxes=[];}var G=function(N){var T;switch(N.DATATYPE_CODE){case"BOOLEAN":T=!N.VALUE_OPTION_LIST_CODE?new n(null):new sap.ino.commons.models.types.IntegerType();break;case"INTEGER":if(N.MANDATORY){T=new j(null,{minimum:(N.NUM_VALUE_MIN||undefined),maximum:(N.NUM_VALUE_MAX||undefined)});}else{T=new l(null,{minimum:(N.NUM_VALUE_MIN||undefined),maximum:(N.NUM_VALUE_MAX||undefined)});}break;case"NUMERIC":if(N.MANDATORY){T=new F({groupingEnabled:false},{minimum:(N.NUM_VALUE_MIN||undefined),maximum:(N.NUM_VALUE_MAX||undefined)});}else{T=new m({groupingEnabled:false},{minimum:(N.NUM_VALUE_MIN||undefined),maximum:(N.NUM_VALUE_MAX||undefined)});}break;case"TEXT":T=new S(null,{minLength:(N.MANDATORY?1:undefined)});break;case"RICHTEXT":T=new S(null,{minLength:(N.MANDATORY?1:undefined)});break;case"DATE":T=new k(null,{minimum:(N.MANDATORY?1:0)});break;default:break;}return T;};var E=function(N){var V=N.getParameters().value;var P=N.getSource();var Q=P.getItemByText(V);if(Q===null){var T=new e({code:"IDEA_FORM_MSG_DROPDOWN_LIST",type:d.Error});this.oIdeaFormMessage=T;z.setClientMessage(T,this);}else{z.resetClientMessages();}};var H=function(N){var P=N.getSource();var V=P.getValue();var Q=P.getItemByText(V);if(V&&!Q){z.setClientMessage(new e({code:"IDEA_FORM_MSG_DROPDOWN_LIST",type:d.Error}),this);}else{z.resetClientMessages();}};var K=function(N){if(!this.getSelected()){this.setValueState('Error');z.setClientMessage(new e({code:"IDEA_OBJECT_MSG_CHECK_BOX_UNTICK",type:d.Error}),this);}else{z.resetClientMessages();this.setValueState('None');}};var z=this;i=i.filter(function(N){if(!N.ID){return N.IS_ACTIVE===1;}return true;});jQuery.each(i,function(N,P){if(!P.IS_ACTIVE){return true;}var Q;if(!P.ID){Q=jQuery.extend({ID:z.getModel("object").getNextHandle(),FIELD_CODE:P.CODE},P);z.getModel("editObject").setProperty("/AdminFieldsValue/"+N,Q);}else{Q=z.getModel("editObject").getProperty("/AdminFieldsValue/"+N);}if(P.IS_DISPLAY_ONLY){var T=new sap.ui.core.HTML({sanitizeContent:true,preferDOM:false,content:{model:"editObject",path:"/AdminFieldsValue/"+N+"/DISPLAY_TEXT",formatter:z.formatter.wrapHTML}});w.addItem(T);return true;}var U;if(P.UOM_CODE){U=P.DEFAULT_TEXT+"("+h.getText("sap.ino.xs.object.basis.Unit.Root",P.UOM_CODE)+")";}else{U=P.DEFAULT_TEXT;}if(P.IS_PUBLISH&&P.STATE_OF_PUBLISH){U=U+z.getText("OBJECT_MSG_ADMIN_FORM_FIELD_CAN_PUBLISH");}else if(P.IS_PUBLISH){U=U+z.getText("OBJECT_MSG_ADMIN_FORM_FIELD_CANNOT_PUBLISH");}else{U=U;}var V=false;if(P.MANDATORY===1){V=true;}var X;X=t[P.DATATYPE_CODE];if(P.VALUE_OPTION_LIST_CODE){var Y=new L({text:U,tooltip:P.DEFAULT_LONG_TEXT,required:V});Y.addStyleClass("sapInoIdeaFormLabelStyle");w.addItem(Y);var Z="sap.ino.xs.object.basis.ValueOptionList.Root_"+P.VALUE_OPTION_LIST_CODE;Q.valueOptionList=h.getCodes(Z,function(k1){return k1.ACTIVE===1;});var $="editObject>/AdminFieldsValue/"+N+"/"+X;var _={path:$,type:G(P)};var a1=new g({tooltip:P.DEFAULT_LONG_TEXT,selectedKey:_,width:"100%",change:P.MANDATORY?E:H});a1.addItem();var b1="{editObject>"+X+"}";var c1=new q({key:b1,text:"{editObject>DEFAULT_TEXT}"});var d1="editObject>/AdminFieldsValue/"+N+"/valueOptionList";a1.bindItems({path:d1,template:c1,sorter:new p("SEQUENCE_NO")});if(!z.aComboBoxes){z.aComboBoxes=[];}z.aComboBoxes.push(a1);w.addItem(a1);}else{if(P.DATATYPE_CODE==="BOOLEAN"){if(!z.aCheckBoxes){z.aCheckBoxes=[];}var e1;if(P.IS_PUBLISH&&P.STATE_OF_PUBLISH){e1=P.DEFAULT_TEXT+z.getText("OBJECT_MSG_ADMIN_FORM_FIELD_CAN_PUBLISH");}else if(P.IS_PUBLISH){e1=P.DEFAULT_TEXT+z.getText("OBJECT_MSG_ADMIN_FORM_FIELD_CANNOT_PUBLISH");}else{e1=P.DEFAULT_TEXT;}var f1=new f({text:e1,enabled:true,tooltip:P.DEFAULT_LONG_TEXT,selected:{path:"editObject>/AdminFieldsValue/"+N+"/BOOL_VALUE",type:'sap.ino.commons.models.types.IntBooleanType'},select:V?K:function(){}});var g1=f1._getLabel();if(V){g1.addStyleClass("sapMLabelRequired");z.aCheckBoxes.push(f1);}g1.addStyleClass("sapInoIdeaFormLabelStyle");f1.addStyleClass("sapInoIdeaFormChxBoxHeight");w.addItem(f1);}else{var h1;var i1=new L({text:U,tooltip:P.DEFAULT_LONG_TEXT,required:V});i1.addStyleClass("sapInoIdeaFormLabelStyle");w.addItem(i1);var j1={path:"editObject>/AdminFieldsValue/"+N+"/"+X,type:G(P)};if(P.DATATYPE_CODE==="RICHTEXT"){h1=sap.ui.xmlfragment({id:z.getView().getId(),fragmentName:"sap.ino.vc.idea.fragments.IdeaRichTxt"},z);h1.attachReady(function(){this.bindProperty("value",{path:j1.path,type:G(P)});});}else if(P.DATATYPE_CODE==="DATE"){h1=new sap.m.DatePicker({tooltip:P.DEFAULT_LONG_TEXT,value:{path:j1.path,type:G(P)},width:"100%"});}else{h1=new I({tooltip:P.DEFAULT_LONG_TEXT,value:j1,width:"100%"});}if(h1.addAriaLabelledBy){h1.addAriaLabelledBy(i1);}h1.addStyleClass("sapUiSmallMarginBottom");w.addItem(h1);}}});this._bEditAdminFormContorl=true;}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.internal.InternalWall.controller')){sap.ui.getCore().loadLibrary("sap.ino.wall");jQuery.sap.declare('sap.ino.vc.internal.InternalWall.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ino.vc.wall.WallMixin');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/internal/InternalWall.controller",["sap/ino/vc/commons/BaseVariantListController","sap/ui/Device","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/wall/WallMixin","sap/ino/vc/attachment/AttachmentMixin","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Attachment","sap/ino/commons/application/Configuration","sap/m/MessageToast"],function(B,D,O,W,A,J,a,C,M){"use strict";var v={MY:"my",SHARED:"shared"};var f={NONE:"myWalls",MY:"myWalls",SHARED:"sharedWalls"};var b=a.getEndpointURL();return B.extend("sap.ino.vc.internal.InternalWall",jQuery.extend({},W,{routes:[],list:{"Variants":{},"Picker":{"Variants":{"Values":[{"TEXT":"WALL_LIST_MIT_MY","ACTION":v.MY,"FILTER":f.MY},{"TEXT":"WALL_LIST_MIT_SHARED","ACTION":v.SHARED,"FILTER":f.SHARED}]}}},view:{"Picker":{"VARIANT":undefined},"EDITABLE":undefined},formatter:O,objectListFormatter:O,onInit:function(){var t=this;this._wallMixinInit({wallId:"interalwalllistinidea",wallBindPath:"object>/InternalWalls",wallAddAction:function(o,w){o.addInternalWall(w);},wallRemoveAction:function(o,w){o.removeInternalWall(w.getStorageId());o.update();},wallData:function(o){return o.getProperty("/InternalWalls");}});this.getList().addStyleClass("sapInoWallListPreviewItems");B.prototype.onInit.apply(this,arguments);if(!this.getModel("local")){this.setModel(new J({ATTACHMENT_UPLOAD_URL:b}),"local");}},onBeforeRendering:function(){this.view.EDITABLE=true;var V=this.getModel("view");V.setData(this.view,true);this._bindList();var o=this.getList().getBinding("items");if(o){this._updateWallPreviewControls();}},onAfterRendering:function(){this._attachmentMixinInit({attachmentId:"InternalAttachments",updateObject:function(o){o.update();},uploadSuccess:function(o,r){o.addInternalAttachment({"CREATED_BY_NAME":C.getCurrentUser().NAME,"ATTACHMENT_ID":r.attachmentId,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType,"CREATED_AT":new Date()});o.update().fail(function(){o.getMessageParser().parse(r);M.show(this.getText("OBJECT_MSG_ATTACHMENT_FAILED"));return true;});}});},getVariantsPopover:function(){if(!this._getWallPickerDialog().isActive()){return B.prototype.getVariantsPopover.apply(this,arguments);}else{if(!this._oPickerVariantPopover){this._oPickerVariantPopover=sap.ui.xmlfragment("sap.ino.vc.wall.fragments.PickerListVariants",this);this.getView().addDependent(this._oPickerVariantPopover);}return this._oPickerVariantPopover;}},getVariant:function(s){if(!this._getWallPickerDialog().isActive()){return B.prototype.getVariant.apply(this,arguments);}else{return this._getListDefinitionEntry(s,"ACTION","/Picker/Variants/Values");}},onVariantPress:function(V,e){this.setViewProperty("/Picker/VARIANT",V);var w=this._getWallPickerView();if(w){w.getController().setViewProperty("/List/VARIANT",V);w.invalidate();}},_onVariantPress:function(e){var i=e.getSource();var c=i.getBindingContext("list");var s;var o;if(c){o=c.getObject();s=o?o.ACTION:undefined;}this.onVariantPress(s,e);var p=this.getVariantsPopover();if(typeof p.close==="function"){p.close();}},onWallPicked:function(w){this._bindList();var o=this.getList().getBinding("items");var i=this.getModel("object");if(o){var t=this;i.update().done(function(){t._updateWallPreviewControls();});}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.notice.NoticeList.controller')){jQuery.sap.declare('sap.ino.vc.notice.NoticeList.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/ino/vc/notice/NoticeList.controller",["sap/ino/vc/commons/BaseController","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/Device","sap/ino/vc/commons/mixins/ClipboardMixin","sap/ino/vc/commons/mixins/IdentityQuickviewMixin","sap/ino/commons/formatters/ObjectListFormatter"],function(B,C,J,T,D,a,I,O){"use strict";var l={"newIdeas":{sPath:"data>/MyIdeaMediumCommunity"},"newStatus":{sPath:"data>/IdeaMediumCommunity"},"newComments":{sPath:"data>/IdeaMediumSearchParams(searchToken='',tagsToken='',tagsToken1='',tagsToken2='',tagsToken3='',tagsToken4='',filterName='completedIdeas',filterBackoffice=0,c1='',o1=-2,v1='',c2='',o2=-1,v2='',c3='',o3=-1,v3='')/Results"}};var b=[{ID:36338,CREATED_AT:"/Date(1566541324522)/",CREATED_BY_ID:814053,CHANGED_AT:"/Date(1566541324522)/",CHANGED_BY_ID:814053,OBJECT_ID:314794,COMMENT:"Can you demo the POC to us.",PARENT_ID:null,CHANGED_BY_NAME:"Allen Zhang",CHANGED_BY_EMAIL:"allen.zhang07@sap.com",CHANGED_BY_PHONE:null,CHANGED_BY_MOBILE:"1",CHANGED_BY_OFFICE:null,CHANGED_BY_IMAGE_ID:null,CREATED_BY_NAME:"Allen Zhang",CREATED_BY_EMAIL:"allen.zhang07@sap.com",CREATED_BY_PHONE:null,CREATED_BY_MOBILE:"1",CREATED_BY_OFFICE:null,CREATED_BY_IMAGE_ID:null,HAS_ATTACHMENTS:0,HAS_REPLIES:1,CAN_UPDATE:1,CAN_DELETE:1,SOURCE_ID:null,STATUS:0,ChildrenComments:[{ID:36338,CREATED_AT:"/Date(1566541324522)/",CREATED_BY_ID:814053,CHANGED_AT:"/Date(1566541324522)/",CHANGED_BY_ID:814053,OBJECT_ID:314794,COMMENT:"Can you demo the POC to us.",PARENT_ID:null,CHANGED_BY_NAME:"Allen Zhang",CHANGED_BY_EMAIL:"allen.zhang07@sap.com",CHANGED_BY_PHONE:null,CHANGED_BY_MOBILE:"1",CHANGED_BY_OFFICE:null,CHANGED_BY_IMAGE_ID:null,CREATED_BY_NAME:"Allen Zhang",CREATED_BY_EMAIL:"allen.zhang07@sap.com",CREATED_BY_PHONE:null,CREATED_BY_MOBILE:"1",CREATED_BY_OFFICE:null,CREATED_BY_IMAGE_ID:null,HAS_ATTACHMENTS:0,HAS_REPLIES:1,CAN_UPDATE:1,CAN_DELETE:1,SOURCE_ID:null,STATUS:0}]}];return B.extend("sap.ino.vc.notice.NoticeList",jQuery.extend({},T,a,I,{routes:["noticelist"],formatter:jQuery.extend({},O),view:{"showCommentDialogBtn":false},onInit:function(){B.prototype.onInit.apply(this,arguments);this.oViewModel=this.getModel("view");this.oViewModel.setData(this.view,true);},onRouteMatched:function(){this.bindViewData();},onItemPress:function(e){var i=e.getSource();var c=i.getBindingContext("data");if(c){this.navigateTo("idea-display",{id:c.getProperty("ID")});}},onNoticeListTypeSelect:function(e){this._sIdeaViewKey=e.getParameter("key");this.onSwitchButtonStyle(e);if(this._sIdeaViewKey==="newComments"){this.setViewProperty("/showCommentDialogBtn",true);}else{this.setViewProperty("/showCommentDialogBtn",false);}this._bindIdeas(this._sIdeaViewKey);},bindViewData:function(){var i;i=this.byId("sapInoNoticeUpdateButtons").getSelectedKey();this._sIdeaViewKey=i||Object.keys(l)[0];this._bindIdeas(this._sIdeaViewKey);},_bindIdeas:function(k){var d=C.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE")*1||C.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE_HIDE_PHASE_BAR")*1;var t=Number(d)?this.getFragment("sap.ino.vc.notice.fragments.NoticeListItemNoImage"):this.getFragment("sap.ino.vc.notice.fragments.NoticeListItem");var o={path:l[k].sPath,template:t};var c=this;var L=this.byId("noticeIdeaList");L.bindItems(o);L.attachEventOnce("updateFinished",function(e){c.onResizeLayoutChange(null,c._sCurrentLayout);});},onSwitchButtonStyle:function(e){var s=e.getSource();var i=s.getItems();var k=s.getSelectedKey();var c,p;jQuery.each(i,function(d,o){if(o.getKey()===k){o.setDisplayNotice(false);o.setTextVisible(true);c=o.getIcon();o.setIcon(c+"-selected");}else{o.setDisplayNotice(true);o.setTextVisible(false);c=o.getIcon();p=c.indexOf("-selected");if(p>0){o.setIcon(c.substr(0,p));}}});},openCommentDialog:function(e){if(!this._oCommentDialogPopover){this._oCommentDialogPopover=this.createFragment("sap.ino.vc.notice.fragments.NoticeCommentDialog");this.getView().addDependent(this._oCommentDialogPopover);}if(!this._oCommentDialogPopover.isOpen()){this._oCommentDialogPopover.setModel(new J(e.getSource().getBindingContext("data").getObject()),"CommentData");this._oCommentDialogPopover.setModel(new J(b),"IdeaComment");this._oCommentDialogPopover.openBy(e.getSource());}else{this.closeNotifications();}},closeNotifications:function(){if(this._oCommentDialogPopover&&this._oCommentDialogPopover.isOpen()){this._oCommentDialogPopover.close();}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.reward.List.controller')){jQuery.sap.declare('sap.ino.vc.reward.List.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/reward/List.controller",["sap/ui/Device","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/ino/commons/application/Configuration","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/commons/models/object/RewardList","sap/ino/controls/OrientationType","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/vc/commons/BaseVariantListController","sap/ino/vc/evaluation/EvaluationFormatter","sap/ino/vc/reward/RewardFormatter","sap/ino/vc/reward/mixins/MassActionMixin","sap/ino/vc/reward/mixins/CreateActionMixin","sap/ino/vc/commons/mixins/ExportMixin","sap/ui/model/json/JSONModel"],function(D,S,F,a,M,C,O,A,R,b,T,B,E,c,d,e,f,J){"use strict";var r={REWARD:"rewardlist",REWARD_VARIANT:"rewardlistvariant"};var v={REWARD_MANAGE:"rewardmanage",REWARD_QUALIFIED:"rewardqualified",REWARD_REWARDED:"rewardobjects",REWARD_EXPORTED:"rewarddownloaded",REWARD_GAMIFICATION:"rewardgamificationreport"};var m={REWARD_MANAGE:"rewardManage",REWARD_QUALIFIED:"qualifiedIdeaForReward",REWARD_REWARDED:"readyForDownloadReward",REWARD_EXPORTED:"downloadedReward",REWARD_GAMIFICATION:"rewardGamificationReport"};var l={NAME:"IDEA_LIST_MIT_REWARD_NAME",Variants:{DEFAULT_VARIANT:v.REWARD_MANAGE,TITLE:"IDEA_LIST_MIT_REWARD_MANAGE",Values:[{TEXT:"IDEA_LIST_MIT_REWARD_MANAGE",ACTION:v.REWARD_MANAGE,FILTER:m.REWARD_MANAGE,CAMPAIGN_MANAGE:true,VISIBLE:true},{TEXT:"IDEA_LIST_MIT_REWARD_QUALIFIED",ACTION:v.REWARD_QUALIFIED,FILTER:m.REWARD_QUALIFIED,HIERARCHY_LEVEL:"1",CAMPAIGN_MANAGE:true,VISIBLE:true},{TEXT:"IDEA_LIST_MIT_REWARD_REWARDED",ACTION:v.REWARD_REWARDED,FILTER:m.REWARD_REWARDED,HIERARCHY_LEVEL:"1",CAMPAIGN_MANAGE:true},{TEXT:"IDEA_LIST_MIT_REWARD_EXPORTED",ACTION:v.REWARD_EXPORTED,FILTER:m.REWARD_EXPORTED,HIERARCHY_LEVEL:"1",CAMPAIGN_MANAGE:true},{TEXT:"IDEA_LIST_MIT_REWARD_GAMIFICATION_REPORT",ACTION:v.REWARD_GAMIFICATION,FILTER:m.REWARD_GAMIFICATION,HIERARCHY_LEVEL:"1",CAMPAIGN_MANAGE:true}]}};var L=B.extend("sap.ino.vc.reward.List",jQuery.extend({},T,f,d,e,{formatter:jQuery.extend({},O,E,c),initialFocus:"filterButton",list:l,routes:["rewardlist","rewardlistvariant"],view:{"List":{"VARIANT":v.REWARD_MANAGE,"MANAGE":false,"TAGS":[],"IS_TAGS_SELECTION":false,"TAGCLOUD":false,"TAGCLOUD_EXPABLE":true,"TAGCLOUD_EXP":false,"TAGCLOUD_BAR_VISIBLE":false,"HIDE_PPT_EXPORT":true,"SELECT_ALL_ENABLE":false,"SELECT_ALL":false,"IS_IDEA_LIST":false,"IS_GAMIFICATION_REPORT":false},"ORIENTATION":b.PORTRAIT},onInit:function(){B.prototype.onInit.apply(this,arguments);this.oViewModel=this.getModel("view");this.oViewModel.setData(this.view,true);this.initApplicationObjectChangeListeners();},onRouteMatched:function(o){this.setGlobalFilter([]);var g=this.getModel("user").getProperty("/privileges")["sap.ino.ui::backoffice.access"];if(!g){this.navigateTo("home");return;}this.setHelp("REWARD_LIST");this.setCurrentRouteCampaignID();this.show(o);},setCurrentRouteCampaignID:function(){var h=this.getModel("history");var s=h.getProperty("/CurrentHash/hash");if(s&&s.indexOf('campaign/')>=0){var g=s.substr(9);this.setViewProperty("/List/CAMPAIGN",g);var o=this.byId("panelFilterFragment--campaignFilterList");var j=o.getSuggestionItems();for(var i=0;i<j.length;i++){if(j[i].getProperty("key")===g){o.setSelectionItem(j[i]);break;}}this.setFilter(new F("CAMPAIGN_ID",a.EQ,g));}},onCampaignDialogItemsSelect:function(o){var s=o.getParameter("selectedItem").data("ID")+"";var g=this.byId("panelFilterFragment--campaignFilterList");g.getBinding("suggestionItems").filter([]);var h=g.getSuggestionItems();for(var i=0;i<h.length;i++){if(h[i].getProperty("key")===s){g.setSelectionItem(h[i]);break;}}if(s!==this.getViewProperty("/List/CAMPAIGN")){this.setViewProperty("/List/CAMPAIGN",s);this.setFilter(new F("CAMPAIGN_ID",a.EQ,s));var j=this.getList().getBindingInfo("items");j.filters=this._aFilter;this.getList().bindItems(j);}},onCampaignDialogSearch:function(o){var g=o.getParameter("itemsBinding");var V=jQuery.sap.encodeURL(o.getParameter("value"));g.filter(new F("SHORT_NAME",a.Contains,V));g.sort(new S("SHORT_NAME"));},onCampaignSuggestion:function(o){var V=this.getModel("view");var g=o.getSource().getBinding("suggestionItems");var h=jQuery.extend({},o,true);var s=h.getParameter("suggestValue");this.resetClientMessages();this.byId("panelFilterFragment--campaignFilterList").setFilterSuggests(false);V.setProperty("/campaignSuggestion",this._aCampaignSuggestion);g.filter(new F("SHORT_NAME",a.Contains,s));g.sort(new S("SHORT_NAME"));},onFilterReset:function(){this.setViewProperty("/List/CAMPAIGN",undefined);this.byId("panelFilterFragment--campaignFilterList").setValue(undefined);this.setFilter([]);if(!D.system.desktop){return;}this._filter();},onFilterCampaignChange:function(o){var s=o.getParameter("selectedItem")?Number(o.getParameter("selectedItem").getProperty("key")):undefined;if(s!==this.getViewProperty("/List/CAMPAIGN")){this.setViewProperty("/List/CAMPAIGN",s);this.setFilter(new F("CAMPAIGN_ID",a.EQ,s));this._filter();}},onClearCampaignFilter:function(o){var V=o.getParameter("value");if(V.trim()===""){this.setViewProperty("/List/CAMPAIGN",undefined);this.setFilter([]);this._filter();}},onHandleCampaignFilterHelp:function(){var V=this.getModel("view");if(!this._oCampaignlistDialog){this._oCampaignlistDialog=this.createCampaignListDialog();}V.setProperty("/campaignSuggestion",this._aCampaignSuggestion);this._oCampaignlistDialog.open();},onDownloadReward:function(){var t=this;var o=this.getList();var g=[];var h=[];var s=o.getSelectedIndices();if(s.length){for(var i=0;i<s.length;i++){g.push(o.getContextByIndex(s[i]).getProperty("ID"));if(h.indexOf(o.getContextByIndex(s[i]).getProperty("REWARD_LIST_ID"))===-1){h.push(o.getContextByIndex(s[i]).getProperty("REWARD_LIST_ID"));}}}var j=B.prototype.executeObjectAction.call(t,R,"download",{staticparameters:{"REWARD_ID":g,"REWARD_LIST_ID":h}});j.done(function(){if(t.bindList&&typeof(t.bindList)==="function"){t.bindList();}});},onListExportXLS:function(){var t=this;if(!this.getViewProperty("/List/IS_IDEA_LIST")&&this.isDownloaded()){M.confirm(this.getText("IDEA_LIST_REWARD_LIST_INS_EXPORT_CONFIRMATION"),{title:this.getText("GENERAL_EXPORT_TIT_EXPORT_CONFIRMATION"),icon:M.Icon.NONE,onClose:function(g){if(g==="OK"){f.onListExportXLS.call(t);}}});}else{f.onListExportXLS.call(t);}},onListExportCSV:function(){var t=this;if(!this.getViewProperty("/List/IS_IDEA_LIST")&&this.isDownloaded()){M.confirm(this.getText("IDEA_LIST_REWARD_LIST_INS_EXPORT_CONFIRMATION"),{title:this.getText("GENERAL_EXPORT_TIT_EXPORT_CONFIRMATION"),icon:M.Icon.NONE,onClose:function(g){if(g==="OK"){f.onListExportCSV.call(t);}}});}else{f.onListExportCSV.call(t);}},visibleItem:function(V){return V;},onTableSelectionChange:function(o){if(!this._bIsWarned){this._bIsWarned=true;M.show(this.getText("SELECTION_WITH_COAUTHOR_MESSAGE"),M.Icon.INFORMATION,this.getText("MESSAGE_TIT_WARNING"),[M.Action.OK]);}if(this._bIsTableSelectionChanging){return;}var t=this.getList();var s=t.getSelectedIndices();var g=o.getParameter("rowIndex")===-1||o.getParameter("selectAll")?0:t._iBindingLength;var h=o.getParameter("rowIndex")===-1||o.getParameter("selectAll")?0:t.getContextByIndex(o.getParameter("rowIndex")).getProperty("REWARD_LIST_ID");var k=s.indexOf(o.getParameter("rowIndex"))>=0?true:false;var n=false;var p=false;for(var j=0;j<g;j++){this._bIsTableSelectionChanging=true;if(t.getContextByIndex(j).getProperty("REWARD_LIST_ID")===h&&j!==o.getParameter("rowIndex")){if(k){t.addSelectionInterval(j,j);}else{t.removeSelectionInterval(j,j);}}}this._bIsTableSelectionChanging=false;s=t.getSelectedIndices();for(var i=0;i<s.length;i++){if(Number(t.getContextByIndex(s[i]).getProperty("DOWNLOAD_COUNT"))){n=false;break;}else{n=true;}}if(s.length){p=true;}if(this.byId("sapInoMassDeleteBtn")){this.byId("sapInoMassDeleteBtn").setEnabled(n);}if(this.byId("sapInoMassExportBtn")){this.byId("sapInoMassExportBtn").setEnabled(p);}},onOpenIdeaReward:function(o){var i=o.getSource().getBindingContext("data").getProperty("IDEA_ID");if(i){this.navigateTo("idea-display",{id:i,query:{section:"sectionRewards"}});}},onOrientationChange:function(){},_check4ManagingList:function(){var g=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");if(g){var V=this.getViewProperty("/List/VARIANT");var h=this.getListProperty("/Variants/Values");var i=jQuery.grep(h,function(o){return o.ACTION===V;});i=(i&&i.length>0)?i[0]:{};return i.MANAGE||i.CAMPAIGN_MANAGE||false;}return false;},_filter:function(){var g=[];if(this.getViewProperty("/List/CAMPAIGN")){g.push(new F("CAMPAIGN_ID",a.EQ,this.getViewProperty("/List/CAMPAIGN")));}if(this.getViewProperty("/List/IS_IDEA_LIST")){this.getList().getBinding("items").filter(g.length?new F(g,true):null,"Application");}else{this.getList().getBinding("rows").filter(g.length?new F(g,true):null,"Application");}},createCampaignListDialog:function(){if(!this._campaignDialog){this._campaignDialog=this.createFragment("sap.ino.vc.idea.fragments.CampaignSuggestionSelectList",this.getView().getId());this.getView().addDependent(this._campaignDialog);}return this._campaignDialog;},_setCampaignFilter:function(){var s=this.getViewProperty("/List/CAMPAIGN");var o=this.byId("panelFilterFragment--campaignFilterList");var g=o.getSuggestionItems();for(var i=0;i<g.length;i++){if(g[i].getProperty("key")===s){o.setSelectionItem(g[i]);break;}}},bindList:function(){var t=this;this.saveState();this.resetActionState();var p="";var i=this._check4ManagingList();var o=this.getBindingParameter();function g(){var h=arguments[0].getParameter("data").results;var n=[];var V=t.getModel("view");jQuery.each(h,function(I,j){if(jQuery.grep(n,function(N){return N.ID===j.CAMPAIGN_ID;}).length===0||n.length===0){n.push({ID:j.CAMPAIGN_ID,SHORT_NAME:j.CAMPAIGN_NAME});}});V.setProperty("/campaignSuggestion",n);t._aCampaignSuggestion=n;t._filter();t._setCampaignFilter();}if(o.Variant===v.REWARD_QUALIFIED){p+="IdeaMediumBackofficeSearchParams";p+="(searchToken='"+(o.SearchTerm?jQuery.sap.encodeURL(o.SearchTerm):"")+"',"+"searchType="+0+","+"tagsToken='"+(o.TagIds.join(",")||"")+"',"+"filterName='"+(o.VariantFilter||"")+"',"+"filterBackoffice="+(i?"1":"0")+",c1='',o1=-1,v1='',c2='',o2=-1,v2='',c3='',o3=-1,v3=''"+",cvt='"+""+"',"+"cvr=0,"+"cvy=0"+",tagsToken1='',tagsToken2='',tagsToken3='',tagsToken4='')/Results";}else if(o.Variant===v.REWARD_GAMIFICATION){p+="SearchGamificationReportParams(searchLanguage='"+C.getCurrentUser().LOCALE+"')/Results";}else{p+="RewardSearchParams";p+="(searchToken='"+(o.SearchTerm?jQuery.sap.encodeURL(o.SearchTerm):"")+"',"+"filterName='"+(o.VariantFilter||"")+"'"+")/Results";}this.setPath("data>/"+p);if(o.Variant===v.REWARD_QUALIFIED){this.getList().bindItems({parameters:{operationMode:"Client"},path:this.getPath(),filters:this._aFilter,template:this.getItemTemplate(),groupHeaderFactory:this.getGroupHeaderFactory(),events:{dataRequested:function(){jQuery.each(t.getBusyControls(),function(I,h){if(jQuery.type(h.setBusy)==="function"){h.setBusy(true);}});},dataReceived:function(){jQuery.each(t.getBusyControls(),function(I,h){if(jQuery.type(h.setBusy)==="function"){h.setBusy(false);}});if(jQuery.type(g)==="function"){g.apply(this,arguments);}}}});}else if(o.Variant===v.REWARD_GAMIFICATION){this.getList().bindRows({path:this.getPath()});}else{this.getList().bindRows({parameters:{operationMode:"Client"},path:this.getPath(),events:{dataRequested:function(){jQuery.each(t.getBusyControls(),function(I,h){if(jQuery.type(h.setBusy)==="function"){h.setBusy(true);}});},dataReceived:function(){jQuery.each(t.getBusyControls(),function(I,h){if(jQuery.type(h.setBusy)==="function"){h.setBusy(false);}});if(jQuery.type(g)==="function"){g.apply(this,arguments);}}}});}},fnCompleted:function(o){return function(){if(!o.getViewProperty("/List/IS_IDEA_LIST")&&!o.getViewProperty("/List/IS_GAMIFICATION_REPORT")){o.onDownloadReward();}else{return null;}};},getExportControl:function(){if(this.getViewProperty("/List/GAMIFICATION_DETAIL_OPEN")){return this.byId('gamificationReportTableDetail');}else{return this.getList();}},getBindingParameter:function(){var V,s;V=this.getViewProperty("/List/VARIANT");s=this.getCurrentVariant().FILTER;var g=this.getViewProperty("/List/SEARCH");var t=this.getViewProperty("/List/TAGS");var h=this.getViewProperty("/List/CAMPAIGN");var i=jQuery.map(t,function(o){return o.ID;});return{Variant:V,VariantFilter:s,SearchTerm:g,TagIds:i,CampaignId:h};},getList:function(){var o=this.getViewProperty("/List/IS_GAMIFICATION_REPORT")?this.byId("rewardTableGamificationFragment--gamificationReportTable"):this.byId("rewardTableFragment--objectTable");return this.getViewProperty("/List/IS_IDEA_LIST")?this.byId("rewardListFragment--objectlist"):o;},getVariantVisibility:function(V){var g,h;g=this.getModel("list").getProperty("/Variants/Values");for(var i=0;i<g.length;i+=1){var o=g[i];if(o.ACTION===V){h=o.VISIBLE;}}return h;},getExportPrefix:function(){if(!this.getViewProperty("/List/IS_IDEA_LIST")){if(this.getViewProperty("/List/IS_GAMIFICATION_REPORT")){return this.getText("EXPORT_PREFIX_GAMIFICATION");}return this.getText("EXPORT_PREFIX_REWARD");}else{return this.getText("EXPORT_PREFIX_IDEA");}},getItemTemplate:function(){return this.getFragment("sap.ino.vc.reward.fragments.RewardListItem");},isDownloaded:function(){var t=this.getList();var s=t.getSelectedIndices();var g=false;if(s.length){for(var i=0;i<s.length;i++){if(t.getContextByIndex(s[i]).getProperty("DOWNLOAD_COUNT")>0){g=true;break;}}}return g;},initApplicationObjectChangeListeners:function(){var t=this;var g=["create","del","modifyAndSubmit","executeStatusTransition","forward"];var h=function(o){var s=o.getParameter("actionName");if(s&&g.indexOf(s)>-1&&o.getParameter("object").getMetadata().getName()==="sap.ino.commons.models.object.RewardList"){t.bindList();}};A.attachChange(A.Action.Create,h);A.attachChange(A.Action.Del,h);A.attachChange(A.Action.Action,h);},show:function(o,g){var q;var V;if(o&&o.getParameter){var h=o.getParameter("arguments");q=h["?query"];V=h.variant;}else{V=g.variant;q=g;}if(V===this.list.Variants.Values[4].ACTION){this.setViewProperty("/List/IS_GAMIFICATION_REPORT",true);}else{this.setViewProperty("/List/IS_GAMIFICATION_REPORT",false);}var t=this;var s=this.getListProperty("/Variants/DEFAULT_VARIANT");this.setViewProperty("/isre",V||s);V=this.getViewProperty("/isre");var i=this.getVariant(V);this.setViewProperty("/List/VARIANT",i.ACTION);var j=this.getList()&&this.getList().isBound("rows")||this.getList()&&this.getList().isBound("items");var k=this.hasStateChanged(this.getCurrentRoute(),V,q,D.orientation.portrait);k=k||this._bListChanged;this._bListChanged=false;if(!j||k){this.setVariantVisibility();this.setParameters(q,i);var n=this.getViewProperty("/ORIENTATION");this.onOrientationChange(D.system.desktop?n:D.orientation);var p=this.getVariantVisibility(V);if(p===false||typeof(p)==="undefined"){M.show(t.getText("NOT_AUTHORIZED_MESSAGE"),M.Icon.INFORMATION,t.getText("NOT_AUTHORIZED_DIALOG_TITLE"),[M.Action.OK],function(){t.navigateTo("home");});return;}this.bindList();}},setParameters:function(q,V){q=q||{};var s=V.ACTION;this.setViewProperty("/List/TAGCLOUD",false);this.setViewProperty("/List/IDEA_NAVIGATION_SECTION","sectionRewards");this.setViewProperty("/DISABLE_ORIENTATION",true);this.setViewProperty("/List/VARIANT",V.ACTION);this.setViewProperty("/List/MANAGE",V.MANAGE||V.CAMPAIGN_MANAGE);if(this.byId("sapInoMassDeleteBtn")){this.byId("sapInoMassDeleteBtn").setVisible(s!==v.REWARD_EXPORTED);}if(s===v.REWARD_QUALIFIED){this.setViewProperty("/List/IS_IDEA_LIST",true);this.setViewProperty("/List/HIDE_PPT_EXPORT",false);if(!this._sResizeListId){this._sResizeListId=this.attachListControlResized(this.getList());}}else{this.setViewProperty("/List/IS_IDEA_LIST",false);this.setViewProperty("/List/HIDE_PPT_EXPORT",true);if(this._sResizeRegId){this.detachListControlResized(this.getList());}}},setVariantVisibility:function(){var V=this.getModel("list").getProperty("/Variants/Values");for(var i=0;i<V.length;i+=1){var o=V[i];var I=o.MANAGE||false;var g=o.EXPERT||false;var h=o.CAMPAIGN_MANAGE||false;var j=(!I&&!g&&!h)||(g&&C.hasCurrentUserPrivilege("sap.ino.ui::expert"))||(h&&(C.hasCurrentUserPrivilege("sap.ino.ui::campaign_manager")||C.hasCurrentUserPrivilege("sap.ino.xs.rest.admin.application::execute"))&&C.getSystemSetting("sap.ino.config.REWARD_ACTIVE")==="1")||(I&&C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access"));if(V[i].ACTION===v.REWARD_GAMIFICATION){j=j&&!!this.getView().getModel("config").getProperty("/ENABLE_GAMIFICATION");}this.getModel("list").setProperty("/Variants/Values/"+i+"/VISIBLE",j);}},onObjectListUpdateFinished:function(g){var p=g&&g.getParameters();if(p&&p.total>0){this.setViewProperty("/List/SELECT_ALL_ENABLE",true);}else{this.setViewProperty("/List/SELECT_ALL_ENABLE",false);}B.prototype.onObjectListUpdateFinished.apply(this,arguments);},onPressCurrentValue:function(o){var s=o.getSource();var p=s.getBindingInfo("text").binding.getContext().sPath;var g=this.getModel("data");var i,I,u;if(p){i=g.getProperty(p+"/DIMENSION_ID");I=g.getProperty(p+"/IDENTITY_ID");u=g.getProperty(p+"/USER_NAME");}var G=this.getGamificationDetailDialog();var h="data>/SearchGamificationReportDetailParams(dimensionId="+i+","+"identityId="+I+","+"searchLanguage='"+C.getCurrentUser().LOCALE+"'"+")/Results";var j=new sap.ui.model.Sorter("CREATED_AT",true);this.byId('gamificationReportTableDetail').bindAggregation("rows",{path:h,sorter:j});G.setTitle(this.getText("IDEA_LIST_REWARD_LIST_GAMIFICATION_REPORT_DETAIL_VIEW",u));this.setViewProperty("/List/GAMIFICATION_DETAIL_OPEN",true);G.open();},onPressGamificationDetailClose:function(o){var g=this.getGamificationDetailDialog();this.setViewProperty("/List/GAMIFICATION_DETAIL_OPEN",false);g.close();},getGamificationDetailDialog:function(){if(!this._oGamifcationDialog){this._oGamifcationDialog=this.createFragment("sap.ino.vc.reward.fragments.RewardGamificationReportDetail",this.getView().getId());this.getView().addDependent(this._oGamifcationDialog);}return this._oGamifcationDialog;},onGamiTableSelectionChange:function(o){var t=this.getList();var g=this.byId("sapInoMassExportBtn");var s=t.getSelectedIndices();if(s.length){g.setEnabled(true);}else{g.setEnabled(false);}},onGamiTableDetailSelectionChange:function(o){var t=this.byId("gamificationReportTableDetail");var g=this.byId("exportDetailBtn");var s=t.getSelectedIndices();if(s.length){g.setEnabled(true);}else{g.setEnabled(false);}},onOpenSubmitter:function(o){var s=o.getSource();var i=s.getBindingContext("data").getProperty(s.getBindingContext("data").sPath+"/EMPLOYEE_ID");this.openIdentityQuickView(s,i);}}));L.list=l;L.routes=r;return L;});};if(!jQuery.sap.isDeclared('sap.ino.vc.search.Global.controller')){sap.ui.getCore().loadLibrary("sap.ino.wall");jQuery.sap.declare('sap.ino.vc.search.Global.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.ino.wall.Wall');jQuery.sap.require('sap.ino.vc.wall.util.WallFactory');jQuery.sap.require('sap.ui.model.type.DateTime');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/search/Global.controller",["sap/ino/vc/commons/BaseVariantListController","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/core/mvc/ViewType","sap/ino/controls/OrientationType","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/commons/mixins/GlobalSearchMixin","sap/ino/wall/Wall","sap/ino/vc/wall/util/WallFactory","sap/ino/commons/application/Configuration","sap/ino/vc/blog/mixins/BlogCardMixin","sap/ui/model/type/DateTime","sap/m/MessageToast","sap/ino/vc/idea/mixins/VolunteerMixin"],function(B,D,J,T,V,O,a,F,b,R,c,G,W,d,C,e,f,M,g){"use strict";return B.extend("sap.ino.vc.search.Global",jQuery.extend({},T,a,F,b,R,G,e,g,{routes:["search","searchcategory"],formatter:$.extend({variantTitle:function(){return"Search";}},c,B.prototype.formatter),onInit:function(){B.prototype.onInit.apply(this,arguments);},onBeforeHide:function(E){},onBeforeRendering:function(){},isGlobalSearch:function(){return true;},onRouteMatched:function(E,o){var p=E.getParameters();var s=p.arguments;var q=s['?query'];var v=this.getView();this.setViewProperty("/SEARCH_QUERY",q);this.setHelp("GLOBAL_SEARCH");if(!v.getBusy()){v.setBusy(true);}this.getSearchResult(q);},getSearchResult:function(h){var s=this;var v=this.getView();var p={keyword:h.search&&window.decodeURIComponent(h.search)||'',id:h.id||'',type:h.type||'',managed:h.managed};var i=$.get('xs/rest/common/search.xsjs',p);v.setBusy(true);i.done(function(r){s.setModel(new J(r),'data');s.bindSearchResult(r);v.setBusy(false);});i.fail(function(j){if(j){M.show(j);}v.setBusy(false);});i.error(function(j){if(j){M.show(j);}v.setBusy(false);});},bindSearchResult:function(r){var s=this;var h=this.getCampaignList();var i=this.getIdeaList();var t=this.getTagList();var u=this.getUserList();var w=this.getWallList();var j=this.getBlogList();if(r.Campaigns&&h){h.bindItems({path:'data>/Campaigns/data',template:s.getFragment("sap.ino.vc.campaign.fragments.CardListItem")});}if(r.Ideas&&i){var k=C.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE")*1;var l=k?this.getFragment("sap.ino.vc.idea.fragments.CardListItemNoImage"):this.getFragment("sap.ino.vc.idea.fragments.CardListItem");i.bindItems({path:'data>/Ideas/data',template:l});}if(r.Tags&&t){t.bindItems({path:'data>/Tags/data',template:s.getFragment('sap.ino.vc.tag.fragments.CardListItem')});}if(r.Users&&u){u.bindItems({path:'data>/Users/data',template:s.getFragment('sap.ino.vc.iam.fragments.IdentityListItem')});}if(r.Walls&&w){w.bindItems({path:'data>/Walls/data',template:s.getFragment('sap.ino.vc.wall.fragments.WallListItem')}).addStyleClass("sapInoWallListPreviewItems");s.bindWallList(w,r.Walls.data);var m=this.getWallList().getBinding("items");if(m){m.attachDataReceived(this.bindWallList,this);}}if(r.Blogs&&j){j.bindItems({path:'data>/Blogs/data',template:s.getFragment('sap.ino.vc.search.fragments.BlogListItem')}).addStyleClass('sapInoBlogList');}},bindWallList:function(l,h){var j=l.getItems();var h=h;var w=[];var s=this;s._oPreview2Wall=s._oPreview2Wall||{};for(var i=0;i<j.length;i++){var k=j[i].getAggregation("content")[1];var I=k.getBindingContext("data").getProperty("ID");var m=h.filter(function(o){return o.ID===I;});if(!k.getWallControl()){if(m&&m.length>0){w.push(I);var n=d.createWallFromInoJSON(m[0]);if(m[0].BACKGROUND_IMAGE_ATTACHMENT_ID){n.setBackgroundImage(C.getAttachmentDownloadURL(m[0].BACKGROUND_IMAGE_ATTACHMENT_ID));}s._oPreview2Wall[I]=n;k.setWall(n);k.invalidate();}}else if(!k.getWallControl().getItems().length){if(m&&m.length>0){w.push(I);}}}},getCampaignList:function(){return this.getView().byId('objectCampaignList');},getIdeaList:function(){return this.getView().byId('objectIdeaList');},getTagList:function(){return this.getView().byId('objectTagList');},getUserList:function(){return this.getView().byId('objectUserList');},getWallList:function(){return this.getView().byId('objectWallList');},getBlogList:function(){return this.getView().byId('objectBlogList');},getListController:function(){return this._oListController;},setListController:function(o){this._oListController=o;},getListView:function(){return this._oListView;},setListView:function(v){this._oListView=v;},displayListView:function(s){var v=this.getListView();if(s){v.removeStyleClass("sapInoMobileObjectListNotVisible");}else{if(!v.hasStyleClass("sapInoMobileObjectListNotVisible")){v.addStyleClass("sapInoMobileObjectListNotVisible");}}},enableListBinding:function(E){if(E){this.getListController().bindList=this.getListController().bindListCore;}else{this.getListController().bindList=function(){};}},onVariantBasePress:function(){var l=this.getListController();l.onVariantBasePress.apply(l,arguments);},onTagSelected:function(){var l=this.getListController();l.onTagSelected.apply(l,arguments);},onTagDeselected:function(){var l=this.getListController();l.onTagDeselected.apply(l,arguments);},onTagItemDeselectPress:function(){var l=this.getListController();l.onTagItemDeselectPress.apply(l,arguments);},getList:function(){return this.getListController()&&this.getListController().getList();},getPath:function(){return this.getListController()&&this.getListController()._sPath;},getItemTemplate:function(){return this.getListController()&&this.getListController().getItemTemplate();},getListLayout:function(){return this.byId("searchresults");},showMoreLink:function(r){return!!(r&&r.data&&r.counts>r.data.length);},onItemPress:function(h){var s=h.getSource();var i=s.getBindingContext('data');var p=h.getParameters();if(p.campaignId){this.navigateTo('campaign',{id:p.campaignId});}if(i.getProperty('WALL_TYPE_CODE')){this.navigateToWall("wall",{id:i.getProperty('ID')});}},onOpenCampaign:function(E){this.navigateTo("campaign",{id:E.getParameter("campaignId")});},onOpenIdea:function(h){var i=h.getSource();var j=i.getBindingContext("data");if(j){this.navigateTo("idea-display",{id:j.getProperty("ID")});}},onBlogItemPress:function(h){var I=h.getSource();var i=I.getBindingContext("data");if(i){this.navigateTo("blog-display",{id:i.getProperty("ID")});}},navigateToMore:function(h,i){var s=this.getModel('search');var j=s.getData();var k=j.searchAguments;var l=k['?query']&&k['?query'].search;var m={category:h,search:l,param:$.extend(k,i||{})};if(m.category&&m.param&&m.category==='idealist'){m.param['?query']=m.param['?query']||{};m.param['?query'].sort="SEARCH_SCORE DESC";}this._handleSearchNavgate(l,m);},goCampaigns:function(){this.navigateToMore('campaignlist');},goIdeas:function(){var h={};var i='idealist';var s=this.getModel('search');var j=s.getData();var k=j.searchAguments;var q=k&&k['?query'];var t=q&&q.type;if(t==='campaign'){h.id=q.id;i='campaign-idealist';}this.navigateToMore(i,h);},goTags:function(){this.navigateToMore('taglist');},goUsers:function(){this.navigateToMore('peoplelist');},goWalls:function(){this.navigateToMore('walllist');},goBlogs:function(){var s=this.getModel('search');var h=s.getData();var i=h.searchAguments&&h.searchAguments['?query']&&h.searchAguments['?query'].id;if(!i){return false;}this.navigateToMore('campaign-bloglist',{id:i});},isShown:function(h){return!!h&&!!h.data;},transToDate:function(s){var h=new Date(s);return h.toDateString();},showResultCount:function(t,n,r){var N=!!(r&&r.data&&r.counts>r.data.length);var h=t;var i=n||0;if(N){return h+'  ('+(i-1)+'+)';}else{return h+'  ('+i+')';}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.shell.InoShell.controller')){jQuery.sap.require('sap.ino.apps.ino.Component');jQuery.sap.declare('sap.ino.vc.shell.InoShell.controller');jQuery.sap.require('sap.ui.core.ComponentContainer');jQuery.sap.require('sap.ui.core.routing.History');jQuery.sap.require('sap.ui.unified.Menu');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.ui.core.Item');jQuery.sap.require('sap.ui.core.CustomData');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.GroupHeaderListItem');jQuery.sap.require('sap.ui.core.format.NumberFormat');sap.ui.define("sap/ino/vc/shell/InoShell.controller",["sap/ino/vc/commons/BaseController","sap/ui/core/ComponentContainer","sap/ui/core/routing/History","sap/ui/unified/Menu","sap/ui/core/MessageType","sap/ui/Device","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/ui/core/mvc/ViewType","sap/ui/core/Item","sap/ui/core/CustomData","sap/m/MessageBox","sap/m/MessageToast","sap/m/GroupHeaderListItem","sap/ino/commons/formatters/ObjectListFormatter","sap/ui/core/format/NumberFormat","sap/ino/commons/models/core/ClipboardModel","sap/ino/commons/formatters/BaseFormatter","sap/ino/commons/models/core/CodeModel","sap/ino/vc/commons/mixins/UserGroupMixin","sap/ino/commons/models/object/PersonalizeSetting","sap/ino/vc/commons/mixins/GlobalSearchMixin"],function(C,b,H,M,c,D,d,J,V,I,e,f,g,G,O,N,h,B,i,U,P,j){"use strict";var n=30000;var k={Theme:{HCB:"sap_hcb"},Mail:{Active:"active",Inactive:"inactive"}};return C.extend("sap.ino.vc.shell.InoShell",jQuery.extend({},U,j,{formatter:jQuery.extend({helpMenuButton:function(s){return s.phone;},fullScreenToggle:function(s){return!s.desktop&&window.location.protocol==="https:";},displayTermsConditions:function(){return d.isComponentActive("sap.ino.config.DISPLAY_TERMS_CONDITIONS");},termsConditions:function(s){if(s===null||s===undefined){return undefined;}var m=this.getView().getModel("module");return m.getProperty(s);},version:function(){return this._i18n.getResourceBundle().getText("ABOUT_VERSION_FLD",[this._oComponent.getVersion(),this._oComponent.getVersionTimestamp()]);},text:function(t){return this._i18n.getResourceBundle().getText(t);},icon:function(s){if(jQuery.isNumeric(s)){s=d.getAttachmentTitleImageDownloadURL(s);}else if(s){s="/"+s;}else{s="sap-icon://error";}return s;},groupHeader:function(o){return new G({title:this._i18n.getResourceBundle().getText("MENU_TIT_"+o.key)});},visibleWithSearch:function(s,p,l){return(p!==undefined&&!p)||!s||(l!==undefined&&!l);},visibleAppTitle:function(p,t){if(t.length===0||t.match(/^\s+$/g)){var a=true;}return(p!==undefined&&!p)&&(a===undefined||!a);},generateMailURL:function(m){return sap.m.URLHelper.normalizeEmail(m);},notificationTooltip:function(a){if(a){var o=N.getIntegerInstance({style:"short"});var l=o.format(a);if(l===0){return this._i18n.getResourceBundle().getText("SHELL_EXP_NOTIFICATION_EMPTY");}else if(l===1){return this._i18n.getResourceBundle().getText("SHELL_EXP_NOTIFICATION_SINGLE");}else{return this._i18n.getResourceBundle().getText("SHELL_EXP_NOTIFICATION_COUNT",[o.format(a)]);}}return this._i18n.getResourceBundle().getText("SHELL_EXP_NOTIFICATION_EMPTY");},notificationCountFormatter:function(a){if(a&&a>999){return 999;}return a;},notificationText:function(t){return t.split("{").join("").split("}").join("");},clipboardObjectName:function(s){return s?this._i18n.getResourceBundle().getText("CLIPBOARD_OBJECT_NAME_"+s):"";},navigationItemSelected:function(r,s){if(!r||!s){return false;}if(r===s||r===s+"variant"||r+"list"===s){return true;}var a=jQuery.grep(this.menu.Navigation,function(t){return r===t.TO||r===t.TO+"variant"||r+"list"===t.TO;});if(a.length===0&&r.indexOf("-")>-1){var R=r.split("-");if(R[1]===s||R[1]===s+"variant"){return true;}var S=jQuery.grep(this.menu.Navigation,function(t){return R[1]===t.TO||R[1]===t.TO+"variant";});if(S.length===0&&r.split("-")[0]+'list'===s){return true;}}return false;},navigationItemVisible:function(a,F,m,p,s){var v=(!p||(p&&m))&&(F||(!F&&a));if(s==="evalreqlist"){return v&&d.getSystemSetting("sap.ino.config.EVAL_REQ_ACTIVE")==="1";}if(s==="rewardlist"){return v&&(this.getModel("user").getProperty("/privileges/sap.ino.ui::campaign_manager")||this.getModel("user").getProperty("/privileges/sap.ino.xs.rest.admin.application::execute"))&&d.getSystemSetting("sap.ino.config.REWARD_ACTIVE")==="1";}if(s==="expertfinder"){return v&&(this.getView().getModel("config").oData["sap.ino.config.EXPERT_FINDER_ACTIVE"]==="1");}if(s==="peoplelist"){return v&&(this.getView().getModel("config").oData["sap.ino.config.PEOPLE_MENU_FOR_ALL_ACTIVE"]==="1");}if(s==="leaderboard"){return v&&!!this.getView().getModel("config").oData.ENABLE_GAMIFICATION&&!!this.getView().getModel("config").oData.ENABLE_LEADERBOARD;}return v;},historyEnable:function(a){return Number(a)>=1;},historyTooltip:function(a,l){if(a.length){return this.getText("PAGE_TIT_"+(!a[0].title?"HOME":a[0].title.toUpperCase()));}else{return"";}},historyMenu:function(t){return this.getText("PAGE_TIT_"+(!t?"HOME":t.toUpperCase()));},historyMenuDetail:function(t,s){var a=this.getOwnerComponent().getModel("historyDetail").getProperty("/HashList");var l=null;a.forEach(function(m,o){if(s===m.hash){l=m.detailTitle;}});return l?l:this.getText("PAGE_TIT_"+(!t?"HOME":t.toUpperCase()));},formatChangeLogValue:function(s,a,l){if(l){return B.toDate(l);}else if(a){return a;}else if(s){return s;}else{return"";}},formatIdentityCode:function(s){return i.getFormatter("sap.ino.xs.object.iam.IdentityLogSetting.Root")(s);}},C.prototype.formatter),objectListFormatter:O,menu:{"Navigation":[{"ICON":"sap-icon://InoIcons/idea-add","TITLE":"MENU_MIT_CREATE_IDEA","TO":"idea-create","GROUP":"ACTION","FRONTOFFICE_ENABLED":true,"MOBILE_ENABLED":true},{"ICON":"sap-icon://home","TITLE":"MENU_MIT_HOME","TO":"home","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":true,"MOBILE_ENABLED":true},{"ICON":"sap-icon://InoIcons/campaign","TITLE":"MENU_MIT_CAMPAIGNS","TO":"campaignlist","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":true,"MOBILE_ENABLED":true},{"ICON":"sap-icon://lightbulb","TITLE":"MENU_MIT_IDEAS","TO":"idealist","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":true,"MOBILE_ENABLED":true},{"ICON":"sap-icon://person-placeholder","TITLE":"MENU_MIT_IDENTITIES","TO":"peoplelist","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":true,"MOBILE_ENABLED":true},{"ICON":"sap-icon://InoIcons/wall","TITLE":"MENU_MIT_WALLS","TO":"walllist","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":true,"MOBILE_ENABLED":true},{"ICON":"sap-icon://tags","TITLE":"MENU_MIT_TAGS","TO":"taglist","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":true,"MOBILE_ENABLED":true},{"ICON":"sap-icon://feed","TITLE":"MENU_MIT_FEEDS","TO":"feedlist","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":true,"MOBILE_ENABLED":true},{"ICON":"sap-icon://employee-lookup","TITLE":"MENU_MIT_EXPERT_FINDER","TO":"expertfinder","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":false,"MOBILE_ENABLED":false},{"ICON":"sap-icon://bar-chart","TITLE":"MENU_MIT_REPORTS","TO":"reportlist","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":false,"MOBILE_ENABLED":false},{"ICON":"sap-icon://clinical-tast-tracker","TITLE":"MENU_MIT_EVALUATION_REQUEST","TO":"evalreqlist","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":true,"MOBILE_ENABLED":false},{"ICON":"sap-icon://competitor","TITLE":"MENU_MIT_REWARDS_MANAGEMENT","TO":"rewardlist","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":false,"MOBILE_ENABLED":false},{"ICON":"sap-icon://InoIcons/leaderboard_fire","TITLE":"MENU_MIT_GAMEFICATION_LEADERBOARD","TO":"leaderboard","GROUP":"NAVIGATION","FRONTOFFICE_ENABLED":true,"MOBILE_ENABLED":false}]},view:{"Picker":{"VARIANT":"templates"},"Search":{"LIMITED_SPACE":D.orientation.portrait}},list:{"Variants":{"Values":[{"TEXT":"WALL_LIST_MIT_MY_TEMPLATES","ACTION":"templates","FILTER":"myWallTemplates"},{"TEXT":"WALL_LIST_MIT_SHARED_TEMPLATES","ACTION":"sharedtemplates","FILTER":"sharedWallTemplates"}]}},requestQueue:[],onInit:function(){C.prototype.onInit.apply(this,arguments);var o=this;var u=sap.ui.getCore().getConfiguration();var a=d.getCurrentUser();if(a){u.setLanguage(a.LOCALE);}if(!a){return;}jQuery.each(d.getStylePaths()||[],function(q,S){jQuery.sap.includeStyleSheet(S);});var s=d.getComponentName();if(("sap.ino.ngui."+s)!=gSAPInoAppName){jQuery.sap.registerModulePath(s,"/"+s.replace(/\./g,"/"));}var l=new b({id:this.createId("componentcontainer"),name:s,height:"100%",width:"100%"});var t=this.byId("toolPage");t.addAggregation("mainContents",l);f._rb=sap.ui.getCore().getLibraryResourceBundle("sap.m");this.setViewData(this.view);if(a){var m=new J({"USER_ID":a.USER_ID,"NAME":a.NAME,"IMAGE_ID":a.IDENTITY_IMAGE_ID});m.setDefaultBindingMode("TwoWay");this.getView().setModel(m,"userData");}if(!D.system.desktop&&(D.system.phone||D.system.tablet)){t.mAggregations.mainContents[0].attachBrowserEvent("click",function(){if(t.getSideExpanded()&&!h.sharedInstance().clipboardVisible){t.setSideExpanded(false);}});}D.orientation.attachHandler(this._onOrientationChange,this);var p=this;h.sharedInstance().attachEvent("objectAdded",function(){p.toggleClipboard(true);});this.getPersonalizeSetting();},updateModel:function(){var a=1;},onExit:function(){D.orientation.detachHandler(this._onOrientationChange,this);},onBeforeRendering:function(){var t=this;var o=d.getSystemSetting('sap.ino.config.OPEN_GROUP_FOR_COMMUNITY_USER')*1;t.setModel(new J(o),'identityData>/open_group');if(o){if(!this.requestQueue.length){this.requestQueue.push(this.getMemberGroups());this.requestQueue[0].done(function(a){t.setModel(new J(a),'identityData>/groups');if(!a||!a.length){t.openUserGroupDialog();}});}}},onAfterRendering:function(){var u=d.getTheme();var s=sap.ui.getCore().getConfiguration().getTheme();if(u&&s!==u){sap.ui.getCore().applyTheme(u);}var o=d.getCurrentUser();var S=d.setupCompleted();if(!o||!S){var a=sap.ui.view({viewName:"sap.ino.vc.commons.BootStrapError",type:sap.ui.core.mvc.ViewType.XML});a.placeAt("content","only");return;}var v=this.getView();var l=this.byId("componentcontainer");this._oShell=this.byId("mainShell");this._oComponent=l.getComponentInstance();var t=this._oComponent.getModel("i18n");this.updatePageLanguage(t.getResourceBundle().sLocale);var m="overflow-y: hidden;"+l.$().attr("style");l.$().attr("style",m);this._i18n=this._oComponent.getModel("i18n");v.setModel(this._i18n,"i18n");var p=this._oComponent.getModel("device");v.setModel(p,"device");var q=this._oComponent.getModel("user");v.setModel(q,"user");var r=this._oComponent.getModel("navigation");v.setModel(r,"navigation");var w=this._oComponent.getModel("config");v.setModel(w,"config");var x=this._oComponent.getModel("module");v.setModel(x,"module");var y=this._oComponent.getModel("code");v.setModel(y,"code");var z=this._oComponent.getModel("data");v.setModel(z,"data");var A=this._oComponent.getModel("notifications");v.setModel(A,"notifications");var E=this._oComponent.getModel("search");v.setModel(E,"search");var F=this._oComponent.getModel("clipboard");v.setModel(F,"clipboard");var r=new J(this.menu);this._oSideNavigation=this.byId("sideNavigation");this._oSideNavigation.setModel(r,"navigationList");var K=this._oComponent.getModel("history");v.setModel(K,"history");jQuery(".sapInoInnoMgmtShell #main--split-canvas").before(jQuery(".sapInoInnoMgmtShell #main--split-pane"));this.byId("openMenu").focus();this.setCategroyData();this.listenRouteMatch();},updatePageLanguage:function(l){var a=jQuery("html");if(l&&!a.attr("lang")){l=l.replace("_","-");a.attr("lang",l);}},_onOrientationChange:function(){var v=this.getModel("view");v.setProperty("/Search/LIMITED_SPACE",D.orientation.portrait);},onToggleFullScreen:function(){var a=window.document;var l=a.documentElement;var r=l.requestFullscreen||l.mozRequestFullScreen||l.webkitRequestFullScreen||l.msRequestFullscreen;var m=a.exitFullscreen||a.mozCancelFullScreen||a.webkitExitFullscreen||a.msExitFullscreen;if(!a.fullscreenElement&&!a.mozFullScreenElement&&!a.webkitFullscreenElement&&!a.msFullscreenElement){r.call(l);}else{m.call(a);}},onShowNotification:function(E){if(!this._oNotificationPopover){this._oNotificationPopover=this.createFragment("sap.ino.vc.shell.fragments.Notifications");this.getView().addDependent(this._oNotificationPopover);}if(!this._oNotificationPopover.isOpen()){this.getModel("notifications").updateNotifications();this._oNotificationPopover.openBy(this.byId("notification"));}else{this.closeNotifications();}},closeNotifications:function(){if(this._oNotificationPopover&&this._oNotificationPopover.isOpen()){this._oNotificationPopover.close();}},onRemoveNotification:function(E){var o=E.getSource();var a=o.getParent().getParent();var l=a.data("notification_id");var m=this.getModel("notifications");m.markNotificationAsRead(l).done(function(){m.updateNotifications();});},onRemoveAllNotifications:function(E){var o=E.getSource();var a=o.data("latest_notification_id");if(a>0){var l=this.getModel("notifications");l.markNotificationsAsRead(a);}this.closeNotifications();},onNotificationNavigate:function(E){var o=E.getSource();var t=o.data("object_type_code");var s=o.data("object_id");var a=o.data("notification_code");if(D.system.phone){this._oNotificationPopover.close();}if(a==="IDEA_DELETED"){return null;}switch(t){case"IDEA":if(a==="COMMENT_CREATED"||a==="COMMENT_DELETED"){this.navigateTo("idea-display",{id:s,query:{section:"sectionComments"}});}else if(a==="EXPERT_ASSIGNED"||a==="EXPERT_UNASSIGNED"){this.navigateTo("idea-display",{id:s,query:{section:"sectionExperts"}});}else if(a==="STATUS_ACTION_sap.ino.config.EVAL_SUBMIT"||a==="STATUS_ACTION_sap.ino.config.EVAL_PUB_SUBMITTER"||a==="STATUS_ACTION_sap.ino.config.EVAL_PUB_COMMUNITY"){this.navigateTo("idea-display",{id:s,query:{section:"sectionEvaluations"}});}else{this.navigateTo("idea-display",{id:s});}break;case"CAMPAIGN":this.navigateTo("campaign",{id:s});break;case"REGISTRATION_REQUEST":if(a==='CAMP_REGISTER_CREATED'){this.navigateTo("registerapprovallist");}else{this.navigateTo("campaign",{id:s});}break;case"EVAL_REQUEST_ITEM":this.navigateTo("evaluationrequest-item",{id:s});break;case"EVAL_REQUEST":this.navigateTo("evaluationrequest-display",{id:s});break;default:break;}this.closeNotifications();},showMenu:function(s){if(this._oSplitContainer){if(D.system.phone){this.byId("openMenu").setSelected(s);this.byId("menutoolbar").setProperty("visible",false);this._oSplitContainer.setSecondaryContentSize("100%");}else{this._oSplitContainer.setSecondaryContentSize("250px");}this._oSplitContainer.setShowSecondaryContent(s);}},onShowMenu:function(E){if(h.sharedInstance().clipboardVisible){this.toggleClipboard(false);if(!this._oToolPage){this._oToolPage=this.byId("toolPage");}this._oToolPage.setSideExpanded(!this._oToolPage.getSideExpanded());}else{if(!this._oToolPage){this._oToolPage=this.byId("toolPage");}this._oToolPage.setSideExpanded(!this._oToolPage.getSideExpanded());if(D.system.phone){this._oToolPage.getAggregation('sideContent').setExpanded(this._oToolPage.getSideExpanded());}E.getSource().setTooltip(this._oToolPage.getSideExpanded()?this._i18n.getResourceBundle().getText("SHELL_EXP_MENU_COLLAPSE"):this._i18n.getResourceBundle().getText("SHELL_EXP_MENU_EXPAND"));}},onLogoIcon:function(E){this._oComponent.navigateTo("home");},onNavigate:function(E){var o=E.getSource();var s=o.data("TO");if(s&&s!==""){var a=this.getModel("navigation").getProperty("/Route");if(a!==s){this.getModel("navigation").setProperty("/Route",s);var l=o.getBindingContext("navigationList").getObject().ON_NAV;if(l){l(this,o,s);}else{this._oComponent.navigateTo(s);}}}else{this._oComponent.showMessage(c.Error,this._i18n.getResourceBundle().getText("NAVIGATION_EXP_UNKNOWN_TARGET"));}if(D.system.phone){var t=this.byId("toolPage");t.setSideExpanded(false);}var m=!!o.getBindingContext("navigationList").getObject().KEEP_MENU_OPEN;this.showMenu(m);},onNavFooterPressed:function(E){var o=E.getSource();switch(o.data("ITEM")){case"HELP_CLIPBOARD":this.openHelpScreen("HELP_EXP_CLIPBOARD");break;case"HELP":this.openHelpScreen();break;case"CLIPBOARD":this.toggleClipboard(true);break;default:break;}},onLogout:function(){this._oComponent.logout();},onUserOpen:function(E){var t=this;var o=E.getSource();if(!this._oUserActionSheet){this._oUserActionSheet=sap.ui.xmlfragment("sap.ino.vc.shell.fragments.UserAction",this);this._oUserActionSheet.addStyleClass("sapInoMobileCancel");this._oUserActionSheet.attachAfterClose(function(){if(!t._getUserDataDialog().isOpen()&&!t._getSettingsDialog().isOpen()&&!t._getTermsDialog().isOpen()&&!t._getAboutDialog().isOpen()){o.focus();}},this);this.getView().addDependent(this._oUserActionSheet);}this._oUserActionSheet.openBy(o);},onBackBtnPress:function(){var o=this.getModel("history");var a=o.getProperty("/HashList");var l=a[0];var m=l;var u=location.href.split("#")[0]+"#/"+l.hash;a.shift();o.setProperty("/CurrentHash",m);o.setProperty("/HashList",a);o.setProperty("/Count",a.length);this._oComponent.navigateToByURL(u);},onBackMenuPress:function(E){var s=E.getSource();var a=s.getBindingContext("history").getProperty("hash");var u=location.href.split("#")[0]+"#/"+a;var o=this.getModel("history");var l=o.getProperty("/HashList");var m=s.getBindingContext("history").sPath.split("/");var p=Number(m[m.length-1]);var q=l[p];l=l.slice(p+1);o.setProperty("/CurrentHash",q);o.setProperty("/HashList",l);o.setProperty("/Count",l.length);this._oComponent.navigateToByURL(u);},onBackMenuOpen:function(E){var o=E.getSource();var a=$(o.getDomRef()).next("a");if(this.getOwnerComponent().getModel("historyDetail").getProperty("/HashList").length>10000){var l=this.getOwnerComponent().getModel("historyDetail").getProperty("/HashList");var u=jQuery.extend([],this.getModel("history").getProperty("/HashList"));u.push(this.getModel("history").getProperty("/CurrentHash"));var m=[];l.forEach(function(p,q){if(u.find(function(r,q){return r.hash===p.hash;})){m.push(p);}});this.getOwnerComponent().getModel("historyDetail").setProperty("/HashList",m);}if(!this._oBackActionSheet){this._oBackActionSheet=sap.ui.xmlfragment("sap.ino.vc.shell.fragments.BackAction",this);this._oBackActionSheet.addStyleClass("sapInoMobileCancel sapUiBackActionSheet");this.getView().addDependent(this._oBackActionSheet);}this._oBackActionSheet.attachAfterClose(function(){a.focus();o._toggleIcon(a,"sap-icon://slim-arrow-down");},this);this._oBackActionSheet.openBy(a);},_getUserDataDialog:function(){var t=this;if(!this._oUserDataDialog){this._oUserDataDialog=sap.ui.xmlfragment("sap.ino.vc.shell.fragments.UserDataDialog",this);this.getView().addDependent(this._oUserDataDialog);if(!D.system.phone){this._oUserDataDialog.getContent()[0].addStyleClass("sapUiSmallMargin sapInoUserDataDialog");}var a=t._oComponent.getCurrentUserId();t._oIdentityModel=new J();if(d.getUserProfileByTextURL(a)){t._oIdentityModel.loadData(d.getUserProfileByTextURL(a),{"USER_ID":a},true,"GET");t._oIdentityModel.attachRequestCompleted(null,function(){var l=t._oIdentityModel.getData();l['open_group']=d.getSystemSetting('sap.ino.config.OPEN_GROUP_FOR_COMMUNITY_USER')*1;t._oIdentityModel.setData(l);t._oUserDataDialog.setModel(t._oIdentityModel,"identityData");if(sap.ui.getCore().byId("identityLogList")){sap.ui.getCore().byId("identityLogList").bindItems({path:"data>/Identity("+a+")/IdentityLog",sorter:new sap.ui.model.Sorter("CHANGED_AT",true),template:this.getFragment("sap.ino.vc.iam.fragments.IdentityLogTemplate")});}},t);}this._oUserDataDialog.attachAfterClose(function(){t._oShell.getUser().focus();});}return this._oUserDataDialog;},onUserData:function(){var t=this;var o=t._getUserDataDialog();jQuery.sap.delayedCall(0,this,function(){o.open();if(this.byId("changeHistoryLog")){this.byId("changeHistoryLog").bindItems({path:"data>/Identity("+t._oComponent.getCurrentUserId()+")/IdentityLog/Results"});}this.getMemberGroups().done(function(a){t.setModel(new J(a),'identityData>/groups');});});},onUserDataClose:function(){var a=this._getUserDataDialog();a.close();},openHelpPressed:function(){this.openHelpScreen();},openHelpScreen:function(t){this._oComponent.getRootController().openHelpScreen(t);},toggleClipboard:function(s){var S=this.byId("sideNavigation");var t=this.byId("toolPage");if(!this._oClipboardFragment){this._oNavigationFragment=S.getItem();this._oNavigationFooterFragment=S.getFixedItem();this._oClipboardFragment=sap.ui.xmlfragment("sap.ino.vc.shell.fragments.Clipboard",this);this._oClipboardFooterFragment=sap.ui.xmlfragment("sap.ino.vc.shell.fragments.ClipboardFooter",this);}if(s){S.setItem(this._oClipboardFragment);S.setFixedItem(this._oClipboardFooterFragment);if(!t.getSideExpanded()){t.setSideExpanded(true);}h.sharedInstance().clipboardOpened();}else{S.setItem(this._oNavigationFragment);S.setFixedItem(this._oNavigationFooterFragment);if(t.getSideExpanded()){t.setSideExpanded(false);}h.sharedInstance().clipboardClosed();}},onCloseClipboard:function(){var t=this.byId("toolPage");t.setSideExpanded(false);this.toggleClipboard(false);},onRemoveAllClipboardObjects:function(){h.sharedInstance().remove();},onRemoveClipboardObject:function(E){var s=E.getSource();var o=s.data("OBJECT_NAME");var K=s.data("OBJECT_KEY");var a=h.loadObject(o);h.sharedInstance().remove(a,K);},onOpenClipboardObject:function(E){var s=E.getSource();var o=s.data("OBJECT_NAME");var K=s.data("OBJECT_KEY");switch(o){case"sap.ino.commons.models.object.Idea":this.navigateTo("idea-display",{id:K});break;case"sap.ino.commons.models.object.User":if(!this.oIdentityCardView||this.oIdentityCardView.getController()===null){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});s.addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(s,K);break;default:break;}},_getSettingsDialog:function(){var t=this;if(!this._oSettingsDialog){this._oSettingsController=sap.ui.controller("sap.ino.vc.shell.Settings");var u=this.getView()&&this.getView().getModel("userData");if(u&&this._oSettingsController.setUserDataModel){this._oSettingsController.setUserDataModel(u);}this._oSettingsView=sap.ui.view({type:V.XML,viewName:"sap.ino.vc.shell.Settings",controller:this._oSettingsController});this._oSettingsDialog=sap.ui.xmlfragment("sap.ino.vc.shell.fragments.SettingsDialog",this);this.getView().addDependent(this._oSettingsDialog);this._oSettingsDialog.addContent(this._oSettingsView);this._oSettingsDialog.attachAfterClose(function(){t._oShell.getUser().focus();});}return this._oSettingsDialog;},onSettings:function(){this._getSettingsDialog().open();},_cropImage:function(o){var t=this;var a=jQuery.Deferred();var F=o.crop();if(F){jQuery.sap.require("sap.ino.commons.models.object.Attachment");var A=sap.ino.commons.models.object.Attachment;A.uploadFile(F).done(function(r){var l=t._oSettingsController.getObjectModel();l.setUserImage({"ATTACHMENT_ID":r.attachmentId,"FILE_NAME":r.fileName,"MEDIA_TYPE":r.mediaType});a.resolve({messages:[{"TYPE":"I","MESSAGE":"SETTINGS_MSG_USER_IMAGE_CROP","MESSAGE_TEXT":t.getText("SETTINGS_MSG_USER_IMAGE_CROP"),"REF_FIELD":""}]});}).fail(function(){g.show(t.getText("SETTINGS_MSG_USER_IMAGE_CROP_FAILED"));a.reject();});}else{a.resolve();}return a.promise();},_openRestartDialog:function(){var m=this.getText("SETTINGS_RESTART_MESSAGE");var t=this.getText("SETTINGS_RESTART_TITLE");var r=function(a){if(a===f.Action.YES){location.reload();}};f.confirm(m,{icon:f.Icon.ERROR,title:t,actions:[f.Action.YES,f.Action.NO],onClose:r,styleClass:"sapUiSizeCompact"});},onSettingsOk:function(){throw new Error("obsolete method.");var t=this;var _=function(){var v=t._oSettingsView;var a=t._oSettingsController.getObjectModel();var l=v.byId("settingLOCALE");var m=v.byId("settingMAIL");var p=v.byId("settingHCB");var s=p.getSelected()?k.Theme.HCB:"";t._sHCBPropOLD=a._oBeforeData.Settings.THEME;t._sHCBPropOLD=(t._sHCBPropOLD===null)?"":t._sHCBPropOLD;t._sLocalePropOLD=a._oBeforeData.Settings.LOCALE;t._sLocalePropOLD=(t._sLocalePropOLD===null)?"":t._sLocalePropOLD;var r=a.updateUserSettings([{SECTION:"locale",KEY:"locale",VALUE:l.getSelectedKey()},{SECTION:"notification",KEY:"mail",VALUE:m&&m.getSelected()?k.Mail.Active:k.Mail.Inactive},{SECTION:"ui",KEY:"theme",VALUE:s}]);a.modify();r.always(function(){var q=a.getProperty("/Settings/THEME");q=(q===null)?"":q;var L=a.getProperty("/Settings/LOCALE");L=(L===null)?"":L;var R=(L!==t._sLocalePropOLD)||(q!==t._sHCBPropOLD);if(R){t._openRestartDialog();}});r.done(function(){d.refreshBackendConfiguration();});};var o=this._oSettingsView.byId("imageSettingCropping");this._cropImage(o).done(_);},onSettingsCancel:function(){this._getSettingsDialog().close();},_getTermsDialog:function(){var t=this;if(!this._oTermsDialog){this._oTermsDialog=this.getTermsDialog(this);d.getUserModel().setProperty("/data/TERMACTION",false);d.getUserModel().setProperty("/data/USER_ACCEPTED",1);this._oTermsDialog.attachAfterClose(function(){t._oShell.getUser().focus();});}return this._oTermsDialog;},onTermsConditions:function(){this._getTermsDialog().open();},_getAboutDialog:function(){var t=this;if(!this._oAboutDialog){this._oAboutDialog=sap.ui.xmlfragment("sap.ino.vc.shell.fragments.AboutDialog",this);this.getView().addDependent(this._oAboutDialog);this._oAboutDialog.attachAfterClose(function(){t._oShell.getUser().focus();});}return this._oAboutDialog;},onAbout:function(){this._getAboutDialog().open();},onAboutClose:function(){this._getAboutDialog().close();},selectGroupTab:function(a){var s=this;var p=a.getParameters();if(p.selectedKey==='userDataGroupPage'){var l=this._bindUserGroupModel();var t=p.selectedItem.getContent()[0];t.getBinding('rows').filter([]);l.attachRequestCompleted(function(){s.reBindSelectedData(t);});}},_getUserGroupDialog:function(){if(!this._userGroupDialog){this._userGroupDialog=sap.ui.xmlfragment('sap.ino.vc.shell.fragments.UserGroupDialog',this);this._bindUserGroupModel(this._userGroupDialog);this.getView().addDependent(this._userGroupDialog);}return this._userGroupDialog;},openUserGroupDialog:function(){var a=this._getUserGroupDialog();return a.open();},onSubmitSelectedGroups:function(){var s=this;var a=this.putGroupSelected(this._getUserGroupDialog().getContent()[0],true);if(a){a.done(function(){g.show(s.getText('USER_GROUP_SELECT_SUCCESS'));s._getUserGroupDialog().close();});}},onPersonalize:function(){var s=this;var a=d.getPersonalize();s.getView().setModel(new J(a),'PERSONALIZE');return this._getPersonalizeDialog().open();},closePersonalize:function(){return this._getPersonalizeDialog().close();},_getPersonalizeDialog:function(){if(!this._personalizeDialog){this._personalizeDialog=sap.ui.xmlfragment('sap.ino.vc.shell.fragments.Personalize',this);this.getView().addDependent(this._personalizeDialog);}return this._personalizeDialog;},getPersonalizeSetting:function(){var a=P.defaultPesonalize;return $.extend(a,d.getPersonalize());},personalizeSave:function(){var s=this;var p=s.getView().getModel('PERSONALIZE');var a=p.getData();P.updateSettings({personalize:a}).done(function(){g.show(s.getText("PERSONALIZE_CHANGE_SUCCESS"));s.getView().setModel(new J(a),'PERSONALIZE');s._getPersonalizeDialog().close();});},onPersonalSetting:function(){this.navigateTo('mySetting');},formatterLatestNotificationId:function(a){if(a&&a.length>0){return a.sort(function(p,o){return o.ID-p.ID;})[0].ID;}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.tag.List.controller')){jQuery.sap.declare('sap.ino.vc.tag.List.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/tag/List.controller",["sap/ino/vc/commons/BaseVariantListController","sap/ui/Device","sap/ino/commons/formatters/ObjectListFormatter","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/commons/application/Configuration","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/controls/OrientationType","sap/m/MessageToast","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/commons/mixins/TagCardMixin"],function(B,D,O,S,J,F,a,C,T,b,M,c,d){"use strict";var o={ASC:"ASC",DESC:"DESC"};var s={NAME:"NAME"};var v={ALL:"all",OTHER:"other"};var f={NONE:undefined};var l={NAME:"TAG_LIST_TIT_NAME",ADJUSTMENT_TITLE:"TAG_LIST_TIT_ADJUSTMENT",Filter:{},Sorter:{Values:[{TEXT:"SORT_MIT_NAME",ACTION:s.NAME,DEFAULT_ORDER:o.ASC}]},Order:{Values:[{TEXT:"ORDER_MIT_ASC",ACTION:o.ASC},{TEXT:"ORDER_MIT_DESC",ACTION:o.DESC}]},Variants:{DEFAULT_VARIANT:v.ALL,TITLE:"TAG_LIST_TIT_VARIANTS",Values:[{TEXT:"TAG_LIST_MIT_TAGS",NAME:"TAG_LIST_MIT_TAGS",ACTION:v.ALL,FILTER:f.NONE,DEFAULT_SORT:s.NAME,VISIBLE:true}]}};var L={TAG:"taglist",TAG_VARIANT:"taglistvariant"};var t=B.extend("sap.ino.vc.tag.List",jQuery.extend({},T,c,d,{routes:["taglist","taglistvariant"],initialFocus:"mainFilterButton",list:l,view:{"List":{"SORT":s.NAME,"ORDER":undefined,"VARIANT":v.ALL,"Default":{"SORT":s.NAME,"ORDER":undefined,"VARIANT":v.ALL}},"ORIENTATION":b.PORTRAIT,"DISABLE_ORIENTATION":true},onInit:function(){B.prototype.onInit.apply(this,arguments);this.oViewModel=this.getModel("view")||new J({});this.oViewModel.setData(this.view,true);},onRouteMatched:function(e,g){this.bindVariants();var V=this.getModel("view");V.setData(this.view,true);var q;var h;var i=this.getListProperty("/Variants/DEFAULT_VARIANT");if(e&&e.getParameter){var A=e.getParameter("arguments");this._sRoute=e.getParameter("name");q=A["?query"];h=A.variant;}else{this._sRoute=e;q=g;h=g.variant;}this.setViewProperty("/List/VARIANT",h||i);h=this.getViewProperty("/List/VARIANT");var j;var k=this.getVariant(h)||V.getProperty("/List/CURRENTVAR");if(!k){k={ACTION:h,DEFAULT_SORT:"NAME"};}var m=this.getList().isBound("items");if(!q||!q.sort){var n=k.DEFAULT_SORT;var p=this.getSort(n)[0].DEFAULT_ORDER;q=q||{};q.sort=q.sort||n;q.sort=q.sort+" "+(q.order||p);}var r=this.hasStateChanged(this._sRoute,h,q,D.orientation.portrait);if(!m||r){this.setParameters(q,k);j=this.getSort(this.getViewProperty("/List/SORT"));this.setSorter(j);this.updateFilter();this.setSortIcon(this.byId("panelFilterFragment--sortreverse"),this.getViewProperty("/List/ORDER"));this.bindList(q);this.initialSorterItems();}this._bInnerViewNavigation=true;this.setHelp("TAG_LIST");},bindList:function(q){this.saveState();this.setPath("data>/"+this.getBindingPath(q));B.prototype.bindList.apply(this);},bindVariants:function(){var p=C.getBackendRootURL()+"/sap/ino/xs/rest/common/tagGroupQuery.xsjs";var e=new J(p);var V=this.getDefaultVariantValue();var g=this;e.attachRequestCompleted(null,function(){var h=e.getData();if(h.length>0){h.push({TEXT:"TAG_LIST_MIT_OTHER",NAME:"TAG_LIST_MIT_OTHER",ACTION:v.OTHER,FILTER:f.NONE,DEFAULT_SORT:s.NAME,HIERARCHY_LEVEL:"1",VISIBLE:true});}h=V.concat(h);g.getModel("list").setProperty("/Variants/Values",h);},e);},getList:function(){return this.byId("objectlist");},getItemTemplate:function(){return this.getFragment("sap.ino.vc.tag.fragments.CardListItem");},getBindingPath:function(q){var e=q&&q.search||"";if(this.getFilter().length===0){return"SearchTagsAllParams(searchToken='"+e+"')/Results";}else{return"SearchTagsAllFullParams(searchToken='"+e+"')/Results";}},updateFilter:function(){var e=[];this.setFilter([]);var V=this.getViewProperty("/List/VARIANT");if(V===v.ALL){return;}else if(V===v.OTHER){var g=this.getModel("list").getProperty("/Variants/Values");jQuery.each(g,function(i,h){if(h.ACTION!==v.ALL&&h.ACTION!==v.OTHER){e.push(new F("GROUP_ID",a.NE,h.ACTION));}});}else{e.push(new F("GROUP_ID",a.EQ,this.getViewProperty("/List/VARIANT")));}this.addFilter(new F({filters:e,and:true}));},setParameters:function(q,V){B.prototype.setParameters.apply(this,arguments);},getDefaultVariantValue:function(){return[{TEXT:"TAG_LIST_MIT_TAGS",ACTION:v.ALL,NAME:"TAG_LIST_MIT_TAGS",FILTER:f.NONE,DEFAULT_SORT:s.NAME,VISIBLE:true}];},follow:function(){M.show("test");}}));t.list=l;t.listContext=L;return t;});};if(!jQuery.sap.isDeclared('sap.ino.vc.analytics.List.controller')){jQuery.sap.declare('sap.ino.vc.analytics.List.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.odata.ODataModel');jQuery.sap.require('sap.ui.model.odata.v4.ODataModel');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.suite.ui.microchart.ColumnMicroChart');jQuery.sap.require('sap.suite.ui.microchart.AreaMicroChart');jQuery.sap.require('sap.suite.ui.microchart.ComparisonMicroChart');jQuery.sap.require('sap.suite.ui.microchart.HarveyBallMicroChart');jQuery.sap.require('sap.suite.ui.microchart.RadialMicroChart');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.core.HTML');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/ino/vc/analytics/List.controller",["sap/ui/Device","sap/ino/vc/commons/BaseVariantListController","sap/ui/model/Sorter","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/model/odata/ODataModel","sap/ui/model/odata/v4/ODataModel","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Report","sap/ino/commons/util/ReportUtil","sap/ui/model/Filter","sap/ino/commons/application/Configuration","sap/suite/ui/microchart/ColumnMicroChart","sap/suite/ui/microchart/AreaMicroChart","sap/suite/ui/microchart/ComparisonMicroChart","sap/suite/ui/microchart/HarveyBallMicroChart","sap/suite/ui/microchart/RadialMicroChart","sap/ino/commons/models/core/CodeModel","sap/m/MessageBox","sap/ui/core/HTML","sap/m/Text","sap/m/MessageToast","sap/ino/commons/models/object/Attachment"],function(D,B,S,O,T,a,V,J,R,b,F,C,d,A,e,H,f,g,M,h,j,k,l){"use strict";var m={IDENTITY_ID:"IDENTITY_ID"};var v={MY:"my",STANDARD:"standard",CUSTOM_REPORTS:"customReports"};var p={MY:"data>/MyReports",STANDARD:"data>/ReportTemplates"};var n={bar:"Comparison",column:"Column",line:"Area",pie:"HarveyBall",donut:"Radial",heatmap:"Column",bullet:"Comparison",barstacked:"Comparison",columnstacked:"Column",barstacked100:"Comparison",columnstacked100:"Column",waterfall:"Column",combination:"Column",scatter:"Area",bubble:"Area",combinationstacked:"Column",bardual:"Comparison",columndual:"Column",linedual:"Area",barstackeddual:"Comparison",columnstackeddual:"Column",combinationstackeddual:"Column",barstackeddual100:"Comparison",columnstackeddual100:"Column",lastmonthschart:"Column",processindicator:"Column",piechart:"HarveyBall",toplist:"Comparison",currentmonthlist:"Comparison"};var o=["Good","Neutral","Critical","Error"];var L={ADJUSTMENT_TITLE:"ANALYTICS_LIST_TIT_ADJUSTMENT",Variants:{DEFAULT_VARIANT:v.MY,TITLE:"ANALYTICS_LIST_TIT_VARIANTS",Values:[{TEXT:"ANALYTIC_MY_REPORT_LIST",ACTION:v.MY,FILTER:m.IDENTITY_ID,FILTER_VALUE:C.getCurrentUser(true).USER_ID,PATH:p.MY,VISIBLE:true},{TEXT:"ANALYTIC_STANDARD_REPORT_LIST",ACTION:v.STANDARD,PATH:p.STANDARD,VISIBLE:true},{TEXT:C.getCustomReportsTile(),ACTION:v.CUSTOM_REPORTS,VISIBLE:C.getCustomReportsEnable()}]}};var q={formatterReportText:function(t,s){if(s===v.CUSTOM_REPORTS){return t;}else{return this.getText(t);}return"";},visibleCreateBtn:function(c){return c;},formatNoDataVisible:function(c,E){return!c&&!E;},visibleEditRichtext:function(E,c){return!!E&&c;},visibleOperationBox:function(i,s){return i&&(s===v.CUSTOM_REPORTS);},visibleSaveActionsBtn:function(E,c,s){return!!E&&c&&(s===v.CUSTOM_REPORTS);}};jQuery.extend(q,O);return B.extend("sap.ino.vc.analytics.List",jQuery.extend({},T,{routes:["reportlist","reportlistvariant"],list:L,initialFocus:"filterButton",view:{"List":{"VARIANT":v.MY,"CAMPAIGN":undefined,"TAGCLOUD":false}},formatter:q,onInit:function(){B.prototype.onInit.apply(this,arguments);sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.getCore().loadLibrary("sap.ui.comp");sap.ui.getCore().loadLibrary("sap.chart");sap.ui.getCore().loadLibrary("sap.viz");var s=C.getBackendRootURL()+"/"+C.getApplicationPath("sap.ino.config.URL_PATH_OD_ANALYTICS");this.oDataModel=new a(s);var c=this.getModel("view");c.setData(this.view,true);},onRouteMatched:function(E,c){var i=this.getModel("user").getProperty("/privileges")["sap.ino.ui::backoffice.access"];if(!i){this.navigateTo("home");return;}var s;var Q;if(E&&E.getParameter){var r=E.getParameter("arguments");this._sRoute=E.getParameter("name");Q=r["?query"];s=r.variant;}else{this._sRoute=E;Q=c;s=c.variant;}var t=this.getListProperty("/Variants/DEFAULT_VARIANT");var u=this.getVariant(s);var w=this.getList().isBound("items");var x=this.hasStateChanged(this._sRoute,s,Q);this.constructCustomReportsInfo(s);if(!w||x){u=u||this.getVariant(t);this.setParameters(Q,u);this.bindList();}this.setHelp("REPORT_LIST");},onBeforeHide:function(){this._bFullscreenReset=true;this.setFullScreen(this._bPreviouslyFullscreen);},onAfterShow:function(){if(this.byId("sapInoPanelAnalytics")&&this.byId("sapInoPanelAnalytics").getDomRef()&&this.byId("sapInoPanelAnalytics").getDomRef().querySelector(".sapMPanelContent")){var c=this.byId("sapInoPanelAnalytics").getDomRef();var s=c.querySelector(".sapMPanelContent").style.height;if(s==="0px"||s==="100%"){var t=jQuery(c.querySelector(".sapInoHomeTitledPanelNav"));c.querySelector(".sapMPanelContent").style.height=(jQuery(c).height()-t.height()-parseInt(t.css("padding-top"),10)-parseInt(t.css("padding-bottom"),10))+"px";}}},setParameters:function(Q,c){Q=Q||{};var i=Q.campaign;this.setViewProperty("/List/VARIANT",c.ACTION);this.setViewProperty("/List/CAMPAIGN",i);},getList:function(){return this.byId("reportlist");},bindList:function(){var t=this;if(this.getViewProperty("/List/VARIANT")===v.CUSTOM_REPORTS){}else if(this.getViewProperty("/List/CAMPAIGN")&&this.getViewProperty("/List/VARIANT")==="standard"){this.getModel("data").read("/CampaignSmall("+this.getViewProperty("/List/CAMPAIGN")+")",{success:function(c){t.bindItems(c);}});}else{this.bindItems();}},bindItems:function(c){var t=this;var i=this.getCurrentVariant();var r=[];if(i.FILTER&&i.FILTER_VALUE){r=[new F(i.FILTER,"EQ",i.FILTER_VALUE)];}if(i.ACTION===v.MY&&this.getViewProperty("/List/CAMPAIGN")){r.push(new F("CAMPAIGN_ID","EQ",this.getViewProperty("/List/CAMPAIGN")));}if(!C.isComponentActive('sap.ino.config.USAGE_REPORTING_ACTIVE')){var u=new sap.ui.model.Filter("IS_USAGE_REPORT",sap.ui.model.FilterOperator.NE,1);r.push(u);}var s=this.getList();var G=sap.ino.commons.models.core.CodeModel.getFormatter("sap.ino.xs.object.analytics.ReportTemplate.Root");s.bindItems({path:i.PATH,filters:r,factory:function(I,w){var x={DELETE_BUTTON_VISIBLE:true,CHART_VISIBLE:true};var y=t.createFragment("sap.ino.vc.analytics.fragments.CardListItem",I);var z=w.getObject();var E;if(typeof(z.CONFIG)==='string'){E=JSON.parse(z.CONFIG);}else{E=JSON.parse(JSON.stringify(z.CONFIG));}x.TITLE=E.Title||G(z.CODE);x.CAMPAIGN_NAME=z.CAMPAIGN_NAME||(c&&c.SHORT_NAME)||t.getText("ANALYTICS_LIST_CROSS_CAMPAIGN");var K=z.CAMPAIGN_COLOR||(c&&c.COLOR_CODE);if(K&&K.length===6){K="background-color: #"+K;}x.CAMPAIGN_COLOR="<div style=\"height: 4px; width: 200px; "+K+" \" />";if(t.getViewProperty("/List/VARIANT")===v.STANDARD){x.DELETE_BUTTON_VISIBLE=false;}if(c&&E.Parameters&&E.Parameters.Campaign){E.Parameters.Campaign.Selection=[c.ID];}if(!b.checkMandatoryParameters(E)){x.CHART_VISIBLE=false;x.UNIT=t.getText("ANALYTICS_LIST_MISSING_PARAMETER");}else{var N=jQuery.extend({},E.Views[E.SelectedView],E.Tile);N.Chart.Type=n[(N.Content||N.Chart.Type.split("/")[1]).toLowerCase()];var P=t.getReadParameter(E,N);var Q=N.Unit||N.Tile.Unit;x.UNIT=Q?t.getText(Q):undefined;P.success=function(U){var W=t.createChart(N);W.setTooltip(t.createChartTooltip(U.results,N));t.addChartItems(W,U.results,N);if(y.getContent().length>0){var X=y.getContent()[0].getItems()[2].getItems()[1];X.removeAllItems();X.addItem(W);}};t.oDataModel.read("/"+E.DataSource,P);}y.setModel(new J(x),"tile");return y;},events:{dataRequested:function(){jQuery.each(t.getBusyControls(),function(I,w){if(jQuery.type(w.setBusy)==="function"){w.setBusy(true);}});},dataReceived:function(){jQuery.each(t.getBusyControls(),function(I,w){if(jQuery.type(w.setBusy)==="function"){w.setBusy(false);}});}}});},onDelete:function(E){var c=this.getList();var i=E.getSource().getParent().getParent().getParent();var r=/(.+)?(?:\(|ï¼ˆ)(.+)(?=\)|ï¼‰)/.exec(i.getBindingContext("data").sPath)[2];var s=parseInt(r,0);var t=this.getView();M.confirm(this.getText("MSG_DEL_CONFIRM"),{onClose:function(u){if(u!==M.Action.OK){return;}else{t.setBusy(true);var w=R.del(s);w.always(function(){t.setBusy(false);});w.done(function(){c.removeItem(i);});w.fail(function(){});}}});},onItemPress:function(E){var i=E.getSource();var c=i.getBindingContext("data");var P=c.sPath.substr(1);this.navigateTo("report",{code:P});},initFullScreen:function(){if(this._bFullscreenReset===undefined||this._bFullscreenReset===true){this._bPreviouslyFullscreen=this.getFullScreen();}this.setFullScreen(true);this._bFullscreenReset=false;},getReadParameter:function(c,t){var r;if(t.Sorter){r=[new S({path:t.Sorter.Path,descending:t.Sorter.Descending})];}var s;if(t.Dimension&&t.Dimension[0]){s=[t.Dimension,t.Dimensions[0]];}else if(t.Dimensions&&t.Dimensions[0]){s=[t.Dimensions[0]];}if(t.Sorter&&s[0]!==t.Sorter.Path){s.push(t.Sorter.Path);}if(t.Measure&&t.Measure[0]){s.push(t.Measure,t.Measures[0]);}else if(t.Measures&&t.Measures[0]){s.push(t.Measures[0]);}var u=[];for(var i=0;i<s.length;i++){if(s[i]){u.push(s[i]);}}s=u;return{async:true,sorters:r,urlParameters:{"$select":s.join(","),"$top":t.Top||5}};},createChart:function(t){var c;var i={"size":"S","tooltip":this.getText("ANALYTICS_LIST_MISSING_PARAMETER")};switch(t.Chart.Type){case"Area":c=new A(i);break;case"Comparison":c=new e(i);break;case"HarveyBall":c=new H(jQuery.extend(i,{total:100,totalScale:" ",showFractions:true}));break;case"Radial":c=new f(i);break;default:c=new d(i);break;}c.addStyleClass("sapUiSmallMargin");c.addStyleClass("sapUiMediumMarginBegin");c.addStyleClass("sapInoAnalyticsDefaultChart");return c;},addChartItems:function(c,i,t){var s=t.Chart.Type;var r=t.Dimension||t.Dimensions[0];var u=t.Measure||t.Measures[0];switch(s){case"Column":jQuery.each(i,function(I,E){c.addColumn(new sap.suite.ui.microchart.ColumnMicroChartData({color:o[I%4],label:E[r],value:E[u]}));});break;case"Area":var w=new sap.suite.ui.microchart.AreaMicroChartItem({color:"Good"});var x=100/i.length;jQuery.each(i,function(I,E){w.addPoint(new sap.suite.ui.microchart.AreaMicroChartPoint({x:x*I,y:E[u]}));});c.addLine(w);break;case"Comparison":jQuery.each(i,function(I,E){c.addData(new sap.suite.ui.microchart.ComparisonMicroChartData({color:o[I%4],title:E[r],value:E[u]}));});break;case"HarveyBall":var y=0;jQuery.each(i,function(I,E){c.addItem(new sap.suite.ui.microchart.HarveyBallMicroChartItem({color:"Good",fractionLabel:E[r],fraction:E[u],fractionScale:" "}));y+=E[u];});if(y){c.setTotal(y);}break;case"Radial":var z=0;jQuery.each(i,function(I,E){z+=E[u];});c.setTotal(z);c.setFraction(i[0][u]);c.setValueColor("Good");break;default:jQuery.each(i,function(I,E){c.addColumn(new sap.suite.ui.microchart.ColumnMicroChartData({color:o[I%4],label:E[r],value:E[u]}));});break;}},createChartTooltip:function(c,i){var t="";jQuery.each(c,function(I,r){t+=r[i.Dimension||i.Dimensions[0]]+" "+(r[i.Measure||i.Measures[0]]||0);t+=(I!==c.length)?"\n":"";});return t;},getQuery:function(){var Q={};var c=this.getViewProperty("/List/CAMPAIGN");if(c){Q.campaign=c;}return Q;},onVariantPress:function(s){var Q=this.getQuery();this.removeInvalidFilters(Q);if(s){this.navigateTo(this.getRoute(true),{variant:s,query:Q},true,true);}else{this.navigateTo(this.getRoute(false),{query:Q},true,true);}},constructCustomReportsInfo:function(s){var i=this.getModel("user").getProperty("/privileges/sap.ino.xs.rest.admin.application::execute");var c=this.getModel("user").getProperty("/privileges/sap.ino.ui::backoffice.access");this.getView().getModel("list").setProperty("/IS_INN_MGR",i);this.getView().getModel("list").setProperty("/BACKOFFICE_ACCESSABLE",c);this.getView().getModel("list").setProperty("/CURRENT_ACTION_SELECTED",s);if(!s){this.getView().getModel("list").setProperty("/CURRENT_ACTION_SELECTED",v.MY);}if(!this.getView().getModel("customReport")){var r=new J();this.getView().setModel(r,'customReport');}if(s===v.CUSTOM_REPORTS){if(!C.getCustomReportsEnable()){this.navigateTo(this.getRoute(true),{variant:v.MY,query:{}},true,true);}this.getXCSRFTOKEN();this.byId("reportlist").setVisible(false);this.byId('customReports').setVisible(true);this.getCustomReportsInfo();}else{this.byId('customReports').setVisible(false);this.byId("reportlist").setVisible(true);}},getCustomReportsInfo:function(){var r=this.byId('customReports');r.removeAllItems();r.destroyItems();var t=this;var c=sap.ui.xmlfragment({id:t.getView().getId(),fragmentName:"sap.ino.vc.analytics.fragments.CustomReportRichTxt"},t);c.attachReady(function(){this.bindProperty("value",{path:'customReport>/content'});});r.addItem(c);var i=new h({sanitizeContent:true,preferDOM:false,visible:{parts:['customReport>/hasContent','customReport>/EDIT_STATUS','list>/BACKOFFICE_ACCESSABLE'],formatter:function(x,E,y){return x&&!E&&y;},type:null},content:{model:"customReport",path:'/content',formatter:t.formatter.wrapHTML}});r.addItem(i);var s=new j({text:this.getText("ANALYITCS_CUSTOM_REPORTS_TEXT_NO_DATA"),visible:{parts:['customReport>/hasContent','customReport>/EDIT_STATUS'],formatter:function(x,E){return!x&&!E;},type:null}});r.addItem(s);var u={"ACTION":"QUERY"};var U=C.getBackendRootURL()+"/sap/ino/xs/rest/backoffice/customReports.xsjs";var w=jQuery.ajax({url:U,headers:{"X-CSRF-Token":t._xCSRFToken},data:JSON.stringify(u),type:"POST",contentType:"application/json; charset=UTF-8",async:false});w.done(function(x,y){var z=t.getView().getModel("customReport");z.setData(x.data);z.setProperty("/old_content",z.getProperty("/content"));z.setProperty("/EDIT_STATUS",false);if(z.getProperty("/hasContent")){z.setProperty("/CAN_CREATE",false);z.setProperty("/CAN_DELETE",true);z.setProperty("/CAN_MODIFY",true);}else{z.setProperty("/CAN_CREATE",true);z.setProperty("/CAN_DELETE",false);z.setProperty("/CAN_MODIFY",false);}});},beforeEditorInit:function(c){c.mParameters.configuration.paste_data_images=true;c.mParameters.configuration.automatic_uploads=true;c.mParameters.configuration.powerpaste_word_import="clean";c.mParameters.configuration.powerpaste_html_import="clean";c.mParameters.configuration.images_upload_handler=function(i,s,r){var t=i.blob();var u="CUSTOM_REPORT";if(t){l.uploadFileIncludeFileLabel(t,u).done(function(w){s(C.getAttachmentDownloadURL(w.attachmentId));}).fail(function(){r();});}};c.mParameters.configuration.paste_postprocess=function(i,r){window.tinymce.activeEditor.uploadImages();};},getXCSRFTOKEN:function(){var t=this;var P=window.location.protocol+'//'+window.location.host+"/sap/ino/xs/rest/common/ping.xsjs";var c=jQuery.ajax({url:P,headers:{"X-CSRF-Token":"Fetch"},type:"GET",contentType:"application/json; charset=UTF-8",async:false});c.done(function(r,s,i){t._xCSRFToken=i.getResponseHeader("X-CSRF-Token");});},onCreateCustomReportStyle:function(){var c=this.getView().getModel("customReport");c.setProperty("/CAN_CREATE",false);c.setProperty("/ACTION","CREATE");c.setProperty("/EDIT_STATUS",true);},onModifyCustomReportStyle:function(){var c=this.getView().getModel("customReport");c.setProperty("/CAN_MODIFY",false);c.setProperty("/ACTION","UPDATE");c.setProperty("/EDIT_STATUS",true);},onDeleteCustomReportStyle:function(){var c=this.getView().getModel("customReport");c.setProperty("/CAN_DELETE",false);var t=this;var i=function(){var r={"ACTION":"DELETE"};var s=t.byId('customReports');s.setBusy(true);var u=C.getBackendRootURL()+"/sap/ino/xs/rest/backoffice/customReports.xsjs";var w=jQuery.ajax({url:u,headers:{"X-CSRF-Token":t._xCSRFToken},data:JSON.stringify(r),type:"POST",contentType:"application/json; charset=UTF-8",async:false});w.done(function(x){s.setBusy(false);if(x.type==="S"){k.show(t.getText("ANALYITCS_CUSTOM_REPORTS_DELETE_SUCCESSFULLY"));t.constructCustomReportsInfo(v.CUSTOM_REPORTS);}else{c.setProperty("/CAN_DELETE",true);k.show(x.message);}});w.fail(function(x){s.setBusy(false);c.setProperty("/CAN_DELETE",true);k.show(x.responseText);});};M.show(this.getText("ANALYITCS_CUSTOM_REPORTS_DELETE_BOX_MSG"),{title:this.getText("ANALYITCS_CUSTOM_REPORTS_DELETE_BOX_TITLE"),icon:M.Icon.WARNING,actions:[M.Action.YES,M.Action.NO],onClose:function(s){if(s===M.Action.YES){i();c.setProperty("/EDIT_STATUS",false);}else{c.setProperty("/CAN_DELETE",true);}}});},onCustomReportStyleCancel:function(){var c=this.getView().getModel("customReport");var t=this;if(c.getProperty("/old_content")===c.getProperty("/content")){this.constructCustomReportsInfo(v.CUSTOM_REPORTS);}else{M.show(this.getText("ANALYITCS_CUSTOM_REPORTS_CANCEL_BOX_MSG"),{title:this.getText("ANALYITCS_CUSTOM_REPORTS_CANCEL_BOX_TITLE"),icon:M.Icon.WARNING,actions:[M.Action.YES,M.Action.NO],onClose:function(s){if(s===M.Action.YES){c.setProperty("/ACTION",null);t.constructCustomReportsInfo(v.CUSTOM_REPORTS);}}});}},hasPendingChanges:function(){var c=this.getView().getModel("customReport");if(c&&c.getProperty("/old_content")!==c.getProperty("/content")){return true;}return false;},resetPendingChanges:function(){var c=this.getView().getModel("customReport");if(c&&c.getProperty("/old_content")!==c.getProperty("/content")){c.setProperty("/content",c.getProperty("/old_content"));}},cancelOperationAction:function(){var s=this.byId("sapInoCampHomeIdeasButtons");s.setSelectedKey(v.CUSTOM_REPORTS);},onCustomReportStyleSave:function(){var c=this.getView().getModel("customReport");var t=this;var r={"ACTION":c.getProperty("/ACTION"),"CONTENT":c.getProperty("/content")};if(!c.getProperty("/ACTION")){return;}var i=this.byId('customReports');i.setBusy(true);var u=C.getBackendRootURL()+"/sap/ino/xs/rest/backoffice/customReports.xsjs";var s=jQuery.ajax({url:u,headers:{"X-CSRF-Token":t._xCSRFToken},data:JSON.stringify(r),type:"POST",contentType:"application/json; charset=UTF-8",async:false});s.done(function(w,x){i.setBusy(false);if(w.type==="S"){k.show(t.getText("ANALYITCS_CUSTOM_REPORTS_SAVE_SUCCESSFULLY"));t.constructCustomReportsInfo(v.CUSTOM_REPORTS);}else{k.show(w.message);}});s.fail(function(w){i.setBusy(false);k.show(w.responseText);});}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.blog.List.controller')){jQuery.sap.declare('sap.ino.vc.blog.List.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.core.Item');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/blog/List.controller",["sap/ino/vc/commons/BaseVariantListController","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/model/Sorter","sap/ui/core/Item","sap/ino/commons/application/Configuration","sap/ino/commons/models/core/CodeModel","sap/ui/core/mvc/ViewType","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/controls/OrientationType","sap/ino/vc/blog/mixins/DeleteActionMixin","sap/m/MessageToast","sap/m/MessageBox","sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/vc/commons/mixins/TagGroupMixin","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/vc/blog/mixins/BlogCardMixin"],function(B,D,J,S,I,C,a,V,F,b,O,c,d,M,e,A,T,f,g){"use strict";var o={ASC:"ASC",DESC:"DESC"};var m={BLOG:"bloglist",BLOG_VARIANT:"bloglistvariant"};var s={CREATED_AT:"CREATED_AT",CHANGED_AT:"CHANGED_AT",NAME:"tolower(TITLE)"};var v={ALL:"all",MY:"my",DRAFT:"draft",PUBLISH:"publish"};var h={NONE:undefined,MY:"myBlogs",DRAFT:"draftBlogs",PUBLISH:"publishedBlogs"};var l={ADJUSTMENT_TITLE:"BLOG_LIST_TIT_ADJUSTMENT",Filter:{},Sorter:{Values:[{TEXT:"SORT_MIT_CREATED",ACTION:s.CREATED_AT,DEFAULT_ORDER:o.DESC},{TEXT:"SORT_MIT_CHANGED",ACTION:s.CHANGED_AT,DEFAULT_ORDER:o.DESC},{TEXT:"SORT_MIT_TITLE",ACTION:s.NAME,DEFAULT_ORDER:o.ASC}]},Order:{Values:[{TEXT:"ORDER_MIT_ASC",ACTION:o.ASC},{TEXT:"ORDER_MIT_DESC",ACTION:o.DESC}]},Variants:{DEFAULT_VARIANT:v.ALL,TITLE:"BLOG_LIST_TIT_VARIANTS",Values:[{TEXT:"BLOG_LIST_MIT_ALL",ACTION:v.ALL,FILTER:h.NONE,INCLUDE_DRAFT:true,VISIBLE:true,DEFAULT_SORT:s.CREATED_AT,MANAGE:false},{TEXT:"BLOG_LIST_MIT_DRAFT",ACTION:v.DRAFT,FILTER:h.DRAFT,INCLUDE_DRAFT:true,DEFAULT_SORT:s.CREATED_AT,VISIBLE:false,HIERARCHY_LEVEL:"1",MANAGE:true},{TEXT:"BLOG_LIST_MIT_PUBLISH",ACTION:v.PUBLISH,FILTER:h.PUBLISH,INCLUDE_DRAFT:false,DEFAULT_SORT:s.CREATED_AT,VISIBLE:false,HIERARCHY_LEVEL:"1",MANAGE:true}]}};var j=B.extend("sap.ino.vc.blog.List",jQuery.extend({},d,T,f,g,{list:l,initialFocus:"filterButton",view:{"List":{"SORT":s.CREATED_AT,"ORDER":undefined,"VARIANT":v.ALL,"MANAGE":false,"TAGS":[],"IS_TAGS_SELECTION":false,"CAMPAIGN":undefined,"TAGCLOUD":true,"TAGCLOUD_EXPABLE":true,"TAGCLOUD_EXP":false,"TAGCLOUD_BAR_VISIBLE":false,"IS_FILTER_SUBPAGE":true},"ORIENTATION":c.PORTRAIT,"DISABLE_ORIENTATION":true,"IS_COMMUNITY_VIEW":false},formatter:jQuery.extend({},O),onInit:function(){this.formatter.filterStyleClass=function(i){return i===undefined?"":"sapUiTinyMarginBegin";};B.prototype.onInit.apply(this,arguments);this.oViewModel=this.getModel("view");this.oViewModel.setData(this.view,true);this.addSubFilterPageContent(this.getAdditionalFilter());this.getList().addStyleClass(this.getPortraitStyle());this.getList().attachUpdateFinished(this.onUpdateFinished,this);this.initApplicationObjectChangeListeners();},show:function(E,i){var q;var k;if(E&&E.getParameter){var n=E.getParameter("arguments");q=n["?query"];k=n.variant;}else{k=i.variant;q=i;}var t=this;var p=this.getListProperty("/Variants/DEFAULT_VARIANT");this.setViewProperty("/List/VARIANT",k||p);k=this.getViewProperty("/List/VARIANT");var r=this.getVariant(k);var u;var w=this.getList().isBound("items");if(!q||!q.sort){var x=r.DEFAULT_SORT;var y=this.getSort(x)[0].DEFAULT_ORDER;q=q||{};q.sort=q.sort||x;q.sort=q.sort+" "+(q.order||y);}var R=this.hasStateChanged(this.getCurrentRoute(),k,q,D.orientation.portrait);R=R||this._bListChanged;this._bListChanged=false;if(!w||R){this.setVariantVisibility();this.setParameters(q,r);u=this.getSort(this.getViewProperty("/List/SORT"));this.setSorter(u);this.updateFilter();var z=this.getViewProperty("/ORIENTATION");this.onOrientationChange(D.system.desktop?z:D.orientation);this.setSortIcon(this.byId("panelFilterFragment--sortreverse"),this.getViewProperty("/List/ORDER"));var G=this.getVariantVisibility(k);if(G===false||typeof(G)==="undefined"){e.show(t.getText("NOT_AUTHORIZED_MESSAGE"),e.Icon.INFORMATION,t.getText("NOT_AUTHORIZED_DIALOG_TITLE"),[e.Action.OK],function(){t.navigateTo("BlogList");});return;}this.bindList();this.initialSorterItems();if(this.isFilterVisible()){this.bindTagCloud();}}this.setHelp("BLOG_LIST");},setVariantVisibility:function(){var k=this.getModel("list").getProperty("/Variants/Values");for(var i=0;i<k.length;i+=1){var n=k[i];var p=n.MANAGE||false;var q=(!p)||(p&&C.hasCurrentUserPrivilege("sap.ino.ui::campaign_manager"));this.getModel("list").setProperty("/Variants/Values/"+i+"/VISIBLE",q);}},getVariantVisibility:function(k){var n,p;n=this.getModel("list").getProperty("/Variants/Values");for(var i=0;i<n.length;i+=1){var q=n[i];if(q.ACTION===k){p=q.VISIBLE;}}return p;},getPortraitStyle:function(){return"sapInoBlogList";},getList:function(){return this.byId("objectlist");},getBindingParameter:function(){var i,k;i=this.getViewProperty("/List/VARIANT");k=this.getCurrentVariant().FILTER;var n=this.getViewProperty("/List/SEARCH");var t=this.getViewProperty("/List/TAGS");var p=this.getViewProperty("/List/CAMPAIGN");var q=jQuery.map(t,function(r){return r.ID;});return{Variant:i,VariantFilter:k,SearchTerm:n,TagIds:q,CampaignId:p};},bindList:function(){this.saveState();var i=this.getBindingParameter();var p="";var k=i.SearchTerm||"";var n=false;var q=this._check4ManagingList();p+="BlogSearchParams";p+="(searchToken='"+k+"',"+"tagsToken='"+(i.TagIds.join(",")||"")+"',"+"filterName='"+(i.VariantFilter||"")+"'"+")/Results";this.setPath("data>/"+p);if((!D.system.desktop&&D.orientation.landscape)||(D.system.desktop&&this.getViewProperty("/ORIENTATION")===c.LANDSCAPE)){n=true;}var _=function(r){var t=this;var L=this.getList().bindItems({path:this.getPath(),template:this.getItemTemplate(),sorter:this.getSorter(),filters:this.getFilter(),groupHeaderFactory:this.getGroupHeaderFactory(),events:{dataRequested:function(){jQuery.each(t.getBusyControls(),function(u,w){if(jQuery.type(w.setBusy)==="function"){w.setBusy(true);}});},dataReceived:function(){jQuery.each(t.getBusyControls(),function(u,w){if(jQuery.type(w.setBusy)==="function"){w.setBusy(false);}});if(jQuery.type(r)==="function"){r.apply(this);}}}});};_.apply(this);},_check4ManagingList:function(){var i=C.hasCurrentUserPrivilege("sap.ino.ui::campaign_manager");if(i){var k=this.getViewProperty("/List/VARIANT");var n=this.getListProperty("/Variants/Values");var p=jQuery.grep(n,function(q){return q.ACTION===k;});p=(p&&p.length>0)?p[0]:{};return p.MANAGE||false;}return false;},includeDrafts:function(){return this.getCurrentVariant().INCLUDE_DRAFT;},bindTagCloud:function(){var i=this.getBindingParameter();var p=C.getBackendRootURL()+"/sap/ino/xs/rest/common/tagcloud_blogs.xsjs";var k=this;var P=[];if(!this.includeDrafts()){P.push("EXCL_STATUS=sap.ino.config.CAMP_DRAFT");}if(i&&i.TagIds){jQuery.each(i.TagIds,function(q,r){P.push("TAG="+r);});}if(i.SearchTerm&&i.SearchTerm.length>0){P.push("SEARCHTERM="+i.SearchTerm);}if(i.VariantFilter){P.push("FILTERNAME="+i.VariantFilter);}if(P.length>0){p=p+"?"+P.join("&");}if(this._lastTagServicePath!==p){var t=new J(p);var n=this.getText("BLOG_LIST_MIT_FILTER_TAG_OTHER");t.attachRequestCompleted(null,function(){var r=t.getData().RANKED_TAG;var q=k.groupByTagGroup(r,k.getViewProperty("/List/TAGS"),n);k.setTagCloudProperty(q,t.getData().WITHOUT_GROUP!=="X");t.setData({"RANKED_TAG":q},false);this.setFilterModel(t,"tag");},this);}this._lastTagServicePath=p;},onBlogItemPress:function(E){if(this._bIsTokenPressed){this._bIsTokenPressed=false;return;}var i=E.getSource();var k=i.getBindingContext("data");if(k){this.navigateTo("blog-display",{id:k.getProperty("ID")});}},updateFilter:function(){var i=this.getViewProperty("/List/VARIANT");var k=this.getViewProperty("/List/CAMPAIGN");var n=this._check4ManagingList();var p=[];this.setFilter([]);if(k&&k!=="0"){p.push(new F("CAMPAIGN_ID",b.EQ,k));}if(p.length>0){this.addFilter(new F({filters:p,and:true}));}},onFilterCampaignChange:function(E){var i=E.getSource().getSelectedItem();if(i.getSelectedItem){i=i.getSelectedItem();}var k=i.getProperty("key");this.setViewProperty("/List/CAMPAIGN",k);this.navigateIntern(this.getQuery(),true,true);},resetFilter:function(){this.setViewProperty("/List/CAMPAIGN",undefined);B.prototype.resetFilter.apply(this,arguments);},getQuery:function(){var q={};var i=this.getViewProperty("/List/SORT");var k=this.getViewProperty("/List/ORDER");var n=this.getViewProperty("/List/SEARCH");var p=this.getViewProperty("/List/CAMPAIGN");var t=this.getViewProperty("/List/TAGS");if(i){q.sort=i;if(k){q.order=k;}}if(n){q.search=n;}if(p){q.campaign=p;}if(t&&t.length>0){q.tags=JSON.stringify(t);}return q;},setParameters:function(q,i){q=q||{};var k=this.getSort(i.DEFAULT_SORT);var n=this.checkSort(q,i.DEFAULT_SORT);var p=this.checkOrder(q,k.DEFAULT_ORDER);var t=this.checkTags(q.tags);var r=q.campaign;this.setViewProperty("/List/VARIANT",i.ACTION);this.setViewProperty("/List/SORT",n);this.setViewProperty("/List/ORDER",p);this.setViewProperty("/List/TAGS",t);this.setViewProperty("/List/IS_TAGS_SELECTION",t.length>0);this.setViewProperty("/List/SEARCH",q.search);this.setViewProperty("/List/MANAGE",i.MANAGE);this.setViewProperty("/List/CAMPAIGN",r);},getItemTemplate:function(){return this.getFragment("sap.ino.vc.blog.fragments.ListItem");},createFilterController:function(){return sap.ui.controller("sap.ino.vc.blog.Filter");},createFilterView:function(){return this.createView({type:V.XML,viewName:"sap.ino.vc.blog.Filter",controller:this._oFilterController});},createState:function(r,i,q,p){var k=B.prototype.createState.apply(this,arguments);k.query.campaign=q.campaign;return k;},onOpenCampaign:function(E){this.navigateTo("campaign",{id:E.getParameter("campaignId")});},onSetFilterBarVisible:function(){this.bindTagCloud();},getAdditionalFilter:function(){var i=this.createFragment("sap.ino.vc.blog.fragments.FilterItems",this.createIdForFilterElement());return i;},reloadData:function(){this.bindList();this.bindTagCloud();},onApplyFilter:function(){var i=this.getFilterDialog();if(JSON.stringify(this.getViewModelBackup())===JSON.stringify(this.getViewProperty("/"))){i.close();return;}var q=this.getQuery();var k=this.getViewProperty("/List/VARIANT");if(k===this.getListProperty("/Variants/DEFAULT_VARIANT")){this.navigateTo(this.getRoute(false),{query:q},true,true);}else{this.navigateTo(this.getRoute(true),{variant:k,query:q},true,true);}i.close();},formatObjectListVariantsVisible:function(i){if(!i||(i&&C.hasCurrentUserPrivilege("sap.ino.ui::campaign_manager"))){return true;}return false;},initApplicationObjectChangeListeners:function(){var t=this;t._bListChanged=false;var i=["create","del","modifyAndSubmit","submit","majorPublishSubmit","publishSubmit","unPublishSubmit"];var k=function(E){var n=E.getParameter("actionName");if(n&&i.indexOf(n)>-1&&E.getParameter("object").getMetadata().getName()==="sap.ino.commons.models.object.Blog"){t._bListChanged=true;}};A.attachChange(A.Action.Create,k);A.attachChange(A.Action.Del,k);A.attachChange(A.Action.Action,k);},showPopupTagCard:function(E){if(!this._oPopover){this._oPopover=sap.ui.xmlfragment("sap.ino.vc.tag.fragments.TagCardPopover",this);this.getView().addDependent(this._oPopover);}var t=E.getSource();var p="/SearchTagsAll(searchToken='',ID="+t.getKey()+")";var i=this.getModel("data");var k=this;i.read(p,{async:true,success:function(n){var q=new J();q.setData(n);k._oPopover.setModel(q,"Tag");jQuery.sap.delayedCall(0,k,function(){k._oPopover.openBy(t);});}});}}));j.list=l;j.routes=m;return j;});};if(!jQuery.sap.isDeclared('sap.ino.vc.blog.ListPage.controller')){jQuery.sap.declare('sap.ino.vc.blog.ListPage.controller');sap.ui.define("sap/ino/vc/blog/ListPage.controller",["sap/ino/vc/blog/List.controller","sap/ino/vc/commons/TopLevelPageFacet"],function(B,T){"use strict";return B.extend("sap.ino.vc.blog.ListPage",jQuery.extend({},T,{routes:["bloglist","bloglistvariant"],onRouteMatched:function(e){this.setGlobalFilter([]);this.setHelp("BLOG_LIST");this.show(e);}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.BackOfficeHome.controller')){jQuery.sap.declare('sap.ino.vc.campaign.BackOfficeHome.controller');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.TextAlign');sap.ui.define("sap/ino/vc/campaign/BackOfficeHome.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/commons/application/Configuration","sap/ino/vc/iam/mixins/IdentityProfileMixin","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ino/vc/evaluation/EvaluationFormatter","sap/ui/core/TextAlign","sap/ino/vc/idea/mixins/AssignmentActionMixin","sap/ino/vc/idea/mixins/ChangeStatusActionMixin","sap/ino/vc/idea/mixins/DeleteActionMixin","sap/ino/vc/idea/mixins/FollowUpMixin","sap/ino/vc/comment/CommentMixin","sap/ino/vc/idea/mixins/MergeActionMixin","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/vc/blog/mixins/DeleteActionMixin","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ino/vc/blog/mixins/BlogCardMixin","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ino/vc/follow/mixins/FeedsMixin","sap/ino/vc/campaign/mixins/MilestoneMixin","sap/ino/vc/idea/mixins/IdeaFormCriteriaFilterMixin"],function(C,a,I,S,F,b,J,E,T,A,c,D,d,e,M,f,B,g,h,R,j,V,k,l,m,n){"use strict";var L={"follow":{filterParam:"",filter:[new F("FOLLOW_UP_ID","NE",null),new F("STATUS","NE","sap.ino.config.DRAFT")],sorter:new S("FOLLOW_UP_DATE",false)},"coachme":{filterParam:"",filter:[new F("COACH_ID","EQ",a.getCurrentUser().USER_ID),new F("STATUS","NE","sap.ino.config.DRAFT")],sorter:new S("SUBMITTED_AT",false)},"unassigned":{filterParam:"unassignedCoach",filter:[new F("STATUS","NE","sap.ino.config.DRAFT")],sorter:new S("SUBMITTED_AT",true)},"evaldone":{filterParam:"evaluatedIdeas",filter:[new F("STATUS","NE","sap.ino.config.DRAFT")],sorter:new S("LAST_PUBL_EVAL_AT",true)}};var o={"published":{filterParam:"publishedBlogs",filter:[],sorter:new S("PUBLISHED_AT",true),name:"publish"},"draft":{filterParam:"draftBlogs",filter:[],sorter:new S("CHANGED_AT",true),name:"draft"},"all":{filterParam:"",filter:[],sorter:new S("PUBLISHED_AT",true),name:"all"}};var p={Backoffice:{PATH_TEMPLATE:"/CampaignEntityCount",SHOW_CRTBLOG_AUTH:true,Binding:[{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_COACHED",COUNT:"IDEAS_COACHED_BY_ME",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"coachme"}},ROLES:["camp_instance_coach_role","camp_instance_resp_coach_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_UNASSIGNED",COUNT:"UNASSIGNED_IDEAS_COUNT",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"unassigned"}},ROLES:["camp_instance_mgr_role","camp_instance_coach_role","camp_instance_resp_coach_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_EVALUATED",COUNT:"EVALUATED_IDEAS",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"evaldone"}},ROLES:["camp_instance_mgr_role","camp_instance_coach_role","camp_instance_resp_coach_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEA_FOLLOWUP",COUNT:"FOLLOW_UP_IDEAS",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"follow"}},ROLES:["camp_instance_mgr_role","camp_instance_coach_role","camp_instance_resp_coach_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_QUALIFIED_IDEAS_FOR_REWARDS",COUNT:"QUALIFIED_IDEAS_FOR_REWARDS",Route:{NAME:"rewardlistvariant",QUERY:{variant:"rewardqualified"}},ROLES:["camp_instance_mgr_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_EVALUATION_PENDING_BY_ME",COUNT:"EVALUATION_PENDING_BY_ME",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"manage"}},ROLES:["camp_instance_coach_role","camp_instance_resp_coach_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_MANAGED",COUNT:"IDEAS_MANAGED_BY_ME",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"manage"}},ROLES:["camp_instance_mgr_role","camp_instance_coach_role","camp_instance_resp_coach_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"IDEA_LIST_MIT_COMPLETED",COUNT:"COMPLETED_IDEA_COUNT",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"managedcompleted"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{ICON:"sap-icon://hr-approval",LINK_TEXT:"REGISTER_APPR_LIST_TIT",COUNT:"MY_PENDING_APPR_COUNT",Route:{NAME:"campaign-registerapprovallistvariant",QUERY:{variant:"pending"}},ROLES:["camp_instance_mgr_role"]}]}};var r={"UnchangedIdeasFrame":"ReportTemplates('sap.ino.config.7')","CampaignActivitiesFrame":"ReportTemplates('sap.ino.config.14')"};var q={XS:{centerProfileContainer:"identityProfileFragment--identityProfile",centerCommentContainer:"ideasCommentFragment--campaignComment",centerTagsContainer:"campaignTagsFragment--campaignTags",centerReportUnchangedIdeasContainer:"unchangedIdeasFragment--unchangedIdeas",centerReportUnchangedIdeasSplitContainer:undefined,leftReportUnchangedIdeasContainer:undefined,rightReportUnchangedIdeasContainer:undefined,centerReportCampaignActivitiesContainer:"campaignActivitiesFragment--campaignActivities",centerReportCampaignActivitiesSplitContainer:undefined,leftReportCampaignActivitiesContainer:undefined,rightReportCampaignActivitiesContainer:undefined},S:{leftProfileContainer:"identityProfileFragment--identityProfile",centerCommentContainer:"ideasCommentFragment--campaignComment",centerTagsContainer:"campaignTagsFragment--campaignTags",centerReportCampaignActivitiesContainer:"campaignActivitiesFragment--campaignActivities",centerReportUnchangedIdeasContainer:"unchangedIdeasFragment--unchangedIdeas"},M:{leftProfileContainer:"identityProfileFragment--identityProfile",centerCommentContainer:"ideasCommentFragment--campaignComment",centerTagsContainer:"campaignTagsFragment--campaignTags",centerReportCampaignActivitiesSplitContainer:"campaignActivitiesFragment--campaignActivities",centerReportUnchangedIdeasSplitContainer:"unchangedIdeasFragment--unchangedIdeas"},L:{leftProfileContainer:"identityProfileFragment--identityProfile",leftCommentContainer:"ideasCommentFragment--campaignComment",leftTagsContainer:"campaignTagsFragment--campaignTags",leftReportCampaignActivitiesContainer:"campaignActivitiesFragment--campaignActivities",leftReportUnchangedIdeasContainer:"unchangedIdeasFragment--unchangedIdeas"},XL:{leftProfileContainer:"identityProfileFragment--identityProfile",leftCommentContainer:"ideasCommentFragment--campaignComment",leftTagsContainer:"campaignTagsFragment--campaignTags",rightReportCampaignActivitiesContainer:"campaignActivitiesFragment--campaignActivities",rightReportUnchangedIdeasContainer:"unchangedIdeasFragment--unchangedIdeas"}};return C.extend("sap.ino.vc.campaign.BackOfficeHome",jQuery.extend({},I,A,c,d,D,e,M,f,B,h,R,j,V,k,g,l,m,n,{initialFocus:["backofficeButton--backofficeToogle","identityProfileFragment--createBlog"],formatter:jQuery.extend({unchangedIdeasColor:function(i){switch(i){case 0:return'Good';case 1:return'Neutral';case 2:return'Critical';default:return'Error';}},unchangedIdeasLabel:function(i){switch(i){case 0:return'1';case 1:return'<= 7';case 2:return'<= 30';default:return'> 30';}}},this.formatter,E,d.followUpMixinFormatter,g),onInit:function(){C.prototype.onInit.apply(this,arguments);this.aBusyControls=[this.getView()];this._sBOHResizeIdeaListId=this.attachListControlResized(this.byId("ideasFragment--ideasList"));},onExit:function(){C.prototype.onExit.apply(this,arguments);this.detachListControlResized(this._sBOHResizeIdeaListId);},bindViewData:function(){this.getModel("view").setProperty("/CAMPAIGN_COMMENT_NAVIGATION_SECTION","campaignSectionComments");var i;if(this.getModel("device").getProperty("/system/phone")){i=this.byId("ideasFragment--sapInoCampHomeIdeasSelect").getSelectedKey();}else{i=this.byId("ideasFragment--sapInoCampHomeIdeasButtons").getSelectedKey();}this._sIdeaViewKey=i||Object.keys(L)[0];this._bindIdeas(this._sIdeaViewKey);var s;if(this.getModel("device").getProperty("/system/phone")){s=this.byId("blogsFragment--sapInoCampHomeBlogsSelect").getSelectedKey();}else{s=this.byId("blogsFragment--sapInoCampHomeBlogsButtons").getSelectedKey();}this._sBlogViewKey=s||Object.keys(o)[0];if(!this.getModel("component").getProperty("/SHOW_BACKOFFICE_BLOG")){this._sBlogViewKey=Object.keys(o)[2];}this._bindBlogs(this._sBlogViewKey);this._bindUnchangedIdeas();this._bindActivities();this._bindComments();this._bindTags();},onAfterRendering:function(){var u=this.byId("unchangedIdeasFragment--UnchangedIdeasFrame");var i=this.byId("campaignActivitiesFragment--CampaignActivitiesFrame");var v={title:{visible:false},legendGroup:{layout:{position:"auto"}},categoryAxis:{title:{visible:false},label:{visible:false}},valueAxis:{title:{visible:false}}};if(u){u.setVizProperties(v);}if(i){i.setVizProperties(v);}if(!this.getModel("device").getProperty("/system/phone")){if(!u.aBindParameters){u.attachBrowserEvent("click",this.onNavigateToReport,this);}if(!i.aBindParameters){i.attachBrowserEvent("click",this.onNavigateToReport,this);}}},getList:function(){return this.byId("ideasFragment--ideasList");},show:function(P){this._oParentView=P;this.bindViewData();this.setIdentityProfileBinding();this.getList().attachUpdateFinished(this._onListUpdateFinished,this);this.bindMilestone(this.getCampaignId());},_onListUpdateFinished:function(){var i=this.getList();i.$().find(".sapMListUl").attr("role","list");var s=i.$().find("li");jQuery.each(s,function(t,u){var $=jQuery(u);$.attr("role","group");var v=$.find(".sapInoItemAriaLabel");if(v&&v.length>0){$.attr("aria-labelledby",v[0].id);}var w=$.find(".sapMLIBContent");if(w&&w.length>0){w.attr("role","listitem");}});},getLayout:function(s){return q[s];},setIdentityProfileBinding:function(){var s=this.getView().getBindingContext("data").getProperty("SHORT_NAME");var t=p.Backoffice;var u=this.getView().getBindingContext("data").getProperty("IS_REGISTER_AUTO_APPROVE");var v=new Date();var w=this.getView().getBindingContext("data").getProperty("REGISTER_FROM");var x=this.getView().getBindingContext("data").getProperty("REGISTER_TO");var y=false;if(v>=w&&v<=x){y=true;}if(!u){if(y){jQuery.each(t.Binding,function(i,G){if(G.COUNT==="MY_PENDING_APPR_COUNT"){G.VISIBLE=true;}});}}if(this.getView().getBindingContext("data").getProperty("REWARD")){jQuery.each(t.Binding,function(i,G){if(G.COUNT==="QUALIFIED_IDEAS_FOR_REWARDS"){G.VISIBLE=true;}});}t.HEADLINE=s;t.HEADLINE_BACKGROUND="#"+(this.getView().getBindingContext("data").getProperty("COLOR_CODE")||"FFFFFF");t.PATH=p.Backoffice.PATH_TEMPLATE+"("+this.getCampaignId()+")";this.getView().setModel(new J({ID:this.getCampaignId(),NAME:s,_OBJECT_TYPE_CODE:"CAMPAIGN"}),"contextObject");this.bindIdentityProfile(this.byId("identityProfileFragment--identityProfile"),t,this.getCampaignId(),this.byId("identityProfileFragment--identityProfileButtons"));if(this.getModel("data").getProperty(t.PATH)){var z=this.byId("identityProfileFragment--identityProfileList");this.getModel("data").read(t.PATH,{success:function(){var i=z.getBindingInfo("items");z.bindItems(i);}});}},getCampaignId:function(){return this.getView().getBindingContext("data")?this.getView().getBindingContext("data").getProperty("ID"):undefined;},_bindIdeas:function(K,i){var s=this.getModel("device").getProperty("/system/phone");if(i||this.getCampaignId()&&true){var P="data>/IdeaMediumBackofficeSearchParams(searchToken='',"+"searchType="+"0"+","+"tagsToken='',"+"tagsToken1='',"+"tagsToken2='',"+"tagsToken3='',"+"tagsToken4='',"+"filterName='"+L[K].filterParam+"',"+"filterBackoffice=1"+this.getEmptyIdeaformFilters()+",cvt='"+""+"',"+"cvr="+"0"+","+"cvy="+"0"+")/Results";var t=this.byId("ideasFragment--ideasList");var u=a.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE")*1||a.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE_HIDE_PHASE_BAR")*1;var v=Number(u)?this.getFragment("sap.ino.vc.idea.fragments.ManageListItemNoImage"):this.getFragment("sap.ino.vc.idea.fragments.ManageListItem");if(s){}else{}t.bindItems({path:P,template:v,sorter:L[K].sorter,filters:L[K].filter.concat(new F("CAMPAIGN_ID","EQ",i||this.getCampaignId())),length:4});var w=this.byId("ideasFragment--panelTitle");w.setText(this.getText("CAMPAIGN_HOME_PANEL_IDEAS_"+K.toUpperCase()));var x=a.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");var O="";if(x){O="/sap/ino/xs/rest/backoffice/odata.xsodata";}else{O="/sap/ino/xs/rest/community/odata.xsodata";}P=a.getBackendRootURL()+O+t.mBindingInfos.items.binding.sPath+"?$format=json";var y=t.mBindingInfos.items.binding.sFilterParams;var z=t.mBindingInfos.items.binding.sSortParams;var G="&$select(ID)";P=P+"&"+z+"&"+y+G;var H=new J();H.setData({path:P});sap.ui.getCore().setModel(H,"ideaSearchParams");}},_bindBlogs:function(K){if(this.getCampaignId()){var i=this.getModel("device").getProperty("/system/phone");var P="data>/BlogSearchParams(searchToken='',"+"tagsToken='',"+"filterName='"+o[K].filterParam+"')/Results";var s={path:P,template:this.getFragment("sap.ino.vc.blog.fragments.ListItemHome"),sorter:o[K].sorter,filters:o[K].filter.concat(new F("CAMPAIGN_ID","EQ",this.getCampaignId())),length:4,top:4};if(i){var t=this.byId("blogsFragment--blogsCarousel");t.bindAggregation("pages",s);}else{var u=this.byId("blogsFragment--blogsList");if(u){u.bindItems(s);}}var v=this.byId("blogsFragment--panelBlogTitle");if(this.getModel("component").getProperty("/SHOW_BACKOFFICE_BLOG")){v.setText(this.getText("CAMPAIGN_HOME_PANEL_BLOGS_"+K.toUpperCase()));}else{v.setText(this.getText("HOMEPAGE_PANEL_CAMPAIGN_BLOGS"));}}},_bindUnchangedIdeas:function(){var u=this.byId("unchangedIdeasFragment--UnchangedIdeasFrame");u.getParent().setVisible(true);var i=this.getModel("data");i.read("/CampaignUnchangedIdeas",{async:true,filters:[new F("CAMPAIGN_ID","EQ",this.getCampaignId())],success:function(s){if(s.results&&s.results[0]){u.getParent().setVisible(true);u.getParent().getParent().getContent()[1].setVisible(false);var t=new sap.ui.model.json.JSONModel();t.setData(s);u.setModel(t);}else{u.getParent().setVisible(false);u.getParent().getParent().getContent()[1].setVisible(true);}}});},_bindActivities:function(){var i=this.byId("campaignActivitiesFragment--CampaignActivitiesFrame");i.getParent().setVisible(true);var s=this.getModel("data");s.read("/CampaignActivities",{async:true,filters:[new F("CAMPAIGN_ID","EQ",this.getCampaignId())],success:function(u){if(u.results&&u.results[0]){i.getParent().setVisible(true);i.getParent().getParent().getContent()[1].setVisible(false);var v=new sap.ui.model.json.JSONModel();v.setData(u);i.setModel(v);}else{i.getParent().setVisible(false);i.getParent().getParent().getContent()[1].setVisible(true);}}});var t=this.byId("campaignActivitiesFragment--panelTitle");t.setText(this.getText("MW_TCO_TIT_ACTIVITIES_MONTH",[this.getText("MONTH_FLD_"+(new Date().getMonth()+1))]));},_bindComments:function(){var i=this.byId("ideasCommentFragment--campaginCommentList");var s=i.getBindingInfo("items");i.bindItems(s);},_bindTags:function(){if(!this._oTagTokenizer){this._oTagTokenizer=this.byId("campaignTagsFragment--campaignTags").getContent()[0];}this.byId("campaignTagsFragment--campaignTags").getContent()[0].setBusy(true);var t=this.byId("campaignTagsFragment--Tags");var i=t.getBindingInfo("tokens");t.bindAggregation("tokens",i);var s=this.getModel("data");var P=this.getView().getBindingContext("data").sPath+"/Tags";var u=this;s.read(P,{async:true,success:function(v){var w=u.byId("campaignTagsFragment--campaignTags");w.removeContent(w.getContent()[0]);if(v.results.length===0){var H=new sap.m.HBox().addStyleClass("sapInoCampaignTagsContainerNoTags");H.addItem(new sap.m.Text({text:u.getText("CAMPAIGN_LIST_FLD_NO_TAGS"),width:"100%"}).setTextAlign(T.Center));w.addContent(H);}else{w.addContent(u._oTagTokenizer);}u.byId("campaignTagsFragment--campaignTags").getContent()[0].setBusy(false);}});},_bindFeed:function(){var s=this;var P=a.getBackendRootURL()+"/sap/ino/xs/rest/common/feed.xsjs";var i=[];if(this.getCampaignId()){i.push("campaign="+this.getCampaignId());i.push("top=4");}if(i.length>0){P=P+"?"+i.join("&");}var t=new J(P);t.attachRequestCompleted(null,function(){if(t.oData.results){jQuery.each(t.oData.results,function(v,w){w.EVENT_AT=new Date(w.EVENT_AT);});}var u=s.byId("feedsFragment--feedList");u.setModel(t,"feed");},t);},onIdeaListTypeSelect:function(i){this._sIdeaViewKey=i.getParameter("key")||i.getParameter("selectedItem")&&i.getParameter("selectedItem").getKey();this._bindIdeas(this._sIdeaViewKey);},onBlogListTypeSelect:function(i){this._sBlogViewKey=i.getParameter("key")||i.getParameter("selectedItem")&&i.getParameter("selectedItem").getKey();this._bindBlogs(this._sBlogViewKey);},onOpenSubmitter:function(i){var s=i.getSource();var t=s.getBindingContext("data").getProperty("SUBMITTER_ID");this.openIdentityQuickView(s,t);},onOpenCoach:function(i){var s=i.getSource();var t=s.getBindingContext("data").getProperty("COACH_ID");this.openIdentityQuickView(s,t);},onNavigateToIdeas:function(){var i=this.getCampaignId();if(!this._sIdeaViewKey){this.navigateTo("campaign-idealist",{id:i});}else{this.navigateTo("campaign-idealistvariant",{id:i,variant:this._sIdeaViewKey});}},onNavigateToBlogs:function(){var i=this.getCampaignId();if(!this._sBlogViewKey){this.navigateTo("campaign-bloglist",{id:i});}else{this.navigateTo("campaign-bloglistvariant",{id:i,variant:o[this._sBlogViewKey].name});}},onItemPress:function(i){var s=i.getSource();s.$().attr("aria-label",this.getText());var t=s.getBindingContext("data");if(t){this.navigateTo("idea-display",{id:t.getProperty("ID")});}},onNavigateToComment:function(){var i=this.getCampaignId();this.navigateTo("campaign-comment",{id:i});},onNavigateToCampaignFeeds:function(i){this.navigateTo("campaign-feeds",{id:this.getCampaignId()});},onNavigateToReport:function(i){var s=this.getCampaignId();var t=((i.currentTarget&&i.currentTarget.id)||(i.oSource.sId)).split("--");var u=t[t.length-1];this.navigateTo("report",{code:r[u],query:{campaign:s}});},onOfficeToggle:function(){if(this._oParentView){var i=this._oParentView.getController();if(i.switchView){i.switchView();}}},onOpenCampaignSettings:function(){if(this._oParentView){var i=this._oParentView.getController();if(i.openCampaignSettings){i.openCampaignSettings(this.getCampaignId());}}},showPopupTagCard:function(i){this._bIsTokenPressed=true;if(!this._oPopover){this._oPopover=sap.ui.xmlfragment("sap.ino.vc.tag.fragments.TagCardPopover",this);this.getView().addDependent(this._oPopover);}var t=i.getSource();var P="/SearchTagsAll(searchToken='',ID="+t.getKey()+")";var s=this.getModel("data");var u=this;s.read(P,{async:true,success:function(v){var w=new J();w.setData(v);u._oPopover.setModel(w,"Tag");jQuery.sap.delayedCall(0,u,function(){u._oPopover.openBy(t);});}});},onEditBlog:function(i){var s=i.getSource();this.navigateTo("blog-edit",{id:s.getBindingContext("data").getProperty("ID")});},onBlogItemPress:function(i){if(this._bIsTokenPressed){this._bIsTokenPressed=false;return;}var s=i.getSource();var t=s.getBindingContext("data");if(t){this.navigateTo("blog-display",{id:t.getProperty("ID")});}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.CampaignBlogList.controller')){jQuery.sap.declare('sap.ino.vc.campaign.CampaignBlogList.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/campaign/CampaignBlogList.controller",["sap/ino/vc/blog/List.controller","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/Device","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/ino/commons/models/aof/PropertyModel","sap/ino/vc/commons/mixins/TagGroupMixin"],function(B,T,D,C,J,P,a){"use strict";return B.extend("sap.ino.vc.campaign.CampaignBlogList",jQuery.extend({},T,a,{routes:["campaign-bloglist","campaign-bloglistvariant"],onInit:function(){B.prototype.onInit.apply(this,arguments);this.setViewProperty("/HIDE_CAMPAIGN_FILTER",true);this.setViewProperty("/List/IS_FILTER_SUBPAGE",false);},onRouteMatched:function(e){this.setGlobalFilter([]);var A=e.mParameters.arguments;var q=A["?query"]||{};q.campaign=A.id;q.variant=A.variant;var t=this;var v=this.getView();var I=function(){t.updateBackgroundColor(v.getBindingContext("data").getProperty("COLOR_CODE"));t.show((this.getRoute()==="campaign-bloglist")?"bloglist":"bloglistvariant",q);};var s=function(E){var p=E.getSource();var V=t.getModel("list").getProperty("/Variants/Values");for(var i=0;i<V.length;i+=1){var b=V[i];var c=b.MANAGE||false;var d=!c||(c&&p.getProperty("/nodes/Root/customProperties/backofficeCampaignPrivilege"));t.getModel("list").setProperty("/Variants/Values/"+i+"/VISIBLE",d);}p.destroy();};this._iCampaignId=parseInt(A.id,10);if(C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")){var o=new P("sap.ino.xs.object.campaign.Campaign",this._iCampaignId,{nodes:["Root"]},false,s);}this.bindCampaignODataModel(this._iCampaignId,I);},hasBackgroundImage:function(){return false;},onVariantPress:function(v){if(!D.system.desktop){return;}var q=this.getQuery();this.removeInvalidFilters(q);delete q.campaign;if(v){this.navigateTo(this.getRoute(true),{id:this._iCampaignId,variant:v,query:q},true,true);}else{this.navigateTo(this.getRoute(false),{id:this._iCampaignId,query:q},true,true);}},navigateIntern:function(q,r){var v=this.getViewProperty("/List/VARIANT");this.navigateTo(this.getCurrentRoute(),{"variant":v,"query":q,"id":this._iCampaignId},r,true);},bindTagCloud:function(){var b=this.getBindingParameter();var p=C.getBackendRootURL()+"/sap/ino/xs/rest/common/tagcloud_blogs.xsjs";var c=this;var d=[];if(this._iCampaignId){d.push("CAMPAIGN="+this._iCampaignId);}if(!this.includeDrafts()){d.push("EXCL_STATUS=sap.ino.config.CAMP_DRAFT");}if(b&&b.TagIds){jQuery.each(b.TagIds,function(k,v){d.push("TAG="+v);});}if(b.SearchTerm&&b.SearchTerm.length>0){d.push("SEARCHTERM="+b.SearchTerm);}if(b.VariantFilter){d.push("FILTERNAME="+b.VariantFilter);}if(d.length>0){p=p+"?"+d.join("&");}if(this._lastTagServicePath!==p){var t=new J(p);var o=this.getText("BLOG_LIST_MIT_FILTER_TAG_OTHER");t.attachRequestCompleted(null,function(){var r=t.getData().RANKED_TAG;var e=c.groupByTagGroup(r,c.getViewProperty("/List/TAGS"),o);c.setTagCloudProperty(e,t.getData().WITHOUT_GROUP!=="X");t.setData({"RANKED_TAG":e},false);this.setFilterModel(t,"tag");},this);}this._lastTagServicePath=p;},bindCampaignODataModel:function(i,c){var t=this;var e="CampaignFull";if(i>0){this.getView().bindElement({path:"data>/"+e+"("+i+")",events:{dataRequested:function(){jQuery.each(t.getBusyControls(),function(I,b){if(jQuery.type(b.setBusy)==="function"){b.setBusy(true);}});},dataReceived:function(){jQuery.each(t.getBusyControls(),function(I,b){if(jQuery.type(b.setBusy)==="function"){b.setBusy(false);}});if(typeof c==="function"){c.apply(t);}}}});if(typeof c==="function"){var o=this.getView().getBindingContext("data");if(o&&o.getPath()===("/"+e+"("+i+")")){c.apply(t);}}}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.CommunityHome.controller')){jQuery.sap.declare('sap.ino.vc.campaign.CommunityHome.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.core.TextAlign');jQuery.sap.require('sap.ui.core.IconPool');sap.ui.define("sap/ino/vc/campaign/CommunityHome.controller",["sap/ino/vc/commons/BaseObjectController","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/application/Configuration","sap/ui/core/ResizeHandler","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/vc/evaluation/EvaluationFormatter","sap/ui/core/TextAlign","sap/ino/vc/comment/CommentMixin","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ino/vc/campaign/mixins/CampaignProfileMixin","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ino/vc/blog/mixins/BlogCardMixin","sap/ui/core/IconPool","sap/ino/vc/follow/mixins/FeedsMixin","sap/ino/vc/campaign/mixins/MilestoneMixin"],function(C,D,J,T,a,R,S,F,b,E,c,d,V,f,g,h,j,k,l,B,I,m,M){"use strict";var n={Community:{PATH_TEMPLATE:"/CampaignCommunityEntityCount",SHOW_BUTTONS_AUTH:true,Binding:[{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_ALL",COUNT:"ALL_IDEAS_COUNT",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"all"}},ROLES:["camp_instance_mgr_role","camp_instance_coach_role","camp_instance_resp_coach_role","camp_instance_part_role","camp_instance_expert_role","camp_instance_resp_expert_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_OPEN_FOR_VOTING",COUNT:"OPEN_VOTING_IDEAS_COUNT",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"vote"}},ROLES:["camp_instance_mgr_role","camp_instance_coach_role","camp_instance_resp_coach_role","camp_instance_part_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_EVA_PENDING_FOR_ME",COUNT:"EVALUATION_PENDING_COUNT",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"evalpending"}},ROLES:["camp_instance_expert_role","camp_instance_resp_expert_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_OPEN_FOR_EVA",COUNT:"OPEN_EVALUATION_IDEA_COUNT",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"evalopen"}},ROLES:["camp_instance_expert_role","camp_instance_resp_expert_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_EVA_BY_ME",COUNT:"MY_EVALUATED_IDEA_COUNT",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"eval"}},ROLES:["camp_instance_expert_role","camp_instance_resp_expert_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_MY",COUNT:"MY_ALL_IDEA_COUNT",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"my"}},ROLES:["camp_instance_part_role","camp_instance_expert_role","camp_instance_resp_expert_role"]},{ICON:"sap-icon://comment",LINK_TEXT:"PROFILE_LNK_IDEAS_MY_COMMENTS",COUNT:"MY_COMMENT_IDEA_COUNT",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"commented"}},ROLES:["camp_instance_mgr_role","camp_instance_coach_role","camp_instance_resp_coach_role","camp_instance_part_role","camp_instance_expert_role","camp_instance_resp_expert_role"]},{ICON:"sap-icon://InoIcons/heart",LINK_TEXT:"PROFILE_LNK_IDEAS_MY_VOTES",COUNT:"MY_VOTE_IDEA_COUNT",Route:{NAME:"campaign-idealistvariant",QUERY:{variant:"voted"}},ROLES:["camp_instance_mgr_role","camp_instance_coach_role","camp_instance_resp_coach_role","camp_instance_part_role","camp_instance_expert_role","camp_instance_resp_expert_role"]},{ICON:"sap-icon://survey",LINK_TEXT:"HOMEPAGE_PANEL_CAMPAIGN_BLOGS",COUNT:"CAMPAIGN_BLOGS_COUNT",Route:{NAME:"campaign-bloglist",QUERY:{}},ROLES:["camp_instance_mgr_role","camp_instance_coach_role"]}]}};var L={XS:{centerProfileContainer:"CampaignProfileFragment--campaignProfile",centerCampaignManagerContainer:"CampaignManagersFragment--CampaignManagers",centerCampaignTagsContainer:"campaignTagsFragment--campaignTags",rightTopCommentatorContainer:undefined,centerTopCommentatorSplitContainer:undefined,centerCommentContainer:"commentFragment--campaignComment",centerBlogContainer:"blogsFragment--blogCommunity"},S:{leftProfileContainer:"CampaignProfileFragment--campaignProfile",centerCampaignManagerContainer:"CampaignManagersFragment--CampaignManagers",centerCampaignTagsContainer:"campaignTagsFragment--campaignTags",rightTopCommentatorContainer:undefined,centerTopCommentatorSplitContainer:undefined,centerCommentContainer:"commentFragment--campaignComment",centerBlogContainer:"blogsFragment--blogCommunity"},M:{leftProfileContainer:"CampaignProfileFragment--campaignProfile",centerCampaignManagerContainer:"CampaignManagersFragment--CampaignManagers",centerCampaignTagsContainer:"campaignTagsFragment--campaignTags",rightTopCommentatorContainer:undefined,centerTopCommentatorSplitContainer:undefined,centerCommentSplitContainer:"commentFragment--campaignComment",centerBlogSplitContainer:"blogsFragment--blogCommunity"},L:{leftProfileContainer:"CampaignProfileFragment--campaignProfile",leftCampaignManagerContainer:"CampaignManagersFragment--CampaignManagers",leftCampaignTagsContainer:"campaignTagsFragment--campaignTags",centerTopCommentatorSplitContainer:"topCommentatorFragment--topCommentator",centerCommentSplitContainer:"commentFragment--campaignComment",centerBlogContainer:"blogsFragment--blogCommunity"},XL:{leftProfileContainer:"CampaignProfileFragment--campaignProfile",leftCampaignManagerContainer:"CampaignManagersFragment--CampaignManagers",leftCampaignTagsContainer:"campaignTagsFragment--campaignTags",rightTopCommentatorContainer:"topCommentatorFragment--topCommentator",rightCommentContainer:"commentFragment--campaignComment",rightBlogContainer:"blogsFragment--blogCommunity"}};return C.extend("sap.ino.vc.campaign.CommunityHome",jQuery.extend({},h,d,V,f,g,j,k,l,B,m,M,{identityProfile:n,formatter:jQuery.extend({},this.formatter,E,h),initialFocus:["backofficeButton--backofficeToogle","identityProfileFragment--createIdea"],onInit:function(){C.prototype.onInit.apply(this,arguments);this.aBusyControls=[this.getView()];},bindViewData:function(){this.getModel("view").setProperty("/CAMPAIGN_COMMENT_NAVIGATION_SECTION","campaignSectionComments");this.setViewProperty("/IS_COMMUNITY_VIEW",true);this._bindIdeas(this.getCampaignId());this._bindBlogs(this.getCampaignId());this._bindTopList();this._bindComments();this._bindTags();this._bindRegisterButton();this.getView().setModel(new J({ID:this.getView().getBindingContext("data").getProperty("ID"),NAME:this.getView().getBindingContext("data").getProperty("SHORT_NAME"),_OBJECT_TYPE_CODE:"CAMPAIGN"}),"contextObject");},show:function(p){if(!this.getView().getBindingContext("data")){return;}this._oParentView=p;this.bindViewData();this.setIdentityProfileBinding();var e=this.byId('campaignBannerList');e.addEventDelegate({onAfterRendering:jQuery.proxy(function(){$(".sapMCrslInner.sapMCrslBottomOffset").height($('#'+e.getActivePage()).parents('.sapMCrslItem').height()+"px");$('#'+e.getActivePage()).parents('.sapMCrslItem ').fadeIn();},this)});this.bindMilestone(this.getCampaignId());},getLayout:function(s){return L[s];},setIdentityProfileBinding:function(){var s=this.getView().getBindingContext("data").getProperty("SHORT_NAME");var e=n.Community;e.HEADLINE=s;e.HEADLINE_BACKGROUND="#"+(this.getView().getBindingContext("data").getProperty("COLOR_CODE")||"FFFFFF");e.PATH=n.Community.PATH_TEMPLATE+"("+this.getCampaignId()+")";this.bindIdentityProfile(this.byId("CampaignProfileFragment--campaignProfile"),e,this.getCampaignId(),this.byId("CampaignProfileFragment--identityProfileButtons"));if(this.getModel("data").getProperty(e.PATH)){var i=this.byId("CampaignProfileFragment--identityProfileList");this.getModel("data").read(e.PATH,{success:function(){var o=i.getBindingInfo("items");i.bindItems(o);}});}},getCampaignId:function(){return this.getView().getBindingContext("data")?this.getView().getBindingContext("data").getProperty("ID"):undefined;},onResizeLayoutChange:function(o,N){var t=this;function s(q,r){for(var i=0;i<q.length;i+=1){if(i<r){q[i].setVisible(true);}else{q[i].setVisible(false);}}}function e(i){var q=t.byId(i);var r=q.getItems();switch(N){case"XL":if(i==="blogsFragment--blogsList"){s(r,3);}else{s(r,4);}break;case"L":s(r,4);break;case"M":s(r,3);break;case"S":s(r,2);break;case"XS":s(r,1);break;default:break;}}var p=this.getModel("device").getProperty("/system/phone");if(!p){e("ideasFragment--ideasList");e("blogsFragment--blogsList");}},_bindIdeas:function(i){if(i||this.getCampaignId()){var e=this.getModel("device").getProperty("/system/phone");var o=a.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE")*1||a.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE_HIDE_PHASE_BAR")*1;var t=Number(o)?this.getFragment("sap.ino.vc.idea.fragments.CardListItemNoImage"):this.getFragment("sap.ino.vc.idea.fragments.CardListItem");var p={path:"data>/IdeaMediumCommunity",template:t,sorter:new S("SUBMITTED_AT",true),filters:[new F("STATUS","NE","sap.ino.config.DRAFT"),new F("CAMPAIGN_ID","EQ",i||this.getCampaignId())],length:4,top:4};var q=this;var P="";var s="";var r="";var u="&$select(ID)";var v=a.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");var O="";if(v){O="/sap/ino/xs/rest/backoffice/odata.xsodata";}else{O="/sap/ino/xs/rest/community/odata.xsodata";}if(e){var w=this.byId("ideasFragment--ideasCarousel");w.bindAggregation("pages",p);P=a.getBackendRootURL()+O+w.mBindingInfos.pages.binding.sPath+"?$format=json";s=w.mBindingInfos.pages.binding.sFilterParams;r=w.mBindingInfos.pages.binding.sSortParams;}else{var x=this.byId("ideasFragment--ideasList");if(x){x.bindItems(p);x.attachEventOnce("updateFinished",function(){q.onResizeLayoutChange(null,q._sCurrentLayout);});P=a.getBackendRootURL()+O+x.mBindingInfos.items.binding.sPath+"?$format=json";s=x.mBindingInfos.items.binding.sFilterParams;r=x.mBindingInfos.items.binding.sSortParams;}}P=P+"&"+r+"&"+s+u;var y=new J();y.setData({path:P});sap.ui.getCore().setModel(y,"ideaSearchParams");}},_bindBlogs:function(){if(this.getCampaignId()){var i=this.getModel("device").getProperty("/system/phone");var p="data>/BlogSearchParams(searchToken='',"+"tagsToken='',"+"filterName='publishedBlogs')/Results";var o={path:p,template:this.getFragment("sap.ino.vc.blog.fragments.ListItemHome"),sorter:new S("PUBLISHED_AT",true),filters:[new F("CAMPAIGN_ID","EQ",this.getCampaignId())],length:4,top:4};var t=this;if(i){var e=this.byId("blogsFragment--blogsCarousel");e.bindAggregation("pages",o);}else{var q=this.byId("blogsFragment--blogsList");if(q){q.bindItems(o);q.attachEventOnce("updateFinished",function(){t.onResizeLayoutChange(null,t._sCurrentLayout);});}}var r=this.byId("blogsFragment--panelBlogTitle");r.setText(this.getText("HOMEPAGE_PANEL_CAMPAIGN_BLOGS"));}},_bindTopList:function(){var H=!!this.getView().getBindingContext("data").getProperty("MANAGER_HAS_DISPLAY_HOMEPAGE_SETTING");var o=this.byId("CampaignManagersFragment--CampaignManagersList").getBindingInfo("items");var e=this.byId("topCommentatorFragment--topCommentatorsList").getBindingInfo("items");if(H){o.sorter=[];var i=new F("DISPLAY_HOMEPAGE","EQ",1);o.filters=i;}this.byId("CampaignManagersFragment--CampaignManagersList").bindItems(o);this.byId("topCommentatorFragment--topCommentatorsList").bindItems(e);},_bindComments:function(){var o=this.byId("commentFragment--campaginCommentList");var e=o.getBindingInfo("items");o.bindItems(e);},_bindRegisterButton:function(){var r=this.byId("CampaignProfileFragment--registerButton");var o;var i=this.getView().getBindingContext("data").getProperty("ID");var p="/CampaignFull("+i+")";this.getModel("data").read(p,{urlParameters:{"$select":"REGISTER_STATUS"},success:function(){o=r.getBindingInfo("enabled");r.bindProperty("enabled",o);o=r.getBindingInfo("icon");r.bindProperty("icon",o);o=r.getBindingInfo("text");r.bindProperty("text",o);o=r.getBindingInfo("visible");r.bindProperty("visible",o);}});},_bindBannerList:function(){var o=this.byId("campaignBannerList");var e=o.getBindingInfo("pages");o.setActivePage(0);o.firePageChanged();o.bindAggregation("pages",e);},_bindTags:function(){if(!this._oTagTokenizer){this._oTagTokenizer=this.byId("campaignTagsFragment--campaignTags").getContent()[0];}this.byId("campaignTagsFragment--campaignTags").getContent()[0].setBusy(true);var t=this.byId("campaignTagsFragment--Tags");var o=t.getBindingInfo("tokens");t.bindAggregation("tokens",o);var e=this.getModel("data");var p=this.getView().getBindingContext("data").sPath+"/Tags";var i=this;e.read(p,{async:true,success:function(q){var r=i.byId("campaignTagsFragment--campaignTags");r.removeContent(r.getContent()[0]);if(q.results.length===0){var H=new sap.m.HBox().addStyleClass("sapInoCampaignTagsContainerNoTags");H.addItem(new sap.m.Text({text:i.getText("CAMPAIGN_LIST_FLD_NO_TAGS"),width:"100%"}).setTextAlign(c.Center));r.addContent(H);}else{r.addContent(i._oTagTokenizer);}i.byId("campaignTagsFragment--campaignTags").getContent()[0].setBusy(false);}});},_bindFeed:function(){var s=this;var p=a.getBackendRootURL()+"/sap/ino/xs/rest/common/feed.xsjs";var P=[];if(this.getCampaignId()){P.push("campaign="+this.getCampaignId());P.push("top=4");}if(P.length>0){p=p+"?"+P.join("&");}var o=new J(p);o.attachRequestCompleted(null,function(){if(o.oData.results){jQuery.each(o.oData.results,function(i,q){q.EVENT_AT=new Date(q.EVENT_AT);});}var e=s.byId("feedsFragment--feedList");e.setModel(o,"feed");},o);},onAfterRendering:function(){this._bindBannerList();},onOpenIdea:function(o){var i;if(o.getParameter("ideaId")){i=o.getParameter("ideaId");}else{try{if(o.getSource().getProperty("objectId")){i=o.getSource().getProperty("objectId");}}catch(e){i=o.getSource().getBindingContext("data").getProperty("ID");}}if(i){this.navigateTo("idea-display",{id:i});}},onOpenCampaign:function(){},onNavigateToIdeas:function(){this.navigateTo("campaign-idealist",{id:this.getCampaignId()});},onNavigateToBlogs:function(){this.navigateTo("campaign-bloglist",{id:this.getCampaignId()});},onIdeaCommentPress:function(o){var i;if(o.getParameter("ideaId")){i=o.getParameter("ideaId");}else{try{if(o.getSource().getProperty("objectId")){i=o.getSource().getProperty("objectId");}}catch(e){i=o.getSource().getBindingContext("data").getProperty("ID");}}if(i){this.navigateTo("idea-display",{id:i,query:{section:"sectionComments"}});}},onCardItemPress:function(e){var i=e.getSource();var o=i.getAggregation("content")[0];o.getFocusDomRef().focus();},onNavigateToComment:function(){this.navigateTo("campaign-comment",{id:this.getCampaignId()});},onNavigateToCampaignFeeds:function(){this.navigateTo("campaign-feeds",{id:this.getCampaignId()});},onOfficeToggle:function(){if(this._oParentView){var o=this._oParentView.getController();o.switchView();}},onOpenCampaignSettings:function(){if(this._oParentView){var o=this._oParentView.getController();if(o.openCampaignSettings){o.openCampaignSettings(this.getCampaignId());}}},showPopupTagCard:function(e){this._bIsTokenPressed=true;if(!this._oPopover){this._oPopover=sap.ui.xmlfragment("sap.ino.vc.tag.fragments.TagCardPopover",this);this.getView().addDependent(this._oPopover);}var t=e.getSource();var p="/SearchTagsAll(searchToken='',ID="+t.getKey()+")";var o=this.getModel("data");var i=this;o.read(p,{async:true,success:function(q){var r=new J();r.setData(q);i._oPopover.setModel(r,"Tag");jQuery.sap.delayedCall(0,i,function(){i._oPopover.openBy(t);});}});},onNavigateToManagers:function(){this.navigateTo("campaign-managerlist",{id:this.getCampaignId()});},onBlogItemPress:function(e){if(this._bIsTokenPressed){this._bIsTokenPressed=false;return;}var i=e.getSource();var o=i.getBindingContext("data");if(o){this.navigateTo("blog-display",{id:o.getProperty("ID")});}},onChangePage:function(e){var p=e.getParameters();var i=p.newActivePageId;$(".sapMCrslInner.sapMCrslBottomOffset").height($('#'+i).parents('.sapMCrslItem').height()+"px");$('#'+i).parents('.sapMCrslItem').fadeIn().siblings().hide().fadeIn();}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.List.controller')){jQuery.sap.declare('sap.ino.vc.campaign.List.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');sap.ui.define("sap/ino/vc/campaign/List.controller",["sap/ino/vc/commons/BaseVariantListController","sap/ino/controls/OrientationType","sap/ui/Device","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/commons/mixins/TagGroupMixin","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ino/vc/commons/mixins/ExtensibilityMixin","sap/ui/core/mvc/ViewType"],function(B,O,D,S,F,a,J,C,T,b,c,d,R,E,V){"use strict";var o={ASC:"ASC",DESC:"DESC"};var s={NONE:'',SEARCH_SCORE:"SEARCH_SCORE",NAME:"tolower(NAME)",REGISTER_TO:"REGISTER_TO",SUBMIT_TO:"SUBMIT_TO",VALID_TO:"VALID_TO",CREATED_AT:"CREATED_AT",CHANGED_AT:"CHANGED_AT"};var v={ALL:"all",ACTIVE:"active",OPEN:'open',FUTURE:"future",PAST:"past",MANAGE:"manage",DRAFT:"draft",PUBLISH:"publish",SUBMITTABLE:"submittable",REGISTERED:"registered"};var f={NONE:undefined,ACTIVE:"activeCampaigns",OPEN:"openCampaigns",FUTURE:"futureCampaigns",PAST:"pastCampaigns",MANAGE:"managedCampaigns",DRAFT:"draftCampaigns",PUBLISH:"publishCampaigns",SUBMITTABLE:"submittableCampaigns",REGISTERED:"registeredCampaigns"};var l={CAMPAIGN:"campaignlist",CAMPAIGN_VARIANT:"campaignlistvariant"};var L={NULL:"",YES:"1",NO:"0"};var m={ADJUSTMENT_TITLE:"IDEA_LIST_TIT_ADJUSTMENT",NAME:"CAMPAIGN_LIST_TIT_NAME",MANAGEDNAME:"CAMPAIGN_LIST_TIT_MANAGEDNAME",Filter:{},QuickSorter:[{TEXT:"SORT_MIT_MOST_RECENT",ACTION:s.CREATED_AT,DEFAULT_ORDER:o.DESC},{TEXT:"SORT_MIT_LATEST_CHANGE",ACTION:s.CHANGED_AT,DEFAULT_ORDER:o.DESC}],Sorter:{Values:[{TEXT:"SORT_MIT_CAMPAIGN_END",ACTION:s.VALID_TO,DEFAULT_ORDER:o.ASC},{TEXT:"SORT_MIT_REGISTER_TO",ACTION:s.REGISTER_TO,DEFAULT_ORDER:o.ASC},{TEXT:"SORT_MIT_SUBMIT_TO",ACTION:s.SUBMIT_TO,DEFAULT_ORDER:o.ASC},{TEXT:"SORT_MIT_TITLE",ACTION:s.NAME,DEFAULT_ORDER:o.ASC}],Limit:2},Order:{Values:[{TEXT:"ORDER_MIT_ASC",ACTION:o.ASC},{TEXT:"ORDER_MIT_DESC",ACTION:o.DESC}]},Variants:{DEFAULT_VARIANT:v.ALL,TITLE:"CAMPAIGN_LIST_TIT_VARIANTS",Values:[{TEXT:"CAMPAIGN_LIST_MIT_ALL",ACTION:v.ALL,FILTER:f.NONE,INCLUDE_DRAFT:false,DEFAULT_SORT:s.NAME,COUNT:"0",VISIBLE:true},{TEXT:"CAMPAIGN_LIST_MIT_ACTIVE",ACTION:v.ACTIVE,FILTER:f.ACTIVE,INCLUDE_DRAFT:false,DEFAULT_SORT:s.SUBMIT_TO,HIERARCHY_LEVEL:"1",COUNT:"0",VISIBLE:true},{TEXT:"CAMPAIGN_LIST_MIT_OPEN",ACTION:v.OPEN,FILTER:f.OPEN,INCLUDE_DRAFT:false,DEFAULT_SORT:s.SUBMIT_TO,HIERARCHY_LEVEL:"1",COUNT:"0",VISIBLE:true},{TEXT:"CAMPAIGN_LIST_MIT_FUTURE",ACTION:v.FUTURE,FILTER:f.FUTURE,INCLUDE_DRAFT:false,DEFAULT_SORT:s.SUBMIT_TO,HIERARCHY_LEVEL:"1",COUNT:"0",VISIBLE:true},{TEXT:"CAMPAIGN_LIST_MIT_CLOSED",ACTION:v.PAST,FILTER:f.PAST,INCLUDE_DRAFT:false,DEFAULT_SORT:s.SUBMIT_TO,HIERARCHY_LEVEL:"1",COUNT:"0",VISIBLE:true},{TEXT:"CAMPAIGN_LIST_MIT_REGISTERED",ACTION:v.REGISTERED,FILTER:f.REGISTERED,INCLUDE_DRAFT:false,DEFAULT_SORT:s.REGISTER_TO,HIERARCHY_LEVEL:"1",COUNT:"0",VISIBLE:true},{TEXT:"CAMPAIGN_LIST_MIT_MANAGE",ACTION:v.MANAGE,FILTER:f.MANAGE,INCLUDE_DRAFT:true,DEFAULT_SORT:s.SUBMIT_TO,VISIBLE:true,COUNT:"0",MANAGE:true},{TEXT:"CAMPAIGN_LIST_MIT_DRAFT",ACTION:v.DRAFT,FILTER:f.DRAFT,INCLUDE_DRAFT:true,DEFAULT_SORT:s.SUBMIT_TO,VISIBLE:true,HIERARCHY_LEVEL:"1",COUNT:"0",MANAGE:true},{TEXT:"CAMPAIGN_LIST_MIT_PUBLISH",ACTION:v.PUBLISH,FILTER:f.PUBLISH,INCLUDE_DRAFT:false,DEFAULT_SORT:s.VALID_TO,VISIBLE:true,HIERARCHY_LEVEL:"1",COUNT:"0",MANAGE:true},{TEXT:"CAMPAIGN_LIST_MIT_OPEN",ACTION:v.SUBMITTABLE,FILTER:f.SUBMITTABLE,INCLUDE_DRAFT:false,DEFAULT_SORT:s.SUBMIT_TO,COUNT:"0",VISIBLE:true,HIERARCHY_LEVEL:"1",MANAGE:true}]}};var e=B.extend("sap.ino.vc.campaign.List",jQuery.extend({},T,c,d,R,{routes:["campaignlist","campaignlistvariant"],initialFocus:"mainFilterButton",list:m,formatter:b,view:{NAME:"CAMPAIGN_LIST",List:{SORT:s.NAME,ORDER:undefined,MANAGE:false,VARIANT:v.ALL,TAGS:[],Default:{SORT:s.NAME,ORDER:undefined,VARIANT:v.ALL},"RESP_CODE":"","HAS_BLOG":"","IS_SHOW_MORE_FILTER":false,"IS_FILTER_SUBPAGE":true,"TAGCLOUD":true,"TAGCLOUD_EXPABLE":true,"TAGCLOUD_EXP":false,"TAGCLOUD_BAR_VISIBLE":false},ORIENTATION:C.getPersonalize().CAMPAIGN_VIEW?O.PORTRAIT:O.LANDSCAPE},onInit:function(){B.prototype.onInit.apply(this,arguments);this.oViewModel=this.getModel("view")||new J({});this.oViewModel.setData(this.view,true);this.getList().addStyleClass(this.getPortraitStyle());this.getList().setWrapping(true);this.getList().attachUpdateFinished(this.onUpdateFinished,this);},onRouteMatched:function(g,h){var q;var i;if(g&&g.getParameter){var A=g.getParameter("arguments");this._sRoute=g.getParameter("name");q=A["?query"];i=A.variant;}else{this._sRoute=g;q=h;i=h.variant;}if(this.getVariant(i)&&C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")){var j=this.getVariant(i).MANAGE?true:false;this.getModel("component").setProperty("/SHOW_BACKOFFICE",j);}var k=this.getModel("component").getProperty("/SHOW_BACKOFFICE");var n=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")&&k?v.MANAGE:this.getListProperty("/Variants/DEFAULT_VARIANT");this.setViewProperty("/List/VARIANT",i||n);i=this.getViewProperty("/List/VARIANT");var p,Q;var r=jQuery.extend(true,{},this.getVariant(i));this.checkSort(q,r.DEFAULT_SORT);this.changeDefaultSortOfVariant(r,q);var t=this.getList().isBound("items");if(!q||!q.sort){var u=r.DEFAULT_SORT;var w=this.getSort(u)[0].DEFAULT_ORDER;q=q||{};q.sort=q.sort||u;q.sort=q.sort+" "+(q.order||w);}var x=this.hasStateChanged(this._sRoute,i,q,D.orientation.portrait);if(!t||x){this.setVariantVisibility();this.setParameters(q,r);p=this.getSort(this.getViewProperty("/List/SORT"));Q=this.getQuickSort(this.getViewProperty("/List/QUICKSORT"));this.setSorter(Q.concat(p));this.updateFilter();var y=this.getViewProperty("/ORIENTATION");this.onOrientationChange(D.system.desktop?y:D.orientation);this.setSortIcon(this.byId("panelFilterFragment--sortreverse"),this.getViewProperty("/List/ORDER"));this.bindList();this.initialSorterItems();if(this.isFilterVisible()){this.bindTagCloud();}}this._bInnerViewNavigation=true;if(this.bGlobalSearchContext){return;}var z=q.search||"";var G=this.getViewProperty("/List/RESP_CODE")||'';var H=this.getViewProperty("/List/HAS_BLOG")||'';var I=this.getViewProperty("/List/TAGS");var K={};var M=[];I.forEach(function(W,X){if(!K[W.ROOTGROUPID]){K[W.ROOTGROUPID]=[];K[W.ROOTGROUPID].push(W.ID);M.push(W.ROOTGROUPID);}else{K[W.ROOTGROUPID].push(W.ID);}});var N={searchToken:window.decodeURIComponent(z),resp_code:G,has_camp_blog:H,tagTokens:K[M[0]]?K[M[0]].join(","):"",tagTokens1:K[M[1]]?K[M[1]].join(","):"",tagTokens2:K[M[2]]?K[M[2]].join(","):"",tagTokens3:K[M[3]]?K[M[3]].join(","):"",tagTokens4:K[M[4]]?K[M[4]].join(","):""};var P=this.getModel("list").getProperty("/Variants/Values");var U=this.getModel("list");C.getCampaignFilterCount(N,U,P);this.setHelp("CAMPAIGN_LIST");},onAfterShow:function(){},onBeforeHide:function(){},setVariantVisibility:function(){var g=this.getModel("list").getProperty("/Variants/Values");for(var i=0;i<g.length;i+=1){var h=g[i];var I=h.MANAGE||false;var j=(!I)||(I&&C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access"));this.getModel("list").setProperty("/Variants/Values/"+i+"/VISIBLE",j);}},getPortraitStyle:function(){return"sapInoCampaignListCardItems";},getList:function(){return this.byId("objectlist");},getBindingParameter:function(){var g,h;g=this.getViewProperty("/List/VARIANT");h=this.getCurrentVariant().FILTER;var i=this.getViewProperty("/List/SEARCH");var t=this.getViewProperty("/List/TAGS");var j=jQuery.map(t,function(p){return p.ID;});var k={};var n=[];t.forEach(function(p,q){if(!k[p.ROOTGROUPID]){k[p.ROOTGROUPID]=[];k[p.ROOTGROUPID].push(p.ID);n.push(p.ROOTGROUPID);}else{k[p.ROOTGROUPID].push(p.ID);}});return{Variant:g,VariantFilter:h,SearchTerm:i,TagIds:j,tagGroup:k,tagGroupKey:n};},getBindingPath:function(q){var i=this._check4ManagingList()?1:0;if(!q||q==={}||(q.search===undefined&&q.tags===undefined&&q.variant===undefined)){return{Path:"CampaignFull"};}return{Path:"CampaignSearchParams(searchToken='"+(q.search||"")+"',"+"tagsToken='"+(q.tagGroup[q.tagGroupKey[0]]?q.tagGroup[q.tagGroupKey[0]].join(","):"")+"',"+"tagsToken1='"+(q.tagGroup[q.tagGroupKey[1]]?q.tagGroup[q.tagGroupKey[1]].join(","):"")+"',"+"tagsToken2='"+(q.tagGroup[q.tagGroupKey[2]]?q.tagGroup[q.tagGroupKey[2]].join(","):"")+"',"+"tagsToken3='"+(q.tagGroup[q.tagGroupKey[3]]?q.tagGroup[q.tagGroupKey[3]].join(","):"")+"',"+"tagsToken4='"+(q.tagGroup[q.tagGroupKey[4]]?q.tagGroup[q.tagGroupKey[4]].join(","):"")+"',"+"filterName='"+(q.variant||"")+"',"+"filterBackoffice="+(i||"0")+")/Results"};},bindList:function(){this.saveState();var g=this.getBindingParameter();var h=this.getBindingPath({search:g.SearchTerm,tags:g.TagIds,tagGroup:g.tagGroup,tagGroupKey:g.tagGroupKey,variant:g.VariantFilter});this.setPath("data>/"+h.Path);B.prototype.bindList.apply(this);},includeDrafts:function(){return this.getCurrentVariant().INCLUDE_DRAFT;},bindTagCloud:function(){var g=this.getBindingParameter();var p=C.getBackendRootURL()+"/sap/ino/xs/rest/common/tagcloud_campaigns.xsjs";var P=[];if(!this.includeDrafts()){P.push("EXCL_STATUS=sap.ino.config.CAMP_DRAFT");}if(g&&g.TagIds){jQuery.each(g.TagIds,function(k,i){P.push("TAG="+i);});}if(g.SearchTerm&&g.SearchTerm.length>0){P.push("SEARCHTERM="+g.SearchTerm);}if(g.VariantFilter){P.push("FILTERNAME="+g.VariantFilter);}if(this.getViewProperty("/List/RESP_CODE")){P.push("RESP_VALUE_CODE="+this.getViewProperty("/List/RESP_CODE"));}if(this.getViewProperty("/List/HAS_BLOG")){P.push("HAS_BLOG="+this.getViewProperty("/List/HAS_BLOG"));}p=p+"?";if(P.length>0){p=p+"&"+P.join("&");}if(this._lastTagServicePath===p){return;}this._attachRequestCompleted(p);this._lastTagServicePath=p;},_attachRequestCompleted:function(p){var g=this;var h=g.getText("CAMPAIGN_LIST_FLD_TAG_GROUP_OTHER");var t=new sap.ui.model.json.JSONModel(p);t.attachRequestCompleted(null,function(){var r=t.getData().RANKED_TAG;var i=t.getData().TAG_GROUP;var j=g.groupByTagGroup(r,g.getViewProperty("/List/TAGS"),h);jQuery.each(j,function(k,n){if(n.GROUP_NAME==="Other"){i.push(n);}});g.setTagCloudProperty(j,t.getData().WITHOUT_GROUP!=="X");t.setData({"RANKED_TAG":j,"TAG_GROUP":i},false);g.setFilterModel(t,"tag");},t);},getItemTemplate:function(){var r;var i=this._check4ManagingList();if(i){r="Managed_Protrait";}if(i){if(this.getViewProperty("/ORIENTATION")===O.LANDSCAPE){r="Managed_Landscape";}}else if((!D.system.desktop&&D.orientation.landscape)||(D.system.desktop&&this.getViewProperty("/ORIENTATION")===O.LANDSCAPE)){r="Landscape";}else{r="Portrait";}var t;switch(r){case"Managed_Landscape":t=this.getFragment("sap.ino.vc.campaign.fragments.CampaignListItem");break;case"Landscape":t=this.getFragment("sap.ino.vc.campaign.fragments.FlatListItem");break;case"Portrait":t=this.getFragment("sap.ino.vc.campaign.fragments.CardListItem");break;case"Managed_Protrait":t=this.getFragment("sap.ino.vc.campaign.fragments.ManagedCardListItem");break;default:break;}return t;},onOrientationChange:function(g){var i=this._check4ManagingList();if(this.getList()){if(i){if(this.getPortraitStyle){this.getList().addStyleClass(this.getPortraitStyle());}if(this.getLandscapeStyle){this.getList().removeStyleClass(this.getLandscapeStyle());}}}if(this.getList()){if(i||g===O.LANDSCAPE||g.landscape){if(g===O.LANDSCAPE){if(this.getPortraitStyle){this.getList().removeStyleClass(this.getPortraitStyle());}if(this.getLandscapeStyle){this.getList().addStyleClass(this.getLandscapeStyle());}}}else{if(this.getPortraitStyle){this.getList().addStyleClass(this.getPortraitStyle());}if(this.getLandscapeStyle){this.getList().removeStyleClass(this.getLandscapeStyle());}}this.getList().setWrapping(!(g===O.LANDSCAPE));}},setParameters:function(q,g){B.prototype.setParameters.apply(this,arguments);this.setViewProperty("/List/MANAGE",g.MANAGE);this.setViewProperty("/List/TAGCLOUD",true);q=q||{};var r=q.respCode;var h=q.hasBlog;this.setViewProperty("/List/RESP_CODE",r);this.setViewProperty("/List/HAS_BLOG",h);this.removeSubFilterPageContent();this.addSubFilterPageContent(this.getAdditionalFilter());},onVariantPress:function(g,h){B.prototype.onVariantPress.apply(this,[g,h,"campaignlistvariant","campaignlist"]);},updateFilter:function(){var g=[];this.setFilter([]);if(!this.getCurrentVariant().INCLUDE_DRAFT&&!this.isCampaignDraftFilterExisted()){g.push(new F("STATUS_CODE",a.NE,"sap.ino.config.CAMP_DRAFT"));}var r=this.getViewProperty("/List/RESP_CODE");if(r){g.push(new F("RESP_CODE",a.EQ,r));}var h=this.getViewProperty("/List/HAS_BLOG");switch(h){case"1":g.push(new F("BLOG_COUNTS",a.GE,1));break;case"0":g.push(new F("BLOG_COUNTS",a.EQ,null));break;default:break;}if(g.length>0){this.addFilter(new F({filters:g,and:true}));}},isCampaignDraftFilterExisted:function(){var g=this.getFilter();var h;for(var i=0;i<g.length;i++){h=g[i];if(h.aFilters&&h.aFilters.length>0){if(h.aFilters[0].oValue1==="sap.ino.config.CAMP_DRAFT"&&h.aFilters[0].sOperator===a.NE&&h.aFilters[0].sPath==="STATUS_CODE"){return true;}}}return false;},onItemPress:function(g){var i=g.getSource();var h=i.getBindingContext("data");if(h){this.navigateTo("campaign",{id:h.getProperty("ID")});}},onCardItemPress:function(g){var i=g.getSource();var h=i.getAggregation("content")[0];h.getFocusDomRef().focus();},onCreateIdea:function(g){this.navigateTo("idea-create",{query:{campaign:g.getParameter("campaignId")}});},onSetFilterBarVisible:function(){this.bindTagCloud();},onApplyFilter:function(){var g=this.getFilterDialog();if(JSON.stringify(this.getViewModelBackup())===JSON.stringify(this.getViewProperty("/"))){g.close();return;}var q=this.getQuery();var h=this.getViewProperty("/List/VARIANT");var r=this.getRoute();var p={query:q};p.variant=h;this.navigateTo(this.getRoute(true),p,true,true);g.close();},formatObjectListVariantsVisible:function(i,I){return true;},_check4ManagingList:function(){var g=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");if(g){var h=this.getViewProperty("/List/VARIANT");var i=this.getListProperty("/Variants/Values");var j=jQuery.grep(i,function(k){return k.ACTION===h;});j=(j&&j.length>0)?j[0]:{};return j.MANAGE||false;}return false;},onCampaignsListItemPress:function(g){var i=g.getSource();var h=i.getBindingContext("data");if(h){this.navigateTo("campaign",{id:h.getProperty("ID")});}},onOpenCampaignSettings:function(g){var h=g.getSource();var i=h.getBindingContext("data");this.navigateToByURLInNewWindow(C.getCampaignSettingsURL(i.getProperty("ID")));},createState:function(r,g,q,p){var h=B.prototype.createState.apply(this,arguments);h.query.status=q.status;h.query.respCode=q.respCode;h.query.hasBlog=q.hasBlog;return h;},getQuery:function(){var q={};var g=this.getViewProperty("/List/SORT");var r=this.getViewProperty("/List/RESP_CODE");var h=this.getViewProperty("/List/HAS_BLOG");var t=this.getViewProperty("/List/TAGS");var i=this.getViewProperty('/List/QUICKSORT');var j=this.getViewProperty('/List/SEARCH');if(g){q.sort=g;}if(r){q.respCode=r;}if(h){q.hasBlog=h;}if(t&&t.length>0){q.tags=JSON.stringify(t);}if(i){q.quickSort=i;}if(j){q.search=j;}return q;},addSubFilterPageContent:function(g){var n=this.getFilterNavContainer();var p=n.getPages();p[0].getContent()[0].addItem(g);},removeSubFilterPageContent:function(){var n=this.getFilterNavContainer();var p=n.getPages();var g=p[0].getContent()[0];if(g.getItems().length>2){g.getItems()[2].destroy(true);}},onFilterRespListChange:function(g){var h=g.getSource().getSelectedItem();if(h.getSelectedItem){h=h.getSelectedItem();}var k=h.getProperty("key");this.setViewProperty("/List/RESP_CODE",k);this.navigateIntern(this.getQuery(),true,true);},onFilterHasBlogChange:function(g){var h=g.getSource().getSelectedItem();if(h.getSelectedItem){h=h.getSelectedItem();}var k=h.getProperty("key");this.setViewProperty("/List/HAS_BLOG",k);this.navigateIntern(this.getQuery(),true,true);},getAdditionalFilter:function(){var g;g=this.createFragment("sap.ino.vc.campaign.fragments.FilterItems",this.createIdForFilterElement());return g;},onMoreFilterChange:function(g){var n=this.getFilterNavContainer();var p=n.getPages();var h=p[0].getContent()[0];if(h.getItems().length>2){var _=function(i){this.getFilterElementById("filterItems").setBusy(false);}.bind(this,h);this.setViewProperty("/List/IS_SHOW_MORE_FILTER",true);g.getSource().setVisible(false);this.getFilterElementById("filterItems").setBusyIndicatorDelay(0).setBusy(true);setTimeout(function(i){this.bindFilters(i);}.bind(this,_),0);}},bindFilters:function(g){var t=this;var h=this.getModel("view");var r=C.getBackendRootURL()+"/sap/ino/xs/rest/common/campaign_filter_resp_values.xsjs";var p={CAMPAIGN_ID:this.getBindingParameter().CampaignId===undefined?undefined:parseInt(this.getBindingParameter().CampaignId,10)};var H=[];H.push({code:L.NULL,text:""});H.push({code:L.YES,text:t.getText("CAMPAIGN_LIST_MIT_FILTER_YES")});H.push({code:L.NO,text:t.getText("CAMPAIGN_LIST_MIT_FILTER_NO")});h.setProperty("/HAS_BLOG",H);jQuery.ajax({url:r,headers:{"X-CSRF-Token":"Fetch"},data:p,type:"GET",contentType:"application/json; charset=UTF-8",async:false,success:function(i){var j=i.RespValues;if(j&&j.length>0){j.sort(function(P,n){return P.DEFAULT_TEXT.localeCompare(n.DEFAULT_TEXT);});}var k=[{CODE:"",DEFAULT_LONG_TEXT:"",DEFAULT_TEXT:""}].concat(j);h.setProperty("/resp",k);if(g&&typeof g==="function"){g();}}});},resetFilter:function(){var r=this.getRoute();this.setViewProperty("/List/RESP_CODE","");this.setViewProperty("/List/HAS_BLOG","");B.prototype.resetFilter.apply(this,arguments);},onFilterReset:function(){this.setViewProperty("/List/TAGS",[]);this.setViewProperty("/List/IS_TAGS_SELECTION",false);this.setViewProperty("/List/IS_SHOW_MORE_FILTER",false);this.resetFilter();if(!D.system.desktop){return;}this.navigateIntern(this.getQuery(),true);},changeDefaultSortOfVariant:function(g,q){if(q&&q.search&&(g.ACTION==="manage"||g.ACTION==="all")){g.DEFAULT_SORT="SEARCH_SCORE";}else if(g.ACTION==="manage"||g.ACTION==="all"){jQuery.each(this.list.Variants.Values,function(i,h){if(h.ACTION===g.ACTION){g.DEFAULT_SORT=h.DEFAULT_SORT;return false;}});}},onOfficeToggle:function(){var g=this.getModel("component").getProperty("/SHOW_BACKOFFICE");g=!g;this.getModel("component").setProperty("/SHOW_BACKOFFICE",g);var h={query:{},variant:''};if(g){h.variant=v.MANAGE;}else{h.variant=v.ALL;}if(this.getViewProperty("/List/SEARCH")){h.query.search=this.getViewProperty("/List/SEARCH");h.query.sort=this.getViewProperty("/List/SORT");}this.navigateTo("campaignlistvariant",h,true,true);}}));e.list=m;e.listContext=l;return e;});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.RegistrationHome.controller')){jQuery.sap.declare('sap.ino.vc.campaign.RegistrationHome.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/ino/vc/campaign/RegistrationHome.controller",["sap/ino/vc/commons/BaseObjectController","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/application/Configuration","sap/ui/core/ResizeHandler","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ino/vc/campaign/mixins/CampaignProfileMixin","sap/ino/vc/campaign/mixins/MilestoneMixin","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(C,D,J,T,a,R,O,F,b,c,M,S,d,e){"use strict";var l={XS:{centerProfileContainer:"RegistrationProfileFragment--registrationProfile",centerCampaignManagerContainer:"CampaignManagersFragment--CampaignManagers"},S:{leftProfileContainer:"RegistrationProfileFragment--registrationProfile",leftCampaignManagerContainer:"CampaignManagersFragment--CampaignManagers"},M:{leftProfileContainer:"RegistrationProfileFragment--registrationProfile",leftrCampaignManagerContainer:"CampaignManagersFragment--CampaignManagers"},L:{leftProfileContainer:"RegistrationProfileFragment--registrationProfile",leftCampaignManagerContainer:"CampaignManagersFragment--CampaignManagers"},XL:{leftProfileContainer:"RegistrationProfileFragment--registrationProfile",leftCampaignManagerContainer:"CampaignManagersFragment--CampaignManagers"}};return C.extend("sap.ino.vc.campaign.RegistrationHome",jQuery.extend({},F,b,c,M,{formatter:jQuery.extend({},this.formatter,O),onInit:function(){C.prototype.onInit.apply(this,arguments);this.aBusyControls=[this.getView()];},show:function(p){this._oParentView=p;var f=this.byId('campaignBannerList');f.addEventDelegate({onAfterRendering:function(){$(".sapMCrslInner.sapMCrslBottomOffset").height($('#'+f.getActivePage()).parents('.sapMCrslItem').height()+"px");$('#'+f.getActivePage()).parents('.sapMCrslItem ').fadeIn();}});this.getView().setModel(new J({ID:this.getView().getBindingContext("data").getProperty("ID"),NAME:this.getView().getBindingContext("data").getProperty("SHORT_NAME"),_OBJECT_TYPE_CODE:"CAMPAIGN"}),"contextObject");this.bindMilestone(this.getCampaignId());this._bindAdjustCampaignManagerList();},_bindBlogs:function(){if(this.getCampaignId()){var i=this.getModel("device").getProperty("/system/phone");var p="data>/BlogSearchParams(searchToken='',"+"tagsToken='',"+"filterName='publishedBlogs')/Results";var B={path:p,template:this.getFragment("sap.ino.vc.blog.fragments.ListItemHome"),sorter:new S("PUBLISHED_AT",true),filters:[new d("CAMPAIGN_ID","EQ",this.getCampaignId())],length:4,top:4};var t=this;if(i){var o=this.byId("blogsFragment--blogsCarousel");o.bindAggregation("pages",B);}else{var L=this.byId("blogsFragment--blogsList");if(L){L.bindItems(B);L.attachEventOnce("updateFinished",function(){t.onResizeLayoutChange(null,t._sCurrentLayout);});}}var f=this.byId("blogsFragment--panelBlogTitle");f.setText(this.getText("HOMEPAGE_PANEL_CAMPAIGN_BLOGS"));}},getLayout:function(L){return l[L];},getCampaignId:function(){return this.getView().getBindingContext("data")?this.getView().getBindingContext("data").getProperty("ID"):undefined;},_bindBannerList:function(){var B=this.byId("campaignBannerList");if(B.getAggregation("pages")&&B.getAggregation("pages").length&&B.getAggregation("pages")[0]){var o=B.getBindingInfo("pages");B.bindAggregation("pages",o);}},onNavigateToManagers:function(E){this.navigateTo("campaign-managerlist",{id:this.getCampaignId()});},onAfterShow:function(){this._bindBannerList();},onChangePage:function(f){var p=f.getParameters();var n=p.newActivePageId;$(".sapMCrslInner.sapMCrslBottomOffset").height($('#'+n).parents('.sapMCrslItem').height()+"px");$('#'+n).parents('.sapMCrslItem').fadeIn().siblings().hide().fadeIn();},_bindAdjustCampaignManagerList:function(){var h=!!this.getView().getBindingContext("data").getProperty("MANAGER_HAS_DISPLAY_HOMEPAGE_SETTING");var o=this.byId("CampaignManagersFragment--CampaignManagersList").getBindingInfo("items");if(h){o.sorter=[];var f=new d("DISPLAY_HOMEPAGE","EQ",1);o.filters=f;}this.byId("CampaignManagersFragment--CampaignManagersList").bindItems(o);}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.comment.Comment.controller')){jQuery.sap.declare('sap.ino.vc.comment.Comment.controller');jQuery.sap.require('sap.ui.core.mvc.ViewType');sap.ui.define("sap/ino/vc/comment/Comment.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ui/core/mvc/ViewType","sap/ino/vc/comment/CommentMixin"],function(C,V,a){"use strict";return C.extend("sap.ino.vc.comment.Comment",jQuery.extend({},a,{onInit:function(){C.prototype.onInit.apply(this,arguments);},onBeforeRendering:function(e){this.commentMixinInit({commentInputId:"commentInputField",commentListId:"commentList",successMessageKey:"MSG_CREATE_SUCCESS_COMMENT",editDialogViewName:"sap.ino.vc.comment.EditCommentDialog"});},onAfterRendering:function(){this.byId("commentList").addEventDelegate({onAfterRendering:function(e){var l=e.srcControl;var i=l.$().find("li");jQuery.each(i,function(I,o){var $=jQuery(o);$.attr("aria-label",$.getEncodedText());});}});}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.comment.RichComment.controller')){jQuery.sap.declare('sap.ino.vc.comment.RichComment.controller');sap.ui.define("sap/ino/vc/comment/RichComment.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ino/vc/comment/RichCommentCntrlMixin","sap/ino/vc/comment/RichCommentMixin","sap/ino/vc/comment/RichCommentAttachmentMixin","sap/ino/commons/models/object/IdeaLatest","sap/ino/commons/formatters/BaseFormatter"],function(B,R,a,b,I,c){"use strict";return B.extend("sap.ino.vc.comment.RichComment",jQuery.extend({},R,a,b,{routes:"idea-display",formatter:c,sectionName:"sectionComments",onInit:function(){B.prototype.onInit.apply(this,arguments);this.getView().setModel(null,"comment");this.richCommentMixinInitRouterEvent();},onAfterRendering:function(){this.richCommentMixinInit();this.richAttachmentMixinInit();this.setAccessibilityProperty();}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.Display.controller')){jQuery.sap.declare('sap.ino.vc.evaluation.Display.controller');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/evaluation/Display.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/commons/models/object/Evaluation","sap/ino/vc/evaluation/EvaluationFacet","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/Attachment","sap/ino/vc/commons/TopLevelPageFacet"],function(B,E,a,M,J,A,T){"use strict";var b=A.getEndpointURL();return B.extend("sap.ino.vc.evaluation.Display",jQuery.extend({},T,a,{routes:["evaluation-display"],onInit:function(){B.prototype.onInit.apply(this,arguments);if(!this.getModel("local")){this.setModel(new J({ATTACHMENT_UPLOAD_URL:b}),"local");}this.setModel(new J({EVAL_REWORK:"sap.ino.config.EVAL_REWORK",V_REWORK:false,EVAL_PUB_SUBMITTER:"sap.ino.config.EVAL_PUB_SUBMITTER",V_PUB_SUBMITTER:false,EVAL_PUB_COMMUNITY:"sap.ino.config.EVAL_PUB_COMMUNITY",V_PUB_COMMUNITY:false,EVAL_UNPUBLISH:"sap.ino.config.EVAL_UNPUBLISH",V_UNPUBLISH:false}),"status");var v=this.getModel("view");if(!v){v=new J({});this.setModel(v,"view");}v.setProperty("/IDEA_NAVIGATION_SECTION","sectionEvaluations");v.setProperty("/EDIT_MODE",false);this.aBusyControls=[this.byId("evaluationLayout")];this.initMatrixControl();this.scrollDockElement("evaluationDisplay","evaluationMatrix");this._sResizeEvalList=this.attachListControlResized(this.byId("criteriaList"));},onExit:function(){B.prototype.onExit.apply(this,arguments);this.detachListControlResized(this._sResizeEvalList);},resetStatusModel:function(){var s=this.getModel("status");s.setProperty("/V_REWORK",false);s.setProperty("/V_PUB_COMMUNITY",false);s.setProperty("/V_PUB_SUBMITTER",false);s.setProperty("/V_UNPUBLISH",false);},setStatusChangeButtons:function(){var n=this.getObjectModel()&&this.getObjectModel().getPropertyModel().getData().actions.executeStatusTransition.customProperties&&this.getObjectModel().getPropertyModel().getData().actions.executeStatusTransition.customProperties.statusTransitions;if(!n){return;}this.resetStatusModel();var s=this.getModel("status");jQuery.each(n,function(i,k){switch(k.STATUS_ACTION_CODE){case"sap.ino.config.EVAL_REWORK":s.setProperty("/V_REWORK",true);break;case"sap.ino.config.EVAL_PUB_SUBMITTER":s.setProperty("/V_PUB_SUBMITTER",true);break;case"sap.ino.config.EVAL_PUB_COMMUNITY":s.setProperty("/V_PUB_COMMUNITY",true);break;case"sap.ino.config.EVAL_UNPUBLISH":s.setProperty("/V_UNPUBLISH",true);break;default:break;}});},onRouteMatched:function(e){B.prototype.onRouteMatched.apply(this,arguments);var t=this;var o=this.getObjectModel();o.getDataInitializedPromise().done(function(){t.setHelp("EVALUATION_DISPLAY");});o.getPropertyModel().attachEvent("modelInitialized",function(){t.setStatusChangeButtons();});this.bindMatrix();},createObjectModel:function(o){return new E(o,{actions:["update","del","executeStatusTransition","submit"],continuousUse:true,readSource:{model:this.getDefaultODataModel(),groupSetting:{EvalAttachments:"IdeaEvalAttachments"}}});},onExecuteStatusTransition:function(e){var t=this;var c=this.getObjectModel();var d;if(!c){return;}var s=e.getSource().getCustomData()[0].getValue();var i=s==="sap.ino.config.EVAL_REWORK";d=c.executeStatusTransition({STATUS_ACTION_CODE:s,IDEA_ID:c.getProperty("/IDEA_ID")});if(d){d.done(function(){M.show(t.getText("OBJECT_MSG_STATUS_CHANGE_SUCCESS"));if(i){t.resetStatusModel();t.setObjectModel(undefined);t.onNavBack(true);}});d.fail(function(o){if(i){t.onNavBack(true);}if(o.MESSAGES&&o.MESSAGES.length>0){M.show(t.getText(o.MESSAGES[0].MESSAGE_TEXT));}});}},onEdit:function(){this.navigateTo("evaluation-edit",{id:this.getObjectModel().getKey()});},onClose:function(){this.navigateBack();}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.evaluation.RequestsModify.controller')){jQuery.sap.declare('sap.ino.vc.evaluation.RequestsModify.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.core.MessageType');jQuery.sap.require('sap.ui.core.message.Message');sap.ui.define("sap/ino/vc/evaluation/RequestsModify.controller",["sap/ino/vc/commons/BaseObjectModifyController","sap/ui/model/json/JSONModel","sap/ino/commons/models/object/EvaluationRequest","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/ui/core/MessageType","sap/ui/core/message/Message","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/vc/evaluation/mixins/ExpertFinderMixin","sap/ino/vc/idea/mixins/AddExpertFromClipboardMixin","sap/ino/vc/evaluation/EvaluationFormatter","sap/ino/commons/util/DateUtil"],function(B,J,E,F,a,S,M,b,T,c,A,d,D){"use strict";var r={create:"evaluationrequest-create",edit:"evaluationrequest-edit"};return B.extend("sap.ino.vc.evaluation.RequestsModify",jQuery.extend({},T,c,A,{view:{CLIPBOARD_ITEM_SELECT_COUNTER:0,IS_EVALUATION_REQUEST:false},routes:[r.create,r.edit],_INPUT_EXPERTS_SETTING:{childNodeName:"Experts",childNodeNameSingular:"Expert",suggestion:{key:"ID",text:"NAME",additionalText:"USER_NAME",path:"data>/SearchIdentity(searchToken='$suggestValue')/Results",sorter:new S("NAME")},token:{key:"IDENTITY_ID",text:"NAME"}},onInit:function(){B.prototype.onInit.apply(this,arguments);this.addMultiInputHandling(this.byId("inputExperts"),this._INPUT_EXPERTS_SETTING);this.byId("inputExperts").attachTokenUpdate(this._tokenUpdate,this);this.getView().setModel(new J(this.view),"view");this.setViewProperty("/IS_EVALUATION_REQUEST",true);},_initExpertsFilters:function(){this._findFilters(this.getObjectModel().getProperty("/Experts"),function(e){return e.IDENTITY_ID;});},_tokenUpdate:function(e){if(!e.getSource().getAggregation("tokenizer")){return;}var t=e.getSource().getAggregation("tokenizer").getAggregation("tokens");this._findFilters(t,function(o){return o.getProperty("key");});},_findFilters:function(k,g){this._INPUT_EXPERTS_SETTING.suggestion.filters=undefined;if(!k||k.length<=0){return;}var f=[];jQuery.each(k,function(i,K){f.push(new sap.ui.model.Filter({path:"ID",operator:"NE",value1:g(K)}));});this._INPUT_EXPERTS_SETTING.suggestion.filters=new sap.ui.model.Filter({filters:f,and:true});},createObjectModel:function(o,R,e){var C=this;var k=o;var s={nodes:["Root"],continuousUse:true,concurrencyEnabled:true,readSource:{model:this.getDefaultODataModel()}};var f=new E(k,s);if(!k){var q=e["?query"]||{};var n=parseInt(q.idea,10);try{C.getView().setBusy(true);jQuery.when(f.getReadSourceModel().read("/IdeaMedium("+n+")",{success:function(i){f.setProperty("/RESP_VALUE_CODE",i.RESP_VALUE_CODE);f.setProperty("/IDEA_NAME",i.NAME);f.setProperty("/IDEA_ID",i.ID);f.setProperty("/IDEA_PHASE_CODE",i.PHASE);f.setProperty("/CAMPAIGN_SUBMIT_TO",i.CAMPAIGN_SUBMIT_TO);}})).done(function(){C.getView().setBusy(false);});jQuery.when(f.getReadSourceModel().read("/IdeaFull("+n+")/Experts",{success:function(i){f.setProperty("/IdeaExpertsForDialog",i.results);}})).done(function(){C.getView().setBusy(false);});jQuery.when(f.getReadSourceModel().read("/IdeaFull("+n+")/RespExperts",{success:function(i){f.setProperty("/RespExpertsForDialog",i.results);}})).done(function(){C.getView().setBusy(false);});jQuery.when(f.getReadSourceModel().read("/IdeaFull("+n+")/CampaignExperts",{success:function(i){f.setProperty("/CampExpertsForDialog",i.results);}})).done(function(){C.getView().setBusy(false);});}catch(g){jQuery.sap.log.error("Failed parsing creation arguments",g,"evaluationrequest-create");}}return f;},onRouteMatched:function(){var C=this;B.prototype.onRouteMatched.apply(this,arguments);C.setHelp("EVALUATIONREQUESTS_MODIFY");C.getObjectModel().getDataInitializedPromise().done(function(){C._initExpertsFilters();});},onSubmit:function(){var C=this;C.resetClientMessages();if(!C.validateContent()){return;}var o=C.getObjectModel().oData;var e=sap.ino.commons.models.object.EvaluationRequest.checkBeforeUpdate(o);e.done(function(R){if(R&&R.RESULT){C.onConfirmDialog(R.RESULT);}else{C.onModify();}});},onModify:function(){var C=this;var o=C.getObjectModel();var e=C.getObjectModel().oData;e.ACCEPT_DATE=D.convertToUtcString(e.ACCEPT_DATE);e.COMPLETE_DATE=D.convertToUtcString(e.COMPLETE_DATE);var m=this.executeObjectAction("modify",{messages:{error:"MSG_EVAL_REQ_INVALID_ERROR"}});m.done(function(){C.navigateTo("idea-display",{id:o.getProperty("/IDEA_ID"),query:{section:"sectionEvaluations"}},true);});m.fail(function(){e.ACCEPT_DATE=D.convertToLocalDate(e.ACCEPT_DATE);e.COMPLETE_DATE=D.convertToLocalDate(e.COMPLETE_DATE);});},onIdeaPressed:function(){var i=this.getObjectModel().getProperty("/IDEA_ID");this.navigateTo("idea-display",{id:i},true);},onDelete:function(e){var C=this;C.resetClientMessages();var o=e.getSource();var f=this.executeObjectAction("del",{messages:{confirm:"MSG_DEL_CONFIRM",success:"MSG_DEL_SUCCESS"}});f.done(function(R){if(R&&R.confirmationCancelled===true){if(o&&jQuery.type(o.focus)==="function"){o.focus();}return;}C.navigateBack();});},onConfirmDialog:function(R){var _={"EXPERT_AMOUNT_WARNING":"MSG_EVAL_REQ_MAX_EXPERT_WARNING","DUPLICATED_EXPERT_WARNING":"MSG_EVAL_REQ_DUPLICATED_EXPERT_WARNING","EXISTED_EVALUATION_WARNING":"MSG_EVAL_REQ_EXISTED_EVALUATION_WARNING"};var C=this;var v=new sap.m.VBox();if(!R||R.length<=0){C.onModify();return;}jQuery.each(R,function(i,f){var o=f instanceof Object;var s=f;if(o){s=f.MSG_CODE;}var t=C.getText(_[s]);var g=new sap.m.Text({text:t});if(!o){g.addStyleClass("sapUiSmallMarginBottom");}v.addItem(g);var h='';if(o&&f.DuplExperts){jQuery.each(f.DuplExperts,function(j,k){h+="<li>"+k+"</li>";});v.addItem(new sap.ui.core.HTML({content:"<ul class='sapUiTinyMarginTop sapUiSmallMarginBottom'>"+h+"</ul>",sanitizeContent:true}));}});var e=new sap.m.Dialog({title:C.getText('IDEA_OBJECT_TIT_CONFIRM_EVALUATION_REQUEST'),type:'Message',content:[v],beginButton:new sap.m.Button({text:C.getText('BTN_OK'),press:function(){var f=C.getObjectModel().getProperty("/Experts");jQuery.each(R,function(i,g){jQuery.each(g.DuplExperts,function(h,s){for(var j=f.length-1;j>=0;j--){if(f[j].NAME===s){f.splice(j,1);}}});});C._initExpertsFilters();C.getObjectModel().setProperty("/Experts",f);C.onModify();e.close();}}),endButton:new sap.m.Button({text:C.getText("BTN_CANCEL"),press:function(){e.close();}}),afterClose:function(){e.destroy();}});e.open();},validateContent:function(){var C=this;var m=C.getObjectModel();var e=m.getProperty("/Experts");if(!e||e.length<=0){var o=new b({code:"MSG_EVAL_REQ_EXPERTS_MANDATORY_ERROR",type:M.Error});C.setClientMessage(o,C.byId("inputExperts"));return false;}if(!m.getProperty("/ACCEPT_DATE")){C.setClientMessage(new b({code:"MSG_EVAL_REQ_ACCEPTANCE_MANDATORY_ERROR",type:M.Error}),C.byId("dpAcceptDate"));return false;}if(!m.getProperty("/COMPLETE_DATE")){C.setClientMessage(new b({code:"MSG_EVAL_REQ_COMPLETION_MANDATORY_ERROR",type:M.Error}),C.byId("dpCompletetDate"));return false;}if(!m.getProperty("/DESCRIPTION")){C.setClientMessage(new b({code:"MSG_EVAL_REQ_DESCRIPTION_MANDATORY_ERROR",type:M.Error}),C.byId("txtAreaDesc"));return false;}return true;},toSubmitDate:function(t,e){return t+" "+d.toDate(e);}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.home.BackOfficeHome.controller')){jQuery.sap.declare('sap.ino.vc.home.BackOfficeHome.controller');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/home/BackOfficeHome.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/vc/iam/mixins/IdentityProfileMixin","sap/ino/commons/formatters/ObjectListFormatter","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ino/commons/application/Configuration","sap/ino/vc/idea/mixins/FollowUpMixin","sap/ino/vc/idea/mixins/AssignmentActionMixin","sap/ino/vc/idea/mixins/ChangeStatusActionMixin","sap/ino/vc/idea/mixins/DeleteActionMixin","sap/ino/vc/idea/mixins/AddExpertFromClipboardMixin","sap/ino/vc/evaluation/EvaluationFormatter","sap/ino/vc/idea/mixins/MergeActionMixin","sap/ino/vc/blog/mixins/DeleteActionMixin","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/vc/campaign/mixins/RegistrationMixin","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/idea/RewardFormatter","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ino/vc/follow/mixins/FeedsMixin","sap/ino/vc/idea/mixins/IdeaFormCriteriaFilterMixin","sap/ino/commons/models/object/Homepagewidget","sap/ui/model/json/JSONModel"],function(C,I,O,S,F,a,b,A,c,D,d,E,M,B,T,R,e,f,V,g,h,i,H,J){"use strict";var l={"follow":{filterParam:"",filter:[new F("FOLLOW_UP_ID","NE",null),new F("STATUS","NE","sap.ino.config.DRAFT")],sorter:new S("FOLLOW_UP_DATE",false)},"coachme":{filterParam:"",filter:[new F("COACH_ID","EQ",a.getCurrentUser().USER_ID),new F("STATUS","NE","sap.ino.config.DRAFT")],sorter:new S("SUBMITTED_AT",false)},"unassigned":{filterParam:"unassignedCoach",filter:[new F("STATUS","NE","sap.ino.config.DRAFT")],sorter:new S("SUBMITTED_AT",true)},"evaldone":{filterParam:"evaluatedIdeas",filter:[new F("STATUS","NE","sap.ino.config.DRAFT")],sorter:new S("LAST_PUBL_EVAL_AT",true)}};var m={"published":{filterParam:"publishedBlogs",filter:[],sorter:new S("PUBLISHED_AT",true),name:"publish"},"draft":{filterParam:"draftBlogs",filter:[],sorter:new S("CHANGED_AT",true),name:"draft"},"all":{filterParam:"",filter:[],sorter:new S("PUBLISHED_AT",true),name:"all"}};var j={Backoffice:{PATH:"/BackofficeEntityCount(1)",Binding:[{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_COACHED",COUNT:"COACHED_BY_ME_IDEA_COUNT",Route:{NAME:"idealistvariant",QUERY:{variant:"coachme"}},ROLES:["sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{ICON:"sap-icon://InoIcons/campaign",LINK_TEXT:"PROFILE_LNK_MANAGED_CAMPAIGNS",COUNT:"MANAGED_CAMPAIGN_COUNT",Route:{NAME:"campaignlistvariant",QUERY:{variant:"manage"}},ROLES:["sap.ino.ui::camps_mgr_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_UNASSIGNED",COUNT:"UNASSIGNED_IDEA_COUNT",Route:{NAME:"idealistvariant",QUERY:{variant:"unassigned"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{ICON:"sap-icon://hr-approval",LINK_TEXT:"REGISTER_APPR_LIST_TIT",COUNT:"MY_PENDING_APPR_COUNT",Route:{NAME:"registerapprovallistvariant",QUERY:{variant:"pending"}},ROLES:["sap.ino.ui::camps_mgr_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEA_FOLLOWUP",COUNT:"FOLLOW_UP_IDEA_COUNT",Route:{NAME:"idealistvariant",QUERY:{variant:"follow"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"PROFILE_LNK_IDEAS_EVALUATED",COUNT:"EVALUATED_IDEA_COUNT",Route:{NAME:"idealistvariant",QUERY:{variant:"evaldone"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{ICON:"sap-icon://competitor",LINK_TEXT:"REWARDS_MANAGEMENT_LIST_TIT",COUNT:"REWARDS_MANAGEMENT_COUNT",Route:{NAME:"rewardlist",QUERY:{variant:"rewardmanage"}},ROLES:["sap.ino.ui::camps_mgr_role"]},{ICON:"sap-icon://InoIcons/following",LINK_TEXT:"PROFILE_LNK_FOLLOWED_MY",COUNT:"MY_FOLLOWED_COUNT",Route:{NAME:"followlistvariant",QUERY:{variant:"campaign"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{ICON:"sap-icon://lightbulb",LINK_TEXT:"IDEA_LIST_MIT_COMPLETED",COUNT:"COMPLETED_IDEA_COUNT",Route:{NAME:"idealistvariant",QUERY:{variant:"managedcompleted"}},ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]}]}};var r={"UnchangedIdeasFrame":"ReportTemplates('sap.ino.config.7')","VotesFrame":"ReportTemplates('sap.ino.config.16')"};var L={XS:{centerProfileContainer:"identityProfileFragment--identityProfile",centerReportUnchangedIdeasContainer:"unchangedIdeasFragment--unchangedIdeas",centerReportUnchangedIdeasSplitContainer:undefined,leftReportUnchangedIdeasContainer:undefined,rightReportUnchangedIdeasContainer:undefined,centerReportVotesContainer:"votesFragment--votes",centerReportVotesSplitContainer:undefined,leftReportVotesContainer:undefined,rightReportVotesContainer:undefined},S:{leftProfileContainer:"identityProfileFragment--identityProfile",centerReportUnchangedIdeasContainer:"unchangedIdeasFragment--unchangedIdeas",centerReportVotesContainer:"votesFragment--votes"},M:{leftProfileContainer:"identityProfileFragment--identityProfile",centerReportUnchangedIdeasSplitContainer:"unchangedIdeasFragment--unchangedIdeas",centerReportVotesSplitContainer:"votesFragment--votes"},L:{leftProfileContainer:"identityProfileFragment--identityProfile",leftReportUnchangedIdeasContainer:"unchangedIdeasFragment--unchangedIdeas",leftReportVotesContainer:"votesFragment--votes"},XL:{leftProfileContainer:"identityProfileFragment--identityProfile",rightReportUnchangedIdeasContainer:"unchangedIdeasFragment--unchangedIdeas",rightReportVotesContainer:"votesFragment--votes"}};return C.extend("sap.ino.vc.home.BackOfficeHome",jQuery.extend({},I,b,A,c,D,M,B,T,R,e,O,V,g,h,d,i,{formatter:jQuery.extend(this.formatter,O,E,b.followUpMixinFormatter,f),feedTitleLink:function(o,s){if(!isNaN(parseInt(o,10))){switch(s){case'CAMPAIGN':return this.formatter.navigationLink.apply(this,["campaign",{id:o}]);case'IDEA':return this.formatter.navigationLink.apply(this,["idea-display",{id:o}]);default:break;}}return undefined;},initialFocus:"backofficeButton--backofficeToogle",onInit:function(){C.prototype.onInit.apply(this,arguments);this.aBusyControls=[this.getView()];this._sBOHResizeIdeaListId=this.attachListControlResized(this.byId("ideasFragment--ideasList"));var o=H.getBackofficeHomepageWidget();o.done(function(k){var w=k.RESULT[0]||{IS_VISIBLE:false,HTML_CONTENT:""};w.IS_VISIBLE=!!w.IS_VISIBLE;this.getView().setModel(new J(w),"widget");}.bind(this));},onExit:function(){C.prototype.onExit.apply(this,arguments);this.detachListControlResized(this._sBOHResizeIdeaListId);},getIdeaList:function(){return this.byId("ideasFragment--ideasList");},getCampaignList:function(){return this.byId("campaignsListFragment--campaignsList");},show:function(p){this._oParentView=p;this.bindViewData();this.setIdentityProfileBinding();this.getIdeaList().attachUpdateFinished(this._onIdeaListUpdateFinished,this);this.getCampaignList().attachUpdateFinished(this._onCampaignListUpdateFinished,this);},_onIdeaListUpdateFinished:function(){var o=this.getIdeaList();o.$().find(".sapMListUl").attr("role","list");var k=o.$().find("li");jQuery.each(k,function(n,p){var $=jQuery(p);$.attr("role","group");var q=$.find(".sapInoItemAriaLabel");if(q&&q.length>0){$.attr("aria-labelledby",q[0].id);}var s=$.find(".sapMLIBContent");if(s&&s.length>0){s.attr("role","listitem");}});},_onCampaignListUpdateFinished:function(){var o=this.getCampaignList();o.$().find(".sapMListUl").attr("role","list");var k=o.$().find("li");jQuery.each(k,function(n,p){var $=jQuery(p);$.attr("role","group");var q=$.find(".sapInoItemAriaLabel");if(q&&q.length>0){$.attr("aria-labelledby",q[0].id);}var s=$.find(".sapMLIBContent");if(s&&s.length>0){s.attr("role","listitem");}});},_replaceReportName:function(o){var t=this;o.forEach(function(k){var K=k.getProperty("name");var s=t.getText(K);k.setProperty("name",s);});},_changeReportTitle:function(o){var t=this;if(o.getFeeds()){o.getFeeds().forEach(function(k){var K=k.getProperty("values");var s=t.getText(K);k.setProperty("values",[s]);});}if(o.getDataset()&&o.getDataset().getMeasures()){t._replaceReportName(o.getDataset().getMeasures());}if(o.getDataset()&&o.getDataset().getDimensions()){t._replaceReportName(o.getDataset().getDimensions());}},onAfterRendering:function(){var t=this;var u=this.byId("unchangedIdeasFragment--UnchangedIdeasFrame");var v=this.byId("votesFragment--VotesFrame");var o={title:{visible:false},legendGroup:{layout:{position:"auto"}},categoryAxis:{title:{visible:false},label:{visible:false}},valueAxis:{title:{visible:false}}};if(u){u.setVizProperties(o);if(!this.getModel("device").getProperty("/system/phone")&&!u.aBindParameters){u.attachBrowserEvent("click",this.onNavigateToReport,this);}t._changeReportTitle(u);}if(v){if(this.getModel("device").getProperty("/system/phone")){o.categoryAxis.label.visible=true;}v.setVizProperties(o);if(!this.getModel("device").getProperty("/system/phone")&&!v.aBindParameters){v.attachBrowserEvent("click",this.onNavigateToReport,this);}t._changeReportTitle(v);}},getLayout:function(s){return L[s];},setIdentityProfileBinding:function(){this.bindIdentityProfile(this.byId("identityProfileFragment--identityProfile"),j.Backoffice);if(this.getModel("data").getProperty(j.Backoffice.PATH)){var o=this;this.getModel("data").read(j.Backoffice.PATH,{success:function(){var k=o.byId("identityProfileFragment--identityProfileList").getBindingInfo("items");o.byId("identityProfileFragment--identityProfileList").bindItems(k);}});}},bindViewData:function(){this._bindCampaigns();var s;if(this.getModel("device").getProperty("/system/phone")){s=this.byId("ideasFragment--sapInoCampHomeIdeasSelect").getSelectedKey();}else{s=this.byId("ideasFragment--sapInoCampHomeIdeasButtons").getSelectedKey();}this._sIdeaViewKey=s||Object.keys(l)[0];this._bindIdeas(this._sIdeaViewKey);var k;if(this.getModel("device").getProperty("/system/phone")){k=this.byId("blogsFragment--sapInoCampHomeBlogsSelect").getSelectedKey();}else{k=this.byId("blogsFragment--sapInoCampHomeBlogsButtons").getSelectedKey();}this._sBlogViewKey=k||Object.keys(m)[0];if(!this.getModel("component").getProperty("/SHOW_BACKOFFICE_BLOG")){this._sBlogViewKey=Object.keys(m)[2];}this._bindBlogs(this._sBlogViewKey);this._bindUnchangedIdeas();this._bindVotes();},_bindCampaigns:function(){var k=this.getModel("device").getProperty("/system/phone");var s=a.hasCurrentUserPrivilege('sap.ino.xs.rest.admin.application::campaign');var n=s?'filterBackoffice=0':'filterBackoffice=1';var p="data>/CampaignSearchParams(searchToken='',"+"tagsToken='',"+"tagsToken1='',"+"tagsToken2='',"+"tagsToken3='',"+"tagsToken4='',"+"filterName='submittableCampaigns',"+n+")/Results";if(k){var o=this.byId("campaignsListFragment--campaignsCarousel");o.bindAggregation("pages",{path:p,template:this.createFragment("sap.ino.vc.home.fragments.CampaignBanner"),length:4,top:4,filters:[new F("STATUS_CODE","NE","sap.ino.config.CAMP_DRAFT")],sorter:new S("SUBMIT_TO",false)});}else{var q=this.byId("campaignsListFragment--campaignsList");q.bindItems({path:p,template:this.getFragment("sap.ino.vc.campaign.fragments.HomeCampaignListItem"),length:3,top:3,filters:[new F("STATUS_CODE","NE","sap.ino.config.CAMP_DRAFT")],sorter:new S("SUBMIT_TO",false)});}},_bindIdeas:function(k){var n=this.getModel("device").getProperty("/system/phone");var p="data>/IdeaMediumBackofficeSearchParams(searchToken='',"+"searchType="+"0"+","+"tagsToken='',"+"tagsToken1='',"+"tagsToken2='',"+"tagsToken3='',"+"tagsToken4='',"+"filterName='"+l[k].filterParam+"',"+"filterBackoffice=1"+this.getEmptyIdeaformFilters()+",cvt='"+""+"',"+"cvr="+"0"+","+"cvy="+"0"+")/Results";var o=this.byId("ideasFragment--ideasList");var q=a.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE")*1||a.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE_HIDE_PHASE_BAR")*1;var t=Number(q)?this.getFragment("sap.ino.vc.idea.fragments.ManageListItemNoImage"):this.getFragment("sap.ino.vc.idea.fragments.ManageListItem");o.bindItems({path:p,template:t,sorter:l[k].sorter,filters:l[k].filter,length:4});var s=this.byId("ideasFragment--panelTitle");s.setText(this.getText("CAMPAIGN_HOME_PANEL_IDEAS_"+k.toUpperCase()));var u=a.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");var v="";if(u){v="/sap/ino/xs/rest/backoffice/odata.xsodata";}else{v="/sap/ino/xs/rest/community/odata.xsodata";}p=a.getBackendRootURL()+v+o.mBindingInfos.items.binding.sPath+"?$format=json";var w=o.mBindingInfos.items.binding.sFilterParams;var x=o.mBindingInfos.items.binding.sSortParams;var y="&$select(ID)";p=p+"&"+x+"&"+w+y;var z=new J();z.setData({path:p});sap.ui.getCore().setModel(z,"ideaSearchParams");},_bindBlogs:function(k){if(a.getCurrentUser().USER_ID){var n=this.getModel("device").getProperty("/system/phone");var p="data>/BlogSearchParams(searchToken='',"+"tagsToken='',"+"filterName='"+m[k].filterParam+"')/Results";var o={path:p,template:this.getFragment("sap.ino.vc.blog.fragments.ListItemHome"),sorter:m[k].sorter,length:4,top:4};if(n){var q=this.byId("blogsFragment--blogsCarousel");q.bindAggregation("pages",o);}else{var s=this.byId("blogsFragment--blogsList");if(s){s.bindItems(o);}}var t=this.byId("blogsFragment--panelBlogTitle");if(this.getModel("component").getProperty("/SHOW_BACKOFFICE_BLOG")){t.setText(this.getText("CAMPAIGN_HOME_PANEL_BLOGS_"+k.toUpperCase()));}else{t.setText(this.getText("HOMEPAGE_PANEL_CAMPAIGN_BLOGS"));}}},_bindUnchangedIdeas:function(){var v=this.byId("unchangedIdeasFragment--UnchangedIdeasFrame");var o=this.getModel("data");o.read("/UnchangedIdeas",{async:true,success:function(k){var n=new sap.ui.model.json.JSONModel();n.setData(k);v.setModel(n);}});},_bindVotes:function(){var v=this.byId("votesFragment--VotesFrame");var o=this.getModel("data");o.read("/IdeaVotes",{async:true,sorters:[new S("CHANGED_AT_YEAR_MONTH",false)],success:function(k){var n=new sap.ui.model.json.JSONModel();n.setData(k);v.setModel(n);}});},onCampaignsListItemPress:function(o){var k=o.getSource();var n=k.getBindingContext("data");if(n){this.navigateTo("campaign",{id:n.getProperty("ID")});}},onNavigateToCampaigns:function(){this.navigateTo("campaignlistvariant",{variant:"submittable"});},onOfficeToggle:function(){if(this._oParentView){var o=this._oParentView.getController();if(o.switchView){o.switchView();}}},onOpenCampaignSettings:function(o){if(this._oParentView){var s=o.getSource();var k=s.getBindingContext("data");var n=this._oParentView.getController();if(n.openCampaignSettings){n.openCampaignSettings(k.getProperty("ID"));}}},onBackofficeSettings:function(){if(this._oParentView){var o=this._oParentView.getController();if(o.onBackofficeSettings){o.onBackofficeSettings();}}},onCreateIdea:function(o){this.navigateTo("idea-create",{query:{campaign:o.getParameter("campaignId")}});},onIdeaListTypeSelect:function(o){this._sIdeaViewKey=o.getParameter("key")||o.getParameter("selectedItem")&&o.getParameter("selectedItem").getKey();this._bindIdeas(this._sIdeaViewKey);},onBlogListTypeSelect:function(o){this._sBlogViewKey=o.getParameter("key")||o.getParameter("selectedItem")&&o.getParameter("selectedItem").getKey();this._bindBlogs(this._sBlogViewKey);},onOpenSubmitter:function(o){var s=o.getSource();var k=s.getBindingContext("data").getProperty("SUBMITTER_ID");this.openIdentityQuickView(s,k);},onOpenCoach:function(o){var s=o.getSource();var k=s.getBindingContext("data").getProperty("COACH_ID");this.openIdentityQuickView(s,k);},onNavigateToIdeas:function(){if(!this._sIdeaViewKey){this.navigateTo("idealist");}else{this.navigateTo("idealistvariant",{variant:this._sIdeaViewKey});}},onNavigateToBlogs:function(){if(!this._sBlogViewKey){this.navigateTo("bloglist");}else{this.navigateTo("bloglistvariant",{variant:m[this._sBlogViewKey].name});}},onNavigateToReport:function(o){var k=((o.currentTarget&&o.currentTarget.id)||(o.oSource.sId)).split("--");var s=k[k.length-1];this.navigateTo("report",{code:r[s]});},onItemPress:function(o){var k=o.getSource();var n=k.getBindingContext("data");if(n){this.navigateTo("idea-display",{id:n.getProperty("ID")});}},onBlogItemPress:function(o){if(this._bIsTokenPressed){this._bIsTokenPressed=false;return;}var k=o.getSource();var n=k.getBindingContext("data");if(n){this.navigateTo("blog-display",{id:n.getProperty("ID")});}},onOpenCreator:function(o){var s=o.getSource();var k=s.getBindingContext("data").getProperty("CREATED_BY_ID");if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(s,k);},onNavigateToFeedList:function(){this.navigateTo("feedlist");},showPopupTagCard:function(o){this._bIsTokenPressed=true;if(!this._oPopover){this._oPopover=sap.ui.xmlfragment("sap.ino.vc.tag.fragments.TagCardPopover",this);this.getView().addDependent(this._oPopover);}var t=o.getSource();var p="/SearchTagsAll(searchToken='',ID="+t.getKey()+")";var k=this.getModel("data");var n=this;k.read(p,{async:true,success:function(q){var s=new sap.ui.model.json.JSONModel();s.setData(q);n._oPopover.setModel(s,"Tag");jQuery.sap.delayedCall(0,n,function(){n._oPopover.openBy(t);});}});}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.Display.controller')){jQuery.sap.declare('sap.ino.vc.idea.Display.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.DialogType');jQuery.sap.require('sap.ui.core.ValueState');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.FlexBox');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.ui.core.HTML');sap.ui.define("sap/ino/vc/idea/Display.controller",["sap/ino/vc/commons/BaseObjectController","sap/ino/vc/evaluation/EvaluationFormatter","sap/ino/vc/idea/mixins/FollowUpMixin","sap/ino/commons/models/object/Idea","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ino/vc/commons/TopLevelPageFacet","sap/ino/commons/models/object/Vote","sap/ino/vc/idea/mixins/AssignmentActionMixin","sap/ino/vc/idea/mixins/ChangeStatusActionMixin","sap/ino/vc/commons/mixins/MailMixin","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ino/vc/idea/mixins/MergeActionMixin","sap/ino/commons/application/WebAnalytics","sap/m/Label","sap/m/Text","sap/m/CheckBox","sap/ino/commons/models/core/CodeModel","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/commons/mixins/TagCardMixin","sap/ino/commons/models/object/RewardList","sap/ino/vc/idea/mixins/CreateRewardActionMixin","sap/ino/commons/models/aof/PropertyModel","sap/ino/vc/idea/RewardFormatter","sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/controls/IdeaStatusType","sap/ino/vc/idea/mixins/ChangeAuthorActionMixin","sap/ino/vc/idea/mixins/ChangeAuthorActionFormatter","sap/ino/vc/idea/mixins/ChangeDecisionMixin","sap/ino/commons/models/object/IdeaObjectIntegration","sap/ino/commons/models/object/IdeaLatest","sap/m/Dialog","sap/m/DialogType","sap/ui/core/ValueState","sap/m/MessageBox","sap/m/FlexBox","sap/m/Link","sap/m/Button","sap/m/ButtonType","sap/ui/core/HTML"],function(B,E,F,I,C,J,M,T,V,A,c,d,e,f,g,W,L,h,j,k,l,m,R,o,P,p,q,r,s,t,u,v,w,D,x,y,z,G,H,K,N,O){"use strict";var Q={decisionQuickViewVisibility:function(a,b,i,n,S,U,X,Y){if(b!==n||(a!==i||!U||U.trim()==='')&&(!Y||Y.trim()==='')){return false;}if(X||S===1){return true;}else{return false;}},decisionValueOption:function(a,b){if(a&&a.trim()!==""){return B.prototype.formatter.valueOption.call(this,a);}if(b&&b.trim()!==""){return b.substr(0,6);}return"";},voteTabVisibility:function(b,a,i,n){if(!b&!a&&i!=='TEXT'&&i!=='LIST'){return false;}else if(n){return true;}else if(b){return true;}else{return false;}},enableEditDecision:function(i,n,S,U){if(i&&n&&n.length>0){n.sort(function(a,b){return b.ID-a.ID;});if(n[0].STATUS_CODE!==U||(n[0].PHASE_CODE!==S||!n[0].REASON_CODE||n[0].REASON_CODE.trim()==='')&&(!n[0].REASON||n[0].REASON.trim()==='')){return false;}return true;}else{return false;}},editDecisionCustomData:function(i){if(i&&i.length>0){i.sort(function(a,b){return b.ID-a.ID;});return i[0].ID;}},visibleDecision:function(i,n,S,U){if(n&&n.length>0){n.sort(function(a,b){return b.ID-a.ID;});if(n[0].STATUS_CODE!==U||(n[0].PHASE_CODE!==S||!n[0].REASON_CODE||n[0].REASON_CODE.trim()==='')&&(!n[0].REASON||n[0].REASON.trim()==='')){return false;}if(i||n[0].DECISION_REASON_LIST_VISIBLE===1){return true;}else{return false;}}else{return false;}},adjustDesWidth:function(b,a,i,n){var S=Q.visibleDecision(b,a,i,n);if(S===false){return"IDEA_DEATAIL_WIDTH";}else{return"null";}},sectionTitle:function(i,a){if(i>0){return a&&a+"("+String(i)+")";}else{return a;}},sectionInternalTitle:function(n,a,b){if(!parseInt(n,10)&&!parseInt(a,10)){return b;}else{return b&&b+this.getText("MENU_MIT_INTERNAL_COUNTS",[String(n),String(a)]);}},sectionInternalTitleToolTip:function(n,a,b){if(!parseInt(n,10)&&!parseInt(a,10)){return null;}else{return b;}},setIdeaDetailCommentsTab:function(i){if(i===1){return"LATESTUPDATE_COMMENT_TAB";}else{return"null";}},setIdeaDetailCreateIcon:function(i,a){if(i===1&&a===false){return"LATESTCTEATE_ICON";}else{return"null";}},isPreviousEnabled:function(a){var b=this.getView().getModel("ideaList");if(b&&b.getData()){var S=b.getData();if(S&&S.length>=0){var U=0;$.each(S,function(i,n){if(n===a){U=i;return false;}});if(U-1>=0){return true;}else{return false;}}else{return false;}}else{return false;}},isNextEnabled:function(a){var b=this.getView().getModel.getModel("ideaList").getData();if(b&&b.length>=0){var S=0;$.each(b,function(i,n){if(n===a){S=i;return false;}});if(S+1<b.length){return true;}else{return false;}}else{return false;}},isPreviousOrNextVisible:function(a){var b=this.getView().getModel("ideaList").getData();if(b&&b.length>=0){var S=$.grep(b,function(n,i){return n===a;});if(S.length>0){return true;}return false;}else{return false;}},aContributorsFirstPerson:function(a){if(!a||a.length<=0){return"";}if(a.length===1){return a[0].NAME;}else if(a.length>1){return a[0].NAME+"...";}},formatPressPreviousButton:function(i){if(i===1){return false;}},formatPressNextButton:function(i,a){if(i===a){return false;}},enableLinkObject:function(a){if(a){return true;}else{return false;}}};jQuery.extend(Q,B.prototype.formatter,F.followUpMixinFormatter,E,p,t);return B.extend("sap.ino.vc.idea.Display",jQuery.extend({},T,A,c,F,d,e,g,l,m,o,f,s,u,{routes:["idea-display"],formatter:Q,preCheck:true,onInit:function(){B.prototype.onInit.apply(this,arguments);this.setViewProperty("/EDIT",false);this.aBusyControls=[this.byId("ideaDisplay")];this.setModel(new J({EvaluationSelection:{},CreateAverageEvaluationEnabled:false,CreateTotalEvaluationEnabled:false}),"objectContext");this._initHandleRewardsAOChange();},createObjectModel:function(a){var S={nodes:["Root","Extension"],actions:["modify","modifyAndSubmit","del","assignCoach","executeStatusTransition","assignToMe","unassignCoach","mergeIdeas","markAsDuplicate","addExpert","reassignCampaign","changeAuthorStatic","changeDecision","createObject","linkExistedObject","copy"],continuousUse:true,readSource:{model:this.getDefaultODataModel(),includeNodes:[{name:"CampaignExperts",parentNode:"Root",primaryKey:"ID"},{name:"RespExperts",parentNode:"Root",primaryKey:"ID"},{name:"CampaignManagers",parentNode:"Root",primaryKey:"ID"},{name:"Decisions",parentNode:"Root",primaryKey:"ID"},{name:"StatusDecisions",parentNode:"Root",primaryKey:"ID"}]}};W.logIdeaView(a);return new I(a,S);},onRouteMatched:function(a){B.prototype.onRouteMatched.apply(this,arguments);var b=this;var i=this.getObjectModel();var n=this.byId("vBoxFormIdeals");var S=this.byId("vBoxAdminFormIdeals");i.getDataInitializedPromise().done(function(b1){var c1=b1.CAMPAIGN_BACKGROUND_IMAGE_ID;var d1=b1.CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID;b.setBackgroundImages(c1,d1);b.setViewProperty("/CO_AUTHOR",false);if(i.oData.Contributors.length>0){b.setViewProperty("/CO_AUTHOR",true);}if(n){n.removeAllItems();}if(S){S.removeAllItems();}if(!!i.oData.FieldsValue&&i.oData.FieldsValue.length>0){b.bindingFormIdeals(n,i);}if(!!i.oData.AdminFieldsValue&&i.oData.AdminFieldsValue.length>0){b.bindingAdminFormIdeals(S,i);}b.setVisibilityForRewards(b1);var e1=b.getOwnerComponent().getModel('search');if(e1){e1.setProperty('/searchAguments',{"id":i.getProperty("/CAMPAIGN_ID")});}var f1=b.byId('objectpage')?b.byId('objectpage').getSelectedSection():"";var g1=[];var h1=f1&&(f1.indexOf("sectionComments")>-1)?true:false;var i1=f1&&(f1.indexOf("sectionDetails")>-1)?true:false;if(i.getProperty("/SHOW_CREATED_VIEWER")===1){g1.push("CreatedViewer");}if(i.getProperty("/SHOW_STATUSCHANGE_VIEWER")===1){g1.push("StatusChangeViewer");}if(i1&&i.getProperty("/SHOW_UPDATED_VIEWER")===1){g1.push("UpdatedViewer");}if(h1&&i.getProperty("/SHOW_COMMENT_VIEWER")===1){g1.push("CommentViewer");}if(!h1&&b._commentAlreadyRead){i.setProperty("/SHOW_COMMENT_VIEWER",0);b._commentAlreadyRead=false;}if(g1.length>0){var j1={TYPE_CODE:g1,IDEA_ID:i.getProperty("/ID")};var k1=w.deleteViewerByObjectIdAndTypeCode(j1);k1.done(function(m1){if(h1&&i.getProperty("/SHOW_COMMENT_VIEWER")===1){b._commentAlreadyRead=true;}});}var l1=f1&&(f1.indexOf("sectionAttachments")>-1)?true:false;if(l1){i.setProperty("/EDITABLE",false);}});var U=b.getModel("objectContext");var X=Object.keys(U.getProperty("/EvaluationSelection")||{});if(X.length>0){U.setProperty("/EvaluationSelection",{});U.setProperty("/CreateAverageEvaluationEnabled",false);U.setProperty("/CreateTotalEvaluationEnabled",false);}this.setHelp("IDEA_DISPLAY","IDEA_DISPLAY_ADDITIONAL");var Y=a.getParameter("arguments").id;this.initPageIndicatorLabel(Y);var Z=C.getBackendRootURL()+"/sap/ino/xs/rest/common/update_object_view_count.xsjs";var _={OBJECT_TYPE:"IDEA",OBJECT_ID:Y,USER_NAME:C.getCurrentUser().USER_NAME};var a1=jQuery.ajax({url:Z,headers:{"X-CSRF-Token":C.getXSRFToken()},data:JSON.stringify(_),dataType:"json",type:"POST",contentType:"application/json; charset=UTF-8",async:true});a1.done();},onAfterRendering:function(){var a=this;var b=C.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE");var i=C.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE_HIDE_PHASE_BAR");a.setViewProperty('/DISABLE_IDEA_IMAGE',!!(b*1)||!!(i*1));a.setViewProperty('/DISABLE_IDEA_IMAGE_HIDE_PHASE_BAR',!!(i*1));a.setPageContentTopStyle();jQuery.sap.delayedCall(0,a,function(){k.getCodes("sap.ino.xs.object.evaluation.Model.Criterion");k.getCodes("sap.ino.xs.object.basis.Unit.Root");k.getCodes("sap.ino.xs.object.status.Action.Root");});},bindingAdminFormIdeals:function(a,b){var n=this;jQuery.each(b.oData.AdminFieldsValue,function(i,S){if(S.STATE_OF_PUBLISH===1){var U=S.DEFAULT_TEXT+":";if(S.UOM_CODE){U=S.DEFAULT_TEXT+"("+k.getText("sap.ino.xs.object.basis.Unit.Root",S.UOM_CODE)+"):";}var X=new L({text:U,tooltip:S.DEFAULT_LONG_TEXT});X.addStyleClass("sapInoIdeaFormLabelStyle");var Y;if(S.DATATYPE_CODE==="BOOLEAN"){Y="BOOL_VALUE";}else if(S.DATATYPE_CODE==="TEXT"){Y="TEXT_VALUE";}else if(S.DATATYPE_CODE==="RICHTEXT"){Y="RICH_TEXT_VALUE";}else if(S.DATATYPE_CODE==="DATE"){Y="DATE_VALUE";}else{Y="NUM_VALUE";}var Z=S[Y];var _=S.valueOptionList;if(!_){if(S.VALUE_OPTION_LIST_CODE){var a1="sap.ino.xs.object.basis.ValueOptionList.Root_"+S.VALUE_OPTION_LIST_CODE;_=k.getCodes(a1,function(g1){return g1.ACTIVE===1;});}}if(!!_&&_.length>0&&Z!==undefined&&Z!==null&&Z!==""){jQuery.each(_,function(g1,h1){if(h1.CODE.toString()===Z.toString()){Z=h1.DEFAULT_TEXT;return;}});}if(S.DATATYPE_CODE==="BOOLEAN"&&(!_||_.length===0)){var b1=S[Y]===0||!S[Y]?false:true;var c1=new j({text:S.DEFAULT_TEXT,selected:b1,editable:false,tooltip:S.DEFAULT_LONG_TEXT});var d1=c1._getLabel();d1.addStyleClass("sapInoIdeaFormLabelStyle");a.addItem(c1);}else{var e1;if(S.DATATYPE_CODE==="NUMERIC"&&!!Z&&(!_||_.length===0)){var f1=sap.ui.core.format.NumberFormat.getFloatInstance({groupingEnabled:true,groupingSeparator:","});e1=new h();e1.setText(f1.format(Z));}else if(S.DATATYPE_CODE==="RICHTEXT"&&!!Z&&(!_||_.length===0)){e1=new sap.ui.core.HTML({sanitizeContent:true,preferDOM:false});e1.setContent(Z);}else if(S.DATATYPE_CODE==="DATE"&&!!Z&&(!_||_.length===0)){e1=new h();e1.setText(Q.toDate(Z));}else{e1=new h();e1.setText(Z);}a.addItem(X);a.addItem(e1);}}});},bindingFormIdeals:function(a,b){var n=this;jQuery.each(b.oData.FieldsValue,function(i,S){var U=S.DEFAULT_TEXT+":";if(S.IS_DISPLAY_ONLY){var X=new O({sanitizeContent:true,preferDOM:false,content:{model:"object",path:"/FieldsValue/"+i+"/DISPLAY_TEXT",formatter:n.formatter.wrapHTML}});a.addItem(X);return true;}if(S.UOM_CODE){U=S.DEFAULT_TEXT+"("+k.getText("sap.ino.xs.object.basis.Unit.Root",S.UOM_CODE)+"):";}var Y=new L({text:U,tooltip:S.DEFAULT_LONG_TEXT});Y.addStyleClass("sapInoIdeaFormLabelStyle");var Z;if(S.DATATYPE_CODE==="BOOLEAN"){Z="BOOL_VALUE";}else if(S.DATATYPE_CODE==="TEXT"){Z="TEXT_VALUE";}else if(S.DATATYPE_CODE==="RICHTEXT"){Z="RICH_TEXT_VALUE";}else if(S.DATATYPE_CODE==="DATE"){Z="DATE_VALUE";}else{Z="NUM_VALUE";}var _=S[Z];var a1=S.valueOptionList;if(!!a1&&a1.length>0&&_!==undefined&&_!==null&&_!==""){jQuery.each(a1,function(h1,i1){if(i1.CODE.toString()===_.toString()){_=i1.DEFAULT_TEXT;return;}});}if(S.DATATYPE_CODE==="BOOLEAN"&&(!a1||a1.length===0)){if(S.IS_HIDDEN===1){var b1=new h();b1.setText("******");b1.setTooltip(n.getText("IDEA_DISPLAY_FORM_HIDDEN_TOOLTIP"));a.addItem(Y);a.addItem(b1);}else{var c1=S[Z]===0||!S[Z]?false:true;var d1=new j({text:S.DEFAULT_TEXT,selected:c1,editable:false,tooltip:S.DEFAULT_LONG_TEXT});var e1=d1._getLabel();e1.addStyleClass("sapInoIdeaFormLabelStyle");a.addItem(d1);}}else{var f1;if(S.DATATYPE_CODE==="NUMERIC"&&!!_&&(!a1||a1.length===0)){var g1=sap.ui.core.format.NumberFormat.getFloatInstance({groupingEnabled:true,groupingSeparator:","});f1=new h();f1.setText(g1.format(_));}else if(S.DATATYPE_CODE==="RICHTEXT"&&!!_&&(!a1||a1.length===0)){f1=new sap.ui.core.HTML({sanitizeContent:true,preferDOM:false});f1.setContent(_);}else if(S.DATATYPE_CODE==="DATE"&&!!_&&(!a1||a1.length===0)){f1=new h();f1.setText(Q.toDate(_));}else{f1=new h();f1.setText(_);}if(S.IS_HIDDEN===1){if(S.DATATYPE_CODE==="RICHTEXT"){f1=new h();}f1.setText("******");f1.setTooltip(n.getText("IDEA_DISPLAY_FORM_HIDDEN_TOOLTIP"));}a.addItem(Y);a.addItem(f1);}});},hasBackgroundImage:function(){return true;},getODataEntitySet:function(){return"IdeaFull";},onCampaignPressed:function(a){a.preventDefault();var i=this.getObjectModel().getProperty("/CAMPAIGN_ID");this.navigateTo("campaign",{id:i});},onIdeaPressed:function(a){a.preventDefault();var i=this.getObjectModel().getProperty("/LINK_IDEA_ID");this.navigateTo("idea-display",{id:i});},onEdit:function(a){this.navigateTo("idea-edit",{id:this.getObjectModel().getKey()});},onGeneralEdit:function(a){if(!this._oEditActionSheet){this._oEditActionSheet=this.createFragment("sap.ino.vc.idea.fragments.EditActionSheet",this.getView().getId());this.getView().addDependent(this._oEditActionSheet);}this._oEditActionSheet.openBy(a.getSource());},onRewardCreateEanble:function(a){if(a){return P.getStaticActionEnabledStaticFormatter("sap.ino.xs.object.reward.RewardList","create",{IDEA_ID:a})(a);}return false;},onCreate:function(a){if(!this._oCreateActionSheet){this._oCreateActionSheet=this.createFragment("sap.ino.vc.idea.fragments.CreateActionSheet",this.getView().getId());this.getView().addDependent(this._oCreateActionSheet);}this._oCreateActionSheet.openBy(a.getSource());},onCreateEvaluation:function(){var a=this;this.navigateTo("evaluation-create",{query:a._getEvaluationQuery()});},_getEvaluationQuery:function(){var a={ideaId:this.getObjectModel().getKey()};var b=this.getModel("data").oData;var i=/^EvaluationRequestFullItem\((\d+)\)$/igm;var n;if(b){for(var S in b){if(b.hasOwnProperty(S)){var U=i.exec(S);if(U&&U.length>1){n=U[1];}}}}if(n){a.EvalReqItemId=n;}return a;},onCreateAverageEvaluation:function(){var a=this;var b=function(n){var S=Object.keys(a.getModel("objectContext").getProperty("/EvaluationSelection")||{});if(S.length>0){a.navigateTo("evaluation-create",{query:{ideaId:a.getObjectModel().getKey(),EvalReqItemId:a.getObjectModel().getKey(),evalIds:S.join(","),evalAction:1,includeAttachs:n}});}};var i=[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO];sap.m.MessageBox.confirm(a.getText("IDEA_OBJECT_MSG_NEW_CREATE_AVERAGE_EVALUATION"),{actions:i,onClose:function(n){var S=Math.pow(i.length,i.indexOf(n)+1);if(S===2){b(1);}}});},onCreateTotalEvaluation:function(){var a=this;var b=function(n){var S=Object.keys(a.getModel("objectContext").getProperty("/EvaluationSelection")||{});if(S.length>0){a.navigateTo("evaluation-create",{query:{ideaId:a.getObjectModel().getKey(),EvalReqItemId:a.getObjectModel().getKey(),evalIds:S.join(","),evalAction:2,includeAttachs:n}});}};var i=[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO];sap.m.MessageBox.confirm(a.getText("IDEA_OBJECT_MSG_NEW_CREATE_TOTAL_EVALUATION"),{actions:i,onClose:function(n){var S=Math.pow(i.length,i.indexOf(n)+1);if(S===2){b(1);}}});},onContactPeople:function(a){var S=a.getSource();if(!this._oContactActionSheet){this._oContactActionSheet=this.createFragment("sap.ino.vc.idea.fragments.ContactActionSheet",this.getView().getId());this.getView().addDependent(this._oContactActionSheet);}this._oContactActionSheet.openBy(S);},onContactContributors:function(){var i=this.getObjectModel();var a=i.getProperty("/Contributors").concat(i.getProperty("/Submitter"));if(this.getObjectModel().getPropertyModel().getProperty("/nodes/Root/customProperties/EmailVisibilies").CONTRIBUTORS){this.triggerMail(a);}else{this.onIdeaContactMail(a);}},onContactCoach:function(){var i=this.getObjectModel();var a=i.getProperty("/Coach");if(this.getObjectModel().getPropertyModel().getProperty("/nodes/Root/customProperties/EmailVisibilies").COACHES){this.triggerMail(a);}else{this.onIdeaContactMail(a);}},onContactIdeaExperts:function(){var i=this.getObjectModel();var a=i.getProperty("/Experts");if(this.getObjectModel().getPropertyModel().getProperty("/nodes/Root/customProperties/EmailVisibilies").IDEA_EXPERTS){this.triggerMail(a);}else{this.onIdeaContactMail(a);}},onContactCampaignExperts:function(){var i=this.getObjectModel();var a=i.getProperty("/CampaignExperts");if(this.getObjectModel().getPropertyModel().getProperty("/nodes/Root/customProperties/EmailVisibilies").CAMP_EXPERTS){this.triggerMail(a);}else{this.onIdeaContactMail(a);}},triggerMail:function(a){var b=a.filter(function(n){return n.IS_VALID_EMAIL&&n.EMAIL;}).map(function(n){return n.EMAIL;}).reduce(function(n,S){if(n.indexOf(S)<0){n.push(S);}return n;},[]).join(";");var i=this.createMailContent();sap.m.URLHelper.triggerEmail(b,i.subject,i.body);},onCreateWall:function(a){var b=this;var i=this.getObjectModel();if(i){i.createWall(this.getOwnerComponent()).done(function(n){b.navigateToWall("wall",{id:n});});}},getCopyDialog:function(a){if(!this._oCopyIdeaDialog){this._oCopyIdeaDialog=this.createFragment("sap.ino.vc.idea.fragments.Copy",this.getView().getId());this.getView().addDependent(this._oCopyIdeaDialog);this._oCopyOkBtn=this.byId(this.createId("copyok"));this._oCopyIdeaDialog.setInitialFocus();}return this._oCopyIdeaDialog;},onCopyIdea:function(){var i=this.getObjectModel();var a=this.getCopyDialog();a.setModel(new J({"NAME":this.getText("IDEA_OBJECT_FLD_COPY_PREFIX",[i.getProperty("/NAME")])}),"copy");a.open();},onCopyIdeaTitleChange:function(a){if(a.getParameters().newValue&&a.getParameters().newValue.length>0){this._oCopyOkBtn.setEnabled(true);}else{this._oCopyOkBtn.setEnabled(false);}},onCopyDialogOk:function(){var a=this;var b=this.getCopyDialog();var i=b.getModel("copy").getProperty("/NAME");b.setBusy(true);var n=a.executeObjectAction("copy",{parameters:{ID:-1,NAME:i},messages:{success:"IDEA_OBJECT_MSG_COPY_SUCCESS",error:"IDEA_OBJECT_MSG_COPY_FAILURE"}});n.done(function(S){b.close();setTimeout(function(){a.navigateTo("idea-edit",{id:S.getKey()});},500);});n.always(function(){b.setBusy(false);});},onCopyDialogClose:function(){this.getCopyDialog().close();},onCopyDialogAfterClose:function(){this.resetClientMessages();this.getCopyDialog().destroy();this._oCopyIdeaDialog=undefined;},onOpenDecisionQuickView:function(a){var S=a.getSource();var i=S.getBindingContext("object").getProperty("ID");if(S&&i){if(!this._oDecisionCardView||!this._oDecisionCardView.getController()){this._oDecisionCardView=sap.ui.xmlview({viewName:"sap.ino.vc.idea.DecisionQuickView"});S.addDependent(this._oDecisionCardView);}this._oDecisionCardView.getController().open(S,i);}},onRespListHint:function(a){var b=this._getRespListHintDialog();var i=this.getObjectModel();var n=i.getProperty("/RESP_VALUE_CODE");b.bindElement({path:"data>/RespValues('"+n+"')/"});b.open();},onRespListHintDialogClose:function(){var a=this._getRespListHintDialog();a.close();},_getRespListHintDialog:function(){var a=this._oRespListHintDialog;if(!a){a=this.createFragment("sap.ino.vc.idea.fragments.ResponsibilityDetail",this.getView().getId());this.getView().addDependent(a);this._oRespListHintDialog=a;this._oRespListHintDialog.setInitialFocus(this.createId("TagToken"));}return a;},showPopupTagCard:function(a){if(!this._oPopover){this._oPopover=sap.ui.xmlfragment("sap.ino.vc.tag.fragments.TagCardPopover",this);this.getView().addDependent(this._oPopover);}var b=a.getSource();var i="/SearchTagsAll(searchToken='',ID="+b.getKey()+")";var n=this.getModel("data");var S=this;n.read(i,{async:true,success:function(U){var X=new J();X.setData(U);S._oPopover.setModel(X,"Tag");jQuery.sap.delayedCall(0,S,function(){S._oPopover.openBy(b);});}});},_initHandleRewardsAOChange:function(){var a=this;var b=function(i){if(i.getParameter("object").getMetadata().getName()==="sap.ino.commons.models.object.RewardList"&&a&&a.getObjectModel()){a.getObjectModel().checkUpdate(true,false);}};q.attachChange(q.Action.Create,b);q.attachChange(q.Action.Del,b);q.attachChange(q.Action.Action,b);},setVisibilityForRewards:function(a){if(this.byId("sectionRewards")&&a){this.byId("sectionRewards").setVisible(a.IDEA_HAS_REWARDS>0||a.REWARD_ACTIVE>0);}},hasPendingChanges:function(){var i=this.getObjectModel();if(!i){return false;}var a=i.getProperty("/IDEA_COMMENT_VIEW");var b=i.getProperty("/IDEA_INTERNAL_COMMENT_VIEW");var n=a?a.getModel("comment"):null;var S=b?b.getModel("comment"):null;if(n&&(this.getCurrentRoute()!=="idea-display"||n.getProperty("/OBJECT_ID")!==i.getProperty("/ID")||(this.getCurrentRoute()==="idea-display"&&this.getRouter().getContext().indexOf("idea/")<0))){a.setModel(null,"comment");n=null;}if(S&&(this.getCurrentRoute()!=="idea-display"||S.getProperty("/OBJECT_ID")!==i.getProperty("/ID")||(this.getCurrentRoute()==="idea-display"&&this.getRouter().getContext().indexOf("idea/")<0))){b.setModel(null,"comment");S=null;}return false;},getCorrespondingCommentModel:function(a){var i=this.getObjectModel();var b,n;if(a==="IDEA"){n=i.getProperty("/IDEA_COMMENT_VIEW");b=n?n.getModel("comment"):null;}else if(a==="INTERNAL"){n=i.getProperty("/IDEA_INTERNAL_COMMENT_VIEW");b=n?n.getModel("comment"):null;}return b;},onCreateEvaluationRequest:function(a){this.navigateTo("evaluationrequest-create",{query:{idea:this.getObjectModel().getKey()}});},onOpenDecisionMaker:function(a){var S=a.getSource();var b=S.getBindingContext("object");var i=b.getProperty(b.sPath+"/DECIDER_ID");if(!this._oIdentityCardView){this._oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this._oIdentityCardView);}this._oIdentityCardView.getController().open(S,i);},onAuthorPressed:function(a){var S=a.getSource();var b=S.getBindingContext("object");var i=b.getProperty(b.sPath+"SUBMITTER_ID");this.callIdentityView(S,i);},onCoauthorPressed:function(a){var S=a.getSource();var b=S.getBindingContext("object");var i=b.getProperty(b.sPath+"Contributors")[0].IDENTITY_ID;this.callIdentityView(S,i);},onCoachPressed:function(a){var S=a.getSource();var b=S.getBindingContext("object");var i=b.getProperty(b.sPath+"COACH_ID");this.callIdentityView(S,i);},callIdentityView:function(S,i){if(!this._oIdentityCardView){this._oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this._oIdentityCardView);}this._oIdentityCardView.getController().open(S,i);},getIntegrationObjectDialog:function(){if(!this._oCopyIntegrationObject){this._oCopyIntegrationObject=this.createFragment("sap.ino.vc.idea.fragments.IntegrationObjectDialog",this.getView().getId());this.getView().addDependent(this._oCopyIntegrationObject);}return this._oCopyIntegrationObject;},onCreateIntegrationObject:function(){var a=this;var b=this.getIntegrationObjectDialog();v.getAllApiFromCampaign({CAMPAIGN_ID:this.getObjectModel().getProperty("/CAMPAIGN_ID")}).done(function(i){if(i&&i.RESULT&&i.RESULT.length===1){a.enableCreateIntegrationObjectTag=true;a.getIntegrationObjectDialog().getModel("objectContext").setProperty("/enableCreateIntegrationObjectBtn",true);a.objectTechnicalName=i.RESULT[0].TECHNICAL_NAME;}else{i.enableCreateIntegrationObjectBtn=false;}setTimeout(function(){b.setModel(new J(i),"objectContext");b.open();},500);}).fail(function(i){i.RESULT=[];});},onIntegrationObjectTargetConfim:function(){var a=this;var b=this.getIntegrationObjectDialog();b.setBusy(true);var i={duration:7000,width:'20em'};v.createObject({API_TECH_NAME:this.objectTechnicalName,CAMPAIGN_ID:this.getObjectModel().getProperty("/CAMPAIGN_ID"),IDEA_ID:this.getObjectModel().getProperty("/ID")}).done(function(n){b.setBusy(false);b.close();var S=n.RESULT.status.toString().includes('20')?'Your request to create a new object request has been sent successfully.':'Your request to create a new object request has been failed.';var U=S+'The request ID is '+(n.RESULT.generatedId?n.RESULT.generatedId[-1]:'')+' and message status is: '+(n.RESULT.status?n.RESULT.status:'')+'.';var X=new h({text:U});var Y=new H({href:C.getBackendRootURL()+'/sap/ino/config#integrationMonitorList',text:'For more detail, please navigate to Innovation Office->Monitor->Integration',target:'_blank'});if(!this.oSuccessMessageDialog){this.oSuccessMessageDialog=new D({type:x.Message,title:n.RESULT.status.toString().includes('20')?y.Success:y.Error,state:n.RESULT.status.toString().includes('20')?y.Success:y.Error,content:new G({items:[X,Y],alignItems:"Start",justifyContent:"Start",alignContent:"Start"}),beginButton:new K({type:N.Emphasized,text:"OK",press:function(){this.oSuccessMessageDialog.close();}.bind(this)})});}this.oSuccessMessageDialog.open();}).fail(function(){b.setBusy(false);b.close();M.show(a.getText("INTEGRATION_TARGET_MSG_STATUS_CREATE_FAILED"),i);});},onIntegrationObjectDialogClose:function(){this.getIntegrationObjectDialog().close();this.getIntegrationObjectDialog().destroy();this._oCopyIntegrationObject=undefined;},selectIntegrationTarget:function(a){this.getIntegrationObjectDialog().getModel("objectContext").setProperty("/enableCreateIntegrationObjectBtn",true);this.objectTechnicalName=a.getParameter("listItem").getBindingContext("objectContext").getProperty("TECHNICAL_NAME");},onUpdateFinished:function(a){if(this.enableCreateIntegrationObjectTag){this.enableCreateIntegrationObjectTag=false;var i=this.byId("integrationTargetList");if(i&&i.getItems()){i.setSelectedItem(i.getItems()[0]);}}},onLinkExternalObject:function(){var a=this.getLinkExternalObjectDialog();v.getAllApiFromCampaign({CAMPAIGN_ID:this.getObjectModel().getProperty("/CAMPAIGN_ID")}).done(function(b){setTimeout(function(){a.setModel(new J(b),"ExternalObjectModel");a.getModel("ExternalObjectModel").setProperty("/LINK_OBJECT_INFO",{API_TECHNICAL_NAME:b&&b.RESULT&&b.RESULT.length===1?b.RESULT[0].TECHNICAL_NAME:null,OBJECT_ID:null,OBJECT_TYPE:null});a.open();},500);}).fail(function(b){b.RESULT=[];});},getLinkExternalObjectDialog:function(){if(!this._oLinkExternalObject){this._oLinkExternalObject=this.createFragment("sap.ino.vc.idea.fragments.LinkExternalObjectDialog",this.getView().getId());this.getView().addDependent(this._oLinkExternalObject);}return this._oLinkExternalObject;},onTargetSystemChange:function(a){var S=a.getSource();},onLinkExternalObjectSave:function(){var a=this;var b=this.getLinkExternalObjectDialog();if(this.getView().getController().hasAnyClientErrorMessages()){return;}var i=b.getModel("ExternalObjectModel");b.setBusy(true);var n={duration:7000,width:'20em'};v.linkExistedObject({API_TECH_NAME:i.getProperty("/LINK_OBJECT_INFO/API_TECHNICAL_NAME"),OBJECT_ID:i.getProperty("/LINK_OBJECT_INFO/OBJECT_ID"),OBJECT_TYPE:i.getProperty("/LINK_OBJECT_INFO/OBJECT_TYPE"),CAMPAIGN_ID:this.getObjectModel().getProperty("/CAMPAIGN_ID"),IDEA_ID:this.getObjectModel().getProperty("/ID")}).done(function(S){if(S.RESULT.existed){b.setBusy(false);z.show(a.getText("IDEA_OBJECT_MSG_INTEGRATION_LINK_EXISTED"),{title:a.getText("IDEA_OBJECT_TITLE_INTEGRATION_LINK_EXISTED"),icon:z.Icon.WARNING,actions:[z.Action.OK],onClose:function(b1){}});}else{b.setBusy(false);b.close();var U=S.RESULT.status.toString().includes('20')?a.getText("IDEA_OBJECT_MSG_INTEGRATION_LINK_SUCCESS"):a.getText("IDEA_OBJECT_MSG_INTEGRATION_LINK_FAILED");var X=S.RESULT.generatedId?S.RESULT.generatedId[-1]:'';var Y=S.RESULT.status?S.RESULT.status:'';var Z=a.getText("IDEA_OBJECT_MSG_INTEGRATION_LINK_SHOW_TEXT",[U,X,Y]);var _=new h({text:Z});var a1=new H({href:C.getBackendRootURL()+'/sap/ino/config#integrationMonitorList',text:a.getText("IDEA_OBJECT_MSG_INTEGRATION_LINK_MORE_DETAIL"),target:'_blank'});a.oLinkMessageDialog=new D({type:x.Message,title:S.RESULT.status.toString().includes('20')?y.Success:y.Error,state:S.RESULT.status.toString().includes('20')?y.Success:y.Error,content:new G({items:[_,a1],alignItems:"Start",justifyContent:"Start",alignContent:"Start"}),beginButton:new K({type:N.Emphasized,text:"OK",press:function(){a.oLinkMessageDialog.close();}.bind(this)})});a.oLinkMessageDialog.open();}}).fail(function(){b.setBusy(false);b.close();M.show(a.getText("INTEGRATION_TARGET_MSG_STATUS_CREATE_FAILED"),n);});},onLinkExternalObjectDialogClose:function(){this.getLinkExternalObjectDialog().close();this.getLinkExternalObjectDialog().destroy();this._oLinkExternalObject=undefined;},onDelete:function(a){var b=this;var i=a.getSource();var n=b.getObjectModel();var S=C.getSystemSettingsModel().getProperty("/sap.ino.config.PPM_INTEGRATION_ACTIVE");var U=n.getProperty("/INTEGRATION_OBJECT_EXIST");var X=n.getPropertyModel().getProperty("/actions/del/customProperties/hasReward");var Y=n.getPropertyModel().getProperty("/actions/del/enabled");var Z=n.getPropertyModel().getProperty("/actions/del/customProperties/isMergeedWithVote");if(X){M.show(this.getText("MSG_IDEA_HAVE_REWARD_CANNOT_DELETE"));}else if(!Y){M.show(this.getText("OBJECT_MSG_DELETE_FAILED"));}else if(Z){M.show(this.getText("MSG_IDEA_MERGED_WITH_VOTE_CANNOT_DELETE"));}else{var _=n.getProperty("/EVALUATION_COUNT");var a1=n.getPropertyModel().getProperty("/actions/del/customProperties/isManager");if(!_||(_&&a1)){var b1="MSG_DEL_CONFIRM";if(S==="1"||U){b1="MSG_IDEA_CAMP_MANAGER_DEL_CONFIRM_HAVE_PPM_INTEGRATION";}var c1=b.executeObjectAction("del",{messages:{confirm:b1,success:"MSG_DEL_SUCCESS"}});c1.done(function(d1){if(d1&&d1.confirmationCancelled===true){if(i&&jQuery.type(i.focus)==="function"){i.focus();}return;}b.navigateTo("idealist");});}else{M.show(this.getText("MSG_IDEA_DEL_FAILED_SUBMITTER_HAVE_EVALUATION"));}}},onPressPrevious:function(){var a=this.getObjectModel().getProperty("/ID");var b=this.getView().getModel("ideaList");var S=b.getData();var U;$.each(S,function(i,n){if(n===a){U=i;return false;}});var X=S[U-1];if(X){this.setViewProperty("/PAGE_INDICATOR",U);this.navigateTo("idea-display",{id:X});}},onPressNext:function(){var a=this.getObjectModel().getProperty("/ID");var b=this.getView().getModel("ideaList");var S=b.getData();var U;$.each(S,function(i,n){if(n===a){U=i;return false;}});var X=S[U+1];if(X){this.setViewProperty("/PAGE_INDICATOR",U+2);this.navigateTo("idea-display",{id:X});}},onExit:function(){B.prototype.onExit.apply(this,arguments);},initPageIndicatorLabel:function(a){var b=this;var S,U;S=this.getViewProperty("/PAGE_INDICATOR");U=this.getViewProperty("/PAGE_SIZE");var X=sap.ui.getCore().getModel("ideaSearchParams");if(X&&X.getData()){var Y=X.getData().path;if(X.getData().path.indexOf('IdeaMediumBackofficeSearchParams')>-1){Y=Y.replace('IdeaMediumBackofficeSearchParams','IdeaMediumBackofficeSearchParamsCount');}else{Y=Y.replace('IdeaMediumSearchParams','IdeaMediumSearchParamsCount');}jQuery.ajax({url:Y,headers:{'X-CSRF-Token':'Fetch'},type:'GET',contentType:'application/json; charset=UTF-8',async:true,success:function(Z){var _=new J();var a1=$.map(Z.d.results,function(i){return i.ID;});_.setData(a1);b.getView().setModel(_,"ideaList");var b1;$.each(a1,function(i,n){if(n===parseInt(a,10)){b1=i;return false;}});var c1=b.getViewProperty("/IDEA_SECTION_CONTAINER_ID");if(b1!==undefined){b.byId("pageIndicatorPanel").setVisible(true);b.setViewProperty("/IS_IN_CURRENT_IDEA_LIST",true);if(c1){b.byId("ideaPageToolbar").setHeight("5rem");$(c1).css("top","5rem");}var d1=a1.length;if(U!==d1){b.setViewProperty("/PAGE_SIZE",d1);}if(S!==b1+1){b.setViewProperty("/PAGE_INDICATOR",b1+1);}}else{b.byId("pageIndicatorPanel").setVisible(false);if(c1){b.byId("ideaPageToolbar").setHeight("2.5rem");$(c1).css("top","2.5rem");}}},error:function(i){b.byId("pageIndicatorPanel").setVisible(false);var n=b.getViewProperty("/IDEA_SECTION_CONTAINER_ID");if(n){b.byId("ideaPageToolbar").setHeight("2.5rem");$(n).css("top","2.5rem");}}});}else{b.byId("pageIndicatorPanel").setVisible(false);}},setPageContentTopStyle:function(){var a=this.getView().getModel("ideaList");var b="#"+this.byId("ideaDisplay").getScrollDelegate()._sContainerId;this.setViewProperty("/IDEA_SECTION_CONTAINER_ID",b);if((a&&a.getData().length>0)&&this.getViewProperty("/IS_IN_CURRENT_IDEA_LIST")){this.byId("ideaPageToolbar").setHeight("5rem");$(b).css("top","5rem");}else{this.byId("ideaPageToolbar").setHeight("2.5rem");$(b).css("top","2.5rem");}}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.Experts.controller')){jQuery.sap.declare('sap.ino.vc.idea.Experts.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/idea/Experts.controller",["sap/ino/vc/commons/BaseObjectController","sap/ui/model/json/JSONModel","sap/ino/commons/application/Configuration","sap/ino/commons/models/object/User","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/core/ListItem","sap/m/MessageToast","sap/m/MessageBox","sap/ino/vc/idea/mixins/AddExpertFromClipboardMixin"],function(B,J,C,U,F,a,D,L,M,b,A){"use strict";return B.extend("sap.ino.vc.idea.Experts",jQuery.extend({},A,{view:{IDEACARD_SECTION_VISIBLE:'STAT',CLIPBOARD_ITEM_SELECT_COUNTER:0,IS_EVALUATION_REQUEST:false},aSelectedExperts:[],onInit:function(){B.prototype.onInit.apply(this,arguments);this.getView().setModel(new J(this.view),"view");},onBeforeRendering:function(){var t=this;var v=this.getView();var i;if(this.getObjectModel()&&this.getObjectModel().getData().hasOwnProperty("IDEA_ID")){this.setViewProperty("/IS_EVALUATION_REQUEST",true);i=this.getObjectModel()&&this.getObjectModel().getData().IDEA_ID;}else{this.setViewProperty("/IS_EVALUATION_REQUEST",false);i=this.getObjectModel()&&this.getObjectModel().getKey();}if(!this._iIdeaId||this._iIdeaId!==i){this._iIdeaId=i;var p=new J(C.getIdeaExpertsByIdeaURL(i));v.setModel(p,"proposedExperts");}if(!this.getViewProperty("/IS_EVALUATION_REQUEST")){this.getObjectModel().read("/Experts",{success:function(){var o=t.byId("ideaExperts").getBindingInfo("content");t.byId("ideaExperts").unbindAggregation("content");t.byId("ideaExperts").bindAggregation("content",o);}});}},onExpertExpand:function(e){var i=e.getSource().getParent();i.toggleStyleClass("sapInoIdeaExpertItemSelected");},onOpenIdea:function(e){if(D.system.phone){this.getView().getParent().close();}var c=e.getSource().getBindingContext("proposedExperts");var i=c.getProperty("IDEA/ID");if(i){this.navigateTo("idea-display",{id:i});}},onSuggestIdeaExpert:function(e){var c=e.getSource();var v=e.getParameter("suggestValue");var t=new L({text:"{data>NAME}",additionalText:"{data>USER_NAME}",key:"{data>ID}"});var s="/SearchIdentity(searchToken='"+jQuery.sap.encodeURL(v)+"')/Results";var f=this._getSuggestExpertFilter();if(D.system.desktop){c.bindAggregation("suggestionItems",{path:"data>"+s,template:t,filters:f,parameters:{select:"searchToken,ID,NAME,USER_NAME"}});}else{c._bBindingUpdated=true;c.getModel("data").read(s,{filters:f,success:function(d){c.removeAllSuggestionItems();for(var i=0;i<d.results.length-1;i++){c.addAggregation("suggestionItems",new L({key:d.results[i].ID,text:d.results[i].NAME,additionalText:d.results[i].USER_NAME}),true);}if(d.results.length>0){c.addSuggestionItem(new L({key:d.results[d.results.length-1].ID,text:d.results[d.results.length-1].NAME,additionalText:d.results[d.results.length-1].USER_NAME}));}}});}this.aSelectedExperts=[];},_getSuggestExpertFilter:function(){var f=[];var c=this.getObjectModel().getProperty("/SubmitterContributorsCoach");jQuery.each(c,function(i,o){if(o.ROLE_CODE==="IDEA_SUBMITTER"||o.ROLE_CODE==="IDEA_CONTRIBUTOR"){var d=new F({path:"ID",operator:a.NE,value1:o.IDENTITY_ID});f.push(d);}});return(f.length===0)?[]:[new F(f,true)];},onAddInputExpert:function(e){var i=this.byId("suggestUser");var s=e.getParameters().selectedItem;if(!s){var r=jQuery.grep(i.getSuggestionItems(),function(S){return S.getText()===i.getValue();});if(r.length>0){s=r[0];}}if(s){var E=s&&parseInt(s.getKey(),10);this.openAddExpertDialog(E);}i.setValue("");i.focus();},onAddInputExpertForDialog:function(e){var s=e.getParameters().selectedItem;if(s){var E=s&&parseInt(s.getKey(),10);var c=s.getText();var d=[{IDENTITY_ID:E,NAME:c}];this._addExpert(d,c);}},getAddExpertDialog:function(){if(!this._oAddExpertDialog){this._oAddExpertDialog=this.createFragment("sap.ino.vc.idea.fragments.AddExpert");this.getView().addDependent(this._oAddExpertDialog);}return this._oAddExpertDialog;},openAddExpertDialog:function(e){var E="data>/Identity("+e+")";var d=this.getAddExpertDialog();d.bindElement({path:E});d.open();},onAddExpertDialogOK:function(){var c=this.getAddExpertDialog().getBindingContext("data");var e=c.getProperty("ID");var E=[{IDENTITY_ID:e}];this._addExpert(E,c.getProperty("NAME"));var d=this.getAddExpertDialog();d.close();},onAddExpertDialogCancel:function(){var d=this.getAddExpertDialog();d.close();},onAddRemoveExpert:function(e){var s=e.getParameter("action");var E=e.getParameter("identityId");var c=e.getParameter("userName");var d=[{IDENTITY_ID:E}];switch(s){case"add":this.openAddExpertDialog(E);break;case"remove":this._removeExpert(d,c);break;default:break;}},onAddRemoveExpertForDialog:function(e){var s=e.getParameter("action");var E=e.getParameter("identityId");var c=e.getParameter("userName");var d=[{IDENTITY_ID:E,NAME:c}];switch(s){case"add":this._addExpert(d);break;case"remove":this._removeExpert(d);break;default:break;}},onTokenDelete:function(e){var t=e.getSource();var E=Number(t.getKey());var c=[{IDENTITY_ID:E}];this._removeExpert(c);},isExpertActionable:function(e,p,i){p=p||this.getObjectModel().getProperty("/property/nodes/Root/customProperties/backofficeChangeExpertPrivilege");i=i||this.getObjectModel().getProperty("/Experts");var c=this.getObjectModel().getProperty("/SubmitterContributorsCoach");return!!(p&&i&&jQuery.isArray(i)&&jQuery.grep(i,function(o){return o.IDENTITY_ID===e;}).length===0&&jQuery.grep(c,function(o){return(o.ROLE_CODE==="IDEA_SUBMITTER"||o.ROLE_CODE==="IDEA_CONTRIBUTOR")&&o.IDENTITY_ID===e;}).length===0);},isExpertAddedForDialog:function(e,E){E=E||this.getObjectModel().getProperty("/Experts")||[];return!!(jQuery.isArray(E)&&jQuery.grep(E,function(o){return o.IDENTITY_ID===e;}).length===0);},respExpertsFormatter:function(t,v){return jQuery.sap.formatMessage(t,v||"");},}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.List.controller')){jQuery.sap.declare('sap.ino.vc.idea.List.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.core.Item');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.core.ValueState');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.m.Token');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ino/vc/idea/List.controller",["sap/ino/vc/library","sap/ino/vc/commons/BaseVariantListController","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/model/Sorter","sap/ui/core/Item","sap/ino/commons/application/Configuration","sap/ino/commons/models/core/CodeModel","sap/ui/core/mvc/ViewType","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ino/commons/formatters/ObjectListFormatter","sap/ino/controls/OrientationType","sap/ino/vc/idea/mixins/AssignmentActionMixin","sap/ino/vc/idea/mixins/ChangeStatusActionMixin","sap/ino/vc/idea/mixins/FollowUpMixin","sap/ino/vc/idea/mixins/DeleteActionMixin","sap/m/MessageToast","sap/ui/core/ValueState","sap/ui/core/format/DateFormat","sap/ino/vc/evaluation/EvaluationFormatter","sap/m/Token","sap/ino/vc/commons/mixins/ExportMixin","sap/ino/vc/idea/mixins/VoteMixin","sap/ino/vc/idea/mixins/MergeActionMixin","sap/ino/vc/commons/mixins/ExtensibilityMixin","sap/m/MessageBox","sap/ino/commons/models/object/PersonalizeSetting","sap/ino/commons/models/aof/ApplicationObjectChange","sap/ino/vc/commons/mixins/TagGroupMixin","sap/ino/vc/commons/mixins/FollowMixin","sap/ino/vc/idea/mixins/ChangeStatusActionFormatter","sap/ino/vc/idea/mixins/VolunteerMixin","sap/ino/vc/idea/mixins/AddExpertFromClipboardMixin","sap/ino/vc/idea/mixins/CommonFilterMixin","sap/ino/vc/idea/mixins/DueFilterMixin","sap/ino/vc/idea/mixins/CampaignFormFilterMixin","sap/ino/vc/idea/mixins/IdeaFormCriteriaFilterMixin","sap/ino/vc/idea/mixins/ChangeAuthorActionMixin","sap/ino/vc/idea/mixins/ChangeAuthorActionFormatter","sap/ino/vc/idea/mixins/MarkAsReadActionMixin","sap/ino/vc/idea/mixins/CompanyViewFilterMixin"],function(l,B,D,J,S,I,C,a,V,F,b,O,c,A,d,f,g,M,h,k,E,T,m,n,p,q,r,P,s,t,u,v,w,y,z,G,H,K,L,N,Q,R){"use strict";var U={EMPTY:"",COMPLETED:"COMPLETED",NODISCONTINUED:"NODISCONTINUED",DISCONTINUED:"DISCONTINUED",ACTIVE:"ACTIVE",NEW:"NEW"};var W={EMPTY:"",NEW_UPDATES:"SHOW_UPDATED_VIEWER",NEW_STATUSES:"SHOW_STATUSCHANGE_VIEWER",NEW_COMMENTS:"SHOW_COMMENT_VIEWER"};var X={ASC:"ASC",DESC:"DESC"};var Y={IDEA:"idealist",IDEA_VARIANT:"idealistvariant"};var Z={EQ:"EQ",GE:"GE",LE:"LE"};var $={CHANGED_AT:"CHANGED_AT_DT",COMMENT_COUNT:"COMMENT_COUNT",EVALUATION_COUNT:"EVALUATION_COUNT",EXP_SCORE:"EXP_SCORE",FOLLOW_UP_DATE:"FOLLOW_UP_AT_DT",LAST_PUBL_EVAL_AT:"LAST_PUBL_EVAL_AT",NAME:"tolower(NAME)",RESP_VALUE_LIST:"tolower(RESP_VALUE_NAME)",SCORE:"SCORE",SEARCH_SCORE:"SEARCH_SCORE",SUBMITTED_AT:"SUBMITTED_AT_DT",VOTE_COUNT:"VOTE_COUNT",CREATED_AT:"CREATED_AT"};var _={ALL:"all",MY:"my",VOTED:"voted",COMMENTED:"commented",VOTE:"vote",COMPLETED:"completed",MANAGED_COMPLETED:"managedcompleted",EVAL:"eval",EVAL_PENDING:"evalpending",MANAGE:"manage",FOLLOW_UP:"follow",UNASSIGNED:"unassigned",COACH_ME:"coachme",EVAL_DONE:"evaldone",EVAL_OPEN:"evalopen",MY_GROUP_VIEW_AUTH:"mygroup",MY_GROUP_VIEW_VOTED:"mygroupvoted",MY_GROUP_VIEW_COMMENTED:"mygroupcommented",FOLLOWING:"following"};var a1={NONE:undefined,MY_AUTH:"myAuthoredIdeas",MY_VOTED:"myVotedIdeas",MY_COMMENTED:"myCommentedIdeas",MY_GROUP_VIEW_AUTH:"myGroupAuthoredIdeas",MY_GROUP_VIEW_VOTED:"myGroupVotedIdeas",MY_GROUP_VIEW_COMMENTED:"myGroupCommentedIdeas",OPEN_VOTE:"ideasIcanVoteFor",COMPLETED:"completedIdeas",MANAGED_COMPLETED:"managedCompletedIdeas",MY_EVAL:"myEvaluatedIdeas",EVAL_REQUIRED:"myEvaluatableIdeas",UNASSIGNED_COACH:"unassignedCoach",EVALUATED:"evaluatedIdeas",FOLLOW_UP:"followedupIdeas",COACH_ME:"coachedIdeasByMe",MANAGE:"",EVAL_OPEN:"openForEvaluation",FOLLOWING:"myFollowingIdeas"};var b1={NAME:"IDEA_LIST_TIT_NAME",MANAGEDNAME:"IDEA_LIST_TIT_MANAGEDNAME",IS_FILTER_SUBPAGE:true,ADJUSTMENT_TITLE:"IDEA_LIST_TIT_ADJUSTMENT",Filter:{Values:[{TEXT:"IDEA_LIST_MIT_FILTER_PHASE",KEY:"PHASE"},{TEXT:"IDEA_LIST_MIT_FILTER_STATUS",KEY:"STATUS"}],Status:[{TEXT:"IDEA_LIST_MIT_FILTER_STATUS_COMPLETED",KEY:U.COMPLETED},{TEXT:"IDEA_LIST_MIT_FILTER_STATUS_NODISCONTINUED",KEY:U.NODISCONTINUED},{TEXT:"IDEA_LIST_MIT_FILTER_STATUS_DISCONTINUED",KEY:U.DISCONTINUED},{TEXT:"IDEA_LIST_MIT_FILTER_STATUS_ACTIVE",KEY:U.ACTIVE},{TEXT:"IDEA_LIST_MIT_FILTER_STATUS_NEW_IDEAS",KEY:U.NEW}],PhaseBinding:{MODEL:"code",CODE_PATH:"CODE",TABLE_PATH:"sap.ino.xs.object.campaign.Phase.Root",EMPTY_CODE_TEXT:"IDEA_LIST_MIT_FILTER_PHASE_EMPTY"},LatestUpdate:[{TEXT:"IDEA_LIST_MIT_FILTER_LATEST_UPDATE_NEW_UPDATES",KEY:W.NEW_UPDATES},{TEXT:"IDEA_LIST_MIT_FILTER_LATEST_UPDATE_NEW_STATUSES",KEY:W.NEW_STATUSES},{TEXT:"IDEA_LIST_MIT_FILTER_LATEST_UPDATE_NEW_COMMENTS",KEY:W.NEW_COMMENTS}]},QuickSorter:[{TEXT:"SORT_MIT_MOST_RECENT",ACTION:$.CREATED_AT,DEFAULT_ORDER:X.DESC},{TEXT:"SORT_MIT_LATEST_CHANGE",ACTION:$.CHANGED_AT,DEFAULT_ORDER:X.DESC},{TEXT:"SORT_MIT_MOST_VOTE",ACTION:$.VOTE_COUNT,DEFAULT_ORDER:X.DESC}],Sorter:{Values:[{TEXT:"SORT_MIT_CHANGED",ACTION:$.CHANGED_AT,DEFAULT_ORDER:X.DESC},{TEXT:"SORT_MIT_SUBMITTED",ACTION:$.SUBMITTED_AT,DEFAULT_ORDER:X.DESC},{TEXT:"SORT_MIT_TITLE",ACTION:$.NAME,DEFAULT_ORDER:X.ASC},{TEXT:"SORT_MIT_VOTE",ACTION:$.SCORE,DEFAULT_ORDER:X.DESC},{TEXT:"SORT_MIT_VOTE_NUM",ACTION:$.VOTE_COUNT,DEFAULT_ORDER:X.DESC},{TEXT:"SORT_MIT_RESP_VALUE_LIST",ACTION:$.RESP_VALUE_LIST,DEFAULT_ORDER:X.DESC},{TEXT:"SORT_MIT_SEARCH_SCORE",ACTION:$.SEARCH_SCORE,DEFAULT_ORDER:X.DESC}],Limit:2},Order:{Values:[{TEXT:"ORDER_MIT_ASC",ACTION:X.ASC},{TEXT:"ORDER_MIT_DESC",ACTION:X.DESC}]},Operator:{Values:[{TEXT:"OPERATOR_MIT_EQ",ACTION:Z.EQ},{TEXT:"OPERATOR_MIT_GE",ACTION:Z.GE},{TEXT:"OPERATOR_MIT_LE",ACTION:Z.LE}]},Variants:{DEFAULT_VARIANT:_.ALL,TITLE:"IDEA_LIST_TIT_VARIANTS",Values:[{TEXT:"IDEA_LIST_MIT_EVAL_PENDING",ACTION:_.EVAL_PENDING,FILTER:a1.EVAL_REQUIRED,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.SUBMITTED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:0,OBJECT_TYPE_CODE:a1.EVAL_REQUIRED,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ENABLED:1,ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role"]},{TEXT:"IDEA_LIST_MIT_OPEN_FOR_EVAL",ACTION:_.EVAL_OPEN,FILTER:a1.EVAL_OPEN,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.SUBMITTED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:1,ENABLED:1,OBJECT_TYPE_CODE:a1.EVAL_OPEN,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role"]},{TEXT:"IDEA_LIST_MIT_MY_EVAL",ACTION:_.EVAL,FILTER:a1.MY_EVAL,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.SUBMITTED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:2,ENABLED:1,OBJECT_TYPE_CODE:a1.MY_EVAL,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role"]},{TEXT:"IDEA_LIST_MIT_VOTE",ACTION:_.VOTE,FILTER:a1.OPEN_VOTE,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.SUBMITTED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:3,ENABLED:1,OBJECT_TYPE_CODE:a1.OPEN_VOTE,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role","sap.ino.ui::camps_part_role"]},{TEXT:"IDEA_LIST_MIT_MY",ACTION:_.MY,FILTER:a1.MY_AUTH,INCLUDE_DRAFT:true,COUNT:"0",DEFAULT_SORT:$.CHANGED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:4,ENABLED:1,OBJECT_TYPE_CODE:a1.MY_AUTH,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role"]},{TEXT:"IDEA_LIST_MIT_VOTED",ACTION:_.VOTED,FILTER:a1.MY_VOTED,INCLUDE_DRAFT:true,COUNT:"0",DEFAULT_SORT:$.CHANGED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:5,ENABLED:1,OBJECT_TYPE_CODE:a1.MY_VOTED,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role","sap.ino.ui::camps_resp_expert_role","sap.ino.ui::camps_expert_role"]},{TEXT:"IDEA_LIST_MIT_COMMENTED",ACTION:_.COMMENTED,FILTER:a1.MY_COMMENTED,INCLUDE_DRAFT:true,COUNT:"0",DEFAULT_SORT:$.CHANGED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:6,ENABLED:1,OBJECT_TYPE_CODE:a1.MY_COMMENTED,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role","sap.ino.ui::camps_resp_expert_role","sap.ino.ui::camps_expert_role"]},{TEXT:"IDEA_LIST_MIT_COMPLETED",ACTION:_.COMPLETED,FILTER:a1.COMPLETED,INCLUDE_DRAFT:false,COUNT:0,DEFAULT_SORT:$.SUBMITTED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:7,ENABLED:1,OBJECT_TYPE_CODE:a1.COMPLETED,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role"]},{TEXT:"IDEA_LIST_MIT_ALL",ACTION:_.ALL,FILTER:a1.NONE,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.SUBMITTED_AT,ACTIVE:true,SEQUENCE:8,OBJECT_TYPE_CODE:"all",ENABLED:1,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role","sap.ino.ui::camps_part_role"]},{TEXT:"IDEA_LIST_MIT_MANAGE",ACTION:_.MANAGE,FILTER:a1.MANAGE,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.SUBMITTED_AT,MANAGE:true,ACTIVE:true,SEQUENCE:9,ENABLED:1,OBJECT_TYPE_CODE:"IdeaTobeManaged",TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{TEXT:"IDEA_LIST_MIT_FOLLOW_UP",ACTION:_.FOLLOW_UP,FILTER:a1.FOLLOW_UP,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.FOLLOW_UP_DATE,HIERARCHY_LEVEL:"1",MANAGE:true,ACTIVE:true,SEQUENCE:10,ENABLED:1,OBJECT_TYPE_CODE:a1.FOLLOW_UP,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{TEXT:"IDEA_LIST_MIT_UNASSIGNED",ACTION:_.UNASSIGNED,FILTER:a1.UNASSIGNED_COACH,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.SUBMITTED_AT,HIERARCHY_LEVEL:"1",MANAGE:true,ACTIVE:true,SEQUENCE:11,ENABLED:1,OBJECT_TYPE_CODE:a1.UNASSIGNED_COACH,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{TEXT:"IDEA_LIST_MIT_COACH_ME",ACTION:_.COACH_ME,FILTER:a1.COACH_ME,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.SUBMITTED_AT,HIERARCHY_LEVEL:"1",MANAGE:true,ACTIVE:true,SEQUENCE:12,ENABLED:1,OBJECT_TYPE_CODE:a1.COACH_ME,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{TEXT:"IDEA_LIST_MIT_EVAL_DONE",ACTION:_.EVAL_DONE,FILTER:a1.EVALUATED,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.LAST_PUBL_EVAL_AT,HIERARCHY_LEVEL:"1",MANAGE:true,ACTIVE:true,SEQUENCE:13,ENABLED:1,OBJECT_TYPE_CODE:a1.EVALUATED,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{TEXT:"IDEA_LIST_MIT_COMPLETED",ACTION:_.MANAGED_COMPLETED,FILTER:a1.MANAGED_COMPLETED,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.SUBMITTED_AT,HIERARCHY_LEVEL:"1",MANAGE:true,ACTIVE:true,SEQUENCE:14,ENABLED:1,OBJECT_TYPE_CODE:a1.MANAGED_COMPLETED,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role"]},{TEXT:"IDEA_LIST_MIT_FOLLOWING",ACTION:_.FOLLOWING,FILTER:a1.FOLLOWING,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.CHANGED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:15,ENABLED:1,OBJECT_TYPE_CODE:a1.FOLLOWING,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role"]},{TEXT:"IDEA_LIST_MIT_GROUP_"+C.getGroupConfiguration().GROUP+"_AUTH",ACTION:_.MY_GROUP_VIEW_AUTH,FILTER:a1.MY_GROUP_VIEW_AUTH,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.CHANGED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:16,ENABLED:1,OBJECT_TYPE_CODE:a1.MY_GROUP_VIEW_AUTH,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",DISPLAY_LABEL:C.getGroupConfiguration().DISPLAY_LABEL,ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role"]},{TEXT:"IDEA_LIST_MIT_GROUP_"+C.getGroupConfiguration().GROUP+"_VOTED",ACTION:_.MY_GROUP_VIEW_VOTED,FILTER:a1.MY_GROUP_VIEW_VOTED,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.CHANGED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:17,ENABLED:1,OBJECT_TYPE_CODE:a1.MY_GROUP_VIEW_VOTED,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",DISPLAY_LABEL:C.getGroupConfiguration().DISPLAY_LABEL,ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role"]},{TEXT:"IDEA_LIST_MIT_GROUP_"+C.getGroupConfiguration().GROUP+"_COMMENTED",ACTION:_.MY_GROUP_VIEW_COMMENTED,FILTER:a1.MY_GROUP_VIEW_COMMENTED,INCLUDE_DRAFT:false,COUNT:"0",DEFAULT_SORT:$.CHANGED_AT,HIERARCHY_LEVEL:"1",ACTIVE:true,SEQUENCE:18,ENABLED:1,OBJECT_TYPE_CODE:a1.MY_GROUP_VIEW_COMMENTED,TYPE_CODE:"QUICK_LINK_STANDARD_IDEA",DISPLAY_LABEL:C.getGroupConfiguration().DISPLAY_LABEL,ROLES:["sap.ino.ui::camps_mgr_role","sap.ino.ui::camps_coach_role","sap.ino.ui::camps_resp_coach_role","sap.ino.ui::camps_part_role","sap.ino.ui::camps_expert_role","sap.ino.ui::camps_resp_expert_role"]}]}};var c1=k.getInstance({pattern:"YYYY-MM-dd"});var d1=["QUICK_LINK_CUSTOM_IDEA","QUICK_LINK_STANDARD_IDEA"];var e1=B.extend("sap.ino.vc.idea.List",jQuery.extend({},A,d,f,g,m,n,p,q,t,u,w,y,z,G,H,K,L,Q,R,{list:b1,initialFocus:"filterButton",view:{"NAME":"IDEA_LIST","List":{"SORT":$.SUBMITTED_AT,"ORDER":undefined,"PHASE":[],"LATEST_UPDATE":[],"STATUS":[],"SUB_STATUS":[],"VARIANT":_.ALL,"MANAGE":false,"TAGS":[],"IS_TAGS_SELECTION":false,"CAMPAIGN":undefined,"DUE":undefined,"AUTHORS":[],"COACHES":[],"TAGCLOUD":true,"EXTENSION":{},"RESP_VALUE_CODE":[],"RESP_VALUE_NAME":"","VOTE_OPERATOR":Z.EQ,"VOTE_NUMBER":"","TAGCLOUD_EXPABLE":true,"TAGCLOUD_EXP":false,"TAGCLOUD_BAR_VISIBLE":false,"HIDE_PPT_EXPORT":false,"IS_FILTER_SUBPAGE":true,"IS_SHOW_MORE_FILTER":true,"SELECT_ALL":false,"SELECT_ALL_ENABLE":false,"SHOW_MASS_ACTION_BAR":true,"EXPORT_ALL":false,"EXPORT_IDEA_VIA_EMAIL":C.getSystemSettingsModel().getProperty("/sap.ino.config.EXPORT_IDEALIST_VIA_EMAIL_ACTIVE")==="1","IDEA_FILTER_SWITCH_VISIBLE":C.getPersonalize().FILTER_ACTIVE_IDEA,"IDEA_FILTER_NEW_AND_INPROCESS":C.getPersonalize().FILTER_ACTIVE_IDEA?C.getPersonalize().FILTER_ACTIVE_IDEA:false,"IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW":false,"IDEA_FILTER_COMMUNITY_GROUP_VIEW_VISIBLE":C.getGroupConfiguration().ENABLE_GROUP_VIEW,"IDEA_LIST_FILTER_PERSONALIZATION":null,"QUICKLINKNAME":undefined,"ADDSHORTBYVALUE":true,"SELECTQUICKLINKID":undefined},"ORIENTATION":C.getPersonalize().IDEA_VIEW?c.PORTRAIT:c.LANDSCAPE,"CLIPBOARD_ITEM_SELECT_COUNTER":0,"QUICK_LINK_COUNT":0,"NEWQUICKLINKFUNCTION":false,"ORIGINALVARIANT":undefined,"CURRENTURL":undefined},formatter:jQuery.extend({},O,f.followUpMixinFormatter,E,v,N),onInit:function(){this.formatter.filterStyleClass=function(e){return e===undefined?"":"sapUiTinyMarginBegin";};B.prototype.onInit.apply(this,arguments);this.oViewModel=this.getModel("view");this.oViewModel.setData(this.view,true);this.getList().addStyleClass(this.getPortraitStyle());this.getList().setWrapping(true);this.getList().attachUpdateFinished(this.onUpdateFinished,this);this.initApplicationObjectChangeListeners();this.initFilterItemModel();this.initCompanyView();},onAfterRendering:function(){},getScrollContainer:function(){return this.byId("scrollContainer");},addSubFilterPageContent:function(e){var o=this.getFilterNavContainer();var i=o.getPages();i[0].getContent()[0].addItem(e);this.onSetFilterBarVisible("authorFilter","coachFilter");},removeSubFilterPageContent:function(){var o=this.getFilterNavContainer();var e=o.getPages();var i=e[0].getContent()[0];if(i.getItems().length>2){i.getItems()[2].destroy(true);}},show:function(e,o){var i;var j;if(e&&e.getParameter){var x=e.getParameter("arguments");i=x["?query"];j=x.variant;}else{j=o.variant;i=o;}var f1=this;var g1=location.href.split("#/")[1];if(g1){this.setViewProperty("/CURRENTURL",decodeURIComponent(g1));}this.setViewProperty("/ORIGINALVARIANT",j);if(this.getVariant(j)&&C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")){var h1=this.getVariant(j).MANAGE?true:false;this.getModel("component").setProperty("/SHOW_BACKOFFICE",h1);}var i1=this.getModel("component").getProperty("/SHOW_BACKOFFICE");var j1=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")&&!this._iCampaignId&&i1?_.MANAGE:this.getListProperty("/Variants/DEFAULT_VARIANT");if(this.getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW")){j1=_.MY;}if(i&&i.managed&&!j){if(!this.getModel("component").getProperty("/SHOW_BACKOFFICE")){j1=this.getListProperty("/Variants/DEFAULT_VARIANT");}else{j1=_.MANAGE;}this.setViewProperty("/ORIGINALVARIANT",j||j1);i.sort=$.SEARCH_SCORE;}this.setViewProperty("/isre",j||j1);this.setViewProperty("/Variants/DEFAULT_VARIANT",j1);j=this.getViewProperty("/isre");var k1=jQuery.extend(true,{},this.getVariant(j));this.changeDefaultSortOfVariant(k1,i);this.setViewProperty("/List/VARIANT",k1.ACTION);this.campaignId=o&&o.campaign||'';var l1,m1;var n1=this.getList().isBound("items");if((!i||!i.sort)&&k1.DEFAULT_SORT){var o1=k1.DEFAULT_SORT;var p1;var q1=this.getSort(o1);if(q1.length>0){p1=q1[0].DEFAULT_ORDER;}i=i||{};i.sort=i.sort||o1;i.sort=i.sort+" "+(i.order||p1);}var r1=this.hasStateChanged(this.getCurrentRoute(),j,i,D.orientation.portrait);r1=r1||this._bListChanged;this._bListChanged=false;var s1=C.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE");this.setViewProperty('/List/DISABLE_IDEA_IMAGE',!!(s1*1));var t1=this.getViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS");if(!n1||r1){this.setParameters(i,k1);this.setVariantVisibility(k1);this.removeInvalidFilters(i.variant?i:{variant:j});l1=this.getSort(this.getViewProperty("/List/SORT"));m1=this.getQuickSort(this.getViewProperty("/List/QUICKSORT"));this.setSorter(m1.concat(l1));this.updateFilter();var u1=this.getViewProperty("/ORIENTATION");this.onOrientationChange(D.system.desktop?u1:D.orientation);this.getIdeaFilterCount(i);this.getQuickLinkSetting(k1,e,i);this.getIdeaFilterSetting();this.bindList();this.initialSorterItems();this.bindTagCloud();if(this.getViewProperty("/List/IS_SHOW_MORE_FILTER")){this.bindFilters();}}["statusSelect","subStatusSelect","phaseSelect"].forEach(function(v1){var w1=f1.byId(v1);if(!w1){return;}w1.onAfterRendering=function(){if(w1._oTokenizer){w1._oTokenizer.setEditable(false);}};});this._deriveMassActionButtonEnabledStatus();this.setShortByIcon("shortByIcon1","shortByIcon2");},getIdeaFilterSetting:function(){var e=this;P.getFilterSettings().done(function(i){var o=e.getModel("view");o.setProperty("/List/IDEA_LIST_FILTER_PERSONALIZATION",i.RESULT);});},getIdeaFilterCount:function(o){var e=this.getModel("list").getProperty("/Variants/Values")||'';var i=this.getViewProperty("/List/STATUS")||[];var j=this.getViewProperty("/List/SUB_STATUS")&&this.getViewProperty("/List/SUB_STATUS").toString();var x=this.getViewProperty("/List/RESP_VALUE_CODE").map(function(w1){return w1.code;});var f1=this.getModel("component").getProperty("/SHOW_BACKOFFICE");var g1=this.getViewProperty("/List/PHASE")&&this.getViewProperty("/List/PHASE").toString();var h1=this.getViewProperty("/List/CAMPAIGN")||'';var i1=this.campaignId;var j1=o.search||"";var k1=this.getViewProperty("/List/VOTE_NUMBER");var l1=this.getViewProperty("/List/VOTE_OPERATOR");var m1=this.getViewProperty("/List/AUTHORS")&&this.getViewProperty("/List/AUTHORS").toString();var n1=this.getViewProperty("/List/COACHES")&&this.getViewProperty("/List/COACHES").toString();var o1=this.getViewProperty("/List/LATEST_UPDATE")&&this.getViewProperty("/List/LATEST_UPDATE").toString();var p1=this.getViewProperty("/List/TAGS");var q1={};var r1=[];p1.forEach(function(w1){if(!q1[w1.ROOTGROUPID]){q1[w1.ROOTGROUPID]=[];q1[w1.ROOTGROUPID].push(w1.ID);r1.push(w1.ROOTGROUPID);}else{q1[w1.ROOTGROUPID].push(w1.ID);}});if(i1===''){i1=h1;}var s1=this.getViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS");var t1={searchToken:window.decodeURIComponent(j1),searchType:this.getSearchType(),CAMPAIGN_ID:i1,oIdeaFilterChange:s1,phase:g1,status_code:j,status_type:i.join(","),resp_code:x.length>0?x.join(","):"",dueFrom:this.getFilterItem("/DueFrom"),dueTo:this.getFilterItem("/DueTo"),vote_num:k1,vote_operator:l1,authorKeys:m1,coachKeys:n1,latestUpdate:o1,tagTokens:q1[r1[0]]?q1[r1[0]].join(","):"",tagTokens1:q1[r1[1]]?q1[r1[1]].join(","):"",tagTokens2:q1[r1[2]]?q1[r1[2]].join(","):"",tagTokens3:q1[r1[3]]?q1[r1[3]].join(","):"",tagTokens4:q1[r1[4]]?q1[r1[4]].join(","):"",ideaFormId:this.getCampaignFormQuery(),bShowBackoffice:f1};this.getIdeaformQuery(t1);this.getCompanyViewQuery(t1);var u1=this.getModel("list");var v1=this.getModel("list").getProperty("/CURRENTQUICKLINK");C.getIdeaFilterCount(t1,u1,e,v1);},getQuickLinkSetting:function(o,e,i){var j=this;var x=this.getModel("list").getProperty("/Variants/Values")||'';this.getModel("list").setProperty("/CURRENTQUICKLINK",undefined);P.getQuickLinkSettings({'TYPE_CODE':d1}).done(function(f1){if(f1.RESULT.length>0&&x){f1.RESULT.forEach(function(h1){x.forEach(function(i1){if(h1.TYPE_CODE==="QUICK_LINK_STANDARD_IDEA"&&i1.TYPE_CODE==="QUICK_LINK_STANDARD_IDEA"&&h1.OBJECT_TYPE_CODE===i1.OBJECT_TYPE_CODE){i1.ACTIVE=h1.ACTIVE===1?true:false;i1.SEQUENCE=h1.SEQUENCE;i1.ID=h1.ID;i1.ENABLED=h1.ENABLED;}else if(h1.TYPE_CODE==="QUICK_LINK_CUSTOM_IDEA"){var j1=x.every(function(k1){if(k1.TYPE_CODE==="QUICK_LINK_STANDARD_IDEA"){return true;}if(k1.TYPE_CODE==="QUICK_LINK_CUSTOM_IDEA"){return h1.ID!==k1.ID;}});if(j1&&i1.TYPE_CODE==="QUICK_LINK_STANDARD_IDEA"&&h1.OBJECT_TYPE_CODE===i1.OBJECT_TYPE_CODE){h1.ACTIVE=h1.ACTIVE===1?true:false;h1.FILTER=i1.FILTER;h1.ACTION=i1.ACTION;h1.ROLES=i1.ROLES;if(i1.MANAGE){h1.MANAGE=i1.MANAGE;}x.push(h1);}}});});j.setViewProperty("/NEWQUICKLINKFUNCTION",true);}j.getModel("list").setProperty("/Variants/Values",x);j.setVariantVisibility(o);var g1=j.getVariantVisibility(o.ACTION);if(g1===false||typeof(g1)==="undefined"){j.navigateToTopLink(i);return;}j.getCurrentUrlId();});},navigateToTopLink:function(o){var e=this.getCurrentQuickIdeaList();this.navigateToFirstQuickLink(e.getVisibleItems(),o);},getFilterInfoByLink:function(e){e=e||'';e=e.split('?');if(e.length>=2){e=e[1];}var j=e!==''?e.split('&'):[];var o={},x,f1,g1;var h1=/(.*)=([^&]+)/;for(var i=0;i<j.length;i++){x=j[i].match(h1);if(x&&x.length===3){f1=x[1].toUpperCase();g1=x[2];o[f1]=g1;}}return o;},setShortByIcon:function(e,i){var o=this.byId(e)||this.getFilterElementById(e);var j=["sap-icon://sort-ascending","sap-icon://sort-descending"];var x=this.getViewProperty("/List/SORT");var f1=x.split(",");var g1=f1[0].split(" ");if(g1[1]==="ASC"&&o){o.setSrc(j[0]);o.setTooltip(this.getText('EXP_ASCENDING_SORT_BUTTON'));}else if(g1[1]==="DESC"&&o){o.setSrc(j[1]);o.setTooltip(this.getText('EXP_DESCENGDING_SORT_BUTTON'));}if(f1[1]){var h1=this.byId(i)||this.getFilterElementById(i);var i1=f1[1].split(" ");if(i1[1]==="ASC"&&h1){h1.setSrc(j[0]);h1.setTooltip(this.getText('EXP_ASCENDING_SORT_BUTTON'));}else if(i1[1]==="DESC"&&h1){h1.setSrc(j[1]);h1.setTooltip(this.getText('EXP_DESCENGDING_SORT_BUTTON'));}}},setVariantVisibility:function(o){var e=this.getModel("list").getProperty("/Variants/Values");var j=this.getModel("user").getProperty("/privileges");for(var i=0;i<e.length;i+=1){var x=e[i];var f1=false;if(j){for(var g1=0;g1<=x.ROLES.length-1;g1++){if(j[x.ROLES[g1]]){f1=true;break;}}}if(!this.getModel('component').getProperty('/SHOW_BACKOFFICE')&&this.getViewProperty("/List/IDEA_FILTER_COMMUNITY_GROUP_VIEW_VISIBLE")){if(x.ACTION===_.MY_GROUP_VIEW_AUTH||x.ACTION===_.MY_GROUP_VIEW_VOTED||x.ACTION===_.MY_GROUP_VIEW_COMMENTED||x.ACTION===_.FOLLOWING){f1=this.getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW");}else{f1=!this.getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW");}if(this.getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW")&&(x.ACTION===_.MY||x.ACTION===_.COMMENTED||x.ACTION===_.VOTED)){f1=this.getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW");}}if(!this.getViewProperty("/List/IDEA_FILTER_COMMUNITY_GROUP_VIEW_VISIBLE")&&x.TEXT&&x.TEXT.indexOf("_GROUP_")>-1){f1=false;}if(this.getModel('component').getProperty('/SHOW_BACKOFFICE')&&C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")){f1=(x.MANAGE||false)&&f1;if(x.ACTION===_.MANAGED_COMPLETED&&this.getViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS")){f1=false;}}this.getModel("list").setProperty("/Variants/Values/"+i+"/VISIBLE",f1);}},getVariantVisibility:function(e){var j,o;j=this.getModel("list").getProperty("/Variants/Values");for(var i=0;i<j.length;i+=1){var x=j[i];if(x.ACTION===e){o=x.VISIBLE;}}return o;},getPortraitStyle:function(){return"sapInoIdeaListCardItems";},getList:function(){return this.byId("objectlist");},getExportControl:function(){return this.getList();},removeInvalidFilters:function(o){var i=false;var e=o.variant?o.variant:this.getViewProperty("/List/VARIANT");if(e){var j=this.getVariant(e);i=j?j.MANAGE:false;}if(!i){delete o.due;delete o.authors;delete o.coaches;jQuery.each(this.getViewProperty("/List/EXTENSION")||{},function(x,f1){delete o[f1.toLowerCase()];});this.restDue();this.setViewProperty("/List/AUTHORS",[]);this.setViewProperty("/List/COACHES",[]);this.setViewProperty("/List/EXTENSION",{});}if(this.getViewProperty("/List/HIDE_STATUS")){delete o.status;this.setViewProperty("/List/STATUS",undefined);}},getBindingParameter:function(){var e,i;e=this.getViewProperty("/List/VARIANT");i=this.getCurrentVariant().FILTER;var j=this.getViewProperty("/List/SEARCH");var o=this.getViewProperty("/List/TAGS");var x=this.getViewProperty("/List/CAMPAIGN");var f1=jQuery.map(o,function(i1){return i1.ID;});var g1=this.getViewProperty("/List/RESP_VALUE_CODE").map(function(i1){return i1.code;});var h1=[{key:"ideaFilterContinuingChange",value:(this._check4ManagingList()&&this.getViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS"))?'true':'false'},{key:"status",value:this.getViewProperty("/List/STATUS")},{key:"sub_status",value:this.getViewProperty("/List/SUB_STATUS")},{key:"resp_value_code",value:g1.join(",")},{key:"vote_number",value:this.getViewProperty("/List/VOTE_NUMBER")},{key:"vote_operator",value:this.getViewProperty("/List/VOTE_OPERATOR")},{key:"phase",value:this.getViewProperty("/List/PHASE")},{key:"authors",value:this.getViewProperty("/List/AUTHORS")},{key:"coaches",value:this.getViewProperty("/List/COACHES")},{key:"latest_update",value:this.getViewProperty("/List/LATEST_UPDATE")}];jQuery.each(this.getViewProperty("/List/EXTENSION"),function(i1,j1){if(j1||j1===0||j1===0.0){h1.push(new F(i1,b.EQ,j1));}});if(this.hasDueFilter()){h1.push(this.getDueFilter());}if(this.hasCampaignFormFilter()){h1.push(this.getCampaignFormFilter());}return{Variant:e,VariantFilter:i,SearchTerm:j,TagIds:f1,CampaignId:x,Filters:h1};},onOpenSubmitter:function(e){var o=e.getSource();var i=o.getBindingContext("data").getProperty("SUBMITTER_ID")||o.getBindingContext("data").getProperty("EMPLOYEE_ID");if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(o.getAggregation("_ideaSubmitter")||o,i);},onOpenCoach:function(e){var o=e.getSource();var i=o.getBindingContext("data").getProperty("COACH_ID");if(!this.oIdentityCardView){this.oIdentityCardView=sap.ui.xmlview({viewName:"sap.ino.vc.iam.IdentityCard"});this.getView().addDependent(this.oIdentityCardView);}this.oIdentityCardView.getController().open(o,i);},bindList:function(){this.saveState();this.resetActionState();var o=this.getBindingParameter();var e="";var i=false;var j=o.SearchTerm||"";var x=this._check4ManagingList();var f1=this.byId('orientationButton');var g1={};var h1=[];var i1=this.getModel("view").getProperty("/List/TAGS");i1.forEach(function(l1,m1){if(!g1[l1.ROOTGROUPID]){g1[l1.ROOTGROUPID]=[];g1[l1.ROOTGROUPID].push(l1.ID);h1.push(l1.ROOTGROUPID);}else{g1[l1.ROOTGROUPID].push(l1.ID);}});if(x){var j1=this.getSearchType();e+="IdeaMediumBackofficeSearchParams";e+="(searchToken='"+j+"',"+"searchType="+j1+","+"tagsToken='"+(g1[h1[0]]?g1[h1[0]].join(","):"")+"',"+"tagsToken1='"+(g1[h1[1]]?g1[h1[1]].join(","):"")+"',"+"tagsToken2='"+(g1[h1[2]]?g1[h1[2]].join(","):"")+"',"+"tagsToken3='"+(g1[h1[3]]?g1[h1[3]].join(","):"")+"',"+"tagsToken4='"+(g1[h1[4]]?g1[h1[4]].join(","):"")+"',"+"filterName='"+(o.VariantFilter||"")+"',"+"filterBackoffice="+(x?"1":"0")+this.getIdeaformFilters()+this.getCompanyViewFilters()+")/Results";}else{var k1=this.getGroupViewParameters(o);e+="IdeaMediumSearchParams";e+="(searchToken='"+j+"',"+"tagsToken='"+(g1[h1[0]]?g1[h1[0]].join(","):"")+"',"+"tagsToken1='"+(g1[h1[1]]?g1[h1[1]].join(","):"")+"',"+"tagsToken2='"+(g1[h1[2]]?g1[h1[2]].join(","):"")+"',"+"tagsToken3='"+(g1[h1[3]]?g1[h1[3]].join(","):"")+"',"+"tagsToken4='"+(g1[h1[4]]?g1[h1[4]].join(","):"")+"',"+"filterName='"+(o.VariantFilter||"")+"',"+"filterBackoffice="+(x?"1":"0")+this.getIdeaformFilters()+","+"cvt='"+k1.groupToken+"',"+"cvr="+k1.groupRole+","+"cvy="+k1.groupType+")/Results";}if(x){f1.setVisible(false);}else{f1.setVisible(true);}if(!o.SearchTerm&&o.TagIds.length===0&&!o.VariantFilter&&!x&&!this.hasCampaignFormFilter()&&!this.hasIdeaformFilters()){e="IdeaMediumCommunity";}this.setPath("data>/"+e);if((!D.system.desktop&&D.orientation.landscape)||(D.system.desktop&&this.getViewProperty("/ORIENTATION")===c.LANDSCAPE)){i=true;}this.getList().setWrapping(!(x||i));B.prototype.bindList.apply(this);},onOrientationChange:function(e){var i=this._check4ManagingList();if(i||e===c.LANDSCAPE||e.landscape){if(this.getPortraitStyle){this.getList().removeStyleClass(this.getPortraitStyle());}if(this.getLandscapeStyle){this.getList().addStyleClass(this.getLandscapeStyle());}}else{if(this.getPortraitStyle){this.getList().addStyleClass(this.getPortraitStyle());}if(this.getLandscapeStyle){this.getList().removeStyleClass(this.getLandscapeStyle());}}this.getList().setWrapping(!(i||e===c.LANDSCAPE||e.landscape));this.setViewProperty("/ORIENTATION",e);this.setViewProperty("/List/EXPORT_ALL",e===c.PORTRAIT&&!i);},_check4ManagingList:function(){var e=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");if(e){var i=this.getViewProperty("/List/VARIANT");var j=this.getListProperty("/Variants/Values");var o=jQuery.grep(j,function(x){return x.ACTION===i;});o=(o&&o.length>0)?o[0]:{};return o.MANAGE||o.CAMPAIGN_MANAGE||false;}return false;},bindTagCloud:function(){var i=this._check4ManagingList();var o=this.getBindingParameter();var e=C.getTagcloudServiceURL(o.CampaignId,o.TagIds,o.SearchTerm,o.VariantFilter,!this.includeDrafts(),i,o.Filters);var j=this;if(this._lastTagServicePath!==e){var x=new J(e);var f1=this.getText("IDEA_LIST_MIT_FILTER_TAG_OTHER");x.attachRequestCompleted(null,function(){var g1=x.getData().RANKED_TAG||[];var h1=x.getData().TAG_GROUP;var i1=j.groupByTagGroup(g1,j.getViewProperty("/List/TAGS"),f1);jQuery.each(i1,function(j1,k1){if(k1.GROUP_NAME==="Other"){h1.push(k1);}});j.setTagCloudProperty(i1,x.getData().WITHOUT_GROUP!=="X");x.setData({"RANKED_TAG":i1,"TAG_GROUP":h1},false);this.setFilterModel(x,"tag");},this);}this._lastTagServicePath=e;},onItemPress:function(e){var i=e.getSource();var o=i.getBindingContext("data");if(o){this.navigateTo("idea-display",{id:o.getProperty("ID")});}},onCardItemPress:function(e){var i=e.getSource();var o=i.getAggregation("content")[0];o.getFocusDomRef().focus();},onIdeaCommentPress:function(o){var i;if(o.getParameter("ideaId")){i=o.getParameter("ideaId");}else{try{if(o.getSource().getProperty("objectId")){i=o.getSource().getProperty("objectId");}}catch(e){i=o.getSource().getBindingContext("data").getProperty("ID");}}if(i){this.navigateTo("idea-display",{id:i,query:{section:"sectionComments"}});}},onCardItemAfterRendering:function(){},includeDrafts:function(){return this.getCurrentVariant().INCLUDE_DRAFT;},updateFilter:function(){var e=this.getViewProperty("/List/STATUS")||[];var i=this.getViewProperty("/List/SUB_STATUS");var j=this.getViewProperty("/List/RESP_VALUE_CODE")||[];var o=this.getViewProperty("/List/VOTE_NUMBER");var x=this.getViewProperty("/List/PHASE");var f1=this.getViewProperty("/List/LATEST_UPDATE");var g1=this.getViewProperty("/List/CAMPAIGN");var h1=this.getViewProperty("/List/AUTHORS");var i1=this.getViewProperty("/List/COACHES");var j1=this.getViewProperty("/List/EXTENSION");var k1=this._check4ManagingList();var l1=this.getViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS");var m1=[];var n1=this;this.setFilter([]);if(l1&&k1){var o1=[];o1.push(new F("STATUS_TYPE",b.EQ,""));o1.push(new F("STATUS",b.NE,"sap.ino.config.COMPLETED"));o1.push(new F("STATUS",b.NE,"sap.ino.config.DISCONTINUED"));o1.push(new F("STATUS",b.NE,"sap.ino.config.MERGED"));m1.push(new F({filters:[new F({filters:[new F("STATUS_TYPE",b.NE,"COMPLETED"),new F("STATUS_TYPE",b.NE,"DISCONTINUED"),new F("BASE_PACKAGE",b.NE,"sap.ino.config")],and:true}),new F({filters:o1,and:true})],and:false}));}else if(l1===false){m1=[];}if(i&&i.length>0){var p1=[];jQuery.each(i,function(y1,z1){p1.push(new F("STATUS",b.EQ,z1));});m1.push(new F({filters:p1,and:false}));}else if(e.length>0){var q1=e.reduce(function(y1,z1){switch(z1){case U.COMPLETED:y1.push(new F({filters:[new F("STATUS_TYPE",b.EQ,"COMPLETED"),new F({filters:[new F("STATUS_TYPE",b.EQ,""),new F("STATUS",b.EQ,"sap.ino.config.COMPLETED")],and:true})],and:false}));break;case U.NODISCONTINUED:y1.push(new F({filters:[new F("STATUS",b.NE,"sap.ino.config.DISCONTINUED"),new F("STATUS",b.NE,"sap.ino.config.MERGED")],and:true}));n1.setViewProperty("/List/IS_DISCONTINUED_CHECKBOX_SELECTED",true);break;case U.DISCONTINUED:y1.push(new F({filters:[new F("STATUS_TYPE",b.EQ,"DISCONTINUED"),new F({filters:[new F("STATUS_TYPE",b.EQ,""),new F("STATUS",b.EQ,"sap.ino.config.DISCONTINUED")],and:true}),new F({filters:[new F("STATUS_TYPE",b.EQ,""),new F("STATUS",b.EQ,"sap.ino.config.MERGED")],and:true})],and:false}));break;case U.ACTIVE:var o1=[];o1.push(new F("STATUS_TYPE",b.EQ,""));o1.push(new F("STATUS",b.NE,"sap.ino.config.COMPLETED"));o1.push(new F("STATUS",b.NE,"sap.ino.config.DISCONTINUED"));o1.push(new F("STATUS",b.NE,"sap.ino.config.MERGED"));o1.push(new F("STATUS",b.NE,"sap.ino.config.NEW_IN_PHASE"));if(!k1&&!n1.getCurrentVariant().INCLUDE_DRAFT){o1.push(new F("STATUS",b.NE,"sap.ino.config.DRAFT"));}y1.push(new F({filters:[new F({filters:[new F("STATUS_TYPE",b.NE,"COMPLETED"),new F("STATUS_TYPE",b.NE,"DISCONTINUED"),new F("STATUS_TYPE",b.NE,"NEW"),new F("BASE_PACKAGE",b.NE,"sap.ino.config")],and:true}),new F({filters:o1,and:true})],and:false}));break;case U.NEW:y1.push(new F({filters:[new F("STATUS_TYPE",b.EQ,"NEW"),new F({filters:[new F("STATUS_TYPE",b.EQ,""),new F("STATUS",b.EQ,"sap.ino.config.NEW_IN_PHASE")],and:true})],and:false}));break;default:break;}return y1;},[]);m1.push(new F({filters:q1,and:false}));}if(x&&x.length>0){var r1=[];jQuery.each(x,function(y1,z1){r1.push(new F("PHASE",b.EQ,z1));});m1.push(new F({filters:r1,and:false}));}if(g1&&g1!=="0"){m1.push(new F("CAMPAIGN_ID",b.EQ,g1));}if(j&&j.length>0){var s1=[];j.forEach(function(y1){s1.push(new F("RESP_VALUE_CODE",b.EQ,y1.code));});m1.push(new F({filters:s1,and:false}));}if(o){var t1;var u1=this.getViewProperty("/List/VOTE_OPERATOR");switch(u1){case Z.EQ:t1=b.EQ;break;case Z.GE:t1=b.GE;break;case Z.LE:t1=b.LE;break;default:t1=b.EQ;}m1.push(new F("VOTE_COUNT",t1,o));}if(this.hasDueFilter()){m1.push(this.getDueFilter());}if(this.hasCampaignFormFilter()){m1.push(this.getCampaignFormFilter());}if(h1&&h1.length>0){var v1=[];jQuery.each(h1,function(y1,z1){v1.push(new F("SUBMITTER_ID",b.EQ,z1));});m1.push(new F({filters:v1,and:false}));}if(i1&&i1.length>0){var w1=[];jQuery.each(i1,function(y1,z1){w1.push(new F("COACH_ID",b.EQ,z1));});m1.push(new F({filters:w1,and:false}));}if(f1&&f1.length>0){var x1=[];jQuery.each(f1,function(y1,z1){x1.push(new F(z1,b.EQ,1));});m1.push(new F({filters:x1,and:false}));}if(k1||!this.includeDrafts()){m1.push(new F("STATUS",b.NE,"sap.ino.config.DRAFT"));}jQuery.each(j1,function(y1,z1){if(z1||z1===0||z1===0.0){m1.push(new F(y1,b.EQ,z1));}});if(m1.length>0){this.addFilter(new F({filters:m1,and:true}));}},onFilterStatusChange:function(e){var i=e.getParameter("selectedItems");if(i.length>0){this.oViewModel.setProperty("/List/SUB_STATUS",[]);this.oViewModel.setProperty("/subStatus",[]);}else{this.bindFilters();}},onFilterSubStatusChange:function(e){var o=e.getSource();if(o.getSelectedItem){o=o.getSelectedItem();}this.setViewProperty("/List/SUB_STATUS",o.getProperty("key"));},handlePhaseSelectionFinish:function(e){var o=e.getSource();if(o.getSelectedItem){o=o.getSelectedItem();}this.setViewProperty("/List/PHASE",o.getSelectedKeys());},handleSubstatusSelectionFinish:function(e){var o=e.getSource();o._oTokenizer.onAfterRendering=function(){o._oTokenizer.setEditable(false);};if(o.getSelectedItem){o=o.getSelectedItem();}this.setViewProperty("/List/SUB_STATUS",o.getSelectedKeys());},handleLatestUpdateSelectionFinish:function(e){var o=e.getSource();if(o.getSelectedItem){o=o.getSelectedItem();}this.setViewProperty("/List/LATEST_UPDATE",o.getSelectedKeys());},onFilterVoteOperatorChange:function(e){var o=e.getSource();if(!o.getSelectedItem()){return;}var i=this.getFilterElementById("voteNumber");if(i.getValue()===undefined||i.getValue().trim()===""){return;}this.setViewProperty("/List/VOTE_OPERATOR",o.getSelectedItem().getProperty("key"));},onFilterVoteNumChange:function(e){var o=this.getFilterElementById("voteOperatorSelect");if(!o.getSelectedItem()){return;}var i=e.getSource();if(i.getValue()===undefined||i.getValue().trim()===""){this.setViewProperty("/List/VOTE_NUMBER","");}else{this.setViewProperty("/List/VOTE_NUMBER",i.getValue().trim());}},onHandleRespFilterRequest:function(){this.getRespFilterHelpDialog().open();this.oViewModel.setProperty("/oldResp",jQuery.extend(true,[],this.oViewModel.getData().resp));},getRespFilterHelpDialog:function(){if(!this._respHelpDialog){this._respHelpDialog=this.createFragment("sap.ino.vc.idea.fragments.RespValueHelpDialog",this.getView().getId());this.getView().addDependent(this._respHelpDialog);}return this._respHelpDialog;},onHandleRespTokenUpdate:function(e){var i=e.getParameter("removedTokens");var o=function(j,h1){return j.reduce(function(i1,j1){return i1.filter(function(k1){return k1.code!==j1.getKey();});},h1);};var x=function(j,h1){var i1=function(j1,k1){if(j1.children&&j1.children.length>0){j1.children.forEach(function(l1){i1(l1,k1);});}if(j1.CODE===k1&&j1.checked){j1.checked="Unchecked";return true;}else{return false;}};return j.reduce(function(j1,k1){j1.some(function(l1){return i1(l1,k1.getKey());});return j1;},h1);};var f1=this;var g1=function(h1){for(var j=0;j<h1.length;j++){var i1,j1;if(h1[j].children&&h1[j].children.length>0){j1=true;i1=true;j1=f1.checkChildUntickAll(h1[j].children,j1);i1=f1.checkChildTickAll(h1[j].children,i1);}if(j1===false&&i1===false){h1[j].checked="Mixed";}else if(j1){h1[j].checked="Unchecked";}else if(i1){h1[j].checked="Checked";}}return h1;};if(i&&i.length>0){this.oViewModel.getData().List.RESP_VALUE_CODE=o(i,this.oViewModel.getProperty("/List/RESP_VALUE_CODE"));this.oViewModel.getData().resp=x(i,this.oViewModel.getData().resp);this.oViewModel.getData().resp=g1(this.oViewModel.getData().resp);this.oViewModel.setProperty("/resp",this.oViewModel.getData().resp);}},onHandleRespHelpOK:function(){var e=[];this.oViewModel.getData().resp.forEach(function(o){this.getSelectedResp(e,o);}.bind(this));this.oViewModel.setProperty('/List/RESP_VALUE_CODE',e);this._respHelpDialog.close();},getSelectedResp:function(e,i){if(i.children&&i.children.length>0){i.children.forEach(function(o){this.getSelectedResp(e,o);}.bind(this));}if(i.checked==="Checked"&&i.PARENT_CODE){e.push({code:i.CODE,text:i.DEFAULT_TEXT});}},onHandleRespHelpCancel:function(){this.oViewModel.setProperty("/resp",jQuery.extend(true,[],this.oViewModel.getData().oldResp));this._respHelpDialog.close();},onHandleRespSelectionChange:function(e){var i=e.getSource().getParent().getBindingContext("view");var j=i.getPath();this.validateChild(this.oViewModel,j);var o=j.substring(0,j.indexOf('children'));this.validateRootRespList(this.oViewModel,o);},setChildState:function(o,e){var i=this;this.getChildren(o).forEach(function(x){x.checked=e;i.setChildState(x,e);});},validateChild:function(e,i){var j=e.getProperty(i);if(j.checked==="Checked"&&j.PARENT_CODE){this.setChildState(j,j.checked);}else if(!j.PARENT_CODE){this.setChildState(j,j.checked);}},getChildren:function(o){if(o.children){return o.children;}else{return[];}},checkChildUntickAll:function(e,j){for(var i=0;i<e.length;i++){if(e[i].checked&&e[i].checked!=='Unchecked'){j=false;break;}else{if(e[i].children&&e[i].children.length>0){j=this.checkChildUntickAll(e[i].children,j);}}}return j;},checkChildTickAll:function(e,j){for(var i=0;i<e.length;i++){if(e[i].checked&&e[i].checked==='Unchecked'){j=false;break;}else{if(e[i].children&&e[i].children.length>0){j=this.checkChildTickAll(e[i].children,j);}}}return j;},validateRootRespList:function(e,i){if(i===''){return;}var o=e.getProperty(i);var j,x;if(o.children&&o.children.length>0){j=true;x=true;j=this.checkChildUntickAll(o.children,j);x=this.checkChildTickAll(o.children,x);}if(j===false&&x===false){o.checked="Mixed";}else if(j){o.checked="Unchecked";}else if(x){o.checked="Checked";}e.setProperty(i,o);},validateParent:function(e,i){if(i==='/children'||i===''){return;}var o=e.getProperty(i);var j=this.getChildren(o);var f1=j.filter(function(x){return x.checked==='Checked';}).length;if(f1===j.length){o.checked='Checked';}else{var g1=j.filter(function(x){return x.checked==='Unchecked';}).length;g1+=j.filter(function(x){return x.checked===void 0;}).length;if(!o.PARENT_CODE){if(g1===j.length){o.checked='Unchecked';}else{o.checked='Mixed';}}}e.setProperty(i,o);i=i.substring(0,i.lastIndexOf('/'));if(i!=='/children'){this.validateParent(e,i);}},onFilterPhaseChange:function(e){var o=e.getSource().getSelectedItem();if(o.getSelectedItem){o=o.getSelectedItem();}this.setViewProperty("/List/PHASE",o.getProperty("key"));},onFilterCampaignChange:function(e){this.setCampaignForm(undefined);this.clearIdeaFormFieldsCriterias();var o=e.getParameter("selectedItem");if(o){var i=o.getProperty("key");this.setViewProperty("/List/CAMPAIGN",i);this.getIdeaFormFieldsCriterias();}},onFilterDueFromChange:function(e){this.clearDueValueState();this.setDueFrom(e);},onFilterDueToChange:function(e){this.clearDueValueState();this.setDueTo(e);},onFilterAuthorChange:function(o){this._onFilterIdentityChange(o,"/List/AUTHORS");},onFilterCoachChange:function(o){this._onFilterIdentityChange(o,"/List/COACHES");},_onFilterIdentityChange:function(o,e){if(!o){return;}var i=[];var j=o.getTokens();jQuery.each(j,function(x,f1){i.push(f1.getProperty("key"));});this.setViewProperty(e,i);},resetFilter:function(){var e=this.getRoute();this.setViewProperty("/List/STATUS","");this.setViewProperty("/List/SUB_STATUS","");this.setViewProperty("/List/PHASE","");this.restDue();this.setViewProperty("/List/AUTHORS",[]);this.setViewProperty("/List/COACHES",[]);this.setViewProperty("/List/EXTENSION",{});this.setViewProperty("/List/RESP_VALUE_CODE","");this.setViewProperty("/List/RESP_VALUE_NAME","");this.setViewProperty("/List/VOTE_NUMBER","");this.setViewProperty("/List/VOTE_OPERATOR",Z.EQ);this.setFilterItem("/IdeaFormCriterias","");this.setViewProperty("/List/LATEST_UPDATE","");if(e==='idealist'){this.setViewProperty("/List/CAMPAIGN","");this.restCampaignForm();this.restIdeaFormFieldsCriterias();this.getIdeaFormFieldsCriterias();this.resetCompanyCriterias();var o=this.byId("campaignFilterList")||this.getFilterElementById("campaignFilterList");if(o){o.removeAllSuggestionItems();o.setValue("");}var i=this.byId("campaignFormFilterList")||this.getFilterElementById("campaignFormFilterList");if(i){i.removeAllSuggestionItems();i.setValue("");}var j=this.byId("coachFilter")||this.getFilterElementById("coachFilter");if(j){j.removeAllSuggestionItems();j.removeAllTokens();}var x=this.byId("authorFilter")||this.getFilterElementById("authorFilter");if(x){x.removeAllSuggestionItems();x.removeAllTokens();}}B.prototype.resetFilter.apply(this,arguments);},initialCampaignItems:function(){var e=this.getViewProperty("/List/CAMPAIGN");if(!e){return;}var o=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");var i=this.getModel("view");var j=this;var x=this._check4ManagingList()?"managedCampaigns":"";o.read("/CampaignSuggestionParams(searchToken='',filterName='"+x+"')/Results",{urlParameters:{"$orderby":"SHORT_NAME","$filter":"ID eq "+e},success:function(f1){i.setProperty("/campaignSuggestion",f1.results);var g1=j.byId("campaignFilterList")||j.getFilterElementById("campaignFilterList");g1.setFilterSuggests(false);if(g1.getSuggestionItems().length>0){g1.setSelectionItem(g1.getSuggestionItems()[0]);}}});},addPhaseItems:function(){var e=this.getListProperty("/Filter/PhaseBinding/EMPTY_CODE_TEXT");var i=this.getListProperty("/Filter/PhaseBinding/TABLE_PATH");var j="view>/Phases";var o="view"+">"+this.getListProperty("/Filter/PhaseBinding/CODE_PATH");var x=C.getBackendRootURL()+"/sap/ino/xs/rest/common/idea_filter_phase.xsjs";var f1={CAMPAIGN_ID:this.getBindingParameter().CampaignId===undefined?undefined:parseInt(this.getBindingParameter().CampaignId,10)};var g1=this.getModel("view");jQuery.ajax({url:x,headers:{"X-CSRF-Token":"Fetch"},data:f1,type:"GET",contentType:"application/json; charset=UTF-8",async:false,success:function(l1){var m1=l1.Phases;g1.setProperty("/Phases",m1);}});var h1=this;var i1=a.getFormatter(i);var j1=new I({text:{path:o,formatter:function(l1){return(!l1)?h1.getText(e):i1(l1);}},key:{path:o}});var k1=this.getFilterElementById("phaseSelect");if(k1){k1.bindItems({path:j,template:j1,parameters:{includeEmptyCode:true}});}},addRespListItems:function(){var o=this.getModel("view");var e=C.getBackendRootURL()+"/sap/ino/xs/rest/common/idea_filter_resp_values.xsjs";var i={CAMPAIGN_ID:this.getBindingParameter().CampaignId===undefined?undefined:parseInt(this.getBindingParameter().CampaignId,10)};jQuery.ajax({url:e,headers:{"X-CSRF-Token":"Fetch"},data:i,type:"GET",contentType:"application/json; charset=UTF-8",async:false,success:function(j){var x=j.RespValues;if(x&&x.length>0){x.sort(function(g1,h1){return g1.DEFAULT_TEXT.localeCompare(h1.DEFAULT_TEXT);});}var f1=[{CODE:"",DEFAULT_LONG_TEXT:"",DEFAULT_TEXT:""}].concat(x);o.setProperty("/resp",f1);}});},addSubStatusFilterItems:function(){var o=this.getModel("view");if(o.getProperty("/subStatus")){o.setProperty("/subStatus",[]);}var e=[];var i=this._check4ManagingList();var j=this.getViewProperty("/List/STATUS");switch(j){case U.COMPLETED:e.push(new F({filters:[new F("STATUS_TYPE",b.EQ,"COMPLETED"),new F({filters:[new F("STATUS",b.EQ,'sap.ino.config.COMPLETED')],and:true})],and:false}));break;case U.DISCONTINUED:e.push(new F({filters:[new F("STATUS_TYPE",b.EQ,"DISCONTINUED"),new F({filters:[new F("STATUS",b.EQ,"sap.ino.config.DISCONTINUED")],and:true}),new F({filters:[new F("STATUS",b.EQ,"sap.ino.config.MERGED")],and:true})],and:false}));break;case U.ACTIVE:var x=[];x.push(new F("STATUS",b.NE,"sap.ino.config.COMPLETED"));x.push(new F("STATUS",b.NE,"sap.ino.config.DISCONTINUED"));x.push(new F("STATUS",b.NE,"sap.ino.config.MERGED"));if(!i&&!this.getCurrentVariant().INCLUDE_DRAFT){x.push(new F("STATUS",b.NE,"sap.ino.config.DRAFT"));}e.push(new F({filters:[new F({filters:[new F("STATUS_TYPE",b.NE,"COMPLETED"),new F("STATUS_TYPE",b.NE,"DISCONTINUED"),new F("BASE_PACKAGE",b.NE,"sap.ino.config")],and:true}),new F({filters:x,and:true})],and:false}));break;case U.NEW:e.push(new F({filters:[new F("STATUS_TYPE",b.EQ,"NEW"),new F({filters:[new F("STATUS",b.EQ,"sap.ino.config.NEW_IN_PHASE")],and:true})],and:false}));break;default:e=[];}var f1=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");var g1={success:function(h1){h1=[{STATUS:"",TEXT:"",STATUS_TYPE:"",BASE_PACKAGE:""}].concat(h1.results);o.setProperty("/subStatus",h1);}};if(e.length>0){g1.filters=e;}if(this.getViewProperty('/List/CAMPAIGN')){f1.read("/AuthIdeasStatusParams(campaignId="+this.getViewProperty('/List/CAMPAIGN')+")/Results",g1);}else{f1.read("/AuthIdeasStatusParams(campaignId=0)/Results",g1);}},getQuery:function(o){var e={};var i=o&&o.bSorterChange;var j=o&&o.bFilterChange;if(i){var x=this.getViewProperty("/List/SORT");var f1=this.getViewProperty('/List/QUICKSORT');}if(j){var g1=this.getViewProperty("/List/STATUS");var h1=this.getViewProperty("/List/SUB_STATUS");var i1=this.getViewProperty("/List/VOTE_NUMBER");var j1=this.getViewProperty("/List/VOTE_OPERATOR");var k1=this.getViewProperty("/List/RESP_VALUE_CODE");var l1=this.getViewProperty("/List/PHASE");var m1=this.getViewProperty("/List/CAMPAIGN");var n1=this.getViewProperty("/List/AUTHORS");var o1=this.getViewProperty("/List/COACHES");var p1=this.getViewProperty("/List/EXTENSION");var q1=this.getViewProperty("/List/LATEST_UPDATE");var r1=this.hasDueFromFilter();var s1=this.hasDueToFilter();var t1=this.hasCampaignFormFilter();}if(x){e.sort=x;}if(f1){e.quickSort=f1;}if(g1&&g1.length>0){e.status=g1;}if(h1&&h1.length>0){e.subStatus=h1;}if(k1&&k1.length>0){e.respCode=k1.map(function(z1){return{code:encodeURIComponent(z1.code),text:encodeURIComponent(z1.text)};});e.respCode=JSON.stringify(e.respCode);}if(l1&&l1.length>0){e.phase=l1;}if(i1){e.voteNum=i1;if(j1){e.voteOperator=j1;}}if(m1){e.campaign=m1;}if(r1){e.dueFrom=this.getFilterItem("/DueFrom");}if(s1){e.dueTo=this.getFilterItem("/DueTo");}if(n1&&n1.length>0){e.authors=n1;}if(o1&&o1.length>0){e.coaches=o1;}if(t1){e.ideaformid=this.getCampaignFormQuery();}if(q1&&q1.length>0){e.latestUpdate=q1;}this.setIdeaformCriteriaToQuery(e);this.setCompanyCriteriaToQuery(e);jQuery.each(p1,function(z1,A1){if(A1||A1===0||A1===0.0){e[z1.toLowerCase()]=A1;}});if(this._oQuery){jQuery.each(this._oQuery,function(z1,A1){if((j&&!i&&(z1==='sort'||z1==='quickSort'))||(i&&!j&&(z1!=='sort'&&z1!=='quickSort'))||(!i&&!j)){e[z1]=A1;}});}var u1=this.getViewProperty("/List/SEARCH");if(u1){e.search=u1;}var v1=this.getViewProperty("/List/TAGS");if(v1&&v1.length>0){e.tags=JSON.stringify(v1);}var w1=this._check4ManagingList();var x1=this.getViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS");if(w1){e.sIdeaFilterChange=x1;}if(!w1){var y1=this.getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW");e.bIdeaGroupView=y1;}this._oQuery=jQuery.extend(true,{},e);return e;},getSort:function(e){var i=this.getViewProperty("/List/VARIANT");var o=this.getVariant(i);var j=[{TEXT:"SORT_MIT_FOLLOW_UP_DATE",ACTION:$.FOLLOW_UP_DATE,DEFAULT_ORDER:X.ASC},{TEXT:"SORT_MIT_LAST_PUBL_EVAL_AT",ACTION:$.LAST_PUBL_EVAL_AT,DEFAULT_ORDER:X.DESC},{TEXT:"SORT_MIT_EVAL_COUNT",ACTION:$.EVALUATION_COUNT,DEFAULT_ORDER:X.DESC},{TEXT:"SORT_MIT_EXPERT_SCORE",ACTION:$.EXP_SCORE,DEFAULT_ORDER:X.DESC},{TEXT:"SORT_MIT_SEARCH_SCORE",ACTION:$.SEARCH_SCORE,DEFAULT_ORDER:X.DESC}];var x=this._extensibilityExtensionFieldSorter()||[];if(o&&o.MANAGE&&C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")){this.addSorterConfig(j,true);if(x.length>0){this.addSorterConfig(x,true);}}else{this.removeSorterConfig(j);if(x.length>0){this.removeSorterConfig(x);}}var f1=this;var g1=this.getListProperty("/Sorter/Values");g1.sort(function(h1,i1){var j1=f1.getText(h1.TEXT);var k1=f1.getText(i1.TEXT);if(j1>k1){return 1;}else if(j1<k1){return-1;}else{return 0;}});return B.prototype.getSort.call(this,e);},setParameters:function(o,e){o=o||{};var i=e.ACTION;var j=this.checkSort(o,e.DEFAULT_SORT);var x=this.checkStatus(o.status,[]);var f1=this.checkPhase(o.phase,[]);var g1=this.checkPhase(o.latestUpdate,[]);var h1=this.checkTags(o.tags);var i1=o.campaign;var j1=this.checkRespList(o.respCode);var k1=o.respName;var l1=this.checkIdentities(o.subStatus,[]);var m1=o.voteOperator;var n1=o.voteNum;var o1=o.dueFrom;var p1=o.dueTo;var q1=this.checkIdentities(o.authors,[]);var r1=this.checkIdentities(o.coaches,[]);var s1=o.quickSort;if(o.sIdeaFilterChange==="false"){this.setViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS",false);}else if(o.sIdeaFilterChange==="true"){this.setViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS",true);}if(o.bIdeaGroupView==="false"){this.setViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW",false);}else if(o.bIdeaGroupView==="true"){this.setViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW",true);}this.setViewProperty("/List/VARIANT",e.ACTION);this.setViewProperty("/List/SORT",j);this.setViewProperty("/List/STATUS",x);this.setViewProperty("/List/SUB_STATUS",l1);this.setViewProperty("/List/RESP_VALUE_CODE",(function(){return j1.map(function(u1){return{code:decodeURIComponent(u1.code),text:decodeURIComponent(u1.text)};});}()));this.setViewProperty("/List/RESP_VALUE_NAME",k1);this.setViewProperty("/List/VOTE_NUMBER",n1);this.setViewProperty("/List/VOTE_OPERATOR",m1);this.setViewProperty("/List/PHASE",f1);this.setViewProperty("/List/LATEST_UPDATE",g1);this.setViewProperty("/List/TAGS",h1);this.setViewProperty("/List/IS_TAGS_SELECTION",h1.length>0);this.setViewProperty("/List/SEARCH",o.search);this.setViewProperty("/List/MANAGE",e.MANAGE||e.CAMPAIGN_MANAGE);this.setViewProperty("/List/CAMPAIGN",i1);this.setCampaignForm(o.ideaformid);this.getIdeaFormFieldsCriterias();this.setDueFromValue(o1);this.setDueToValue(p1);this.setViewProperty("/List/AUTHORS",q1);this.setViewProperty("/List/COACHES",r1);this.setViewProperty("/List/QUICKSORT",s1);var t1=this;this.setViewProperty("/List/EXTENSION",{});jQuery.each(o,function(u1,v1){if(u1.indexOf("_")===0){t1.setViewProperty("/List/EXTENSION/"+u1.toUpperCase(),v1);}});this.initIdeaFormItems(o);this.initCompanyViewItems(o);this.setViewProperty("/List/TAGCLOUD",true);this.setViewProperty("/List/HIDE_STATUS",false);this.setViewProperty("/List/SELECT_ALL",false);this.removeSubFilterPageContent();if([_.MANAGE,_.FOLLOW_UP,_.UNASSIGNED,_.COACH_ME,_.EVAL_DONE].indexOf(i)>=0){this.setViewProperty("/List/MANAGE",true);this.addSubFilterPageContent(this.getAdditionalFilter());this.setMultiInputContent(this.getFilterElementById("authorFilter"),q1,true);this.setMultiInputContent(this.getFilterElementById("coachFilter"),r1,true);}else if(_.COMPLETED===i){this.setViewProperty("/List/MANAGE",false);this.setViewProperty("/List/HIDE_STATUS",true);this.setViewProperty("/List/STATUS",undefined);this.addSubFilterPageContent(this.getAdditionalFilter());}else{this.addSubFilterPageContent(this.getAdditionalFilter());this.setViewProperty("/List/MANAGE",false);}this.setViewProperty("/List/EXPORT_ALL",this.getViewProperty("/ORIENTAION")===c.PORTRAIT&&!this.getViewProperty("/List/MANAGE"));},getItemTemplate:function(){var e;if(this._check4ManagingList()){e="Managed";}else if((!D.system.desktop&&D.orientation.landscape)||(D.system.desktop&&this.getViewProperty("/ORIENTATION")===c.LANDSCAPE)){e="Landscape";}else{e="Portrait";}var o;var i=C.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE")*1||C.getSystemSetting("sap.ino.config.DISABLE_IDEA_IMAGE_HIDE_PHASE_BAR")*1;switch(e){case"Managed":o=i?this.getFragment("sap.ino.vc.idea.fragments.ManageListItemNoImage"):this.getFragment("sap.ino.vc.idea.fragments.ManageListItem");break;case"Landscape":o=i?this.getFragment("sap.ino.vc.idea.fragments.FlatListItemNoImage"):this.getFragment("sap.ino.vc.idea.fragments.FlatListItem");break;case"Portrait":o=i?this.getFragment("sap.ino.vc.idea.fragments.CardListItemNoImage"):this.getFragment("sap.ino.vc.idea.fragments.CardListItem");break;default:break;}return o;},createFilterController:function(){return sap.ui.controller("sap.ino.vc.idea.Filter");},createFilterView:function(){return this.createView({type:V.XML,viewName:"sap.ino.vc.idea.Filter",controller:this._oFilterController});},createFilterDialog:function(){return sap.ui.xmlfragment("sap.ino.vc.idea.fragments.FilterDialog",this);},createState:function(e,i,o,j){var x=B.prototype.createState.apply(this,arguments);x.query.status=o.status;x.query.subStatus=o.subStatus;x.query.respCode=o.respCode;x.query.respName=o.respName;x.query.phase=o.phase;x.query.campaign=o.campaign;x.query.due=o.due;x.query.authors=o.authors;x.query.coaches=o.coaches;x.query.voteNum=o.voteNum;x.query.voteOperator=o.voteOperator;x.query.sIdeaFilterChange=this.getViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS");return x;},onOpenIdea:function(o){var i;if(o.getParameter("ideaId")){i=o.getParameter("ideaId");}else{try{if(o.getSource().getProperty("objectId")){i=o.getSource().getProperty("objectId");}}catch(e){i=o.getSource().getBindingContext("data").getProperty("ID");}}if(i){this.navigateTo("idea-display",{id:i});}},onOpenCampaign:function(e){this.navigateTo("campaign",{id:e.getParameter("campaignId")});},setMultiInputContent:function(e,i,j){if(!e){return;}if(j){this._aIgnoreTokenChanges=this._aIgnoreTokenChanges?this._aIgnoreTokenChanges:[];this._aIgnoreTokenChanges.push(e);}if(!i||i.length===0){e.removeAllTokens();}else{var x=new T({text:"{data>NAME}",key:"{data>ID}"});var f1=[];jQuery.each(i,function(o,i1){f1.push(new F({path:'ID',operator:'EQ',value1:i1}));});var g1=[];g1.push(new F({filters:f1,and:false}));var h1=e;e.bindAggregation("tokens",{path:"data>/Identity",filters:g1,template:x,events:{dataRequested:function(){h1.setBusy(true);},dataReceived:function(){h1.setBusy(false);}}});}if(j){this._aIgnoreTokenChanges=this._aIgnoreTokenChanges.filter(function(o){return o.id!==e.id;});}},addMultiInputHandling:function(e,i){if(!e){return;}var j=this;var x=this._createSuggestHandler(i.suggestion);e.attachSuggest(x,this);e.attachTokenUpdate(function(f1){if(!j._aIgnoreTokenChanges||j._aIgnoreTokenChanges.filter(function(o){return o.id===f1.oSource.id;}).length===0){if(f1.getParameter("type")==="removed"){if(f1.getParameter('removedTokens').length>0){f1.getSource().removeToken(f1.getParameter('removedTokens')[0]);}i.tokenChangeCallback.apply(j,[f1.getSource()]);}else if(f1.getParameter("type")==="added"){i.tokenChangeCallback.apply(j,[f1.getSource()]);}}});if(i.identity){this.setMultiInputContent(e,i.identity);}},onSetFilterBarVisible:function(e,i){this.bindTagCloud();var o=this.getFilterElementById(e);if(o&&!o.mEventRegistry.hasOwnProperty("tokenUpdate")){this.addMultiInputHandling(o,{suggestion:{key:"ID",text:"NAME",additionalText:"USER_NAME",path:"data>/SearchIdentity(searchToken='$suggestValue')/Results",filters:[new F({path:"TYPE_CODE",operator:b.EQ,value1:"USER"})],sorter:new S("NAME")},identity:this.getViewProperty("/List/AUTHORS"),tokenChangeCallback:this.onFilterAuthorChange,token:{key:"IDENTITY_ID",text:"NAME"}});}var j=this.getFilterElementById(i);if(j&&!j.mEventRegistry.hasOwnProperty("tokenUpdate")){this.addMultiInputHandling(j,{suggestion:{key:"ID",text:"NAME",additionalText:"USER_NAME",path:"data>/SearchIdentity(searchToken='$suggestValue')/Results",filters:[new F({path:"TYPE_CODE",operator:b.EQ,value1:"USER"})],sorter:new S("NAME")},identity:this.getViewProperty("/List/COACHES"),tokenChangeCallback:this.onFilterCoachChange,token:{key:"IDENTITY_ID",text:"NAME"}});}},bindFilters:function(e){this.initialCampaignItems();this.initCampaignFormItems();var i=C.getBackendRootURL()+"/sap/ino/xs/rest/common/idea_filter.xsjs";var o={CAMPAIGN_ID:this.getBindingParameter().CampaignId?parseInt(this.getBindingParameter().CampaignId,10):undefined,STATUS:this.getViewProperty("/List/STATUS"),IS_MANAGED:this._check4ManagingList(),INCLUDE_DRAFT:this.getCurrentVariant().INCLUDE_DRAFT};var j=this.getModel("view");var x=this;jQuery.ajax({url:i,headers:{"X-CSRF-Token":"Fetch"},data:o,type:"GET",contentType:"application/json; charset=UTF-8",async:true,success:function(f1){j.setProperty("/Phases",f1.Phases);var g1=f1.RespValues;if(g1&&g1.length>0){g1.sort(function(h1,i1){return h1.DEFAULT_TEXT.localeCompare(i1.DEFAULT_TEXT);});}j.setProperty("/resp",x._filterRespValues(g1));j.setSizeLimit(1000);j.setProperty("/subStatus",f1.Substatus);x._bindPhase("phaseSelect");if(e&&typeof e==="function"){e();}}});},_bindPhase:function(e){var i=this;var j=i.getListProperty("/Filter/PhaseBinding/EMPTY_CODE_TEXT");var o=i.getListProperty("/Filter/PhaseBinding/TABLE_PATH");var x="view>/Phases";var f1="view"+">"+i.getListProperty("/Filter/PhaseBinding/CODE_PATH");var g1=a.getFormatter(o);var h1=new I({text:{path:f1,formatter:function(j1){return(!j1)?i.getText(j):g1(j1);}},key:{path:f1}});var i1=i.getFilterElementById(e);if(i1){i1.bindItems({path:x,template:h1,parameters:{includeEmptyCode:true}});}},_filterRespValues:function(e){var i=this,j=i.getQuery(),o;if(!j||!e||e.length===0){return e;}try{o=JSON.parse(i.getQuery().respCode);}catch(x){return e;}if(!o||o.length===0){return e;}o.forEach(function(f1){i._filterRespChildrenValues(f1,e);});return e;},_filterRespChildrenValues:function(o,e){var i=this;e.forEach(function(j){if(o.code===j.CODE){j.checked="Checked";}if(j.children&&j.children.length>0){i._filterRespChildrenValues(o,j.children);}});},getAdditionalFilter:function(){var o;o=this.createFragment("sap.ino.vc.idea.fragments.FilterItems",this.createIdForFilterElement());var e=this.getFilterElementById("filterItems");this._extensibilityExtensionFilterItems(e);return o;},onApplyFilterToQuery:function(){if(this.isCanApply()){this.navigateIntern(this.getQuery({bFilterChange:true}),true,true);}},reloadData:function(){this.bindList();this.bindTagCloud();},checkDate:function(e,i){var j=new Date(e);return isNaN(j.getTime())?i:j;},checkStatus:function(e,i){if(e&&e.length>0){return e.split(",");}else{return i;}},checkPhase:function(e,i){var j=this.getListProperty("/Filter/PhaseBinding/TABLE_PATH");var o=e;var x=a.getCodes(j);if(e){var f1=jQuery.grep(x,function(g1){var h1=o.split(",");var i1=g1;return jQuery.grep(h1,function(j1){return j1===i1.CODE;});});if(f1&&f1.length>0){return e.split(",");}}return i;},checkIdentities:function(i,o){if(!i){return o;}else{return i.split(",");}},onApplyFilter:function(){var o=this.getFilterDialog();if(JSON.stringify(this.getViewModelBackup())===JSON.stringify(this.getViewProperty("/"))&&JSON.stringify(this.getFilterItemModelBackup())===JSON.stringify(this.getModel("filterItemModel"))){o.close();return;}var e=this.getQuery({bFilterChange:true});var i=this.getViewProperty("/List/VARIANT");var j=this.getRoute();var x={query:e};if(j==="campaign-idealist"||j==="campaign-idealistvariant"){x.id=e.campaign||this.campaignId;}x.variant=i;this.navigateTo(this.getRoute(true),x,true,true);o.close();},getExportPrefix:function(){return this.getText("EXPORT_PREFIX_IDEA");},onMoreFilterChange:function(e){var o=this.getFilterNavContainer();var i=o.getPages();var j=i[0].getContent()[0];if(j.getItems().length>2){var x=function(f1){f1.$().find('*[tabindex="0"]')[f1.getItems().length-1].focus();this.getFilterElementById("filterItems").setBusy(false);}.bind(this,j);this.setViewProperty("/List/IS_SHOW_MORE_FILTER",true);e.getSource().setVisible(false);this.getFilterElementById("filterItems").setBusyIndicatorDelay(0).setBusy(true);setTimeout(function(f1){this.bindFilters(f1);}.bind(this,x),0);}},onFilterReset:function(){this.setViewProperty("/List/TAGS",[]);this.setViewProperty("/List/IS_TAGS_SELECTION",false);this.setViewProperty("/List/SORT","");this.setViewProperty("/List/SELECTQUICKLINKID",undefined);this.getModel("list").setProperty("/CURRENTSELECTLINK",undefined);this.getModel("list").setProperty("/TITLESELECTQUICKLINK",undefined);this.resetFilter();if(!D.system.desktop){return;}this.navigateIntern(this.getQuery({bFilterChange:true,bSorterChange:true}),true);},onCampaignSuggestion:function(e){var o=this.getModel("view");var i=this;var j=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");var x=jQuery.extend({},e,true);var f1=jQuery.sap.encodeURL(x.getParameter("suggestValue"));var g1=this._check4ManagingList()?"managedCampaigns":"";this.resetClientMessages();j.read("/CampaignSuggestionParams(searchToken='"+f1+"',filterName='"+g1+"')/Results",{urlParameters:{"$orderby":"SHORT_NAME"},success:function(h1){o.setProperty("/campaignSuggestion",h1.results);var i1=i.byId("campaignFilterList")||i.getFilterElementById("campaignFilterList");i1.setFilterSuggests(false);}});},onClearCampaignFilter:function(e){var i=e.getParameter("value");if(i.trim()===""){this.setViewProperty("/List/CAMPAIGN","");}this.setCampaignForm(undefined);this.clearIdeaFormFieldsCriterias();},onCampaignDialogSearch:function(e){var i=jQuery.sap.encodeURL(e.getParameter("value"));var o=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");var j=this.getModel("view");var x=this._check4ManagingList()?"managedCampaigns":"";o.read("/CampaignSuggestionParams(searchToken='"+i+"',filterName='"+x+"')/Results",{urlParameters:{"$orderby":"SHORT_NAME"},success:function(f1){j.setProperty("/campaignSuggestion",f1.results);}});},onCampaignDialogItemsSelect:function(e){var i=e.getParameter("selectedItem").data("ID")+"";var o=this.byId("campaignFilterList")||this.getFilterElementById("campaignFilterList");var j=o.getSuggestionItems();j.forEach(function(x){if(x.getProperty("key")===i){o.setSelectionItem(x);}});this.setViewProperty("/List/CAMPAIGN",i);this.clearIdeaFormFieldsCriterias();this.getIdeaFormFieldsCriterias();},onPressOpenIdeaListFilterPersonalization:function(){var e=this;var o=this.getModel("view");if(this._check4ManagingList()){P.getFilterSettingsForDialogForBackoffice().done(function(i){o.setProperty("/List/IDEA_LIST_FILTER_PERSONALIZATION_SETTING",i.RESULT);var j=e.createIdeaListFilterPersonalizeDialog();j.open();});}else{P.getFilterSettingsForDialogForCommunity().done(function(i){o.setProperty("/List/IDEA_LIST_FILTER_PERSONALIZATION_SETTING",i.RESULT);var j=e.createIdeaListFilterPersonalizeDialog();j.open();});}},onUpdateIdeaFilterPersonzalization:function(e){var i=e.getSource();var o=this.getModel("view");var j=o.getProperty("/List/IDEA_LIST_FILTER_PERSONALIZATION_SETTING");var x={};var f1=this;j.forEach(function(g1,h1){x[g1.CODE]={VALUE:Number(g1.VALUE),SEQUENCE:g1.SEQUENCE!==undefined?g1.SEQUENCE+1:9999};});P.updateFilterSettings({'IDEA_LIST_FILTER_PERSONALIZATION':x}).done(function(){o.setProperty("/List/IDEA_LIST_FILTER_PERSONALIZATION",x);i.close();f1.resetFilter();});},onIdeaFilterPersonzalizationCancel:function(e){e.getSource().close();},handleIdeaFilterPersonzalizationSearch:function(e){var i=e.getParameter("value");var o=new F("CODE",sap.ui.model.FilterOperator.Contains,i);var j=e.getSource().getBinding("items");j.filter([o]);},onHandleCampaignFilterHelp:function(){var e=this;var o=this.getModel("view");var i=this.getDefaultODataModel?this.getDefaultODataModel():this.getModel("data");var j=this._check4ManagingList()?"managedCampaigns":"";i.read("/CampaignSuggestionParams(searchToken='',filterName='"+j+"')/Results",{urlParameters:{"$orderby":"SHORT_NAME"},success:function(x){o.setProperty("/campaignSuggestion",x.results);var f1=e.byId("campaignFilterList")||e.getFilterElementById("campaignFilterList");f1.setFilterSuggests(false);var g1=e.createCampaignListDialog();g1.open();}});e.setCampaignForm(undefined);},createIdeaListFilterPersonalizeDialog:function(){if(!this._IdeaListFilterPersonalizeDialog){this._IdeaListFilterPersonalizeDialog=this.createFragment("sap.ino.vc.idea.fragments.IdeaListPersonalizeFilterPop",this.getView().getId());this.getView().addDependent(this._IdeaListFilterPersonalizeDialog);}return this._IdeaListFilterPersonalizeDialog;},createCampaignListDialog:function(){if(!this._campaignDialog){this._campaignDialog=this.createFragment("sap.ino.vc.idea.fragments.CampaignSuggestionSelectList",this.getView().getId());this.getView().addDependent(this._campaignDialog);}return this._campaignDialog;},initApplicationObjectChangeListeners:function(){var e=this;e._bListChanged=false;var i=["create","del","modifyAndSubmit","executeStatusTransition"];var j=function(o){var x=o.getParameter("actionName");if(x&&i.indexOf(x)>-1&&o.getParameter("object").getMetadata().getName()==="sap.ino.commons.models.object.Idea"){e._bListChanged=true;}};s.attachChange(s.Action.Create,j);s.attachChange(s.Action.Del,j);s.attachChange(s.Action.Action,j);},onObjectListUpdateFinished:function(e){var i=e&&e.getParameters();if(i&&i.total>0){this.setViewProperty("/List/SELECT_ALL_ENABLE",true);}else{this.setViewProperty("/List/SELECT_ALL_ENABLE",false);}B.prototype.onObjectListUpdateFinished.apply(this,arguments);this.initIdeaSearchParam();},changeDefaultSortOfVariant:function(o,e){if(e&&e.search&&(o.ACTION==="manage"||o.ACTION==="all")){o.DEFAULT_SORT="SEARCH_SCORE";}else if(o.ACTION==="manage"||o.ACTION==="all"){jQuery.each(this.list.Variants.Values,function(i,j){if(j.ACTION===o.ACTION){o.DEFAULT_SORT=j.DEFAULT_SORT;return false;}});}},activeIdeaFilterSwitchChange:function(){this.setViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS",!this.getViewProperty("/List/IDEA_FILTER_NEW_AND_INPROCESS"));this.navigateIntern(this.getQuery(),true,true);},activeIdeaFilterCommunityGroupView:function(){this.setViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW",!this.getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW"));var e=this.getModel("list").getProperty("/Variants/Values");var j;for(var i=0;i<e.length;i++){var o=e[i];j=o.TEXT;if(o.ACTION===_.VOTED){j=this.getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW")?"IDEA_LIST_MIT_MY_VOTED":"IDEA_LIST_MIT_VOTED";}else if(o.ACTION===_.COMMENTED){j=this.getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW")?"IDEA_LIST_MIT_MY_COMMENTED":"IDEA_LIST_MIT_COMMENTED";}this.getModel("list").setProperty("/Variants/Values/"+i+"/TEXT",j);}var x={query:this.getQuery(),variant:""};if(this.getViewProperty("/List/SEARCH")){x.query.search=this.getViewProperty("/List/SEARCH");}var f1="idealistvariant";if(this.getViewProperty("/List/IS_IDEA_FILTER_COMMUNITY_GROUP_VIEW")){x.variant=_.MY;}else{x.variant=_.ALL;}if(this.getRoute().indexOf("campaign")>-1){x.id=this._iCampaignId;f1="campaign-idealistvariant";}this.navigateTo(f1,x,true,true);},onOfficeToggle:function(){this.bOfficeToggle=true;var e=this.getViewProperty("/NEWQUICKLINKFUNCTION");var i=this.getModel("component").getProperty("/SHOW_BACKOFFICE");i=!i;this.getModel("component").setProperty("/SHOW_BACKOFFICE",i);var o={query:{},variant:""};if(this.getViewProperty("/List/SEARCH")){o.query.search=this.getViewProperty("/List/SEARCH");o.query.sort=this.getViewProperty("/List/SORT");}var j="idealistvariant";if(i){o.variant=_.MANAGE;}else{o.variant=_.ALL;}if(this.getRoute().indexOf("campaign")>-1){o.variant=i?_.MANAGE:_.ALL;o.id=this._iCampaignId;j="campaign-idealistvariant";}this.navigateTo(j,o,true,true);},getCurrentUrlId:function(){this.setViewProperty("/List/SELECTQUICKLINKID",undefined);var e=this.getModel("list").getProperty("/Variants/Values");var i=this.getViewProperty("/CURRENTURL");var j=this.getViewProperty("/List/SELECTQUICKLINKID");var o=this.getViewProperty("/isre");var x=this;var f1=i.split("/");if(f1[0].indexOf("campaign")>-1){f1.splice(0,2);i=f1.join("/");}e.forEach(function(g1){if(g1.LINK_URL&&decodeURIComponent(g1.LINK_URL)===i){x.setViewProperty("/List/SELECTQUICKLINKID",g1.ID);x.getModel("list").setProperty("/TITLESELECTQUICKLINK",g1);j=g1.ID;return;}});if(j){return;}e.forEach(function(g1){if(g1.TYPE_CODE==="QUICK_LINK_STANDARD_IDEA"&&g1.ACTION===o){x.setViewProperty("/List/SELECTQUICKLINKID",g1.ID);x.getModel("list").setProperty("/TITLESELECTQUICKLINK",g1);j=g1.ID;return;}});if(j){return;}else{this.setViewProperty("/List/SELECTQUICKLINKID",undefined);}},getCurrentQuickIdeaList:function(){var e=this.getModel("component").getProperty("/SHOW_BACKOFFICE");var o;if(e){o=this.byId("panelFilterFragment--backOfficeQuickLinkIdeaList");}else{o=this.byId("panelFilterFragment--communityQuickLinkIdeaList");}return o;},navigateToFirstQuickLink:function(e,o){var i=this.campaignId;if(!Array.isArray(e)||!e.length){return;}var j;var x=e[0].getBindingContext("list").getObject();this.setViewProperty("/List/SELECTQUICKLINKID",x.ID);this.getModel("list").setProperty("/CURRENTSELECTLINK",x);this.getModel("list").setProperty("/TITLESELECTQUICKLINK",x);if(x.TYPE_CODE==="QUICK_LINK_CUSTOM_IDEA"){j=i?location.href.split("#")[0]+"#/campaign/"+i+"/"+x.LINK_URL:location.href.split("#")[0]+"#/"+x.LINK_URL;j="search"in o?location.href.split("#")[0]+"#/"+x.LINK_URL+"&search="+o.search:location.href.split("#")[0]+"#/"+x.LINK_URL;this.setViewProperty("/firstQuickLink",j);this.navigateToByURL(j);}else{var f1={variant:x.ACTION};if(i){f1.id=i;j=location.href.split("#")[0]+"#/campaign/"+i+"/ideas-"+f1.variant;}else{j=location.href.split("#")[0]+"#/ideas-"+f1.variant;}j="search"in o?j+"/?search="+o.search:j;this.setViewProperty("/firstQuickLink",j);this.navigateToByURL(j);}},refreshQuickLinkSettings:function(e,i){var j=this.getViewProperty("/isre");var o=jQuery.extend(true,{},this.getVariant(j));if(e.RESULT.length>0&&i){e.RESULT.forEach(function(x){i.forEach(function(o){if(x.TYPE_CODE==="QUICK_LINK_STANDARD_IDEA"&&o.TYPE_CODE==="QUICK_LINK_STANDARD_IDEA"&&x.OBJECT_TYPE_CODE===o.OBJECT_TYPE_CODE){o.ACTIVE=x.ACTIVE===1?true:false;o.SEQUENCE=x.SEQUENCE;o.ID=x.ID;o.ENABLED=x.ENABLED;}else if(x.TYPE_CODE==="QUICK_LINK_CUSTOM_IDEA"){var f1=i.every(function(g1){if(g1.TYPE_CODE==="QUICK_LINK_STANDARD_IDEA"){return true;}if(g1.TYPE_CODE==="QUICK_LINK_CUSTOM_IDEA"){return x.ID!==g1.ID;}});if(f1&&o.TYPE_CODE==="QUICK_LINK_STANDARD_IDEA"&&x.OBJECT_TYPE_CODE===o.OBJECT_TYPE_CODE){x.ACTIVE=x.ACTIVE===1?true:false;x.FILTER=o.FILTER;x.ACTION=o.ACTION;x.ROLES=o.ROLES;if(o.MANAGE){x.MANAGE=o.MANAGE;}i.push(x);}}});});}this.getModel("list").setProperty("/Variants/Values",i);this.setVariantVisibility(o);},setQuicklinkFilterListValue:function(){var e=this;var o=this.getModel("view");var i=this.byId("campaignFilterList");var j=i.getValue();o.setProperty("/quickLinkcampaignName",j);var x=[];["phaseSelect","statusSelect","subStatusSelect","latestUpdateSelect"].forEach(function(o1){var p1=e.byId(o1).getSelectedItems();p1.forEach(function(q1){x.push(q1.getText());});o.setProperty("/quickLink"+o1,x.toString());x=[];});var f1=[];["authorFilter","coachFilter","respListMultiInput"].forEach(function(o1){var p1=e.byId(o1).getTokens();p1.forEach(function(q1){f1.push(q1.getProperty("text"));});o.setProperty("/quickLink"+o1,f1.toString());f1=[];});var g1=[];["dpDue","dpDueTo"].forEach(function(o1){var p1=e.byId(o1).getValue();g1.push(p1);o.setProperty("/quickLinkdateFilter",g1.toString());});var h1=this.byId("voteOperatorSelect").getSelectedItem().getText();o.setProperty("/quickLinkvoteOperator",h1);var i1=this.getModel("filterItemModel").getProperty("/IdeaFormCriterias");var j1=this.getModel("filterItemModel").getProperty("/CAMPAIGNFORM");var k1=this.getModel("filterItemModel").getProperty("/IdeaFormList");var l1=this.byId("campaignFormFilterList").getValue();var m1=[];if(k1&&i1){k1.forEach(function(o1){i1.forEach(function(p1){if(p1.CriteriaCode===o1.CODE){if(p1.CriteriaValue==="1"&&p1.CriteriaValueDataType===1){m1.push(o1.DEFAULT_TEXT+": true");}else if(p1.CriteriaValue==="0"&&p1.CriteriaValueDataType===1){m1.push(o1.DEFAULT_TEXT+": false");}else{m1.push(o1.DEFAULT_TEXT+": "+p1.CriteriaValue);}}});});}var n1=i1.every(function(o1){return o1.CriteriaValue===""||o1.CriteriaValue===undefined;});if(j1!==""&&j1!==undefined){if(n1){o.setProperty("/quickLinkCampaignForm",l1.toString());}else{o.setProperty("/quickLinkCampaignForm",l1+"("+m1.toString()+")");}}else if(n1){o.setProperty("/quickLinkCampaignForm","");}else{o.setProperty("/quickLinkCampaignForm",m1.toString());}},onQuickLinkOpen:function(){this.setQuicklinkFilterListValue();this.getQuickLinkDialog().open();this.setShortByIcon("shortByIcon3","shortByIcon4");},getQuickLinkDialog:function(){if(!this._quickLinkDialog){this._quickLinkDialog=this.createFragment("sap.ino.vc.idea.fragments.QuickLinkDialog",this.getView().getId());this.getView().addDependent(this._quickLinkDialog);}return this._quickLinkDialog;},onHandleQuickLinkOK:function(){var o=this.byId("quickLinkName");if(o.getValue()===""||o.getValue()===undefined){o.setValueState("Error");return;}else{this.createQuickLinkCustomSettings();}},createQuickLinkCustomSettings:function(){var e=this;var i=1;var j=this.getCurrentQuickIdeaList().getVisibleItems();if(j.length>9){i=0;}var o=[];var x=this.getModel("list").getProperty("/Variants/Values");x.forEach(function(l1){o.push(l1.SEQUENCE);});var f1=Math.min.apply(null,o);var g1=this.getCustomLinkUrl();var h1=this.getViewProperty("/List/QUICKLINKNAME");var i1=this.getCurrentVariant().OBJECT_TYPE_CODE;var j1=[];j1.push({"ID":-1,"ACTIVE":i,"SEQUENCE":f1-1,"TYPE_CODE":"QUICK_LINK_CUSTOM_IDEA","OBJECT_TYPE_CODE":i1,"LINK_TEXT":h1,"LINK_URL":g1});var k1={duration:7000,width:'20em'};if(sap.ui.getCore().getMessageManager().getMessageModel().getData().length===0){this._quickLinkDialog.setBusy(true);P.updateQuickLinkSettings(j1).done(function(){P.getQuickLinkSettings({'TYPE_CODE':d1}).done(function(l1){e.refreshQuickLinkSettings(l1,x);var m1=e.getCurrentQuickIdeaList();m1.bindItems(m1.getBindingInfo('items'));e._quickLinkDialog.setBusy(false);e.onHandleQuickLinkCancel();M.show(e.getText("QUICK_LINK_CREATE_CUSTOMER_IDEA_SUCCESS"),k1);});}).fail(function(){e._quickLinkDialog.setBusy(false);e.onHandleQuickLinkCancel();M.show(e.getText("QUICK_LINK_CREATE_CUSTOMER_IDEA_FAILURE"),k1);});}},getCustomLinkUrl:function(){var o=this.getQuery();if("search"in o){delete o.search;}var e=this.getViewProperty("/List/VARIANT");var i=this.getCurrentRoute();var j={query:o};if(i==="idealist"){i="idealistvariant";}if(i==="campaign-idealist"||i==="campaign-idealistvariant"){j.id=o.campaign||this.campaignId;}j.variant=e;var x=this.getRouter().getURL(i,j);return decodeURIComponent(x);},onHandleQuickLinkCancel:function(){this._quickLinkDialog.close();this._quickLinkDialog.destroy();this._quickLinkDialog=undefined;this.setViewProperty("/List/QUICKLINKNAME","");},onQuickLinkInfoPopoverOpen:function(e){if(this._oQuickLinkInfoPopover){this._oQuickLinkInfoPopover.close();this._oQuickLinkInfoPopover=null;}this._oQuickLinkInfoPopover=this.createFragment("sap.ino.vc.idea.fragments.QuickLinkInfoPopover");this.getView().addDependent(this._oQuickLinkInfoPopover);this._oQuickLinkInfoPopover.openBy(e.getSource());},onQuickLinkStandListDialogOpen:function(){this._currentItemIndex=-1;this._currentData=jQuery.extend(true,[],this.getModel('list').getProperty('/Variants/Values'));this.deleteId=[];this.getQuickLinkStandardListDialog().open();this.onQuickLinkSelectionChange();},getQuickLinkStandardListDialog:function(){var o,e;if(!this._quickLinkStandardListDialog){this._quickLinkStandardListDialog=this.createFragment("sap.ino.vc.idea.fragments.QuickLinkStandardListDialog",this.getView().getId());this.getView().addDependent(this._quickLinkStandardListDialog);o=this.byId('quickLinkStandardListTable');e=o.getVisibleItems();for(var i=0;i<e.length;i++){e[i].addEventDelegate({onAfterRendering:function(){var j=o.getVisibleItems();if(this._currentItemIndex>=0&&j[this._currentItemIndex]){var x=j[this._currentItemIndex];if(x&&x.getCells&&x.getCells()[2]&&x.getCells()[2].firePress){x.getCells()[2].firePress();}}}},this);}this.updateQuickLinkCount(e.length);}else{o=this.byId('quickLinkStandardListTable');e=o.getVisibleItems();this.updateQuickLinkCount(e.length);}return this._quickLinkStandardListDialog;},updateQuickLinkCount:function(i){this.getModel('view').setProperty('/QUICK_LINK_COUNT',i);},onQuickLinkStandListMenuButtonPress:function(e){var o=e.getSource();if(!this._quickLinkMenuPopover){this._quickLinkMenuPopover=this._quickLinkStandardListDialog.getContent()[0].getContent()[1];this._quickLinkMenuPopover.setVisible(true);this.getView().addDependent(this._quickLinkMenuPopover);}this.setQuickLinkMenuButtonStatus(o.getParent().getParent(),o.getParent());this._quickLinkMenuPopover.getContent()[0].bindElement('list>'+o.getParent().getBindingContextPath());this._quickLinkMenuPopover.openBy(o);},setQuickLinkMenuButtonStatus:function(o,e){var i=this._quickLinkMenuPopover.getContent()[0].getItems();var j=i[0];var x=i[1];var f1=i[2];var g1=o.getVisibleItems();var h1=e.getBindingContext('list');var i1=h1.getProperty(h1.getPath()+'/TYPE_CODE')==='QUICK_LINK_CUSTOM_IDEA';j.setEnabled(e!==g1[0]);x.setEnabled(e!==g1[g1.length-1]);f1.setEnabled(i1);},onQuickLinkMoveUpButtonPress:function(e){var o=e.getSource().getBindingContext('list');this.setQuickLinkItemSequence(o,'UP');this._quickLinkMenuPopover.close();},onQuickLinkMoveDownButtonPress:function(e){var o=e.getSource().getBindingContext('list');this.setQuickLinkItemSequence(o,'DOWN');this._quickLinkMenuPopover.close();},setQuickLinkItemSequence:function(o,e){var j=this;var x=this.byId('quickLinkStandardListTable');var f1=o.getModel();var g1=o.getPath();var h1=x.getVisibleItems();var i1,j1,k1,l1,m1,n1,o1,p1,q1;for(var i=0;i<h1.length;i++){i1=h1[i];l1=i1.getBindingContext('list').getPath();if(l1===g1){o1=i1.getBindingContext('list').getProperty(l1+'/SEQUENCE');if(e==='UP'){j1=h1[i-1];m1=j1.getBindingContext('list').getPath();p1=j1.getBindingContext('list').getProperty(m1+'/SEQUENCE');f1.setProperty(l1+'/SEQUENCE',p1);f1.setProperty(m1+'/SEQUENCE',o1);j._currentItemIndex=i-1;}if(e==='DOWN'){k1=h1[i+1];n1=k1.getBindingContext('list').getPath();q1=k1.getBindingContext('list').getProperty(n1+'/SEQUENCE');f1.setProperty(l1+'/SEQUENCE',q1);f1.setProperty(n1+'/SEQUENCE',o1);j._currentItemIndex=i+1;}f1.refresh(true);return false;}}},onQuickLinkDeleteButtonPress:function(e){var o=e.getSource().getBindingContext('list');var j=o.getObject();var x=this.byId('quickLinkStandardListTable');var f1=x.getVisibleItems();var g1,h1;for(var i=0;i<f1.length;i++){g1=f1[i];h1=g1.getBindingContext('list').getPath();if(o.getPath()===h1){g1.getBindingContext('list').getObject().DELETE=1;}}this.getModel('list').refresh(true);this._currentItemIndex=-1;this.deleteId.push(j.ID);this.updateQuickLinkCount(x.getVisibleItems().length);this.onQuickLinkSelectionChange();},onQuickLinkInformationPopoverOpen:function(e){var o=e.getSource();if(!this._quickLinkInfoPopover){this._quickLinkInfoPopover=this.createFragment("sap.ino.vc.idea.fragments.QuickLinkInfoPopover");this.getView().addDependent(this._quickLinkInfoPopover);}this._quickLinkInfoPopover.openBy(o);},onQuickLinkSelectionChange:function(){var o=this.byId("quickLinkStandardListTable");var e=o.getVisibleItems();var i=0;var j=[];var x={duration:7000,width:'20em'};e.forEach(function(f1){var g1=f1.getAggregation("cells")[0].getSelected();if(g1===true){i+=1;}else{j.push(f1);}});if(i>9){M.show(this.getText("QUICK_LINK_LIST_SELECT_OVER_LIMIT"),x);j.forEach(function(f1){f1.getAggregation("cells")[0].setEnabled(false);});}else if(i===0){M.show(this.getText("QUICK_LINK_LIST_SELECT_BELOW_LIMIT"),x);this.byId('quickLinkStandardListDialogOKButton').setEnabled(false);}else{j.forEach(function(f1){f1.getAggregation("cells")[0].setEnabled(true);});this.byId('quickLinkStandardListDialogOKButton').setEnabled(true);}},onHandleQuickLinkStandardListDialogOK:function(){var o=this.byId("quickLinkStandardListTable");var e=o.getVisibleItems();var i=0;var j={duration:7000,width:'20em'};e.forEach(function(x){var f1=x.getAggregation("cells")[0].getSelected();if(f1===true){i+=1;}});if(i===0){M.show(this.getText("QUICK_LINK_LIST_SELECT_BELOW_LIMIT"),j);return;}this.updateQuickLinkStandardSettings();},updateQuickLinkStandardSettings:function(){var e=this;var i=this.getModel("list").getProperty("/Variants/Values");var j=[];var o={duration:7000,width:'20em'};i.forEach(function(x){if(x.TYPE_CODE==="QUICK_LINK_STANDARD_IDEA"){j.push({"ID":x.ID?x.ID:-1,"ACTIVE":x.ACTIVE===true?1:0,"SEQUENCE":x.SEQUENCE,"TYPE_CODE":"QUICK_LINK_STANDARD_IDEA","OBJECT_TYPE_CODE":x.OBJECT_TYPE_CODE});}else{j.push({"ID":x.ID?x.ID:-1,"ACTIVE":x.ACTIVE===true?1:0,"SEQUENCE":x.SEQUENCE,"TYPE_CODE":"QUICK_LINK_CUSTOM_IDEA","OBJECT_TYPE_CODE":x.OBJECT_TYPE_CODE,"LINK_TEXT":x.LINK_TEXT,"LINK_URL":x.LINK_URL});}});if(this.deleteId.length>0){j.forEach(function(x){e.deleteId.forEach(function(f1){if(x.ID===f1){x.DELETE=1;}});});this.deleteId.forEach(function(x){i=i.filter(function(f1){return f1.ID!==x;});});}P.updateQuickLinkSettings(j).done(function(){P.getQuickLinkSettings({'TYPE_CODE':d1}).done(function(x){e.refreshQuickLinkSettings(x,i);var f1=e.getCurrentQuickIdeaList();f1.bindItems(f1.getBindingInfo('items'));e._quickLinkStandardListDialog.close();M.show(e.getText("QUICK_LINK_UPDATE_SUCCESS"),o);});}).fail(function(){e._quickLinkStandardListDialog.close();M.show(e.getText("QUICK_LINK_UPDATE_FAILURE"),o);});},onHandleQuickLinkStandardListDialogCancel:function(){this.getModel('list').setProperty('/Variants/Values',this._currentData);this._quickLinkStandardListDialog.close();this._quickLinkStandardListDialog.destroy();this._quickLinkStandardListDialog=undefined;},onQuickLinkNameChange:function(e){var i=this;var o=e.getSource();var j=o.getValue();var x=this.getModel('list').getProperty('/Variants/Values');var f1=[this.getText('IDEA_LIST_MIT_EVAL_PENDING'),this.getText('IDEA_LIST_MIT_OPEN_FOR_EVAL'),this.getText('IDEA_LIST_MIT_MY_EVAL'),this.getText('IDEA_LIST_MIT_VOTE'),this.getText('IDEA_LIST_MIT_MY'),this.getText('IDEA_LIST_MIT_VOTED'),this.getText('IDEA_LIST_MIT_COMMENTED'),this.getText('IDEA_LIST_MIT_COMPLETED'),this.getText('IDEA_LIST_MIT_ALL'),this.getText('IDEA_LIST_MIT_FOLLOW_UP'),this.getText('IDEA_LIST_MIT_MANAGE'),this.getText('IDEA_LIST_MIT_UNASSIGNED'),this.getText('IDEA_LIST_MIT_COACH_ME'),this.getText('IDEA_LIST_MIT_EVAL_DONE')];if(!P.checkQuickLinkNameValid(x,j,f1)){o.fireValidationError({element:o,property:'value',type:'Error',message:i.getText('MSG_QUICK_LINK_NAME_DUPLICATED')});}else{o.fireValidationSuccess({element:o,property:'value'});}},initIdeaSearchParam:function(){var e=C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access");var o="";if(e){o="/sap/ino/xs/rest/backoffice/odata.xsodata";}else{o="/sap/ino/xs/rest/community/odata.xsodata";}var i=C.getBackendRootURL()+o+this.getList().mBindingInfos.items.binding.sPath+"?$format=json";var j=this.getList().mBindingInfos.items.binding.sFilterParams;var x=this.getList().mBindingInfos.items.binding.sSortParams;var f1="&$select(ID)";i=i+"&"+x+"&"+j+f1;var g1=new J();g1.setData({path:i});sap.ui.getCore().setModel(g1,"ideaSearchParams");},getGroupViewParameters:function(o){var e=C.getGroupConfiguration().GROUP;var i;if(e==="COMPANY"){i=1;}else if(e==="ORGANIZATION"){i=2;}var j;if(o.Variant===_.MY_GROUP_VIEW_AUTH){j=1;}else if(o.Variant===_.MY_GROUP_VIEW_VOTED){j=2;}else if(o.Variant===_.MY_GROUP_VIEW_COMMENTED){j=3;}j=j?j:0;i=i?i:0;return{groupToken:'',groupType:i,groupRole:j};},getSearchType:function(){var e=this.getModel('search').getProperty('/selectedCategory');var i=0;if(e==='campaign-idealistbycompany'||e==='idealistbycompany'){i=1;}return i;}}));e1.list=b1;e1.routes=Y;return e1;});};if(!jQuery.sap.isDeclared('sap.ino.vc.idea.ListPage.controller')){jQuery.sap.declare('sap.ino.vc.idea.ListPage.controller');sap.ui.define("sap/ino/vc/idea/ListPage.controller",["sap/ino/vc/idea/List.controller","sap/ino/vc/commons/TopLevelPageFacet"],function(I,T){"use strict";return I.extend("sap.ino.vc.idea.ListPage",jQuery.extend({},T,{routes:["idealist","idealistvariant"],onRouteMatched:function(e){this.setGlobalFilter([]);this.setHelp("IDEA_LIST");if(this.getRoute()==='idealist'){this._iCampaignId=null;this.campaignId=null;}this.show(e);},onAfterShow:function(){},onBeforeHide:function(){}}));});};if(!jQuery.sap.isDeclared('sap.ino.vc.campaign.CampaignIdeaList.controller')){jQuery.sap.declare('sap.ino.vc.campaign.CampaignIdeaList.controller');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ino/vc/campaign/CampaignIdeaList.controller",["sap/ino/vc/idea/List.controller","sap/ino/vc/commons/TopLevelPageFacet","sap/ui/Device","sap/ino/commons/application/Configuration","sap/ui/model/json/JSONModel","sap/ino/commons/models/aof/PropertyModel","sap/ino/vc/campaign/mixins/CampaignInstanceRolesMixin"],function(I,T,D,C,J,P,a){"use strict";return I.extend("sap.ino.vc.campaign.CampaignIdeaList",jQuery.extend({},a,T,{routes:["campaign-idealist","campaign-idealistvariant"],onInit:function(){I.prototype.onInit.apply(this,arguments);this.setViewProperty("/HIDE_CAMPAIGN_FILTER",true);},onRouteMatched:function(e){this.setGlobalFilter([]);var A=e.mParameters.arguments;var q=A["?query"]||{};q.campaign=A.id;q.variant=A.variant;var t=this;var i;var s;var v=this.getView();var f=function(){t.updateBackgroundColor(v.getBindingContext("data").getProperty("COLOR_CODE"));i=v.getBindingContext("data").getProperty("CAMPAIGN_BACKGROUND_IMAGE_ID");s=v.getBindingContext("data").getProperty("CAMPAIGN_SMALL_BACKGROUND_IMAGE_ID");t.setBackgroundImages(i,s);t.show((this.getRoute()==="campaign-idealist")?"idealist":"idealistvariant",q);t.getCampaignInstanceRolesData(t._iCampaignId);};var S=function(E){var p=E.getSource();var V=t.getModel("list").getProperty("/Variants/Values");p.destroy();};this._iCampaignId=parseInt(A.id,10);if(C.hasCurrentUserPrivilege("sap.ino.ui::backoffice.access")){var o=new P("sap.ino.xs.object.campaign.Campaign",this._iCampaignId,{nodes:["Root"]},false,S);}this.bindCampaignODataModel(this._iCampaignId,f);},onAfterShow:function(){this._bPreviouslyFullscreen=this.getFullScreen();if(!this._bPreviouslyFullscreen){this.setFullScreen(true);}},onBeforeHide:function(){this.setFullScreen(this._bPreviouslyFullscreen);},hasBackgroundImage:function(){return true;},onVariantPress:function(v){if(!D.system.desktop){return;}var q=this.getQuery();this.removeInvalidFilters(q);delete q.campaign;if(v){this.navigateTo(this.getRoute(true),{id:this._iCampaignId,variant:v,query:q},true,true);}else{this.navigateTo(this.getRoute(false),{id:this._iCampaignId,query:q},true,true);}},navigateIntern:function(q,r){var v=this.getViewProperty("/List/VARIANT");this.navigateTo(this.getCurrentRoute(),{"variant":v,"query":q,"id":this._iCampaignId},r,true);},bindTagCloud:function(){var b=this.getBindingParameter();var p=C.getTagcloudServiceURL(b.CampaignId,b.TagIds,b.SearchTerm,b.VariantFilter,!this.includeDrafts(),undefined,b.Filters);var c=this;if(this._lastTagServicePath!==p){var t=new J(p);var o=this.getText("IDEA_LIST_MIT_FILTER_TAG_OTHER");t.attachRequestCompleted(null,function(){var r=t.getData().RANKED_TAG||[];var d=t.getData().TAG_GROUP;var e=c.groupByTagGroup(r,c.getViewProperty("/List/TAGS"),o);jQuery.each(e,function(f,g){if(g.GROUP_NAME==="Other"){d.push(g);}});c.setTagCloudProperty(e,t.getData().WITHOUT_GROUP!=="X");t.setData({"RANKED_TAG":e,"TAG_GROUP":d},false);this.setFilterModel(t,"tag");},this);}this._lastTagServicePath=p;},bindCampaignODataModel:function(i,c){var t=this;var e="CampaignFull";if(i>0){this.getView().bindElement({path:"data>/"+e+"("+i+")",events:{dataRequested:function(){jQuery.each(t.getBusyControls(),function(b,d){if(jQuery.type(d.setBusy)==="function"){d.setBusy(true);}});},dataReceived:function(){jQuery.each(t.getBusyControls(),function(b,d){if(jQuery.type(d.setBusy)==="function"){d.setBusy(false);}});if(typeof c==="function"){c.apply(t);}}}});if(typeof c==="function"){var o=this.getView().getBindingContext("data");if(o&&o.getPath()===("/"+e+"("+i+")")){c.apply(t);}}}}}));});};
