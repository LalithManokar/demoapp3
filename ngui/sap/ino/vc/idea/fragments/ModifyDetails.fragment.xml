<core:FragmentDefinition
	xmlns="sap.m"
	xmlns:core="sap.ui.core"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:f="sap.ui.layout.form"
	xmlns:l="sap.ui.layout"
	xmlns:u="sap.ui.unified"
	xmlns:ino="sap.ino.controls"
	xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1">
	<l:Grid>
		<f:SimpleForm editable="true"
                      layout="{view>/Layouts/SimpleFormLayout/layout}"
                      labelSpanL="{view>/Layouts/SimpleFormLayout/labelSpanL}"
                      labelSpanM="{view>/Layouts/SimpleFormLayout/labelSpanM}"
                      emptySpanL="{view>/Layouts/SimpleFormLayout/emptySpanL}"
                      emptySpanM="{view>/Layouts/SimpleFormLayout/emptySpanM}">
			<f:layoutData>
				<l:GridData span="XL8 L8 M12 S12"/>
			</f:layoutData>
			<core:ExtensionPoint name="extension_details_top_left"/>
			<Label text="{i18n>IDEA_OBJECT_TIT_CAMPAIGN}" required="{object>meta/nodes/Root/attributes/CAMPAIGN_ID/required}" class="sapInoIdeaModifyLabel"/>
			<ComboBox
                    id="campaignComboBox"
                    visible="{object>property/nodes/Root/attributes/CAMPAIGN_ID/changeable}"
                    selectedKey="{path: 'object>CAMPAIGN_ID', type:'sap.ino.commons.models.types.IntegerNullableType'}"
                    enabled="{object>property/nodes/Root/attributes/CAMPAIGN_ID/changeable}"
                    selectionChange = "onCampaignSelectionChange">
				<layoutData>
					<l:GridData span="XL12 L12 M12 S12"/>
				</layoutData>
			</ComboBox>
			<Text id="campaignTitle" text="{object>CAMPAIGN_NAME}" visible="{=${object>property/nodes/Root/attributes/CAMPAIGN_ID/changeable} === false}"/>
			<Label text="{i18n>IDEA_OBJECT_TIT_NAME}" required="{object>meta/nodes/Root/attributes/NAME/required}"  class="sapInoIdeaModifyLabel"/>
			<Input id="NAME"
			       class="sapInfoIdeaName"
                   value="{object>NAME}"
                   maxLength="{object>meta/nodes/Root/attributes/NAME/maxLength}"
                   enabled="{object>property/nodes/Root/attributes/NAME/changeable}"
                   change="onTitleChange">
				<layoutData>
					<l:GridData span="XL12 L12 M12 S12"/>
				</layoutData>
			</Input>
			<Label id="RespList_lbl"  class="sapInoIdeaModifyLabel" text="{object>RESP_NAME}" visible = "{object>RESP_LIST_VISIBLE}"       required = "true" tooltip ="{object>RESP_DESCRIPTION}" />
			<Input id="RespList"
                   value="{object>RESP_VALUE_NAME}"
                   enabled = "{object>property/nodes/Root/attributes/RESPONSIBILITY_VALUE_CHANGEABLE/changeable}"
                   visible = "{=${object>RESP_LIST_VISIBLE}||false}" 
                   showValueHelp="true"
                   showSuggestion="true"
                   valueHelpOnly="true"
                   suggest="onSuggestionList"
                   suggestionItems = "{object>Resp_Value}"
                   suggestionItemSelected ="onSuggestionSelected"
                   valueHelpRequest = "onHandleValueHelp"
                   change = "onRespListValueChange">
				<suggestionItems>
					<core:Item text="{object>NAME}"/>
				</suggestionItems>
				<layoutData>
					<l:GridData span="XL11 L11 M11 S11" />
				</layoutData>
			</Input>
			<Button icon="sap-icon://hint" tooltip="{i18n>IDEA_RESP_LIST_TITLE_HINT}" visible = "{=${object>RESP_LIST_VISIBLE}||false}"
                enabled="{=!!${object>RESP_VALUE_NAME}}" class="sapInoIdeaSimilarIdeasButton" press="onRespListHint">
				<layoutData>
					<l:GridData span="XL1 L1 M1 S1"/>
				</layoutData>
			</Button>
			<core:ExtensionPoint name="extension_details_middle_left"/>
			<Label text="{i18n>IDEA_OBJECT_TIT_DESCRIPTION}" 
                required="{object>meta/nodes/Root/attributes/DESCRIPTION/required}" 
                visible="{=${device>/system/desktop}}"
                class="sapInoIdeaModifyDescriptionLabel">
				<layoutData>
					<l:GridData span="XL11 L11 M11 S11" />
				</layoutData>
			</Label>
			<!-- TODO use toggle button to indicate state -->
			<Button icon="sap-icon://check-availability" tooltip="{i18n>IDEA_RELATED_TITLE_SIMILAR_IDEAS}" visible="{=${device>/system/desktop}}"
                class="sapInoIdeaSimilarIdeasButton" press="onToggleSimilarIdeas">
				<layoutData>
					<l:GridData span="XL1 L1 M1 S1"/>
				</layoutData>
			</Button>
			<HBox width="100%" visible="{=${device>/system/desktop}}">
				<layoutData>
					<l:GridData span="XL12 L12 M12 S12"/>
				</layoutData>
				<VBox id="rteContainer"
                     class="sapInoIdeaModify"
                     height="100%" 
                     width="100%" 
                     visible="{=${device>/system/desktop}}">
					<!-- RTE is created lazily in controller initRTE to prevent loading issues when cache is not filled -->
				</VBox>
				<VBox id="similarIdeas" class="sapInoIdeaSimilarIdeasBase">
                    <core:Fragment fragmentName="sap.ino.vc.commons.fragments.SimilarIdeas" type="XML"/>
					<!--<List headerText="{i18n>IDEA_OBJECT_TIT_SIMILAR_IDEAS}" items="{similarIdeas>/}" class="sapInoIdeaSimilarIdeasList">
						<CustomListItem id="similarIdeasList">
							<Link text="{similarIdeas>NAME}" target="_blank" 
        			            href="{path: 'similarIdeas>ID', formatter: '.getIdeaDisplayLink'}" 
        			            class="sapInoIdeaSimilarIdeasListIdea"/>
						</CustomListItem>
					</List>-->
				</VBox>
			</HBox>
			<Label text="{i18n>IDEA_OBJECT_TIT_DESCRIPTION}" required="{object>meta/nodes/Root/attributes/DESCRIPTION/required}" visible="{=!${device>/system/desktop}}"/>
			<ino:MobileTextEditor visible="{=!${device>/system/desktop}}"
                                  showToolbar="false"
                                  value="{object>DESCRIPTION}"
                                  editable="{object>property/nodes/Root/attributes/DESCRIPTION/changeable}"
                                  maxHeight="20rem"
                                  minHeight="10rem"
                                  openInDialog="true"
                                  dialogTitle="{i18n>IDEA_OBJECT_TIT_DESCRIPTION}"
            />
			<Label text = "Additional Form Fields" visible = "false" />
			<VBox id="ideaFormAddFields" width="100%">
				<layoutData>
					<l:GridData span="XL12 L12 M12 S12"/>
				</layoutData>
			</VBox>
		</f:SimpleForm>
		<f:SimpleForm editable="true"
                      layout="{view>/Layouts/SimpleFormLayout/layout}"
                      labelSpanL="{view>/Layouts/SimpleFormLayout/labelSpanL}"
                      labelSpanM="{view>/Layouts/SimpleFormLayout/labelSpanM}"
                      emptySpanL="{view>/Layouts/SimpleFormLayout/emptySpanL}"
                      emptySpanM="{view>/Layouts/SimpleFormLayout/emptySpanM}">
			<f:layoutData>
				<l:GridData span="XL4 L4 M12 S12"/>
			</f:layoutData>
			<core:ExtensionPoint name="extension_details_top_right"/>
			<Label text="{i18n>IDEA_OBJECT_TIT_TITLE_IMAGE}" visible="{view>/ENABLE_IDEA_IMAGE}"/>
			<VBox visible="{view>/ENABLE_IDEA_IMAGE}">
				<u:FileUploader
                        id="imageUploader"
                        uploadUrl="{view>/ATTACHMENT_UPLOAD_URL}" multiple="false"
                        buttonOnly="true" 
                        buttonText="{i18n>IDEA_OBJECT_BTN_UPLOAD_TITLE_IMAGE}" 
                        icon="sap-icon://upload"
                        change="onFileUploaderChange" uploadComplete="onFileUploaderComplete" uploadOnChange="true"
                        typeMissmatch="onFileTypeMissMatch"
                        useMultipart="false" 
                        sendXHR="true"
                        mimeType="image/*"
                        enabled="{ parts : [{ path : 'object>ID', type : null }, { path : 'object>/property/nodes/Root/customProperties/contentEditable', type : null }], formatter:'.formatter.uploadEnabled' }"
                        />
				<Text text="{i18n>CTRL_USER_IMAGE_TEXT}"/>
				<ino:ImageCropping
                        id="imageCropping"
                        url="{parts:['object>TITLE_IMAGE_ID','config>/sap.ino.config.URL_PATH_XS_ATTACHMENT_DOWNLOAD','object>TITLE_IMAGE_CHANGED_AT'],formatter:'.formatter.ideaTitleImageUrl'}"
                        visible="{= ${object>TITLE_IMAGE_ID} > 0}"
                        width="216px"
                        height="121px"
                        showZoom="true"
                        showMove="{=!${device>/support/touch}}"
                        showClear="true"
                        showCrop="true"
                        zoomStep="5"
                        moveStep="5"
                        clear="onTitleImageClear"
                        cropImg="onTitleImageCrop"
                        enabled="{ parts : [{ path : 'object>ID', type : null }, { path : 'object>/property/nodes/Root/customProperties/contentEditable', type : null }], formatter:'.formatter.uploadEnabled' }"/>
			</VBox>
			<Label text="{i18n>IDEA_OBJECT_TIT_ATTACHMENTS}"
                   visible="{=!${device>/system/phone}}" />
			<mvc:XMLView viewName="sap.ino.vc.attachment.Attachment"
                         visible="{=!${device>/system/phone}}"
                         class="sapInoFormUploadCollection"
                         app:editable="true" />
			<Label text="{i18n>IDEA_OBJECT_TIT_LINKS}" />
			<VBox>
				<Button id="addLink"
                        press="onAddLink"
                        type="Transparent"
                        icon="sap-icon://add"
                        tooltip="{i18n>IDEA_OBJECT_BTN_ADD_LINK}"/>
				<List class="sapInoFormList"
                      items="{object>Links}"
                      showNoData="false">
					<CustomListItem>
						<FlexBox
                                alignItems="Center"
                                justifyContent="SpaceBetween"
                                class = "sapInoIdeaTrackLinkBox">
							<items>
								<Link text="{ parts : [{path: 'object>LABEL'}, {path: 'object>URL'}] , formatter : '.formatter.linkLabel' }"
                                      href="{object>URL}"
                                      target="new"
                                      wrapping="true"
                                />
								<HBox>
									<Button press="onEditLink"
                                        icon="sap-icon://edit-outside"
                                        tooltip="{i18n>IDEA_OBJECT_ALT_EDIT_LINK_TOOLTIP}"
                                        type="Transparent" />
									<Button press="onDeleteLink"
                                        icon="sap-icon://sys-cancel"
                                        tooltip="{i18n>IDEA_OBJECT_ALT_REMOVE_LINK_TOOLTIP}"
                                        type="Transparent" />
								</HBox>
							</items>
						</FlexBox>
					</CustomListItem>
				</List>
			</VBox>
			<Label text="{i18n>IDEA_OBJECT_TIT_CONTRIBUTORS}" />
			<MultiInput
                id="Contributors"
                change="onContributorsChanged"
                tokenChange="onContributorsTokenChanged"
                startSuggestion="2"
                showSuggestion="true"
                filterSuggests="false"
                showValueHelp="false"
                enabled="{=!${object>CONTRIBUTION_READ_ONLY}}"
                enableMultiLineMode="false"/>
			<Table 
			    items="{
			        path:'object>ContributionShare'
			    }"
			    visible="{
			        parts:[{path:'object>ContributionShare'},{path:'object>REWARD_ACTIVE'}],
			        formatter:'.contributionShareFormatter'
			    }"
			    showNoData="false"
			    class="contributorRewardList"
                id="contributorRewardList">
				<columns>
					<Column width="auto"></Column>
					<Column width="60px"></Column>
					<Column width="30px"></Column>
				</columns>
				<items>
					<ColumnListItem>
						<cells>
							<Text text="{object>AUTHOR_NAME}" />
							<Input 
    							type="Text" 
                                maxLength="{object>meta/nodes/Root/attributes/PERCENTAGE/maxLength}"
                                enabled="{=!${object>/CONTRIBUTION_READ_ONLY}}"
    							value="{path:'object>PERCENTAGE', type:'sap.ui.model.type.Integer', constraints:{minimum:0,maximum:100}}"
    							required="{object>meta/nodes/Root/attributes/PERCENTAGE/required}" />
							<Text text="{i18n>IDEA_OBJECT_FLD_UNIT_PERCENT}" />
						</cells>
					</ColumnListItem>
				</items>
			</Table>
			<Label text="{i18n>IDEA_OBJECT_TIT_TAGS}" />
			<MultiInput
                    id="Tags"
                    change="onTagChanged"
                    tokenChange="onTagTokenChanged"
                    startSuggestion="1"
                    showSuggestion="true"
                    filterSuggests="false"
                    showValueHelp="false"
                    enableMultiLineMode="false" />
             <Label id="anonymousOptionLabel" text="{i18n>IDEA_OBJECT_TIT_ANONYMOUS}" visible="{= ${object>OPEN_ANONYMOUS_FOR_IDEA} > 0}"/>
            	<ComboBox
                    id="anonymousComboBox"
                    selectionChange = "onAnonymousSelectionChange"
                    visible="{= ${object>OPEN_ANONYMOUS_FOR_IDEA} > 0}"
                    >
				<layoutData>
					<l:GridData span="XL12 L12 M12 S12"/>
				</layoutData>
			</ComboBox>
            <HBox id="openForContributors">
                <layoutData>
					<l:GridData span="XL12 L12 M12 S12"/>
				</layoutData>
                <CheckBox 
                    selected="{path: 'object>IS_OPEN_FOR_CONTRIBUTORS', type: 'sap.ino.commons.models.types.IntBooleanType'}"
                    enabled="{object>property/nodes/Root/attributes/CAMPAIGN_ID/changeable}" />
                <Text text="{i18n>IDEA_OBJECT_TIT_OPEN_CONTRIBUTORS}" />
            </HBox>
			<core:ExtensionPoint name="extension_details_middle_right"/>
		</f:SimpleForm>
		<f:SimpleForm editable="true"
			  layout="{view>/Layouts/SimpleFormLayout/layout}"
              labelSpanL="{view>/Layouts/SimpleFormLayout/labelSpanL}"
              labelSpanM="{view>/Layouts/SimpleFormLayout/labelSpanM}"
              emptySpanL="{view>/Layouts/SimpleFormLayout/emptySpanL}"
              emptySpanM="{view>/Layouts/SimpleFormLayout/emptySpanM}">
			<f:layoutData>
				<l:GridData span="XL8 L8 M12 S12"/>
			</f:layoutData>
			<core:ExtensionPoint name="extension_details_bottom_left"/>
		</f:SimpleForm>
		<f:SimpleForm editable="true"
			  layout="{view>/Layouts/SimpleFormLayout/layout}"
              labelSpanL="{view>/Layouts/SimpleFormLayout/labelSpanL}"
              labelSpanM="{view>/Layouts/SimpleFormLayout/labelSpanM}"
              emptySpanL="{view>/Layouts/SimpleFormLayout/emptySpanL}"
              emptySpanM="{view>/Layouts/SimpleFormLayout/emptySpanM}">
			<f:layoutData>
				<l:GridData span="XL4 L4 M12 S12"/>
			</f:layoutData>
			<core:ExtensionPoint name="extension_details_bottom_right"/>
		</f:SimpleForm>
	</l:Grid>
</core:FragmentDefinition>