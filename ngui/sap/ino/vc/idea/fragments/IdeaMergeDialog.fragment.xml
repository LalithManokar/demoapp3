<core:FragmentDefinition 
    xmlns="sap.m"
	xmlns:core="sap.ui.core"
    xmlns:l="sap.ui.layout"
	xmlns:ino="sap.ino.controls"
    xmlns:mvc="sap.ui.core.mvc">
    <Dialog
        title="{i18n>BO_IDEA_TIT_MERGE}"
        resizable="false"
        contentWidth="750px"
        contentHeight="50%"
        class="sapInoScrollContainer">
        <content>
            <NavContainer
                id="ideaMergeNavCon"
                defaultTransitionName="slide"
                >
                <pages>
                    <Page id="merge01" showHeader="false">
                        <Text text="{i18n>IDEA_MERGE_FLD_STEP1}" class = "sapInoFontWeightBold sapUiSmallMarginTop sapUiSmallMarginBegin" />
                        <HBox>
                            <Label text="{i18n>IDEA_MERGE_FLD_SOURCE_IDEA}" class="sapUiSmallMarginBegin sapUiTinyMarginTopBottom"/>
                            <Text text="{merge>/sourceName}" class="sapUiTinyMarginTopBottom sapInoSpaceBeforeText" />
                        </HBox>
                        <!-- list of all selectable ideas -->
                        <List
                            id="ideaSelection"
                            growing="false"
                            class="sapInoListWidthM sapInoSuppressPinBtn" />
                    </Page>
                    <Page id="merge02" showHeader="false">
                        <VBox>
                            <Text text="{i18n>IDEA_MERGE_FLD_STEP2}" class = "sapInoFontWeightBold sapUiSmallMarginTop sapUiSmallMarginBegin" />
                            <Select
    					        forceSelection="true"
    					        selectedKey="{merge>/leadingIdeaId}"
    					        items="{
    					            path: 'merge>/selectedIdeaObjects', 
    					            filters: [{ 
    					                path: 'outcome/CAN_BE_LEADING',
    					                operator: 'EQ',
    					                value1: true
    					            }],
    					            sorter: {
    					                path: 'NAME'
    					            }
    				            }"
    					        change="onChangeLeadingMergeIdea"
    					        class = "sapUiSmallMarginBegin sapUiSmallMarginTopBottom">
    					        <core:Item key="{merge>ID}" text="{merge>NAME}" />
    				        </Select>
                        <!-- leading idea selection -->
                        </VBox>
                        <VBox>
                            <Table
                                id="ideaMergeIdeaStatus"
                                inset="false"
                                items="{
                                    path: 'merge>/selectedIdeaObjects',
                                    sorter: {
                                        path: 'outcome/OUTCOME',
                                        descending: true
                                    }
                                }"
                                >
                                <columns>
                                    <Column><Label text="{i18n>IDEA_MERGE_FLD_COLUMN_IDEA}" /></Column>
                                    <Column width="1rem" />
                                    <Column><Label text="{i18n>IDEA_MERGE_FLD_COLUMN_RESULT}"/></Column>
                                </columns>
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <Link href="{ path: 'merge>ID', formatter: '.formatter.ideaNavigationLink' }"
                                                text="{merge>NAME}" target="_blank" />
                                            <core:Icon 
                                                    src="sap-icon://message-warning"
                                                    visible="{ path: 'merge>messages', formatter: '.formatIdeaMergeResultErroneous' }"
                                                    decorative="true" 
                                                    class="sapInoMergeIdeasWarningIcon"/>
                                            <HBox>
                                                <Text 
                                                    text="{ parts: [{path: 'merge>outcome/OUTCOME'}, {path: 'merge>messages'}], formatter: '.formatIdeaMergeResult'}" 
                                                    class="sapInoMergeIdeasTableMessage">
                                                    <customData>
                                                    <core:CustomData 
                                                        key="smallMessageStyle"
                                                        value=""
                                                        writeToDom="{ path: 'merge>messages', formatter: '.formatIdeaMergeResultErroneous' }"
                                                    />
                                                    </customData>
                                                </Text>
                                            </HBox>
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </VBox>
                        
                    </Page>
                </pages>
            </NavContainer>

        </content>
        <buttons>
            <Button id="ideaMergePrevStepBtn" text="{i18n>IDEA_MERGE_BTN_PREVIOUS_STEP}" visible="{= ${merge>/pageview} === 'merge02'}" press="onIdeaMergePrevStep" />
            <Button id="ideaMergeSelectAllBtn" text="{i18n>BTN_SELECT_ALL}" visible="{= ${merge>/pageview} === 'merge01'}" press="onSelectAllMergeIdeas" />
            <Button id="ideaMergeCancelBtn" text="{i18n>BO_COMMON_BUT_CANCEL}" press="onIdeaMergeCancel" />
            <Button id="ideaMergeNextStepBtn" 
                text="{i18n>IDEA_MERGE_BTN_NEXT_STEP}" 
                enabled="{path: 'merge>/selectedIdeas', formatter: '.formatIdeaMergeNextStepEnabled'}"
                visible="{= ${merge>/pageview} === 'merge01' }" 
                press="onIdeaMergeNextStep" />
            <Button id="ideaMergeConfirmBtn"
                enabled = "{path: 'merge>/selectedIdeaObjects', formatter: '.formatMergeActionEnabled'}"
                text="{i18n>IDEA_LIST_BTN_MERGE}" 
                visible="{= ${merge>/pageview} === 'merge02' }" 
                press="onMergeIdeasExecute" />
        </buttons>
    </Dialog>
</core:FragmentDefinition>