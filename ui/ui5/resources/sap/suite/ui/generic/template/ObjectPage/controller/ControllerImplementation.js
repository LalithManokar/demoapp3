sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/generic/app/navigation/service/SelectionVariant","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/detailTemplates/detailUtils","sap/suite/ui/generic/template/ObjectPage/controller/SideContentHandler","sap/suite/ui/generic/template/ObjectPage/extensionAPI/ExtensionAPI","sap/suite/ui/generic/template/js/AnnotationHelper","sap/m/Table","sap/ui/layout/DynamicSideContent","sap/suite/ui/generic/template/lib/ShareUtils","sap/ui/dom/jquery/Selectors","sap/base/Log","sap/suite/ui/generic/template/ObjectPage/controller/MultipleViewsHandler","sap/suite/ui/generic/template/lib/MessageUtils","sap/ui/events/KeyCodes","sap/base/util/merge","sap/ui/model/FilterProcessor"],function(C,M,F,S,a,t,d,b,E,A,R,D,c,f,L,g,h,K,m,l){"use strict";var n=25;function s(O){O.setSelectedSection(null);}function I(e){return e.data("inlineCreate")==="true";}function o(B,e){if(B.getBindings){var j=B.getBindings();for(var i=0;i<j.length;i++){o(j[i],e);}}else{var T=B.getType();B.setType(T,e);}}var r=/[A-Za-z].*[A-Za-z]/;var p={getMethods:function(v,T,q){var u={"oMultipleViewsHandler":{}};var B=d.getControllerBase(v,T,q);v.oController=q;var O;var w=new b(q,T,B.stateChanged);var y=null;var z=[];var G=[];var H=null;function J(e){var i=e.getParameter("bindingParams");i.parameters=i.parameters||{};i.parameters.usePreliminaryContext=true;i.parameters.bCanonicalRequest=T.oServices.oApplication.mustRequireRequestsCanonical();i.parameters.batchGroupId="facets";return i;}function N(){L.info("Activate object","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");var e=B.state.saveScenarioHandler;var i=T.oServices.oCRUDManager.activateDraftEntity(e);i.then(function(k){d1();h.showSuccessMessageIfRequired(T.oCommonUtils.getText("OBJECT_SAVED"),T.oServices);var x=q.getOwnerComponent();T.oServices.oViewDependencyHelper.setAllPagesDirty([x.getId()]);T.oServices.oViewDependencyHelper.unbindChildren(x);T.oServices.oApplication.invalidatePaginatorInfo();var X1=x.getNavToListOnSave();T.oServices.oApplication.navigateAfterActivation(!X1&&k.context);},jQuery.noop);var j={activationPromise:i};T.oComponentUtils.fire(q,"AfterActivate",j);}function P(e){var i=q.getView();var j=i.getModel();var k=j.hasPendingChanges();var x=j.getPendingChanges();var X1=Object.create(null);if(x){for(var Y1 in x){if(x.hasOwnProperty(Y1)){var Z1=j.getContext("/"+Y1);X1[Y1]={context:Z1,change:x[Y1]};}}}T.oCommonEventHandlers.submitChangesForSmartMultiInput();var $1=T.oServices.oCRUDManager.saveEntity();$1.then(function(a2){if(!e){var b2=T.oComponentUtils.getTemplatePrivateModel();b2.setProperty("/objectPage/displayMode",1);v.setEditable(false);}Q(a2,i,k,X1,e);});var _1={saveEntityPromise:$1};T.oComponentUtils.fire(q,"AfterSave",_1);}function Q(e,i,j,k,x){var X1=T.oComponentUtils.isNonDraftCreate();T.oServices.oViewDependencyHelper.setRootPageToDirty();T.oServices.oViewDependencyHelper.unbindChildren(q.getOwnerComponent());var Y1=q.getOwnerComponent();var Z1=Y1.getNavToListOnSave();var $1=T.oComponentUtils.getViewLevel()===1;var _1;if(X1){e=e||i.getBindingContext();if($1&&(!Z1||x)&&e&&e.getPath()!=="/undefined"){T.oServices.oNavigationController.navigateToContext(e,undefined,true);}else{T.oServices.oNavigationController.navigateBack();}_1="OBJECT_CREATED";}else{_1=j?"OBJECT_SAVED":"OBJECT_NOT_MODIFIED";if($1&&Z1&&!x){T.oServices.oNavigationController.navigateBack();}}h.showSuccessMessageIfRequired(T.oCommonUtils.getText(_1),T.oServices);for(var a2 in k){var b2=k[a2];var c2=b2.context;var d2=b2.change;var e2=Object.keys(d2)||[];var f2=e2.indexOf("__metadata");if(f2>-1){e2.splice(f2,1);}T.oServices.oApplicationController.executeSideEffects(c2,e2);}}function U(e){var i=e.getSource().getId();V("SaveAndContEdit",i);}function V(e,i){var j;var k;var x;if(T.oComponentUtils.isDraftEnabled()){j=1;k=N;x="activate";}else{j=3;if(e==="SaveAndContEdit"){k=P.bind(null,true);x=i;}else{k=P.bind(null,false);x="save";}}T.oCommonUtils.executeIfControlReady(B.state.saveScenarioHandler.handleSaveScenario.bind(null,j,k),x);}function W(e){if(I(e.getSource())){var i=e.getParameter("bindingParams");if(i.filters&&i.filters.length){var j=l.groupFilters(i.filters);i.filters=new F({filters:[new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:true}),j],and:true}),new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:false}),new F({filters:[j,new F({path:"HasActiveEntity",operator:"EQ",value1:false})],and:false})],and:true})],and:false});}var k=i.sorter[0]&&i.sorter[0].getGroupFunction();var x=k&&function(X1){var Y1=X1.getObject();if(Y1.IsActiveEntity||Y1.HasActiveEntity){var Z1=Object.assign({},k(X1));Z1.key=Z1.key.charAt(0)==="ยง"?"ยง"+Z1.key:Z1.key;return Z1;}return{key:"ยง",text:T.oCommonUtils.getText("NEW_ENTRY_GROUP")};};if(e.getSource().data("disableInlineCreateSort")==="false"){i.sorter.unshift(new S("HasActiveEntity",false,x));}}}function X(){return O.getHeaderTitle();}function Y(e){var i=T.oComponentUtils.getTemplatePrivateModel();var j={shareEmailPressed:function(){var k=i.getProperty("/objectPage/headerInfo/objectTitle");var x=i.getProperty("/objectPage/headerInfo/objectSubtitle");if(x){k=k+" - "+x;}var X1=document.URL.replace(/\(/g,'%28').replace(/\)/g,'%29');sap.m.URLHelper.triggerEmail(null,k,X1);},shareJamPressed:function(){c.openJamShareDialog(i.getProperty("/objectPage/headerInfo/objectTitle")+" "+i.getProperty("/objectPage/headerInfo/objectSubtitle"));},getModelData:function(){return{title:i.getProperty("/objectPage/headerInfo/objectTitle"),subtitle:i.getProperty("/objectPage/headerInfo/objectSubtitle"),customUrl:c.getCustomUrl()};}};c.openSharePopup(T.oCommonUtils,e.getSource(),j);}function Z(){var e=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.RelatedAppsSheet",{buttonPressed:function(i){var j=i.getSource();var k=j.getBindingContext("buttons");var x=k.getProperty("link");var X1=k.getProperty("param");var Y1=x.intent;var Z1=Y1.split("#")[1].split("-")[0];var $1=Y1.split("-")[1].split("?")[0].split("~")[0];var _1={target:{semanticObject:Z1,action:$1},params:X1};sap.ushell.Container.getService("CrossApplicationNavigation").toExternal(_1);}},"buttons");return e;}var $;function _(){$=function(e){var i=e.getSource().getParent();var j=T.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=q.getOwnerComponent();var x=k.getModel("_templPrivGlobal");var X1={objectPage:{currentEntitySet:k.getProperty("entitySet")}};x.setProperty("/generic/multipleViews",X1);var Y1=T.oServices.oCRUDManager.deleteEntity();var Z1=k.getBindingContext().getPath();var $1=Object.create(null);$1[Z1]=Y1;T.oServices.oApplication.prepareDeletion($1);var e={deleteEntityPromise:Y1};j.setBusy(Y1);T.oComponentUtils.fire(q,"AfterDelete",e);i.close();};return T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.TableDeleteConfirmation",{onCancel:function(e){var i=e.getSource().getParent();i.close();},onDelete:function(e){$(e);}},"delete");}function a1(){var e=T.oServices.oApplication.getBusyHelper();if(e.isBusy()){return;}var i=T.oCommonUtils;var j=T.oComponentUtils.getTemplatePrivateModel();var k=(j.getProperty("/objectPage/headerInfo/objectTitle")||"").trim();var x=j.getProperty("/objectPage/headerInfo/objectSubtitle");var X1;var Y1={};Y1.title=T.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE");if(k){if(x){X1=[" ",k,x];Y1.text=i.getText("DELETE_WITH_OBJECTINFO",X1);}else{X1=[k];Y1.text=i.getText("DELETE_WITH_OBJECTTITLE",X1);}}else{Y1.text=i.getText("ST_GENERIC_DELETE_SELECTED");}var Z1=Promise.resolve(q.beforeDeleteExtension());Z1.then(function($1){Object.assign(Y1,$1);var _1=_();var a2=_1.getModel("delete");a2.setData(Y1);_1.open();},jQuery.noop);}function b1(e){var i=e.getParameter("columnInfos");var j=i&&i.length-1;while(j>=0){if(i[j].ignore){i.splice(j,1);}j-=1;}var k=i.reduce(function(X1,Y1){if(!Y1.type&&!Y1.customParseFunction){X1.push(Y1);}return X1;},[]);if(k.length>0){var x=T.oCommonUtils.getText("DATA_PASTE_UNSUPPORTED_FORMAT_MESSAGE");M.show(x,{icon:M.Icon.ERROR,title:T.oCommonUtils.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE]});}}function c1(e){var j;var l1=e.getSource();var k=l1.getId();var x=k.split("::Table")[0]+"::addEntry";var X1=q.byId(x);if(!X1){return;}var Y1=e.getParameter("result");if(Y1){if(Y1.errors){var Z1=Y1.errors.map(function(g2){return g2.message;});var $1=T.oCommonUtils.getText("DATA_PASTE_ERROR_MESSAGE",[Z1.length]);var _1=T.oCommonUtils.getText("DATA_PASTE_ERROR_CORRECTION_MESSAGE");var a2=T.oCommonUtils.getText("DATA_PASTE_ERROR_CORRECTION_NOTE");Z1.unshift("");Z1.unshift(a2);Z1.unshift(_1);M.show($1,{icon:M.Icon.ERROR,title:T.oCommonUtils.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],details:Z1.join("<br />")});}else if(Y1.parsedData){j=Y1.parsedData;if(j&&j.length){var b2=j.length;var c2;var d2,e2=[];var f2=sap.m.DraftIndicatorState.Saved;for(var i=0;i<b2;i++){c2=i<b2-1;d2=T.oCommonEventHandlers.addEntry(X1,true,undefined,j[i],c2);e2.push(d2);}Promise.all(e2).then(function(){var g2=q.getOwnerComponent();var h2=g2.getAppComponent();var i2=h2.getModel("_templPrivGlobal");i2.setProperty("/generic/draftIndicatorState",f2);});}}}}function d1(){var e=T.oComponentUtils.getTemplatePrivateModel();var i=e.getProperty("/objectPage/aPasteAttachedTables");var j=i.length;var k;var x;while(j>=0){k=i[j];x=q.byId(k+"::Table");if(x&&x.isA("sap.ui.comp.smarttable.SmartTable")&&x.hasListeners("paste")){x.detachBeforePaste(b1);x.detachPaste(c1);i.splice(j,1);}j-=1;}}function e1(e){T.oServices.oApplication.performAfterSideEffectExecution(a1);}function f1(e,i){var j,k;if(e){k=e.context||e;if(T.oServices.oDraftController.getDraftContext().hasDraft(k)){T.oServices.oViewDependencyHelper.setRootPageToDirty();j=k.context||k;}}if(j){T.oServices.oApplication.invalidatePaginatorInfo();T.oServices.oApplication.switchToDraft(j);}else{var x=T.oComponentUtils.getTemplatePrivateModel();x.setProperty("/objectPage/displayMode",2);}v.setEditable(true);}var g1;function h1(e){T.oServices.oCRUDManager.editEntity(e).then(function(i){if(i.draftAdministrativeData){g1(i.draftAdministrativeData.CreatedByUserDescription||i.draftAdministrativeData.CreatedByUser);}else{f1(i.context,false);}});}g1=function(e){var i=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.UnsavedChangesDialog",{onEdit:function(){i.close();h1(true);},onCancel:function(){i.close();}},"Dialog");var j=i.getModel("Dialog");var k=T.oCommonUtils.getText("DRAFT_LOCK_EXPIRED",[e]);j.setProperty("/unsavedChangesQuestion",k);i.open();};function i1(){var j="{\"SelectionVariantID\":\"\"}";var k=q.getOwnerComponent();var X1=k.getEntitySet();var Y1=k.getModel();var Z1=Y1.getMetaModel();var $1=Z1.getODataEntitySet(X1);var _1=Z1.getODataEntityType($1.entityType);var a2=_1.property;var b2=[];for(var x in a2){var c2=a2[x]["com.sap.vocabularies.Common.v1.FieldControl"]&&a2[x]["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(c2&&b2.indexOf(c2)<0){b2.push(c2);}}var d2=q.getView().getBindingContext();var e2=d2.getObject();var f2=new a();for(var i in a2){var g2=a2[i].type;var h2=a2[i].name;var i2=e2[a2[i].name];if(b2.indexOf(h2)>-1){continue;}if(h2&&(i2||g2==="Edm.Boolean")){if(g2==="Edm.Time"&&i2.ms!==undefined){i2=i2.ms;}if(typeof i2!=="string"){try{i2=i2.toString();}catch(e){i2=i2+"";}}f2.addParameter(h2,i2);}}j=f2.toJSONString();return j;}function j1(e,l1){var i=true;var j=l1.getModel();l1=l1 instanceof R?l1.getParent():l1;var k=T.oCommonUtils.getDeleteRestrictions(l1);var x=k&&k.Deletable&&k.Deletable.Path;if(x){i=j.getProperty(x,e);}return i;}var k1;var l1;function m1(e,j){k1=e;l1=j instanceof R?j.getParent():j;var k=[];$=function(x){var X1=T.oServices.oApplication.getBusyHelper();var Y1=x.getSource().getParent();var Z1=T.oCommonUtils.getSelectedContexts(l1);k=[];var $1;var _1;var a2=q.getView().getModel().getObject(Z1[0].getPath());for(var i=0;i<Z1.length;i++){if(j1(Z1[i],l1)){k.push(Z1[i].getPath());}}var b2=T.oServices.oCRUDManager.deleteEntities(k);X1.setBusy(b2);T.oServices.oApplicationController.executeSideEffects(l1.getBindingContext(),[],[l1.getTableBindingPath()]);var c2=k1.getParent().getParent().getId();b2.then(function(e2){T.oCommonUtils.refreshSmartTable(l1);if(a2.IsActiveEntity===false){_1=0;}else{_1=e2.length;}$1=k.length-_1;var f2="";if($1>0){if(T.oCommonUtils.isUiTable(l1.getTable())){var g2=l1.getTable().getPlugin("sap.ui.table.plugins.SelectionPlugin");g2&&g2.clearSelection();}if($1>1){f2=T.oCommonUtils.getContextText("DELETE_SUCCESS_PLURAL_WITH_COUNT",l1.getId(),null,[$1]);}else{if(_1>0){f2=T.oCommonUtils.getContextText("DELETE_SUCCESS_WITH_COUNT",l1.getId(),null,[$1]);}else{f2=T.oCommonUtils.getContextText("ITEM_DELETED",l1.getId());}}}if(_1>0){if(_1>1){f2+=f2&&f2+"\n";f2+=T.oCommonUtils.getContextText("DELETE_ERROR_PLURAL_WITH_COUNT",l1.getId(),null,[_1]);}else{if($1>0){f2+="\n";f2+=T.oCommonUtils.getContextText("DELETE_ERROR_WITH_COUNT",l1.getId(),null,[_1]);}else{f2+=T.oCommonUtils.getContextText("DELETE_ERROR",l1.getId());}}}if(f2){if(_1>0){M.error(f2);}else{h.showSuccessMessageIfRequired(f2,T.oServices);}}});var d2={deleteEntitiesPromise:b2,sUiElementId:c2,aContexts:Z1};T.oComponentUtils.fire(q,"AfterLineItemDelete",d2);Y1.close();};return T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.TableDeleteConfirmation",{onCancel:function(i){var x=i.getSource().getParent();x.close();},onDelete:function(i){$(i);}},"delete");}function n1(e){var j=T.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k1=e.getSource();var l1=T.oCommonUtils.getOwnerControl(k1);if(!T.oCommonUtils.isSmartTable(l1)){l1=l1.getParent();}var k=T.oCommonUtils.getSelectedContexts(l1);if(k.length===0){M.error(T.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:T.oCommonUtils.getContentDensityClass()});return;}var x=[];var X1=[];for(var i=0;i<k.length;i++){if(j1(k[i],l1)){x.push(k[i].getPath());}else{X1.push(k[i]);}}var Y1={};if(k.length>1){Y1.title=T.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[k.length]);Y1.text=T.oCommonUtils.getContextText("DELETE_SELECTED_ITEMS",l1.getId());}else{var Z1=T.oCommonEventHandlers.getSelectedItemContextForDeleteMessage(l1,k[0]);Y1.title=T.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE");Y1.text=T.oCommonUtils.getContextText("DELETE_SELECTED_ITEM",l1.getId(),null,Z1);}if(X1.length>0){Y1.undeletableText=T.oCommonUtils.getContextText("DELETE_UNDELETABLE_ITEMS",l1.getId(),null,[X1.length,k.length]);}var $1={sUiElementId:k1.getParent().getParent().getId(),aContexts:k};var _1=Promise.resolve(q.beforeLineItemDeleteExtension($1));_1.then(function(a2){Object.assign(Y1,a2);var b2=m1(k1,l1);if(!X1.length){Y1.undeletableText=undefined;}var c2=b2.getModel("delete");c2.setData(Y1);b2.open();},jQuery.noop);}function o1(){var i=q.byId("imageDialog")||T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.ImageDialog",{onImageDialogClose:function(){i.close();}},"headerImage");return i;}function p1(){var e=T.oComponentUtils.getTemplatePrivateModel();e.setProperty("/objectPage/isHeaderExpanded",true);var i=q.byId("template::ObjectPage::TitleImage");if(!i){return;}var j=q.getView().byId("template::ObjectPage::ObjectPageHeader");j.attachStateChange(function(k){var x=k.getParameter("isExpanded");e.setProperty("/objectPage/isHeaderExpanded",x);});}function q1(){var e;var j=T.oComponentUtils.getTemplatePrivateModel();var k=function(i){return function(x){var X1=x.getSource();var Y1=X1.getExternalValue();j.setProperty("/objectPage/headerInfo/"+i,Y1);if(i==="objectTitle"){T.oComponentUtils.setText(Y1);if(!Y1){var Z1=T.oComponentUtils.getHeaderDataAvailablePromise();Z1.then(function($1){Y1=X1.getExternalValue();if(Y1){return;}var _1=q.getView();var a2=$1.getObject();var b2=_1.getModel("ui");var c2=b2.getProperty("/createMode");if(c2&&a2&&(a2.IsActiveEntity===undefined||a2.IsActiveEntity===false||a2.HasActiveEntity===false)){e=e||T.oCommonUtils.getText("NEW_OBJECT");j.setProperty("/objectPage/headerInfo/objectTitle",e);T.oComponentUtils.setText(e);}});}}};};O.getCustomData().forEach(function(x){var X1=x.getKey();if(X1==="objectTitle"||X1==="objectSubtitle"){var Y1=x.getBinding("value");var Z1=!Y1&&x.getBindingInfo("value");if(!Y1&&!Z1){j.setProperty("/objectPage/headerInfo/"+X1,x.getValue());return;}var $1=k(X1);if(Y1){Y1.attachChange($1);o(Y1,"string");}else{Z1.events={change:$1};for(var i=0;i<Z1.parts.length;i++){Z1.parts[i].targetType="string";}}}});}function r1(e){e.preventDefault();var i=T.oCommonUtils.getControlInformation(e,null,true);if(i){T.oCommonUtils.processDataLossConfirmationIfNonDraft(i.navigate,jQuery.noop,B.state);}}function s1(e,i){L.info("Set binding context to "+e,"Subsection: "+i.getId(),"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");i.setBindingContext(e);}function t1(e,i,j,k){if(i){var x=e?T.oComponentUtils.getHeaderDataAvailablePromise():Promise.resolve();x.then(function(){s1(undefined,j);var X1=j.getId();L.info("Start refreshing of Subsection: "+X1,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");k.refresh(null,true);L.info("End refreshing of Subsection: "+X1,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");});}else{s1(null,j);}}var u1={lazyLoading:t1.bind(null,false),lazyLoadingAfterHeader:t1.bind(null,true),reuseComponent:function(i,e){var j=e.getBlocks()[0];var k=i?T.oComponentUtils.getHeaderDataAvailablePromise():Promise.resolve();k.then(T.oComponentUtils.onVisibilityChangeOfReuseComponent.bind(null,i,j));}};function v1(e,i,j){if(j instanceof D){j=j.getMainContent()[0];}else if(!j.getContent){return;}j.getContent().forEach(function(k){if(T.oCommonUtils.isSmartTable(k)){if(i||e[k.getEntitySet()]){if(k.isInitialised()){T.oCommonUtils.refreshSmartTable(k);}else{k.attachInitialise(function(){T.oCommonUtils.refreshSmartTable(k);});}if(!i){T.oServices.oApplicationController.executeSideEffects(q.getOwnerComponent().getBindingContext(),[],[k.getTableBindingPath()]);}}}});}function w1(e){return T.oCommonUtils.getControlInformation(e);}function x1(e){z.push(e);T.oCommonUtils.getControlInformation(e,function(i,j){var k=e.getBlocks();w.initSideContentInfoObject(k[0]);var x=k.concat(e.getMoreBlocks());i.refresh=function(Z1,$1){var _1=v1.bind(null,Z1,$1);x.forEach(_1);};var X1=T.oCommonUtils.getElementCustomData(e).strategyForVisibilityChange;var Y1=u1[X1];i.strategyForVisibilityChange=Y1||jQuery.noop;if(Y1){j.push("subSectionListeningToVisibilityChange");}});}function y1(e){var i,j;i=e?e.getParameter("section"):undefined;j=i?i.getId():O.getSelectedSection();if(j!==y){L.info("Selected Section: "+j,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");}if(!i&&j){O.getSections().some(function(k){if(k.getId()===y){i=k;return true;}return false;});}return{sectionId:j,section:i};}function z1(e){var j=0,k;var x=y1(e);y=x.sectionId;k=x.section;if(k){var X1=k.getSelectedSubSection();if(X1!==H){L.info("Selected Subsection: "+H,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");H=X1;z.some(function(a2,b2){if(a2.getId()===H){j=b2;return true;}return false;});G=[];}}if(G.length===0){var Y1=0;var Z1=2;var $1=O.getUseIconTabBar();if($1&&k){var _1=k.getSubSections();Z1=_1.length>Z1?Z1:_1.length;}for(var i=j;Y1<Z1&&i<z.length;i++){var a2=z[i];if(a2.getVisible()){Y1++;G.push(a2.getId());}}}}function A1(i,e,j){e=e||w1(j);i=i||B1(j);if(e.isVisible===i){return;}e.isVisible=i;e.strategyForVisibilityChange(i,j,e);}function B1(e){var i=e.getId();return G.some(function(j){if(j===i){L.info("Initially Visible Subsection: "+i,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");return true;}return false;});}function C1(i){T.oCommonUtils.executeForAllInformationObjects("subSectionListeningToVisibilityChange",A1.bind(null,i));}function D1(e){var j=[];for(var i=0;i<e.length;i++){if(e[i].getVisible()){j.push(e[i]);}}return j;}function E1(){var e=[];var i=O.getSections();e=D1(i);if(e.length===1){return F1(e[0]);}return false;}function F1(e){if(e){var z=e.getSubSections();var i=D1(z);return i.length===1;}return false;}function G1(l1){var e=l1.getParent();var i=e.getParent();if(e&&e.isA("sap.ui.layout.Grid")&&i&&i.isA("sap.uxap.ObjectPageSubSection")){e.addStyleClass("sapSmartTemplatesObjectPageSubSectionGridExpand");i.addStyleClass("sapUxAPObjectPageSubSectionFitContainer");l1.setFitContainer(true);}}function H1(e,i){var j="sapUiSizeCompact",k="sapUiSizeCondensed",x;if(!e){return;}x=jQuery(document.body);if(x.hasClass(j)){i.addStyleClass(k);}}function I1(l1,e,i){if(e.isA("sap.m.Table")){e.setGrowingThreshold(n);e.setGrowingScrollToLoad(true);}else if(e.isA("sap.ui.table.Table")){G1(l1);H1(i,e);}}function J1(l1,e,i){var j;var k=q.getOwnerComponent().mProperties;if(k&&k.sections){var x=k.sections[i];if(x&&x.hasOwnProperty("condensedTableLayout")){j=x.condensedTableLayout;}else{j=k.condensedTableLayout;}}else{j=k.condensedTableLayout;}if(O.getUseIconTabBar()){var X1=e.getParent();while(X1&&X1.sParentAggregationName!=="sections"){X1=X1.getParent();}if(F1(X1)){I1(l1,e,j);}}else if(E1()){I1(l1,e,j);}}function K1(e){z1(e);B.stateChanged();}function L1(e,i,j,k,x){var X1=A.createP13NColumnKey(x);var Y1=A.getBindingForHiddenPath(x);if(Y1==="{= !${} }"){e.push(X1);return false;}if(typeof(Y1)==="string"){var Z1=Y1.match(r)&&Y1.match(r)[0];if(Z1&&Z1.indexOf("/")>0&&k.navigationProperty){var $1=q.getOwnerComponent().getEntitySet();var _1=Z1.split("/",1)[0];if(j.getODataAssociationSetEnd(k,_1).entitySet===$1){i[X1]=Z1.split("/").slice(1).join("/");return true;}}}else if(!Y1){e.push(X1);}return false;}function M1(l1,e,j,k,x,X1){var Y1=[];var Z1=Object.create(null);var $1=false;for(var i=0;i<X1.length;i++){var _1=X1[i];$1=L1(Y1,Z1,k,x,_1)||$1;}if($1){e.dynamicHideInfos={staticHiddenColumns:Y1,columnKeyToHiddenPath:Z1};j.push("smartTableWithDynamicColumnHide");}if(Y1.length){l1.deactivateColumns(Y1);}}function N1(e,j,l1){j.push("smartTable");l1=T.oCommonUtils.isMTable(l1)?l1.getParent():l1;var k=l1.getModel().getMetaModel();var x=k.getODataEntitySet(l1.getEntitySet());var X1=k.getODataEntityType(x.entityType);var Y1=X1["com.sap.vocabularies.UI.v1.LineItem"];var Z1=l1.getCustomData();for(var i=0;i<Z1.length;i++){if(Z1[i].getKey()==="lineItemQualifier"){Y1=X1["com.sap.vocabularies.UI.v1.LineItem#"+Z1[i].getValue()];break;}}M1(l1,e,j,k,X1,Y1||[]);}function O1(l1){return T.oCommonUtils.getControlInformation(l1,N1);}function P1(e,i){var j,k;j=i.split(e)[1];k=j&&j.substring(0,j.lastIndexOf("::Table"));return k;}function Q1(e,i,j){i.push("searchField");var k=T.oCommonUtils.isMTable(j.getParent().getParent())?j.getParent().getParent().getParent():j.getParent().getParent();e.table=k;var x=O1(k);x.searchField=j;}function R1(e){return T.oCommonUtils.getControlInformation(e,Q1);}function S1(e){R1(e);}function T1(e){var i=R1(e);i.searchString=e.getSource().getValue();i.table.rebindTable();}function U1(e,i){i.setValue("");if(e.searchString){e.searchString="";e.table.rebindTable();}}function V1(){T.oCommonUtils.executeForAllInformationObjects("searchField",U1);}v.refreshFacets=function(e){var i=function(j){var k=w1(j);k.refresh(e,false);};O.getSections().forEach(function(j){j.getSubSections().forEach(i);});};v.onComponentActivate=B.onComponentActivate;v.getCurrentState=function(){var e=Object.create(null);if(y){e.section={data:y,lifecycle:{permanent:true,pagination:true}};}if(H){e.subSection={data:H,lifecycle:{permanent:true,pagination:true}};}e.sideContent=w.getCurrentState();var i=Object.create(null);q.provideCustomStateExtension(i);for(var j in i){e["$custom$"+j]=i[j];}var k=true;var x=function(X1,Y1){if(!(X1 instanceof C)){throw new Error("State must always be set with respect to a ControllerExtension");}if(!k){throw new Error("State must always be provided synchronously");}var Z1=X1.getMetadata().getNamespace();if(Y1){for(var $1 in Y1){e["$extension$"+Z1+"$"+$1]=Y1[$1];}}};q.templateBaseExtension.provideExtensionStateData(x);k=false;return e;};v.applyState=function(u,i){var e=T.oComponentUtils.getHeaderDataAvailablePromise()||Promise.resolve();e.then(function(){var k=Object.create(null);var x=Object.create(null);for(var X1 in u){if(X1.indexOf("$custom$")===0){k[X1.substring(8)]=u[X1];}else if(X1.indexOf("$extension$")===0){var Y1=X1.substring(11,X1.indexOf("$",11));var Z1=x[Y1];if(!Z1){Z1=Object.create(null);x[Y1]=Z1;}var $1=X1.substring(X1.indexOf("$",11)+1,X1.length);Z1[$1]=u[X1];}}q.applyCustomStateExtension(k,i);var _1=true;var a2=function(b2){if(!(b2 instanceof C)){throw new Error("State must always be retrieved with respect to a ControllerExtension");}if(!_1){throw new Error("State must always be restored synchronously");}var Y1=b2.getMetadata().getNamespace();return x[Y1];};q.templateBaseExtension.restoreExtensionStateData(a2,i);_1=false;});w.applyState(u.sideContent,i);if(i){if(y!==(u.section||"")){B.stateChanged();}return;}V1();if(u.section){y=u.section;L.info("Restoring Selected Section: "+y,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");O.setSelectedSection(y);if(u.subSection){var j;z.some(function(k){if(k.getId()===u.subSection){j=k;return true;}return false;});if(j){j.getParent().setSelectedSubSection(j);}H=u.subSection;L.info("Restoring Selected Subsection: "+H,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");}}else{Promise.all([T.oComponentUtils.getHeaderDataAvailablePromise(),T.oComponentUtils.getNavigationFinishedPromise()]).then(s.bind(null,O));y="";}};v.beforeRebind=function(){C1(false);};v.afterRebind=function(){L.info("Call of _triggerVisibleSubSectionsEvents","","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");O._triggerVisibleSubSectionsEvents();};v.applyHeaderContextToSmartTablesDynamicColumnHide=function(e){var i=function(j,l1){var k=j.dynamicHideInfos.staticHiddenColumns.slice();for(var x in j.dynamicHideInfos.columnKeyToHiddenPath){var X1=j.dynamicHideInfos.columnKeyToHiddenPath[x];if(e.getProperty(X1)){k.push(x);}}l1.deactivateColumns(k);};T.oCommonUtils.executeForAllInformationObjects("smartTableWithDynamicColumnHide",i);};var h1=t.testable(h1,"editEntity");var j1=t.testable(j1,"isEntryDeletable");var N=t.testable(N,"onActivateImpl");var P=t.testable(P,"onSaveImpl");var W1={onInit:function(){O=q.byId("objectPage");var e=q.getOwnerComponent();var i=O.getSections();for(var k=0;k<i.length;k++){var j=i[k];var z=j.getSubSections();z.forEach(x1);}z1();var x=X();var X1=e.getAppComponent().getConfig();var Y1=!!(X1.settings&&(X1.settings.objectPageDynamicHeaderTitleWithVM||X1.settings.objectPageHeaderType==='Dynamic'));v.aBreadCrumbs=x&&(Y1?x.getBreadcrumbs().getLinks():x.getBreadCrumbsLinks());if(Y1){p1();}B.onInit(null,C1.bind(null,true));q1();T.oCommonUtils.executeGlobalSideEffect();O.attachEvent("subSectionEnteredViewPort",function(a2){var b2=a2.getParameter("subSection");L.info("Viewport entered ","Subsection: "+b2.getId(),"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");A1(true,null,b2);});var Z1=q.getOwnerComponent()&&q.getOwnerComponent().getSections();for(var $1 in Z1){if(Z1.hasOwnProperty($1)){Z1[$1]["key"]=$1;u.oMultipleViewsHandler[$1]=new g(u,q,T,Z1[$1]);u.oMultipleViewsHandler[$1]["oSmartTable"]=q.byId($1+"::Table");}}var _1=T.oComponentUtils.getTemplatePrivateModel();_1.setProperty("/objectPage/aPasteAttachedTables",[]);},handlers:{onEditAndActiveToggle:function(e,i){T.oServices.oApplication.performAfterSideEffectExecution(function(){var j=T.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=e.getBindingContext();var x=T.oServices.oApplication.getDraftSiblingPromise(k);j.setBusy(x.then(function(X1){if(i){L.info("Navigating to draft entity","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");f1(X1,true);}else{L.info("Navigating to active entity","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");T.oServices.oNavigationController.navigateToContext(X1,null,true,1,true);}f(':focus').blur();}));});},addEntry:function(e){var k1=e.getSource();var l1=T.oCommonUtils.getOwnerControl(k1);l1=T.oCommonUtils.isMTable(l1)?l1.getParent():l1;var i=I(l1);if(!k1.data("CrossNavigation")&&i){T.oCommonEventHandlers.addEntry(k1,true);return;}T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){T.oCommonEventHandlers.addEntry(k1,false);},jQuery.noop,B.state);},submitChangesForSmartMultiInput:function(){if(T.oComponentUtils.isDraftEnabled()){T.oCommonEventHandlers.submitChangesForSmartMultiInput();}},deleteEntries:n1,onSelectionChange:function(e){T.oCommonUtils.setEnabledToolbarButtons(e.getSource());},onMultiSelectionChange:function(e){T.oCommonEventHandlers.onMultiSelectionChange(e);},onCancel:function(e){var i=e.getSource();var j=B.state.onCancel(i);j.then(function(){d1();});},onContactDetails:function(e){T.oCommonEventHandlers.onContactDetails(e);},onPressDraftInfo:function(e){var i=q.getView().getBindingContext();var j=sap.ui.getCore().byId(e.getSource().getId()+(e.getId()==="markChangesPress"?"-changes":"-lock"));T.oCommonUtils.showDraftPopover(i,j);},onPressDraftInfoObjectPageDynamicHeaderTitle:function(e){var i=q.getView().getBindingContext();var j=q.byId("template::ObjectPage::ObjectMarkerObjectPageDynamicHeaderTitle");T.oCommonUtils.showDraftPopover(i,j);},onShareObjectPageActionButtonPress:Y,onRelatedApps:function(e){var x,X1,Y1,Z1,$1,_1,a2;var b2,c2,d2,e2,f2;x=e.getSource();d2=sap.ushell&&sap.ushell.Container;X1=d2&&d2.getService("URLParsing");Y1=X1.parseShellHash(document.location.hash);e2=Y1.semanticObject;f2=Y1.action;Z1=q.getView&&q.getView().getBindingContext();var g2=q.getOwnerComponent().getModel().getMetaModel();var h2=Z1.getObject();var i2=h2.__metadata.type;var j2=g2.getODataEntityType(i2);var k2=j2["com.sap.vocabularies.Common.v1.SemanticKey"];var l2={};if(k2&&k2.length>0){for(var j=0;j<k2.length;j++){var m2=k2[j].PropertyPath;if(!l2[m2]){l2[m2]=[];l2[m2].push(h2[m2]);}}}else{for(var k in j2.key.propertyRef){var n2=j2.key.propertyRef[k].name;if(!l2[n2]){l2[n2]=[];l2[n2].push(h2[n2]);}}}$1=q.getOwnerComponent().getAppComponent();_1=d2&&d2.getService("CrossApplicationNavigation");a2=_1.getLinks({semanticObject:e2,params:l2,ui5Component:$1});b2=Z();c2=b2.getModel("buttons");c2.setProperty("/buttons",[]);b2.openBy(x);a2.done(function(o2){var p2=[];o2.sort(function(t2,u2){if(t2.text<u2.text){return-1;}if(t2.text>u2.text){return 1;}return 0;});for(var i=0;i<o2.length;i++){var q2=o2[i];var r2=q2.intent;var s2=r2.split("-")[1].split("?")[0];if(s2!==f2){p2.push({enabled:true,text:q2.text,link:q2,param:l2});}}if(p2.length===0){p2.push({enabled:false,text:T.oCommonUtils.getText("NO_RELATED_APPS")});}c2.setProperty("/buttons",p2);});},onSemanticObjectLinkPopoverLinkPressed:function(e){T.oCommonEventHandlers.onSemanticObjectLinkPopoverLinkPressed(e,B.state);},onEdit:function(e){var k1=e.getSource();if(k1.data("CrossNavigation")){T.oCommonEventHandlers.onEditNavigateIntent(k1);return;}h1();},onSave:V,onSaveAndContinueEdit:U,onSmartFieldUrlPressed:function(e){T.oCommonEventHandlers.onSmartFieldUrlPressed(e,B.state);},onBreadCrumbUrlPressed:r1,onDelete:e1,onCallActionFromToolBar:function(e){T.oCommonEventHandlers.onCallActionFromToolBar(e,B.state);},onCallAction:function(e,i,j){T.oServices.oApplication.performAfterSideEffectExecution(function(){var k=q.getView().getBindingContext();if(k){T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var x=q.getOwnerComponent();var X1=x.getEntitySet();var Y1={functionImportPath:e,contexts:[k],sourceControl:"",label:i,operationGrouping:j};T.oServices.oCRUDManager.callAction(Y1).then(function(Z1){var $1=Z1&&Z1[0];if($1&&$1.response&&$1.response.context&&(!$1.actionContext||$1.actionContext&&$1.response.context.getPath()!==$1.actionContext.getPath())){T.oServices.oViewDependencyHelper.setParentToDirty(x,X1,1);}});},jQuery.noop,B.state,"Proceed");}},true);},onDataFieldForIntentBasedNavigation:function(e){e=m({},e);T.oServices.oApplication.performAfterSideEffectExecution(function(){T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){T.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(e,B.state);});},true);},onDataFieldWithIntentBasedNavigation:function(e){T.oCommonEventHandlers.onDataFieldWithIntentBasedNavigation(e,B.state);},onDataFieldWithNavigationPath:function(e){T.oCommonEventHandlers.onDataFieldWithNavigationPath(e);},onChartInit:function(e){e.getSource().getChartAsync().then(function(i){var j=q._templateEventHandlers.onSelectionChange;i.attachSelectData(j).attachDeselectData(j);var k=i.getParent();T.oCommonUtils.checkToolbarIntentsSupported(k);});},onDataRequested:function(i){L.info("Data requested","SmartTable: "+i,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");var e=(q&&q.getView()&&q.getView().getId())+"--";var j=P1(e,i);u.oMultipleViewsHandler[j]&&u.oMultipleViewsHandler[j].onDataRequested();},onDataReceived:function(e){T.oCommonEventHandlers.onDataReceived(e);},onBeforeRebindDetailTable:function(e){var i,j,k;var l1=e.getSource();var x=J(e);var X1=O1(l1);var Y1=X1.searchField;if(Y1){var Z1=T.oCommonUtils.getControlInformation(Y1);if(Z1.searchString){x.parameters.custom={search:Z1.searchString};}}T.oCommonEventHandlers.onBeforeRebindTable(e,{ensureExtensionFields:q.templateBaseExtension.ensureFieldsForSelect,addExtensionFilters:q.templateBaseExtension.addFilters});q.onBeforeRebindTableExtension(e);k=q&&typeof q.getView==="function"&&q.getView()&&typeof q.getView().getId==="function"&&q.getView().getId();if(k){k=k+"--";j=l1&&l1.getId();i=P1(k,j);u.oMultipleViewsHandler[i]&&u.oMultipleViewsHandler[i].onRebindContentControl(e);}W(e);if(T.oCommonUtils.isAnalyticalTable(l1.getTable())){x.parameters.entitySet=l1.getEntitySet();}},onListNavigate:function(e){T.oCommonEventHandlers.onListNavigate(e,B.state,q.onListNavigationExtension.bind(q));},onBeforeSemanticObjectLinkPopoverOpens:function(e){var i=e.getParameters();T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var j=i1();T.oCommonUtils.semanticObjectLinkNavigation(i,j,q);},jQuery.noop,B.state,jQuery.noop);},onSemanticObjectLinkNavigationPressed:function(e){var i=e.getParameters();var k1=e.getSource();T.oCommonEventHandlers.onSemanticObjectLinkNavigationPressed(k1,i);},onSemanticObjectLinkNavigationTargetObtained:function(e){var i=e.getParameters();var k1=e.getSource();T.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(k1,i,B.state);},onSemanticObjectLinkNavigationTargetObtainedSmartLink:function(e){var i,k1;i=e.getParameters();k1=e.getSource();k1=k1.getParent().getParent().getParent().getParent();T.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(k1,i,B.state);},onHeaderImagePress:function(e){if(e.getSource().getSrc()===""){return;}var i=o1();var j=e.getSource().getId();i.addAriaLabelledBy(j);var k=i.getModel("headerImage");k.setProperty("/src",e.getSource().getSrc());if(sap.ui.Device.system.phone){i.setProperty("stretch",true);}i.open();},sectionNavigate:K1,onInlineDataFieldForAction:function(e){T.oCommonEventHandlers.onInlineDataFieldForAction(e,B.state);},onInlineDataFieldForIntentBasedNavigation:function(e){T.oCommonEventHandlers.onInlineDataFieldForIntentBasedNavigation(e.getSource(),B.state);},onDeterminingDataFieldForAction:function(e){T.oCommonEventHandlers.onDeterminingDataFieldForAction(e);},onBeforeRebindChart:function(e){J(e);var i=e.getSource();i.getChartAsync().then(function(k){i.oModels=k.oPropagatedProperties.oModels;});var j={ensureExtensionFields:jQuery.noop,addExtensionFilters:q.templateBaseExtension.addFilters};T.oCommonUtils.onBeforeRebindTableOrChart(e,j);},onToggleDynamicSideContent:w.onToggleDynamicSideContent,sideContentBreakpointChanged:w.sideContentBreakpointChanged,onTableInit:function(e){var i;var l1=e.getSource();var j=l1.getTable();O1(l1);T.oCommonUtils.checkToolbarIntentsSupported(l1);var k=(q&&typeof q.getView==="function"&&q.getView()&&q.getView().getId())+"--";var x=l1&&l1.getId();i=P1(k,x);u.oMultipleViewsHandler[i]&&u.oMultipleViewsHandler[i].init(e);if(j.isA("sap.m.Table")){var X1=function(){J1(l1,j,i);};j.attachUpdateStarted(X1,this);}else if(j.isA("sap.ui.table.Table")){J1(l1,j,i);}if(I(l1)&&!l1.data("CrossNavigation")){j.addEventDelegate({onkeyup:function(e){if(e.ctrlKey&&e.keyCode===K.ENTER&&l1.getEditable()){T.oCommonEventHandlers.addEntry(l1,true);e.preventDefault();e.setMarked();}}});}var Y1=T.oComponentUtils.getTemplatePrivateModel();if(I(l1)){j.addEventDelegate({onAfterRendering:function(e){var Z1;if(l1.getEditable()&&!l1.hasListeners("paste")){l1.attachBeforePaste(b1);l1.attachPaste(c1);Z1=Y1.getProperty("/objectPage/aPasteAttachedTables");if(Z1){Z1.push(i);}}}});}},onPasteButtonPress:function(e){var i=T.oCommonUtils.getText("DATA_PASTE_ACTION_MESSAGE");M.information(i);},onSearchObjectPage:T1,onSearchLiveChange:S1,onSmartTablePaste:c1,onUITableExpand:G1,onSingleVisibleSection:E1,onSingleVisibleSubSection:F1},formatters:{sideContentActionButtonText:w.formatSideContentActionButtonText,setNoDataTextForSmartTable:function(e){if(T.oCommonUtils&&e){var i=T.oCommonUtils.getContextText("NOITEMS_SMARTTABLE",e);if(i!=="NOITEMS_SMARTTABLE"){return i;}return"";}},setVMVisibilityForVendor:function(){var e=jQuery.sap.getUriParameters();if(e.mParams["sap-ui-layer"]){var j=e.mParams["sap-ui-layer"];for(var i=0;i<j.length;i++){if(j[i].toUpperCase()==="VENDOR"){return true;}}}return false;},formatItemTextForMultipleView:function(i){var e=i&&i.facetId;return u.oMultipleViewsHandler[e]?u.oMultipleViewsHandler[e].formatItemTextForMultipleView(i):"";}},extensionAPI:new E(T,q,B)};W1.handlers=Object.assign(B.handlers,W1.handlers);return W1;}};return p;});
